var Ao=Object.defineProperty;var No=(t,s,n)=>s in t?Ao(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var mr=(t,s,n)=>No(t,typeof s!="symbol"?s+"":s,n);import{j as e,_ as Ea,a as Pa,D as Aa,P as Na}from"./vendor-pdf-fH9nKmrR.js";import{b as To,c as Ro,g as Do,d as Te,T as ue,L as es,e as We,S as X,f as re,B as lt,A as yt,h as ti,i as ke,j as Fo,k as Ge,l as Ws,r as c,m as q,n as Ki,o as Xi,p as Wn,q as ts,s as tt,t as Nt,E as Pt,D as Ot,u as Fe,v as Yn,M as ct,w as Ta,x as Ra,y as Bt,z as Qn,C as ht,F as Gn,G as $e,H as Zi,I as $o,J as Ut,K as Lo,N as Q,O as L,P as _i,Q as Ji,U as _e,V as Lt,W as qt,X as en,Y as ee,Z as se,$ as z,a0 as K,a1 as qi,a2 as gr,a3 as Mo,a4 as ve,a5 as Ce,a6 as le,a7 as De,a8 as si,a9 as Mt,aa as ye,ab as ss,ac as Vt,ad as xe,ae as er,af as zt,ag as tr,ah as as,ai as Bo,aj as Da,ak as Fa,al as Je,am as dt,an as Ys,ao as zo,ap as Qs,aq as rt,ar as Cs,as as ut,at as _o,au as qo,a as Pe,av as sr,aw as fr,ax as Gs,ay as tn,az as yr,aA as Uo,aB as os,aC as ze,aD as vs,aE as $a,aF as Ct,aG as ns,aH as sn,aI as Oo,aJ as Vo,aK as Ho,aL as La,aM as Wo,aN as br,aO as Yo,aP as Qo,aQ as Go,aR as Ma,aS as nn,aT as Ko,aU as Xo,aV as Zo,aW as Jo,aX as el,aY as jr,aZ as Ba,a_ as tl,a$ as sl,b0 as nl,b1 as il,b2 as rl,b3 as al,b4 as ol,b5 as Ui,b6 as ll,b7 as St,b8 as cl,b9 as vr,ba as dl,bb as ul}from"./vendor-antd-DBqaEXz6.js";import{c as nt,u as Se,a as we,b as he,d as Ie,e as Tt,L as it,f as pt,w as wr,n as za,g as _a,i as Ks,h as hl,j as Ps,k as qa,p as nr,l as Ts,m as Kn,o as ir,q as is,r as Sr,s as pl,S as Ua,t as li,v as rr,x as Oa,y as xl,z as Va,A as ml,B as kr,C as gl,D as fl,E as yl,F as bl,G as zs,N as Ss,H as jl,I as vl,R as wl,J as be,K as Sl,P as kl}from"./vendor-react-DhRdgJPE.js";import{a as ls}from"./vendor-utils-BjqWK1h3.js";import{n as Z,k as Ht}from"./vendor-ui-DBsRPB0H.js";import{E as Il}from"./vendor-editor-Cfg_fevG.js";import{L as Xn,G as Es,R as ni,T as Xs,u as Cl,a as El,I as Pl,C as Al,b as Nl,c as Tl,S as Rl,F as Dl,d as Fl}from"./vendor-canvas-B6JX88JX.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Oi={},Ir=To;Oi.createRoot=Ir.createRoot,Oi.hydrateRoot=Ir.hydrateRoot;const Cr=localStorage.getItem("token"),ci=localStorage.getItem("user");let Ha=null;try{Ha=ci&&ci!=="undefined"?JSON.parse(ci):null}catch(t){console.error("Failed to parse user data from localStorage",t),localStorage.removeItem("user")}const $l={isAuthenticated:!!Cr,user:Ha,token:Cr},Wa=nt({name:"auth",initialState:$l,reducers:{setCredentials:(t,s)=>{t.user=s.payload.user,t.token=s.payload.token,t.isAuthenticated=!0,localStorage.setItem("token",s.payload.token),localStorage.setItem("user",JSON.stringify(s.payload.user))},logout:t=>{t.user=null,t.token=null,t.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}}}),{setCredentials:Ya,logout:Ll}=Wa.actions,Ml=Wa.reducer;var ot=(t=>(t.NEW_LEAD="New Lead",t.FOLLOWUP_DUE="Follow-up Due",t.STATUS_CHANGE="Status Changed",t.ASSIGNMENT="Lead Assigned",t))(ot||{}),$t=(t=>(t.FACEBOOK="Facebook",t.WEBSITE="Website",t.MANUAL="Manual",t.SYSTEM="System",t))($t||{}),mt=(t=>(t.HIGH="High",t.MEDIUM="Medium",t.LOW="Low",t))(mt||{}),Ne=(t=>(t.READ="Read",t.UNREAD="Unread",t))(Ne||{});const Qa=()=>[{id:"1",userId:"1",type:ot.NEW_LEAD,title:"New Lead from Facebook",message:"John Smith has inquired about Tourist visa",source:$t.FACEBOOK,priority:mt.HIGH,status:Ne.UNREAD,entityId:"101",entityType:"lead",createdAt:new Date(new Date().setHours(new Date().getHours()-1)).toISOString()},{id:"2",userId:"1",type:ot.FOLLOWUP_DUE,title:"Follow-up Due Today",message:"You have a call scheduled with Emma Wilson at 2:00 PM",source:$t.SYSTEM,priority:mt.HIGH,status:Ne.UNREAD,entityId:"201",entityType:"followup",createdAt:new Date(new Date().setHours(new Date().getHours()-3)).toISOString()},{id:"3",userId:"1",type:ot.STATUS_CHANGE,title:"Lead Status Changed",message:'Sarah Johnson changed the status of lead Michael Brown from "New" to "Contacted"',source:$t.SYSTEM,priority:mt.MEDIUM,status:Ne.UNREAD,entityId:"102",entityType:"lead",createdAt:new Date(new Date().setHours(new Date().getHours()-5)).toISOString()},{id:"4",userId:"1",type:ot.ASSIGNMENT,title:"Lead Assigned to You",message:"David Wilson assigned a new lead Raj Patel to you",source:$t.SYSTEM,priority:mt.MEDIUM,status:Ne.READ,entityId:"103",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-1)).toISOString(),readAt:new Date(new Date().setHours(new Date().getHours()-6)).toISOString()},{id:"5",userId:"1",type:ot.NEW_LEAD,title:"New Lead from Website",message:"Sophie Martin has inquired about Permanent Residency visa",source:$t.WEBSITE,priority:mt.HIGH,status:Ne.READ,entityId:"104",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-1)).toISOString(),readAt:new Date(new Date().setHours(new Date().getHours()-12)).toISOString()},{id:"6",userId:"1",type:ot.FOLLOWUP_DUE,title:"Follow-up Overdue",message:"You missed a WhatsApp follow-up with Akira Tanaka yesterday",source:$t.SYSTEM,priority:mt.HIGH,status:Ne.UNREAD,entityId:"202",entityType:"followup",createdAt:new Date(new Date().setDate(new Date().getDate()-2)).toISOString()},{id:"7",userId:"1",type:ot.STATUS_CHANGE,title:"Lead Status Changed",message:'You changed the status of lead Ana Rodriguez from "Contacted" to "Interested"',source:$t.SYSTEM,priority:mt.LOW,status:Ne.READ,entityId:"105",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-3)).toISOString(),readAt:new Date(new Date().setDate(new Date().getDate()-3)).toISOString()},{id:"8",userId:"1",type:ot.NEW_LEAD,title:"New Lead from Manual Entry",message:"A new lead has been added manually for Business visa",source:$t.MANUAL,priority:mt.MEDIUM,status:Ne.UNREAD,entityId:"106",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-4)).toISOString()}],Bl=()=>({userId:"1",inApp:{enabled:!0,newLeads:!0,followUpReminders:!0,statusChanges:!0,leadAssignments:!0},email:{newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0},pushNotifications:!1});var Ga={exports:{}};(function(t,s){(function(n,i){t.exports=i()})(Ro,function(){return function(n,i,r){n=n||{};var o=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function p(d,I,f,x){return o.fromToBase(d,I,f,x)}r.en.relativeTime=a,o.fromToBase=function(d,I,f,x,E){for(var w,y,C,l=f.$locale().relativeTime||a,m=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],P=m.length,h=0;h<P;h+=1){var u=m[h];u.d&&(w=x?r(d).diff(f,u.d,!0):f.diff(d,u.d,!0));var N=(n.rounding||Math.round)(Math.abs(w));if(C=w>0,N<=u.r||!u.r){N<=1&&h>0&&(u=m[h-1]);var g=l[u.l];E&&(N=E(""+N)),y=typeof g=="string"?g.replace("%d",N):g(N,I,u.l,C);break}}if(I)return y;var A=C?l.future:l.past;return typeof A=="function"?A(y):A.replace("%s",y)},o.to=function(d,I){return p(d,I,this,!0)},o.from=function(d,I){return p(d,I,this)};var j=function(d){return d.$u?r.utc():r()};o.toNow=function(d){return this.to(j(this),d)},o.fromNow=function(d){return this.from(j(this),d)}}})})(Ga);var zl=Ga.exports;const _l=Do(zl);Te.extend(_l);const Er=t=>{switch(t){case mt.HIGH:return"#f5222d";case mt.MEDIUM:return"#faad14";case mt.LOW:return"#52c41a";default:return"#1677ff"}},ql=t=>Te(t).fromNow(),Ul=t=>Te(t).format("YYYY-MM-DD HH:mm"),_s=t=>t.filter(s=>s.status===Ne.UNREAD).length,Ol=t=>{if(!t.entityId||!t.entityType)return"/notifications";switch(t.entityType){case"lead":return`/leads/${t.entityId}`;case"followup":return`/followups/${t.entityId}`;default:return"/notifications"}},{Text:Pr,Paragraph:Vl}=ue,Ka=({notification:t,onView:s,onMarkAsRead:n})=>{const i=()=>{switch(t.type){case ot.NEW_LEAD:return e.jsx(Ws,{style:{color:"#1677ff"}});case ot.FOLLOWUP_DUE:return e.jsx(Ge,{style:{color:"#faad14"}});case ot.STATUS_CHANGE:return e.jsx(Fo,{style:{color:"#722ed1"}});case ot.ASSIGNMENT:return e.jsx(ke,{style:{color:"#52c41a"}});default:return e.jsx(ti,{style:{color:"#1677ff"}})}},r=()=>{t.status===Ne.UNREAD&&n(t),s(t)};return e.jsx(es.Item,{onClick:r,className:t.status===Ne.UNREAD?"notification-unread":"",style:{cursor:"pointer",backgroundColor:t.status===Ne.UNREAD?"#f0f5ff":"transparent",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},children:e.jsx(es.Item.Meta,{avatar:e.jsx(lt,{dot:t.status===Ne.UNREAD,color:Er(t.priority),children:e.jsx(yt,{icon:i(),size:"large",style:{backgroundColor:"white",border:`1px solid ${Er(t.priority)}`}})}),title:e.jsxs(X,{children:[e.jsx(Pr,{strong:!0,children:t.title}),t.status===Ne.UNREAD&&e.jsx(re,{color:"blue",children:"New"})]}),description:e.jsxs("div",{children:[e.jsx(Vl,{ellipsis:{rows:2},style:{marginBottom:4},children:t.message}),e.jsx(We,{title:Ul(t.createdAt),children:e.jsx(Pr,{type:"secondary",style:{fontSize:12},children:ql(t.createdAt)})})]})})})},{Title:Hl,Text:Wl}=ue,{TabPane:Ar}=tt,Yl=()=>{const t=Se(),[s,n]=c.useState([]),[i,r]=c.useState(!1),[o,a]=c.useState(!1),[p,j]=c.useState(!1),[d,I]=c.useState("all"),[f,x]=c.useState(!1),E=c.useRef(null);c.useEffect(()=>{w();const g=setInterval(()=>{Math.random()<.25&&!o&&(j(!0),x(!0),setTimeout(()=>{x(!1)},2e3))},3e4);return()=>clearInterval(g)},[o]);const w=()=>{r(!0),setTimeout(()=>{const g=Qa();n(g),r(!1),j(g.some(A=>A.status===Ne.UNREAD))},600)},y=g=>{a(g),g&&(j(!1),E.current&&E.current.classList.remove("bell-animate"))},C=g=>{l(g),a(!1),g.entityId&&g.entityType?g.entityType==="lead"?t(`/leads/${g.entityId}`):g.entityType==="followup"&&t(`/followups/${g.entityId}`):t("/notifications")},l=g=>{const A=s.map($=>$.id===g.id?{...$,status:Ne.READ,readAt:new Date().toISOString()}:$);n(A)},m=()=>{a(!1),t("/notifications")},P=()=>{const g=s.map(A=>A.status===Ne.UNREAD?{...A,status:Ne.READ,readAt:new Date().toISOString()}:A);n(g),j(!1)},h=()=>d==="unread"?s.filter(g=>g.status===Ne.UNREAD):s.slice(0,5),u=g=>{I(g)},N=e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx(Hl,{level:5,style:{margin:0},children:"Notifications"}),e.jsxs(X,{children:[e.jsx(q,{type:"text",size:"small",icon:e.jsx(Ki,{}),onClick:w,loading:i,className:"header-btn",title:"Refresh notifications"}),e.jsx(q,{type:"text",size:"small",icon:e.jsx(Xi,{}),onClick:P,disabled:_s(s)===0,className:"header-btn",title:"Mark all as read"}),e.jsx(q,{type:"text",size:"small",icon:e.jsx(Wn,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Settings"}),e.jsx(q,{type:"text",size:"small",icon:e.jsx(ts,{}),onClick:()=>a(!1),className:"header-btn",title:"Close"})]})]}),e.jsxs(tt,{activeKey:d,onChange:u,size:"small",className:"notification-tabs",children:[e.jsx(Ar,{tab:e.jsx("span",{children:"All"})},"all"),e.jsx(Ar,{tab:e.jsxs("span",{className:"tab-label",children:["Unread",e.jsx(lt,{count:_s(s),size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})},"unread")]}),i?e.jsxs("div",{className:"notification-loading",children:[e.jsx(Nt,{size:"large"}),e.jsx(Wl,{type:"secondary",children:"Loading notifications..."})]}):e.jsx("div",{style:{backgroundColor:"white"},children:e.jsx(es,{className:"notification-list",dataSource:h(),renderItem:g=>e.jsx("div",{onClick:()=>C(g),className:"notification-item",children:e.jsx(Ka,{notification:g,onView:C,onMarkAsRead:l})}),locale:{emptyText:e.jsx(Pt,{image:Pt.PRESENTED_IMAGE_SIMPLE,description:"No notifications",className:"notification-empty"})}})}),e.jsx("div",{className:"notification-footer",children:e.jsx(q,{type:"primary",onClick:m,style:{width:"100%",borderRadius:"4px"},children:"View All Notifications"})})]});return e.jsx("div",{className:`notification-bell-container ${f?"has-new-notification":""}`,ref:E,children:e.jsx(Ot,{open:o,onOpenChange:y,trigger:["click"],dropdownRender:()=>N,placement:"bottomRight",arrow:{pointAtCenter:!0},overlayStyle:{zIndex:1050,boxShadow:"0 6px 16px -8px rgba(0,0,0,0.2), 0 9px 28px rgba(0,0,0,0.1)"},destroyPopupOnHide:!0,children:e.jsx(lt,{count:_s(s),overflowCount:99,className:p?"badge-pulse":"",style:{backgroundColor:p?"#f5222d":"#1677ff",transition:"background-color 0.3s ease"},size:"small",offset:[-2,2],children:e.jsx(q,{type:"text",icon:e.jsx(ti,{className:"bell-icon"}),className:"notification-bell-btn","aria-label":"Notifications"})})})})},ii="/api",te=ls.create({baseURL:ii,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Yt=ls.create({baseURL:ii,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Xa=ls.create({baseURL:ii,headers:{"Content-Type":"application/json",Accept:"application/json"}});te.interceptors.request.use(t=>{var o,a,p,j,d,I,f,x,E;const s=localStorage.getItem("token"),n=localStorage.getItem("exhibitor_token"),i=((o=t.url)==null?void 0:o.startsWith("/bookings/"))&&t.method==="patch"||((a=t.url)==null?void 0:a.includes("/exhibition/"))||((p=t.url)==null?void 0:p.includes("/stalls/"))||((j=t.url)==null?void 0:j.includes("/halls/"))||((d=t.url)==null?void 0:d.includes("/users/"))||((I=t.url)==null?void 0:I.includes("/roles/")),r=((f=t.url)==null?void 0:f.includes("/test-booking"))||((x=t.url)==null?void 0:x.includes("/exhibitor-bookings"))||((E=t.url)==null?void 0:E.startsWith("/exhibitors/"));return i?s?t.headers.Authorization=`Bearer ${s}`:console.warn("Admin token required but not found for:",t.url):r&&n?t.headers.Authorization=`Bearer ${n}`:s?t.headers.Authorization=`Bearer ${s}`:n&&(t.headers.Authorization=`Bearer ${n}`),t},t=>Promise.reject(t));Xa.interceptors.request.use(t=>{const s=localStorage.getItem("exhibitor_token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));te.interceptors.response.use(t=>t,t=>{var n,i,r;((n=t.response)==null?void 0:n.status)===401&&localStorage.removeItem("token");const s=((r=(i=t.response)==null?void 0:i.data)==null?void 0:r.message)||t.message;return Promise.reject(new Error(s))});Xa.interceptors.response.use(t=>t,t=>{var n,i,r;((n=t.response)==null?void 0:n.status)===401&&localStorage.removeItem("exhibitor_token");const s=((r=(i=t.response)==null?void 0:i.data)==null?void 0:r.message)||t.message;return Promise.reject(new Error(s))});const Nr=async(t,s=!1)=>{const n=s?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return ls.get(`${ii}${t}`,{responseType:"blob",headers:{Authorization:`Bearer ${n}`}})};class Ql{async getSettings(){return(await te.get("/settings")).data}async updateSettings(s){return(await te.put("/settings",s)).data}async uploadLogo(s){const n=new FormData;return n.append("file",s),(await te.post("/settings/upload/logo",n,{headers:{"Content-Type":"multipart/form-data"}})).data}}const ar=new Ql,Gl={settings:null,loading:!1,error:null},qs=we("settings/fetchSettings",async(t,{rejectWithValue:s})=>{var n,i;try{return await ar.getSettings()}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch settings")}}),Us=we("settings/updateSettings",async(t,{rejectWithValue:s})=>{var n,i;try{return await ar.updateSettings(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to update settings")}}),An=we("settings/uploadLogo",async(t,{dispatch:s,rejectWithValue:n})=>{var i,r;try{const o=await ar.uploadLogo(t);return o.path&&await s(Us({logo:o.path})),o}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to upload logo")}}),Kl=nt({name:"settings",initialState:Gl,reducers:{},extraReducers:t=>{t.addCase(qs.pending,s=>{s.loading=!0,s.error=null}).addCase(qs.fulfilled,(s,n)=>{s.settings=n.payload,s.loading=!1}).addCase(qs.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Us.pending,s=>{s.loading=!0,s.error=null}).addCase(Us.fulfilled,(s,n)=>{s.settings=n.payload,s.loading=!1}).addCase(Us.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(An.pending,s=>{s.loading=!0,s.error=null}).addCase(An.fulfilled,s=>{s.loading=!1}).addCase(An.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),Xl=Kl.reducer,Za=()=>{const{user:t}=he(r=>r.auth),s=r=>{if(!t||!t.role||!t.role.permissions)return console.log("[Permission Check] No user or missing role/permissions:",{user:t}),!1;const o=t.role.permissions;if(o.includes(r))return console.log(`[Permission Check] ${r}: true (exact match)`),!0;if(o.includes("*")||o.includes("all")||o.includes("admin")||o.includes("superadmin")||o.includes("full_access"))return console.log(`[Permission Check] ${r}: true (wildcard match)`),!0;const a=r.split("_");if(a.length===2){const p=`${a[1]}_${a[0]}`,j=[`${a[0]}.*`,`*.${a[1]}`,`view_${a[0]}`,`${a[0]}_view`,`${a[0]}s_${a[1]}`,p];for(const d of j)if(o.includes(d))return console.log(`[Permission Check] ${r}: true (alternate match: ${d})`),!0}return console.log(`[Permission Check] ${r}: false`,{available:o}),!1};return{hasPermission:s,hasAnyPermission:r=>r.some(o=>s(o)),hasAllPermissions:r=>r.every(o=>s(o))}},{Header:Zl,Sider:Jl,Content:ec}=Fe,tc=Z.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,sc=Z.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,nc=Z.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;Z.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const Me=({children:t})=>{var C;const[s,n]=c.useState(!1),i=Se(),r=Ie(),o=Tt(),a=he(l=>l.auth.user),{settings:p}=he(l=>l.settings),[j,d]=c.useState("/logo.png"),{hasPermission:I}=Za();c.useEffect(()=>{var l;console.log("[MainLayout] User object:",{user:a,permissions:(l=a==null?void 0:a.role)==null?void 0:l.permissions})},[a]),c.useEffect(()=>{r(qs())},[r]),c.useEffect(()=>{const l=localStorage.getItem("cachedLogoUrl"),m=localStorage.getItem("logoTimestamp"),P=new Date().getTime();if(l&&m&&P-parseInt(m)<36e5)d(l);else if(p!=null&&p.logo){const h=`${te.defaults.baseURL}/public/logo`;d(h),localStorage.setItem("cachedLogoUrl",h),localStorage.setItem("logoTimestamp",P.toString());const u=new Image;u.src=h}},[p]);const f=[{key:"dashboard",icon:e.jsx(Qn,{style:{fontSize:"16px"}}),label:"Dashboard",onClick:()=>i("/dashboard"),requiredPermission:"dashboard_view"},{key:"exhibition",icon:e.jsx(ht,{style:{fontSize:"16px"}}),label:"Exhibitions",onClick:()=>i("/exhibition"),requiredPermission:"exhibitions_view"},{key:"stall",icon:e.jsx(Gn,{style:{fontSize:"16px"}}),label:"Stalls",children:[{key:"stall-list",icon:e.jsx(Gn,{style:{fontSize:"16px"}}),label:"Stall List",onClick:()=>i("/stall/list"),requiredPermission:"view_stalls"},{key:"stall-type",icon:e.jsx($e,{style:{fontSize:"16px"}}),label:"Stall Types",onClick:()=>i("/stall-types"),requiredPermission:"view_stall_types"}],requiredPermission:"view_stalls"},{key:"bookings",icon:e.jsx(ht,{style:{fontSize:"16px"}}),label:"Stall Bookings",onClick:()=>i("/bookings"),requiredPermission:"bookings_view"},{key:"exhibitors",icon:e.jsx(Zi,{}),label:"Exhibitors",onClick:()=>i("/exhibitors"),requiredPermission:"exhibitors_view"},{key:"users",icon:e.jsx(ke,{}),label:"Users",onClick:()=>i("/index"),requiredPermission:"users_view"},{key:"roles",icon:e.jsx($o,{}),label:"Roles",onClick:()=>i("/roles"),requiredPermissions:["roles_view","dashboard_view"]},{key:"settings",icon:e.jsx(Wn,{}),label:"Settings",onClick:()=>i("/settings"),requiredPermission:"settings_view"}],x=l=>l.filter(m=>{var P;return m.key==="roles"&&console.log("[Menu Filter] Roles menu item check:",{requiredPermission:m.requiredPermission,requiredPermissions:m.requiredPermissions,hasPermission:m.requiredPermissions?m.requiredPermissions.every(h=>I(h)):m.requiredPermission?I(m.requiredPermission):!0,userPermissions:(P=a==null?void 0:a.role)==null?void 0:P.permissions}),m.requiredPermissions&&m.requiredPermissions.length>0?m.requiredPermissions.every(h=>I(h)):m.requiredPermission?I(m.requiredPermission):!0}).map(m=>{const{requiredPermission:P,requiredPermissions:h,...u}=m;if(u.children){const N=x(u.children);return N.length===0?null:{...u,children:N}}return u}).filter(Boolean),E=x(f),w=[{key:"profile",label:"Profile",icon:e.jsx(ke,{}),onClick:()=>i("/account")},{key:"settings",label:"Settings",icon:e.jsx(Wn,{}),onClick:()=>i("/settings"),style:I("settings_view")?{}:{display:"none"}},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(Yn,{}),onClick:()=>{r(Ll()),i("/login")}}],y=()=>{const l=o.pathname.substring(1);return l.charAt(0).toUpperCase()+l.slice(1)};return e.jsxs(Fe,{style:{minHeight:"100vh"},children:[e.jsxs(Jl,{trigger:null,collapsible:!0,collapsed:s,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsx(tc,{children:e.jsx(sc,{children:e.jsx(nc,{src:j,alt:"Logo",onError:()=>d("/logo.png")})})}),e.jsx(ct,{mode:"inline",selectedKeys:[o.pathname.substring(1)||"dashboard"],items:E,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:s})]}),e.jsxs(Fe,{style:{marginLeft:s?80:256,transition:"all 0.2s"},children:[e.jsxs(Zl,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(q,{type:"text",icon:s?e.jsx(Ta,{}):e.jsx(Ra,{}),onClick:()=>n(!s),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:y()})]}),e.jsxs(X,{size:16,children:[e.jsx(q,{type:"text",icon:e.jsx(Bt,{}),style:{fontSize:16}}),e.jsx(Yl,{}),e.jsx(Ot,{menu:{items:w},trigger:["click"],children:e.jsxs(X,{style:{cursor:"pointer"},children:[e.jsx(yt,{style:{backgroundColor:"#7C3AED",cursor:"pointer"},children:(C=a==null?void 0:a.username)==null?void 0:C.charAt(0).toUpperCase()}),e.jsx("span",{style:{color:"#111827",fontWeight:500},children:a==null?void 0:a.username})]})})]})]}),e.jsx(ec,{style:{margin:"24px",padding:"24px",background:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},children:t})]})]})},Tr=localStorage.getItem("exhibitor_token"),ic=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,rc={isAuthenticated:!!Tr,exhibitor:ic,token:Tr,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},Ja=nt({name:"exhibitorAuth",initialState:rc,reducers:{setExhibitorCredentials:(t,s)=>{t.exhibitor=s.payload.exhibitor,t.token=s.payload.token,t.isAuthenticated=!0,localStorage.setItem("exhibitor_token",s.payload.token),localStorage.setItem("exhibitor",JSON.stringify(s.payload.exhibitor))},exhibitorLogout:t=>{t.exhibitor=null,t.token=null,t.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(t,s)=>{t.showLoginModal=!0,t.showForgotPasswordModal=!1,t.loginContext=s.payload||null},hideLoginModal:t=>{t.showLoginModal=!1,t.loginContext=null},showForgotPasswordModal:t=>{t.showForgotPasswordModal=!0,t.showLoginModal=!1},hideForgotPasswordModal:t=>{t.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:Vi,exhibitorLogout:eo,showLoginModal:rs,hideLoginModal:ln,showForgotPasswordModal:ac,hideForgotPasswordModal:di}=Ja.actions,oc=Ja.reducer,{Header:lc,Sider:cc,Content:dc}=Fe,cs=({children:t})=>{var I;const[s,n]=c.useState(!1),i=Se(),r=Ie(),o=Tt(),a=he(f=>f.exhibitorAuth.exhibitor),p=[{key:"dashboard",icon:e.jsx(Qn,{}),label:"Dashboard",onClick:()=>i("/exhibitor/dashboard")},{key:"bookings",icon:e.jsx(ht,{}),label:"My Bookings",onClick:()=>i("/exhibitor/bookings")},{key:"profile",icon:e.jsx(ke,{}),label:"My Profile",onClick:()=>i("/exhibitor/profile")},{key:"exhibitions",icon:e.jsx(Ut,{}),label:"Exhibitions",onClick:()=>i("/exhibitions")},{key:"help",icon:e.jsx(Lo,{}),label:"Help & Support",onClick:()=>i("/exhibitor/support")}],j=[{key:"profile",label:"Profile",icon:e.jsx(ke,{}),onClick:()=>i("/exhibitor/profile")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(Yn,{}),onClick:()=>{r(eo()),i("/")}}],d=()=>{const f=o.pathname.replace("/exhibitor/","");return f.charAt(0).toUpperCase()+f.slice(1)};return e.jsxs(Fe,{style:{minHeight:"100vh"},children:[e.jsxs(cc,{trigger:null,collapsible:!0,collapsed:s,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100},width:256,children:[e.jsxs("div",{style:{height:72,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:s?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[e.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!s&&e.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),e.jsx(ct,{mode:"inline",selectedKeys:[o.pathname.split("/").pop()||"dashboard"],items:p,style:{border:"none",padding:"16px 8px",background:"transparent"}})]}),e.jsxs(Fe,{style:{marginLeft:s?80:256,transition:"all 0.2s"},children:[e.jsxs(lc,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(q,{type:"text",icon:s?e.jsx(Ta,{}):e.jsx(Ra,{}),onClick:()=>n(!s),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:d()})]}),e.jsxs(X,{size:16,children:[e.jsx(lt,{count:3,size:"small",children:e.jsx(q,{type:"text",icon:e.jsx(ti,{}),style:{fontSize:16}})}),e.jsx(Ot,{menu:{items:j},trigger:["click"],children:e.jsxs(X,{style:{cursor:"pointer"},children:[e.jsx(yt,{style:{backgroundColor:"#1890ff",cursor:"pointer"},children:((I=a==null?void 0:a.companyName)==null?void 0:I.charAt(0).toUpperCase())||"E"}),e.jsx("span",{style:{color:"#111827",fontWeight:500},children:(a==null?void 0:a.companyName)||"Exhibitor"})]})})]})]}),e.jsx(dc,{style:{margin:"24px",padding:"24px",background:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},children:t})]})]})},Hi={login:async t=>await te.post("/auth/login",t),getProfile:async()=>await te.get("/auth/me"),changePassword:async t=>await te.post("/auth/change-password",t)},{Title:to,Text:Rs,Paragraph:uc}=ue,rn=Ht`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,hc=Ht`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,pc=Ht`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,or=Ht`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,so=Ht`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,xc=Ht`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,mc=Ht`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,gc=Ht`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,fc=Z.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,yc=Z.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${hc} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,bc=Z.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${t=>.1+t.index%3*.05}), transparent);
  left: ${t=>20+t.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${t=>t.isHovered?xc:mc} ${t=>1.5+t.index*.2}s ease-out;
  animation-delay: ${t=>t.index*.1}s;
  animation-fill-mode: forwards;
`,jc=Z.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${pc} 0.8s ease-out forwards;
`,vc=Z.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,wc=Z.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${gc} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${or} 2s ease-in-out infinite;
  }
`,Sc=Z.span`
  margin-left: 10px;
  animation: ${rn} 0.5s ease-out;
`,kc=Z.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,Ic=Z.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,Cc=Z.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${rn} 0.8s ease-out forwards;
`,Ec=Z.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,Pc=Z.img`
  width: 140px;
  height: auto;
  animation: ${so} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;Z.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const Ac=Z.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${rn} 0.8s ease-out forwards;
`,Nc=Z.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,Tc=Z(to)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,Rc=Z(uc)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,Dc=Z.div`
  width: 100%;
  max-width: 400px;
  animation: ${rn} 0.6s ease-out;
`,Fc=Z(Q)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,$c=Z(Q.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Lc=Z(q)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${or} 0.5s ease-in-out;
  }
`,Mc=Z.div`
  margin-bottom: 2rem;
  text-align: center;
`,cn=Z(L.Item)`
  margin-bottom: 24px;
`,Bc=Z.div`
  margin-top: 8px;
`,zc=Z.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,_c=Z(_i)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,qc=Z.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${rn} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${or} 0.5s ease-in-out;
  }
`,Rr=()=>e.jsxs(vc,{children:[e.jsxs(wc,{viewBox:"0 0 50 50",children:[e.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),e.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),e.jsx(Sc,{children:"Signing in..."})]}),Uc=Z.div`
  position: absolute;
  width: ${t=>t.size}px;
  height: ${t=>t.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${so} ${t=>t.duration}s ease-in-out infinite;
  animation-delay: ${t=>t.delay}s;
  top: ${t=>t.top}%;
  left: ${t=>t.left}%;
  z-index: 1;
`,Oc=t=>{if(!t)return 0;const s=t.length>=8,n=/[A-Z]/.test(t),i=/[a-z]/.test(t),r=/\d/.test(t),o=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(t),a=[s,n,i,r,o];return a.filter(j=>j).length/a.length*100},Vc=t=>t<30?"#ff4d4f":t<60?"#faad14":t<80?"#1890ff":"#52c41a",Hc=t=>t<30?"Weak":t<60?"Fair":t<80?"Good":"Strong",Wc=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],Yc=()=>{const t=Se(),s=Ie(),[n,i]=c.useState(null),[r,o]=c.useState(!1),[a,p]=c.useState(!1),[j,d]=c.useState(""),[I,f]=c.useState(!1),x=he(S=>S.auth.isAuthenticated),E=c.useRef(null),[w,y]=c.useState({x:0,y:0}),[C,l]=c.useState(!1),[m,P]=c.useState(!1),[h]=L.useForm(),[u,N]=c.useState("/logo.png"),[g,A]=c.useState("EXHIBITION MANAGER");c.useEffect(()=>{const S=localStorage.getItem("cachedLogoUrl"),R=localStorage.getItem("logoTimestamp"),B=new Date().getTime();if(S&&R&&B-parseInt(R)<36e5)N(S);else{const _=`${te.defaults.baseURL}/public/logo`;N(_),localStorage.setItem("cachedLogoUrl",_),localStorage.setItem("logoTimestamp",B.toString());const V=new Image;V.src=_}fetch(`${te.defaults.baseURL}/public/site-info`).then(_=>_.json()).then(_=>{_.siteName&&A(_.siteName)}).catch(_=>{console.error("Error fetching site info:",_)})},[]),c.useEffect(()=>{const S=localStorage.getItem("rememberedUser");if(S)try{const R=JSON.parse(S);h.setFieldsValue({username:R.username,password:R.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[h]),c.useEffect(()=>{const S=setTimeout(()=>{l(!0)},100);return()=>clearTimeout(S)},[]),c.useEffect(()=>{x&&t("/dashboard")},[x,t]),c.useEffect(()=>{const S=R=>{if(E.current){const B=E.current.getBoundingClientRect(),_=R.clientX-B.left,V=R.clientY-B.top;_>=0&&_<=B.width&&V>=0&&V<=B.height&&y({x:_,y:V})}};return window.addEventListener("mousemove",S),()=>{window.removeEventListener("mousemove",S)}},[]);const $=async S=>{var R;try{i(null),o(!0);const B=await Hi.login({username:S.username,password:S.password}),{user:_,token:V}=B.data;if(!_||!V)throw new Error("Invalid response from server");S.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:S.username,password:S.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),p(!0),setTimeout(()=>{s(Ya({user:_,token:V})),ee.success("Login successful!"),t("/dashboard")},1200)}catch(B){console.error("Login Error:",B),console.error("Response Data:",(R=B.response)==null?void 0:R.data);let _="Authentication Error",V="Invalid username or password.";if(B.response&&typeof B.response=="object"){const{status:Y,data:G}=B.response;Y===401?(_="Invalid Credentials",V="The username or password you entered is incorrect."):Y===403?(_="Access Denied",V="You do not have permission to access this resource."):Y===400?(_="Invalid Request",V="Please check your input and try again."):Y===500&&(_="Server Error",V="A server error occurred. Please try again later."),G&&typeof G=="object"&&G.message&&(V=G.message)}else B.request?(_="Connection Error",V="Unable to connect to the server. Please check your internet connection."):B.message&&(V=B.message);i({title:_,message:V})}finally{o(!1)}},T=Oc(j),v=Vc(T),k=Hc(T),b=localStorage.getItem("rememberUser")==="true";if(x)return e.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[e.jsx(Rr,{}),e.jsx(Rs,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const D=S=>{const R=[];for(let B=0;B<S;B++){const _=Math.random()*20+8,V=Math.random()*3,Y=Math.random()*10+6,G=Math.random()*100,H=Math.random()*100;R.push(e.jsx(Uc,{size:_,delay:V,duration:Y,top:G,left:H,style:{transform:`translate(${w.x/50*(B%5-2)}px, ${w.y/50*(B%5-2)}px)`,opacity:m?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},B))}return R},M=S=>{const R=[];for(let B=0;B<S;B++)R.push(e.jsx(bc,{index:B,isHovered:m},B));return R},F=S=>{P(S)};return e.jsxs(fc,{style:{opacity:C?1:0,transition:"opacity 0.3s ease-out"},children:[a&&e.jsx(qc,{children:e.jsx(Ji,{})}),e.jsxs(yc,{onMouseEnter:()=>F(!0),onMouseLeave:()=>F(!1),children:[e.jsx(Cc,{children:e.jsx(Ec,{children:e.jsx(Pc,{src:u,alt:"Exhibition Manager Logo",onError:()=>N("/logo.png")})})}),e.jsxs(kc,{ref:E,children:[D(12),M(8)]}),e.jsxs(Ic,{children:[e.jsx(Ac,{children:e.jsx(Nc,{children:g})}),e.jsx(Tc,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),e.jsx(Rc,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),e.jsx(jc,{children:e.jsxs(Dc,{children:[e.jsxs(Mc,{children:[e.jsx(to,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),e.jsx(Rs,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),n&&e.jsx(_e,{message:n.title,description:n.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:e.jsx(q,{size:"small",type:"text",onClick:()=>i(null),children:"Dismiss"})}),e.jsxs(L,{form:h,name:"login",initialValues:{remember:b},onFinish:$,layout:"vertical",children:[e.jsx(cn,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:e.jsx(Fc,{prefix:e.jsx(ke,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:r,autoComplete:"username"})}),e.jsx(cn,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:I&&e.jsxs(Bc,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx(Rs,{type:"secondary",children:"Password Strength:"}),e.jsx(Rs,{strong:!0,style:{color:v},children:k})]}),e.jsx(qt,{percent:T,showInfo:!1,strokeColor:v,size:"small"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(We,{title:e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Wc.map((S,R)=>e.jsx("li",{children:S},R))}),children:e.jsxs(Rs,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[e.jsx(en,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:e.jsx($c,{prefix:e.jsx(Lt,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:r,autoComplete:"current-password",onChange:S=>d(S.target.value),onFocus:()=>f(!0),onBlur:()=>f(!1)})}),e.jsx(zc,{children:e.jsx(cn,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(_c,{children:"Remember me"})})}),e.jsx(cn,{children:r?e.jsx(Rr,{}):e.jsx(Lc,{type:"primary",htmlType:"submit",block:!0,className:a?"success":"",children:"Sign in"})})]})]})})]})},{Title:Qc,Text:Qe}=ue,Gc=({title:t,value:s,icon:n,color:i,gradient:r})=>e.jsxs(K,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:r,border:"none",overflow:"hidden",position:"relative"},children:[e.jsx("div",{className:"stat-card-background"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx(Qe,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:t}),e.jsx(Qe,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:s})]}),e.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:n})]})]}),Kc=()=>{const t=Tt(),[s,n]=c.useState(!1),[i,r]=c.useState("");c.useEffect(()=>{t.state&&"unauthorized"in t.state?(n(!0),r(t.state.message||"You do not have permission to access the requested page")):(n(!1),r(""))},[t]);const o=[{title:"Total Users",value:"1,128",icon:e.jsx(ke,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:"93",icon:e.jsx(qi,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:"15,600.00",icon:e.jsx(Mo,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Reports",value:"24",icon:e.jsx(gr,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(Qc,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),s&&e.jsx(_e,{message:"Access Denied",description:i,type:"error",showIcon:!0,closable:!0,onClose:()=>n(!1),style:{marginBottom:"24px"}}),e.jsx(se,{gutter:[24,24],children:o.map((a,p)=>e.jsx(z,{xs:24,sm:12,lg:6,children:e.jsx(Gc,{...a})},p))}),e.jsxs(se,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(z,{xs:24,lg:12,children:e.jsx(K,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"activity-item",children:[e.jsx(ke,{style:{color:"#7C3AED"}}),e.jsxs(Qe,{children:["User ",e.jsx(Qe,{strong:!0,children:"'john_doe'"})," logged in"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(qi,{style:{color:"#2563EB"}}),e.jsxs(Qe,{children:["New order ",e.jsx(Qe,{strong:!0,children:"#12345"})," received"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(gr,{style:{color:"#059669"}}),e.jsxs(Qe,{children:["Product ",e.jsx(Qe,{strong:!0,children:"'Widget X'"})," updated"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(ke,{style:{color:"#DC2626"}}),e.jsxs(Qe,{children:["New user registration: ",e.jsx(Qe,{strong:!0,children:"'jane_smith'"})]})]})]})})}),e.jsx(z,{xs:24,lg:12,children:e.jsx(K,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator online"}),e.jsxs(Qe,{children:["Server Status: ",e.jsx(Qe,{strong:!0,type:"success",children:"Online"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator connected"}),e.jsxs(Qe,{children:["Database Status: ",e.jsx(Qe,{strong:!0,type:"success",children:"Connected"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator backup"}),e.jsxs(Qe,{children:["Last Backup: ",e.jsx(Qe,{strong:!0,children:"2 hours ago"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator normal"}),e.jsxs(Qe,{children:["System Load: ",e.jsx(Qe,{strong:!0,children:"Normal"})]})]})]})})})]})]})},{Title:Xc,Text:ds}=ue,Dr=[{id:"1",exhibitionName:"Tech Expo 2023",stallNumber:"A12",status:"approved",bookingDate:"2023-03-15",exhibitionDate:"2023-05-20"},{id:"2",exhibitionName:"Digital Summit",stallNumber:"B45",status:"pending",bookingDate:"2023-04-05",exhibitionDate:"2023-06-10"},{id:"3",exhibitionName:"Innovation Fair",stallNumber:"C33",status:"rejected",bookingDate:"2023-04-12",exhibitionDate:"2023-07-15"}],Zc=()=>{const[t,s]=c.useState(Dr),[n,i]=c.useState(!1),r=he(j=>j.exhibitorAuth.exhibitor);c.useEffect(()=>{i(!0),setTimeout(()=>{s(Dr),i(!1)},1e3)},[]);const o=t.filter(j=>j.status==="approved").length,a=t.filter(j=>j.status==="pending").length;t.filter(j=>j.status==="rejected").length;const p=j=>{switch(j){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx($e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ge,{})," Pending"]});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});default:return e.jsx(re,{children:"Unknown"})}};return e.jsxs("div",{children:[e.jsxs(Xc,{level:2,children:["Welcome, ",(r==null?void 0:r.companyName)||"Exhibitor"]}),e.jsx(ds,{type:"secondary",children:"Here's an overview of your exhibition activities"}),a>0&&e.jsx(_e,{message:"Pending Approvals",description:`You have ${a} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(q,{size:"small",type:"primary",children:"View Details"})}),e.jsxs(se,{gutter:[24,24],style:{marginTop:24},children:[e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{children:e.jsx(ve,{title:"Total Bookings",value:t.length,prefix:e.jsx(ht,{})})})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{children:e.jsx(ve,{title:"Approved Bookings",value:o,valueStyle:{color:"#3f8600"},prefix:e.jsx($e,{})})})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{children:e.jsx(ve,{title:"Pending Approvals",value:a,valueStyle:{color:"#faad14"},prefix:e.jsx(Ge,{})})})})]}),e.jsx(K,{title:"Recent Bookings",extra:e.jsx(it,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:n,children:e.jsx(es,{dataSource:t,renderItem:j=>e.jsxs(es.Item,{actions:[e.jsx(it,{to:`/exhibitor/bookings/${j.id}`,children:"View Details"},"view")],children:[e.jsx(es.Item.Meta,{title:e.jsxs("div",{children:[e.jsx(ds,{strong:!0,children:j.exhibitionName}),e.jsxs(ds,{type:"secondary",style:{marginLeft:12},children:["Stall: ",j.stallNumber]})]}),description:e.jsxs("div",{children:[e.jsxs(ds,{children:["Booked on: ",j.bookingDate]}),e.jsx(Ce,{type:"vertical"}),e.jsxs(ds,{children:["Exhibition date: ",j.exhibitionDate]})]})}),p(j.status)]})})}),e.jsx(K,{title:"Upcoming Exhibitions",style:{marginTop:24},children:e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(Ut,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs("div",{children:[e.jsx(ds,{children:"Explore available exhibitions and book your stall"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(it,{to:"/exhibitions",children:e.jsx(q,{type:"primary",children:"Browse Exhibitions"})})})]})]})})]})},gt={getExhibitions:()=>Yt.get("/public/exhibitions"),getExhibition:t=>Yt.get(`/public/exhibitions/${t}`),getLayout:t=>Yt.get(`/public/exhibitions/${t}/layout`),getStallDetails:(t,s)=>Yt.get(`/public/exhibitions/${t}/stalls/${s}`),bookStall:(t,s,n)=>Yt.post(`/public/exhibitions/${t}/stalls/${s}/book`,n),bookMultipleStalls:(t,s)=>Yt.post(`/public/exhibitions/${t}/stalls/book-multiple`,s),searchExhibitors:t=>Yt.get("/public/exhibitors/search",{params:{query:t}}),exhibitorBookStalls:t=>te.post(`/exhibitor-bookings/${t.exhibitionId}`,t),getExhibitorBookings:()=>te.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:t=>te.get(`/exhibitor-bookings/${t}`),cancelExhibitorBooking:t=>te.patch(`/exhibitor-bookings/${t}/cancel`),getExhibitorBookingInvoice:t=>te.get(`/exhibitor-bookings/${t}/invoice`)},{Title:Jc,Text:ed}=ue,{Option:us}=le,{TabPane:hs}=tt,{confirm:td}=ye,sd=()=>{const[t,s]=c.useState([]),[n,i]=c.useState(!1),[r,o]=c.useState(""),[a,p]=c.useState("all"),j=Se();c.useEffect(()=>{d()},[]);const d=async()=>{try{i(!0);const l=await gt.getExhibitorBookings();s(l.data)}catch(l){console.error("Error fetching bookings:",l),ee.error("Failed to load bookings. Please try again.")}finally{i(!1)}},I=l=>{td({title:"Are you sure you want to cancel this booking?",icon:e.jsx(ss,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",onOk:async()=>{try{await gt.cancelExhibitorBooking(l),ee.success("Booking cancelled successfully"),d()}catch(m){console.error("Error cancelling booking:",m),ee.error("Failed to cancel booking")}}})},f=l=>{switch(l){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx($e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ge,{})," Pending"]});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(re,{color:"blue",children:[e.jsx($e,{})," Confirmed"]});case"cancelled":return e.jsx(re,{color:"default",children:"Cancelled"});default:return e.jsx(re,{children:"Unknown"})}},x=l=>{switch(l){case"paid":return e.jsx(re,{color:"success",children:"Paid"});case"pending":return e.jsx(re,{color:"warning",children:"Pending"});case"refunded":return e.jsx(re,{color:"default",children:"Refunded"});default:return e.jsx(re,{children:"Unknown"})}},E=async l=>{try{const m=await gt.getExhibitorBookingInvoice(l);m&&m.data&&m.data._id?j(`/exhibitor/invoice/${l}`):ee.error("Invoice not found or not available")}catch(m){console.error("Error fetching invoice:",m),ee.error("Failed to retrieve invoice details")}},w=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(l,m)=>{var P;return((P=m.exhibitionId)==null?void 0:P.name)||"N/A"},sorter:(l,m)=>{var P,h;return(((P=l.exhibitionId)==null?void 0:P.name)||"").localeCompare(((h=m.exhibitionId)==null?void 0:h.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:l=>(l==null?void 0:l.map(m=>m.number).join(", "))||"N/A"},{title:"Booking Date",dataIndex:"createdAt",key:"createdAt",render:l=>Te(l).format("MMM D, YYYY"),sorter:(l,m)=>Te(l.createdAt).unix()-Te(m.createdAt).unix()},{title:"Exhibition Date",key:"exhibitionDate",render:(l,m)=>{var u,N;const P=Te((u=m.exhibitionId)==null?void 0:u.startDate).format("MMM D"),h=Te((N=m.exhibitionId)==null?void 0:N.endDate).format("MMM D, YYYY");return`${P} - ${h}`},sorter:(l,m)=>{var P,h;return Te((P=l.exhibitionId)==null?void 0:P.startDate).unix()-Te((h=m.exhibitionId)==null?void 0:h.startDate).unix()}},{title:"Status",dataIndex:"status",key:"status",render:l=>f(l),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(l,m)=>m.status===l},{title:"Payment",dataIndex:"paymentStatus",key:"paymentStatus",render:l=>x(l)},{title:"Amount",dataIndex:"amount",key:"amount",render:l=>`${l.toLocaleString()}`,sorter:(l,m)=>l.amount-m.amount},{title:"Actions",key:"action",render:(l,m)=>{const P=[{key:"view",icon:e.jsx(Mt,{}),label:"View Details",onClick:()=>j(`/exhibitor/bookings/${m._id}`)}];return["approved","confirmed"].includes(m.status)&&P.push({key:"invoice",icon:e.jsx(Ut,{}),label:"View Invoice",onClick:()=>E(m._id)}),m.status==="pending"&&P.push({key:"cancel",icon:e.jsx(ss,{}),label:"Cancel Booking",onClick:()=>I(m._id)}),e.jsx(X,{size:"middle",children:e.jsx(Ot,{overlay:e.jsx(ct,{items:P}),trigger:["click"],children:e.jsx(q,{type:"text",icon:e.jsx(si,{})})})})}}],y=l=>{o(l)},C=t.filter(l=>{var h,u;const m=(((h=l.exhibitionId)==null?void 0:h.name)||"").toLowerCase().includes(r.toLowerCase())||l.stallIds.some(N=>N.number.toLowerCase().includes(r.toLowerCase()))||(((u=l.exhibitionId)==null?void 0:u.venue)||"").toLowerCase().includes(r.toLowerCase()),P=a==="all"||l.status===a;return m&&P});return e.jsxs("div",{children:[e.jsx(Jc,{level:2,children:"My Bookings"}),e.jsx(ed,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),e.jsx(K,{style:{marginTop:24},children:e.jsxs(tt,{defaultActiveKey:"all",children:[e.jsxs(hs,{tab:"All Bookings",children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsxs(X,{children:[e.jsx(Q,{placeholder:"Search by exhibition, stall, or venue",prefix:e.jsx(Bt,{}),style:{width:300},onChange:l=>y(l.target.value),value:r}),e.jsxs(le,{defaultValue:"all",style:{width:120},onChange:l=>p(l),children:[e.jsx(us,{value:"all",children:"All Status"}),e.jsx(us,{value:"approved",children:"Approved"}),e.jsx(us,{value:"pending",children:"Pending"}),e.jsx(us,{value:"rejected",children:"Rejected"}),e.jsx(us,{value:"confirmed",children:"Confirmed"}),e.jsx(us,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(it,{to:"/exhibitions",children:e.jsx(q,{type:"primary",children:"Book New Stall"})})]}),e.jsx(De,{columns:w,dataSource:C,rowKey:"_id",pagination:{pageSize:10},loading:n})]},"all"),e.jsx(hs,{tab:"Pending",children:e.jsx(De,{columns:w,dataSource:t.filter(l=>l.status==="pending"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"pending"),e.jsx(hs,{tab:"Approved",children:e.jsx(De,{columns:w,dataSource:t.filter(l=>l.status==="approved"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"approved"),e.jsx(hs,{tab:"Confirmed",children:e.jsx(De,{columns:w,dataSource:t.filter(l=>l.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"confirmed"),e.jsx(hs,{tab:"Rejected",children:e.jsx(De,{columns:w,dataSource:t.filter(l=>l.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"rejected"),e.jsx(hs,{tab:"Cancelled",children:e.jsx(De,{columns:w,dataSource:t.filter(l=>l.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"cancelled")]})})]})},{Title:Fr,Text:ui}=ue,nd=()=>{var f,x,E,w,y,C,l,m,P,h,u,N,g;const{id:t}=pt(),s=Se(),[n,i]=c.useState(null),[r,o]=c.useState(!0);c.useEffect(()=>{a()},[t]);const a=async()=>{try{o(!0);const A=await gt.getExhibitorBooking(t||"");i(A.data)}catch(A){console.error("Error fetching booking details:",A),ee.error("Failed to load booking details")}finally{o(!1)}},p=async()=>{try{s(`/exhibitor/invoice/${t}`)}catch(A){console.error("Error fetching invoice:",A),ee.error("Failed to retrieve invoice")}},j=A=>{switch(A){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx($e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ge,{})," Pending"]});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(re,{color:"blue",children:[e.jsx($e,{})," Confirmed"]});case"cancelled":return e.jsx(re,{color:"default",children:"Cancelled"});default:return e.jsx(re,{children:"Unknown"})}},d=A=>{switch(A){case"paid":return e.jsx(re,{color:"success",children:"Paid"});case"pending":return e.jsx(re,{color:"warning",children:"Pending"});case"refunded":return e.jsx(re,{color:"default",children:"Refunded"});default:return e.jsx(re,{children:"Unknown"})}},I=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:A=>`${A.dimensions.width}m  ${A.dimensions.height}m`},{title:"Size",key:"size",render:A=>`${A.dimensions.width*A.dimensions.height} m`},{title:"Rate per m",dataIndex:"ratePerSqm",key:"ratePerSqm",render:A=>`${A.toLocaleString()}`},{title:"Amount",key:"amount",render:(A,$,T)=>{var k;const v=(k=n.calculations)==null?void 0:k.stalls[T];return v?`${v.baseAmount.toLocaleString()}`:"N/A"}}];return r?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(Nt,{size:"large"})}):n?e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>s("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(n.status)&&e.jsx(q,{type:"primary",icon:e.jsx(Ut,{}),onClick:p,children:"View Invoice"})]}),e.jsxs(K,{title:"Booking Details",style:{marginBottom:20},children:[e.jsxs(xe,{bordered:!0,column:{xs:1,sm:2,md:3},children:[e.jsx(xe.Item,{label:"Booking ID",children:n._id}),e.jsx(xe.Item,{label:"Exhibition",children:((f=n.exhibitionId)==null?void 0:f.name)||"N/A"}),e.jsx(xe.Item,{label:"Venue",children:((x=n.exhibitionId)==null?void 0:x.venue)||"N/A"}),e.jsx(xe.Item,{label:"Booking Date",children:Te(n.createdAt).format("MMM D, YYYY")}),e.jsxs(xe.Item,{label:"Exhibition Dates",children:[Te((E=n.exhibitionId)==null?void 0:E.startDate).format("MMM D, YYYY")," -",Te((w=n.exhibitionId)==null?void 0:w.endDate).format("MMM D, YYYY")]}),e.jsx(xe.Item,{label:"Status",children:j(n.status)}),e.jsx(xe.Item,{label:"Payment Status",children:d(n.paymentStatus||"pending")}),e.jsxs(xe.Item,{label:"Total Amount",children:["",((y=n.amount)==null?void 0:y.toLocaleString())||"N/A"]})]}),n.rejectionReason&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(Fr,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),e.jsx(ui,{children:n.rejectionReason})]})]}),e.jsx(K,{title:"Stall Details",style:{marginBottom:20},children:e.jsx(De,{dataSource:n.stallIds||[],columns:I,rowKey:"_id",pagination:!1})}),e.jsx(K,{title:"Calculation Summary",children:e.jsx(se,{gutter:[16,16],children:e.jsx(z,{span:24,children:e.jsxs(xe,{bordered:!0,column:1,children:[e.jsxs(xe.Item,{label:"Base Amount",children:["",((C=n.calculations)==null?void 0:C.totalBaseAmount.toLocaleString())||"N/A"]}),((l=n.calculations)==null?void 0:l.totalDiscountAmount)>0&&e.jsxs(xe.Item,{label:"Discount",children:["- ",((m=n.calculations)==null?void 0:m.totalDiscountAmount.toLocaleString())||"N/A"]}),((P=n.calculations)==null?void 0:P.totalDiscountAmount)>0&&e.jsxs(xe.Item,{label:"Amount After Discount",children:["",((h=n.calculations)==null?void 0:h.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(N=(u=n.calculations)==null?void 0:u.taxes)==null?void 0:N.map(A=>e.jsxs(xe.Item,{label:`${A.name} (${A.rate}%)`,children:["+ ",A.amount.toLocaleString()||"N/A"]},A.name)),e.jsx(xe.Item,{label:"Total Amount",children:e.jsxs(ui,{strong:!0,style:{fontSize:"16px"},children:["",((g=n.amount)==null?void 0:g.toLocaleString())||"N/A"]})})]})})})}),e.jsx(K,{title:"Customer Information",style:{marginTop:20},children:e.jsxs(xe,{bordered:!0,column:{xs:1,sm:2},children:[e.jsx(xe.Item,{label:"Company Name",children:n.companyName}),e.jsx(xe.Item,{label:"Contact Person",children:n.customerName}),e.jsx(xe.Item,{label:"Email",children:n.customerEmail}),e.jsx(xe.Item,{label:"Phone",children:n.customerPhone})]})})]}):e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[e.jsx(Fr,{level:3,children:"Booking Not Found"}),e.jsx(ui,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),e.jsx("div",{style:{marginTop:20},children:e.jsx(q,{type:"primary",onClick:()=>s("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},id=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",lr=id?"https://aakardata.in/api":"http://localhost:5000/api",rd="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5",Wi=ls.create({baseURL:lr}),ps=ls.create({baseURL:lr});Wi.interceptors.request.use(t=>{const s=localStorage.getItem("exhibitor_token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));const Xt=ls.create({baseURL:lr});Xt.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));const Ze={sendRegistrationOTP:async t=>await ps.post("/exhibitors/send-otp",{email:t}),verifyOTP:async t=>await ps.post("/exhibitors/verify-otp",t),register:async t=>await ps.post("/exhibitors/register",t),login:async t=>await ps.post("/exhibitors/login",t),requestPasswordReset:async t=>await ps.post("/exhibitors/forgot-password",t),resetPassword:async t=>await ps.post("/exhibitors/reset-password",t),getProfile:async()=>await Wi.get("/exhibitors/profile"),updateProfile:async t=>await Wi.put("/exhibitors/profile",t),getExhibitors:async()=>await Xt.get("/exhibitors/admin/exhibitors"),getExhibitor:async t=>await Xt.get(`/exhibitors/admin/exhibitors/${t}`),createExhibitor:async t=>await Xt.post("/exhibitors/admin/exhibitors",t),updateStatus:async(t,s,n)=>await Xt.put(`/exhibitors/admin/exhibitors/${t}/status`,{status:s,rejectionReason:n}),updateExhibitor:async(t,s)=>await Xt.put(`/exhibitors/admin/exhibitors/${t}`,s),deleteExhibitor:async t=>await Xt.delete(`/exhibitors/admin/exhibitors/${t}`)},{Title:$r,Text:Lr}=ue,{TabPane:Mr}=tt,ad=()=>{var j;const[t]=L.useForm(),[s,n]=c.useState(!1),[i,r]=c.useState(!1),o=Ie(),a=he(d=>d.exhibitorAuth.exhibitor);c.useEffect(()=>{(async()=>{try{r(!0);const I=await Ze.getProfile();I.data&&o(Vi({exhibitor:I.data,token:(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||""}))}catch{ee.error("Failed to fetch exhibitor profile")}finally{r(!1)}})()},[o]),c.useEffect(()=>{a&&t.setFieldsValue({companyName:a.companyName||"",contactPerson:a.contactPerson||"",email:a.email||"",phone:a.phone||"",address:a.address||"",website:a.website||"",description:a.description||"",panNumber:a.panNumber||"",gstNumber:a.gstNumber||"",city:a.city||"",state:a.state||"",pinCode:a.pinCode||""})},[a,t]);const p=async d=>{try{n(!0);const I=await Ze.updateProfile(d),f=(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||"";o(Vi({exhibitor:{...a,...d},token:f})),ee.success("Profile updated successfully")}catch{ee.error("Failed to update profile")}finally{n(!1)}};return e.jsxs("div",{children:[e.jsx($r,{level:2,children:"My Profile"}),e.jsx(Lr,{type:"secondary",children:"Manage your exhibitor profile information"}),e.jsx(K,{style:{marginTop:24},loading:i,children:e.jsxs(tt,{defaultActiveKey:"profile",children:[e.jsx(Mr,{tab:"Profile Information",children:e.jsxs(se,{gutter:32,children:[e.jsx(z,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(yt,{size:100,icon:e.jsx(ke,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((j=a==null?void 0:a.companyName)==null?void 0:j.charAt(0).toUpperCase())||"E"}),e.jsx($r,{level:4,children:a==null?void 0:a.companyName}),e.jsx(Lr,{type:"secondary",children:a==null?void 0:a.email})]})}),e.jsx(z,{span:18,children:e.jsxs(L,{form:t,layout:"vertical",onFinish:p,initialValues:{companyName:(a==null?void 0:a.companyName)||"",contactPerson:(a==null?void 0:a.contactPerson)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",address:(a==null?void 0:a.address)||"",website:(a==null?void 0:a.website)||"",description:(a==null?void 0:a.description)||"",panNumber:(a==null?void 0:a.panNumber)||"",gstNumber:(a==null?void 0:a.gstNumber)||"",city:(a==null?void 0:a.city)||"",state:(a==null?void 0:a.state)||"",pinCode:(a==null?void 0:a.pinCode)||""},children:[e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:e.jsx(Q,{prefix:e.jsx(er,{}),placeholder:"Company Name"})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:e.jsx(Q,{prefix:e.jsx(ke,{}),placeholder:"Contact Person"})})})]}),e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{prefix:e.jsx(zt,{}),placeholder:"Email",disabled:!0})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:e.jsx(Q,{prefix:e.jsx(tr,{}),placeholder:"Phone Number"})})})]}),e.jsx(L.Item,{name:"address",label:"Address",children:e.jsx(Q.TextArea,{rows:2,placeholder:"Company Address"})}),e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:8,children:e.jsx(L.Item,{name:"city",label:"City",children:e.jsx(Q,{placeholder:"City"})})}),e.jsx(z,{span:8,children:e.jsx(L.Item,{name:"state",label:"State",children:e.jsx(Q,{placeholder:"State"})})}),e.jsx(z,{span:8,children:e.jsx(L.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(Q,{placeholder:"PIN Code",maxLength:6})})})]}),e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(Q,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(Q,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),e.jsx(L.Item,{name:"website",label:"Website",children:e.jsx(Q,{placeholder:"https://www.yourcompany.com"})}),e.jsx(L.Item,{name:"description",label:"Company Description",children:e.jsx(Q.TextArea,{rows:4,placeholder:"Brief description of your company"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",loading:s,icon:e.jsx(as,{}),children:"Save Changes"})})]})})]})},"profile"),e.jsx(Mr,{tab:"Change Password",children:e.jsxs(L,{layout:"vertical",onFinish:d=>{ee.success("Password updated successfully")},children:[e.jsx(L.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(Q.Password,{placeholder:"Current Password"})}),e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(Q.Password,{placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:d})=>({validator(I,f){return!f||d("newPassword")===f?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(Q.Password,{placeholder:"Confirm New Password"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var od=class extends Error{constructor(s){super(s[0].message);mr(this,"issues");this.name="SchemaError",this.issues=s}},no=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))(no||{});function Br(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var zr=Ks;function io(t,s){if(t===s||!(zr(t)&&zr(s)||Array.isArray(t)&&Array.isArray(s)))return s;const n=Object.keys(s),i=Object.keys(t);let r=n.length===i.length;const o=Array.isArray(s)?[]:{};for(const a of n)o[a]=io(t[a],s[a]),r&&(r=t[a]===o[a]);return r?t:o}function ks(t){let s=0;for(const n in t)s++;return s}var _r=t=>[].concat(...t);function ld(t){return new RegExp("(^|:)//").test(t)}function cd(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function Zn(t){return t!=null}function dd(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var ud=t=>t.replace(/\/$/,""),hd=t=>t.replace(/^\//,"");function pd(t,s){if(!t)return s;if(!s)return t;if(ld(s))return s;const n=t.endsWith("/")||!s.startsWith("?")?"/":"";return t=ud(t),s=hd(s),`${t}${n}${s}`}function xd(t,s,n){return t.has(s)?t.get(s):t.set(s,n).get(s)}var qr=(...t)=>fetch(...t),md=t=>t.status>=200&&t.status<=299,gd=t=>/ion\/(vnd\.api\+)?json/.test(t.get("content-type")||"");function Ur(t){if(!Ks(t))return t;const s={...t};for(const[n,i]of Object.entries(s))i===void 0&&delete s[n];return s}function cr({baseUrl:t,prepareHeaders:s=f=>f,fetchFn:n=qr,paramsSerializer:i,isJsonContentType:r=gd,jsonContentType:o="application/json",jsonReplacer:a,timeout:p,responseHandler:j,validateStatus:d,...I}={}){return typeof fetch>"u"&&n===qr&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(x,E,w)=>{const{getState:y,extra:C,endpoint:l,forced:m,type:P}=E;let h,{url:u,headers:N=new Headers(I.headers),params:g=void 0,responseHandler:A=j??"json",validateStatus:$=d??md,timeout:T=p,...v}=typeof x=="string"?{url:x}:x,k,b=E.signal;T&&(k=new AbortController,E.signal.addEventListener("abort",k.abort),b=k.signal);let D={...I,signal:b,...v};N=new Headers(Ur(N)),D.headers=await s(N,{getState:y,arg:x,extra:C,endpoint:l,forced:m,type:P,extraOptions:w})||N;const M=H=>typeof H=="object"&&(Ks(H)||Array.isArray(H)||typeof H.toJSON=="function");if(!D.headers.has("content-type")&&M(D.body)&&D.headers.set("content-type",o),M(D.body)&&r(D.headers)&&(D.body=JSON.stringify(D.body,a)),g){const H=~u.indexOf("?")?"&":"?",U=i?i(g):new URLSearchParams(Ur(g));u+=H+U}u=pd(t,u);const F=new Request(u,D);h={request:new Request(u,D)};let R,B=!1,_=k&&setTimeout(()=>{B=!0,k.abort()},T);try{R=await n(F)}catch(H){return{error:{status:B?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(H)},meta:h}}finally{_&&clearTimeout(_),k==null||k.signal.removeEventListener("abort",k.abort)}const V=R.clone();h.response=V;let Y,G="";try{let H;if(await Promise.all([f(R,A).then(U=>Y=U,U=>H=U),V.text().then(U=>G=U,()=>{})]),H)throw H}catch(H){return{error:{status:"PARSING_ERROR",originalStatus:R.status,data:G,error:String(H)},meta:h}}return $(R,Y)?{data:Y,meta:h}:{error:{status:R.status,data:Y},meta:h}};async function f(x,E){if(typeof E=="function")return E(x);if(E==="content-type"&&(E=r(x.headers)?"json":"text"),E==="json"){const w=await x.text();return w.length?JSON.parse(w):null}return x.text()}}var Or=class{constructor(t,s=void 0){this.value=t,this.meta=s}},dr=Ps("__rtkq/focused"),ro=Ps("__rtkq/unfocused"),ur=Ps("__rtkq/online"),ao=Ps("__rtkq/offline");function ri(t){return t.type==="query"}function fd(t){return t.type==="mutation"}function ai(t){return t.type==="infinitequery"}function Jn(t){return ri(t)||ai(t)}function hr(t,s,n,i,r,o){return yd(t)?t(s,n,i,r).filter(Zn).map(Yi).map(o):Array.isArray(t)?t.map(Yi).map(o):[]}function yd(t){return typeof t=="function"}function Yi(t){return typeof t=="string"?{type:t}:t}function bd(t,s){return t.catch(s)}var Zs=Symbol("forceQueryFn"),Qi=t=>typeof t[Zs]=="function";function jd({serializeQueryArgs:t,queryThunk:s,infiniteQueryThunk:n,mutationThunk:i,api:r,context:o}){const a=new Map,p=new Map,{unsubscribeQueryResult:j,removeMutationResult:d,updateSubscriptionOptions:I}=r.internalActions;return{buildInitiateQuery:C,buildInitiateInfiniteQuery:l,buildInitiateMutation:m,getRunningQueryThunk:f,getRunningMutationThunk:x,getRunningQueriesThunk:E,getRunningMutationsThunk:w};function f(P,h){return u=>{var A;const N=o.endpointDefinitions[P],g=t({queryArgs:h,endpointDefinition:N,endpointName:P});return(A=a.get(u))==null?void 0:A[g]}}function x(P,h){return u=>{var N;return(N=p.get(u))==null?void 0:N[h]}}function E(){return P=>Object.values(a.get(P)||{}).filter(Zn)}function w(){return P=>Object.values(p.get(P)||{}).filter(Zn)}function y(P,h){const u=(N,{subscribe:g=!0,forceRefetch:A,subscriptionOptions:$,[Zs]:T,...v}={})=>(k,b)=>{var W;const D=t({queryArgs:N,endpointDefinition:h,endpointName:P});let M;const F={...v,type:"query",subscribe:g,forceRefetch:A,subscriptionOptions:$,endpointName:P,originalArgs:N,queryCacheKey:D,[Zs]:T};if(ri(h))M=s(F);else{const{direction:J,initialPageParam:de}=v;M=n({...F,direction:J,initialPageParam:de})}const S=r.endpoints[P].select(N),R=k(M),B=S(b()),{requestId:_,abort:V}=R,Y=B.requestId!==_,G=(W=a.get(k))==null?void 0:W[D],H=()=>S(b()),U=Object.assign(T?R.then(H):Y&&!G?Promise.resolve(B):Promise.all([G,R]).then(H),{arg:N,requestId:_,subscriptionOptions:$,queryCacheKey:D,abort:V,async unwrap(){const J=await U;if(J.isError)throw J.error;return J.data},refetch:()=>k(u(N,{subscribe:!1,forceRefetch:!0})),unsubscribe(){g&&k(j({queryCacheKey:D,requestId:_}))},updateSubscriptionOptions(J){U.subscriptionOptions=J,k(I({endpointName:P,requestId:_,queryCacheKey:D,options:J}))}});if(!G&&!Y&&!T){const J=xd(a,k,{});J[D]=U,U.then(()=>{delete J[D],ks(J)||a.delete(k)})}return U};return u}function C(P,h){return y(P,h)}function l(P,h){return y(P,h)}function m(P){return(h,{track:u=!0,fixedCacheKey:N}={})=>(g,A)=>{const $=i({type:"mutation",endpointName:P,originalArgs:h,track:u,fixedCacheKey:N}),T=g($),{requestId:v,abort:k,unwrap:b}=T,D=bd(T.unwrap().then(R=>({data:R})),R=>({error:R})),M=()=>{g(d({requestId:v,fixedCacheKey:N}))},F=Object.assign(D,{arg:T.arg,requestId:v,abort:k,unwrap:b,reset:M}),S=p.get(g)||{};return p.set(g,S),S[v]=F,F.then(()=>{delete S[v],ks(S)||p.delete(g)}),N&&(S[N]=F,F.then(()=>{S[N]===F&&(delete S[N],ks(S)||p.delete(g))})),F}}}var oo=class extends od{constructor(t,s,n,i){super(t),this.value=s,this.schemaName=n,this._bqMeta=i}};async function Qt(t,s,n,i){const r=await t["~standard"].validate(s);if(r.issues)throw new oo(r.issues,s,n,i);return r.value}function vd(t){return t}var Ds=(t={})=>({...t,[Ua]:!0});function wd({reducerPath:t,baseQuery:s,context:{endpointDefinitions:n},serializeQueryArgs:i,api:r,assertTagType:o,selectors:a,onSchemaFailure:p,catchSchemaFailure:j,skipSchemaValidation:d}){const I=(v,k,b,D)=>(M,F)=>{const S=n[v],R=i({queryArgs:k,endpointDefinition:S,endpointName:v});if(M(r.internalActions.queryResultPatched({queryCacheKey:R,patches:b})),!D)return;const B=r.endpoints[v].select(k)(F()),_=hr(S.providesTags,B.data,void 0,k,{},o);M(r.internalActions.updateProvidedBy([{queryCacheKey:R,providedTags:_}]))};function f(v,k,b=0){const D=[k,...v];return b&&D.length>b?D.slice(0,-1):D}function x(v,k,b=0){const D=[...v,k];return b&&D.length>b?D.slice(1):D}const E=(v,k,b,D=!0)=>(M,F)=>{const R=r.endpoints[v].select(k)(F()),B={patches:[],inversePatches:[],undo:()=>M(r.util.patchQueryData(v,k,B.inversePatches,D))};if(R.status==="uninitialized")return B;let _;if("data"in R)if(xl(R.data)){const[V,Y,G]=Va(R.data,b);B.patches.push(...Y),B.inversePatches.push(...G),_=V}else _=b(R.data),B.patches.push({op:"replace",path:[],value:_}),B.inversePatches.push({op:"replace",path:[],value:R.data});return B.patches.length===0||M(r.util.patchQueryData(v,k,B.patches,D)),B},w=(v,k,b)=>D=>D(r.endpoints[v].initiate(k,{subscribe:!1,forceRefetch:!0,[Zs]:()=>({data:b})})),y=(v,k)=>v.query&&v[k]?v[k]:vd,C=async(v,{signal:k,abort:b,rejectWithValue:D,fulfillWithValue:M,dispatch:F,getState:S,extra:R})=>{var Y,G;const B=n[v.endpointName],{metaSchema:_,skipSchemaValidation:V=d}=B;try{let H=y(B,"transformResponse");const U={signal:k,abort:b,dispatch:F,getState:S,extra:R,endpoint:v.endpointName,type:v.type,forced:v.type==="query"?l(v,S()):void 0,queryCacheKey:v.type==="query"?v.queryCacheKey:void 0},W=v.type==="query"?v[Zs]:void 0;let J;const de=async(ae,ne,ge,Ye)=>{if(ne==null&&ae.pages.length)return Promise.resolve({data:ae});const O={queryArg:v.originalArgs,pageParam:ne},ie=await ce(O),me=Ye?f:x;return{data:{pages:me(ae.pages,ie.data,ge),pageParams:me(ae.pageParams,ne,ge)},meta:ie.meta}};async function ce(ae){let ne;const{extraOptions:ge,argSchema:Ye,rawResponseSchema:O,responseSchema:ie}=B;if(Ye&&!V&&(ae=await Qt(Ye,ae,"argSchema",{})),W?ne=W():B.query?ne=await s(B.query(ae),U,ge):ne=await B.queryFn(ae,U,ge,Ue=>s(Ue,U,ge)),typeof process<"u",ne.error)throw new Or(ne.error,ne.meta);let{data:me}=ne;O&&!V&&(me=await Qt(O,ne.data,"rawResponseSchema",ne.meta));let Ae=await H(me,ne.meta,ae);return ie&&!V&&(Ae=await Qt(ie,Ae,"responseSchema",ne.meta)),{...ne,data:Ae}}if(v.type==="query"&&"infiniteQueryOptions"in B){const{infiniteQueryOptions:ae}=B,{maxPages:ne=1/0}=ae;let ge;const Ye={pages:[],pageParams:[]},O=(Y=a.selectQueryEntry(S(),v.queryCacheKey))==null?void 0:Y.data,me=l(v,S())&&!v.direction||!O?Ye:O;if("direction"in v&&v.direction&&me.pages.length){const Ae=v.direction==="backward",at=(Ae?lo:Gi)(ae,me);ge=await de(me,at,ne,Ae)}else{const{initialPageParam:Ae=ae.initialPageParam}=v,Ue=(O==null?void 0:O.pageParams)??[],at=Ue[0]??Ae,As=Ue.length;ge=await de(me,at,ne),W&&(ge={data:ge.data.pages[0]});for(let oe=1;oe<As;oe++){const fe=Gi(ae,ge.data);ge=await de(ge.data,fe,ne)}}J=ge}else J=await ce(v.originalArgs);return _&&!V&&J.meta&&(J.meta=await Qt(_,J.meta,"metaSchema",J.meta)),M(J.data,Ds({fulfilledTimeStamp:Date.now(),baseQueryMeta:J.meta}))}catch(H){let U=H;if(U instanceof Or){let W=y(B,"transformErrorResponse");const{rawErrorResponseSchema:J,errorResponseSchema:de}=B;let{value:ce,meta:ae}=U;try{J&&!V&&(ce=await Qt(J,ce,"rawErrorResponseSchema",ae)),_&&!V&&(ae=await Qt(_,ae,"metaSchema",ae));let ne=await W(ce,ae,v.originalArgs);return de&&!V&&(ne=await Qt(de,ne,"errorResponseSchema",ae)),D(ne,Ds({baseQueryMeta:ae}))}catch(ne){U=ne}}try{if(U instanceof oo){const W={endpoint:v.endpointName,arg:v.originalArgs,type:v.type,queryCacheKey:v.type==="query"?v.queryCacheKey:void 0};(G=B.onSchemaFailure)==null||G.call(B,U,W),p==null||p(U,W);const{catchSchemaFailure:J=j}=B;if(J)return D(J(U,W),Ds({baseQueryMeta:U._bqMeta}))}}catch(W){U=W}throw console.error(U),U}};function l(v,k){const b=a.selectQueryEntry(k,v.queryCacheKey),D=a.selectConfig(k).refetchOnMountOrArgChange,M=b==null?void 0:b.fulfilledTimeStamp,F=v.forceRefetch??(v.subscribe&&D);return F?F===!0||(Number(new Date)-Number(M))/1e3>=F:!1}const m=()=>we(`${t}/executeQuery`,C,{getPendingMeta({arg:k}){const b=n[k.endpointName];return Ds({startedTimeStamp:Date.now(),...ai(b)?{direction:k.direction}:{}})},condition(k,{getState:b}){var V;const D=b(),M=a.selectQueryEntry(D,k.queryCacheKey),F=M==null?void 0:M.fulfilledTimeStamp,S=k.originalArgs,R=M==null?void 0:M.originalArgs,B=n[k.endpointName],_=k.direction;return Qi(k)?!0:(M==null?void 0:M.status)==="pending"?!1:l(k,D)||ri(B)&&((V=B==null?void 0:B.forceRefetch)!=null&&V.call(B,{currentArg:S,previousArg:R,endpointState:M,state:D}))?!0:!(F&&!_)},dispatchConditionRejection:!0}),P=m(),h=m(),u=we(`${t}/executeMutation`,C,{getPendingMeta(){return Ds({startedTimeStamp:Date.now()})}}),N=v=>"force"in v,g=v=>"ifOlderThan"in v,A=(v,k,b)=>(D,M)=>{const F=N(b)&&b.force,S=g(b)&&b.ifOlderThan,R=(_=!0)=>{const V={forceRefetch:_,isPrefetch:!0};return r.endpoints[v].initiate(k,V)},B=r.endpoints[v].select(k)(M());if(F)D(R());else if(S){const _=B==null?void 0:B.fulfilledTimeStamp;if(!_){D(R());return}(Number(new Date)-Number(new Date(_)))/1e3>=S&&D(R())}else D(R(!1))};function $(v){return k=>{var b,D;return((D=(b=k==null?void 0:k.meta)==null?void 0:b.arg)==null?void 0:D.endpointName)===v}}function T(v,k){return{matchPending:li(Oa(v),$(k)),matchFulfilled:li(is(v),$(k)),matchRejected:li(rr(v),$(k))}}return{queryThunk:P,mutationThunk:u,infiniteQueryThunk:h,prefetch:A,updateQueryData:E,upsertQueryData:w,patchQueryData:I,buildMatchThunkActions:T}}function Gi(t,{pages:s,pageParams:n}){const i=s.length-1;return t.getNextPageParam(s[i],s,n[i],n)}function lo(t,{pages:s,pageParams:n}){var i;return(i=t.getPreviousPageParam)==null?void 0:i.call(t,s[0],s,n[0],n)}function co(t,s,n,i){return hr(n[t.meta.arg.endpointName][s],is(t)?t.payload:void 0,ir(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,i)}function dn(t,s,n){const i=t[s];i&&n(i)}function Js(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function Vr(t,s,n){const i=t[Js(s)];i&&n(i)}var un={};function Sd({reducerPath:t,queryThunk:s,mutationThunk:n,serializeQueryArgs:i,context:{endpointDefinitions:r,apiUid:o,extractRehydrationInfo:a,hasRehydrationInfo:p},assertTagType:j,config:d}){const I=Ps(`${t}/resetApiState`);function f($,T,v,k){var b;$[b=T.queryCacheKey]??($[b]={status:"uninitialized",endpointName:T.endpointName}),dn($,T.queryCacheKey,D=>{D.status="pending",D.requestId=v&&D.requestId?D.requestId:k.requestId,T.originalArgs!==void 0&&(D.originalArgs=T.originalArgs),D.startedTimeStamp=k.startedTimeStamp;const M=r[k.arg.endpointName];ai(M)&&"direction"in T&&(D.direction=T.direction)})}function x($,T,v,k){dn($,T.arg.queryCacheKey,b=>{if(b.requestId!==T.requestId&&!k)return;const{merge:D}=r[T.arg.endpointName];if(b.status="fulfilled",D)if(b.data!==void 0){const{fulfilledTimeStamp:M,arg:F,baseQueryMeta:S,requestId:R}=T;let B=nr(b.data,_=>D(_,v,{arg:F.originalArgs,baseQueryMeta:S,fulfilledTimeStamp:M,requestId:R}));b.data=B}else b.data=v;else b.data=r[T.arg.endpointName].structuralSharing??!0?io(gl(b.data)?fl(b.data):b.data,v):v;delete b.error,b.fulfilledTimeStamp=T.fulfilledTimeStamp})}const E=nt({name:`${t}/queries`,initialState:un,reducers:{removeQueryResult:{reducer($,{payload:{queryCacheKey:T}}){delete $[T]},prepare:Ts()},cacheEntriesUpserted:{reducer($,T){for(const v of T.payload){const{queryDescription:k,value:b}=v;f($,k,!0,{arg:k,requestId:T.meta.requestId,startedTimeStamp:T.meta.timestamp}),x($,{arg:k,requestId:T.meta.requestId,fulfilledTimeStamp:T.meta.timestamp,baseQueryMeta:{}},b,!0)}},prepare:$=>({payload:$.map(k=>{const{endpointName:b,arg:D,value:M}=k,F=r[b];return{queryDescription:{type:"query",endpointName:b,originalArgs:k.arg,queryCacheKey:i({queryArgs:D,endpointDefinition:F,endpointName:b})},value:M}}),meta:{[Ua]:!0,requestId:za(),timestamp:Date.now()}})},queryResultPatched:{reducer($,{payload:{queryCacheKey:T,patches:v}}){dn($,T,k=>{k.data=Sr(k.data,v.concat())})},prepare:Ts()}},extraReducers($){$.addCase(s.pending,(T,{meta:v,meta:{arg:k}})=>{const b=Qi(k);f(T,k,b,v)}).addCase(s.fulfilled,(T,{meta:v,payload:k})=>{const b=Qi(v.arg);x(T,v,k,b)}).addCase(s.rejected,(T,{meta:{condition:v,arg:k,requestId:b},error:D,payload:M})=>{dn(T,k.queryCacheKey,F=>{if(!v){if(F.requestId!==b)return;F.status="rejected",F.error=M??D}})}).addMatcher(p,(T,v)=>{const{queries:k}=a(v);for(const[b,D]of Object.entries(k))((D==null?void 0:D.status)==="fulfilled"||(D==null?void 0:D.status)==="rejected")&&(T[b]=D)})}}),w=nt({name:`${t}/mutations`,initialState:un,reducers:{removeMutationResult:{reducer($,{payload:T}){const v=Js(T);v in $&&delete $[v]},prepare:Ts()}},extraReducers($){$.addCase(n.pending,(T,{meta:v,meta:{requestId:k,arg:b,startedTimeStamp:D}})=>{b.track&&(T[Js(v)]={requestId:k,status:"pending",endpointName:b.endpointName,startedTimeStamp:D})}).addCase(n.fulfilled,(T,{payload:v,meta:k})=>{k.arg.track&&Vr(T,k,b=>{b.requestId===k.requestId&&(b.status="fulfilled",b.data=v,b.fulfilledTimeStamp=k.fulfilledTimeStamp)})}).addCase(n.rejected,(T,{payload:v,error:k,meta:b})=>{b.arg.track&&Vr(T,b,D=>{D.requestId===b.requestId&&(D.status="rejected",D.error=v??k)})}).addMatcher(p,(T,v)=>{const{mutations:k}=a(v);for(const[b,D]of Object.entries(k))((D==null?void 0:D.status)==="fulfilled"||(D==null?void 0:D.status)==="rejected")&&b!==(D==null?void 0:D.requestId)&&(T[b]=D)})}}),y={tags:{},keys:{}},C=nt({name:`${t}/invalidation`,initialState:y,reducers:{updateProvidedBy:{reducer($,T){var v,k,b;for(const{queryCacheKey:D,providedTags:M}of T.payload){l($,D);for(const{type:F,id:S}of M){const R=(k=(v=$.tags)[F]??(v[F]={}))[b=S||"__internal_without_id"]??(k[b]=[]);R.includes(D)||R.push(D)}$.keys[D]=M}},prepare:Ts()}},extraReducers($){$.addCase(E.actions.removeQueryResult,(T,{payload:{queryCacheKey:v}})=>{l(T,v)}).addMatcher(p,(T,v)=>{var b,D,M;const{provided:k}=a(v);for(const[F,S]of Object.entries(k))for(const[R,B]of Object.entries(S)){const _=(D=(b=T.tags)[F]??(b[F]={}))[M=R||"__internal_without_id"]??(D[M]=[]);for(const V of B)_.includes(V)||_.push(V)}}).addMatcher(Kn(is(s),ir(s)),(T,v)=>{m(T,[v])}).addMatcher(E.actions.cacheEntriesUpserted.match,(T,v)=>{const k=v.payload.map(({queryDescription:b,value:D})=>({type:"UNKNOWN",payload:D,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:b}}));m(T,k)})}});function l($,T){var k;const v=$.keys[T]??[];for(const b of v){const D=b.type,M=b.id??"__internal_without_id",F=(k=$.tags[D])==null?void 0:k[M];F&&($.tags[D][M]=F.filter(S=>S!==T))}delete $.keys[T]}function m($,T){const v=T.map(k=>{const b=co(k,"providesTags",r,j),{queryCacheKey:D}=k.meta.arg;return{queryCacheKey:D,providedTags:b}});C.caseReducers.updateProvidedBy($,C.actions.updateProvidedBy(v))}const P=nt({name:`${t}/subscriptions`,initialState:un,reducers:{updateSubscriptionOptions($,T){},unsubscribeQueryResult($,T){},internal_getRTKQSubscriptions(){}}}),h=nt({name:`${t}/internalSubscriptions`,initialState:un,reducers:{subscriptionsUpdated:{reducer($,T){return Sr($,T.payload)},prepare:Ts()}}}),u=nt({name:`${t}/config`,initialState:{online:dd(),focused:cd(),middlewareRegistered:!1,...d},reducers:{middlewareRegistered($,{payload:T}){$.middlewareRegistered=$.middlewareRegistered==="conflict"||o!==T?"conflict":!0}},extraReducers:$=>{$.addCase(ur,T=>{T.online=!0}).addCase(ao,T=>{T.online=!1}).addCase(dr,T=>{T.focused=!0}).addCase(ro,T=>{T.focused=!1}).addMatcher(p,T=>({...T}))}}),N=pl({queries:E.reducer,mutations:w.reducer,provided:C.reducer,subscriptions:h.reducer,config:u.reducer}),g=($,T)=>N(I.match(T)?void 0:$,T),A={...u.actions,...E.actions,...P.actions,...h.actions,...w.actions,...C.actions,resetApiState:I};return{reducer:g,actions:A}}var bt=Symbol.for("RTKQ/skipToken"),uo={status:"uninitialized"},Hr=nr(uo,()=>{}),Wr=nr(uo,()=>{});function kd({serializeQueryArgs:t,reducerPath:s,createSelector:n}){const i=P=>Hr,r=P=>Wr;return{buildQuerySelector:x,buildInfiniteQuerySelector:E,buildMutationSelector:w,selectInvalidatedBy:y,selectCachedArgsForQuery:C,selectApiState:a,selectQueries:p,selectMutations:d,selectQueryEntry:j,selectConfig:I};function o(P){return{...P,...Br(P.status)}}function a(P){return P[s]}function p(P){var h;return(h=a(P))==null?void 0:h.queries}function j(P,h){var u;return(u=p(P))==null?void 0:u[h]}function d(P){var h;return(h=a(P))==null?void 0:h.mutations}function I(P){var h;return(h=a(P))==null?void 0:h.config}function f(P,h,u){return N=>{if(N===bt)return n(i,u);const g=t({queryArgs:N,endpointDefinition:h,endpointName:P});return n($=>j($,g)??Hr,u)}}function x(P,h){return f(P,h,o)}function E(P,h){const{infiniteQueryOptions:u}=h;function N(g){const A={...g,...Br(g.status)},{isLoading:$,isError:T,direction:v}=A,k=v==="forward",b=v==="backward";return{...A,hasNextPage:l(u,A.data),hasPreviousPage:m(u,A.data),isFetchingNextPage:$&&k,isFetchingPreviousPage:$&&b,isFetchNextPageError:T&&k,isFetchPreviousPageError:T&&b}}return f(P,h,N)}function w(){return P=>{let h;return typeof P=="object"?h=Js(P)??bt:h=P,n(h===bt?r:g=>{var A,$;return(($=(A=a(g))==null?void 0:A.mutations)==null?void 0:$[h])??Wr},o)}}function y(P,h){const u=P[s],N=new Set;for(const g of h.filter(Zn).map(Yi)){const A=u.provided.tags[g.type];if(!A)continue;let $=(g.id!==void 0?A[g.id]:_r(Object.values(A)))??[];for(const T of $)N.add(T)}return _r(Array.from(N.values()).map(g=>{const A=u.queries[g];return A?[{queryCacheKey:g,endpointName:A.endpointName,originalArgs:A.originalArgs}]:[]}))}function C(P,h){return Object.values(p(P)).filter(u=>(u==null?void 0:u.endpointName)===h&&u.status!=="uninitialized").map(u=>u.originalArgs)}function l(P,h){return h?Gi(P,h)!=null:!1}function m(P,h){return!h||!P.getPreviousPageParam?!1:lo(P,h)!=null}}var xs=WeakMap?new WeakMap:void 0,ei=({endpointName:t,queryArgs:s})=>{let n="";const i=xs==null?void 0:xs.get(s);if(typeof i=="string")n=i;else{const r=JSON.stringify(s,(o,a)=>(a=typeof a=="bigint"?{$bigint:a.toString()}:a,a=Ks(a)?Object.keys(a).sort().reduce((p,j)=>(p[j]=a[j],p),{}):a,a));Ks(s)&&(xs==null||xs.set(s,r)),n=r}return`${t}(${n})`};function ho(...t){return function(n){const i=wr(d=>{var I;return(I=n.extractRehydrationInfo)==null?void 0:I.call(n,d,{reducerPath:n.reducerPath??"api"})}),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...n,extractRehydrationInfo:i,serializeQueryArgs(d){let I=ei;if("serializeQueryArgs"in d.endpointDefinition){const f=d.endpointDefinition.serializeQueryArgs;I=x=>{const E=f(x);return typeof E=="string"?E:ei({...x,queryArgs:E})}}else n.serializeQueryArgs&&(I=n.serializeQueryArgs);return I(d)},tagTypes:[...n.tagTypes||[]]},o={endpointDefinitions:{},batch(d){d()},apiUid:za(),extractRehydrationInfo:i,hasRehydrationInfo:wr(d=>i(d)!=null)},a={injectEndpoints:j,enhanceEndpoints({addTagTypes:d,endpoints:I}){if(d)for(const f of d)r.tagTypes.includes(f)||r.tagTypes.push(f);if(I)for(const[f,x]of Object.entries(I))typeof x=="function"?x(o.endpointDefinitions[f]):Object.assign(o.endpointDefinitions[f]||{},x);return a}},p=t.map(d=>d.init(a,r,o));function j(d){const I=d.endpoints({query:f=>({...f,type:"query"}),mutation:f=>({...f,type:"mutation"}),infiniteQuery:f=>({...f,type:"infinitequery"})});for(const[f,x]of Object.entries(I)){if(d.overrideExisting!==!0&&f in o.endpointDefinitions){if(d.overrideExisting==="throw")throw new Error(_a(39));continue}o.endpointDefinitions[f]=x;for(const E of p)E.injectEndpoint(f,x)}return a}return a.injectEndpoints({endpoints:n.endpoints})}}function Rt(t,...s){return Object.assign(t,...s)}var Id=({api:t,queryThunk:s,internalState:n})=>{const i=`${t.reducerPath}/subscriptions`;let r=null,o=null;const{updateSubscriptionOptions:a,unsubscribeQueryResult:p}=t.internalActions,j=(E,w)=>{var C,l,m;if(a.match(w)){const{queryCacheKey:P,requestId:h,options:u}=w.payload;return(C=E==null?void 0:E[P])!=null&&C[h]&&(E[P][h]=u),!0}if(p.match(w)){const{queryCacheKey:P,requestId:h}=w.payload;return E[P]&&delete E[P][h],!0}if(t.internalActions.removeQueryResult.match(w))return delete E[w.payload.queryCacheKey],!0;if(s.pending.match(w)){const{meta:{arg:P,requestId:h}}=w,u=E[l=P.queryCacheKey]??(E[l]={});return u[`${h}_running`]={},P.subscribe&&(u[h]=P.subscriptionOptions??u[h]??{}),!0}let y=!1;if(s.fulfilled.match(w)||s.rejected.match(w)){const P=E[w.meta.arg.queryCacheKey]||{},h=`${w.meta.requestId}_running`;y||(y=!!P[h]),delete P[h]}if(s.rejected.match(w)){const{meta:{condition:P,arg:h,requestId:u}}=w;if(P&&h.subscribe){const N=E[m=h.queryCacheKey]??(E[m]={});N[u]=h.subscriptionOptions??N[u]??{},y=!0}}return y},d=()=>n.currentSubscriptions,x={getSubscriptions:d,getSubscriptionCount:E=>{const y=d()[E]??{};return ks(y)},isRequestSubscribed:(E,w)=>{var C;const y=d();return!!((C=y==null?void 0:y[E])!=null&&C[w])}};return(E,w)=>{if(r||(r=JSON.parse(JSON.stringify(n.currentSubscriptions))),t.util.resetApiState.match(E))return r=n.currentSubscriptions={},o=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(E))return[!1,x];const y=j(n.currentSubscriptions,E);let C=!0;if(y){o||(o=setTimeout(()=>{const P=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,h]=Va(r,()=>P);w.next(t.internalActions.subscriptionsUpdated(h)),r=P,o=null},500));const l=typeof E.type=="string"&&!!E.type.startsWith(i),m=s.rejected.match(E)&&E.meta.condition&&!!E.meta.arg.subscribe;C=!l&&!m}return[C,!1]}};function Cd(t){for(const s in t)return!1;return!0}var Ed=2147483647/1e3-1,Pd=({reducerPath:t,api:s,queryThunk:n,context:i,internalState:r,selectors:{selectQueryEntry:o,selectConfig:a}})=>{const{removeQueryResult:p,unsubscribeQueryResult:j,cacheEntriesUpserted:d}=s.internalActions,I=Kn(j.match,n.fulfilled,n.rejected,d.match);function f(C){const l=r.currentSubscriptions[C];return!!l&&!Cd(l)}const x={},E=(C,l,m)=>{const P=l.getState(),h=a(P);if(I(C)){let u;if(d.match(C))u=C.payload.map(N=>N.queryDescription.queryCacheKey);else{const{queryCacheKey:N}=j.match(C)?C.payload:C.meta.arg;u=[N]}w(u,l,h)}if(s.util.resetApiState.match(C))for(const[u,N]of Object.entries(x))N&&clearTimeout(N),delete x[u];if(i.hasRehydrationInfo(C)){const{queries:u}=i.extractRehydrationInfo(C);w(Object.keys(u),l,h)}};function w(C,l,m){const P=l.getState();for(const h of C){const u=o(P,h);y(h,u==null?void 0:u.endpointName,l,m)}}function y(C,l,m,P){const h=i.endpointDefinitions[l],u=(h==null?void 0:h.keepUnusedDataFor)??P.keepUnusedDataFor;if(u===1/0)return;const N=Math.max(0,Math.min(u,Ed));if(!f(C)){const g=x[C];g&&clearTimeout(g),x[C]=setTimeout(()=>{f(C)||m.dispatch(p({queryCacheKey:C})),delete x[C]},N*1e3)}}return E},Yr=new Error("Promise never resolved before cacheEntryRemoved."),Ad=({api:t,reducerPath:s,context:n,queryThunk:i,mutationThunk:r,internalState:o,selectors:{selectQueryEntry:a,selectApiState:p}})=>{const j=kr(i),d=kr(r),I=is(i,r),f={};function x(l,m,P){const h=f[l];h!=null&&h.valueResolved&&(h.valueResolved({data:m,meta:P}),delete h.valueResolved)}function E(l){const m=f[l];m&&(delete f[l],m.cacheEntryRemoved())}const w=(l,m,P)=>{const h=y(l);function u(N,g,A,$){const T=a(P,g),v=a(m.getState(),g);!T&&v&&C(N,$,g,m,A)}if(i.pending.match(l))u(l.meta.arg.endpointName,h,l.meta.requestId,l.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(l))for(const{queryDescription:N,value:g}of l.payload){const{endpointName:A,originalArgs:$,queryCacheKey:T}=N;u(A,T,l.meta.requestId,$),x(T,g,{})}else if(r.pending.match(l))m.getState()[s].mutations[h]&&C(l.meta.arg.endpointName,l.meta.arg.originalArgs,h,m,l.meta.requestId);else if(I(l))x(h,l.payload,l.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(l)||t.internalActions.removeMutationResult.match(l))E(h);else if(t.util.resetApiState.match(l))for(const N of Object.keys(f))E(N)};function y(l){return j(l)?l.meta.arg.queryCacheKey:d(l)?l.meta.arg.fixedCacheKey??l.meta.requestId:t.internalActions.removeQueryResult.match(l)?l.payload.queryCacheKey:t.internalActions.removeMutationResult.match(l)?Js(l.payload):""}function C(l,m,P,h,u){const N=n.endpointDefinitions[l],g=N==null?void 0:N.onCacheEntryAdded;if(!g)return;const A={},$=new Promise(M=>{A.cacheEntryRemoved=M}),T=Promise.race([new Promise(M=>{A.valueResolved=M}),$.then(()=>{throw Yr})]);T.catch(()=>{}),f[P]=A;const v=t.endpoints[l].select(Jn(N)?m:P),k=h.dispatch((M,F,S)=>S),b={...h,getCacheEntry:()=>v(h.getState()),requestId:u,extra:k,updateCachedData:Jn(N)?M=>h.dispatch(t.util.updateQueryData(l,m,M)):void 0,cacheDataLoaded:T,cacheEntryRemoved:$},D=g(m,b);Promise.resolve(D).catch(M=>{if(M!==Yr)throw M})}return w},Nd=({api:t,context:{apiUid:s},reducerPath:n})=>(i,r)=>{t.util.resetApiState.match(i)&&r.dispatch(t.internalActions.middlewareRegistered(s))},Td=({reducerPath:t,context:s,context:{endpointDefinitions:n},mutationThunk:i,queryThunk:r,api:o,assertTagType:a,refetchQuery:p,internalState:j})=>{const{removeQueryResult:d}=o.internalActions,I=Kn(is(i),ir(i)),f=Kn(is(i,r),rr(i,r));let x=[];const E=(C,l)=>{I(C)?y(co(C,"invalidatesTags",n,a),l):f(C)?y([],l):o.util.invalidateTags.match(C)&&y(hr(C.payload,void 0,void 0,void 0,void 0,a),l)};function w(C){var P;const{queries:l,mutations:m}=C;for(const h of[l,m])for(const u in h)if(((P=h[u])==null?void 0:P.status)==="pending")return!0;return!1}function y(C,l){const m=l.getState(),P=m[t];if(x.push(...C),P.config.invalidationBehavior==="delayed"&&w(P))return;const h=x;if(x=[],h.length===0)return;const u=o.util.selectInvalidatedBy(m,h);s.batch(()=>{const N=Array.from(u.values());for(const{queryCacheKey:g}of N){const A=P.queries[g],$=j.currentSubscriptions[g]??{};A&&(ks($)===0?l.dispatch(d({queryCacheKey:g})):A.status!=="uninitialized"&&l.dispatch(p(A)))}})}return E},Rd=({reducerPath:t,queryThunk:s,api:n,refetchQuery:i,internalState:r})=>{const o={},a=(x,E)=>{(n.internalActions.updateSubscriptionOptions.match(x)||n.internalActions.unsubscribeQueryResult.match(x))&&j(x.payload,E),(s.pending.match(x)||s.rejected.match(x)&&x.meta.condition)&&j(x.meta.arg,E),(s.fulfilled.match(x)||s.rejected.match(x)&&!x.meta.condition)&&p(x.meta.arg,E),n.util.resetApiState.match(x)&&I()};function p({queryCacheKey:x},E){const w=E.getState()[t],y=w.queries[x],C=r.currentSubscriptions[x];if(!y||y.status==="uninitialized")return;const{lowestPollingInterval:l,skipPollingIfUnfocused:m}=f(C);if(!Number.isFinite(l))return;const P=o[x];P!=null&&P.timeout&&(clearTimeout(P.timeout),P.timeout=void 0);const h=Date.now()+l;o[x]={nextPollTimestamp:h,pollingInterval:l,timeout:setTimeout(()=>{(w.config.focused||!m)&&E.dispatch(i(y)),p({queryCacheKey:x},E)},l)}}function j({queryCacheKey:x},E){const y=E.getState()[t].queries[x],C=r.currentSubscriptions[x];if(!y||y.status==="uninitialized")return;const{lowestPollingInterval:l}=f(C);if(!Number.isFinite(l)){d(x);return}const m=o[x],P=Date.now()+l;(!m||P<m.nextPollTimestamp)&&p({queryCacheKey:x},E)}function d(x){const E=o[x];E!=null&&E.timeout&&clearTimeout(E.timeout),delete o[x]}function I(){for(const x of Object.keys(o))d(x)}function f(x={}){let E=!1,w=Number.POSITIVE_INFINITY;for(let y in x)x[y].pollingInterval&&(w=Math.min(x[y].pollingInterval,w),E=x[y].skipPollingIfUnfocused||E);return{lowestPollingInterval:w,skipPollingIfUnfocused:E}}return a},Dd=({api:t,context:s,queryThunk:n,mutationThunk:i})=>{const r=Oa(n,i),o=rr(n,i),a=is(n,i),p={};return(d,I)=>{var f,x;if(r(d)){const{requestId:E,arg:{endpointName:w,originalArgs:y}}=d.meta,C=s.endpointDefinitions[w],l=C==null?void 0:C.onQueryStarted;if(l){const m={},P=new Promise((g,A)=>{m.resolve=g,m.reject=A});P.catch(()=>{}),p[E]=m;const h=t.endpoints[w].select(Jn(C)?y:E),u=I.dispatch((g,A,$)=>$),N={...I,getCacheEntry:()=>h(I.getState()),requestId:E,extra:u,updateCachedData:Jn(C)?g=>I.dispatch(t.util.updateQueryData(w,y,g)):void 0,queryFulfilled:P};l(y,N)}}else if(a(d)){const{requestId:E,baseQueryMeta:w}=d.meta;(f=p[E])==null||f.resolve({data:d.payload,meta:w}),delete p[E]}else if(o(d)){const{requestId:E,rejectedWithValue:w,baseQueryMeta:y}=d.meta;(x=p[E])==null||x.reject({error:d.payload??d.error,isUnhandledError:!w,meta:y}),delete p[E]}}},Fd=({reducerPath:t,context:s,api:n,refetchQuery:i,internalState:r})=>{const{removeQueryResult:o}=n.internalActions,a=(j,d)=>{dr.match(j)&&p(d,"refetchOnFocus"),ur.match(j)&&p(d,"refetchOnReconnect")};function p(j,d){const I=j.getState()[t],f=I.queries,x=r.currentSubscriptions;s.batch(()=>{for(const E of Object.keys(x)){const w=f[E],y=x[E];if(!y||!w)continue;(Object.values(y).some(l=>l[d]===!0)||Object.values(y).every(l=>l[d]===void 0)&&I.config[d])&&(ks(y)===0?j.dispatch(o({queryCacheKey:E})):w.status!=="uninitialized"&&j.dispatch(i(w)))}})}return a};function $d(t){const{reducerPath:s,queryThunk:n,api:i,context:r}=t,{apiUid:o}=r,a={invalidateTags:Ps(`${s}/invalidateTags`)},p=f=>f.type.startsWith(`${s}/`),j=[Nd,Pd,Td,Rd,Ad,Dd];return{middleware:f=>{let x=!1;const w={...t,internalState:{currentSubscriptions:{}},refetchQuery:I,isThisApiSliceAction:p},y=j.map(m=>m(w)),C=Id(w),l=Fd(w);return m=>P=>{if(!ml(P))return m(P);x||(x=!0,f.dispatch(i.internalActions.middlewareRegistered(o)));const h={...f,next:m},u=f.getState(),[N,g]=C(P,h,u);let A;if(N?A=m(P):A=g,f.getState()[s]&&(l(P,h,u),p(P)||r.hasRehydrationInfo(P)))for(const $ of y)$(P,h,u);return A}},actions:a};function I(f){return t.api.endpoints[f.endpointName].initiate(f.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Qr=Symbol(),po=({createSelector:t=qa}={})=>({name:Qr,init(s,{baseQuery:n,tagTypes:i,reducerPath:r,serializeQueryArgs:o,keepUnusedDataFor:a,refetchOnMountOrArgChange:p,refetchOnFocus:j,refetchOnReconnect:d,invalidationBehavior:I,onSchemaFailure:f,catchSchemaFailure:x,skipSchemaValidation:E},w){hl();const y=U=>U;Object.assign(s,{reducerPath:r,endpoints:{},internalActions:{onOnline:ur,onOffline:ao,onFocus:dr,onFocusLost:ro},util:{}});const C=kd({serializeQueryArgs:o,reducerPath:r,createSelector:t}),{selectInvalidatedBy:l,selectCachedArgsForQuery:m,buildQuerySelector:P,buildInfiniteQuerySelector:h,buildMutationSelector:u}=C;Rt(s.util,{selectInvalidatedBy:l,selectCachedArgsForQuery:m});const{queryThunk:N,infiniteQueryThunk:g,mutationThunk:A,patchQueryData:$,updateQueryData:T,upsertQueryData:v,prefetch:k,buildMatchThunkActions:b}=wd({baseQuery:n,reducerPath:r,context:w,api:s,serializeQueryArgs:o,assertTagType:y,selectors:C,onSchemaFailure:f,catchSchemaFailure:x,skipSchemaValidation:E}),{reducer:D,actions:M}=Sd({context:w,queryThunk:N,mutationThunk:A,serializeQueryArgs:o,reducerPath:r,assertTagType:y,config:{refetchOnFocus:j,refetchOnReconnect:d,refetchOnMountOrArgChange:p,keepUnusedDataFor:a,reducerPath:r,invalidationBehavior:I}});Rt(s.util,{patchQueryData:$,updateQueryData:T,upsertQueryData:v,prefetch:k,resetApiState:M.resetApiState,upsertQueryEntries:M.cacheEntriesUpserted}),Rt(s.internalActions,M);const{middleware:F,actions:S}=$d({reducerPath:r,context:w,queryThunk:N,mutationThunk:A,infiniteQueryThunk:g,api:s,assertTagType:y,selectors:C});Rt(s.util,S),Rt(s,{reducer:D,middleware:F});const{buildInitiateQuery:R,buildInitiateInfiniteQuery:B,buildInitiateMutation:_,getRunningMutationThunk:V,getRunningMutationsThunk:Y,getRunningQueriesThunk:G,getRunningQueryThunk:H}=jd({queryThunk:N,mutationThunk:A,infiniteQueryThunk:g,api:s,serializeQueryArgs:o,context:w});return Rt(s.util,{getRunningMutationThunk:V,getRunningMutationsThunk:Y,getRunningQueryThunk:H,getRunningQueriesThunk:G}),{name:Qr,injectEndpoint(U,W){var ce;const de=(ce=s.endpoints)[U]??(ce[U]={});ri(W)&&Rt(de,{name:U,select:P(U,W),initiate:R(U,W)},b(N,U)),fd(W)&&Rt(de,{name:U,select:u(),initiate:_(U)},b(A,U)),ai(W)&&Rt(de,{name:U,select:h(U,W),initiate:B(U,W)},b(N,U))}}}});po();function hn(t){return t.replace(t[0],t[0].toUpperCase())}function Ld(t){return t.type==="query"}function Md(t){return t.type==="mutation"}function xo(t){return t.type==="infinitequery"}function Fs(t,...s){return Object.assign(t,...s)}var hi=Symbol();function pi(t,s,n,i){const r=c.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?s({queryArgs:t,endpointDefinition:n,endpointName:i}):t}),[t,s,n,i]),o=c.useRef(r);return c.useEffect(()=>{o.current.serialized!==r.serialized&&(o.current=r)},[r]),o.current.serialized===r.serialized?o.current.queryArgs:t}function pn(t){const s=c.useRef(t);return c.useEffect(()=>{zs(s.current,t)||(s.current=t)},[t]),zs(s.current,t)?s.current:t}var Bd=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zd=Bd(),_d=()=>typeof navigator<"u"&&navigator.product==="ReactNative",qd=_d(),Ud=()=>zd||qd?c.useLayoutEffect:c.useEffect,Od=Ud(),Gr=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:no.pending}:t;function xi(t,...s){const n={};return s.forEach(i=>{n[i]=t[i]}),n}var mi=["data","status","isLoading","isSuccess","isError","error"];function Vd({api:t,moduleOptions:{batch:s,hooks:{useDispatch:n,useSelector:i,useStore:r},unstable__sideEffectsInRender:o,createSelector:a},serializeQueryArgs:p,context:j}){const d=o?h=>h():c.useEffect;return{buildQueryHooks:l,buildInfiniteQueryHooks:m,buildMutationHook:P,usePrefetch:x};function I(h,u,N){if(u!=null&&u.endpointName&&h.isUninitialized){const{endpointName:k}=u,b=j.endpointDefinitions[k];N!==bt&&p({queryArgs:u.originalArgs,endpointDefinition:b,endpointName:k})===p({queryArgs:N,endpointDefinition:b,endpointName:k})&&(u=void 0)}let g=h.isSuccess?h.data:u==null?void 0:u.data;g===void 0&&(g=h.data);const A=g!==void 0,$=h.isLoading,T=(!u||u.isLoading||u.isUninitialized)&&!A&&$,v=h.isSuccess||A&&($&&!(u!=null&&u.isError)||h.isUninitialized);return{...h,data:g,currentData:h.data,isFetching:$,isLoading:T,isSuccess:v}}function f(h,u,N){if(u!=null&&u.endpointName&&h.isUninitialized){const{endpointName:k}=u,b=j.endpointDefinitions[k];N!==bt&&p({queryArgs:u.originalArgs,endpointDefinition:b,endpointName:k})===p({queryArgs:N,endpointDefinition:b,endpointName:k})&&(u=void 0)}let g=h.isSuccess?h.data:u==null?void 0:u.data;g===void 0&&(g=h.data);const A=g!==void 0,$=h.isLoading,T=(!u||u.isLoading||u.isUninitialized)&&!A&&$,v=h.isSuccess||$&&A;return{...h,data:g,currentData:h.data,isFetching:$,isLoading:T,isSuccess:v}}function x(h,u){const N=n(),g=pn(u);return c.useCallback((A,$)=>N(t.util.prefetch(h,A,{...g,...$})),[h,N,g])}function E(h,u,{refetchOnReconnect:N,refetchOnFocus:g,refetchOnMountOrArgChange:A,skip:$=!1,pollingInterval:T=0,skipPollingIfUnfocused:v=!1,...k}={}){const{initiate:b}=t.endpoints[h],D=n(),M=c.useRef(void 0);if(!M.current){const U=D(t.internalActions.internal_getRTKQSubscriptions());M.current=U}const F=pi($?bt:u,ei,j.endpointDefinitions[h],h),S=pn({refetchOnReconnect:N,refetchOnFocus:g,pollingInterval:T,skipPollingIfUnfocused:v}),R=k.initialPageParam,B=pn(R),_=c.useRef(void 0);let{queryCacheKey:V,requestId:Y}=_.current||{},G=!1;V&&Y&&(G=M.current.isRequestSubscribed(V,Y));const H=!G&&_.current!==void 0;return d(()=>{H&&(_.current=void 0)},[H]),d(()=>{var J;const U=_.current;if(F===bt){U==null||U.unsubscribe(),_.current=void 0;return}const W=(J=_.current)==null?void 0:J.subscriptionOptions;if(!U||U.arg!==F){U==null||U.unsubscribe();const de=D(b(F,{subscriptionOptions:S,forceRefetch:A,...xo(j.endpointDefinitions[h])?{initialPageParam:B}:{}}));_.current=de}else S!==W&&U.updateSubscriptionOptions(S)},[D,b,A,F,S,H,B,h]),[_,D,b,S]}function w(h,u){return(g,{skip:A=!1,selectFromResult:$}={})=>{const{select:T}=t.endpoints[h],v=pi(A?bt:g,p,j.endpointDefinitions[h],h),k=c.useRef(void 0),b=c.useMemo(()=>a([T(v),(R,B)=>B,R=>v],u,{memoizeOptions:{resultEqualityCheck:zs}}),[T,v]),D=c.useMemo(()=>$?a([b],$,{devModeChecks:{identityFunctionCheck:"never"}}):b,[b,$]),M=i(R=>D(R,k.current),zs),F=r(),S=b(F.getState(),k.current);return Od(()=>{k.current=S},[S]),M}}function y(h){c.useEffect(()=>()=>{var u,N;(N=(u=h.current)==null?void 0:u.unsubscribe)==null||N.call(u),h.current=void 0},[h])}function C(h){if(!h.current)throw new Error(_a(38));return h.current.refetch()}function l(h){const u=(A,$={})=>{const[T]=E(h,A,$);return y(T),c.useMemo(()=>({refetch:()=>C(T)}),[T])},N=({refetchOnReconnect:A,refetchOnFocus:$,pollingInterval:T=0,skipPollingIfUnfocused:v=!1}={})=>{const{initiate:k}=t.endpoints[h],b=n(),[D,M]=c.useState(hi),F=c.useRef(void 0),S=pn({refetchOnReconnect:A,refetchOnFocus:$,pollingInterval:T,skipPollingIfUnfocused:v});d(()=>{var Y,G;const V=(Y=F.current)==null?void 0:Y.subscriptionOptions;S!==V&&((G=F.current)==null||G.updateSubscriptionOptions(S))},[S]);const R=c.useRef(S);d(()=>{R.current=S},[S]);const B=c.useCallback(function(V,Y=!1){let G;return s(()=>{var H;(H=F.current)==null||H.unsubscribe(),F.current=G=b(k(V,{subscriptionOptions:R.current,forceRefetch:!Y})),M(V)}),G},[b,k]),_=c.useCallback(()=>{var V,Y;(V=F.current)!=null&&V.queryCacheKey&&b(t.internalActions.removeQueryResult({queryCacheKey:(Y=F.current)==null?void 0:Y.queryCacheKey}))},[b]);return c.useEffect(()=>()=>{var V;(V=F==null?void 0:F.current)==null||V.unsubscribe()},[]),c.useEffect(()=>{D!==hi&&!F.current&&B(D,!0)},[D,B]),c.useMemo(()=>[B,D,{reset:_}],[B,D,_])},g=w(h,I);return{useQueryState:g,useQuerySubscription:u,useLazyQuerySubscription:N,useLazyQuery(A){const[$,T,{reset:v}]=N(A),k=g(T,{...A,skip:T===hi}),b=c.useMemo(()=>({lastArg:T}),[T]);return c.useMemo(()=>[$,{...k,reset:v},b],[$,k,v,b])},useQuery(A,$){const T=u(A,$),v=g(A,{selectFromResult:A===bt||$!=null&&$.skip?void 0:Gr,...$}),k=xi(v,...mi);return c.useDebugValue(k),c.useMemo(()=>({...v,...T}),[v,T])}}}function m(h){const u=(g,A={})=>{const[$,T,v,k]=E(h,g,A),b=c.useRef(k);d(()=>{b.current=k},[k]);const D=c.useCallback(function(S,R){let B;return s(()=>{var _;(_=$.current)==null||_.unsubscribe(),$.current=B=T(v(S,{subscriptionOptions:b.current,direction:R}))}),B},[$,T,v]);y($);const M=pi(A.skip?bt:g,ei,j.endpointDefinitions[h],h),F=c.useCallback(()=>C($),[$]);return c.useMemo(()=>({trigger:D,refetch:F,fetchNextPage:()=>D(M,"forward"),fetchPreviousPage:()=>D(M,"backward")}),[F,D,M])},N=w(h,f);return{useInfiniteQueryState:N,useInfiniteQuerySubscription:u,useInfiniteQuery(g,A){const{refetch:$,fetchNextPage:T,fetchPreviousPage:v}=u(g,A),k=N(g,{selectFromResult:g===bt||A!=null&&A.skip?void 0:Gr,...A}),b=xi(k,...mi,"hasNextPage","hasPreviousPage");return c.useDebugValue(b),c.useMemo(()=>({...k,fetchNextPage:T,fetchPreviousPage:v,refetch:$}),[k,T,v,$])}}}function P(h){return({selectFromResult:u,fixedCacheKey:N}={})=>{const{select:g,initiate:A}=t.endpoints[h],$=n(),[T,v]=c.useState();c.useEffect(()=>()=>{T!=null&&T.arg.fixedCacheKey||T==null||T.reset()},[T]);const k=c.useCallback(function(V){const Y=$(A(V,{fixedCacheKey:N}));return v(Y),Y},[$,A,N]),{requestId:b}=T||{},D=c.useMemo(()=>g({fixedCacheKey:N,requestId:T==null?void 0:T.requestId}),[N,T,g]),M=c.useMemo(()=>u?a([D],u):D,[u,D]),F=i(M,zs),S=N==null?T==null?void 0:T.arg.originalArgs:void 0,R=c.useCallback(()=>{s(()=>{T&&v(void 0),N&&$(t.internalActions.removeMutationResult({requestId:b,fixedCacheKey:N}))})},[$,N,T,b]),B=xi(F,...mi,"endpointName");c.useDebugValue(B);const _=c.useMemo(()=>({...F,originalArgs:S,reset:R}),[F,S,R]);return c.useMemo(()=>[k,_],[k,_])}}}var Hd=Symbol(),Wd=({batch:t=yl,hooks:s={useDispatch:Ie,useSelector:he,useStore:bl},createSelector:n=qa,unstable__sideEffectsInRender:i=!1,...r}={})=>({name:Hd,init(o,{serializeQueryArgs:a},p){const j=o,{buildQueryHooks:d,buildInfiniteQueryHooks:I,buildMutationHook:f,usePrefetch:x}=Vd({api:o,moduleOptions:{batch:t,hooks:s,unstable__sideEffectsInRender:i,createSelector:n},serializeQueryArgs:a,context:p});return Fs(j,{usePrefetch:x}),Fs(p,{batch:t}),{injectEndpoint(E,w){if(Ld(w)){const{useQuery:y,useLazyQuery:C,useLazyQuerySubscription:l,useQueryState:m,useQuerySubscription:P}=d(E);Fs(j.endpoints[E],{useQuery:y,useLazyQuery:C,useLazyQuerySubscription:l,useQueryState:m,useQuerySubscription:P}),o[`use${hn(E)}Query`]=y,o[`useLazy${hn(E)}Query`]=C}if(Md(w)){const y=f(E);Fs(j.endpoints[E],{useMutation:y}),o[`use${hn(E)}Mutation`]=y}else if(xo(w)){const{useInfiniteQuery:y,useInfiniteQuerySubscription:C,useInfiniteQueryState:l}=I(E);Fs(j.endpoints[E],{useInfiniteQuery:y,useInfiniteQuerySubscription:C,useInfiniteQueryState:l}),o[`use${hn(E)}InfiniteQuery`]=y}}}}}),pr=ho(po(),Wd());const Yd="/api",Nn=pr({reducerPath:"exhibitorInvoiceApi",baseQuery:cr({baseUrl:Yd,credentials:"include",prepareHeaders:t=>{const s=localStorage.getItem("exhibitor_token");return s&&t.set("authorization",`Bearer ${s}`),t.set("Content-Type","application/json"),t.set("Accept","application/json"),t}}),tagTypes:["ExhibitorInvoice"],endpoints:t=>({getExhibitorInvoice:t.query({query:s=>({url:`/exhibitor-bookings/${s}/invoice`,method:"GET"}),transformResponse:s=>s,transformErrorResponse:s=>s,providesTags:(s,n,i)=>[{type:"ExhibitorInvoice",id:i}]}),downloadExhibitorInvoice:t.mutation({query:s=>({url:`/exhibitor-bookings/${s}/invoice/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:t.mutation({query:({bookingId:s,...n})=>({url:`/exhibitor-bookings/${s}/invoice/share/email`,method:"POST",body:n})}),shareViaWhatsApp:t.mutation({query:({bookingId:s,...n})=>({url:`/exhibitor-bookings/${s}/invoice/share/whatsapp`,method:"POST",body:n})})})}),{useGetExhibitorInvoiceQuery:Qd,useDownloadExhibitorInvoiceMutation:Gd,useShareViaEmailMutation:Kd,useShareViaWhatsAppMutation:Xd}=Nn,mo=({booking:t})=>{var P,h,u,N;const s=()=>{const g=new Date(t.exhibitionId.startDate||""),A=new Date(t.exhibitionId.endDate||""),$={};let T=new Date(g);for(;T<=A;){const k=T.toLocaleString("default",{month:"short",year:"numeric"});$[k]||($[k]=[]),$[k].push(T.getDate().toString().padStart(2,"0")),T=new Date(T),T.setDate(T.getDate()+1)}const v=Object.entries($).map(([k,b])=>`${b.join(", ")} ${k}`);return`${t.exhibitionId.name||"ABSE"} (${v.join(" & ")})`},n=g=>{const A=new Date(g);return{date:A.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:A.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},i=t.stallIds.map((g,A)=>{var k;const $=g,T=g.dimensions.width*g.dimensions.height,v=T*g.ratePerSqm;return{key:g._id,sn:A+1,stallNo:g.number,stallType:((k=$.stallTypeId)==null?void 0:k.name)||"Standard",dimensions:`${g.dimensions.width}x${g.dimensions.height}m`,area:T.toFixed(0),rate:g.ratePerSqm.toFixed(0),amount:v}}),r=i.reduce((g,A)=>g+A.amount,0),o=t.calculations,a=((P=o.stalls[0])==null?void 0:P.discount)!==void 0&&((h=o.stalls[0])==null?void 0:h.discount)!==null,p=a&&((N=(u=o.stalls[0])==null?void 0:u.discount)==null?void 0:N.value)||0,j=a&&p>0?Math.round(r*p/100*100)/100:0,d=r-j,I=o.taxes.find(g=>g.name.includes("GST")),f=I?I.rate:18,x=Math.round(d*f/100*100)/100,E=d+x,w=r,y=j,C=d,l=x,m=E;return e.jsx("div",{className:"invoice-container",children:e.jsxs("div",{className:"proforma-invoice",children:[e.jsxs("div",{className:"header-section",children:[e.jsx("div",{className:"logo-cell",children:"Logo"}),e.jsxs("div",{className:"title-company",children:[e.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),e.jsx("div",{className:"company-cell",children:t.exhibitionId.companyName})]})]}),e.jsxs("div",{className:"bill-to-section",children:[e.jsx("div",{className:"bill-to-cell",children:"Bill To"}),e.jsxs("div",{className:"bill-to-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Company Name"}),e.jsx("div",{className:"value-cell",children:t.companyName}),e.jsx("div",{className:"date-label-cell",children:"Date"}),e.jsx("div",{className:"date-value-cell",children:n(t.createdAt).date})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Phone No."}),e.jsx("div",{className:"value-cell",children:t.customerPhone}),e.jsx("div",{className:"date-label-cell",children:"Time"}),e.jsx("div",{className:"date-value-cell",children:n(t.createdAt).time})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"GST No."}),e.jsx("div",{className:"value-cell",children:t.customerGSTIN}),e.jsx("div",{className:"date-label-cell",children:"Invoice No"}),e.jsx("div",{className:"date-value-cell",children:t.invoiceNumber})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Address"}),e.jsx("div",{className:"value-cell",children:t.customerAddress})]})]})]}),e.jsxs("div",{className:"expo-venue-section",children:[e.jsxs("div",{className:"expo-column",children:[e.jsx("div",{className:"heading",children:"Expo Name"}),e.jsx("div",{className:"content",children:s()})]}),e.jsxs("div",{className:"venue-column",children:[e.jsx("div",{className:"heading",children:"Venue"}),e.jsx("div",{className:"content",children:t.exhibitionId.venue})]})]}),e.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),e.jsxs("div",{className:"stall-table",children:[e.jsxs("div",{className:"stall-header",children:[e.jsx("div",{className:"stall-header-cell",children:"S/N"}),e.jsx("div",{className:"stall-header-cell",children:"Stall No."}),e.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),e.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),e.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),i.map(g=>e.jsxs("div",{className:"stall-row",children:[e.jsx("div",{className:"stall-cell",children:g.sn}),e.jsx("div",{className:"stall-cell",children:g.stallNo}),e.jsx("div",{className:"stall-cell",children:g.stallType}),e.jsx("div",{className:"stall-cell",children:g.dimensions}),e.jsx("div",{className:"stall-cell",children:g.area}),e.jsx("div",{className:"stall-cell",children:Number(g.rate).toLocaleString("en-IN")}),e.jsx("div",{className:"stall-cell",children:g.amount.toLocaleString("en-IN")})]},g.key))]}),e.jsx("div",{className:"section-header",children:"Calculation Summary"}),e.jsxs("div",{className:"calc-table",children:[e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),e.jsxs("div",{className:"calc-value",children:["",w.toLocaleString("en-IN")]})]}),p>0&&e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["Discount (",p,"%)"]}),e.jsxs("div",{className:"calc-value",children:["-",y.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:p>0?"Amount after Discount":"Net Amount"}),e.jsxs("div",{className:"calc-value",children:["",C.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["GST (",f,"%)"]}),e.jsxs("div",{className:"calc-value",children:["",l.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row total-row",children:[e.jsx("div",{className:"calc-label",children:"Total Amount"}),e.jsxs("div",{className:"calc-value",children:["",m.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"details-section",children:[e.jsxs("div",{className:"bank-details",children:[e.jsx("div",{className:"details-header",children:"Bank Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Bank Name"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Account No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankAccount})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Name"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankAccountName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Branch"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankBranch})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"IFSC CODE"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankIFSC})]})]}),e.jsxs("div",{className:"company-details",children:[e.jsx("div",{className:"details-header",children:"Company Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"CIN No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyCIN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Pan No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyPAN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"SAC CODE"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companySAC})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"GST No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyGST})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Email"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyEmail})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Website"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyWebsite})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Address"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyAddress})]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"PI Instruction"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:t.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:t.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),e.jsx("div",{className:"signature-section",children:e.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})};Pa.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Ea}/pdf.worker.min.js`;const{Title:Zd,Text:Kr}=ue,Jd=()=>{var k,b,D,M,F,S,R,B,_,V,Y,G,H,U,W,J,de;const{id:t}=pt(),{data:s,isLoading:n,error:i}=Qd(t||""),[r]=Gd(),[o]=Kd(),[a]=Xd(),[p,j]=c.useState(!1),[d,I]=c.useState(!1),[f,x]=c.useState(!1),[E,w]=c.useState(null),[y,C]=c.useState(1),[l]=L.useForm(),[m]=L.useForm(),[P,h]=c.useState(null);function u({numPages:ce}){w(ce),C(1)}const N=async()=>{try{const ce=await r(t||"").unwrap(),ae=URL.createObjectURL(ce);h(ae),j(!0)}catch(ce){console.error("Error generating PDF preview:",ce),ee.error("Failed to generate PDF preview")}},g=async()=>{try{const ce=await r(t||"").unwrap(),ae=URL.createObjectURL(ce),ne=document.createElement("a");ne.href=ae,ne.download=`Invoice-${(s==null?void 0:s.invoiceNumber)||t||"download"}.pdf`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne),URL.revokeObjectURL(ae)}catch(ce){console.error("Error downloading PDF:",ce),ee.error("Failed to download PDF")}},A=()=>{I(!0)},$=()=>{x(!0)},T=async ce=>{try{await o({bookingId:t||"",email:ce.email,message:ce.message}).unwrap(),ee.success(`Invoice sent to ${ce.email}`),I(!1),l.resetFields()}catch(ae){console.error("Error sending email:",ae),ee.error("Failed to send email")}},v=async ce=>{try{await a({bookingId:t||"",phoneNumber:ce.phoneNumber}).unwrap();const ae=ce.phoneNumber.replace(/\D/g,""),ne=encodeURIComponent(ce.message);window.open(`https://wa.me/${ae}?text=${ne}`,"_blank"),x(!1),m.resetFields()}catch(ae){console.error("Error opening WhatsApp:",ae),ee.error("Failed to open WhatsApp")}};return n?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(Nt,{size:"large"})}):i||!s?e.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[e.jsx(Zd,{level:3,children:"Invoice Not Found"}),e.jsx(Kr,{children:"The requested invoice could not be loaded. Please try again later."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{title:"Invoice Details",style:{margin:"20px"},children:[e.jsx(se,{gutter:[16,24],children:e.jsx(z,{span:24,children:e.jsxs(X,{children:[e.jsx(q,{type:"primary",icon:e.jsx(Bo,{}),onClick:N,children:"Preview Invoice"}),e.jsx(q,{icon:e.jsx(Da,{}),onClick:g,children:"Download PDF"}),e.jsx(q,{icon:e.jsx(zt,{}),onClick:A,children:"Share via Email"}),e.jsx(q,{icon:e.jsx(Fa,{}),onClick:$,children:"Share via WhatsApp"})]})})}),e.jsx(Ce,{}),e.jsx(mo,{booking:{...s.bookingId,customerGSTIN:(k=s.bookingId)!=null&&k.customerGSTIN||((b=s.bookingId)==null?void 0:b.customerGSTIN)===""?s.bookingId.customerGSTIN:"N/A",customerAddress:(D=s.bookingId)!=null&&D.customerAddress||((M=s.bookingId)==null?void 0:M.customerAddress)===""?s.bookingId.customerAddress:"N/A",invoiceNumber:s.invoiceNumber,exhibitionId:{...s.bookingId.exhibitionId,companyName:((F=s.bookingId.exhibitionId)==null?void 0:F.companyName)||"",bankName:((S=s.bookingId.exhibitionId)==null?void 0:S.bankName)||"",bankAccount:((R=s.bookingId.exhibitionId)==null?void 0:R.bankAccount)||"",bankAccountName:((B=s.bookingId.exhibitionId)==null?void 0:B.bankAccountName)||"",bankBranch:((_=s.bookingId.exhibitionId)==null?void 0:_.bankBranch)||"",bankIFSC:((V=s.bookingId.exhibitionId)==null?void 0:V.bankIFSC)||"",companyCIN:((Y=s.bookingId.exhibitionId)==null?void 0:Y.companyCIN)||"",companyPAN:((G=s.bookingId.exhibitionId)==null?void 0:G.companyPAN)||"",companySAC:((H=s.bookingId.exhibitionId)==null?void 0:H.companySAC)||"",companyGST:((U=s.bookingId.exhibitionId)==null?void 0:U.companyGST)||"",companyEmail:((W=s.bookingId.exhibitionId)==null?void 0:W.companyEmail)||"",companyWebsite:((J=s.bookingId.exhibitionId)==null?void 0:J.companyWebsite)||"",companyAddress:((de=s.bookingId.exhibitionId)==null?void 0:de.companyAddress)||""}}})]}),e.jsxs(ye,{title:"Invoice Preview",visible:p,onCancel:()=>j(!1),footer:null,width:800,children:[P&&e.jsx(Aa,{file:P,onLoadSuccess:u,options:{cMapUrl:"cmaps/",cMapPacked:!0},children:e.jsx(Na,{pageNumber:y,width:750})}),E&&e.jsx("div",{style:{textAlign:"center",marginTop:"10px"},children:e.jsxs(Kr,{children:["Page ",y," of ",E]})})]}),e.jsx(ye,{title:"Share Invoice via Email",visible:d,onCancel:()=>I(!1),footer:null,children:e.jsxs(L,{form:l,layout:"vertical",onFinish:T,children:[e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(Q,{placeholder:"example@example.com"})}),e.jsx(L.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${s.invoiceNumber}.`,children:e.jsx(Q.TextArea,{rows:4})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(ye,{title:"Share Invoice via WhatsApp",visible:f,onCancel:()=>x(!1),footer:null,children:e.jsxs(L,{form:m,layout:"vertical",onFinish:v,children:[e.jsx(L.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:e.jsx(Q,{placeholder:"+1234567890"})}),e.jsx(L.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${s.invoiceNumber}.`,children:e.jsx(Q.TextArea,{rows:4})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Xr,Text:Zr}=ue,{TabPane:Jr}=tt,eu=()=>{var y;const{notification:t}=Je.useApp(),[s]=L.useForm(),[n]=L.useForm(),[i,r]=c.useState(!1),[o,a]=c.useState(!1),[p,j]=c.useState(!1),[d,I]=c.useState(null),f=Ie(),x=he(C=>C.auth.user);c.useEffect(()=>{(async()=>{try{j(!0);const l=await Hi.getProfile();l.data&&f(Ya({user:l.data,token:localStorage.getItem("token")||""}))}catch{ee.error("Failed to fetch profile")}finally{j(!1)}})()},[f]);const E=async C=>{var l,m;try{I(null),a(!0),await Hi.changePassword({currentPassword:C.currentPassword,newPassword:C.newPassword}),t.success({message:"Success",description:"Password has been changed successfully"}),n.resetFields()}catch(P){I(((m=(l=P.response)==null?void 0:l.data)==null?void 0:m.message)||"Failed to change password. Please try again.")}finally{a(!1)}},w=()=>x!=null&&x.role?typeof x.role=="string"?x.role:typeof x.role=="object"&&"name"in x.role?x.role.name:"User":"User";return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(se,{gutter:[24,24],align:"middle",children:e.jsxs(z,{flex:"auto",children:[e.jsx(Xr,{level:4,children:"My Account"}),e.jsx(Zr,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),e.jsx(K,{loading:p,children:e.jsxs(tt,{defaultActiveKey:"account",children:[e.jsx(Jr,{tab:"Account Information",children:e.jsxs(se,{gutter:32,children:[e.jsx(z,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(yt,{size:100,icon:e.jsx(ke,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((y=x==null?void 0:x.username)==null?void 0:y.charAt(0).toUpperCase())||"U"}),e.jsx(Xr,{level:4,children:x==null?void 0:x.username}),e.jsx(Zr,{type:"secondary",children:w()})]})}),e.jsx(z,{span:18,children:e.jsx(L,{layout:"vertical",initialValues:{username:x==null?void 0:x.username,email:x==null?void 0:x.email},disabled:!0,children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:e.jsx(Q,{prefix:e.jsx(ke,{}),placeholder:"Username"})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{prefix:e.jsx(zt,{}),placeholder:"Email Address"})})})]})})})]})},"account"),e.jsxs(Jr,{tab:"Change Password",children:[d&&e.jsx(_e,{message:"Error",description:d,type:"error",showIcon:!0,style:{marginBottom:24}}),e.jsxs(L,{form:n,layout:"vertical",onFinish:E,children:[e.jsx(L.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Current Password"})}),e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:C})=>({validator(l,m){return!m||C("newPassword")===m?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Confirm New Password"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",loading:o,icon:e.jsx(as,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:ms}=le,{Title:tu,Text:su}=ue,nu=()=>{const t=Ie(),{message:s}=Je.useApp(),[n]=L.useForm(),{settings:i,loading:r}=he(x=>x.settings),[o,a]=c.useState([]),[p,j]=c.useState(0);c.useEffect(()=>{t(qs())},[t]),c.useEffect(()=>{if(i&&(n.setFieldsValue({siteName:i.siteName,adminEmail:i.adminEmail,language:i.language,timezone:i.timezone,emailNotifications:i.emailNotifications,footerText:i.footerText}),i.logo)){const x=y=>{const C=localStorage.getItem("token");return{url:`${te.defaults.baseURL}/uploads/${y}`,token:C}},{url:E,token:w}=x(i.logo);fetch(E,{headers:{authorization:`Bearer ${w}`}}).then(y=>y.blob()).then(y=>{var l;const C=URL.createObjectURL(y);a([{uid:"-1",name:((l=i.logo)==null?void 0:l.split("/").pop())||"logo",status:"done",url:C,thumbUrl:C,type:y.type,response:{path:i.logo}}])}).catch(()=>{a([])})}},[i,n]);const d=x=>{t(Us(x)).unwrap().then(()=>s.success("Settings updated successfully")).catch(E=>s.error(`Failed to update settings: ${E}`))},I={name:"file",action:`${te.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:o,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(x){const{status:E,name:w,response:y,uid:C}=x.file;if(E==="uploading"){a([...x.fileList]);return}if(E==="done"&&y){j(0);const l=localStorage.getItem("token"),m=`${te.defaults.baseURL}/uploads/${y.path}`;fetch(m,{headers:{authorization:`Bearer ${l}`}}).then(P=>P.blob()).then(P=>{const h=URL.createObjectURL(P);a([{uid:x.file.uid,name:w,status:"done",url:h,thumbUrl:h,type:P.type,response:y}]),s.success(`${w} uploaded successfully`),n.setFieldValue("logo",y.path)}).catch(()=>{s.error(`${w} preview failed to load`),a([])})}else E==="error"?(s.error(`${w} upload failed.`),a([]),j(0)):E==="removed"&&(a([]),n.setFieldValue("logo",null),j(0))},onRemove(){return a([]),n.setFieldValue("logo",null),j(0),!0},customRequest:async({file:x,onSuccess:E,onError:w,onProgress:y})=>{try{t(An(x)).unwrap().then(C=>{E&&E(C)}).catch(C=>{w&&w(new Error(C))})}catch(C){w&&w(C)}}},f=e.jsx("div",{children:p>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(qt,{type:"circle",percent:p,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(se,{gutter:[24,24],align:"middle",children:e.jsx(z,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(tu,{level:4,style:{margin:0},children:"Settings"}),e.jsx(su,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(K,{className:"info-card",children:e.jsxs(L,{form:n,layout:"vertical",onFinish:d,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(se,{gutter:24,children:[e.jsxs(z,{span:12,children:[e.jsx(L.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{label:"Language",name:"language",children:e.jsxs(le,{children:[e.jsx(ms,{value:"en",children:"English"}),e.jsx(ms,{value:"es",children:"Spanish"}),e.jsx(ms,{value:"fr",children:"French"})]})}),e.jsx(L.Item,{label:"Timezone",name:"timezone",children:e.jsxs(le,{children:[e.jsx(ms,{value:"UTC",children:"UTC"}),e.jsx(ms,{value:"EST",children:"EST"}),e.jsx(ms,{value:"PST",children:"PST"})]})}),e.jsx(L.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(dt,{})})]}),e.jsxs(z,{span:12,children:[e.jsxs(L.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(Ys,{...I,children:o.length<1&&f}),o.length>0&&p>0&&e.jsx(qt,{percent:p,status:"active",style:{marginTop:8}})]}),e.jsx(L.Item,{label:"Footer Text",name:"footerText",children:e.jsx(Q.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(L.Item,{children:e.jsxs(X,{children:[e.jsx(q,{type:"primary",htmlType:"submit",icon:e.jsx(as,{}),loading:r,children:"Save Settings"}),e.jsx(q,{onClick:()=>n.resetFields(),icon:e.jsx(zo,{}),children:"Reset"})]})})]})})]})},iu=async()=>{try{return(await te.get("/roles")).data}catch(t){throw console.error("Error fetching roles:",t),t}},ru=async t=>{try{return(await te.get(`/roles/${t}`)).data}catch(s){throw console.error("Error fetching role:",s),s}},au=async t=>{try{return(await te.post("/roles",t)).data}catch(s){throw console.error("Error creating role:",s),s}},ou=async(t,s)=>{try{return(await te.put(`/roles/${t}`,s)).data}catch(n){throw console.error("Error updating role:",n),n}},lu=async t=>{try{await te.delete(`/roles/${t}`)}catch(s){throw console.error("Error deleting role:",s),s}},cu={roles:[],role:null,loading:!1,error:null},Is=we("roles/fetchRoles",async(t,{rejectWithValue:s})=>{var n,i;try{return await iu()}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch roles")}}),gi=we("roles/fetchRoleById",async(t,{rejectWithValue:s})=>{var n,i;try{return await ru(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch role")}}),Tn=we("roles/addRole",async(t,{rejectWithValue:s})=>{var n,i;try{return await au(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create role")}}),Rn=we("roles/modifyRole",async({id:t,roleData:s},{rejectWithValue:n})=>{var i,r;try{return await ou(t,s)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update role")}}),Dn=we("roles/removeRole",async(t,{rejectWithValue:s})=>{var n,i;try{return await lu(t),t}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete role")}}),go=nt({name:"roles",initialState:cu,reducers:{clearRoleError:t=>{t.error=null},setSelectedRole:(t,s)=>{t.role=s.payload}},extraReducers:t=>{t.addCase(Is.pending,s=>{s.loading=!0,s.error=null}).addCase(Is.fulfilled,(s,n)=>{s.loading=!1,s.roles=n.payload}).addCase(Is.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(gi.pending,s=>{s.loading=!0,s.error=null}).addCase(gi.fulfilled,(s,n)=>{s.loading=!1,s.role=n.payload}).addCase(gi.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Tn.pending,s=>{s.loading=!0,s.error=null}).addCase(Tn.fulfilled,(s,n)=>{s.loading=!1,s.roles.push(n.payload)}).addCase(Tn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Rn.pending,s=>{s.loading=!0,s.error=null}).addCase(Rn.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.roles.findIndex(o=>o._id===n.payload._id);i!==-1&&(s.roles[i]=n.payload),((r=s.role)==null?void 0:r._id)===n.payload._id&&(s.role=n.payload)}).addCase(Rn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Dn.pending,s=>{s.loading=!0,s.error=null}).addCase(Dn.fulfilled,(s,n)=>{var i;s.loading=!1,s.roles=s.roles.filter(r=>r._id!==n.payload),((i=s.role)==null?void 0:i._id)===n.payload&&(s.role=null)}).addCase(Dn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),{clearRoleError:nx,setSelectedRole:ix}=go.actions,du=go.reducer,{Text:xn}=ue,uu=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],fi=uu.reduce((t,s)=>(t[s.group]||(t[s.group]=[]),t[s.group].push({key:s.key,label:s.label}),t),{}),hu=({visible:t,onCancel:s,onSave:n,role:i,loading:r})=>{const[o]=L.useForm(),a=!!i,[p,j]=c.useState([]);c.useEffect(()=>{if(t)if(i){const w=i.permissions||[];o.setFieldsValue({name:i.name,description:i.description,permissions:w}),j(w)}else o.resetFields(),j([])},[t,i,o]);const d=()=>{o.setFieldsValue({permissions:p}),o.validateFields().then(w=>{n(w)})},I=w=>{const y=fi[w].map(C=>C.key);return y.length>0&&y.every(C=>p.includes(C))},f=(w,y)=>{let C;if(y)C=[...p,w],p.includes("dashboard_view")||C.push("dashboard_view");else{if(w==="dashboard_view"&&p.length>1&&!window.confirm("Removing dashboard access may prevent users from accessing the system. Are you sure?"))return;C=p.filter(l=>l!==w)}j(C)},x=(w,y)=>{const C=fi[w].map(m=>m.key);let l;if(y){const m=C.filter(P=>!p.includes(P));l=[...p,...m],!p.includes("dashboard_view")&&!l.includes("dashboard_view")&&l.push("dashboard_view")}else{if(w==="Dashboard"&&p.length>C.length&&!window.confirm("Removing dashboard access may prevent users from accessing the system. Are you sure?"))return;l=p.filter(m=>!C.includes(m))}j(l)},E=w=>p.includes(w);return e.jsx(ye,{title:a?"Edit Role":"Add New Role",open:t,onCancel:s,width:700,footer:[e.jsx(q,{onClick:s,children:"Cancel"},"cancel"),e.jsx(q,{type:"primary",loading:r,onClick:d,children:a?"Update":"Create"},"submit")],children:e.jsxs(L,{form:o,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[e.jsx(L.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:e.jsx(Q,{placeholder:"e.g., Administrator, Editor, Viewer"})}),e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:e.jsx(Q.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),e.jsx(Ce,{plain:!0,children:"Permissions"}),e.jsx(L.Item,{name:"permissions",hidden:!0,children:e.jsx(Q,{})}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(fi).map(([w,y])=>e.jsx(K,{size:"small",title:e.jsxs(X,{children:[e.jsx(xn,{strong:!0,children:w}),e.jsx(_i,{checked:I(w),onChange:C=>x(w,C.target.checked),children:"Select All"}),w==="Dashboard"&&e.jsx(xn,{type:"warning",children:"(Essential)"})]}),style:{marginBottom:16,borderColor:w==="Dashboard"?"#faad14":void 0,backgroundColor:w==="Dashboard"?"#fffbe6":void 0},children:e.jsx(se,{gutter:[16,12],children:y.map(C=>e.jsx(z,{span:12,children:e.jsxs(_i,{checked:E(C.key),onChange:l=>f(C.key,l.target.checked),disabled:C.key==="dashboard_view"&&p.length>0,children:[e.jsx(xn,{children:C.label}),C.key==="dashboard_view"&&e.jsx(xn,{type:"warning",children:" (Required)"})]})},C.key))})},w))})]})})},{Title:mn,Paragraph:ea,Text:gs}=ue,{confirm:pu}=ye;function yi({allowed:t}){return t?e.jsx(Ji,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):e.jsx(_o,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function xu(){const{message:t,notification:s}=Je.useApp(),n=Ie(),{roles:i,loading:r,error:o}=he(N=>N.role),[a,p]=c.useState(""),[j,d]=c.useState(!1),[I,f]=c.useState(null);c.useEffect(()=>{n(Is())},[n]),c.useEffect(()=>{o&&s.error({message:"Error",description:o})},[o,s]);const x=()=>{f(null),d(!0)},E=N=>{f(N),d(!0)},w=N=>{I?n(Rn({id:I._id,roleData:N})).unwrap().then(()=>{d(!1),t.success("Role updated successfully")}).catch(g=>{t.error(`Failed to update role: ${g.message}`)}):n(Tn(N)).unwrap().then(()=>{d(!1),t.success("Role created successfully")}).catch(g=>{t.error(`Failed to create role: ${g.message}`)})},y=N=>{pu({title:"Are you sure you want to delete this role?",icon:e.jsx(ss,{}),content:`This will permanently delete the ${N.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){n(Dn(N._id)).unwrap().then(()=>{t.success(`${N.name} role deleted successfully`)}).catch(g=>{t.error(`Failed to delete role: ${g.message}`)})}})},C=[{title:"Role",dataIndex:"name",key:"name",render:(N,g)=>e.jsxs(X,{children:[e.jsx(yt,{style:{backgroundColor:h(g.name)},children:N.charAt(0).toUpperCase()}),e.jsx(gs,{strong:!0,children:N})]})},{title:"Description",dataIndex:"description",key:"description",render:N=>e.jsx(gs,{type:"secondary",children:N})},{title:"Read",key:"read",align:"center",render:(N,g)=>e.jsx(yi,{allowed:l(g)})},{title:"Write",key:"write",align:"center",render:(N,g)=>e.jsx(yi,{allowed:m(g)})},{title:"Delete",key:"delete",align:"center",render:(N,g)=>e.jsx(yi,{allowed:P(g)})},{title:"Actions",key:"actions",align:"right",render:(N,g)=>e.jsxs(X,{children:[e.jsx(We,{title:g.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:e.jsx(q,{type:"primary",shape:"circle",icon:e.jsx(Cs,{}),size:"small",onClick:()=>E(g),disabled:g.name==="Administrator"})}),e.jsx(We,{title:"Delete role",children:e.jsx(q,{danger:!0,shape:"circle",icon:e.jsx(ut,{}),size:"small",onClick:()=>y(g),disabled:g.name==="Administrator"})})]})}],l=N=>N.permissions.some(g=>g.endsWith("_view")),m=N=>N.permissions.some(g=>g.endsWith("_create")||g.endsWith("_edit")),P=N=>N.permissions.some(g=>g.endsWith("_delete")),h=N=>{const g=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let A=0;for(let $=0;$<N.length;$++)A=N.charCodeAt($)+((A<<5)-A);return g[Math.abs(A)%g.length]},u=i.filter(N=>N.name.toLowerCase().includes(a.toLowerCase())||N.description.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(mn,{level:2,children:"Roles & Permissions"}),e.jsx(ea,{children:"Manage role-based access control and permissions for your users."})]}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:r&&i.length===0,children:[e.jsxs(se,{gutter:16,style:{marginBottom:16},children:[e.jsx(z,{span:16,children:e.jsx(Q,{placeholder:"Search roles...",allowClear:!0,value:a,onChange:N=>p(N.target.value),prefix:e.jsx(gs,{type:"secondary",style:{fontSize:16},children:""})})}),e.jsx(z,{span:8,style:{textAlign:"right"},children:e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),style:{borderRadius:6},onClick:x,children:"Add Role"})})]}),e.jsx(De,{columns:C,dataSource:u,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(N,g)=>`Showing ${g[0]}-${g[1]} of ${N} roles`},style:{marginTop:8},loading:r&&i.length>0})]}),e.jsx(K,{title:e.jsx(mn,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsxs(X,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(mn,{level:5,children:"Best Practices"}),e.jsxs("ul",{style:{paddingLeft:20},children:[e.jsx("li",{children:e.jsx(gs,{children:"Follow the principle of least privilege"})}),e.jsx("li",{children:e.jsx(gs,{children:"Regularly audit user roles"})}),e.jsx("li",{children:e.jsx(gs,{children:"Document role responsibilities"})})]})]}),e.jsxs(X,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(mn,{level:5,children:"Role Inheritance"}),e.jsx(ea,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),e.jsx(hu,{visible:j,onCancel:()=>d(!1),onSave:w,role:I,loading:r})]})}const mu=async()=>{try{return(await te.get("/users")).data}catch(t){throw console.error("Error fetching users:",t),t}},gu=async t=>{try{return(await te.get(`/users/${t}`)).data}catch(s){throw console.error("Error fetching user:",s),s}},fu=async t=>{try{return(await te.post("/users",t)).data}catch(s){throw console.error("Error creating user:",s),s}},yu=async(t,s)=>{try{return(await te.put(`/users/${t}`,s)).data}catch(n){throw console.error("Error updating user:",n),n}},bu=async t=>{try{await te.delete(`/users/${t}`)}catch(s){throw console.error("Error deleting user:",s),s}},ju={users:[],selectedUser:null,loading:!1,error:null},Zt=we("users/fetchUsers",async(t,{rejectWithValue:s})=>{var n,i;try{return await mu()}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch users")}}),bi=we("users/fetchUserById",async(t,{rejectWithValue:s})=>{var n,i;try{return await gu(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch user")}}),Fn=we("users/addUser",async(t,{rejectWithValue:s})=>{var n,i;try{return await fu(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create user")}}),$n=we("users/modifyUser",async({id:t,userData:s},{rejectWithValue:n})=>{var i,r;try{return await yu(t,s)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update user")}}),Ln=we("users/removeUser",async(t,{rejectWithValue:s})=>{var n,i;try{return await bu(t),t}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete user")}}),fo=nt({name:"users",initialState:ju,reducers:{clearUserError:t=>{t.error=null},setSelectedUser:(t,s)=>{t.selectedUser=s.payload}},extraReducers:t=>{t.addCase(Zt.pending,s=>{s.loading=!0,s.error=null}).addCase(Zt.fulfilled,(s,n)=>{s.loading=!1,s.users=n.payload}).addCase(Zt.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(bi.pending,s=>{s.loading=!0,s.error=null}).addCase(bi.fulfilled,(s,n)=>{s.loading=!1,s.selectedUser=n.payload}).addCase(bi.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Fn.pending,s=>{s.loading=!0,s.error=null}).addCase(Fn.fulfilled,(s,n)=>{s.loading=!1,s.users.push(n.payload)}).addCase(Fn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase($n.pending,s=>{s.loading=!0,s.error=null}).addCase($n.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.users.findIndex(o=>o._id===n.payload._id);i!==-1&&(s.users[i]=n.payload),((r=s.selectedUser)==null?void 0:r._id)===n.payload._id&&(s.selectedUser=n.payload)}).addCase($n.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Ln.pending,s=>{s.loading=!0,s.error=null}).addCase(Ln.fulfilled,(s,n)=>{var i;s.loading=!1,s.users=s.users.filter(r=>r._id!==n.payload),((i=s.selectedUser)==null?void 0:i._id)===n.payload&&(s.selectedUser=null)}).addCase(Ln.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),{clearUserError:rx,setSelectedUser:gn}=fo.actions,vu=fo.reducer,{Text:wu}=ue,Su=({visible:t,user:s,onClose:n})=>{if(!s)return null;const i=r=>typeof r=="string"?r:r&&typeof r=="object"&&r.name?r.name:"Unknown";return e.jsxs(ye,{title:"User Details",open:t,onCancel:n,footer:null,width:600,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[e.jsx(yt,{size:64,icon:e.jsx(ke,{}),style:{backgroundColor:"#1677ff"}}),e.jsxs("div",{style:{marginLeft:20},children:[e.jsx(wu,{style:{fontSize:20,fontWeight:"bold"},children:s.name||s.username}),e.jsxs("div",{children:[e.jsx(re,{color:s.isActive?"success":"default",children:s.isActive?"Active":"Inactive"}),e.jsx(re,{color:"blue",children:i(s.role)})]})]})]}),e.jsx(Ce,{}),e.jsxs(xe,{bordered:!0,column:1,children:[e.jsx(xe.Item,{label:"Username",children:s.username}),e.jsx(xe.Item,{label:"Email",children:s.email}),e.jsx(xe.Item,{label:"Role",children:i(s.role)}),e.jsx(xe.Item,{label:"Status",children:e.jsx(re,{color:s.isActive?"success":"default",children:s.isActive?"Active":"Inactive"})}),e.jsx(xe.Item,{label:"Created At",children:new Date(s.createdAt).toLocaleString()}),e.jsx(xe.Item,{label:"Updated At",children:new Date(s.updatedAt).toLocaleString()})]})]})},{Option:fn}=le,{Text:ku}=ue,Iu=({visible:t,user:s,onClose:n,onSuccess:i})=>{const{message:r}=Je.useApp(),[o]=L.useForm(),a=Ie(),{roles:p,loading:j}=he(f=>f.role),{loading:d}=he(f=>f.user);c.useEffect(()=>{t&&s&&o.setFieldsValue({username:s.username,name:s.name||"",email:s.email,role:typeof s.role=="object"?s.role._id:s.role,isActive:s.isActive})},[t,s,o]),c.useEffect(()=>{t&&a(Is())},[t,a]);const I=async()=>{if(s)try{const f=await o.validateFields(),x={username:f.username,name:f.name,email:f.email,role:f.role,isActive:f.isActive};f.password&&f.password.trim()!==""&&(x.password=f.password),a($n({id:s._id,userData:x})).unwrap().then(()=>{r.success("User updated successfully"),i(),n()}).catch(E=>{r.error(`Failed to update user: ${E}`)})}catch(f){console.error("Validation error:",f)}};return s?e.jsx(ye,{title:"Edit User",open:t,onCancel:n,width:600,footer:[e.jsx(q,{onClick:n,children:"Cancel"},"cancel"),e.jsx(q,{type:"primary",loading:d,onClick:I,children:"Update User"},"submit")],children:e.jsxs(L,{form:o,layout:"vertical",children:[e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(Q,{placeholder:"Username"})}),e.jsx(L.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:e.jsx(Q,{placeholder:"Full name"})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{placeholder:"Email address"})}),e.jsx(Ce,{children:e.jsx(ku,{type:"secondary",children:"Change Password (Optional)"})}),e.jsx(L.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(Q.Password,{placeholder:"New password (optional)"})}),e.jsx(Ce,{}),e.jsx(L.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(le,{loading:j,children:p.length>0?p.map(f=>e.jsx(fn,{value:f._id,children:f.name},f._id)):e.jsxs(e.Fragment,{children:[e.jsx(fn,{value:"admin",children:"Admin"}),e.jsx(fn,{value:"manager",children:"Manager"}),e.jsx(fn,{value:"agent",children:"Agent"})]})})}),e.jsx(L.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:yn}=le,{Text:ax}=ue,Cu=({visible:t,onClose:s,onSuccess:n})=>{const{message:i}=Je.useApp(),[r]=L.useForm(),o=Ie(),{roles:a,loading:p}=he(I=>I.role),{loading:j}=he(I=>I.user);c.useEffect(()=>{t&&o(Is())},[t,o]),c.useEffect(()=>{t&&r.resetFields()},[t,r]);const d=async()=>{try{const I=await r.validateFields(),f={username:I.username,name:I.name,email:I.email,password:I.password,role:I.role,isActive:I.status};o(Fn(f)).unwrap().then(x=>{i.success("User created successfully"),r.resetFields(),n(),s()}).catch(x=>{i.error(`Failed to create user: ${x}`)})}catch(I){console.error("Validation error:",I)}};return e.jsx(ye,{title:"Create New User",open:t,onCancel:s,width:600,footer:[e.jsx(q,{onClick:s,children:"Cancel"},"cancel"),e.jsx(q,{type:"primary",loading:j,onClick:d,children:"Create User"},"submit")],children:e.jsxs(L,{form:r,layout:"vertical",requiredMark:!1,children:[e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(Q,{placeholder:"Username"})}),e.jsx(L.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:e.jsx(Q,{placeholder:"Full name"})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{placeholder:"Email address"})}),e.jsx(L.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(Q.Password,{placeholder:"Enter password"})}),e.jsx(Ce,{}),e.jsx(L.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(le,{placeholder:"Select role",loading:p,children:a.length>0?a.map(I=>e.jsx(yn,{value:I._id,children:I.name},I._id)):e.jsxs(e.Fragment,{children:[e.jsx(yn,{value:"admin",children:"Admin"}),e.jsx(yn,{value:"manager",children:"Manager"}),e.jsx(yn,{value:"agent",children:"Agent"})]})})}),e.jsx(L.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:Eu,Paragraph:Pu,Text:$s}=ue,{TabPane:ji}=tt,{confirm:Au}=ye;function Nu(){const{message:t,notification:s}=Je.useApp(),n=Ie(),{users:i,loading:r,error:o,selectedUser:a}=he(v=>v.user),[p,j]=c.useState(""),[d,I]=c.useState("all"),[f,x]=c.useState(!1),[E,w]=c.useState(!1),[y,C]=c.useState(!1);c.useEffect(()=>{n(Zt())},[n]),c.useEffect(()=>{o&&s.error({message:"Error",description:o})},[o,s]),c.useEffect(()=>{a||(x(!1),w(!1))},[a]);const l=(v,k)=>{Au({title:"Are you sure you want to delete this user?",icon:e.jsx(ss,{}),content:`This will permanently delete ${k}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{n(Ln(v)).unwrap().then(()=>{t.success(`${k} has been deleted successfully.`)}).catch(b=>{t.error(`Failed to delete user: ${b}`)})}})},m=v=>{n(gn(v)),x(!0)},P=v=>{n(gn(v)),w(!0)},h=()=>{C(!0)},u=[{title:"User",key:"user",render:(v,k)=>e.jsxs(X,{children:[e.jsx(yt,{icon:e.jsx(ke,{}),size:"large"}),e.jsxs(X,{direction:"vertical",size:0,children:[e.jsx($s,{strong:!0,children:k.name||k.username}),e.jsx($s,{type:"secondary",style:{fontSize:"12px"},children:k.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:v=>{const k=A(v);let b=k.toLowerCase()==="admin"||k.toLowerCase()==="administrator"?"#1677ff":k.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx(re,{color:b,style:{fontWeight:500,borderRadius:"4px"},children:k.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(v,k)=>A(k.role).toLowerCase().indexOf(v.toLowerCase())===0},{title:"Status",key:"status",render:(v,k)=>e.jsx(X,{children:k.isActive?e.jsx(lt,{status:"success",text:e.jsx($s,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(lt,{status:"default",text:e.jsx($s,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(v,k)=>k.isActive===v},{title:"Last Active",key:"lastLogin",render:(v,k)=>e.jsxs(X,{children:[e.jsx(Ge,{style:{color:"#8c8c8c"}}),e.jsx($s,{type:"secondary",children:k.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(v,k)=>e.jsxs(X,{size:"small",children:[e.jsx(We,{title:"View details",children:e.jsx(q,{type:"text",icon:e.jsx(Mt,{}),size:"small",onClick:()=>m(k)})}),e.jsx(We,{title:"Edit user",children:e.jsx(q,{type:"text",icon:e.jsx(Cs,{}),size:"small",onClick:()=>P(k)})}),e.jsx(We,{title:"Delete user",children:e.jsx(q,{type:"text",danger:!0,icon:e.jsx(ut,{}),size:"small",onClick:()=>l(k._id,k.name||k.username)})})]})}],N=v=>v.isActive?"active":"inactive",g=i.filter(v=>(d==="all"||d==="active"&&N(v)==="active"||d==="inactive"&&N(v)==="inactive")&&Object.values(v).some(k=>typeof k=="string"&&k.toLowerCase().includes(p.toLowerCase()))),A=v=>typeof v=="string"?v:v&&typeof v=="object"&&v.name?v.name:"Unknown",$={admin:i.filter(v=>{const k=A(v.role).toLowerCase();return k==="admin"||k==="administrator"}).length,manager:i.filter(v=>A(v.role).toLowerCase()==="manager").length,agent:i.filter(v=>A(v.role).toLowerCase()==="agent").length},T={active:i.filter(v=>v.isActive).length,inactive:i.filter(v=>!v.isActive).length};return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(Eu,{level:2,children:"User Management"}),e.jsx(Pu,{children:"Manage user accounts, permissions, and access control."})]}),e.jsxs(se,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ve,{title:"Total Users",value:i.length,prefix:e.jsx(ke,{}),valueStyle:{color:"#1677ff"},loading:r})})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ve,{title:"Active Users",value:T.active,prefix:e.jsx(Ji,{}),valueStyle:{color:"#52c41a"},loading:r})})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ve,{title:"Admin Users",value:$.admin,prefix:e.jsx(ke,{}),valueStyle:{color:"#faad14"},loading:r})})})]}),e.jsx(K,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs(se,{gutter:[16,16],justify:"space-between",align:"middle",children:[e.jsx(z,{xs:24,md:12,children:e.jsx(Q,{placeholder:"Search users...",prefix:e.jsx(Bt,{style:{color:"rgba(0,0,0,.45)"}}),onChange:v=>j(v.target.value),allowClear:!0,size:"middle"})}),e.jsx(z,{xs:24,md:12,style:{textAlign:"right"},children:e.jsxs(X,{wrap:!0,children:[e.jsx(We,{title:"Refresh data",children:e.jsx(q,{icon:r?e.jsx(qo,{}):e.jsx(Bt,{}),onClick:()=>n(Zt()),disabled:r,children:"Refresh"})}),e.jsx(q,{type:"primary",icon:e.jsx(Ws,{}),onClick:h,children:"Add User"})]})})]})}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(tt,{defaultActiveKey:"all",onChange:I,tabBarStyle:{marginBottom:24},children:[e.jsx(ji,{tab:`All Users (${i.length})`},"all"),e.jsx(ji,{tab:`Active (${T.active})`},"active"),e.jsx(ji,{tab:`Inactive (${T.inactive})`},"inactive")]}),e.jsx(De,{columns:u,dataSource:g,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(v,k)=>`${k[0]}-${k[1]} of ${v} users`},loading:r})]}),e.jsx(Su,{user:i.find(v=>v._id===(a==null?void 0:a._id))||null,visible:f,onClose:()=>n(gn(null))}),e.jsx(Iu,{user:i.find(v=>v._id===(a==null?void 0:a._id))||null,visible:E,onClose:()=>n(gn(null)),onSuccess:()=>n(Zt())}),e.jsx(Cu,{visible:y,onClose:()=>C(!1),onSuccess:()=>n(Zt())})]})}const{Title:ox,Text:bn,Paragraph:Ls}=ue,Tu=({settings:t,onSave:s,loading:n})=>{const[i]=L.useForm();Pe.useEffect(()=>{i.setFieldsValue(t)},[t,i]);const r=o=>{s(o)};return e.jsxs(K,{title:e.jsxs(X,{children:[e.jsx(zt,{}),e.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[e.jsx(Ls,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),e.jsx(_e,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(L,{form:i,layout:"vertical",initialValues:t,onFinish:r,children:[e.jsxs(se,{gutter:[24,16],children:[e.jsxs(z,{span:24,children:[e.jsx(L.Item,{name:"newLeads",valuePropName:"checked",label:e.jsx(bn,{strong:!0,children:"New Lead Notifications"}),children:e.jsx(dt,{})}),e.jsx(Ls,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),e.jsxs(z,{span:24,children:[e.jsx(L.Item,{name:"followUpReminders",valuePropName:"checked",label:e.jsx(bn,{strong:!0,children:"Follow-up Reminders"}),children:e.jsx(dt,{})}),e.jsx(Ls,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),e.jsxs(z,{span:24,children:[e.jsx(L.Item,{name:"statusChanges",valuePropName:"checked",label:e.jsx(bn,{strong:!0,children:"Status Change Notifications"}),children:e.jsx(dt,{})}),e.jsx(Ls,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),e.jsxs(z,{span:24,children:[e.jsx(L.Item,{name:"leadAssignments",valuePropName:"checked",label:e.jsx(bn,{strong:!0,children:"Lead Assignment Notifications"}),children:e.jsx(dt,{})}),e.jsx(Ls,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),e.jsx(Ce,{}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",icon:e.jsx(as,{}),loading:n,children:"Save Email Preferences"})})]})]})},{Title:Ru,Text:lx,Paragraph:ta}=ue,{Search:Du}=Q,{TabPane:sa}=tt,Fu=()=>{const t=Se();pt();const[s,n]=c.useState([]),[i,r]=c.useState([]),[o,a]=c.useState(!1),[p,j]=c.useState(""),[d,I]=c.useState("ALL"),[f,x]=c.useState("ALL"),[E,w]=c.useState(Bl().email),[y,C]=c.useState(!1),[l,m]=c.useState("all");c.useEffect(()=>{P()},[]),c.useEffect(()=>{h()},[s,p,d,f,l]);const P=()=>{a(!0),setTimeout(()=>{n(Qa()),a(!1)},500)},h=()=>{let k=s;if(l==="unread"&&(k=k.filter(b=>b.status===Ne.UNREAD)),p){const b=p.toLowerCase();k=k.filter(D=>D.title.toLowerCase().includes(b)||D.message.toLowerCase().includes(b))}d!=="ALL"&&(k=k.filter(b=>b.type===d)),f!=="ALL"&&(k=k.filter(b=>b.source===f)),r(k)},u=k=>{m(k)},N=k=>{j(k)},g=()=>{j(""),I("ALL"),x("ALL"),m("all")},A=k=>{const b=Ol(k);t(b)},$=k=>{const b=s.map(D=>D.id===k.id?{...D,status:Ne.READ,readAt:new Date().toISOString()}:D);n(b)},T=()=>{const k=s.map(b=>b.status===Ne.UNREAD?{...b,status:Ne.READ,readAt:new Date().toISOString()}:b);n(k),fr.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})},v=k=>{C(!0),setTimeout(()=>{w(k),C(!1),fr.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return e.jsx("div",{className:"notifications-page",children:e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:24,children:e.jsx(K,{children:e.jsxs(se,{justify:"space-between",align:"middle",children:[e.jsxs(z,{children:[e.jsx(Ru,{level:4,children:e.jsxs(X,{children:[e.jsx(ti,{}),"Notifications"]})}),e.jsx(ta,{children:"Stay updated with all your lead activities and follow-ups"})]}),e.jsx(z,{children:e.jsxs(X,{children:[e.jsx(We,{title:"Refresh notifications",children:e.jsx(q,{icon:e.jsx(Ki,{}),onClick:P,loading:o,children:"Refresh"})}),e.jsx(q,{type:"primary",icon:e.jsx(Xi,{}),onClick:T,disabled:_s(s)===0,children:"Mark All as Read"})]})})]})})}),e.jsx(z,{xs:24,lg:16,children:e.jsxs(K,{className:"notifications-list-card",style:{marginBottom:24},children:[e.jsxs(tt,{activeKey:l,onChange:u,tabBarExtraContent:e.jsx(X,{children:e.jsx(lt,{count:_s(s),offset:[-5,0],children:e.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[e.jsx(sa,{tab:"All Notifications"},"all"),e.jsx(sa,{tab:"Unread"},"unread")]}),e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsx(Du,{placeholder:"Search notifications...",onSearch:N,style:{width:300},allowClear:!0}),e.jsx(X,{children:e.jsx(q,{icon:e.jsx(sr,{}),onClick:g,disabled:p===""&&d==="ALL"&&f==="ALL",children:"Reset Filters"})})]}),e.jsx(es,{dataSource:i,renderItem:k=>e.jsx(Ka,{notification:k,onView:A,onMarkAsRead:$}),pagination:{pageSize:10,showTotal:(k,b)=>`${b[0]}-${b[1]} of ${k} notifications`},rowKey:"id",loading:o,locale:{emptyText:e.jsx(Pt,{description:e.jsx("span",{children:"No notifications found"})})}})]})}),e.jsxs(z,{xs:24,lg:8,children:[e.jsx(Tu,{settings:E,onSave:v,loading:y}),e.jsx(K,{title:e.jsxs(X,{children:[e.jsx(Wn,{}),e.jsx("span",{children:"Notification Tips"})]}),children:e.jsx(ta,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),e.jsx("li",{children:"Use email notifications for critical updates when you're away"}),e.jsx("li",{children:"Click on a notification to see more details or take action"}),e.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class an extends Pe.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,n){console.error("Error caught by boundary:",s,n)}render(){var s;return this.state.hasError?e.jsx(Gs,{status:"error",title:"Something went wrong",subTitle:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred",extra:[e.jsx(q,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),e.jsx(q,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Oe=t=>{var n,i;const s=((i=(n=t.response)==null?void 0:n.data)==null?void 0:i.message)||"An error occurred";throw new Error(s)},Ee={getExhibitions:async()=>{try{return await te.get("/exhibitions")}catch(t){return Oe(t)}},getActiveExhibitions:async()=>{try{return await te.get("/exhibitions/active")}catch(t){return Oe(t)}},getExhibition:async t=>{try{return await te.get(`/exhibitions/${t}`)}catch(s){return Oe(s)}},createExhibition:async t=>{try{return await te.post("/exhibitions",t)}catch(s){return Oe(s)}},updateExhibition:async(t,s)=>{try{return await te.put(`/exhibitions/${t}`,s)}catch(n){return Oe(n)}},deleteExhibition:async t=>{try{return await te.delete(`/exhibitions/${t}`)}catch(s){return Oe(s)}},getHalls:async t=>{try{return await te.get(`/exhibitions/${t}/halls`)}catch(s){return Oe(s)}},createHall:async(t,s)=>{try{const{_id:n,id:i,createdAt:r,updatedAt:o,...a}=s;return console.log("Creating hall with data:",{exhibitionId:t,data:a}),(await te.post(`/exhibitions/${t}/halls`,a)).data}catch(n){throw console.error("Error creating hall:",n),n}},updateHall:async(t,s,n)=>{try{const{_id:i,id:r,createdAt:o,updatedAt:a,...p}=n;console.log("Updating hall with data:",{exhibitionId:t,hallId:s,data:p});const j=await te.put(`/exhibitions/${t}/halls/${s}`,p);return console.log("Hall updated:",j.data),j}catch(i){return console.error("Error updating hall:",i),Oe(i)}},deleteHall:async(t,s)=>{var n,i,r;try{if(!t||!s)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:t,hallId:s});const o=await te.delete(`/exhibitions/${t}/halls/${s}`);if(!o.data)throw new Error("No response received from server");return o}catch(o){throw console.error("Error deleting hall:",o),((n=o.response)==null?void 0:n.status)===401?new Error("Unauthorized. Please log in again."):((i=o.response)==null?void 0:i.status)===403?new Error("You do not have permission to delete halls."):((r=o.response)==null?void 0:r.status)===404?new Error("Hall not found."):o}},saveLayout:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return{data:{halls:s}}}catch(n){return Oe(n)}},getLayout:async t=>{try{if(!t)throw new Error("Exhibition ID is required");return await te.get(`/exhibitions/${t}/layout`)}catch(s){return Oe(s)}},getStalls:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return await te.get(`/exhibitions/${t}/stalls`,{params:{hallId:s}})}catch(n){return Oe(n)}},createStall:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return await te.post(`/exhibitions/${t}/stalls`,s)}catch(n){return Oe(n)}},updateStall:async(t,s,n)=>{try{if(!t||!s)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:t,stallId:s,data:n});const i=await te.put(`/exhibitions/${t}/stalls/${s}`,n);return console.log("Stall update response:",i),i}catch(i){return console.error("Error updating stall:",i),Oe(i)}},deleteStall:async(t,s)=>{try{if(!t||!s)throw new Error("Exhibition ID and Stall ID are required");return await te.delete(`/exhibitions/${t}/stalls/${s}`)}catch(n){return Oe(n)}},getFixtures:async(t,s)=>{try{const n=`/exhibitions/${t}/fixtures`,i=s?{type:s}:void 0;return await te.get(n,{params:i})}catch(n){return Oe(n)}},getFixture:async(t,s)=>{try{return await te.get(`/exhibitions/${t}/fixtures/${s}`)}catch(n){return Oe(n)}},createFixture:async(t,s)=>{try{return await te.post(`/exhibitions/${t}/fixtures`,s)}catch(n){return Oe(n)}},updateFixture:async(t,s,n)=>{try{return await te.put(`/exhibitions/${t}/fixtures/${s}`,n)}catch(i){return Oe(i)}},deleteFixture:async(t,s)=>{try{return await te.delete(`/exhibitions/${t}/fixtures/${s}`)}catch(n){return Oe(n)}}},$u={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},kt=we("exhibition/fetchExhibitions",async(t,{rejectWithValue:s})=>{try{return(await Ee.getExhibitions()).data.map(r=>({...r,id:r._id||r.id})).filter(r=>r.id)}catch(n){return s(n.message)}}),ft=we("exhibition/fetchExhibition",async(t,{rejectWithValue:s})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.getExhibition(t)).data}catch(n){return s(n.message)}}),Mn=we("exhibition/createExhibition",async(t,{rejectWithValue:s})=>{try{return(await Ee.createExhibition(t)).data}catch(n){return s(n.message)}}),Bn=we("exhibition/updateExhibition",async({id:t,data:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.updateExhibition(t,s)).data}catch(i){return n(i.message)}}),At=we("exhibition/fetchHalls",async(t,{rejectWithValue:s})=>{var n;try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.getHalls(t)).data}catch(i){return((n=i.response)==null?void 0:n.status)===404?[]:s(i.message)}}),Et=we("exhibition/fetchStalls",async({exhibitionId:t,hallId:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.getStalls(t,s)).data}catch(i){return n(i.message)}}),Os=we("exhibition/deleteExhibition",async(t,{rejectWithValue:s})=>{try{return await Ee.deleteExhibition(t),t}catch(n){return s(n.message)}}),Vs=we("exhibition/fetchFixtures",async({exhibitionId:t,type:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.getFixtures(t,s)).data}catch(i){return n(i.message)}}),zn=we("exhibition/createFixture",async({exhibitionId:t,data:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ee.createFixture(t,s)).data}catch(i){return n(i.message)}}),_n=we("exhibition/updateFixture",async({exhibitionId:t,id:s,data:n},{rejectWithValue:i})=>{try{if(!t||!s)throw new Error("Exhibition ID and Fixture ID are required");return(await Ee.updateFixture(t,s,n)).data}catch(r){return i(r.message)}}),qn=we("exhibition/deleteFixture",async({exhibitionId:t,id:s},{rejectWithValue:n})=>{try{if(!t||!s)throw new Error("Exhibition ID and Fixture ID are required");return await Ee.deleteFixture(t,s),s}catch(i){return n(i.message)}}),yo=nt({name:"exhibition",initialState:$u,reducers:{clearCurrentExhibition:t=>{t.currentExhibition=null,t.halls=[],t.stalls=[],t.fixtures=[],t.error=null},clearError:t=>{t.error=null},clearStalls:t=>{t.stalls=[]},clearFixtures:t=>{t.fixtures=[]}},extraReducers:t=>{t.addCase(kt.pending,s=>{s.loading=!0,s.error=null}).addCase(kt.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions=n.payload}).addCase(kt.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(ft.pending,s=>{s.loading=!0,s.error=null}).addCase(ft.fulfilled,(s,n)=>{s.loading=!1,s.currentExhibition=n.payload}).addCase(ft.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Mn.pending,s=>{s.loading=!0,s.error=null}).addCase(Mn.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions.push(n.payload)}).addCase(Mn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Bn.pending,s=>{s.loading=!0,s.error=null}).addCase(Bn.fulfilled,(s,n)=>{s.loading=!1,s.currentExhibition=n.payload;const i=s.exhibitions.findIndex(r=>r.id===n.payload.id);i!==-1&&(s.exhibitions[i]=n.payload)}).addCase(Bn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(At.pending,s=>{s.loading=!0,s.error=null}).addCase(At.fulfilled,(s,n)=>{s.loading=!1,s.halls=n.payload}).addCase(At.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Et.pending,s=>{s.loading=!0,s.error=null}).addCase(Et.fulfilled,(s,n)=>{s.loading=!1;const i=n.payload.map(r=>{var o;return{...r,id:r._id||r.id,_id:r._id||r.id,stallTypeId:typeof r.stallTypeId=="string"?r.stallTypeId:(o=r.stallTypeId)==null?void 0:o._id,stallType:r.stallType||{name:"N/A",description:null}}});n.meta.arg.hallId,s.stalls=i}).addCase(Et.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Os.pending,s=>{s.loading=!0,s.error=null}).addCase(Os.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions=s.exhibitions.filter(i=>(i._id||i.id)!==n.payload)}).addCase(Os.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Vs.pending,s=>{s.loading=!0,s.error=null}).addCase(Vs.fulfilled,(s,n)=>{s.loading=!1,s.fixtures=n.payload.map(i=>({...i,id:i._id||i.id,_id:i._id||i.id}))}).addCase(Vs.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(zn.pending,s=>{s.loading=!0,s.error=null}).addCase(zn.fulfilled,(s,n)=>{s.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id};s.fixtures.push(i)}).addCase(zn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(_n.pending,s=>{s.loading=!0,s.error=null}).addCase(_n.fulfilled,(s,n)=>{s.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id},r=s.fixtures.findIndex(o=>o.id===i.id||o._id===i._id);r!==-1&&(s.fixtures[r]=i)}).addCase(_n.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(qn.pending,s=>{s.loading=!0,s.error=null}).addCase(qn.fulfilled,(s,n)=>{s.loading=!1,s.fixtures=s.fixtures.filter(i=>i.id!==n.payload&&i._id!==n.payload)}).addCase(qn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),{clearCurrentExhibition:cx,clearError:dx,clearStalls:ux,clearFixtures:hx}=yo.actions,Lu=yo.reducer,qe=(t,s)=>{if(!t)return"";let i=`/exhibition/${t.slug||t._id||t.id}`;return s&&(i+=`/${s}`),i},oi=(t,s)=>t?`/exhibitions/${t.slug||t._id||t.id}`:"",{Title:Mu,Text:Gt}=ue,{RangePicker:Bu}=tn,zu=()=>{const{message:t,modal:s}=Je.useApp(),n=Se(),i=Ie(),{exhibitions:r,loading:o}=he(b=>b.exhibition),[a,p]=c.useState([]),[j,d]=c.useState(!1),[I,f]=c.useState(!1),[x,E]=c.useState({status:[],dateRange:null,search:"",activeStatus:null}),[w,y]=c.useState("all");c.useEffect(()=>{i(kt())},[i]);const C=c.useMemo(()=>{const b=r.length,D=r.filter(R=>R.status==="published").length,M=r.filter(R=>new Date(R.startDate)>new Date).length,F=r.filter(R=>R.status==="completed").length,S=r.filter(R=>R.isActive).length;return{total:b,active:D,upcoming:M,completed:F,activeCount:S}},[r]),l=async b=>{const D=b._id||b.id;try{d(!0),await i(Os(D)).unwrap(),t.success("Exhibition deleted successfully")}catch(M){t.error(M.message||"Failed to delete exhibition")}finally{d(!1)}},m=async()=>{s.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ut,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsxs("strong",{children:[a.length," selected exhibitions"]}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(q,{onClick:()=>ye.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(q,{danger:!0,type:"primary",onClick:async()=>{try{d(!0),await Promise.all(a.map(b=>i(Os(b._id||b.id)).unwrap())),t.success(`Successfully deleted ${a.length} exhibitions`),p([])}catch(b){t.error(b.message||"Failed to delete some exhibitions")}finally{d(!1),ye.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},P=async(b,D)=>{try{f(!0);const M=b._id||b.id;await Ee.updateExhibition(M,{status:D});const F=r.map(S=>(S._id||S.id)===M?{...S,status:D}:S);i(kt.fulfilled(F,"",void 0)),t.success("Status updated successfully")}catch{t.error("Failed to update status"),i(kt())}finally{f(!1)}},h=async(b,D)=>{try{f(!0);const M=b._id||b.id;await Ee.updateExhibition(M,{isActive:D});const F=r.map(S=>(S._id||S.id)===M?{...S,isActive:D}:S);i(kt.fulfilled(F,"",void 0)),t.success(`Exhibition ${D?"activated":"deactivated"} successfully`)}catch{t.error("Failed to update active status"),i(kt())}finally{f(!1)}},u=(b,D)=>{const M=b._id||b.id;D==="/layout"?n(qe(b,"layout"),{state:{exhibitionId:M}}):n(qe(b)+D,{state:{exhibitionId:M}})},N=b=>{switch(b.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},g=(b,D)=>{const M=N(b);return e.jsxs(X,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[e.jsx(re,{color:M,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:b}),!D&&e.jsx(re,{color:"red",style:{margin:0},children:"Inactive"})]})},A=b=>{const D=new Date,M=new Date(b.startDate),F=new Date(b.endDate);if(D<M)return 0;if(D>F)return 100;const S=F.getTime()-M.getTime(),R=D.getTime()-M.getTime();return Math.round(R/S*100)},$=b=>{s.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ut,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsx("strong",{children:b.name}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(q,{onClick:()=>ye.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(q,{danger:!0,type:"primary",onClick:()=>{l(b),ye.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},T=b=>[{key:"view",label:"View Details",icon:e.jsx(Mt,{}),onClick:()=>u(b,"")},{key:"edit",label:"Edit Exhibition",icon:e.jsx(Cs,{}),onClick:()=>u(b,"/edit")},{key:"layout",label:"Manage Layout",icon:e.jsx(os,{}),onClick:()=>u(b,"/layout")},{type:"divider"},...b.status==="published"?[{key:"public-view",label:"Public View",icon:e.jsx(Mt,{}),onClick:()=>window.open(oi(b),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:e.jsx(sr,{}),children:[{key:"draft",label:e.jsxs(X,{children:[e.jsx(re,{color:"#faad14",style:{margin:0},children:"Draft"}),e.jsx("span",{children:"Set as Draft"})]}),icon:e.jsx(Ut,{}),onClick:()=>P(b,"draft"),disabled:b.status==="draft"||I},{key:"published",label:e.jsxs(X,{children:[e.jsx(re,{color:"#52c41a",style:{margin:0},children:"Published"}),e.jsx("span",{children:"Publish"})]}),icon:e.jsx($e,{}),onClick:()=>P(b,"published"),disabled:b.status==="published"||I},{key:"completed",label:e.jsxs(X,{children:[e.jsx(re,{color:"#1890ff",style:{margin:0},children:"Completed"}),e.jsx("span",{children:"Mark as Completed"})]}),icon:e.jsx(Ge,{}),onClick:()=>P(b,"completed"),disabled:b.status==="completed"||I}]},{key:"active-status",label:e.jsxs(X,{children:[b.isActive?e.jsx(re,{color:"red",style:{margin:0},children:"Deactivate"}):e.jsx(re,{color:"#52c41a",style:{margin:0},children:"Activate"}),e.jsx("span",{children:b.isActive?"Deactivate":"Activate"})]}),icon:e.jsx(yr,{}),onClick:()=>h(b,!b.isActive),disabled:I},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(ut,{}),danger:!0,onClick:()=>$(b)}],v=c.useMemo(()=>r.filter(b=>{if(x.search&&!b.name.toLowerCase().includes(x.search.toLowerCase())||x.status.length>0&&!x.status.includes(b.status)||x.activeStatus!==null&&b.isActive!==x.activeStatus)return!1;if(x.dateRange){const[D,M]=x.dateRange,F=new Date(b.startDate),S=new Date(b.endDate);if(F<new Date(D)||S>new Date(M))return!1}switch(w){case"active":return b.status==="published";case"upcoming":return new Date(b.startDate)>new Date;case"completed":return b.status==="completed";default:return!0}}),[r,x,w]),k=[{title:"Exhibition Details",key:"details",render:(b,D)=>e.jsx(Gt,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>u(D,""),children:D.name})},{title:"Status",key:"status",width:180,align:"center",render:(b,D)=>g(D.status,D.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(b,D)=>D.status===b},{title:"Start Date",key:"startDate",width:130,render:(b,D)=>e.jsx(Gt,{children:Te(D.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(b,D)=>e.jsx(Gt,{children:Te(D.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(b,D)=>e.jsx(Gt,{children:Te(D.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(b,D)=>e.jsx(qt,{percent:A(D),size:"small",status:D.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(b,D)=>e.jsxs(X,{size:"middle",children:[e.jsx(We,{title:"View Details",children:e.jsx(q,{type:"text",icon:e.jsx(Mt,{}),onClick:()=>u(D,"")})}),e.jsx(We,{title:"Edit Exhibition",children:e.jsx(q,{type:"text",icon:e.jsx(Cs,{}),onClick:()=>u(D,"/edit")})}),e.jsx(Ot,{menu:{items:T(D)},trigger:["click"],placement:"bottomRight",children:e.jsx(q,{type:"text",icon:e.jsx(si,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(se,{gutter:[24,24],align:"middle",children:[e.jsx(z,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(Mu,{level:4,style:{margin:0},children:"Exhibitions"}),e.jsx(Gt,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),e.jsx(z,{children:e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),onClick:()=>n("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),e.jsxs(se,{gutter:[24,24],style:{marginBottom:"24px"},children:[e.jsx(z,{xs:24,sm:12,md:6,lg:4,children:e.jsx(K,{children:e.jsx(ve,{title:"Total Exhibitions",value:C.total,prefix:e.jsx(Ut,{})})})}),e.jsx(z,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ve,{title:"Published Exhibitions",value:C.active,prefix:e.jsx($e,{style:{color:"#52c41a"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ve,{title:"Upcoming Exhibitions",value:C.upcoming,prefix:e.jsx(Ge,{style:{color:"#1890ff"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ve,{title:"Completed Exhibitions",value:C.completed,prefix:e.jsx($e,{style:{color:"#8c8c8c"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ve,{title:"Active Status",value:C.activeCount,prefix:e.jsx(yr,{style:{color:"#52c41a"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:e.jsxs(X,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(se,{gutter:[16,16],align:"middle",children:[e.jsx(z,{flex:"auto",children:e.jsxs(X,{size:"middle",wrap:!0,children:[e.jsx(Q,{placeholder:"Search exhibitions",prefix:e.jsx(Bt,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:x.search,onChange:b=>E(D=>({...D,search:b.target.value})),allowClear:!0}),e.jsx(le,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:x.status,onChange:b=>E(D=>({...D,status:b})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),e.jsxs(le,{placeholder:"Active Status",style:{width:"150px"},value:x.activeStatus,onChange:b=>E(D=>({...D,activeStatus:b})),allowClear:!0,children:[e.jsx(le.Option,{value:!0,children:"Active"}),e.jsx(le.Option,{value:!1,children:"Inactive"})]}),e.jsx(Bu,{onChange:b=>E(D=>{var M,F;return{...D,dateRange:b?[((M=b[0])==null?void 0:M.toISOString())||"",((F=b[1])==null?void 0:F.toISOString())||""]:null}})})]})}),e.jsx(z,{children:e.jsx(Uo,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:w,onChange:b=>y(b)})})]}),a.length>0&&e.jsx(se,{children:e.jsxs(X,{children:[e.jsxs(Gt,{children:["Selected ",a.length," items"]}),e.jsx(q,{danger:!0,onClick:m,children:"Delete Selected"})]})})]})}),e.jsx(K,{className:"info-card",styles:{body:{padding:0}},children:e.jsx(De,{columns:k,dataSource:v.map(b=>({...b,key:b._id||b.id})),rowKey:b=>b._id||b.id,loading:o||j||I,rowSelection:{selectedRowKeys:a.map(b=>b._id||b.id),onChange:(b,D)=>p(D),selections:[De.SELECTION_ALL,De.SELECTION_NONE]},footer:()=>a.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[e.jsxs(Gt,{children:["Selected ",e.jsx("strong",{children:a.length})," ",a.length===1?"exhibition":"exhibitions"]}),e.jsx(q,{danger:!0,onClick:m,icon:e.jsx(ut,{}),loading:j,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:b=>`Total ${b} items`,style:{marginTop:"16px"}}})})]})},ws={getStallTypes:async()=>te.get("/stall-types"),createStallType:async t=>te.post("/stall-types",t),updateStallType:async(t,s)=>te.put(`/stall-types/${t}`,s),deleteStallType:async t=>te.delete(`/stall-types/${t}`)},{RangePicker:_u}=tn,{Title:Dt,Text:Ft}=ue,na=({value:t="",onChange:s})=>{const n=Pe.useRef(null),[i]=Pe.useState(t);return e.jsx(Il,{apiKey:rd,onInit:(r,o)=>{n.current=o},value:t,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:r=>{r.on("init",()=>{r.undoManager.clear(),r.undoManager.add()}),r.on("change",()=>{r.undoManager.add()})}},onEditorChange:r=>{s==null||s(r)}})},qu=({form:t})=>{const[s,n]=c.useState([]),[i,r]=c.useState(!1);return c.useEffect(()=>{(async()=>{try{r(!0);const a=await ws.getStallTypes();n(a.data.filter(p=>p.status==="active"))}catch(a){console.error("Failed to fetch stall types:",a)}finally{r(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(Dt,{level:4,children:"Basic Information"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),e.jsxs(se,{gutter:24,children:[e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:e.jsx(Q,{placeholder:"Enter exhibition name"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(Q.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:e.jsx(Q.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:e.jsx(Q,{placeholder:"Enter invoice prefix (default: INV)"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:e.jsx(_u,{style:{width:"100%"}})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Dt,{level:4,children:"Company Details"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),e.jsxs(se,{gutter:24,children:[e.jsxs(z,{span:12,children:[e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(Q,{placeholder:"Enter company name"})}),e.jsx(L.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:e.jsx(Q,{placeholder:"Enter contact number"})}),e.jsx(L.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{placeholder:"Enter email address"})}),e.jsx(L.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(Q.TextArea,{rows:4,placeholder:"Enter company address"})}),e.jsx(L.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:e.jsx(na,{})})]}),e.jsxs(z,{span:12,children:[e.jsx(L.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:e.jsx(Q,{placeholder:"Enter PAN number"})}),e.jsx(L.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:e.jsx(Q,{placeholder:"Enter GST number"})}),e.jsx(L.Item,{name:"companySAC",label:"SAC Code No.",children:e.jsx(Q,{placeholder:"Enter SAC code number"})}),e.jsx(L.Item,{name:"companyCIN",label:"CIN No.",children:e.jsx(Q,{placeholder:"Enter CIN number"})}),e.jsx(L.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:e.jsx(Q,{placeholder:"Enter website URL"})}),e.jsx(L.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:e.jsx(na,{})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Dt,{level:4,children:"Bank Details"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),e.jsxs(se,{gutter:24,children:[e.jsxs(z,{span:12,children:[e.jsx(L.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:e.jsx(Q,{placeholder:"Enter bank name"})}),e.jsx(L.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:e.jsx(Q,{placeholder:"Enter branch name"})}),e.jsx(L.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:e.jsx(Q,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),e.jsxs(z,{span:12,children:[e.jsx(L.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:e.jsx(Q,{placeholder:"Enter account name"})}),e.jsx(L.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:e.jsx(Q,{placeholder:"Enter account number"})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Dt,{level:4,children:"Stall Rates & Pricing"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Dt,{level:5,children:"Stall Type Rates"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),e.jsx(L.List,{name:"stallRates",children:(o,{add:a,remove:p})=>e.jsxs(e.Fragment,{children:[o.map(({key:j,name:d,...I})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...I,name:[d,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(le,{loading:i,placeholder:"Select stall type",style:{width:200},children:s.map(f=>e.jsx(le.Option,{value:f._id,children:f.name},f._id))})}),e.jsx(L.Item,{...I,name:[d,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:e.jsx(ze,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"",formatter:f=>`${f}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:f=>{const x=f?Number(f.replace(/\\s?|(,*)/g,"")):0;return isNaN(x)?0:x}})}),e.jsx(vs,{onClick:()=>p(d)})]},j)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(rt,{}),children:"Add Stall Type Rate"})})]})})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Dt,{level:5,children:"Tax Configuration"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),e.jsx(L.List,{name:"taxConfig",children:(o,{add:a,remove:p})=>e.jsxs(e.Fragment,{children:[o.map(({key:j,name:d,...I})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...I,name:[d,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:e.jsx(Q,{placeholder:"Tax name",style:{width:150}})}),e.jsx(L.Item,{...I,name:[d,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:e.jsx(ze,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:f=>`${f}%`,parser:f=>{const x=f?Number(f.replace("%","")):0;return isNaN(x)?0:Math.min(x,100)}})}),e.jsx(L.Item,{...I,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(vs,{onClick:()=>p(d)})]},j)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(rt,{}),children:"Add Tax"})})]})})]}),e.jsxs("div",{children:[e.jsx(Dt,{level:5,children:"Admin Discount Configuration"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),e.jsx(L.List,{name:"discountConfig",children:(o,{add:a,remove:p})=>e.jsxs(e.Fragment,{children:[o.map(({key:j,name:d,...I})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...I,name:[d,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(Q,{placeholder:"Discount",style:{width:150}})}),e.jsx(L.Item,{...I,name:[d,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(le,{style:{width:150},children:[e.jsx(le.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(le.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx(L.Item,{noStyle:!0,shouldUpdate:(f,x)=>{var E,w,y,C;return((w=(E=f==null?void 0:f.discountConfig)==null?void 0:E[d])==null?void 0:w.type)!==((C=(y=x==null?void 0:x.discountConfig)==null?void 0:y[d])==null?void 0:C.type)},children:({getFieldValue:f})=>{const x=f(["discountConfig",d,"type"]);return e.jsx(L.Item,{...I,name:[d,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(ze,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:E=>x==="percentage"?`${E}%`:`${E}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:E=>{const w=E?Number(E.replace(/[%,]/g,"")):0;return isNaN(w)?0:w}})})}}),e.jsx(L.Item,{...I,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(vs,{onClick:()=>p(d)})]},j)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(rt,{}),children:"Add Admin Discount"})})]})})]}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(Dt,{level:5,children:"Public Discount Configuration"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),e.jsx(L.List,{name:"publicDiscountConfig",children:(o,{add:a,remove:p})=>e.jsxs(e.Fragment,{children:[o.map(({key:j,name:d,...I})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...I,name:[d,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(Q,{placeholder:"Discount",style:{width:150}})}),e.jsx(L.Item,{...I,name:[d,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(le,{style:{width:150},children:[e.jsx(le.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(le.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx(L.Item,{noStyle:!0,shouldUpdate:(f,x)=>{var E,w,y,C;return((w=(E=f==null?void 0:f.publicDiscountConfig)==null?void 0:E[d])==null?void 0:w.type)!==((C=(y=x==null?void 0:x.publicDiscountConfig)==null?void 0:y[d])==null?void 0:C.type)},children:({getFieldValue:f})=>{const x=f(["publicDiscountConfig",d,"type"]);return e.jsx(L.Item,{...I,name:[d,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(ze,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:E=>x==="percentage"?`${E}%`:`${E}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:E=>{const w=E?Number(E.replace(/[%,]/g,"")):0;return isNaN(w)?0:w}})})}}),e.jsx(L.Item,{...I,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(vs,{onClick:()=>p(d)})]},j)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(rt,{}),children:"Add Public Discount"})})]})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Dt,{level:4,children:"Status Settings"}),e.jsx(Ft,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),e.jsxs(se,{gutter:24,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(le,{children:[e.jsx(le.Option,{value:"draft",children:"Draft"}),e.jsx(le.Option,{value:"published",children:"Published"}),e.jsx(le.Option,{value:"completed",children:"Completed"})]})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:ia,Text:vi}=ue,Uu=({form:t})=>{const{message:s}=Je.useApp(),[n,i]=c.useState([]),[r,o]=c.useState([]),[a,p]=c.useState(0),[j,d]=c.useState({}),I=y=>{const C=localStorage.getItem("token");return{url:`${te.defaults.baseURL}/uploads/${y}`,token:C}};c.useEffect(()=>{const y=t.getFieldValue("headerLogo");if(y){const{url:C,token:l}=I(y);fetch(C,{headers:{authorization:`Bearer ${l}`}}).then(m=>m.blob()).then(m=>{const P=URL.createObjectURL(m);i([{uid:"-1",name:y.split("/").pop()||"logo",status:"done",url:P,thumbUrl:P,type:m.type,response:{path:y}}])}).catch(()=>{i([])})}},[t]),c.useEffect(()=>{const y=t.getFieldValue("sponsorLogos")||[];y.length>0&&Promise.all(y.map(async(C,l)=>{const{url:m,token:P}=I(C);try{const u=await(await fetch(m,{headers:{authorization:`Bearer ${P}`}})).blob(),N=URL.createObjectURL(u);return{uid:`-${l+1}`,name:C.split("/").pop()||`sponsor-${l+1}`,status:"done",url:N,thumbUrl:N,type:u.type,response:{path:C}}}catch{return null}})).then(C=>{o(C.filter(Boolean))})},[t]);const f={name:"file",action:`${te.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(y){const{status:C,name:l,response:m,uid:P}=y.file;if(C==="uploading"){i([...y.fileList]);return}if(C==="done"&&m){const{url:h,token:u}=I(m.path);p(0),fetch(h,{headers:{authorization:`Bearer ${u}`}}).then(N=>N.blob()).then(N=>{const g=URL.createObjectURL(N);i([{uid:y.file.uid,name:l,status:"done",url:g,thumbUrl:g,type:N.type,response:m}]),s.success(`${l} uploaded successfully`),t.setFieldValue("headerLogo",m.path),m.thumbnail&&t.setFieldValue("headerLogoThumbnail",m.thumbnail)}).catch(()=>{s.error(`${l} preview failed to load`),i([])})}else C==="error"?(s.error(`${l} upload failed.`),i([]),p(0)):C==="removed"&&(i([]),t.setFieldValue("headerLogo",null),t.setFieldValue("headerLogoThumbnail",null),p(0))},customRequest:async y=>{const{onProgress:C,onSuccess:l,onError:m,file:P,action:h,headers:u}=y;try{const N=new FormData;N.append("file",P);const g=new XMLHttpRequest;g.open("POST",h||"",!0),u&&Object.keys(u).forEach(A=>{g.setRequestHeader(A,u[A])}),g.upload.onprogress=A=>{A.lengthComputable&&C&&(C({percent:A.loaded/A.total*100}),p(Math.round(A.loaded/A.total*100)))},g.onload=()=>{if(g.status>=200&&g.status<300)try{const A=JSON.parse(g.response);l==null||l(A,P),p(0)}catch(A){m==null||m(A)}else m==null||m(new Error("Upload failed"))},g.onerror=()=>{p(0),m==null||m(new Error("Upload request failed"))},g.send(N)}catch(N){p(0),m==null||m(N)}},onRemove(){return i([]),t.setFieldValue("headerLogo",null),t.setFieldValue("headerLogoThumbnail",null),p(0),!0},onPreview:async y=>{if(!y.url)return;const C=window.open("");C&&(C.document.write(`
          <img src="${y.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),C.document.head.innerHTML="<title>Image Preview</title>")}},x={name:"file",action:`${te.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:r,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(y){const{status:C,name:l,response:m,uid:P}=y.file;if(C==="uploading"){o([...y.fileList]);return}if(C==="done"&&m&&m.paths&&m.paths.length>0){d(g=>{const A={...g};return delete A[P],A});const h=m.paths[0],{url:u,token:N}=I(h);fetch(u,{headers:{authorization:`Bearer ${N}`}}).then(g=>g.blob()).then(g=>{const A=URL.createObjectURL(g),$=[...r],T=$.findIndex(b=>b.uid===y.file.uid),v={uid:y.file.uid,name:l,status:"done",url:A,thumbUrl:A,type:g.type,response:{path:h}};T>-1?$[T]=v:$.push(v),o($),s.success(`${l} uploaded successfully`);const k=$.filter(b=>{var D;return b.status==="done"&&((D=b.response)==null?void 0:D.path)}).map(b=>b.response.path);if(t.setFieldValue("sponsorLogos",k),m.thumbnails&&m.thumbnails.length>0){const b=t.getFieldValue("sponsorLogoThumbnails")||[];t.setFieldValue("sponsorLogoThumbnails",[...b,...m.thumbnails])}}).catch(()=>{s.error(`${l} preview failed to load`),o(g=>g.filter(A=>A.uid!==y.file.uid))})}else C==="error"?(s.error(`${l} upload failed.`),o(h=>h.filter(u=>u.uid!==y.file.uid)),d(h=>{const u={...h};return delete u[P],u})):C==="removed"&&d(h=>{const u={...h};return delete u[P],u})},customRequest:async y=>{const{onProgress:C,onSuccess:l,onError:m,file:P,action:h,headers:u}=y,N=typeof P=="object"&&"uid"in P?P.uid:String(Date.now());try{const g=new FormData;g.append("file",P);const A=new XMLHttpRequest;A.open("POST",h||"",!0),u&&Object.keys(u).forEach($=>{A.setRequestHeader($,u[$])}),A.upload.onprogress=$=>{if($.lengthComputable&&C){const T=$.loaded/$.total*100;C({percent:T}),d(v=>({...v,[N]:Math.round(T)}))}},A.onload=()=>{if(A.status>=200&&A.status<300)try{const $=JSON.parse(A.response);l==null||l($,P),d(T=>{const v={...T};return delete v[N],v})}catch($){m==null||m($)}else m==null||m(new Error("Upload failed"))},A.onerror=()=>{d($=>{const T={...$};return delete T[N],T}),m==null||m(new Error("Upload request failed"))},A.send(g)}catch(g){d(A=>{const $={...A};return delete $[N],$}),m==null||m(g)}},onRemove(y){var P;const C=r.filter(h=>h.uid!==y.uid);o(C);const l=C.filter(h=>{var u;return h.status==="done"&&((u=h.response)==null?void 0:u.path)}).map(h=>h.response.path);t.setFieldValue("sponsorLogos",l);const m=t.getFieldValue("sponsorLogoThumbnails")||[];if(m.length>0&&(P=y.response)!=null&&P.path){const h=y.response.path.split("/"),u=h[h.length-1],N=m.filter(g=>!g.includes(u));t.setFieldValue("sponsorLogoThumbnails",N)}return d(h=>{const u={...h};return delete u[y.uid],u}),!0},onPreview:async y=>{if(!y.url)return;const C=window.open("");C&&(C.document.write(`
          <img src="${y.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),C.document.head.innerHTML="<title>Image Preview</title>")}},E=e.jsx("div",{children:a>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(qt,{type:"circle",percent:a,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),w=e.jsxs("div",{children:[e.jsx(Qs,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return e.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:e.jsxs(K,{className:"settings-card",children:[e.jsx(ia,{level:4,children:"Header Settings"}),e.jsx(vi,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),e.jsxs(se,{gutter:24,children:[e.jsx(z,{span:24,children:e.jsxs(L.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(Ys,{...f,children:n.length<1&&E}),n.length>0&&a>0&&e.jsx(qt,{percent:a,status:"active",style:{marginTop:8}})]})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:e.jsx(Q,{placeholder:"Enter a title for your exhibition header"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:e.jsx(Q,{placeholder:"Enter a subtitle (optional)"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:e.jsx(Q.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),e.jsxs(z,{span:24,children:[e.jsx(Ce,{}),e.jsx(ia,{level:5,children:"Sponsor Logos"}),e.jsx(vi,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),e.jsxs(L.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[e.jsx(Ys,{...x,children:w}),Object.entries(j).map(([y,C])=>{var l;return e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[e.jsxs(vi,{style:{marginRight:10,width:150},ellipsis:!0,children:[((l=r.find(m=>m.uid===y))==null?void 0:l.name)||"File",":"]}),e.jsx(qt,{percent:C,status:"active",style:{flex:1}})]},y)})]})]})]})]})})},{Title:ra,Text:aa}=ue,Ou=({form:t})=>{const{message:s}=Je.useApp(),[n,i]=c.useState([]),r=a=>{const p=localStorage.getItem("token");return{url:`${te.defaults.baseURL}/uploads/${a}`,token:p}};c.useEffect(()=>{const a=t.getFieldValue("footerLogo");if(a){const{url:p,token:j}=r(a);fetch(p,{headers:{authorization:`Bearer ${j}`}}).then(d=>d.blob()).then(d=>{const I=URL.createObjectURL(d);i([{uid:"-1",name:a.split("/").pop()||"logo",status:"done",url:I,thumbUrl:I,type:d.type,response:{path:a}}])}).catch(()=>{i([])})}},[t]);const o={name:"file",action:`${te.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:p,name:j,response:d}=a.file;if(p==="uploading"){i([...a.fileList]);return}if(p==="done"&&d){const{url:I,token:f}=r(d.path);fetch(I,{headers:{authorization:`Bearer ${f}`}}).then(x=>x.blob()).then(x=>{const E=URL.createObjectURL(x);i([{uid:a.file.uid,name:j,status:"done",url:E,thumbUrl:E,type:x.type,response:d}]),s.success(`${j} uploaded successfully`),t.setFieldValue("footerLogo",d.path)}).catch(()=>{s.error(`${j} preview failed to load`),i([])})}else p==="error"?(s.error(`${j} upload failed.`),i([])):p==="removed"&&(i([]),t.setFieldValue("footerLogo",null))},onRemove(){return i([]),t.setFieldValue("footerLogo",null),!0},onPreview:async a=>{if(!a.url)return;const p=window.open("");p&&(p.document.write(`
          <img src="${a.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),p.document.head.innerHTML="<title>Image Preview</title>")}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(ra,{level:4,children:"Footer Content"}),e.jsx(aa,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),e.jsxs(se,{gutter:24,children:[e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:e.jsx(Ys,{...o,children:n.length<1&&e.jsxs("div",{children:[e.jsx(Qs,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:e.jsx(Q.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:e.jsx(Q,{placeholder:"Enter contact email"})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:e.jsx(Q,{placeholder:"Enter contact phone number"})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(ra,{level:4,children:"Footer Links"}),e.jsx(aa,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),e.jsx(L.List,{name:"footerLinks",children:(a,{add:p,remove:j})=>e.jsxs(e.Fragment,{children:[a.map(({key:d,name:I,...f})=>e.jsxs(se,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(z,{span:11,children:e.jsx(L.Item,{...f,name:[I,"label"],rules:[{required:!0,message:"Please enter link label"}],children:e.jsx(Q,{placeholder:"Link Label"})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{...f,name:[I,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:e.jsx(Q,{placeholder:"URL (e.g., https://example.com)"})})}),e.jsx(z,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(vs,{onClick:()=>j(I)})})]},d)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>p(),block:!0,icon:e.jsx(rt,{}),children:"Add Footer Link"})})]})})]})]})},{Title:oa,Text:la}=ue,Vu=()=>e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(oa,{level:4,children:"Exhibition Amenities"}),e.jsx(la,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add amenities and facilities available at your exhibition with their rates"}),e.jsx(L.List,{name:"amenities",children:(t,{add:s,remove:n})=>e.jsxs(e.Fragment,{children:[t.map(({key:i,name:r,...o})=>e.jsxs(se,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(z,{span:6,children:e.jsx(L.Item,{...o,name:[r,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(le,{placeholder:"Select type",children:[e.jsx(le.Option,{value:"facility",children:"Facility"}),e.jsx(le.Option,{value:"service",children:"Service"}),e.jsx(le.Option,{value:"equipment",children:"Equipment"}),e.jsx(le.Option,{value:"other",children:"Other"})]})})}),e.jsx(z,{span:6,children:e.jsx(L.Item,{...o,name:[r,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(Q,{placeholder:"Enter name (e.g. Power)"})})}),e.jsx(z,{span:7,children:e.jsx(L.Item,{...o,name:[r,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(Q.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(z,{span:4,children:e.jsx(L.Item,{...o,name:[r,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:e.jsx(ze,{style:{width:"100%"},placeholder:"Enter rate",prefix:"",min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:a=>{const p=a?Number(a.replace(/\\s?|(,*)/g,"")):0;return isNaN(p)?0:p}})})}),e.jsx(z,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(vs,{onClick:()=>n(r)})})]},i)),e.jsx(L.Item,{children:e.jsx(q,{type:"dashed",onClick:()=>s(),block:!0,icon:e.jsx(rt,{}),children:"Add Amenity"})})]})})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(oa,{level:4,children:"Special Requirements"}),e.jsx(la,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),e.jsx(se,{gutter:24,children:e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:e.jsx(Q.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),bo=({initialValues:t,onSubmit:s,submitText:n="Submit"})=>{const[i]=L.useForm(),r=a=>{s(a)},o=[{key:"general",label:"General",children:e.jsx(qu,{form:i})},{key:"header",label:"Header",children:e.jsx(Uu,{form:i})},{key:"footer",label:"Footer",children:e.jsx(Ou,{form:i})},{key:"amenities",label:"Amenities",children:e.jsx(Vu,{form:i})}];return e.jsx(L,{form:i,layout:"vertical",initialValues:t,onFinish:r,style:{height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,marginBottom:"24px"},children:e.jsx(tt,{defaultActiveKey:"general",items:o,type:"card"})}),e.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:e.jsx(q,{type:"primary",htmlType:"submit",children:n})})]})})},Hu=()=>{const t=Se(),s=Ie(),n=async i=>{var r;try{const[o,a]=i.dateRange,p={name:i.name,description:i.description,venue:i.venue,startDate:o.toISOString(),endDate:a.toISOString(),status:i.status||"draft",isActive:i.isActive??!0,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:{width:100,height:100},taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((r=i.amenities)==null?void 0:r.map(I=>({type:I.type,name:I.name,description:I.description,rate:I.rate})))||[],specialRequirements:i.specialRequirements},j=await s(Mn(p)).unwrap();ee.success("Exhibition created successfully");const d=j._id||j.id;d?t(qe({_id:d,id:d,name:p.name}),{state:{exhibitionId:d}}):(ee.error("Exhibition ID not found in response"),t("/exhibition"))}catch(o){ee.error(o.message||"Failed to create exhibition"),console.error("Error creating exhibition:",o)}};return e.jsx(K,{title:"Create New Exhibition",children:e.jsx(bo,{onSubmit:n,submitText:"Create Exhibition"})})},{Title:ca,Text:Ke,Paragraph:wi}=ue,Si=()=>{const t=Se();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>t("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Wu=()=>{const{id:t}=pt(),s=Se(),n=Ie(),{currentExhibition:i,halls:r,stalls:o,loading:a}=he(y=>y.exhibition),[p,j]=c.useState(0);c.useEffect(()=>{t&&(n(ft(t)),n(At(t)),n(Et({exhibitionId:t})))},[t,n]),c.useEffect(()=>{i&&I()},[i]);const d=()=>{if(!i)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const y=r.length||0;let C=o.length||0,l=o.filter(m=>m.status==="booked"||m.status==="reserved").length;return C===0&&(i.stalls&&i.stalls.length>0?(C=i.stalls.length,l=i.stalls.filter(m=>m.status==="booked"||m.status==="reserved").length):(C=i.stallCount||0,l=i.bookedStallCount||0)),{hallCount:y,stallCount:C,bookedStallCount:l,availableStallCount:C-l}},I=()=>{if(!i)return 0;const y=new Date,C=new Date(i.startDate),l=new Date(i.endDate);if(y<C)return j(0);if(y>l)return j(100);const m=l.getTime()-C.getTime(),P=y.getTime()-C.getTime();j(Math.round(P/m*100))},f=y=>{switch(y.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},x=()=>{if(!i)return{text:"",count:0,isPast:!1};const y=new Date,C=new Date(i.startDate),l=new Date(i.endDate);return y>l?{text:"Ended",count:Math.ceil((y.getTime()-l.getTime())/864e5),isPast:!0}:y>=C&&y<=l?{text:"Days Remaining",count:Math.ceil((l.getTime()-y.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((C.getTime()-y.getTime())/(1e3*60*60*24)),isPast:!1}},E=y=>{s(qe(i,y))};if(a)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Si,{}),e.jsx(K,{children:e.jsx($a,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!i)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Si,{}),e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(en,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx(ca,{level:4,children:"Exhibition not found"}),e.jsx(wi,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const w=x();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(Si,{}),e.jsx(K,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(se,{gutter:[24,24],align:"middle",children:[e.jsxs(z,{xs:24,md:16,children:[e.jsx(ca,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:i.name}),e.jsx(wi,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:i.description}),e.jsxs(X,{split:e.jsx(Ce,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(X,{children:[e.jsx(Ct,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(Ke,{style:{color:"rgba(255,255,255,0.8)"},children:[Te(i.startDate).format("MMM D, YYYY")," - ",Te(i.endDate).format("MMM D, YYYY")]})]}),i.venue&&e.jsxs(X,{children:[e.jsx(ns,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(Ke,{style:{color:"rgba(255,255,255,0.8)"},children:i.venue})]})]})]}),e.jsx(z,{xs:24,md:8,children:e.jsxs(K,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:f(i.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:i.status.toUpperCase()}),e.jsx(ve,{title:w.text,value:w.count,suffix:"days",valueStyle:{color:w.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(Ge,{})}),e.jsx(Ce,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(Ke,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(qt,{percent:p,status:p===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),e.jsxs(se,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(z,{xs:24,sm:8,children:e.jsx(q,{type:"primary",icon:e.jsx(os,{}),onClick:()=>E(`${t}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(q,{icon:e.jsx(Cs,{}),onClick:()=>E(`${t}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(z,{xs:24,sm:8,children:e.jsx(q,{icon:e.jsx(Mt,{}),onClick:()=>window.open(oi(i),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:i.status!=="published",children:"View Public Page"})})]}),e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:24,lg:16,children:e.jsxs(K,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(se,{gutter:[24,24],children:[e.jsxs(z,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(Ke,{strong:!0,style:{fontSize:"16px"},children:Te(i.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(Ke,{strong:!0,style:{fontSize:"16px"},children:Te(i.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(Ke,{strong:!0,style:{fontSize:"16px"},children:Te(i.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(z,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(re,{color:f(i.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(re,{color:i.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.isActive?"ACTIVE":"INACTIVE"})]}),i.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(Ke,{strong:!0,style:{fontSize:"16px"},children:i.venue})]})]})]}),e.jsx(Ce,{}),e.jsxs("div",{children:[e.jsx(Ke,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(wi,{children:i.description||"No description provided."})]})]})}),e.jsxs(z,{xs:24,lg:8,children:[e.jsx(K,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:e.jsxs(se,{gutter:[16,24],children:[e.jsx(z,{span:12,children:e.jsx(ve,{title:"Halls",value:d().hallCount,prefix:e.jsx(sn,{})})}),e.jsx(z,{span:12,children:e.jsx(ve,{title:"Stalls",value:d().stallCount,prefix:e.jsx(ht,{})})}),e.jsx(z,{span:12,children:e.jsx(ve,{title:"Booked Stalls",value:d().bookedStallCount,prefix:e.jsx($e,{})})}),e.jsx(z,{span:12,children:e.jsx(ve,{title:"Available Stalls",value:d().availableStallCount,prefix:e.jsx(Oo,{})})})]})}),e.jsx(K,{title:"Created By",style:{borderRadius:"12px"},children:i.createdBy?e.jsxs(X,{children:[e.jsx(yt,{icon:e.jsx(ke,{})}),e.jsx(Ke,{children:i.createdByName||"Administrator"})]}):e.jsx(Ke,{type:"secondary",children:"Information not available"})})]})]})]})},Yu=()=>{var E;const{message:t}=Je.useApp(),{id:s}=pt(),i=(E=Tt().state)==null?void 0:E.exhibitionId,r=Se(),o=Ie(),{currentExhibition:a,loading:p,error:j}=he(w=>w.exhibition),[d,I]=c.useState(!1);c.useEffect(()=>{(async()=>{if(!i){t.error("Exhibition ID not found"),r("/exhibition");return}try{await o(ft(i)).unwrap()}catch(y){t.error(y.message||"Failed to fetch exhibition"),r("/exhibition")}finally{I(!0)}})()},[i,o,t,r]),c.useEffect(()=>{j&&t.error(j)},[j,t]);const f=async w=>{var y;if(!(!i||!a))try{const[C,l]=w.dateRange,m={name:w.name,description:w.description,venue:w.venue,startDate:C.toISOString(),endDate:l.toISOString(),status:w.status,isActive:w.isActive,invoicePrefix:w.invoicePrefix,stallRates:w.stallRates||[],dimensions:a.dimensions,taxConfig:w.taxConfig||[],discountConfig:w.discountConfig||[],publicDiscountConfig:w.publicDiscountConfig||[],companyName:w.companyName,companyContactNo:w.companyContactNo,companyEmail:w.companyEmail,companyAddress:w.companyAddress,companyWebsite:w.companyWebsite,companyPAN:w.companyPAN,companyGST:w.companyGST,companySAC:w.companySAC,companyCIN:w.companyCIN,termsAndConditions:w.termsAndConditions,piInstructions:w.piInstructions,bankName:w.bankName,bankBranch:w.bankBranch,bankIFSC:w.bankIFSC,bankAccountName:w.bankAccountName,bankAccount:w.bankAccount,headerTitle:w.headerTitle,headerSubtitle:w.headerSubtitle,headerDescription:w.headerDescription,headerLogo:w.headerLogo,sponsorLogos:w.sponsorLogos||[],footerText:w.footerText,footerLogo:w.footerLogo,contactEmail:w.contactEmail,contactPhone:w.contactPhone,footerLinks:w.footerLinks||[],amenities:((y=w.amenities)==null?void 0:y.map(P=>({type:P.type,name:P.name,description:P.description,rate:P.rate})))||[],specialRequirements:w.specialRequirements};await o(Bn({id:i,data:m})).unwrap(),t.success("Exhibition updated successfully"),r(qe(a),{state:{exhibitionId:i}})}catch(C){t.error(C.message||"Failed to update exhibition")}};if(!d)return e.jsx(K,{loading:!0});if(!i)return e.jsx(Ss,{to:"/exhibition",replace:!0});if(p||!a)return e.jsx(K,{loading:!0});const x={name:a.name,description:a.description,venue:a.venue,dateRange:[Te(a.startDate),Te(a.endDate)],status:a.status,isActive:a.isActive,invoicePrefix:a.invoicePrefix,stallRates:a.stallRates||[],taxConfig:a.taxConfig||[],discountConfig:a.discountConfig||[],publicDiscountConfig:a.publicDiscountConfig||[],companyName:a.companyName,companyContactNo:a.companyContactNo,companyEmail:a.companyEmail,companyAddress:a.companyAddress,companyWebsite:a.companyWebsite,companyPAN:a.companyPAN,companyGST:a.companyGST,companySAC:a.companySAC,companyCIN:a.companyCIN,termsAndConditions:a.termsAndConditions,piInstructions:a.piInstructions,bankName:a.bankName,bankBranch:a.bankBranch,bankIFSC:a.bankIFSC,bankAccountName:a.bankAccountName,bankAccount:a.bankAccount,headerTitle:a.headerTitle,headerSubtitle:a.headerSubtitle,headerDescription:a.headerDescription,headerLogo:a.headerLogo,sponsorLogos:a.sponsorLogos||[],footerText:a.footerText,footerLogo:a.footerLogo,contactEmail:a.contactEmail,contactPhone:a.contactPhone,footerLinks:a.footerLinks||[],amenities:a.amenities||[],specialRequirements:a.specialRequirements};return e.jsx(K,{title:"Edit Exhibition",extra:e.jsx("a",{onClick:()=>r(qe(a),{state:{exhibitionId:i}}),children:"Back to Details"}),children:e.jsx(bo,{initialValues:x,onSubmit:f,submitText:"Update Exhibition"})})},da=({width:t,height:s,scale:n=1,position:i={x:0,y:0},isSelected:r=!1,onSelect:o=()=>{},onChange:a=()=>{},children:p,isEditable:j=!0})=>{const d=f=>{j&&(o(),f.cancelBubble=!0)},I=Pe.useMemo(()=>{const f=[];for(let E=0;E<=t;E+=5)f.push(e.jsx(Xn,{points:[E,0,E,s],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`v${E}`));for(let E=0;E<=s;E+=5)f.push(e.jsx(Xn,{points:[0,E,t,E],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`h${E}`));return f},[t,s,n]);return e.jsxs(Es,{x:i.x,y:i.y,width:t,height:s,onClick:d,children:[e.jsx(ni,{width:t,height:s,fill:"#ffffff",stroke:r&&j?"#1890ff":"#d9d9d9",strokeWidth:r&&j?2/n:1/n,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/n,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/n}),e.jsx(Es,{children:I}),e.jsx(Xs,{text:`${t}m  ${s}m`,fontSize:14/n,fill:"#666666",x:5,y:5}),p]})},Qu=({visible:t,width:s,height:n,onCancel:i,onSubmit:r})=>{const[o]=L.useForm();Pe.useEffect(()=>{t&&o.setFieldsValue({width:s,height:n})},[t,s,n,o]);const a=()=>{o.validateFields().then(p=>{r(p),o.resetFields()})};return e.jsx(ye,{title:"Edit Exhibition Space",open:t,onCancel:()=>{o.resetFields(),i()},onOk:a,destroyOnClose:!0,children:e.jsxs(L,{form:o,layout:"vertical",initialValues:{width:s,height:n},children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},jo=({hall:t,isSelected:s=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:p=100,isStallMode:j=!1})=>{const d=Pe.useRef(null),I=Pe.useRef(null),f=Pe.useMemo(()=>{const l=[],{width:m,height:P}=t.dimensions,h=1;for(let u=0;u<=m;u+=h)l.push(e.jsx(Xn,{points:[u,0,u,P],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`v${u}`));for(let u=0;u<=P;u+=h)l.push(e.jsx(Xn,{points:[0,u,m,u],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`h${u}`));return l},[t.dimensions.width,t.dimensions.height,r]);Pe.useEffect(()=>{var l;s&&I.current&&d.current&&(I.current.nodes([d.current]),(l=I.current.getLayer())==null||l.batchDraw())},[s]);const x=l=>{l.cancelBubble=!0;const m=l.target,P=m.x(),h=m.y(),u=Math.max(0,Math.min(P,a-t.dimensions.width)),N=Math.max(0,Math.min(h,p-t.dimensions.height));m.x(Math.round(u)),m.y(Math.round(N))},E=l=>{l.cancelBubble=!0;const m=l.target,P=Math.max(0,Math.min(m.x(),a-t.dimensions.width)),h=Math.max(0,Math.min(m.y(),p-t.dimensions.height));i==null||i({...t,_id:t._id,id:t.id||t._id,exhibitionId:t.exhibitionId,dimensions:{...t.dimensions,x:Math.round(P),y:Math.round(h)}})},w=l=>{l.cancelBubble=!0},y=l=>{if(!d.current)return;const m=d.current,P=m.scaleX(),h=m.scaleY();m.scaleX(1),m.scaleY(1);const u=Math.round(m.width()*P),N=Math.round(m.height()*h),g=m.x(),A=m.y(),$=Math.max(0,Math.min(g,a-u)),T=Math.max(0,Math.min(A,p-N));i==null||i({...t,_id:t._id,id:t.id||t._id,exhibitionId:t.exhibitionId,dimensions:{x:$,y:T,width:Math.max(5,Math.min(u,a-$)),height:Math.max(5,Math.min(N,p-T))}})},C=l=>{l.cancelBubble=!0,n==null||n(t)};return e.jsxs(Es,{ref:d,x:t.dimensions.x,y:t.dimensions.y,width:t.dimensions.width,height:t.dimensions.height,draggable:!j&&!!i,onClick:C,onTap:C,onDragStart:w,onDragMove:x,onDragEnd:E,onTransformEnd:y,children:[e.jsx(ni,{width:t.dimensions.width,height:t.dimensions.height,fill:"#ffffff",stroke:s?"#1890ff":"#d9d9d9",strokeWidth:s?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}),e.jsx(Es,{children:f}),e.jsx(Xs,{text:t.name,fontSize:14/r,fill:"#000000",width:t.dimensions.width,align:"center",y:t.dimensions.height/2-7/r})]})},Gu=t=>{if(!t)return"";const s=window.location.origin,n=t.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${s}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${s}/api/uploads/${n}?token=${i}`:""},vo=({fixture:t,isSelected:s=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:p=100,isEditable:j=!0})=>{const d=Pe.useRef(null),I=Pe.useRef(null),[f,x]=c.useState("");c.useEffect(()=>{if(t.icon){const h=Gu(t.icon);x(h)}else x("")},[t.icon]);const[E]=Cl(f);Pe.useEffect(()=>{var h;s&&I.current&&d.current&&(I.current.nodes([d.current]),(h=I.current.getLayer())==null||h.batchDraw())},[s]);const w=h=>{h.cancelBubble=!0},y=h=>{h.cancelBubble=!0;const u=h.target,N=u.x(),g=u.y(),A=Math.max(0,Math.min(N,a-t.dimensions.width)),$=Math.max(0,Math.min(g,p-t.dimensions.height));u.x(Math.round(A)),u.y(Math.round($))},C=h=>{h.cancelBubble=!0;const u=h.target,N=u.x(),g=u.y(),A=Math.max(0,Math.min(N,a-t.dimensions.width)),$=Math.max(0,Math.min(g,p-t.dimensions.height)),T=t._id||t.id;i==null||i({...t,_id:T,id:T,exhibitionId:t.exhibitionId,position:{x:Math.round(A),y:Math.round($)}})},l=h=>{if(!d.current)return;const u=d.current,N=u.scaleX(),g=u.scaleY(),A=u.rotation();u.scaleX(1),u.scaleY(1);const $=Math.round(t.dimensions.width*N),T=Math.round(t.dimensions.height*g),v=u.x(),k=u.y(),b=Math.max(0,Math.min(v,a-$)),D=Math.max(0,Math.min(k,p-T)),M=t._id||t.id;i==null||i({...t,_id:M,id:M,exhibitionId:t.exhibitionId,position:{x:b,y:D},dimensions:{width:Math.max(.5,Math.min($,a-b)),height:Math.max(.5,Math.min(T,p-D))},rotation:A})},m=h=>{h.cancelBubble=!0,n==null||n(t)},P=()=>{const h=t.borderColor||(s?"#1890ff":"#d9d9d9"),u=t.borderRadius!==void 0?t.borderRadius/r:3/r;return E?e.jsx(Pl,{image:E,width:t.dimensions.width,height:t.dimensions.height,fill:t.color||"#ffffff",stroke:h,strokeWidth:s?2/r:1/r,cornerRadius:u,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}):e.jsx(ni,{width:t.dimensions.width,height:t.dimensions.height,fill:t.color||"#f0f2f5",stroke:h,strokeWidth:s?2/r:1/r,cornerRadius:u,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5})};return e.jsxs(e.Fragment,{children:[e.jsxs(Es,{ref:d,x:t.position.x,y:t.position.y,width:t.dimensions.width,height:t.dimensions.height,rotation:t.rotation||0,draggable:j&&!!i,onClick:m,onTap:m,onDragStart:w,onDragMove:y,onDragEnd:C,onTransformEnd:l,children:[P(),t.name&&t.showName!==!1&&e.jsx(Xs,{text:t.name,fontSize:12/r,fill:"#000000",width:t.dimensions.width,align:"center",y:-16/r})]}),s&&j&&e.jsx(El,{ref:I,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(h,u)=>u.width<.5||u.height<.5?h:u})]})},Ku=({visible:t,x:s,y:n,onExhibitionClick:i,onHallClick:r,onStallClick:o,onFixtureClick:a,onClose:p})=>{if(!t)return null;const j=[{key:"exhibition",icon:e.jsx(os,{}),label:"Exhibition Space",onClick:()=>{i(),p()}},{key:"hall",icon:e.jsx(sn,{}),label:"Add Hall",onClick:()=>{r(),p()}}];return o&&j.push({key:"stall",icon:e.jsx(ht,{}),label:"Add Stall",onClick:()=>{o(),p()}}),a&&j.push({key:"fixture",icon:e.jsx(Gn,{}),label:"Add Fixture",onClick:()=>{a(),p()}}),e.jsx("div",{style:{position:"fixed",top:n,left:s,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:e.jsx(ct,{items:j})})},Xu=({stall:t,isSelected:s=!1,onSelect:n,onChange:i,hallWidth:r=0,hallHeight:o=0,hallX:a=0,hallY:p=0,scale:j=1,isDragging:d=!1})=>{const I=c.useRef(null),[f,x]=c.useState(!1),[E,w]=c.useState(!1),[y,C]=c.useState(!1);c.useEffect(()=>{C(window.innerWidth<768);const M=()=>{C(window.innerWidth<768)};return window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[]),c.useEffect(()=>{if(f&&!d)w(!0);else if(d)w(!1);else{const M=setTimeout(()=>{w(!1)},100);return()=>clearTimeout(M)}},[f,d]),c.useEffect(()=>{if(f&&I.current&&!d){if(y&&!s)return;I.current.getStage()&&I.current.moveToTop()}},[f,s,y,d]);const l=s||t.isSelected,m=c.useCallback(M=>{switch(M){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),P=c.useCallback(M=>{switch(M){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),h=c.useCallback(M=>{M.cancelBubble=!0;const F=M.target,S=F.x()-a,R=F.y()-p,B=Math.max(0,Math.min(S,r-t.dimensions.width)),_=Math.max(0,Math.min(R,o-t.dimensions.height));F.x(Math.round(B+a)),F.y(Math.round(_+p))},[a,p,r,o,t.dimensions.width,t.dimensions.height]),u=c.useCallback(M=>{if(M.cancelBubble=!0,!i)return;const F=M.target,S=F.x()-a,R=F.y()-p,B=Math.max(0,Math.min(S,r-t.dimensions.width)),_=Math.max(0,Math.min(R,o-t.dimensions.height));i({...t,id:t.id||t._id,_id:t._id||t.id,dimensions:{...t.dimensions,x:Math.round(B),y:Math.round(_)}})},[i,a,p,r,o,t]),N=c.useCallback(M=>{M.cancelBubble=!0},[]),g=c.useCallback(M=>{M.cancelBubble=!0,n&&!d&&n()},[n,d]),A=c.useCallback(()=>{y&&!l||d||x(!0)},[y,l,d]),$=c.useCallback(()=>{x(!1)},[]),T={x:0,y:0,width:10,height:10},v=t.dimensions||T,k=t.typeName||"Standard";t.ratePerSqm*v.width*v.height;const b=0,D=c.useMemo(()=>t.status!=="available"&&t.companyName?`${k} - ${v.width}${v.height}m - ${t.companyName}`:`${k} - ${v.width}${v.height}m`,[k,v.width,v.height,t.status,t.companyName]);return e.jsxs(Es,{ref:I,x:v.x+a,y:v.y+p,width:v.width,height:v.height,draggable:!!i,onClick:g,onTap:g,onDragStart:N,onDragMove:h,onDragEnd:u,opacity:t.status==="available"?1:.7,cursor:t.status==="available"?"pointer":"default",onMouseEnter:A,onMouseLeave:$,listening:d?!1:!y||t.status==="available",transformsEnabled:d||y?"position":"all",children:[e.jsx(ni,{width:v.width,height:v.height,fill:l?"rgba(24, 144, 255, 0.1)":P(t.status),stroke:l?"#1890ff":m(t.status),strokeWidth:l?2/j:1/j,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:d?0:y?2:3,shadowOffset:{x:1,y:1},shadowOpacity:d?0:.3,rotation:b,perfectDrawEnabled:!d,transformsEnabled:d?"position":"all",cornerRadius:.05}),e.jsx(Xs,{text:t.number,fontSize:Math.min(v.width,v.height)*.25,fill:"#000000",width:v.width,height:v.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!d,fontStyle:"bold",listening:!1}),l&&!d&&e.jsx(Al,{x:v.width-2,y:2,radius:1.5,fill:"#1890ff",stroke:"#ffffff",strokeWidth:.3/j,transformsEnabled:"position",listening:!1}),E&&!d&&e.jsxs(Nl,{x:v.width/2,y:0,opacity:1,listening:!1,children:[e.jsx(Tl,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),e.jsx(Xs,{text:D,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(D.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},xr=c.memo(Xu),on=({width:t,height:s,exhibitionWidth:n=100,exhibitionHeight:i=100,halls:r=[],stalls:o=[],fixtures:a=[],selectedHall:p=null,selectedFixture:j=null,onSelectHall:d=()=>{},onSelectFixture:I=()=>{},onHallChange:f=()=>{},onFixtureChange:x=()=>{},onExhibitionChange:E=()=>{},onAddHall:w=()=>{},onAddStall:y=()=>{},onAddFixture:C=()=>{},children:l,isStallMode:m=!1,isFixtureMode:P=!1,isPublicView:h=!1})=>{const u=c.useRef(null),N=c.useRef(null),g=c.useRef(null),[A,$]=c.useState(1),[T,v]=c.useState({x:0,y:0}),[k,b]=c.useState(!1),[D,M]=c.useState(!1),[F,S]=c.useState({visible:!1,x:0,y:0}),[R,B]=c.useState(!1),[_,V]=c.useState(!1),[Y,G]=c.useState(!1);c.useEffect(()=>{const oe=()=>{G(window.innerWidth<768)};return oe(),window.addEventListener("resize",oe),()=>{window.removeEventListener("resize",oe)}},[]);const H=c.useCallback(oe=>{if(oe.evt.preventDefault(),!u.current)return;const fe=u.current,pe=A,Le=fe.getPointerPosition(),et={x:(Le.x-fe.x())/pe,y:(Le.y-fe.y())/pe},st=1.15,xt=oe.evt.deltaY<0?pe*st:pe/st,Wt=Math.min(Math.max(.1,xt),20),Ns={x:Le.x-et.x*Wt,y:Le.y-et.y*Wt};$(Wt),v(Ns)},[A]),U=c.useCallback(()=>{if(!u.current)return;const oe=u.current,fe=Math.min(A*1.15,20),pe=oe.width()/2,Le=oe.height()/2,et={x:(pe-T.x)/A,y:(Le-T.y)/A},st={x:pe-et.x*fe,y:Le-et.y*fe};$(fe),v(st)},[A,T]),W=c.useCallback(()=>{if(!u.current)return;const oe=u.current,fe=Math.max(A/1.15,.1),pe=oe.width()/2,Le=oe.height()/2,et={x:(pe-T.x)/A,y:(Le-T.y)/A},st={x:pe-et.x*fe,y:Le-et.y*fe};$(fe),v(st)},[A,T]),J=c.useCallback(oe=>{oe.target===u.current&&(S({...F,visible:!1}),M(!0),N.current&&(N.current.hitGraphEnabled(!1),h&&u.current&&(u.current.container().style.cursor="grabbing",N.current.getChildren().forEach(pe=>{pe.shadowForStrokeEnabled&&(pe._savedShadowForStroke=pe.shadowForStrokeEnabled(),pe.shadowForStrokeEnabled(!1)),pe.perfectDrawEnabled&&(pe._savedPerfectDraw=pe.perfectDrawEnabled(),pe.perfectDrawEnabled(!1))}))))},[F,h]),de=c.useCallback(oe=>{h&&oe.target===u.current||oe.target===u.current&&Y&&N.current&&(oe.cancelBubble=!0)},[Y,h]),ce=c.useCallback(oe=>{oe.target===u.current&&(v({x:oe.target.x(),y:oe.target.y()}),N.current&&(N.current.hitGraphEnabled(!0),h&&u.current&&(u.current.container().style.cursor="",N.current.getChildren().forEach(pe=>{pe._savedShadowForStroke!==void 0&&(pe.shadowForStrokeEnabled(pe._savedShadowForStroke),delete pe._savedShadowForStroke),pe._savedPerfectDraw!==void 0&&(pe.perfectDrawEnabled(pe._savedPerfectDraw),delete pe._savedPerfectDraw)}))),u.current&&u.current.batchDraw(),M(!1))},[h]),ae=c.useCallback(()=>{b(!0),document.body.style.cursor=D?"grabbing":"grab"},[D]),ne=c.useCallback(()=>{b(!1),document.body.style.cursor="default"},[]),ge=oe=>{var pe,Le,et;const fe=oe.target.getClassName();if(fe==="Stage"||fe==="Layer"){S({...F,visible:!1});return}if(fe==="Group"||fe==="Rect"){d(null),I(null);const st=(pe=u.current)==null?void 0:pe.getPointerPosition();if(st&&Ye(st)){const{x:xt,y:Wt}=st,{x:Ns,y:ko}=((Le=u.current)==null?void 0:Le.position())||{x:0,y:0},{x:Io,y:Co}=((et=u.current)==null?void 0:et.scale())||{x:1,y:1},Eo=(xt-Ns)/Io,Po=(Wt-ko)/Co;S({x:Eo,y:Po,visible:!0})}else S({...F,visible:!1})}else S({...F,visible:!1})},Ye=oe=>{if(!n||!i||!u.current)return!1;const{x:fe,y:pe}=oe,{x:Le,y:et}=u.current.position(),{x:st}=u.current.scale(),xt={x:(fe-Le)/st,y:(pe-et)/st};return xt.x>=0&&xt.x<=n&&xt.y>=0&&xt.y<=i},O=c.useCallback(()=>{d(null),I(null),B(!0),V(!0),S({...F,visible:!1})},[d,I,F]),ie=c.useCallback(oe=>{E(oe),V(!1)},[E]),me=()=>{B(!0),V(!0),S({...F,visible:!1})},Ae=()=>{w(),S({...F,visible:!1})},Ue=()=>{y(),S({...F,visible:!1})};c.useEffect(()=>{if(t>0&&s>0&&n>0&&i>0){const oe=m?20:40,fe=t-oe*2,pe=s-oe*2,Le=fe/n,et=pe/i,xt=Math.min(Le,et),Wt=(t-n*xt)/2,Ns=(s-i*xt)/2;$(xt),v({x:Wt,y:Ns}),u.current&&u.current.batchDraw()}},[t,s,n,i,m]);const at=Pe.Children.map(l,oe=>Pe.isValidElement(oe)?Pe.cloneElement(oe,{scale:A,position:T}):oe),As=e.jsx(da,{width:n,height:i,scale:A,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return t<=0||s<=0||n<=0||i<=0?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:k?D?"grabbing":"grab":"default"},children:[e.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:e.jsxs(X,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[e.jsx(q,{icon:e.jsx(Vo,{}),onClick:W,disabled:A<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),e.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(A*100),"%"]}),e.jsx(q,{icon:e.jsx(Ho,{}),onClick:U,disabled:A>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),e.jsxs(Rl,{ref:u,width:t,height:s,onClick:ge,draggable:!0,onDragStart:J,onDragMove:de,onDragEnd:ce,onMouseEnter:ae,onMouseLeave:ne,onWheel:H,x:T.x,y:T.y,scaleX:A,scaleY:A,perfectDrawEnabled:!D&&!h,hitGraphEnabled:!D,pixelRatio:Math.min(1.5,window.devicePixelRatio||1),dragDistance:h?0:3,children:[h&&e.jsx(Dl,{ref:g,listening:!1,children:As}),e.jsxs(Fl,{ref:N,imageSmoothingEnabled:!D||!h,children:[!h&&e.jsx(da,{width:n,height:i,scale:A,position:{x:0,y:0},isSelected:R,onSelect:P?void 0:O,onChange:m||P?void 0:E,isEditable:!m&&!P}),r.map(oe=>e.jsx(jo,{hall:oe,isSelected:(p==null?void 0:p.id)===oe.id,onSelect:()=>d(oe),onChange:m||P?void 0:f,scale:A,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isStallMode:m||P},oe._id||oe.id)),o.map(oe=>{const fe=oe._id||oe.id,pe=r.find(Le=>Le.id===oe.hallId||Le._id===oe.hallId);return pe?e.jsx(xr,{stall:{...oe,_id:fe,id:fe},hallX:pe.dimensions.x,hallY:pe.dimensions.y,hallWidth:pe.dimensions.width,hallHeight:pe.dimensions.height,scale:A,isDragging:D&&h},fe):null}),a.map(oe=>{const fe=oe._id||oe.id,Le=((j==null?void 0:j._id)||(j==null?void 0:j.id))===fe;return e.jsx(vo,{fixture:{...oe,_id:fe,id:fe},isSelected:Le,onSelect:()=>I(oe),onChange:P?x:void 0,scale:A,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isEditable:P},fe)}),at]})]}),e.jsx(Ku,{visible:F.visible,x:F.x,y:F.y,onExhibitionClick:me,onHallClick:Ae,onStallClick:Ue,onClose:()=>S({...F,visible:!1})}),e.jsx(Qu,{visible:_,width:n,height:i,onCancel:()=>V(!1),onSubmit:ie})]})},Zu=({visible:t,hall:s,exhibitionWidth:n,exhibitionHeight:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[p]=L.useForm();Pe.useEffect(()=>{t&&(s?p.setFieldsValue({name:s.name,width:s.dimensions.width,height:s.dimensions.height}):p.setFieldsValue({name:"",width:Math.min(10,n),height:Math.min(10,i)}))},[t,s,n,i,p]);const j=async()=>{var x,E;const I=await p.validateFields(),f=s?{...s,_id:s._id,id:s.id||s._id,name:I.name,dimensions:{x:((x=s.dimensions)==null?void 0:x.x)||0,y:((E=s.dimensions)==null?void 0:E.y)||0,width:I.width,height:I.height},exhibitionId:s.exhibitionId}:{name:I.name,dimensions:{x:0,y:0,width:I.width,height:I.height}};o(f),p.resetFields()},d=()=>{s&&a&&ye.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${s.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>a(s)})};return e.jsx(ye,{title:s?"Edit Hall":"Add New Hall",open:t,onCancel:()=>{p.resetFields(),r()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:e.jsxs(L,{form:p,layout:"vertical",style:{marginTop:"16px"},children:[e.jsx(L.Item,{name:"name",label:e.jsxs("span",{style:{color:"#000"},children:["Hall Name ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:e.jsx(Q,{placeholder:"Enter hall name"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsx(L.Item,{name:"width",label:e.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:n,message:`Width cannot exceed ${n} meters`}],children:e.jsx(ze,{min:5,max:n,style:{width:"100%"},placeholder:"Enter width"})}),e.jsx(L.Item,{name:"height",label:e.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:i,message:`Height cannot exceed ${i} meters`}],children:e.jsx(ze,{min:5,max:i,style:{width:"100%"},placeholder:"Enter height"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[e.jsx(X,{children:s&&a&&e.jsx(q,{className:"delete-button",icon:e.jsx(ut,{}),onClick:d,children:"Delete Hall"})}),e.jsxs(X,{children:[e.jsx(q,{onClick:()=>{p.resetFields(),r()},children:"Cancel"}),e.jsx(q,{type:"primary",onClick:j,className:"update-button",children:s?"Update Hall":"Create Hall"})]})]})]})})},{Title:Ju}=ue,eh=({visible:t,stall:s,hall:n,exhibition:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[p]=L.useForm(),[j,d]=c.useState([]),[I,f]=c.useState(!1),x=(l,m,P,h,u)=>{const g=[...P].sort(($,T)=>{const v=Math.floor($.dimensions.y/5),k=Math.floor(T.dimensions.y/5);return v===k?$.dimensions.x-T.dimensions.x:$.dimensions.y-T.dimensions.y}),A=($,T)=>$+l>h||T+m>u?!1:!g.some(v=>{const k=v.dimensions.x,b=v.dimensions.y,D=v.dimensions.width,M=v.dimensions.height,F=1;return!($+l+F<=k||$>=k+D+F||T+m+F<=b||T>=b+M+F)});for(const $ of g){const T=$.dimensions.x+$.dimensions.width+1,v=$.dimensions.y;if(A(T,v))return{x:T,y:v};const k=$.dimensions.x,b=$.dimensions.y+$.dimensions.height+1;if(A(k,b))return{x:k,y:b}}for(let $=0;$<u;$+=5)for(let T=0;T<h;T+=5)if(A(T,$))return{x:T,y:$};return{x:0,y:0}};c.useEffect(()=>{if(s){console.log("Setting form values for stall:",s);const l={number:s.number,stallTypeId:s.stallTypeId,width:s.dimensions.width,height:s.dimensions.height,ratePerSqm:s.ratePerSqm,status:s.status};console.log("Form values to set:",l),p.setFieldsValue(l)}else n&&!p.getFieldValue("status")&&p.setFieldsValue({status:"available",width:Math.min(20,n.dimensions.width/4),height:Math.min(20,n.dimensions.height/4),ratePerSqm:0})},[s,n,p]),c.useEffect(()=>{t&&(async()=>{var m;try{f(!0);const P=await ws.getStallTypes();console.log("Fetched stall types:",P.data);const h=((m=i.stallRates)==null?void 0:m.map(N=>N.stallTypeId))||[];console.log("Configured stall type IDs:",h);const u=P.data.filter(N=>N.status==="active"&&N._id&&h.includes(N._id));console.log("Filtered stall types:",u),d(u)}catch(P){console.error("Failed to fetch stall types:",P)}finally{f(!1)}})()},[t,i.stallRates]);const E=l=>{var P;console.log("Stall type changed to:",l);const m=(P=i.stallRates)==null?void 0:P.find(h=>h.stallTypeId===l);console.log("Found stall rate:",m),m&&p.setFieldsValue({ratePerSqm:m.rate})},w=()=>{p.resetFields(),r()},y=()=>{if(console.log("Hall data:",n),!n||!n._id&&!n.id){ee.error("Invalid hall selected. Please try again.");return}p.validateFields().then(l=>{var u;const m=n._id||n.id;if(!m){ee.error("Hall ID is missing. Please select a hall again.");return}const P=s?{x:s.dimensions.x,y:s.dimensions.y}:x(l.width,l.height,((u=i.stalls)==null?void 0:u.filter(N=>N.hallId===m))||[],n.dimensions.width,n.dimensions.height),h={id:s==null?void 0:s.id,_id:s==null?void 0:s._id,number:l.number,stallTypeId:l.stallTypeId,dimensions:{x:P.x,y:P.y,width:l.width,height:l.height},ratePerSqm:l.ratePerSqm,status:l.status,hallId:m};console.log("Submitting stall data:",h),o(h)})},C=l=>{switch(l){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return e.jsx(e.Fragment,{children:e.jsx(ye,{title:e.jsxs(X,{children:[e.jsx(ht,{style:{fontSize:"20px"}}),e.jsx(Ju,{level:4,style:{margin:0},children:s?"Edit Stall":"Add Stall"})]}),open:t,onCancel:w,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[e.jsxs(X,{size:"middle",children:[s&&a&&e.jsx(q,{danger:!0,icon:e.jsx(ut,{}),onClick:()=>a(s),children:"Delete"}),e.jsx(q,{onClick:w,children:"Cancel"}),e.jsx(q,{type:"primary",onClick:y,children:s?"Save Changes":"Create"})]},"footer-buttons")],children:e.jsxs(L,{form:p,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[e.jsx(L.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:e.jsx(Q,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),e.jsx(L.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(le,{loading:I,placeholder:"Select stall type",size:"large",onChange:E,children:j.map(l=>e.jsx(le.Option,{value:l._id,children:l.name},l._id))})}),e.jsx(Ce,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),e.jsxs(X,{style:{width:"100%",gap:"16px"},children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:e.jsx(ze,{min:1,max:(n==null?void 0:n.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:e.jsx(ze,{min:1,max:(n==null?void 0:n.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),e.jsx(Ce,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),e.jsx(L.Item,{name:"ratePerSqm",label:"Rate per sq.m ()",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:e.jsx(ze,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"",disabled:!0,formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>{const m=l?Number(l.replace(/\\s?|(,*)/g,"")):0;return isNaN(m)?0:m}})}),e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(le,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[e.jsx(le.Option,{value:"available",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:C("available")}}),"Available"]})}),e.jsx(le.Option,{value:"booked",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:C("booked")}}),"Booked"]})}),e.jsx(le.Option,{value:"reserved",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:C("reserved")}}),"Reserved"]})})]})})]})})})},ua=t=>{if(!t)return"";const s=window.location.origin,n=t.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${s}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${s}/api/uploads/${n}?token=${i}`:""},th=({name:t,type:s,color:n,rotation:i,showName:r,iconUrl:o,defaultIcons:a,borderColor:p=null,borderRadius:j=0})=>{c.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:t,type:s,color:n,rotation:i,showName:r,iconUrl:o,defaultIconAvailable:!!a[s],borderColor:p,borderRadius:j})},[t,s,n,i,r,o,a,p,j]);const d=a[s]||"";return e.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[e.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${j||4}px`,backgroundColor:n||"#f0f0f0",transform:`rotate(${i}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:p?`1px solid ${p}`:"1px solid rgba(0,0,0,0.05)"},children:o?e.jsx("img",{src:o,alt:t,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):e.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:d})}),r&&e.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:t}),e.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[e.jsx("span",{children:s.charAt(0).toUpperCase()+s.slice(1)}),e.jsx("span",{children:""}),e.jsx("span",{children:n}),i>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[i,""]})]}),p&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Border: ",p]})]}),j>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Radius: ",j,"px"]})]})]})]})},{Text:sh}=ue,ki=({activeKey:t,form:s,fixture:n,exhibitionWidth:i,exhibitionHeight:r,selectedType:o,showName:a,iconFileList:p,fixtureTypes:j,fixtureIcons:d,defaultColors:I,defaultDimensions:f,colorPresets:x,uploadProps:E,iconPreviewVisible:w=!1,previewImage:y="",onTypeChange:C,onColorChange:l,onShowNameChange:m,onIconPreviewCancel:P=()=>{}})=>{switch(t){case"basic":return h();case"position":return u();case"appearance":return N();default:return h()}function h(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(L.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:e.jsx(Q,{placeholder:"Enter fixture name",prefix:e.jsx(en,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(L.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:e.jsx(dt,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:g=>{m(g),console.log("Form values after showName toggle:",s.getFieldsValue(!0))}})}),e.jsx(L.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:e.jsx(le,{placeholder:"Select fixture type",onChange:C,options:j.map(g=>({...g,label:e.jsxs(X,{children:[e.jsx("span",{style:{fontSize:16},children:d[g.value]}),e.jsx("span",{children:g.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function u(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(K,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"X position"})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:0,max:r,step:.1,precision:1,placeholder:"Y position"})})})]})}),e.jsx(K,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),e.jsx(K,{size:"small",title:e.jsxs("span",{children:[e.jsx(Wo,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsx(L.Item,{name:"rotation",noStyle:!0,children:e.jsx(La,{min:0,max:360,marks:{0:"0",90:"90",180:"180",270:"270",360:"360"},tooltip:{formatter:g=>`${g}`},style:{marginTop:10},keyboard:!1})})})]})}function N(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(L.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(g,A)=>{try{return A?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:e.jsx(br,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:x,onChange:l,style:{width:"100%"}})}),e.jsx(L.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:e.jsx(br,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:x,style:{width:"100%"}})}),e.jsx(L.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:e.jsx(ze,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),e.jsxs(K,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[e.jsx("div",{style:{marginBottom:0},children:e.jsx(Ys,{...E,children:p.length<1&&e.jsxs("div",{children:[e.jsx(Yo,{style:{fontSize:20}}),e.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),e.jsx(sh,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),e.jsx(L.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:e.jsx(Q,{placeholder:"https://example.com/icon.png",prefix:e.jsx(Qo,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(ye,{open:w,title:"Icon Preview",footer:null,onCancel:P,children:e.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:y})})]})}},nh=t=>[{key:"basic",label:e.jsxs("span",{children:[e.jsx(sn,{}),"Basic Info"]}),children:e.jsx(ki,{...t,activeKey:"basic"})},{key:"position",label:e.jsxs("span",{children:[e.jsx(ns,{}),"Position"]}),children:e.jsx(ki,{...t,activeKey:"position"})},{key:"appearance",label:e.jsxs("span",{children:[e.jsx(Qs,{}),"Appearance"]}),children:e.jsx(ki,{...t,activeKey:"appearance"})}],{Text:px,Title:xx}=ue,{TabPane:mx}=tt,ih=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],jn={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},_t={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},Ii={sofa:"",chair:"",table:"",desk:"",plant:"",entrance:"",exit:"",info:"",restroom:"",food:"",custom:""},rh=({visible:t,fixture:s,onCancel:n,onSubmit:i,onDelete:r,exhibitionWidth:o,exhibitionHeight:a})=>{const[p]=L.useForm(),[j,d]=c.useState(!1),[I,f]=c.useState(""),[x,E]=c.useState("basic"),[w,y]=c.useState(""),[C,l]=c.useState([]),[m,P]=c.useState(!1),[h,u]=c.useState(""),{message:N}=Je.useApp(),[g,A]=c.useState("#f0f0f0"),[$,T]=c.useState("New Fixture"),[v,k]=c.useState("chair"),[b,D]=c.useState(0),[M,F]=c.useState(!0),[S,R]=c.useState(null),[B,_]=c.useState(0);c.useEffect(()=>{if(t)if(s){const O=J(s.color),ie=_t[s.type]||"#f0f0f0",me=O||ie;console.log("Setting up fixture colors:",{original:s.color,normalized:O,fallback:ie,final:me}),A(me),T(s.name),k(s.type),D(s.rotation||0),f(s.type),F(s.showName!==!1),R(s.borderColor||null),_(s.borderRadius||0)}else{const O="chair",ie=_t[O];A(ie),T("New Fixture"),k(O),D(0),f(O),F(!0),R(null),_(0)}},[t,s]),c.useEffect(()=>{if(t&&p){if(s){const O=J(s.color),ie=_t[s.type]||"#f0f0f0",me=O||ie;p.setFieldsValue({name:s.name,type:s.type,position:{x:s.position.x,y:s.position.y},dimensions:{width:s.dimensions.width,height:s.dimensions.height},rotation:s.rotation||0,color:me,icon:s.icon||"",showName:s.showName!==!1,borderColor:s.borderColor||null,borderRadius:s.borderRadius||0});const Ae=s.icon?ua(s.icon):"";y(Ae),s.icon?l([{uid:"-1",name:s.icon.split("/").pop()||"icon",status:"done",url:Ae,thumbUrl:Ae}]):l([])}else{const O="chair",ie=_t[O];p.setFieldsValue({name:"New Fixture",type:O,position:{x:Math.floor(o/2),y:Math.floor(a/2)},dimensions:jn[O],rotation:0,color:ie,icon:"",showName:!0,borderColor:null,borderRadius:0}),y(""),l([])}E("basic")}},[t,s,p,o,a]);const V=()=>{if(p&&t)try{const O=p.getFieldsValue(!0);if(O.name&&T(O.name),O.type&&k(O.type),O.rotation!==void 0&&D(O.rotation),O.color){const ie=J(O.color);ie&&A(ie)}if(O.showName!==void 0&&F(O.showName),O.borderColor!==void 0){const ie=O.borderColor?J(O.borderColor):null;R(ie)}O.borderRadius!==void 0&&_(O.borderRadius)}catch(O){console.log("Error updating preview",O)}};c.useEffect(()=>{if(p&&t)return p.getFieldsValue,V(),()=>{}},[p,t]);const Y=O=>{if(f(O),k(O),!s){const ie=_t[O]||_t.custom;p.setFieldsValue({dimensions:jn[O]||jn.custom,color:ie}),A(ie)}},G=O=>{const ie=J(O);p.setFieldValue("color",ie),A(ie);const me=Object.entries(_t).find(([Ae,Ue])=>Ue.toLowerCase()===ie.toLowerCase());me&&!s&&(p.setFieldValue("type",me[0]),f(me[0]),k(me[0]))},H=()=>(console.log("Rendering fixture preview with:",{name:$,type:v,color:g,rotation:b,showName:M,iconUrl:w,borderColor:S,borderRadius:B}),e.jsx(th,{name:$,type:v,color:g,rotation:b,showName:M,iconUrl:w,defaultIcons:Ii,borderColor:S,borderRadius:B})),U=({file:O,fileList:ie})=>{var me;if(O.status==="uploading"&&l(ie),O.status==="done"){N.success(`${O.name} uploaded successfully`);let Ue=(((me=O.response)==null?void 0:me.url)||"").replace(/^\/api\/uploads\//,"");Ue&&!Ue.startsWith("fixtures/")&&(Ue=`fixtures/${Ue.replace(/^\//,"")}`),console.log("Icon path stored in form:",Ue),p.setFieldValue("icon",Ue);const at=ua(Ue);console.log("Using direct backend URL:",at),y(at);const As=O.name.toLowerCase().endsWith(".svg"),oe=ie.map(fe=>fe.uid===O.uid?{...fe,url:at,thumbUrl:at,type:As?"image/svg+xml":fe.type}:fe);l(oe),console.log("Form values after icon upload:",p.getFieldsValue(!0))}O.status==="error"&&(N.error(`${O.name} upload failed.`),l(ie.filter(Ae=>Ae.uid!==O.uid)))},W={name:"file",action:`${te.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:C,onChange:U,onPreview:O=>{u(O.url||O.thumbUrl||""),P(!0)},onRemove:()=>(y(""),l([]),p.setFieldValue("icon",""),console.log("Form values after icon removal:",p.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:e.jsx(ut,{style:{color:"#ff4d4f"}})}},J=O=>{try{if(!O)return"#f0f0f0";if(typeof O=="object"&&O!==null){if(typeof O.toHexString=="function")return O.toHexString();if(O.rgb||O.hex)return O.hex||`rgb(${O.rgb.r},${O.rgb.g},${O.rgb.b})`}if(typeof O=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(O))return O;if(/^([0-9A-F]{3}){1,2}$/i.test(O))return`#${O}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(O))return O}return"#f0f0f0"}catch(ie){return console.error("Error normalizing color:",ie),"#f0f0f0"}},de=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],ce=Pe.useCallback(()=>{s&&r&&r(s)},[s,r]),ae=O=>{E(O),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},ne=nh({form:p,fixture:s,exhibitionWidth:o,exhibitionHeight:a,selectedType:I,showName:M,iconFileList:C,fixtureTypes:ih,fixtureIcons:Ii,defaultColors:_t,defaultDimensions:jn,colorPresets:de,uploadProps:W,iconPreviewVisible:m,previewImage:h,onTypeChange:Y,onColorChange:G,onShowNameChange:O=>F(O),onIconPreviewCancel:()=>P(!1),activeKey:x}),ge=async()=>{try{d(!0);const O=await p.validateFields();T(O.name),k(O.type),D(O.rotation||0),A(J(O.color)),F(O.showName),R(O.borderColor?J(O.borderColor):null),_(O.borderRadius||0);let ie="";O.icon?ie=Ye(O.icon):s!=null&&s.icon&&(ie=s.icon),console.log("Form values being submitted:",{name:O.name,type:O.type,color:O.color,icon:O.icon,originalIcon:s==null?void 0:s.icon,cleanedIcon:ie,showName:O.showName,borderColor:O.borderColor,borderRadius:O.borderRadius});const me=(s==null?void 0:s._id)||(s==null?void 0:s.id)||"",Ae=O.color?J(O.color):(s==null?void 0:s.color)||"#f0f0f0",Ue=O.borderColor?J(O.borderColor):null,at={...s,id:me,_id:me,name:O.name,type:O.type,position:O.position,dimensions:O.dimensions,rotation:O.rotation,color:Ae,icon:ie,zIndex:(s==null?void 0:s.zIndex)||1,isActive:(s==null?void 0:s.isActive)!==void 0?s.isActive:!0,borderColor:Ue,borderRadius:O.borderRadius||0};me&&(at.showName=O.showName),console.log("Submitting fixture with icon path:",ie),console.log("Color being submitted:",Ae),await i(at),n()}catch(O){console.error("Fixture submission failed:",O),N.error("Failed to save fixture. Please check the form and try again.")}finally{d(!1)}},Ye=O=>{if(!O||typeof O!="string")return"";if(O.startsWith("fixtures/")&&!O.includes("?")&&!O.includes("http"))return O;let ie=O.replace(/^\/api\/uploads\//,"");if(ie=ie.replace(/^\//,""),ie.includes("?")||ie.includes("http")){const me=ie.split("?")[0].split("/").pop()||"";if(me)return`fixtures/${me}`}return ie&&!ie.startsWith("fixtures/")?`fixtures/${ie}`:ie};return e.jsxs(ye,{title:e.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:24,marginRight:8},children:s?Ii[s.type]:""}),e.jsx("span",{children:s?`Edit ${s.name}`:"Add New Fixture"})]}),open:t,onCancel:n,confirmLoading:j,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:s&&r&&e.jsx(q,{danger:!0,icon:e.jsx(ut,{}),onClick:ce,style:{borderRadius:"6px"},children:"Delete"})}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(q,{onClick:n,icon:e.jsx(Go,{}),style:{borderRadius:"6px"},children:"Cancel"}),e.jsx(q,{type:"primary",onClick:ge,icon:e.jsx(as,{}),style:{borderRadius:"6px"},children:s?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),H(),e.jsx(L,{form:p,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:V,children:e.jsx(tt,{activeKey:x,onChange:ae,items:ne,tabBarStyle:{marginBottom:16},centered:!0})})]})},ah=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=Se(),{currentExhibition:r}=he(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>i(qe(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},oh=()=>{var w;const{id:t}=pt(),s=Tt(),n=Se(),i=Ie(),r=((w=s.state)==null?void 0:w.exhibitionId)||t,{currentExhibition:o}=he(y=>y.exhibition),a=c.useRef(null),[p,j]=c.useState({width:100,height:100}),[d,I]=c.useState({width:0,height:0}),[f]=L.useForm();c.useEffect(()=>{if(!r){ee.error("Exhibition ID not found"),n("/exhibition");return}i(ft(r))},[r,i,n]),c.useEffect(()=>{o!=null&&o.dimensions&&(j(o.dimensions),f.setFieldsValue(o.dimensions))},[o,f]),c.useEffect(()=>{const y=()=>{a.current&&I({width:a.current.clientWidth,height:a.current.clientHeight})};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]);const x=async()=>{try{const y=await f.validateFields();await Ee.updateExhibition(r,{dimensions:y}),ee.success("Exhibition space saved successfully"),await i(ft(r)).unwrap(),n(qe(o,"layout"),{state:{exhibitionId:r}})}catch{ee.error("Failed to save exhibition space")}},E=y=>{j(C=>({...C,...y})),f.setFieldsValue(y)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ah,{exhibitionId:r}),e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Space Setup"}),e.jsx(q,{type:"primary",icon:e.jsx(as,{}),onClick:x,children:"Save and Continue"})]}),children:e.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[e.jsx("div",{style:{flex:"0 0 300px"},children:e.jsxs(L,{form:f,layout:"vertical",initialValues:p,children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},onChange:y=>E({width:y||10})})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},onChange:y=>E({height:y||10})})})]})}),e.jsx("div",{ref:a,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:e.jsx(an,{children:e.jsx(on,{width:d.width,height:d.height,exhibitionWidth:p.width,exhibitionHeight:p.height,onExhibitionChange:E})})})]})})]})},lh=({exhibitionId:t})=>{const s=Se(),{currentExhibition:n}=he(i=>i.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>s(qe(n),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ch=()=>{var p,j,d,I,f;const{id:t}=pt(),s=Tt(),n=Se(),i=Ie(),r=((p=s.state)==null?void 0:p.exhibitionId)||t,{currentExhibition:o,halls:a}=he(x=>x.exhibition);return c.useEffect(()=>{r&&(i(ft(r)),i(At(r)))},[r,i]),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(lh,{exhibitionId:r}),e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(os,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),e.jsx(q,{type:"primary",onClick:()=>n(qe(o,"space"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(z,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(sn,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),e.jsx(q,{type:"primary",disabled:!((j=o==null?void 0:o.dimensions)!=null&&j.width)||!((d=o==null?void 0:o.dimensions)!=null&&d.height),onClick:()=>n(qe(o,"halls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(z,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(ht,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),e.jsx(q,{type:"primary",disabled:!a.length,onClick:()=>n(qe(o,"stalls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(z,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Gn,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),e.jsx(q,{type:"primary",disabled:!((I=o==null?void 0:o.dimensions)!=null&&I.width)||!((f=o==null?void 0:o.dimensions)!=null&&f.height),onClick:()=>n(qe(o,"fixtures"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},dh=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=Se(),{currentExhibition:r}=he(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>i(qe(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},uh=()=>{var u,N,g;const{id:t}=pt(),s=Tt(),n=Se(),i=Ie(),r=((u=s.state)==null?void 0:u.exhibitionId)||t,{currentExhibition:o,halls:a}=he(A=>A.exhibition),p=c.useRef(null),[j,d]=ee.useMessage(),[I,f]=c.useState(!1),[x,E]=c.useState(null),[w,y]=c.useState({width:0,height:0});c.useEffect(()=>{const A=()=>{if(p.current){const{clientWidth:T,clientHeight:v}=p.current;y({width:Math.max(T||400,400),height:Math.max(v||400,400)})}};A();const $=new ResizeObserver(A);return p.current&&$.observe(p.current),window.addEventListener("resize",A),()=>{$.disconnect(),window.removeEventListener("resize",A)}},[]),c.useEffect(()=>{if(!r){j.error("Exhibition ID not found"),n("/exhibition");return}i(ft(r))},[r,i,n,j]),c.useEffect(()=>{var A,$;if(o){if(!((A=o.dimensions)!=null&&A.width)||!(($=o.dimensions)!=null&&$.height)){j.info("Please set up exhibition space first"),n(qe(o,"space"),{state:{exhibitionId:r}});return}i(At(r))}},[o,r,i,n,j]);const C=()=>{E(null),f(!0)},l=A=>{E(A),f(!!A)},m=async A=>{var $;try{A.id?(await Ee.updateHall(r,A.id,A),j.success("Hall updated successfully"),f(!1)):(await Ee.createHall(r,A),j.success("Hall created successfully"),f(!1)),i(At(r))}catch(T){console.error("Hall operation failed:",T),(($=T.response)==null?void 0:$.status)===409?j.warning({content:T.response.data.message,duration:6,style:{marginTop:"20vh"}}):(j.error(T.message||"Failed to save hall"),f(!1))}},P=async A=>{var $,T;try{const v=A._id||A.id;if(!v)throw new Error("Hall ID is required");await Ee.deleteHall(r,v),j.success("Hall deleted successfully"),f(!1),E(null),i(At(r))}catch(v){console.error("Failed to delete hall:",v),j.error(((T=($=v.response)==null?void 0:$.data)==null?void 0:T.message)||"Failed to delete hall")}},h=async()=>{try{await Ee.saveLayout(r,a),j.success("Layout saved successfully")}catch{j.error("Failed to save layout")}};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(dh,{exhibitionId:r}),d,e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(X,{children:[e.jsx("span",{children:"Hall Management"}),e.jsx(q,{icon:e.jsx(Ma,{}),onClick:()=>n(qe(o,"space"),{state:{exhibitionId:r}}),children:"Back to Space Setup"})]}),e.jsxs(X,{children:[e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),onClick:C,children:"Add Hall"}),e.jsx(q,{type:"primary",icon:e.jsx(as,{}),onClick:h,disabled:!a.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:e.jsx("div",{ref:p,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(an,{children:w.width>0&&w.height>0&&(o==null?void 0:o.dimensions)&&e.jsx(on,{width:w.width,height:w.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:a,selectedHall:x,onSelectHall:l,onHallChange:m,onAddHall:C})})})}),e.jsx(Zu,{visible:I,hall:x,onCancel:()=>f(!1),onSubmit:m,onDelete:P,exhibitionWidth:((N=o==null?void 0:o.dimensions)==null?void 0:N.width)||100,exhibitionHeight:((g=o==null?void 0:o.dimensions)==null?void 0:g.height)||100})]})},hh=Z(ye)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,ph=Z.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Hs=Z.div`
  padding: 24px 32px 32px;
`,xh=Z.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,mh=Z.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;Z.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;Z.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;Z.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;Z.div`
  border: 1px solid ${t=>t.selected?"#4b47b9":"#e6e6f0"};
  background: ${t=>t.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${t=>t.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${t=>t.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${t=>t.selected?"#4b47b9":"white"};
    border: 2px solid ${t=>t.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const gh=Z(K)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;Z(q)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;Z.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;Z(K)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;Z(Q)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const Ci=Z(q)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;Z(xe)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;Z.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;Z(nn)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;Z.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;Z.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;Z.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;Z.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;Z.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px  3) + (16px  2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;Z(K)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const ha=({form:t,stallDetails:s=[],selectedStallId:n,selectedStallIds:i=[],exhibition:r})=>{const[o,a]=c.useState([]);c.useEffect(()=>{let E=[...(t.getFieldValue("selectedStalls")||[]).map(w=>String(w))];if(n){const w=String(n);E.some(y=>y===w)||E.push(w)}i.length>0&&i.forEach(w=>{const y=String(w);E.some(C=>C===y)||E.push(y)}),console.log("StallDetailsStep - Initial stalls after normalization:",E),t.setFieldsValue({selectedStalls:E}),a(E)},[t,n,i]),c.useEffect(()=>{if(o.length>0){const f=t.getFieldValue("selectedStalls")||[],x=new Set(f.map(y=>String(y))),E=new Set(o.map(y=>String(y)));let w=x.size!==E.size;if(!w){for(const y of E)if(!x.has(y)){w=!0;break}}if(w){console.log("Syncing form with selected stalls:",o);const y=o.map(C=>String(C));t.setFieldsValue({selectedStalls:y}),t.validateFields(["selectedStalls"]).catch(C=>{})}}},[o,t]);const p=c.useMemo(()=>!s||s.length===0?[]:s.filter(f=>o.includes(f.id)),[s,o]),j=c.useMemo(()=>{var h,u,N;if(!s||s.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const f=s.filter(g=>o.includes(g.id)),x=f.reduce((g,A)=>g+(A.price||A.ratePerSqm*A.dimensions.width*A.dimensions.height),0),w=(((h=r==null?void 0:r.publicDiscountConfig)==null?void 0:h.filter(g=>g.isActive))||[]).map(g=>{const A=g.type==="percentage"?x*(Math.min(Math.max(0,g.value),100)/100):Math.min(g.value,x);return{name:g.name,type:g.type,value:g.value,amount:A}}),y=w.reduce((g,A)=>g+A.amount,0),C=x-y,l=((N=(u=r==null?void 0:r.taxConfig)==null?void 0:u.filter(g=>g.isActive))==null?void 0:N.map(g=>({name:g.name,rate:g.rate,amount:C*(g.rate/100)})))||[],m=l.reduce((g,A)=>g+A.amount,0),P=C+m;return{baseAmount:x,discounts:w,totalDiscountAmount:y,amountAfterDiscount:C,taxes:l,totalTaxAmount:m,total:P,selectedStallNumbers:f.map(g=>`${g.number} (${g.hallName||`Hall - ${g.hallId}`})`).join(", ")}},[s,o,r==null?void 0:r.taxConfig,r==null?void 0:r.publicDiscountConfig]),d=f=>{const x=String(f);if(o.some(w=>String(w)===x)){const w=o.filter(y=>String(y)!==x);a(w),t.setFieldsValue({selectedStalls:w}),ee.info("Stall removed from selection")}},I=f=>`${f.toLocaleString("en-IN")}`;return e.jsxs(Hs,{children:[e.jsx(xh,{children:"Your Selected Stalls"}),e.jsx(mh,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),e.jsx(L.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:e.jsx(le,{mode:"multiple"})}),p.length>0?e.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:e.jsx(De,{dataSource:p.map(f=>({...f,key:f.id,price:f.price||f.ratePerSqm*f.dimensions.width*f.dimensions.height,area:f.dimensions.width*f.dimensions.height,dimensions:`${f.dimensions.width}m  ${f.dimensions.height}m`,size:`${f.dimensions.width}m  ${f.dimensions.height}m`,stallType:f.stallType||{name:f.typeName||f.type||"Standard"},type:f.typeName||f.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(f,x)=>e.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",f||x.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(f,x)=>e.jsx(re,{color:"blue",style:{borderRadius:"4px"},children:f||`Hall ${x.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(f,x)=>{var w;const E=((w=x.stallType)==null?void 0:w.name)||x.type||"Standard";return e.jsx(re,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:E})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(f,x)=>e.jsxs(X,{direction:"vertical",size:0,children:[e.jsx("span",{style:{fontWeight:500},children:f}),e.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[x.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(f,x)=>e.jsxs("span",{style:{color:"#555"},children:["",(x.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:f=>e.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:I(f)})},{title:"",key:"action",width:70,align:"center",render:(f,x)=>e.jsx(We,{title:"Remove from selection",children:e.jsx(q,{type:"text",danger:!0,icon:e.jsx(ut,{}),onClick:()=>d(x.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):e.jsx(Pt,{description:"No stalls selected yet. Please select stalls from the layout.",image:Pt.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),o.length>0&&e.jsxs(gh,{title:e.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Selected Stalls"}),e.jsxs("div",{className:"value",children:[o.length," stall(s) selected"]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Stall Numbers"}),e.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:j.selectedStallNumbers})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Base Amount"}),e.jsx("div",{className:"value",children:I(j.baseAmount)})]}),j.discounts.map((f,x)=>e.jsxs("div",{className:"summary-row discount",children:[e.jsxs("div",{className:"label",children:[f.name,f.type==="percentage"?` (${f.value}%)`:""]}),e.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",I(f.amount)]})]},`discount-${x}`)),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Amount after Discount"}),e.jsx("div",{className:"value",style:{fontWeight:500},children:I(j.amountAfterDiscount)})]}),j.taxes.map((f,x)=>e.jsxs("div",{className:"summary-row",children:[e.jsxs("div",{className:"label",children:[f.name," (",f.rate,"%)"]}),e.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",I(f.amount)]})]},`tax-${x}`)),e.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[e.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),e.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:I(j.total)})]})]})]})},{Title:fh,Paragraph:pa,Text:xa}=ue,ma=({form:t,formValues:s,selectedStallIds:n=[],exhibition:i})=>{const r=t.getFieldValue("selectedStalls")||n||[];return i&&i.amenities&&i.amenities.length>0,console.log("AmenitiesStep - Selected stalls:",r),e.jsxs(Hs,{children:[e.jsx(fh,{level:4,children:"Additional Amenities"}),e.jsx(pa,{type:"secondary",style:{marginBottom:24},children:"Select additional amenities for your exhibition stalls."}),e.jsx(_e,{message:"Coming Soon",description:"The amenities selection feature is currently under development and will be available soon. You can continue to the next step without selecting amenities.",type:"info",showIcon:!0,icon:e.jsx(Ko,{}),style:{marginBottom:24}}),e.jsx(K,{title:`Selected Stalls: ${r.length}`,children:r.length>0?e.jsxs(pa,{children:["You've selected ",r.length," stall(s). Additional amenities will be available for these stalls in the next update."]}):e.jsx(Pt,{image:Pt.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),e.jsx(Ce,{}),e.jsx(K,{title:"Available Amenities",style:{marginTop:24},children:e.jsx(Pt,{image:e.jsx(Xo,{style:{fontSize:60,color:"#cccccc"}}),description:e.jsxs("span",{children:[e.jsx(xa,{strong:!0,children:"Amenities Coming Soon"}),e.jsx("br",{}),e.jsx(xa,{type:"secondary",children:"Please check back later for available amenities."})]})})}),e.jsx(L.Item,{name:"amenities",hidden:!0,initialValue:[],children:e.jsx("input",{type:"hidden"})}),e.jsx(L.Item,{name:"selectedStalls",hidden:!0,children:e.jsx("input",{type:"hidden"})})]})},{Title:Ei,Paragraph:yh,Text:Xe}=ue,ga=({form:t,stallDetails:s=[],selectedStallId:n,selectedStallIds:i=[],selectedStalls:r=[],exhibition:o,onPrev:a,onFinish:p,loading:j=!1,formValues:d={}})=>{const[I,f]=c.useState([]),x=c.useMemo(()=>{const N=(t.getFieldValue("selectedStalls")||[]).map(A=>String(A));if(console.log("ReviewStep - Form has selectedStalls:",N),console.log("ReviewStep - Props selectedStallIds:",i),console.log("ReviewStep - Props selectedStalls:",r),N.length>0)return N;const g=[];if(n){const A=String(n);g.push(A)}return i&&i.length&&i.forEach(A=>{const $=String(A);g.includes($)||g.push($)}),r&&r.length&&r.forEach(A=>{const $=String(A);g.includes($)||g.push($)}),console.log("ReviewStep - Final consolidated stall IDs:",g),g},[t,n,i,r]);c.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",x),console.log("ReviewStep - Available stall details:",s),s&&s.length&&x.length){const u=s.filter(g=>x.includes(String(g.id)));console.log("ReviewStep - Matched stalls:",u.length);const N=u.map(g=>({key:g.id,id:g.id,number:g.number||g.stallNumber||`Stall ${g.id}`,hallName:g.hallName||`Hall ${g.hallId}`,size:`${g.dimensions.width}m  ${g.dimensions.height}m`,area:g.dimensions.width*g.dimensions.height,rate:g.ratePerSqm,price:g.price||g.ratePerSqm*g.dimensions.width*g.dimensions.height,type:g.typeName||g.type||"Standard"}));f(N)}},[s,x]);const E=t.getFieldValue("amenities")||[],w=c.useMemo(()=>{var M,F,S;const u=I.reduce((R,B)=>R+B.price,0);let N=0;const g=E.map(R=>{var _;const B=(_=o==null?void 0:o.amenities)==null?void 0:_.find(V=>V.id===R||V._id===R);return B?(N+=B.rate||0,{name:B.name,rate:B.rate,type:B.type}):null}).filter(Boolean),$=(((M=o==null?void 0:o.publicDiscountConfig)==null?void 0:M.filter(R=>R.isActive))||[]).map(R=>{const B=R.type==="percentage"?u*(Math.min(Math.max(0,R.value),100)/100):Math.min(R.value,u);return{name:R.name,type:R.type,value:R.value,amount:B}}),T=$.reduce((R,B)=>R+B.amount,0),v=u-T,k=v+N,b=((S=(F=o==null?void 0:o.taxConfig)==null?void 0:F.filter(R=>R.isActive))==null?void 0:S.map(R=>({name:R.name,rate:R.rate,amount:k*(R.rate/100)})))||[],D=b.reduce((R,B)=>R+B.amount,0);return{baseAmount:u,amenities:g,amenitiesTotal:N,discounts:$,totalDiscountAmount:T,amountAfterDiscount:v,subtotal:k,taxes:b,totalTaxAmount:D,total:k+D,stallCount:I.length}},[I,E,o]);c.useEffect(()=>{var N;const u=((N=o==null?void 0:o.publicDiscountConfig)==null?void 0:N.filter(g=>g.isActive))||[];if(u.length>0){const g=u[0];console.log("Setting discountId in form to:",g),t.setFieldsValue({discountId:{name:g.name,type:g.type,value:g.value}})}},[o,t]);const y=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:u=>e.jsx(re,{color:"purple",children:u})},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:u=>`${u} sqm`},{title:"Rate",dataIndex:"rate",key:"rate",render:u=>`${u}/sqm`},{title:"Price",dataIndex:"price",key:"price",render:u=>`${u.toLocaleString()}`}],C=u=>`${u.toLocaleString("en-IN")}`,l=d.customerName||t.getFieldValue("customerName"),m=d.customerPhone||t.getFieldValue("customerPhone"),P=d.email||t.getFieldValue("email"),h=d.companyName||t.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:l,companyName:h,customerPhone:m,customerEmail:P,formValues:d,formFieldValues:{customerName:t.getFieldValue("customerName"),companyName:t.getFieldValue("companyName"),customerPhone:t.getFieldValue("customerPhone"),email:t.getFieldValue("email")}}),j?e.jsx(Hs,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:e.jsx(Nt,{size:"large",tip:"Processing your booking..."})}):x.length===0?e.jsxs(Hs,{children:[e.jsx(_e,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(q,{onClick:a,children:"Back to Stall Selection"})})]}):e.jsxs(Hs,{children:[e.jsx(L.Item,{name:"discountId",hidden:!0,children:e.jsx(Q,{})}),e.jsx(Ei,{level:4,children:"Booking Summary"}),e.jsx(yh,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),e.jsx(K,{title:"Exhibitor Information",style:{marginBottom:24},children:e.jsxs(xe,{column:2,children:[e.jsx(xe.Item,{label:"Name",children:l||"Not provided"}),e.jsx(xe.Item,{label:"Company",children:h||"Not provided"}),e.jsx(xe.Item,{label:"Phone",children:m||"Not provided"}),e.jsx(xe.Item,{label:"Email",children:P||"Not provided"})]})}),e.jsxs(K,{title:"Selected Stalls",className:"review-card",size:"small",children:[e.jsx(De,{dataSource:I,columns:y,pagination:!1,size:"small",style:{marginBottom:16}}),e.jsxs(Xe,{strong:!0,children:["Total Base Amount: ",C(w.baseAmount)]})]}),w.amenities&&w.amenities.length>0&&e.jsxs(K,{title:"Selected Amenities",style:{marginBottom:24},children:[w.amenities.map((u,N)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx(Xe,{children:u.name}),e.jsx(re,{color:"blue",style:{marginLeft:8},children:u.type})]}),e.jsx(Xe,{children:C(u.rate)})]},N)),e.jsx(Ce,{}),e.jsxs(Xe,{strong:!0,children:["Amenities Total: ",C(w.amenitiesTotal)]})]}),e.jsxs(K,{title:"Price Calculation",style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Xe,{children:"Base Amount:"}),e.jsx(Xe,{children:C(w.baseAmount)})]}),w.discounts.length>0&&e.jsxs(e.Fragment,{children:[w.discounts.map((u,N)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(Xe,{children:[u.name," (",u.type==="percentage"?`${u.value}%`:C(u.value),"):"]}),e.jsxs(Xe,{type:"danger",children:["- ",C(u.amount)]})]},N)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Xe,{children:"Amount after Discount:"}),e.jsx(Xe,{children:C(w.amountAfterDiscount)})]})]}),w.amenitiesTotal>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Xe,{children:"Amenities:"}),e.jsx(Xe,{children:C(w.amenitiesTotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Xe,{strong:!0,children:"Subtotal:"}),e.jsx(Xe,{strong:!0,children:C(w.subtotal)})]}),w.taxes.length>0&&e.jsx(e.Fragment,{children:w.taxes.map((u,N)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(Xe,{children:[u.name," (",u.rate,"%):"]}),e.jsx(Xe,{children:C(u.amount)})]},N))}),e.jsx(Ce,{}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Ei,{level:5,children:"Total:"}),e.jsx(Ei,{level:5,children:C(w.total)})]})]})]})},{confirm:bh}=ye,jh=({visible:t,stallDetails:s,selectedStallId:n,selectedStallIds:i,loading:r,exhibition:o,onCancel:a,onSubmit:p})=>{const[j]=L.useForm(),[d,I]=c.useState(0),[f]=c.useState(3),[x,E]=c.useState({}),[w,y]=c.useState(!1),[C,l]=c.useState(!1),m=he(v=>v.exhibitorAuth.exhibitor);c.useEffect(()=>{if(t){I(0),y(!1),E({}),j.resetFields();const v=i.map(D=>String(D));n&&v.push(String(n));const k=[...new Set(v)],b={selectedStalls:k,exhibitionId:o==null?void 0:o._id};m&&(b.customerName=m.contactPerson||"",b.companyName=m.companyName||"",b.email=m.email||"",b.customerPhone=m.phone||""),j.setFieldsValue(b),E(b),console.log("Booking form initialized with stalls:",k),console.log("Exhibitor profile data:",m)}},[t,j,n,i,o,m]);const P=()=>{y(!0)},h=()=>{w?bh({title:"Discard changes?",icon:e.jsx(ss,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){a()}}):a()},u=()=>{l(!0),j.validateFields().then(v=>{const k={...x,...v},b={customerName:j.getFieldValue("customerName"),companyName:j.getFieldValue("companyName"),email:j.getFieldValue("email"),customerPhone:j.getFieldValue("customerPhone")},D={...k,...b};E(D),console.log("Step completed, saving form values:",D),console.log("Selected stalls are:",D.selectedStalls||[]),console.log("Exhibitor info:",b),I(d+1),l(!1)}).catch(v=>{l(!1),console.error("Form validation failed:",v),ee.error("Please complete all required fields")})},N=()=>{I(d-1)},g=()=>{j.validateFields().then(v=>{const k={customerName:j.getFieldValue("customerName"),companyName:j.getFieldValue("companyName"),email:j.getFieldValue("email"),customerPhone:j.getFieldValue("customerPhone")},b={...x,...v,...k};console.log("Submitting booking with values:",b),p(b)}).catch(v=>{console.error("Form validation failed:",v),ee.error("Please complete all required fields")})},A=["Stall Details","Amenities","Review"],$=[{title:"Stall Details",icon:e.jsx(Zo,{}),content:e.jsx(ha,{form:j,stallDetails:s,selectedStallId:n,selectedStallIds:i,exhibition:o})},{title:"Amenities",icon:e.jsx(sn,{}),content:e.jsx(ma,{form:j,stallDetails:s,selectedStallIds:j.getFieldValue("selectedStalls")||[],exhibition:o,formValues:x})},{title:"Review",icon:e.jsx($e,{}),content:e.jsx(ga,{form:j,formValues:x,loading:r,exhibition:o,selectedStalls:j.getFieldValue("selectedStalls")||[],selectedStallIds:j.getFieldValue("selectedStalls")||[],stallDetails:s})}];c.useEffect(()=>{const v=j.getFieldValue("selectedStalls");console.log(`Step ${d} - Form has selectedStalls:`,v)},[d,j]);const T=v=>{const k=j.getFieldValue("selectedStalls")||[],b={customerName:j.getFieldValue("customerName"),companyName:j.getFieldValue("companyName"),email:j.getFieldValue("email"),customerPhone:j.getFieldValue("customerPhone")},D={...x,...b};switch(console.log(`Rendering step ${v} with:`,{selectedStalls:k,exhibitorInfo:b}),v){case 0:return e.jsx(ha,{form:j,stallDetails:s,selectedStallId:n,selectedStallIds:i,exhibition:o});case 1:return e.jsx(ma,{form:j,stallDetails:s,selectedStallIds:k,exhibition:o,formValues:D});case 2:return e.jsx(ga,{form:j,formValues:D,loading:r,exhibition:o,selectedStalls:k,selectedStallIds:k,stallDetails:s,onPrev:N,onFinish:g});default:return null}};return e.jsx(hh,{title:`Book Exhibition Stall - ${A[d]}`,open:t,onCancel:h,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[d>0&&e.jsx(Ci,{onClick:N,disabled:C||r,size:"large",children:"Back"}),e.jsx("div",{children:d<f-1?e.jsx(Ci,{type:"primary",onClick:u,loading:C,disabled:r,size:"large",children:"Next"}):e.jsx(Ci,{type:"primary",onClick:g,loading:r,disabled:C,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:e.jsxs(Nt,{spinning:r||C,tip:r?"Processing your booking...":"Validating...",children:[e.jsx(ph,{children:$.map((v,k)=>e.jsxs("div",{className:`step-item ${d===k?"active":""} ${d>k?"completed":""}`,onClick:()=>d>k?I(k):null,style:{cursor:d>k?"pointer":"default"},children:[e.jsx("span",{className:"step-icon",children:d>k?e.jsx(Xi,{}):k+1}),v.title]},k))}),e.jsx(L,{form:j,layout:"vertical",preserve:!0,onFieldsChange:P,children:T(d)},`form-step-${d}`)]})})},{Step:Pi}=nn,{Text:vh}=ue,wh=({loginModalVisible:t,registerModalVisible:s,setRegisterModalVisible:n,setExhibitorCredentials:i,onForgotPassword:r})=>{const o=Ie(),a=he(V=>V.exhibitorAuth),[p,j]=c.useState(!1),[d,I]=c.useState(null),[f]=L.useForm(),[x]=L.useForm(),[E]=L.useForm(),[w,y]=c.useState(0),[C,l]=c.useState(""),[m,P]=c.useState(!1),[h,u]=c.useState(!1),[N,g]=c.useState(0),[A,$]=c.useState({companyName:"",contactPerson:""}),T=c.useRef(null),v=async V=>{var Y,G,H,U,W,J,de,ce,ae;try{I(null),j(!0);const ne=await Ze.login(V),{exhibitor:ge,token:Ye}=ne.data;if(!ge||!Ye)throw new Error("Invalid response from server");i({exhibitor:ge,token:Ye}),o(ln()),f.resetFields(),ee.success("Login successful!")}catch(ne){if(((Y=ne.response)==null?void 0:Y.status)===403){const ge=(H=(G=ne.response)==null?void 0:G.data)==null?void 0:H.status;if(ge==="pending")I("Your account is pending approval. You will be able to log in after admin approval.");else if(ge==="rejected"){const Ye=(W=(U=ne.response)==null?void 0:U.data)==null?void 0:W.rejectionReason;I(Ye?`Your registration has been rejected. Reason: ${Ye}`:"Your registration has been rejected. Please contact the administrator for more details.")}else I(((de=(J=ne.response)==null?void 0:J.data)==null?void 0:de.message)||"Access denied. Please contact administrator.")}else I(((ae=(ce=ne.response)==null?void 0:ce.data)==null?void 0:ae.message)||"Login failed. Please try again.")}finally{j(!1)}},k=async()=>{var V,Y;try{const G=await x.validateFields(["email","companyName","contactPerson"]);j(!0),I(null),l(G.email),$({companyName:G.companyName,contactPerson:G.contactPerson}),await Ze.sendRegistrationOTP(G.email),P(!0),ee.success("OTP sent to your email address"),g(60),b(),y(1)}catch(G){if(G.name==="ValidationError")return;const H=((Y=(V=G.response)==null?void 0:V.data)==null?void 0:Y.message)||"Failed to send OTP. Please try again.";I(H),ee.error(H)}finally{j(!1)}},b=()=>{T.current&&clearInterval(T.current),T.current=setInterval(()=>{g(V=>V<=1?(T.current&&clearInterval(T.current),0):V-1)},1e3)},D=async()=>{var V,Y;try{j(!0),I(null),await Ze.sendRegistrationOTP(C),ee.success("New OTP sent to your email address"),g(60),b()}catch(G){const H=((Y=(V=G.response)==null?void 0:V.data)==null?void 0:Y.message)||"Failed to resend OTP. Please try again.";I(H),ee.error(H)}finally{j(!1)}},M=async V=>{var Y,G;try{j(!0),I(null);const H={email:C,otp:V.otp};await Ze.verifyOTP(H),u(!0),ee.success("Email verified successfully"),T.current&&clearInterval(T.current),y(2)}catch(H){const U=((G=(Y=H.response)==null?void 0:Y.data)==null?void 0:G.message)||"Invalid OTP. Please try again.";I(U),ee.error(U)}finally{j(!1)}},F=()=>{P(!1),u(!1),l(""),g(0),y(0),$({companyName:"",contactPerson:""}),T.current&&clearInterval(T.current),E.resetFields()},S=async V=>{var Y,G,H;try{if(I(null),j(!0),!h){I("Email verification required");return}const{confirmPassword:U,...W}=V,J={...W,email:C,companyName:A.companyName,contactPerson:A.contactPerson};console.log("Sending registration data:",J);const de=await Ze.register(J);ee.success("Registration successful! You can log in and book a stall only after admin approval."),n(!1),x.resetFields(),F(),setTimeout(()=>{o(rs(void 0))},500)}catch(U){console.error("Registration error:",U),console.error("Response data:",(Y=U.response)==null?void 0:Y.data);const W=((H=(G=U.response)==null?void 0:G.data)==null?void 0:H.message)||"Registration failed. Please try again.";I(W),ee.error(W)}finally{j(!1)}};Pe.useEffect(()=>()=>{T.current&&clearInterval(T.current)},[]);const R=()=>{n(!1),I(null),x.resetFields(),F()},B=()=>{o(ln()),n(!0),f.resetFields()},_=()=>{n(!1),o(rs(void 0)),x.resetFields()};return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{title:"Exhibitor Login",open:t,onCancel:()=>{o(ln()),I(null),f.resetFields()},footer:null,width:400,children:[a.loginContext==="stall-booking"&&e.jsx(_e,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),d&&e.jsx(_e,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:f,name:"exhibitor_login_modal",onFinish:v,layout:"vertical",children:[e.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(Q,{prefix:e.jsx(zt,{}),placeholder:"Email",size:"large",disabled:p})}),e.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Password",size:"large",disabled:p})}),e.jsxs(L.Item,{children:[e.jsx("div",{style:{textAlign:"right",marginBottom:10},children:e.jsx(q,{type:"link",onClick:()=>{o(ln()),r()},style:{padding:0},children:"Forgot password?"})}),e.jsx(q,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:p,children:"Login"})]})]}),e.jsx(Ce,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),e.jsx(q,{type:"default",block:!0,onClick:B,children:"Register as Exhibitor"})]}),e.jsxs(ye,{title:"Exhibitor Registration",open:s,onCancel:R,footer:null,width:500,children:[e.jsxs(nn,{current:w,style:{marginBottom:24},children:[e.jsx(Pi,{title:"Basic Info"}),e.jsx(Pi,{title:"Verify Email"}),e.jsx(Pi,{title:"Complete"})]}),d&&e.jsx(_e,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),w===0&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:x,name:"exhibitor_register_step1",layout:"vertical",children:[e.jsx(L.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:e.jsx(Q,{prefix:e.jsx(er,{}),placeholder:"Company Name",size:"large",disabled:p})}),e.jsx(L.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:e.jsx(Q,{prefix:e.jsx(ke,{}),placeholder:"Contact Person",size:"large",disabled:p})}),e.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(Q,{prefix:e.jsx(zt,{}),placeholder:"Email",size:"large",disabled:p})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",onClick:k,block:!0,size:"large",loading:p,children:"Continue & Verify Email"})})]}),e.jsx(Ce,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),e.jsx(q,{type:"default",block:!0,onClick:_,children:"Login"})]}),w===1&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{message:"Email Verification",description:`We've sent a verification code to ${C}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:E,name:"verify_otp",onFinish:M,layout:"vertical",children:[e.jsx(L.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:e.jsx(Q,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:p})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:p,children:"Verify & Continue"})})]}),e.jsxs(se,{justify:"space-between",align:"middle",style:{marginTop:16},children:[e.jsx(z,{children:e.jsx(q,{type:"link",disabled:N>0||p,onClick:D,children:"Resend Code"})}),e.jsx(z,{children:N>0&&e.jsxs(vh,{type:"secondary",children:["Resend in ",N,"s"]})})]}),e.jsx(Ce,{}),e.jsx(q,{type:"default",block:!0,onClick:()=>y(0),children:"Back"})]}),w===2&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:x,name:"exhibitor_register_step2",onFinish:S,layout:"vertical",children:[e.jsx(L.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:e.jsx(Q,{prefix:e.jsx(tr,{}),placeholder:"Phone Number",size:"large",disabled:p})}),e.jsx(L.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:e.jsx(Q.TextArea,{placeholder:"Address",rows:3,disabled:p})}),e.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Password",size:"large",disabled:p})}),e.jsx(L.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:V})=>({validator(Y,G){return!G||V("password")===G?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Confirm Password",size:"large",disabled:p})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:p,children:"Complete Registration"})})]})]})]})]})},{Step:gx}=nn,{Text:fx}=ue,Sh=({visible:t})=>{const s=Ie(),[n,i]=c.useState(!1),[r,o]=c.useState(null),[a,p]=c.useState(0),[j,d]=c.useState(""),[I,f]=c.useState(!1),[x,E]=c.useState(0),w=L.useForm()[0],y=L.useForm()[0],C=L.useForm()[0],l=c.useRef(null),m=async T=>{var v,k;try{i(!0),o(null);const b=await Ze.requestPasswordReset(T);d(T.email),f(!0),p(1),ee.success("Password reset code sent to your email"),E(60),P()}catch(b){const D=((k=(v=b.response)==null?void 0:v.data)==null?void 0:k.message)||"Failed to send password reset code. Please try again.";o(D)}finally{i(!1)}},P=()=>{l.current&&clearInterval(l.current),l.current=setInterval(()=>{E(T=>T<=1?(l.current&&clearInterval(l.current),0):T-1)},1e3)},h=async()=>{var T,v;try{i(!0),o(null),await Ze.requestPasswordReset({email:j}),ee.success("New password reset code sent to your email"),E(60),P()}catch(k){const b=((v=(T=k.response)==null?void 0:T.data)==null?void 0:v.message)||"Failed to resend password reset code. Please try again.";o(b)}finally{i(!1)}},u=async T=>{var v,k;try{i(!0),o(null),p(2),l.current&&clearInterval(l.current)}catch(b){const D=((k=(v=b.response)==null?void 0:v.data)==null?void 0:k.message)||"Invalid code. Please try again.";o(D)}finally{i(!1)}},N=async T=>{var v,k;try{i(!0),o(null);const b=y.getFieldValue("otp"),D={email:j,otp:b,newPassword:T.newPassword};await Ze.resetPassword(D),ee.success("Password reset successful. You can now log in with your new password."),g(),s(di()),s(rs())}catch(b){const D=((k=(v=b.response)==null?void 0:v.data)==null?void 0:k.message)||"Failed to reset password. Please try again.";o(D)}finally{i(!1)}},g=()=>{p(0),d(""),f(!1),E(0),l.current&&clearInterval(l.current),w.resetFields(),y.resetFields(),C.resetFields()},A=()=>{g(),s(di())},$=()=>{g(),s(di()),s(rs())};return Pe.useEffect(()=>()=>{l.current&&clearInterval(l.current)},[]),e.jsxs(ye,{title:"Forgot Password",open:t,onCancel:A,footer:null,width:400,children:[r&&e.jsx(_e,{message:r,type:"error",style:{marginBottom:16}}),e.jsx(nn,{current:a,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),a===0&&e.jsxs(L,{form:w,onFinish:m,layout:"vertical",children:[e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{prefix:e.jsx(zt,{}),placeholder:"Email"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Send Reset Code"})}),e.jsx(Ce,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),e.jsx(q,{type:"link",onClick:$,block:!0,children:"Back to Login"})]}),a===1&&e.jsxs(L,{form:y,onFinish:u,layout:"vertical",children:[e.jsxs("p",{children:["We've sent a verification code to ",e.jsx("strong",{children:j}),". Please check your email and enter the code below."]}),e.jsx(L.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:e.jsx(Q,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Verify Code"})}),e.jsx("div",{style:{textAlign:"center",marginTop:8},children:x>0?e.jsxs(ue.Text,{type:"secondary",children:["Resend code in ",x,"s"]}):e.jsx(q,{type:"link",onClick:h,disabled:n,children:"Resend Code"})}),e.jsx(Ce,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),e.jsx(q,{type:"link",onClick:()=>{p(0),l.current&&(clearInterval(l.current),E(0))},block:!0,children:"Change Email"})]}),a===2&&e.jsxs(L,{form:C,onFinish:N,layout:"vertical",children:[e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:T})=>({validator(v,k){return!k||T("newPassword")===k?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(Q.Password,{prefix:e.jsx(Lt,{}),placeholder:"Confirm Password"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Reset Password"})})]})]})},{Header:kh}=Fe,Ih=Z(kh)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,Ch=Z.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,Eh=Z.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,Ph=Z.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,Ah=Z.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,fa=Z(yt)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,ya=Z(ct)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,Nh=Z(ct)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,Th=Z(q)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,Rh=Z.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,Dh=Z(it)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,vn=Z(q)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,Fh=Z.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,$h=Z.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,jt=()=>{var A;const t=Se(),s=Ie(),[n,i]=c.useState(!1),[r,o]=c.useState(!1),[a,p]=c.useState(!1),[j,d]=c.useState("/logo.png"),[I,f]=c.useState("Exhibition Manager"),x=he($=>$.exhibitorAuth),{exhibitor:E,isAuthenticated:w,showLoginModal:y,showForgotPasswordModal:C}=x;c.useEffect(()=>{const $=localStorage.getItem("cachedLogoUrl"),T=localStorage.getItem("logoTimestamp"),v=new Date().getTime();if($&&T&&v-parseInt(T)<36e5)d($);else{const k=`${te.defaults.baseURL}/public/logo`;d(k),localStorage.setItem("cachedLogoUrl",k),localStorage.setItem("logoTimestamp",v.toString());const b=new Image;b.src=k}fetch(`${te.defaults.baseURL}/public/site-info`).then(k=>k.json()).then(k=>{k.siteName&&f(k.siteName)}).catch(k=>{console.error("Error fetching site info:",k)})},[]),c.useEffect(()=>(ee.config({top:84,duration:3,maxCount:1}),()=>{ee.destroy()}),[]);const l=()=>{s(eo()),ee.success("Successfully logged out"),t("/"),i(!1),o(!1)},m=()=>{s(rs(void 0)),i(!1),o(!1)},P=()=>{p(!0),i(!1),o(!1)},h=()=>{s(ac())},u=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],N=e.jsx(ya,{items:[{key:"exhibitor-login",icon:e.jsx(jr,{}),label:e.jsx("a",{onClick:m,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:e.jsx(Ws,{}),label:e.jsx("a",{onClick:P,children:"Register as Exhibitor"})}]}),g=e.jsx(ya,{items:[{key:"exhibitor-dashboard",icon:e.jsx(Qn,{}),label:e.jsx(it,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:e.jsx(ke,{}),label:e.jsx(it,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:e.jsx(ht,{}),label:e.jsx(it,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:e.jsx(Yn,{}),label:e.jsx("a",{onClick:l,children:"Logout"})}]});return e.jsxs(e.Fragment,{children:[e.jsx(Ih,{children:e.jsxs(Ch,{children:[e.jsx(Eh,{children:e.jsx(it,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:e.jsx(Ph,{children:e.jsx(Ah,{src:j,alt:"Logo",onError:()=>d("/logo.png")})})})}),e.jsx(Nh,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:u.map($=>({key:$.key,label:e.jsx(it,{to:$.path,children:$.label})}))}),e.jsx(Fh,{children:e.jsx(Ot,{overlay:x.isAuthenticated?g:N,trigger:["click"],placement:"bottomRight",open:n,onOpenChange:i,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:x.isAuthenticated?e.jsxs(X,{style:{cursor:"pointer"},children:[e.jsx($h,{children:((A=x.exhibitor)==null?void 0:A.companyName)||"Exhibitor"}),e.jsx(fa,{icon:e.jsx(ke,{}),size:"large"})]}):e.jsx(fa,{icon:e.jsx(ke,{}),size:"large"})})}),e.jsx(Th,{icon:e.jsx(Jo,{}),onClick:()=>o(!0)})]})}),e.jsx(Rh,{children:e.jsxs(el,{title:"Exhibition Management System",placement:"right",onClose:()=>o(!1),open:r,width:280,closeIcon:e.jsx("span",{style:{fontSize:"16px"},children:""}),children:[e.jsx("div",{style:{marginBottom:24},children:u.map($=>e.jsx(Dh,{to:$.path,onClick:()=>o(!1),children:$.label},$.key))}),e.jsx("div",{style:{marginTop:40},children:x.isAuthenticated?e.jsxs(e.Fragment,{children:[e.jsx(vn,{type:"primary",icon:e.jsx(Qn,{}),onClick:()=>{t("/exhibitor/dashboard"),o(!1)},children:"Dashboard"}),e.jsx(vn,{type:"default",icon:e.jsx(Yn,{}),onClick:l,children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(vn,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:e.jsx(jr,{}),onClick:()=>{m(),o(!1)},children:"Exhibitor Login"}),e.jsx(vn,{type:"default",icon:e.jsx(Ws,{}),onClick:()=>{P(),o(!1)},children:"Register as Exhibitor"})]})})]})}),e.jsx(wh,{loginModalVisible:y,registerModalVisible:a,setRegisterModalVisible:p,setExhibitorCredentials:$=>s(Vi($)),onForgotPassword:h}),e.jsx(Sh,{visible:C})]})},{Content:wn}=Fe,{Title:yx}=ue,Lh=t=>{if(!t)return"";if(t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;if(s.includes("logos/"))return`${te.defaults.baseURL}/public/images/${s}`;const n=localStorage.getItem("token"),i=`uploads/${s}`;return n?`${te.defaults.baseURL}/${i}?token=${n}`:`${te.defaults.baseURL}/${i}`},Mh=()=>{var R,B,_,V;const{id:t}=pt(),s=Se(),n=Ie(),[i,r]=c.useState(null),[o,a]=c.useState(null),[p,j]=c.useState(null),[d,I]=c.useState([]),[f,x]=c.useState(!1),[E,w]=c.useState(!0),[y,C]=c.useState(null),[l,m]=c.useState(!1),[P,h]=c.useState(null),u=c.useRef(null),[N,g]=c.useState({width:800,height:600}),[A,$]=c.useState(!1),[T]=L.useForm(),{isAuthenticated:v}=he(Y=>Y.exhibitorAuth);c.useEffect(()=>{const Y=()=>{$(window.innerWidth<768)};return Y(),window.addEventListener("resize",Y),()=>{window.removeEventListener("resize",Y)}},[]);const k=c.useCallback(Y=>Y.status==="booked"||Y.status==="reserved",[]),b=c.useCallback(()=>{if(u.current){const{clientWidth:Y,clientHeight:G}=u.current,H=A?320:800,U=A?480:600,W=Math.max(Y||H,H),J=Math.max(G||U,U);(Math.abs(W-N.width)>5||Math.abs(J-N.height)>5)&&g({width:W,height:J})}},[N.width,N.height,A]);c.useEffect(()=>{let Y=null;const G=()=>{Y===null&&(Y=window.setTimeout(()=>{Y=null,b()},A?100:50))};b();const H=new ResizeObserver(G);return u.current&&H.observe(u.current),window.addEventListener("resize",G),()=>{Y!==null&&window.clearTimeout(Y),H.disconnect(),window.removeEventListener("resize",G)}},[b,A]),c.useEffect(()=>{(async()=>{try{if(!t){C("Exhibition ID is missing"),w(!1);return}w(!0),C(null);const G=await gt.getLayout(t);r(G.data)}catch(G){C(G.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",G)}finally{w(!1)}})()},[t]),c.useEffect(()=>{i&&b()},[i]),c.useEffect(()=>{v&&i&&(j(null),I([]),b(),ee.info("You can now select stalls to book.",3))},[v]);const D=c.useCallback(async Y=>{if(k(Y)){ee.info(`This stall (${Y.stallNumber}) is already booked.`);return}if(!v){n(rs("stall-booking"));return}const H=Y._id||Y.id;I(U=>U.includes(H)?(ee.info(`Stall ${Y.stallNumber} removed from selection`),U.filter(W=>W!==H)):(ee.success(`Stall ${Y.stallNumber} added to selection`),[...U,H]))},[k,v,n]),M=async Y=>{try{m(!0);const G={...Y,exhibitionId:i==null?void 0:i.exhibition._id,stallIds:Y.selectedStalls};if(v){const H=await gt.exhibitorBookStalls(G);ee.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const H=await gt.bookMultipleStalls(t,G);ee.success("Your booking request has been submitted successfully!")}if(x(!1),I([]),t)try{const H=await gt.getLayout(t);r(H.data)}catch(H){console.error("Error refreshing layout data:",H)}}catch(G){console.error("Error booking stall",G),ee.error("Failed to book stall. Please try again.")}finally{m(!1)}},F=async()=>{if(d.length===0){ee.warning("Please select at least one stall to book");return}try{m(!0),await gt.getStallDetails(t,d[0]);const Y=(i==null?void 0:i.layout.flatMap(G=>G.stalls.map(H=>{var U,W;return{id:H.id,number:H.stallNumber,stallNumber:H.stallNumber,price:H.price||0,ratePerSqm:(U=H.dimensions)!=null&&U.width&&((W=H.dimensions)!=null&&W.height)?(H.price||0)/(H.dimensions.width*H.dimensions.height):0,dimensions:H.dimensions,status:H.status,hallId:G.id,hallName:G.name,type:H.type||"Standard",typeName:H.typeName||H.type||"Standard"}})))||[];h(Y),x(!0)}catch(Y){console.error("Error preparing booking modal",Y),ee.error("Failed to load stall details. Please try again.")}finally{m(!1)}};c.useCallback(Y=>{Y.cancelBubble=!0},[]);const S=c.useMemo(()=>{var Y;return i?{halls:i.layout.map(G=>e.jsx(jo,{hall:{...G,exhibitionId:t||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},G.id)),stalls:i.layout.flatMap(G=>G.stalls.map(H=>{var U,W,J,de,ce,ae,ne,ge;return e.jsx(xr,{stall:{...H,hallId:G.id,hallName:G.name,isSelected:d.includes(H.id),stallTypeId:"default",number:H.stallNumber,typeName:H.type||"Standard",ratePerSqm:H.price||0,rotation:0,dimensions:{x:((U=H.position)==null?void 0:U.x)||0,y:((W=H.position)==null?void 0:W.y)||0,width:((J=H.dimensions)==null?void 0:J.width)||0,height:((de=H.dimensions)==null?void 0:de.height)||0},status:H.status==="maintenance"?"booked":H.status},isSelected:p===H.id||d.includes(H.id),onSelect:H.status==="available"?()=>D(H):void 0,hallWidth:((ce=G.dimensions)==null?void 0:ce.width)||0,hallHeight:((ae=G.dimensions)==null?void 0:ae.height)||0,hallX:((ne=G.dimensions)==null?void 0:ne.x)||0,hallY:((ge=G.dimensions)==null?void 0:ge.y)||0},H.id)})),fixtures:(Y=i.fixtures)==null?void 0:Y.map(G=>{var H,U;return e.jsx(vo,{fixture:{...G,id:G.id||G._id,_id:G._id||G.id,exhibitionId:t||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((H=i.exhibition.dimensions)==null?void 0:H.width)||0,exhibitionHeight:((U=i.exhibition.dimensions)==null?void 0:U.height)||0},G.id||G._id)})}:null},[i,t,p,d,D]);return E?e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(wn,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Nt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):y||!i?e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(wn,{style:{paddingTop:"64px"},children:e.jsx(Gs,{status:"error",title:"Failed to load exhibition layout",subTitle:y||"The exhibition layout couldn't be loaded.",extra:[e.jsx(q,{type:"primary",onClick:()=>s("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((R=i.exhibition.dimensions)!=null&&R.width)||!((B=i.exhibition.dimensions)!=null&&B.height)?e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(wn,{style:{paddingTop:"64px"},children:e.jsx(K,{children:e.jsx(Gs,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(wn,{style:{paddingTop:"64px",background:"#f7f8fa"},children:e.jsxs(K,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:"10px 0px",border:"none"},children:[e.jsxs(se,{gutter:[24,24],style:{marginBottom:32},children:[e.jsx(z,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"row",alignItems:"center",gap:"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{flexShrink:0},children:i.exhibition.headerLogo?e.jsx(Ba,{src:Lh(i.exhibition.headerLogo),alt:`${i.exhibition.name} logo`,style:{maxHeight:90,maxWidth:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:250,height:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:e.jsx(Nt,{size:"small"})})}):e.jsx("div",{style:{width:90,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Ct,{style:{fontSize:32,color:"#aaa"}})})}),e.jsx(Ce,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i.exhibition.name}),e.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(Ct,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsxs("span",{children:[new Date(i.exhibition.startDate).toLocaleDateString()," -",new Date(i.exhibition.endDate).toLocaleDateString()]})]}),e.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(en,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsx("span",{children:i.exhibition.venue})]})]})]})}),e.jsx(z,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"12px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{marginBottom:"12px",fontSize:"16px",fontWeight:500,color:"#444"},children:"Stall Status:"}),e.jsxs(X,{size:"middle",wrap:!0,children:[e.jsx(re,{color:"#87d068",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(lt,{status:"success",text:"Available"})}),e.jsx(re,{color:"#ffd591",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(lt,{status:"warning",text:"Booked"})}),e.jsx(re,{color:"#ffadd2",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(lt,{status:"processing",text:"Reserved"})}),d.length>0&&e.jsx(re,{color:"#1890ff",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.jsx(lt,{status:"processing",color:"#1890ff",text:`Selected (${d.length})`})})]})]})})]}),e.jsxs("div",{ref:u,style:{width:"100%",height:"80vh",minHeight:"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform"},className:"public-canvas-container",children:[e.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Optimize rendering without affecting appearance */
                .konvajs-content {
                  will-change: transform;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Very subtle drag optimization for smoother experience */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                }
              `}),e.jsxs(on,{width:N.width,height:N.height,exhibitionWidth:((_=i==null?void 0:i.exhibition.dimensions)==null?void 0:_.width)||0,exhibitionHeight:((V=i==null?void 0:i.exhibition.dimensions)==null?void 0:V.height)||0,halls:(i==null?void 0:i.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[S==null?void 0:S.halls,S==null?void 0:S.stalls,S==null?void 0:S.fixtures]})]})]})}),d.length>0&&e.jsx(tl,{offsetBottom:20,children:e.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:e.jsxs(q,{type:"primary",size:"large",icon:e.jsx(qi,{}),onClick:F,loading:l,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",d.length,")"]})})}),e.jsx(jh,{visible:f,stallDetails:P,selectedStallId:p,selectedStallIds:d,loading:l,exhibition:i==null?void 0:i.exhibition,onCancel:()=>{x(!1)},onSubmit:M})]})},Bh=Pe.memo(Mh),{Content:Ai}=Fe,{Title:Ni,Text:Kt,Paragraph:ba}=ue,Ti=t=>{if(!t)return"";if(t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;if(s.includes("logos/")||s.includes("sponsors/"))return`${te.defaults.baseURL}/public/images/${s}`;const n=localStorage.getItem("token"),i=`uploads/${s}`;return n?`${te.defaults.baseURL}/${i}?token=${n}`:`${te.defaults.baseURL}/${i}`},zh=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},Sn=t=>{const s={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString(void 0,s)},_h=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);if(n<i){const o=i.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} until start`,count:a,isPast:!1}}else if(n>r){const o=n.getTime()-r.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} since end`,count:a,isPast:!0}}else{const o=r.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} remaining`,count:a,isPast:!1}}},qh=()=>{const{id:t}=pt(),s=Se(),[n,i]=c.useState(null),[r,o]=c.useState(!0),[a,p]=c.useState(null),[j,d]=c.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(c.useEffect(()=>{(async()=>{try{if(!t){p("Exhibition ID is missing");return}o(!0),p(null);const w=await gt.getExhibition(t);if(i(w.data),w.data.headerBackground){const y=Ti(w.data.headerBackground);d(y);const C=new window.Image;C.src=y}else if(w.data.headerLogo){const y=Ti(w.data.headerLogo),C=new window.Image;C.src=y}}catch(w){console.error("Error fetching exhibition:",w),p(w.message||"Error fetching exhibition")}finally{o(!1)}})()},[t]),r)return e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(Ai,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Nt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(a||!n)return e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx(Ai,{style:{paddingTop:"64px"},children:e.jsx(Gs,{status:"404",title:"Exhibition not found",subTitle:a||"The exhibition you're looking for doesn't exist or has been removed.",extra:e.jsx(q,{type:"primary",onClick:()=>s("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:I,color:f}=zh(n.startDate,n.endDate),x=_h(n.startDate,n.endDate);return e.jsxs(Fe,{className:"exhibition-details-layout",children:[e.jsx(jt,{}),e.jsxs(Ai,{className:"exhibition-content",children:[e.jsx("div",{className:"breadcrumb-container",children:e.jsx(sl,{items:[{title:e.jsx(it,{to:"/",children:e.jsx(er,{})})},{title:e.jsx(it,{to:"/exhibitions",children:"Exhibitions"})},{title:n.name}]})}),e.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${j}')`},children:e.jsx("div",{className:"hero-overlay",children:e.jsxs("div",{className:"hero-content",children:[e.jsxs("div",{className:"hero-main",children:[e.jsx(Ni,{level:1,className:"exhibition-title",children:n.name}),e.jsxs(X,{size:24,className:"exhibition-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx(Ct,{}),e.jsxs(Kt,{children:[Sn(n.startDate)," - ",Sn(n.endDate)]})]}),n.venue&&e.jsxs("div",{className:"meta-item",children:[e.jsx(ns,{}),e.jsx(Kt,{children:n.venue})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(Ge,{}),e.jsxs(Kt,{children:[x.text,": ",e.jsx("strong",{children:x.count})]})]})]})]}),e.jsxs("div",{className:"hero-actions",children:[e.jsx(q,{type:"primary",size:"large",icon:e.jsx(os,{}),onClick:()=>s(`/exhibitions/${t}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),e.jsx(q,{size:"large",icon:e.jsx(ht,{}),onClick:()=>s(`/exhibitions/${t}/layout`),className:"action-button book-button",children:"Book a Stall"}),x.isPast?null:e.jsx(q,{size:"large",icon:e.jsx(Zi,{}),onClick:()=>s("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),e.jsx("div",{className:"stats-container",children:e.jsxs(se,{gutter:[16,16],className:"stats-row",children:[e.jsx(z,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon duration-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:Math.ceil((new Date(n.endDate).getTime()-new Date(n.startDate).getTime())/(1e3*60*60*24))}),e.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),e.jsx(z,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon countdown-icon",children:e.jsx(Ge,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:x.count}),e.jsx("div",{className:"stat-label",children:x.text})]})]})}),e.jsx(z,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:f+"20",color:f},children:e.jsx(en,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value status-value",style:{color:f},children:I}),e.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),n.sponsorLogos&&n.sponsorLogos.length>0&&e.jsxs("div",{className:"sponsors-section",children:[e.jsx("div",{className:"sponsors-header",children:e.jsx(Kt,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),e.jsx("div",{className:"sponsors-container",children:n.sponsorLogos.map((E,w)=>e.jsx("div",{className:"sponsor-logo-wrapper",children:e.jsx("div",{className:"sponsor-logo",children:e.jsx("img",{src:Ti(E),alt:`Sponsor ${w+1}`,className:"sponsor-logo-img",onError:y=>{y.target.src="/placeholder-logo.png"}})})},w))})]}),e.jsx("div",{className:"exhibition-details-container",children:e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:24,lg:16,children:e.jsxs(K,{className:"details-card about-card",bordered:!1,children:[e.jsx(Ni,{level:3,className:"section-title",children:"About This Exhibition"}),e.jsx(ba,{className:"main-description",children:n.description}),n.headerDescription&&e.jsx(ba,{className:"extended-description",children:n.headerDescription}),n.headerSubtitle&&e.jsxs("div",{className:"subtitle-section",children:[e.jsx(Ni,{level:4,children:n.headerSubtitle}),e.jsx(Ce,{})]})]})}),e.jsx(z,{xs:24,lg:8,children:e.jsx(X,{direction:"vertical",style:{width:"100%"},size:24,children:e.jsx(K,{title:"Key Information",className:"details-card info-card",bordered:!1,children:e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon start-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Kt,{type:"secondary",className:"info-label",children:"Start Date"}),e.jsx("div",{className:"info-value",children:Sn(n.startDate)})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon end-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Kt,{type:"secondary",className:"info-label",children:"End Date"}),e.jsx("div",{className:"info-value",children:Sn(n.endDate)})]})]}),n.venue&&e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon venue-icon",children:e.jsx(ns,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Kt,{type:"secondary",className:"info-label",children:"Venue"}),e.jsx("div",{className:"info-value",children:n.venue})]})]})]})})})})]})})]}),e.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:Uh}=Fe,{Title:Oh,Paragraph:Vh,Text:Hh}=ue,Wh=Z(Uh)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Yh=Z.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,kn=Z(Oh)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Qh=Z.div`
  margin-bottom: 20px;
`,Gh=Z.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,vt=Z(it)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,Ri=Z.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,Di=Z.div`
  margin-right: 10px;
  color: #4158D0;
`,In=Z.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Kh=Z(Q)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,Xh=Z(q)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Zh=Z(Hh)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Jh=Z(Ce)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,wo=()=>{const[t,s]=c.useState("/logo.png"),[n,i]=c.useState("Exhibition Manager"),r=new Date().getFullYear();return c.useEffect(()=>{const o=`${te.defaults.baseURL}/public/logo`;s(o),fetch(`${te.defaults.baseURL}/public/site-info`).then(a=>a.json()).then(a=>{a.siteName&&i(a.siteName)}).catch(a=>{console.error("Error fetching site info:",a)})},[]),e.jsx(Wh,{children:e.jsxs(Yh,{children:[e.jsxs(se,{gutter:[48,40],children:[e.jsxs(z,{xs:24,sm:24,md:8,lg:7,children:[e.jsx(Qh,{children:e.jsx(it,{to:"/",children:e.jsx(Gh,{src:t,alt:n,onError:()=>s("/logo.png")})})}),e.jsx(Vh,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),e.jsxs(X,{children:[e.jsx(In,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(nl,{})}),e.jsx(In,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(il,{})}),e.jsx(In,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(rl,{})}),e.jsx(In,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(al,{})})]})]}),e.jsxs(z,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(kn,{level:4,children:"Quick Links"}),e.jsx(vt,{to:"/exhibitions",children:"Exhibitions"}),e.jsx(vt,{to:"/about",children:"About Us"}),e.jsx(vt,{to:"/contact",children:"Contact Us"}),e.jsx(vt,{to:"/privacy-policy",children:"Privacy Policy"}),e.jsx(vt,{to:"/terms",children:"Terms & Conditions"})]}),e.jsxs(z,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(kn,{level:4,children:"For Exhibitors"}),e.jsx(vt,{to:"/exhibitor/login",children:"Login"}),e.jsx(vt,{to:"/exhibitor/register",children:"Register"}),e.jsx(vt,{to:"/exhibitor/dashboard",children:"Dashboard"}),e.jsx(vt,{to:"/exhibitor/bookings",children:"My Bookings"}),e.jsx(vt,{to:"/faq",children:"FAQ"})]}),e.jsxs(z,{xs:24,sm:24,md:6,lg:7,children:[e.jsx(kn,{level:4,children:"Contact Us"}),e.jsxs(Ri,{children:[e.jsx(Di,{children:e.jsx(ns,{})}),e.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),e.jsxs(Ri,{children:[e.jsx(Di,{children:e.jsx(tr,{})}),e.jsx("div",{children:"+91 98765 43210"})]}),e.jsxs(Ri,{children:[e.jsx(Di,{children:e.jsx(zt,{})}),e.jsx("div",{children:"info@exhibitionmanager.com"})]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx(kn,{level:4,children:"Newsletter"}),e.jsx(L,{children:e.jsxs(X.Compact,{style:{width:"100%"},children:[e.jsx(Kh,{placeholder:"Your email address"}),e.jsx(Xh,{type:"primary",icon:e.jsx(ol,{}),children:"Subscribe"})]})})]})]})]}),e.jsx(Jh,{}),e.jsxs(Zh,{children:[" ",r," ",n,". All rights reserved."]})]})})},{Title:ja,Text:Fi,Paragraph:va}=ue,{Content:$i}=Fe,ep=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},wa=t=>{const s={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,s)},tp=t=>{const s=new Date,i=new Date(t).getTime()-s.getTime();return Math.ceil(i/(1e3*60*60*24))},Sa=t=>{if(!t)return"/exhibition-placeholder.jpg";if(t.startsWith("/")||t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t,n=s.includes("logos/")?s:`logos/${s}`;return`${te.defaults.baseURL}/public/images/${n}`},sp=()=>{const t=Se(),[s,n]=c.useState([]),[i,r]=c.useState(!0),[o,a]=c.useState(null),[p,j]=c.useState({});return c.useEffect(()=>{(async()=>{try{r(!0),a(null);const I=await gt.getExhibitions();n(I.data);const f={};I.data.forEach(x=>{if(x.headerLogo){const E=Sa(x.headerLogo),w=new window.Image;w.onload=()=>{f[x._id]=!0,j(y=>({...y,[x._id]:!0}))},w.onerror=()=>{console.warn(`Failed to preload image: ${E}`),f[x._id]=!1,j(y=>({...y,[x._id]:!1}))},w.src=E}})}catch(I){a(I.message||"Failed to fetch exhibitions")}finally{r(!1)}})()},[]),i?e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx($i,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Nt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):o?e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx($i,{style:{paddingTop:"64px"},children:e.jsx(Gs,{status:"error",title:"Failed to load exhibitions",subTitle:o,extra:[e.jsx(q,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsx($i,{style:{paddingTop:"64px",background:"#f5f5f5"},children:e.jsxs("div",{style:{padding:"80px 16px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[e.jsx(ja,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),e.jsx(va,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),s.length>0?e.jsx(se,{gutter:[24,24],children:s.map(d=>{const{status:I,color:f}=ep(d.startDate,d.endDate),x=tp(d.startDate),E=d.headerLogo?Sa(d.headerLogo):void 0;return e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(K,{hoverable:!0,onClick:()=>t(oi(d)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[e.jsx(lt.Ribbon,{text:I,color:f,style:{right:"-1px",top:"10px",zIndex:2}}),e.jsxs("div",{className:"exhibition-card-container",children:[e.jsx("div",{className:"exhibition-card-logo-container",children:E&&e.jsx("div",{className:"exhibition-logo",children:e.jsx(Ba,{src:E,alt:`${d.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:e.jsx(Nt,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),e.jsxs("div",{className:"exhibition-card-content",children:[e.jsx("div",{className:"exhibition-title",children:e.jsx(ja,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:d.name})}),e.jsx(va,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:d.description}),e.jsxs("div",{className:"exhibition-card-details",children:[e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Ct,{style:{color:"#722ED1"}}),e.jsx(We,{title:"Exhibition Date Range",children:e.jsxs(Fi,{style:{fontSize:14},children:[wa(d.startDate)," - ",wa(d.endDate)]})})]}),d.venue&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(ns,{style:{color:"#F5222D"}}),e.jsx(We,{title:"Venue",children:e.jsx(Fi,{style:{fontSize:14},ellipsis:!0,children:d.venue})})]}),I==="Upcoming"&&x>0&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Ge,{style:{color:"#1890FF"}}),e.jsx(We,{title:"Time Remaining",children:e.jsxs(Fi,{style:{fontSize:14},children:["Starts in ",x," day",x!==1?"s":""]})})]})]}),e.jsx("div",{className:"exhibition-card-footer",children:e.jsxs(q,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",e.jsx(Ui,{})]})})]})]})]})},d._id)})}):e.jsx(Pt,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:Pt.PRESENTED_IMAGE_SIMPLE})]})}),e.jsx(wo,{}),e.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},np=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=Se(),{currentExhibition:r}=he(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>i(qe(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ip=()=>{var M,F,S;const{message:t}=Je.useApp(),{id:s}=pt(),n=Tt(),i=Se(),r=Ie(),[o,a]=jl(),p=((M=n.state)==null?void 0:M.exhibitionId)||s,{currentExhibition:j,halls:d,stalls:I,loading:f}=he(R=>R.exhibition),x=c.useRef(null),[E,w]=c.useState(!1),[y,C]=c.useState(null),[l,m]=c.useState(null),[P,h]=c.useState({width:0,height:0}),[u,N]=c.useState(!1);c.useEffect(()=>{if(!p){t.error("Exhibition ID not found"),i("/exhibitions");return}},[p,i,t]),c.useEffect(()=>{if(!p){t.error("Exhibition ID not found"),i("/exhibition");return}(async()=>{try{await r(ft(p)).unwrap(),await r(At(p)).unwrap(),N(!0)}catch{t.error("Failed to load data")}})()},[p,r,i]),c.useEffect(()=>{var R,B;!u||!j||(!((R=j.dimensions)!=null&&R.width)||!((B=j.dimensions)!=null&&B.height))&&(t.info("Please set up exhibition space first"),i(qe(j,"space"),{state:{exhibitionId:p}}))},[j,p,i,u]),c.useEffect(()=>{!u||f||d.length===0&&(t.info("Please create halls first"),i(qe(j,"halls"),{state:{exhibitionId:p}}))},[d,p,i,f,u]),c.useEffect(()=>{u&&j&&d.length>0&&(async()=>{try{const B=d.map(_=>r(Et({exhibitionId:p,hallId:_.id})).unwrap());await Promise.all(B)}catch(B){console.error("Error fetching stalls:",B),t.error("Failed to load stalls")}})()},[j,p,d,r,u]);const g=I.filter(R=>R.hallId===((y==null?void 0:y.id)||(y==null?void 0:y._id)));c.useEffect(()=>{if(!u||d.length===0)return;const R=o.get("hallId");if(R){const B=d.find(_=>_.id===R||_._id===R);if(B)C(B);else if(d.length>0){C(d[0]);const _=d[0].id||d[0]._id;_&&a({hallId:_.toString()})}}else if(d.length>0){C(d[0]);const B=d[0].id||d[0]._id;B&&a({hallId:B.toString()})}},[d,o,u,a]),c.useEffect(()=>{const R=()=>{if(x.current){const{clientWidth:_,clientHeight:V}=x.current;h({width:Math.max(_||400,400),height:Math.max(V||400,400)})}};R();const B=new ResizeObserver(R);return x.current&&B.observe(x.current),window.addEventListener("resize",R),()=>{B.disconnect(),window.removeEventListener("resize",R)}},[]);const A=()=>{if(!y){t.warning("Please select a hall first");return}m(null),w(!0)},$=R=>{if(C(R),m(null),R){const B=R.id||R._id;a(B?{hallId:B.toString()}:{})}else a({})},T=R=>{var _;const B=R?{...R,id:R.id||R._id,_id:R._id||R.id,stallTypeId:typeof R.stallTypeId=="string"?R.stallTypeId:((_=R.stallTypeId)==null?void 0:_._id)||R.stallTypeId,stallType:R.stallType}:null;console.log("Selected stall data:",B),m(B),w(!!B)},v=async R=>{var B,_;try{if(!(y!=null&&y.id)&&!(y!=null&&y._id)){t.error("No hall selected");return}const V=y.id,Y=y._id||y.id;if(R.hallId&&R.hallId!==Y){t.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",R),R.id||R._id){const G={...R,id:R.id,_id:R._id,hallId:Y,stallTypeId:R.stallTypeId};console.log("Update data:",G);const H=R.id||R._id;if(!H)throw new Error("Stall ID is missing");await Ee.updateStall(p,H,G),t.success("Stall updated successfully")}else{const{id:G,_id:H,...U}=R,W={...U,hallId:Y,stallTypeId:R.stallTypeId};console.log("Creating new stall with data:",W),await Ee.createStall(p,W),t.success("Stall created successfully")}w(!1),r(Et({exhibitionId:p,hallId:V}))}catch(V){console.error("Error saving stall:",V),t.error(((_=(B=V.response)==null?void 0:B.data)==null?void 0:_.message)||"Failed to save stall")}},k=async R=>{var B,_;try{if(!p){t.error("Exhibition ID not found");return}const V=y;if(!V){t.error("No hall selected");return}const Y=V.id||V._id;if(!Y){t.error("Invalid hall ID");return}await Ee.deleteStall(p,R),w(!1),m(null),await r(Et({exhibitionId:p,hallId:Y})).unwrap(),t.success("Stall deleted successfully")}catch(V){console.error("Error deleting stall:",V),t.error(((_=(B=V.response)==null?void 0:B.data)==null?void 0:_.message)||"Failed to delete stall")}},b=async R=>{var Y,G;if(!p){t.error("Exhibition ID not found");return}const B=R.id||R._id;if(!B){console.error("Stall data:",R),t.error("Stall ID not found");return}if(!(y!=null&&y.id)&&!(y!=null&&y._id)){t.error("No hall selected");return}const _=y.id,V=y._id||y.id;try{await Ee.updateStall(p,B,{...R,id:B,hallId:V}),r(Et({exhibitionId:p,hallId:_}))}catch(H){console.error("Stall update error:",H),t.error(((G=(Y=H.response)==null?void 0:Y.data)==null?void 0:G.message)||"Failed to update stall position")}},D=()=>{w(!1),m(null)};return e.jsx(an,{children:e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{padding:"24px 24px 0"},children:e.jsx(np,{exhibitionId:p})}),e.jsx(K,{title:"Stall Manager",extra:e.jsxs(X,{children:[e.jsx(q,{icon:e.jsx(Ma,{}),onClick:()=>i(`/exhibition/${p}`,{state:{exhibitionId:p}}),children:"Back to Exhibition"}),e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),onClick:A,disabled:!y,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:e.jsx("div",{ref:x,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:j&&e.jsx(on,{width:P.width,height:P.height,exhibitionWidth:((F=j.dimensions)==null?void 0:F.width)||100,exhibitionHeight:((S=j.dimensions)==null?void 0:S.height)||100,halls:d,selectedHall:y,onSelectHall:$,isStallMode:!0,children:y&&g.map(R=>e.jsx(xr,{stall:R,isSelected:(l==null?void 0:l.id)===R.id||(l==null?void 0:l._id)===R._id,onSelect:()=>T(R),onChange:b,hallWidth:y.dimensions.width,hallHeight:y.dimensions.height,hallX:y.dimensions.x,hallY:y.dimensions.y},R.id||R._id))})})}),j&&e.jsx(eh,{visible:E,stall:l,hall:y,exhibition:j,onCancel:D,onSubmit:v,onDelete:l?()=>k(l.id||l._id):void 0})]})})},rp=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=Se(),{currentExhibition:r}=he(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>i(qe(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ap=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],op=()=>{var v,k,b;const{message:t}=Je.useApp(),{id:s}=pt(),n=Tt(),i=Se(),r=Ie(),o=((v=n.state)==null?void 0:v.exhibitionId)||s,{currentExhibition:a,fixtures:p,halls:j,stalls:d,loading:I}=he(D=>D.exhibition),f=c.useRef(null),[x,E]=c.useState(!1),[w,y]=c.useState(null),[C,l]=c.useState({width:0,height:0}),[m,P]=c.useState("all"),[h,u]=c.useState([]);c.useEffect(()=>{if(!o){t.error("Exhibition ID not found"),i("/exhibitions");return}},[o,i,t]),c.useEffect(()=>{(async()=>{try{await r(ft(o)).unwrap(),await r(Vs({exhibitionId:o})).unwrap(),await r(At(o)).unwrap(),await r(Et({exhibitionId:o})).unwrap()}catch{t.error("Failed to load data")}})()},[o,r,t]),c.useEffect(()=>{u(m==="all"?p:p.filter(D=>D.type===m))},[p,m]),c.useEffect(()=>{const D=()=>{if(f.current){const{clientWidth:F,clientHeight:S}=f.current;l({width:Math.max(F||400,400),height:Math.max(S||400,400)})}};D();const M=new ResizeObserver(D);return f.current&&M.observe(f.current),window.addEventListener("resize",D),()=>{M.disconnect(),window.removeEventListener("resize",D)}},[]);const N=()=>{y(null),E(!0)},g=D=>{y(D),E(!!D)},A=async D=>{try{D.id||D._id?(await r(_n({exhibitionId:o,id:D.id||D._id||"",data:D})).unwrap(),t.success("Fixture updated successfully")):(await r(zn({exhibitionId:o,data:D})).unwrap(),t.success("Fixture created successfully")),await r(Vs({exhibitionId:o})).unwrap(),E(!1)}catch(M){console.error("Failed to save fixture:",M),t.error(M.message||"Failed to save fixture")}},$=async D=>{try{const M=D.id||D._id;if(!M)throw new Error("Fixture ID is required");await r(qn({exhibitionId:o,id:M})).unwrap(),t.success("Fixture deleted successfully"),E(!1),y(null)}catch(M){console.error("Failed to delete fixture:",M),t.error(M.message||"Failed to delete fixture")}},T=D=>{P(D)};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(rp,{exhibitionId:o}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(X,{children:e.jsx("span",{children:"Fixture Management"})}),e.jsxs(X,{children:[e.jsx(le,{style:{width:180},value:m,onChange:T,options:ap}),e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),onClick:N,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[e.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),e.jsx("div",{ref:f,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(an,{children:C.width>0&&C.height>0&&(a==null?void 0:a.dimensions)&&e.jsx(on,{width:C.width,height:C.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:j,stalls:d,fixtures:h,selectedFixture:w,onSelectFixture:g,onFixtureChange:A,onAddFixture:N,isFixtureMode:!0})})})]}),e.jsx(rh,{visible:x,fixture:w,onCancel:()=>E(!1),onSubmit:A,onDelete:$,exhibitionWidth:((k=a==null?void 0:a.dimensions)==null?void 0:k.width)||100,exhibitionHeight:((b=a==null?void 0:a.dimensions)==null?void 0:b.height)||100})]})},{Title:lp,Text:cp}=ue,{Option:fs}=le,dp=()=>{const t=Se(),s=Ie(),{stalls:n,loading:i}=he(F=>F.exhibition),[r,o]=c.useState([]),[a,p]=c.useState([]),[j,d]=c.useState(null),[I,f]=c.useState(null),[x,E]=c.useState(!1),w=Pe.useMemo(()=>Math.max(...n.map(F=>F.ratePerSqm*F.dimensions.width*F.dimensions.height),1e6),[n]),y=Pe.useMemo(()=>{const F=Math.pow(10,Math.floor(Math.log10(w)));return Math.ceil(w/F)*F},[w]),[C,l]=c.useState(""),[m,P]=c.useState(null),[h,u]=c.useState([0,y]),[N,g]=c.useState("number"),[A,$]=c.useState("ascend"),T=F=>{d(F),f(null),s({type:"exhibition/clearStalls"})},v=F=>{f(F),s(j&&F?Et({exhibitionId:j,hallId:F}):{type:"exhibition/clearStalls"})};c.useEffect(()=>{(async()=>{try{E(!0),console.log("Fetching exhibitions...");const S=await Ee.getActiveExhibitions();console.log("Exhibitions response:",S.data),o(S.data)}catch(S){console.error("Failed to fetch exhibitions:",S)}finally{E(!1)}})()},[]),c.useEffect(()=>{j?(async()=>{try{E(!0),console.log("Fetching halls for exhibition:",j);const S=await Ee.getHalls(j);console.log("Halls response:",S.data),p(S.data)}catch(S){console.error("Failed to fetch halls:",S)}finally{E(!1)}})():p([])},[j]);const k=Pe.useMemo(()=>{console.log("Filtering stalls from Redux:",n);const F=n.filter(S=>{const R=!C||S.number.toLowerCase().includes(C.toLowerCase()),B=!m||S.status===m,_=!I||S.hallId===I,V=S.ratePerSqm*S.dimensions.width*S.dimensions.height,Y=V>=h[0]&&V<=h[1];return R&&B&&_&&Y}).sort((S,R)=>N==="number"?A==="ascend"?S.number.localeCompare(R.number):R.number.localeCompare(S.number):0);return console.log("Filtered stalls:",F),F},[n,C,m,I,h,N,A]),b=F=>{switch(F){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},M=(F=>{const S=F.reduce((R,B)=>{var _,V;return(_=B==null?void 0:B.dimensions)!=null&&_.width&&((V=B==null?void 0:B.dimensions)!=null&&V.height)?R+B.dimensions.width*B.dimensions.height:R},0);return{totalStalls:F.length,totalSize:S}})(k);return e.jsx("div",{className:"dashboard-container",children:e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{span:24,children:e.jsxs(X,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx(lp,{level:4,style:{margin:0},children:"Stalls"}),e.jsx(cp,{type:"secondary",children:"Manage your exhibition stalls"})]})}),e.jsx(z,{span:24,children:e.jsxs(se,{gutter:[16,16],align:"middle",children:[e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(le,{style:{width:"100%"},placeholder:"Select Exhibition",value:j,onChange:T,allowClear:!0,children:r.map(F=>e.jsx(fs,{value:F._id||F.id,children:F.name},F._id||F.id))})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(le,{style:{width:"100%"},placeholder:"Select Hall",value:I,onChange:v,disabled:!j||a.length===0,allowClear:!0,children:a.map(F=>e.jsx(fs,{value:F._id||F.id,children:F.name},F._id||F.id))})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(Q,{placeholder:"Search by stall number",prefix:e.jsx(Bt,{}),value:C,onChange:F=>l(F.target.value),allowClear:!0})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsxs(le,{style:{width:"100%"},placeholder:"Filter by status",value:m,onChange:P,allowClear:!0,children:[e.jsx(fs,{value:"available",children:"Available"}),e.jsx(fs,{value:"booked",children:"Booked"}),e.jsx(fs,{value:"reserved",children:"Reserved"}),e.jsx(fs,{value:"sold",children:"Sold"})]})})]})}),e.jsx(z,{span:24,children:e.jsx(K,{size:"small",children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{xs:12,sm:12,md:6,children:e.jsx(ve,{title:"Total Stalls",value:M.totalStalls,prefix:e.jsx(ll,{})})}),e.jsx(z,{xs:12,sm:12,md:6,children:e.jsx(ve,{title:"Total Area",value:M.totalSize,suffix:"sqm",prefix:e.jsx(os,{}),precision:2})})]})})}),e.jsx(z,{span:24,children:e.jsx(K,{size:"small",title:"Price Range Filter",children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:24,style:{marginBottom:16},children:e.jsxs(X,{children:[e.jsx(q,{size:"small",onClick:()=>u([0,5e5]),children:"Under 5L"}),e.jsx(q,{size:"small",onClick:()=>u([5e5,1e6]),children:"5L - 10L"}),e.jsx(q,{size:"small",onClick:()=>u([1e6,2e6]),children:"10L - 20L"}),e.jsx(q,{size:"small",onClick:()=>u([2e6,y]),children:"Above 20L"}),e.jsx(q,{size:"small",onClick:()=>u([0,y]),children:"All"})]})}),e.jsx(z,{span:16,children:e.jsx(La,{range:!0,min:0,max:y,value:h,onChange:F=>u(F),step:Math.max(1e3,Math.floor(y/1e3)),tooltip:{formatter:F=>`${(F||0).toLocaleString()}`}})}),e.jsx(z,{span:4,children:e.jsx(ze,{style:{width:"100%"},min:0,max:h[1],value:h[0],onChange:F=>u([F||0,h[1]]),formatter:F=>` ${F}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:F=>F?Number(F.replace(/[^\d.-]/g,"")):0,step:1e3})}),e.jsx(z,{span:4,children:e.jsx(ze,{style:{width:"100%"},min:h[0],max:y,value:h[1],onChange:F=>u([h[0],F||y]),formatter:F=>` ${F}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:F=>F?Number(F.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),e.jsx(z,{span:24,children:e.jsx(De,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(F,S)=>F.number.localeCompare(S.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(F,S)=>{var R;return((R=S.stallType)==null?void 0:R.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:F=>F?`${F.toLocaleString()}`:"N/A",sorter:(F,S)=>(F.ratePerSqm||0)-(S.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(F,S)=>{var R,B;return(R=S==null?void 0:S.dimensions)!=null&&R.width&&((B=S==null?void 0:S.dimensions)!=null&&B.height)?`${S.dimensions.width*S.dimensions.height} sqm`:"N/A"},sorter:(F,S)=>{var _,V,Y,G;const R=(((_=F.dimensions)==null?void 0:_.width)||0)*(((V=F.dimensions)==null?void 0:V.height)||0),B=(((Y=S.dimensions)==null?void 0:Y.width)||0)*(((G=S.dimensions)==null?void 0:G.height)||0);return R-B}},{title:"Dimensions",key:"dimensions",render:(F,S)=>{var R,B;return(R=S==null?void 0:S.dimensions)!=null&&R.width&&((B=S==null?void 0:S.dimensions)!=null&&B.height)?`${S.dimensions.width}m  ${S.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(F,S)=>{var R,B;return(R=S==null?void 0:S.dimensions)!=null&&R.width&&((B=S==null?void 0:S.dimensions)!=null&&B.height)&&S.ratePerSqm?`${(S.ratePerSqm*S.dimensions.width*S.dimensions.height).toLocaleString()}`:"N/A"},sorter:(F,S)=>{var _,V,Y,G;const R=(F.ratePerSqm||0)*(((_=F.dimensions)==null?void 0:_.width)||0)*(((V=F.dimensions)==null?void 0:V.height)||0),B=(S.ratePerSqm||0)*(((Y=S.dimensions)==null?void 0:Y.width)||0)*(((G=S.dimensions)==null?void 0:G.height)||0);return R-B}},{title:"Status",dataIndex:"status",key:"status",render:F=>e.jsx(re,{color:b(F),style:{textTransform:"capitalize"},children:F||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(F,S)=>S.status===F},{title:"Actions",key:"actions",render:(F,S)=>e.jsxs(X,{children:[e.jsx("a",{onClick:()=>t(`/stall/edit/${S._id||S.id}`),children:"Edit"}),e.jsx("a",{onClick:()=>t(`/stall/view/${S._id||S.id}`),children:"View"})]})}],dataSource:k,rowKey:F=>F._id||F.id,loading:x||i,pagination:{total:k.length,pageSize:10,showSizeChanger:!0,showTotal:F=>`Total ${F} stalls`},onChange:(F,S,R)=>{R.field&&(g(R.field),$(R.order))}})})]})})})},{Title:up,Text:hp}=ue,{TextArea:pp}=Q,{Search:xp}=Q,{Option:ka}=le,mp=()=>{Se();const{message:t}=Je.useApp(),[s,n]=c.useState(!1),[i]=L.useForm(),[r,o]=c.useState(!1),[a,p]=c.useState([]),[j,d]=c.useState(!1),[I,f]=c.useState(null);c.useEffect(()=>{x()},[]),c.useEffect(()=>{var m;if(console.log("Modal visibility changed:",s),console.log("Editing stall type:",I),s&&I){const P=((m=I.features)==null?void 0:m.map(h=>h.feature).join(", "))||"";console.log("Setting form values:",{name:I.name,description:I.description,features:P,status:I.status}),setTimeout(()=>{i.setFieldsValue({name:I.name,description:I.description,features:P,status:I.status})},0)}else s&&(i.resetFields(),i.setFieldsValue({status:"active"}))},[I,i,s]);const x=async()=>{try{d(!0);const m=await ws.getStallTypes();p(m.data)}catch(m){t.error("Failed to fetch stall types: "+m.message)}finally{d(!1)}},E=async m=>{try{o(!0),console.log("Form values:",m);const P={name:m.name,description:m.description,status:m.status,features:m.features?m.features.split(",").map(h=>({feature:h.trim()})):[]};console.log("Submitting data:",P),I?(await ws.updateStallType(I._id,P),t.success("Stall type updated successfully")):(await ws.createStallType(P),t.success("Stall type created successfully")),n(!1),f(null),i.resetFields(),x()}catch(P){t.error(`Failed to ${I?"update":"create"} stall type: `+P.message)}finally{o(!1)}},w=m=>{console.log("Editing stall type:",m),f(m),n(!0)},y=async m=>{try{await ws.deleteStallType(m._id),t.success("Stall type deleted successfully"),x()}catch(P){t.error("Failed to delete stall type: "+P.message)}},C=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(m,P)=>m.name.localeCompare(P.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:m=>e.jsx(X,{wrap:!0,children:m==null?void 0:m.map(({feature:P})=>e.jsx(re,{children:P},P))})},{title:"Status",dataIndex:"status",key:"status",render:m=>e.jsx(re,{color:m==="active"?"success":"default",children:m.toUpperCase()})},{title:"Actions",key:"actions",render:(m,P)=>e.jsxs(X,{children:[e.jsx(q,{type:"link",onClick:()=>w(P),children:"Edit"}),e.jsx(q,{type:"link",danger:!0,onClick:()=>y(P),children:"Delete"})]})}],l=()=>{n(!1),f(null),i.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(se,{justify:"space-between",align:"middle",children:[e.jsx(z,{children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(up,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(hp,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(z,{children:e.jsxs(X,{children:[e.jsx(xp,{placeholder:"Search stall types",style:{width:200},onSearch:m=>console.log(m)}),e.jsx(q,{type:"primary",icon:e.jsx(rt,{}),onClick:()=>n(!0),children:"Add Stall Type"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx(De,{columns:C,dataSource:a,rowKey:m=>m._id,loading:j})}),e.jsx(ye,{title:I?"Edit Stall Type":"Add Stall Type",open:s,onCancel:l,footer:null,destroyOnClose:!1,children:e.jsxs(L,{form:i,layout:"vertical",onFinish:E,initialValues:{status:"active"},preserve:!0,children:[e.jsx(L.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(Q,{placeholder:"e.g., 1 Side Open"})}),e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(pp,{rows:4,placeholder:"Enter description"})}),e.jsx(L.Item,{name:"features",label:"Features",children:e.jsx(Q,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(le,{children:[e.jsx(ka,{value:"active",children:"Active"}),e.jsx(ka,{value:"inactive",children:"Inactive"})]})}),e.jsx(L.Item,{children:e.jsxs(q,{type:"primary",htmlType:"submit",loading:r,block:!0,children:[I?"Update":"Create"," Stall Type"]})})]})})]})},gp={bookings:[],currentBooking:null,loading:!1,error:null},Jt=we("booking/fetchBookings",async()=>(await te.get("/bookings")).data),Li=we("booking/fetchBooking",async t=>(await te.get(`/bookings/${t}`)).data),Un=we("booking/createBooking",async t=>(await te.post("/bookings",t)).data),On=we("booking/updateStatus",async({id:t,status:s,rejectionReason:n})=>(await te.patch(`/bookings/${t}`,{status:s,...n&&{rejectionReason:n}})).data),Mi=we("booking/updatePaymentStatus",async({id:t,paymentStatus:s,paymentDetails:n})=>(await te.patch(`/bookings/${t}/payment`,{paymentStatus:s,paymentDetails:n})).data),Vn=we("booking/deleteBooking",async t=>(await te.delete(`/bookings/${t}`),t)),So=nt({name:"booking",initialState:gp,reducers:{clearCurrentBooking:t=>{t.currentBooking=null},clearBookingError:t=>{t.error=null}},extraReducers:t=>{t.addCase(Jt.pending,s=>{s.loading=!0,s.error=null}).addCase(Jt.fulfilled,(s,n)=>{s.loading=!1,s.bookings=n.payload}).addCase(Jt.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to fetch bookings"}).addCase(Li.pending,s=>{s.loading=!0,s.error=null}).addCase(Li.fulfilled,(s,n)=>{s.loading=!1,s.currentBooking=n.payload}).addCase(Li.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to fetch booking"}).addCase(Un.pending,s=>{s.loading=!0,s.error=null}).addCase(Un.fulfilled,(s,n)=>{s.loading=!1,s.bookings.unshift(n.payload),s.currentBooking=n.payload}).addCase(Un.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to create booking"}).addCase(On.pending,s=>{s.loading=!0,s.error=null}).addCase(On.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(s.bookings[i]=n.payload),((r=s.currentBooking)==null?void 0:r._id)===n.payload._id&&(s.currentBooking=n.payload)}).addCase(On.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to update booking status"}).addCase(Mi.pending,s=>{s.loading=!0,s.error=null}).addCase(Mi.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(s.bookings[i]=n.payload),((r=s.currentBooking)==null?void 0:r._id)===n.payload._id&&(s.currentBooking=n.payload)}).addCase(Mi.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to update payment status"}).addCase(Vn.pending,s=>{s.loading=!0,s.error=null}).addCase(Vn.fulfilled,(s,n)=>{var i;s.loading=!1,s.bookings=s.bookings.filter(r=>r._id!==n.payload),((i=s.currentBooking)==null?void 0:i._id)===n.payload&&(s.currentBooking=null)}).addCase(Vn.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:bx,clearBookingError:jx}=So.actions,fp=So.reducer,yp="/api",Hn=pr({reducerPath:"invoiceApi",baseQuery:cr({baseUrl:yp,credentials:"include",prepareHeaders:t=>{const s=localStorage.getItem("token");return s&&t.set("authorization",`Bearer ${s}`),t.set("Content-Type","application/json"),t.set("Accept","application/json"),t}}),tagTypes:["Invoice"],endpoints:t=>({getInvoices:t.query({query:(s={page:1,limit:10})=>({url:"/invoices",method:"GET",params:s}),transformResponse:s=>(console.log("Raw invoice response:",s),typeof s=="object"&&s!==null&&"data"in s?s:Array.isArray(s)?{success:!0,data:s,pagination:{total:s.length,page:1,limit:s.length,pages:1}}:(console.error("Invalid invoice response:",s),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:s=>(console.error("Invoice API Error:",s),s),providesTags:["Invoice"]}),getInvoice:t.query({query:s=>({url:`/invoices/${s}`,method:"GET"}),transformErrorResponse:s=>(console.error("Get Invoice Error:",s),s),providesTags:(s,n,i)=>[{type:"Invoice",id:i}]}),downloadInvoice:t.mutation({query:s=>({url:`/invoices/${s}/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:t.mutation({query:({id:s,...n})=>({url:`/invoices/${s}/share/email`,method:"POST",body:n})}),shareViaWhatsApp:t.mutation({query:({id:s,...n})=>({url:`/invoices/${s}/share/whatsapp`,method:"POST",body:n})})})}),{useGetInvoicesQuery:bp,useGetInvoiceQuery:jp}=Hn,vp=({bookings:t})=>{const n={total:t.length,pending:t.filter(r=>r.status==="pending").length,approved:t.filter(r=>r.status==="approved").length,rejected:t.filter(r=>r.status==="rejected").length,confirmed:t.filter(r=>r.status==="confirmed").length,cancelled:t.filter(r=>r.status==="cancelled").length,totalRevenue:t.filter(r=>r.status==="confirmed"||r.status==="approved").reduce((r,o)=>r+o.amount,0),totalActiveBookings:t.filter(r=>r.status==="confirmed"||r.status==="approved").length,totalDeclinedBookings:t.filter(r=>r.status==="cancelled"||r.status==="rejected").length};return e.jsxs(e.Fragment,{children:[e.jsxs(se,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Total Bookings",value:n.total,prefix:e.jsx(sr,{})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Pending Bookings",value:n.pending,prefix:e.jsx(Ge,{style:{color:"#faad14"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Approved Bookings",value:n.approved,prefix:e.jsx($e,{style:{color:"#52c41a"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Confirmed Bookings",value:n.confirmed,prefix:e.jsx($e,{style:{color:"#52c41a"}})})})})]}),e.jsxs(se,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Rejected Bookings",value:n.rejected,prefix:e.jsx(ts,{style:{color:"#f5222d"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Cancelled Bookings",value:n.cancelled,prefix:e.jsx(ts,{style:{color:"#f5222d"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Total Revenue",value:n.totalRevenue,prefix:"",precision:2})})}),e.jsx(z,{xs:24,sm:12,md:6})]})]})},{RangePicker:wp}=tn,Sp=({filters:t,exhibitions:s,onFilterChange:n,onRefresh:i})=>e.jsx(K,{style:{marginBottom:"24px"},children:e.jsxs(X,{wrap:!0,children:[e.jsx(Q,{placeholder:"Search by company name",prefix:e.jsx(Bt,{}),value:t.search,onChange:r=>n({...t,search:r.target.value}),style:{width:200},allowClear:!0}),e.jsx(le,{placeholder:"Filter by exhibition",value:t.exhibition,onChange:r=>n({...t,exhibition:r}),style:{minWidth:200},allowClear:!0,options:s.map(r=>({label:r.name,value:r._id}))}),e.jsx(le,{mode:"multiple",placeholder:"Filter by status",value:t.status,onChange:r=>n({...t,status:r}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),e.jsx(wp,{onChange:r=>{var o,a;return n({...t,dateRange:r?[((o=r[0])==null?void 0:o.toISOString())||"",((a=r[1])==null?void 0:a.toISOString())||""]:null})}}),e.jsx(q,{icon:e.jsx(Ki,{}),onClick:i,children:"Refresh"})]})}),{Title:kp,Text:Re}=ue,{RangePicker:vx}=tn,Ip=()=>{const t=Ie(),{bookings:s,loading:n}=he(M=>M.booking),{exhibitions:i}=he(M=>M.exhibition),[r,o]=c.useState(null),[a,p]=c.useState(!1),[j,d]=c.useState({search:"",status:[],dateRange:null,exhibition:null}),I=Se(),{data:f,isLoading:x,error:E,refetch:w}=bp({page:1,limit:100}),[y,C]=c.useState(!1),[l,m]=c.useState("pending"),[P,h]=c.useState(""),[u,N]=c.useState(!1);c.useEffect(()=>{t(Jt())},[t]),c.useEffect(()=>{t(kt())},[t]),c.useEffect(()=>{s.length>0&&[...new Set(s.map(F=>F.exhibitionId._id))].forEach(F=>{t(ft(F))})},[s,t]);const g=async(M,F,S)=>{try{N(!0),await t(On({id:M,status:F,...S&&{rejectionReason:S}})).unwrap(),ee.success(`Booking ${F} successfully`),t(Jt()),p(!1),C(!1),o(null)}catch{ee.error("Failed to update booking status")}finally{N(!1)}},A=async M=>{try{await t(Vn(M)).unwrap(),ee.success("Booking deleted successfully"),t(Jt())}catch(F){ee.error((F==null?void 0:F.message)||"Failed to delete booking")}},$=M=>{d(M)},T=s.filter(M=>{var F;if(j.search&&!((F=M.companyName)!=null&&F.toLowerCase().includes(j.search.toLowerCase()))||j.status.length>0&&!j.status.includes(M.status)||j.exhibition&&M.exhibitionId._id!==j.exhibition)return!1;if(j.dateRange){const[S,R]=j.dateRange,B=new Date(M.createdAt);if(B<new Date(S)||B>new Date(R))return!1}return!0}),v=(M,F)=>{const S=new Date(F).getFullYear(),R=s.find(H=>H._id===M);if(!R)return`--/${S}/--`;const V=(s.filter(H=>H.exhibitionId._id===R.exhibitionId._id).sort((H,U)=>new Date(H.createdAt).getTime()-new Date(U.createdAt).getTime()).findIndex(H=>H._id===M)+1).toString().padStart(2,"0"),Y=i.find(H=>H._id===R.exhibitionId._id);return`${(Y==null?void 0:Y.invoicePrefix)||R.exhibitionId.invoicePrefix||"BK"}/${S}/${V}`},k=M=>{if(x)return console.log("Loading invoices..."),null;if(E)return console.error("Error loading invoices:",E),null;if(!f)return console.log("No invoices available"),null;const F=f.data||[];console.log("Looking for invoice with booking ID:",M);const S=F.find(R=>R.bookingId&&typeof R.bookingId=="object"&&R.bookingId._id===M);return console.log("Found invoice:",S),S==null?void 0:S._id},b=async M=>{if(x){ee.loading("Loading invoice data...");return}let F=k(M._id);if(F||(ee.loading("Checking for invoice..."),await w(),F=k(M._id)),F)I(`/invoice/${F}`);else{const S=new Date(M.createdAt),R=new Date(Date.now()-5*60*1e3);S>R?(ee.info("Invoice is still being generated. Checking again in 5 seconds..."),setTimeout(async()=>{await w();const B=k(M._id);B?I(`/invoice/${B}`):ee.warning("Invoice is not ready yet. Please try again in a few moments.")},5e3)):ee.error("No invoice found for this booking. Please contact support if this persists.")}},D=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(M,F)=>e.jsx(q,{type:"link",onClick:()=>{o(s.find(S=>S._id===M)||null),p(!0)},children:v(M,F.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(M,F)=>F.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:M=>M||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(M,F)=>F.stallIds.map(S=>S.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:M=>`${M.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(M,F)=>{const S=F.calculations.totalDiscountAmount;if(!S||S===0)return"-";const R=F.calculations.stalls.filter(_=>_.discount).map(_=>_.discount);if(R.length===0)return"-";const B=R[0];return e.jsx(We,{title:e.jsx("div",{children:R.map((_,V)=>e.jsxs("div",{children:[_==null?void 0:_.name,": ",(_==null?void 0:_.type)==="percentage"?`${_==null?void 0:_.value}%`:`${_==null?void 0:_.value}`,e.jsx("br",{}),"Amount: ",_==null?void 0:_.amount.toLocaleString()]},V))}),children:e.jsxs(re,{color:"red",children:["-",S.toLocaleString(),(B==null?void 0:B.type)==="percentage"&&` (${B.value}%)`,R.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:M=>`${M.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:M=>e.jsx(re,{color:M==="confirmed"?"success":M==="approved"?"blue":M==="pending"?"warning":M==="rejected"?"error":"default",children:M.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:M=>Te(M).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(M,F)=>e.jsxs(X,{children:[e.jsx(We,{title:"View Details",children:e.jsx(q,{icon:e.jsx(Mt,{}),onClick:()=>{o(F),p(!0)}})}),e.jsx(Ot,{overlay:e.jsxs(ct,{children:[F.status!=="cancelled"&&e.jsx(ct.Item,{icon:e.jsx(Ut,{}),disabled:x,onClick:()=>b(F),children:"View Invoice"},"invoice"),e.jsx(ct.Item,{icon:e.jsx($e,{}),onClick:()=>{o(F),m(F.status),h(F.rejectionReason||""),C(!0)},children:"Update Status"},"updateStatus"),e.jsx(ct.Item,{icon:e.jsx(ut,{}),danger:!0,onClick:()=>{ye.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>A(F._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(q,{icon:e.jsx(si,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(se,{gutter:[24,24],align:"middle",children:[e.jsx(z,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(kp,{level:4,style:{margin:0},children:"Stall Bookings"}),e.jsx(Re,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),e.jsx(z,{children:e.jsx(q,{type:"primary",size:"large",icon:e.jsx(rt,{}),onClick:()=>I("/bookings/create"),children:"Create Booking"})})]})}),e.jsx(vp,{bookings:s}),e.jsx(Sp,{filters:j,exhibitions:i,onFilterChange:$,onRefresh:()=>t(Jt())}),e.jsx(K,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:e.jsx(De,{columns:D,dataSource:T,loading:n,rowKey:"_id",scroll:{x:1500},pagination:{total:T.length,pageSize:10,showSizeChanger:!0,showTotal:M=>`Total ${M} items`,position:["bottomRight"]}})}),e.jsx(ye,{title:"Booking Details",open:a,onCancel:()=>{p(!1),o(null)},footer:[e.jsx(q,{type:"primary",disabled:!r,onClick:()=>{r&&(m(r.status),h(r.rejectionReason||""),C(!0))},children:"Update Status"},"updateStatus"),e.jsx(q,{onClick:()=>{p(!1),o(null)},children:"Close"},"close")],width:800,children:r&&e.jsxs(X,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(xe,{bordered:!0,column:2,children:[e.jsxs(xe.Item,{label:"Booking Number",span:2,children:[v(r._id,r.createdAt),e.jsxs(Re,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",r._id,")"]})]}),e.jsx(xe.Item,{label:"Exhibition",span:2,children:r.exhibitionId.name}),e.jsxs(xe.Item,{label:"Status",span:2,children:[e.jsx(re,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()}),r.rejectionReason&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Re,{type:"secondary",children:"Rejection Reason:"}),e.jsx("br",{}),e.jsx(Re,{children:r.rejectionReason})]})]}),e.jsx(xe.Item,{label:"Customer Name",children:r.customerName}),e.jsx(xe.Item,{label:"Customer Email",children:r.customerEmail}),e.jsx(xe.Item,{label:"Customer Phone",children:r.customerPhone}),e.jsx(xe.Item,{label:"Company Name",children:r.companyName})]}),e.jsx(K,{title:"Stall Details",size:"small",children:e.jsx(De,{dataSource:r.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:M=>e.jsxs(re,{color:"blue",children:[M.dimensions.width,"x",M.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:M=>`${M.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:M=>{const F=r.calculations.stalls.find(S=>S.stallId===M._id);return F?`${F.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:M=>{const F=r.calculations.stalls.find(S=>S.stallId===M._id);return F!=null&&F.discount?e.jsxs(re,{color:"red",children:["-",F.discount.amount.toLocaleString(),F.discount.type==="percentage"&&` (${F.discount.value}%)`]}):"-"}}]})}),e.jsx(K,{title:"Financial Summary",size:"small",children:e.jsxs(X,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Re,{children:"Total Base Amount:"}),e.jsxs(Re,{children:["",r.calculations.totalBaseAmount.toLocaleString()]})]}),r.calculations.totalDiscountAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Re,{children:"Total Discount:"}),e.jsxs(Re,{type:"danger",children:["-",r.calculations.totalDiscountAmount.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Re,{children:"Amount after Discount:"}),e.jsxs(Re,{children:["",r.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),e.jsx(Ce,{style:{margin:"8px 0"}}),r.calculations.taxes.map(M=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Re,{children:[M.name," (",M.rate,"%):"]}),e.jsxs(Re,{children:["",M.amount.toLocaleString()]})]},M.name)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Re,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Re,{strong:!0,children:["",r.amount.toLocaleString()]})]})]})})]})}),e.jsx(ye,{title:"Update Booking Status",open:y,onCancel:()=>{C(!1),h("")},footer:null,width:600,children:r&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Ut,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(se,{gutter:[16,8],children:[e.jsx(z,{span:8,children:e.jsx(Re,{strong:!0,children:"Booking Number:"})}),e.jsx(z,{span:16,children:e.jsx(Re,{children:v(r._id,r.createdAt)})}),e.jsx(z,{span:8,children:e.jsx(Re,{strong:!0,children:"Company:"})}),e.jsx(z,{span:16,children:e.jsx(Re,{children:r.companyName})}),e.jsx(z,{span:8,children:e.jsx(Re,{strong:!0,children:"Exhibition:"})}),e.jsx(z,{span:16,children:e.jsx(Re,{children:r.exhibitionId.name})}),e.jsx(z,{span:8,children:e.jsx(Re,{strong:!0,children:"Current Status:"})}),e.jsx(z,{span:16,children:e.jsx(re,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()})})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ss,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Re,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(St.Group,{value:l,onChange:M=>m(M.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[e.jsx(St.Button,{value:"pending",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(Ge,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(St.Button,{value:"approved",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx($e,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(St.Button,{value:"rejected",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(ts,{style:{color:"#f5222d"}}),"Rejected"]})}),e.jsx(St.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx($e,{style:{color:"#1890ff"}}),"Confirmed"]})}),e.jsx(St.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(ts,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),l==="rejected"&&e.jsx("div",{children:e.jsx(L.Item,{label:e.jsx(Re,{strong:!0,children:"Rejection Reason:"}),required:l==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:e.jsx(Q.TextArea,{rows:4,value:P,onChange:M=>h(M.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),l==="approved"&&e.jsx(_e,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),l==="confirmed"&&e.jsx(_e,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),l==="cancelled"&&e.jsx(_e,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),l==="pending"&&e.jsx(_e,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(q,{onClick:()=>{C(!1),h("")},children:"Cancel"}),e.jsx(q,{type:"primary",onClick:()=>{if(l==="rejected"&&!P.trim()){ee.error("Rejection reason is required when rejecting a booking");return}g(r._id,l,l==="rejected"?P:void 0)},loading:u,disabled:l==="rejected"&&!P.trim(),children:"Update Status"})]})]})]})})]})},Cp={exhibitors:[],loading:!1,error:null},It=we("exhibitors/fetchAll",async(t,{rejectWithValue:s})=>{var n,i;try{return(await Ze.getExhibitors()).data}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch exhibitors")}}),Ep=nt({name:"exhibitor",initialState:Cp,reducers:{},extraReducers:t=>{t.addCase(It.pending,s=>{s.loading=!0,s.error=null}).addCase(It.fulfilled,(s,n)=>{s.exhibitors=n.payload,s.loading=!1}).addCase(It.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),Pp=Ep.reducer,{Title:Ap,Text:wt}=ue,Np=()=>{var F;const[t]=L.useForm(),[s]=L.useForm(),[n,i]=c.useState(!1),[r,o]=c.useState([]),[a,p]=c.useState(!1),[j,d]=c.useState([]),[I,f]=c.useState(null),[x,E]=c.useState(),w=Se(),y=Ie(),{loading:C}=he(S=>S.booking),{exhibitions:l=[],loading:m}=he(S=>S.exhibition),{exhibitors:P=[],loading:h}=he(S=>S.exhibitor),{isAuthenticated:u}=he(S=>S.auth);c.useEffect(()=>{if(!u){ee.error("Please login to create a booking"),w("/login");return}y(kt()),y(It())},[y,u,w]);const N=async S=>{try{p(!0),t.setFieldValue("stallIds",[]),t.setFieldValue("discountId",void 0),d([]);const R=await Ee.getExhibition(S);f(R.data);const _=(await Ee.getStalls(S)).data.filter(V=>V.status==="available");o(_)}catch(R){console.error("Failed to fetch exhibition data:",R),ee.error("Failed to fetch exhibition data")}finally{p(!1)}},g=S=>Math.round(S.ratePerSqm*S.dimensions.width*S.dimensions.height*100)/100,A=S=>{const R=r.filter(B=>{const _=B._id||B.id;return _&&S.includes(_)});d(R)},$=(S,R,B)=>{if(!(B!=null&&B.isActive))return 0;let _=0;if(B.type==="percentage")_=S*(Math.max(0,Math.min(100,B.value))/100);else{const V=S/R*B.value;_=Math.min(V,S)}return Math.round(_*100)/100},T=async S=>{var R,B;try{const _=P.find(O=>O._id===S.exhibitorId);if(!_)throw new Error("Selected exhibitor not found");const[V,Y,G]=S.discountId?S.discountId.split("-"):[],H=(R=I==null?void 0:I.discountConfig)==null?void 0:R.find(O=>`${O.name}-${O.value}-${O.type}`===S.discountId),U=j.map(O=>{const ie=O._id||O.id;if(!ie)throw new Error(`Invalid stall ID for stall number ${O.number}`);return{stall:O,stallId:ie,baseAmount:g(O)}}),W=U.reduce((O,{baseAmount:ie})=>O+ie,0),J=U.map(({stall:O,stallId:ie,baseAmount:me})=>{const Ae=H?$(me,W,H):0;return{stallId:ie,number:O.number,baseAmount:me,discount:H?{name:H.name,type:H.type,value:H.value,amount:Ae}:void 0,amountAfterDiscount:Math.round((me-Ae)*100)/100}}),de=J.reduce((O,ie)=>{var me;return O+(((me=ie.discount)==null?void 0:me.amount)||0)},0),ce=Math.round((W-de)*100)/100,ae=((B=I==null?void 0:I.taxConfig)==null?void 0:B.filter(O=>O.isActive).map(O=>({name:O.name,rate:O.rate,amount:Math.round(ce*O.rate/100*100)/100})))||[],ne=ae.reduce((O,ie)=>O+ie.amount,0),ge=Math.round((ce+ne)*100)/100,Ye={exhibitionId:S.exhibitionId,exhibitorId:S.exhibitorId,stallIds:J.map(O=>O.stallId),customerName:_.contactPerson,customerEmail:_.email,customerPhone:_.phone,customerAddress:_.address||"N/A",companyName:_.companyName,discount:H?{name:H.name,type:H.type,value:H.value}:void 0,amount:ge,calculations:{stalls:J,totalBaseAmount:W,totalDiscountAmount:de,totalAmountAfterDiscount:ce,taxes:ae,totalTaxAmount:ne,totalAmount:ge}};await y(Un(Ye)).unwrap(),ee.success("Booking created successfully"),w("/bookings")}catch(_){console.error("Error creating booking:",_),ee.error("Failed to create booking")}},v=async S=>{try{const R=await Ze.createExhibitor(S);ee.success("Exhibitor added successfully"),y(It()),t.setFieldsValue({exhibitorId:R.data._id}),i(!1),s.resetFields()}catch(R){const B=(R==null?void 0:R.message)||"Failed to add exhibitor";ee.error(B),B==="User with this email already exists"&&s.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},k=l.map(S=>({label:S.name,value:S._id||S.id})),b=P.map(S=>({label:S.companyName,value:S._id}));r.map(S=>({label:`Stall ${S.number} (${S.dimensions.width}m  ${S.dimensions.height}m = ${(S.dimensions.width*S.dimensions.height).toFixed(2)} sqm) - ${S.ratePerSqm.toLocaleString()}/sq.m`,value:S._id||S.id}));const D=S=>{E(S),t.setFieldValue("discountId",S)},M=()=>{var H,U;const S=j.reduce((W,J)=>W+g(J),0),R=(H=I==null?void 0:I.discountConfig)==null?void 0:H.find(W=>`${W.name}-${W.value}-${W.type}`===x&&W.isActive),B=R?R.type==="percentage"?Math.round(S*R.value/100*100)/100:Math.min(R.value,S):0,_=Math.round((S-B)*100)/100,V=((U=I==null?void 0:I.taxConfig)==null?void 0:U.filter(W=>W.isActive).map(W=>({name:W.name,rate:W.rate,amount:Math.round(_*W.rate/100*100)/100})))||[],Y=V.reduce((W,J)=>W+J.amount,0),G=Math.round((_+Y)*100)/100;return{baseAmount:S,selectedDiscount:R,discountAmount:B,amountAfterDiscount:_,taxes:V,totalTaxAmount:Y,totalAmount:G}};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{span:24,children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(Ap,{level:2,style:{margin:0},children:"Create Booking"}),e.jsx(ue.Text,{type:"secondary",children:"Create a new stall booking"})]})}),e.jsx(z,{span:24,children:e.jsx(K,{children:e.jsx(L,{form:t,layout:"vertical",onFinish:T,style:{maxWidth:800},children:e.jsxs(se,{gutter:16,children:[e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:e.jsx(le,{placeholder:"Select exhibition",loading:m,options:k,onChange:N})})}),e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"exhibitorId",label:e.jsxs(X,{children:[e.jsx("span",{children:"Exhibitor"}),e.jsx(q,{type:"link",icon:e.jsx(rt,{}),onClick:()=>i(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:e.jsx(le,{showSearch:!0,placeholder:"Select exhibitor",loading:h,options:b,filterOption:(S,R)=>{var B;return(((B=R==null?void 0:R.label)==null?void 0:B.toString())??"").toLowerCase().includes(S.toLowerCase())}})})}),e.jsx(z,{span:24,children:e.jsx(L.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:e.jsx(le,{mode:"multiple",placeholder:a?"Loading stalls...":"Select stalls",loading:a,onChange:A,options:r.map(S=>({label:`Stall ${S.number} (${S.dimensions.width}m  ${S.dimensions.height}m = ${(S.dimensions.width*S.dimensions.height).toFixed(2)} sqm) - ${S.ratePerSqm.toLocaleString()}/sq.m`,value:S._id||S.id}))})})}),j.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{span:24,children:e.jsx(K,{title:"Selected Stalls Summary",size:"small",children:e.jsx(De,{dataSource:j.map(S=>({...S,key:S._id||S.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(S,R)=>{var B,_;return((B=R.stallType)==null?void 0:B.name)||(typeof R.stallTypeId=="object"?(_=R.stallTypeId)==null?void 0:_.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(S,R)=>`${R.dimensions.width}m  ${R.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(S,R)=>(R.dimensions.width*R.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:S=>`${S.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(S,R)=>`${g(R).toLocaleString()}`}],summary:()=>{const S=j.reduce((R,B)=>R+g(B),0);return e.jsxs(De.Summary.Row,{children:[e.jsx(De.Summary.Cell,{index:0,colSpan:5,children:e.jsx("strong",{children:"Total Base Amount"})}),e.jsx(De.Summary.Cell,{index:1,children:e.jsxs("strong",{children:["",S.toLocaleString()]})})]},"summary")}})})}),e.jsx(z,{span:24,children:e.jsxs(K,{title:"Price Calculations",size:"small",children:[e.jsx(se,{gutter:[16,16],children:e.jsx(z,{span:12,children:e.jsx(L.Item,{name:"discountId",label:"Available Discounts",children:e.jsx(le,{placeholder:"Select discount",allowClear:!0,onChange:D,options:(F=I==null?void 0:I.discountConfig)==null?void 0:F.map(S=>({label:`${S.name} (${S.type==="percentage"?S.value+"%":""+S.value})${S.isActive?"":" - Inactive"}`,value:`${S.name}-${S.value}-${S.type}`,disabled:!S.isActive}))})})})}),e.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:e.jsx(X,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:S,selectedDiscount:R,discountAmount:B,amountAfterDiscount:_,taxes:V,totalAmount:Y}=M();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(wt,{children:"Total Base Amount:"}),e.jsxs(wt,{children:["",S.toLocaleString()]})]}),R&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(wt,{children:["Discount (",R.type==="percentage"?`${R.value}%`:`${R.value.toLocaleString()}`,"):"]}),e.jsxs(wt,{type:"danger",children:["-",B.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(wt,{children:"Amount after Discount:"}),e.jsxs(wt,{children:["",_.toLocaleString()]})]}),e.jsx(Ce,{style:{margin:"8px 0"}}),V.map(G=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(wt,{children:[G.name," (",G.rate,"%):"]}),e.jsxs(wt,{children:["",G.amount.toLocaleString()]})]},`tax-${G.name}`)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(wt,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(wt,{strong:!0,children:["",Y.toLocaleString()]})]})]})})()})})]})})]}),e.jsx(z,{span:24,children:e.jsx(L.Item,{children:e.jsxs(X,{children:[e.jsx(q,{type:"primary",htmlType:"submit",loading:C,children:"Create Booking"}),e.jsx(q,{onClick:()=>w("/bookings"),children:"Cancel"})]})})})]})})})})]}),e.jsx(ye,{title:e.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:n,onCancel:()=>{i(!1),s.resetFields()},width:800,footer:e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[e.jsx(q,{onClick:()=>{i(!1),s.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),e.jsx(q,{type:"primary",onClick:s.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:e.jsx(L,{form:s,layout:"vertical",onFinish:v,requiredMark:!1,children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(Q.TextArea,{rows:3})}),e.jsx(L.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"status",label:"Status",initialValue:"active",children:e.jsxs(le,{children:[e.jsx(le.Option,{value:"active",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),e.jsx(le.Option,{value:"inactive",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(Q,{placeholder:"ABCDE1234F"})}),e.jsx(L.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(Q,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})};Pa.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Ea}/pdf.worker.min.js`;const Tp=()=>{const{id:t}=pt(),s=Se(),{data:n,isLoading:i}=jp(t||""),[r,o]=c.useState(!1),[a,p]=c.useState(!1),[j,d]=c.useState(!1),[I,f]=c.useState(null),[x,E]=c.useState(null),[w]=L.useForm(),y=async()=>{try{const h=await Nr(`/invoices/${t}/download?force=true`),u=window.URL.createObjectURL(new Blob([h.data]));f(u),d(!0)}catch(h){console.error("Preview error:",h),ee.error("Failed to preview invoice")}},C=async()=>{try{const h=await Nr(`/invoices/${t}/download?force=true`),u=window.URL.createObjectURL(new Blob([h.data])),N=document.createElement("a");N.href=u,N.setAttribute("download",`invoice-${t}.pdf`),document.body.appendChild(N),N.click(),N.remove(),window.URL.revokeObjectURL(u)}catch(h){console.error("Download error:",h),ee.error("Failed to download invoice")}},l=async h=>{try{await te.post(`/invoices/${t}/share/email`,h),ee.success("Invoice shared via email successfully"),o(!1),w.resetFields()}catch(u){console.error("Email sharing error:",u),ee.error("Failed to share invoice via email")}},m=async h=>{try{await te.post(`/invoices/${t}/share/whatsapp`,h),ee.success("Invoice shared via WhatsApp successfully"),p(!1),w.resetFields()}catch(u){console.error("WhatsApp sharing error:",u),ee.error("Failed to share invoice via WhatsApp")}},P=({numPages:h})=>{E(h)};return i||!n?e.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",n),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(K,{title:"Invoice Details",extra:e.jsxs(X,{children:[e.jsx(q,{icon:e.jsx(Vt,{}),onClick:()=>s(-1),children:"Back"}),e.jsx(q,{icon:e.jsx(Mt,{}),onClick:y,children:"Preview"}),e.jsx(q,{type:"primary",icon:e.jsx(Da,{}),onClick:C,children:"Download"}),e.jsx(q,{icon:e.jsx(zt,{}),onClick:()=>o(!0),children:"Share via Email"}),e.jsx(q,{icon:e.jsx(Fa,{}),onClick:()=>p(!0),children:"Share via WhatsApp"})]}),children:e.jsx(mo,{booking:{...n.bookingId,customerGSTIN:n.bookingId.customerGSTIN||"",invoiceNumber:n.invoiceNumber,exhibitionId:{...n.bookingId.exhibitionId,companyName:n.bookingId.exhibitionId.companyName||"Company Name",bankName:n.bookingId.exhibitionId.bankName||"",bankAccount:n.bookingId.exhibitionId.bankAccount||"",bankAccountName:n.bookingId.exhibitionId.bankAccountName||"",bankBranch:n.bookingId.exhibitionId.bankBranch||"",bankIFSC:n.bookingId.exhibitionId.bankIFSC||"",companyCIN:n.bookingId.exhibitionId.companyCIN||"",companyPAN:n.bookingId.exhibitionId.companyPAN||"",companySAC:n.bookingId.exhibitionId.companySAC||"",companyGST:n.bookingId.exhibitionId.companyGST||"",companyEmail:n.bookingId.exhibitionId.companyEmail||"",companyWebsite:n.bookingId.exhibitionId.companyWebsite||"",companyAddress:n.bookingId.exhibitionId.companyAddress||""},calculations:{...n.bookingId.calculations,stalls:n.bookingId.calculations.stalls.map(h=>({discount:h.discount?{value:h.discount.value}:void 0}))}}})}),e.jsx(ye,{title:"Preview Invoice",open:j,onCancel:()=>{d(!1),I&&(window.URL.revokeObjectURL(I),f(null))},width:1e3,footer:null,children:I&&e.jsx("div",{style:{height:"80vh",overflow:"auto"},children:e.jsx(Aa,{file:I,onLoadSuccess:P,loading:e.jsx("div",{children:"Loading PDF..."}),children:Array.from(new Array(x||0),(h,u)=>e.jsx(Na,{pageNumber:u+1,width:900,renderTextLayer:!1,renderAnnotationLayer:!1},`page_${u+1}`))})})}),e.jsx(ye,{title:"Share Invoice via Email",open:r,onCancel:()=>o(!1),footer:null,children:e.jsxs(L,{form:w,onFinish:l,layout:"vertical",children:[e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(Q,{placeholder:"Enter email address"})}),e.jsx(L.Item,{name:"message",label:"Message (Optional)",children:e.jsx(Q.TextArea,{placeholder:"Enter optional message"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(ye,{title:"Share Invoice via WhatsApp",open:a,onCancel:()=>p(!1),footer:null,children:e.jsxs(L,{form:w,onFinish:m,layout:"vertical",children:[e.jsx(L.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:e.jsx(Q,{placeholder:"Enter phone number with country code"})}),e.jsx(L.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:He,Paragraph:Ve,Text:Cn}=ue,{Content:Rp}=Fe,Dp=t=>{if(!t)return"/exhibition-placeholder.jpg";if(t.startsWith("/")||t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;return s.includes("logos/")||s.includes("sponsors/")?`${te.defaults.baseURL}/public/images/${s}`:"/exhibition-placeholder.jpg"},Fp=Z(Rp)`
  padding-top: 64px;
`,$p=Z.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,Lp=Z.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Mp=Z.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,ys=Z(K)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Bp=Z(K)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Ms=Z(He)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,bs=Z.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,En=Z.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Ia=Z.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,zp=Z(re)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,Bi=Z(q)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,Bs=Z.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;Z.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const _p=()=>{const t=Se(),s=Ie(),[n,i]=c.useState([]),[r,o]=c.useState(!0);c.useEffect(()=>{(async()=>{try{o(!0);const I=await gt.getExhibitions();i(I.data.slice(0,4))}catch(I){console.error("Failed to fetch exhibitions:",I)}finally{o(!1)}})()},[]);const a=d=>{const I={year:"numeric",month:"short",day:"numeric"};return new Date(d).toLocaleDateString(void 0,I)},p=(d,I)=>{const f=new Date,x=new Date(d),E=new Date(I);return f<x?{status:"Upcoming",color:"#722ED1"}:f>E?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},j=()=>{s(rs(void 0))};return e.jsxs(Fe,{children:[e.jsx(jt,{}),e.jsxs(Fp,{children:[e.jsxs($p,{children:[e.jsx(Lp,{}),e.jsx(Mp,{children:e.jsxs(se,{gutter:[48,48],align:"middle",children:[e.jsxs(z,{xs:24,lg:14,children:[e.jsx(He,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),e.jsx(Ve,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),e.jsxs(X,{size:16,wrap:!0,children:[e.jsx(Bi,{type:"primary",size:"large",onClick:()=>t("/exhibitions"),icon:e.jsx(Ui,{}),children:"Explore Exhibitions"}),e.jsx(Bi,{className:"secondary-btn",size:"large",onClick:()=>t("/exhibitor/login"),icon:e.jsx(ke,{}),children:"Exhibitor Portal"})]})]}),e.jsx(z,{xs:24,lg:10,children:e.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:d=>{const I=d.target;I.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",I.onerror=()=>{I.style.height="300px",I.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",I.onerror=null;const f=I.parentElement;if(f){const x=document.createElement("div");x.style.position="absolute",x.style.top="50%",x.style.left="50%",x.style.transform="translate(-50%, -50%)",x.style.color="white",x.style.fontSize="18px",x.style.fontWeight="bold",x.style.textAlign="center",x.textContent="Exhibition Venue",f.appendChild(x)}}}})})]})})]}),e.jsx(Bs,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Ms,{level:2,children:"Featured Exhibitions"}),r?e.jsx(se,{gutter:[24,24],children:[1,2,3,4].map(d=>e.jsx(z,{xs:24,sm:12,lg:6,children:e.jsx(K,{style:{borderRadius:"12px"},children:e.jsx($a,{active:!0,avatar:!0,paragraph:{rows:3}})})},d))}):n.length>0?e.jsx(se,{gutter:[24,24],children:n.map((d,I)=>{const{status:f,color:x}=p(d.startDate,d.endDate);return e.jsx(z,{xs:24,sm:12,lg:6,children:e.jsxs(Bp,{onClick:()=>t(oi(d)),cover:e.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[e.jsx("img",{alt:d.name,src:d.headerLogo?Dp(d.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"cover",filter:"brightness(0.95)"}}),e.jsx(re,{color:x,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:f}),I===0&&e.jsx(zp,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[e.jsx(He,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:d.name}),e.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[e.jsx(Ct,{style:{color:"#4158D0"}}),e.jsxs(Cn,{type:"secondary",style:{fontSize:13},children:[a(d.startDate)," - ",a(d.endDate)]})]}),d.venue&&e.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[e.jsx(ns,{style:{color:"#C850C0"}}),e.jsx(Cn,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:d.venue})]}),e.jsx(q,{type:"link",style:{padding:0,height:"auto"},icon:e.jsx(Ui,{}),children:"View Details"})]})},d._id)})}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(Ve,{children:"No exhibitions available at the moment. Check back soon!"})}),e.jsx("div",{style:{textAlign:"center",marginTop:40},children:e.jsx(q,{type:"primary",size:"large",onClick:()=>t("/exhibitions"),icon:e.jsx(cl,{}),children:"View All Exhibitions"})})]})}),e.jsx(Bs,{className:"how-it-works",children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Ms,{level:2,children:"How to Book Stall"}),e.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:e.jsx(Ve,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),e.jsxs("div",{className:"booking-steps",children:[e.jsx("div",{className:"step-indicator",children:e.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(d=>e.jsxs("div",{className:"step-dot-container",children:[e.jsx("div",{className:"step-dot",children:d}),e.jsx("div",{className:"step-label",children:`Step ${d}`})]},d)),e.jsx("div",{className:"step-progress-line"})]})}),e.jsxs(se,{gutter:[24,24],style:{marginTop:40},children:[e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"1"}),e.jsx("div",{className:"step-icon",children:e.jsx(ke,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Register"}),e.jsx(Ve,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"2"}),e.jsx("div",{className:"step-icon",children:e.jsx($e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Admin Approval"}),e.jsx(Ve,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsx("div",{className:"step-icon",children:e.jsx(ht,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Login & Book Stall"}),e.jsx(Ve,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"4"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ge,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Stall Goes to Reserved"}),e.jsx(Ve,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"5"}),e.jsx("div",{className:"step-icon",children:e.jsx($e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Admin Final Approval"}),e.jsx(Ve,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"6"}),e.jsx("div",{className:"step-icon",children:e.jsx($e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Stall Becomes Booked"}),e.jsx(Ve,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),e.jsx(z,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"7"}),e.jsx("div",{className:"step-icon",children:e.jsx(vr,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(He,{level:5,children:"Make Payment in 3 Days"}),e.jsx(Ve,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),e.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),e.jsx("div",{style:{textAlign:"center",marginTop:60},children:e.jsx(Bi,{type:"primary",size:"large",onClick:j,icon:e.jsx(ke,{}),children:"Register as Exhibitor"})})]})}),e.jsx(Bs,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Ms,{level:2,children:"Why Choose Us"}),e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:e.jsx(os,{})}),e.jsx(He,{level:4,children:"Interactive Layouts"}),e.jsx(Ve,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:e.jsx(ht,{})}),e.jsx(He,{level:4,children:"Real-time Availability"}),e.jsx(Ve,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:e.jsx(vr,{})}),e.jsx(He,{level:4,children:"Secure Payments"}),e.jsx(Ve,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:e.jsx(Zi,{})}),e.jsx(He,{level:4,children:"Exhibitor Dashboard"}),e.jsx(Ve,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:e.jsx(Ct,{})}),e.jsx(He,{level:4,children:"Schedule Management"}),e.jsx(Ve,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),e.jsx(z,{xs:24,sm:12,lg:8,children:e.jsxs(ys,{children:[e.jsx(bs,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:e.jsx($e,{})}),e.jsx(He,{level:4,children:"Support & Assistance"}),e.jsx(Ve,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),e.jsx(Bs,{className:"gray-bg",children:e.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:e.jsxs(se,{gutter:[48,48],children:[e.jsxs(z,{xs:24,lg:12,children:[e.jsx(Ms,{level:2,children:"Our Impact"}),e.jsxs(se,{gutter:[24,24],children:[e.jsx(z,{xs:12,children:e.jsx(En,{children:e.jsx(ve,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),e.jsx(z,{xs:12,children:e.jsx(En,{children:e.jsx(ve,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),e.jsx(z,{xs:12,children:e.jsx(En,{children:e.jsx(ve,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),e.jsx(z,{xs:12,children:e.jsx(En,{children:e.jsx(ve,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),e.jsxs(z,{xs:24,lg:12,children:[e.jsx(Ms,{level:2,children:"What Exhibitors Say"}),e.jsxs(dl,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[e.jsx("div",{children:e.jsxs(Ia,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(yt,{size:64,icon:e.jsx(ke,{}),style:{backgroundColor:"#4158D0"}}),e.jsxs("div",{children:[e.jsx(He,{level:5,style:{margin:0},children:"Sarah Johnson"}),e.jsx(Cn,{type:"secondary",children:"Tech Innovations Inc."})]})]}),e.jsx(Ve,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),e.jsx("div",{children:e.jsxs(Ia,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(yt,{size:64,icon:e.jsx(ke,{}),style:{backgroundColor:"#C850C0"}}),e.jsxs("div",{children:[e.jsx(He,{level:5,style:{margin:0},children:"Michael Chen"}),e.jsx(Cn,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),e.jsx(Ve,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),e.jsx(Bs,{style:{padding:"60px 0"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[e.jsx(He,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),e.jsx(Ve,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),e.jsxs(X,{size:16,wrap:!0,style:{justifyContent:"center"},children:[e.jsx(q,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>t("/exhibitions"),icon:e.jsx(ht,{}),children:"Browse Exhibitions"}),e.jsx(q,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:j,icon:e.jsx(ke,{}),children:"Register as Exhibitor"})]})]})})]}),e.jsx(wo,{})]})},{Title:qp,Text:je,Paragraph:Up}=ue,{Option:Pn}=le,{TextArea:Ca,Search:Op}=Q,{RangePicker:Vp}=tn,Hp=()=>{const t=Ie(),{exhibitors:s,loading:n}=he(U=>U.exhibitor),[i,r]=c.useState(null),[o,a]=c.useState(!1),[p,j]=c.useState(!1),[d,I]=c.useState(!1),[f,x]=c.useState("approved"),[E,w]=c.useState(""),[y,C]=c.useState(!1),[l,m]=c.useState(!1),[P,h]=c.useState(!1),[u,N]=c.useState(""),[g,A]=c.useState([]),[$]=L.useForm(),[T,v]=c.useState([]);T.length>0;const[k,b]=c.useState({total:0,pending:0,approved:0,rejected:0});c.useEffect(()=>{t(It())},[t]),c.useEffect(()=>{if(s!=null&&s.length){A(s);const U={total:s.length,pending:s.filter(W=>W.status==="pending").length,approved:s.filter(W=>W.status==="approved").length,rejected:s.filter(W=>W.status==="rejected").length};b(U)}},[s]),c.useEffect(()=>{i&&p&&$.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,p,$]);const D=U=>{switch(U){case"approved":return e.jsx(re,{color:"success",children:"Approved"});case"pending":return e.jsx(re,{color:"warning",children:"Pending"});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});default:return e.jsx(re,{children:"Unknown"})}},M=async()=>{var U,W;if(i)try{C(!0),await Ze.updateStatus(i._id,f,f==="rejected"?E:void 0),ee.success(`Exhibitor status updated to ${f}`),a(!1),t(It())}catch(J){ee.error(((W=(U=J.response)==null?void 0:U.data)==null?void 0:W.message)||"Failed to update exhibitor status")}finally{C(!1)}},F=async U=>{var W,J;if(i)try{m(!0),await Ze.updateExhibitor(i._id,U),ee.success("Exhibitor details updated successfully"),j(!1),t(It())}catch(de){ee.error(((J=(W=de.response)==null?void 0:W.data)==null?void 0:J.message)||"Failed to update exhibitor details")}finally{m(!1)}},S=async U=>{var W,J;try{h(!0),await Ze.deleteExhibitor(U),ee.success("Exhibitor deleted successfully"),t(It())}catch(de){ee.error(((J=(W=de.response)==null?void 0:W.data)==null?void 0:J.message)||"Failed to delete exhibitor")}finally{h(!1)}},R=U=>{if(N(U),!U){A(s);return}const W=U.toLowerCase(),J=s.filter(de=>de.companyName.toLowerCase().includes(W)||de.contactPerson.toLowerCase().includes(W)||de.email.toLowerCase().includes(W)||de.phone.toLowerCase().includes(W));A(J)},B=U=>{if(U==="all"){A(s);return}const W=s.filter(J=>J.status===U);A(W)},_=U=>{if(!U||U.length!==2){A(s);return}const W=U[0].startOf("day").toISOString(),J=U[1].endOf("day").toISOString(),de=s.filter(ce=>{const ae=new Date(ce.createdAt).toISOString();return ae>=W&&ae<=J});A(de)},V=()=>{const U=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],W=g.map(ne=>[ne.companyName,ne.contactPerson,ne.email,ne.phone,ne.status,ne.isActive?"Yes":"No",new Date(ne.createdAt).toLocaleDateString(),ne.address||"",ne.website||""]);W.unshift(U);const J=W.map(ne=>ne.map(ge=>typeof ge=="string"&&(ge.includes(",")||ge.includes('"')||ge.includes(`
`))?`"${ge.replace(/"/g,'""')}"`:ge).join(",")).join(`
`),de=new Blob([J],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(de),ae=document.createElement("a");ae.setAttribute("href",ce),ae.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),ae.style.visibility="hidden",document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),ee.success("Exhibitor data exported successfully")},Y=()=>{ye.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${T.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{h(!0);const U=T.map(W=>Ze.deleteExhibitor(W.toString()));await Promise.all(U),ee.success(`${T.length} exhibitors deleted successfully`),v([]),t(It())}catch{ee.error("Failed to delete some exhibitors")}finally{h(!1)}}})},G={selectedRowKeys:T,onChange:U=>{v(U)}},H=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(U,W)=>U.companyName.localeCompare(W.companyName),filterDropdown:({setSelectedKeys:U,selectedKeys:W,confirm:J,clearFilters:de})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(Q,{placeholder:"Search company or contact",value:W[0],onChange:ce=>U(ce.target.value?[ce.target.value]:[]),onPressEnter:()=>J(),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(X,{children:[e.jsx(q,{type:"primary",onClick:()=>J(),icon:e.jsx(Bt,{}),size:"small",style:{width:90},children:"Filter"}),e.jsx(q,{onClick:()=>{de&&de(),J()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:U=>e.jsx(Bt,{style:{color:U?"#1890ff":void 0}}),onFilter:(U,W)=>{const J=String(U).toLowerCase();return W.companyName.toLowerCase().includes(J)||W.contactPerson.toLowerCase().includes(J)},render:(U,W)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:U}),e.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",W.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(U,W)=>e.jsxs("div",{children:[e.jsx("div",{children:U}),e.jsx("div",{style:{fontSize:"12px"},children:W.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(U,W)=>W.status===U,render:U=>D(U)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(U,W)=>W.isActive===U,render:U=>e.jsx(re,{color:U?"green":"red",children:U?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(U,W)=>new Date(U.createdAt).getTime()-new Date(W.createdAt).getTime(),render:U=>e.jsx(We,{title:new Date(U).toLocaleString(),children:new Date(U).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:U=>U?e.jsx("a",{href:U,target:"_blank",rel:"noopener noreferrer",children:U.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(U,W)=>e.jsxs(X,{children:[e.jsx(We,{title:"View Details",children:e.jsx(q,{icon:e.jsx(Mt,{}),onClick:()=>{r(W),I(!0)}})}),e.jsx(q,{type:"primary",onClick:()=>{r(W),x(W.status),w(W.rejectionReason||""),a(!0)},children:"Update Status"}),e.jsx(Ot,{overlay:e.jsxs(ct,{children:[e.jsx(ct.Item,{icon:e.jsx(Cs,{}),onClick:()=>{r(W),j(!0)},children:"Edit"},"edit"),e.jsx(ct.Item,{icon:e.jsx(ut,{}),danger:!0,onClick:J=>{J.domEvent.stopPropagation(),ye.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>S(W._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(q,{icon:e.jsx(si,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(se,{gutter:[24,24],align:"middle",children:[e.jsx(z,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(qp,{level:4,style:{margin:0},children:"Exhibitors"}),e.jsx(je,{type:"secondary",children:"Manage exhibitors and their information"})]})}),e.jsx(z,{children:e.jsx(q,{type:"primary",icon:e.jsx(Ws,{}),onClick:()=>j(!0),size:"large",children:"Add Exhibitor"})})]})}),e.jsxs(se,{gutter:[16,24],style:{marginBottom:"24px"},children:[e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Total Exhibitors",value:k.total,prefix:e.jsx(ke,{})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Pending",value:k.pending,prefix:e.jsx(Ge,{style:{color:"#faad14"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Approved",value:k.approved,prefix:e.jsx($e,{style:{color:"#52c41a"}})})})}),e.jsx(z,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ve,{title:"Rejected",value:k.rejected,prefix:e.jsx(ts,{style:{color:"#ff4d4f"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"24px"},children:e.jsxs(X,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(se,{gutter:[16,16],align:"middle",children:[e.jsx(z,{xs:24,sm:8,md:6,lg:4,children:e.jsx(Op,{placeholder:"Search exhibitors",allowClear:!0,onSearch:R,style:{width:"100%"}})}),e.jsx(z,{xs:24,sm:8,md:6,lg:4,children:e.jsxs(le,{placeholder:"Filter by status",style:{width:"100%"},onChange:B,allowClear:!0,children:[e.jsx(Pn,{value:"all",children:"All Status"}),e.jsx(Pn,{value:"pending",children:"Pending"}),e.jsx(Pn,{value:"approved",children:"Approved"}),e.jsx(Pn,{value:"rejected",children:"Rejected"})]})}),e.jsx(z,{xs:24,sm:8,md:6,lg:6,children:e.jsx(Vp,{style:{width:"100%"},onChange:_})})]}),T.length>0&&e.jsx(se,{children:e.jsxs(X,{children:[e.jsxs(je,{children:["Selected ",T.length," items"]}),e.jsx(q,{danger:!0,onClick:Y,children:"Delete Selected"}),e.jsx(q,{type:"primary",onClick:V,children:"Export Selected"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx(De,{rowSelection:G,dataSource:g,columns:H,rowKey:"_id",loading:n,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(U,W)=>`${W[0]}-${W[1]} of ${U} items`},scroll:{x:1500}})}),e.jsx(ye,{title:"Exhibitor Details",open:d,onCancel:()=>I(!1),footer:[e.jsx(q,{onClick:()=>I(!1),children:"Close"},"close")],width:600,children:i&&e.jsx("div",{children:e.jsxs(se,{gutter:[16,16],children:[e.jsx(z,{span:24,children:e.jsx(K,{title:"Company Information",children:e.jsxs(se,{gutter:[16,8],children:[e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Company Name:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.companyName})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Contact Person:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.contactPerson})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Email:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.email})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Phone:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.phone})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Address:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.address||"Not provided"})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Status:"})}),e.jsx(z,{span:12,children:D(i.status)}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Active:"})}),e.jsx(z,{span:12,children:e.jsx(lt,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Registration Date:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:new Date(i.createdAt).toLocaleString()})})]})})}),e.jsx(z,{span:24,children:e.jsxs(K,{title:"Additional Information",children:[e.jsxs(se,{gutter:[16,8],children:[e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Address:"})}),e.jsx(z,{span:12,children:e.jsx(je,{children:i.address||"Not provided"})}),e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Website:"})}),e.jsx(z,{span:12,children:i.website?e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx(z,{span:12,children:e.jsx(je,{strong:!0,children:"Rejection Reason:"})}),e.jsx(z,{span:12,children:e.jsx(je,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{}),e.jsx(je,{strong:!0,children:"Description:"}),e.jsx(Up,{style:{marginTop:8},children:i.description})]})]})})]})})}),e.jsx(ye,{title:"Update Exhibitor Status",open:o,onCancel:()=>a(!1),footer:null,width:600,children:i&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ke,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(se,{gutter:[16,8],children:[e.jsx(z,{span:8,children:e.jsx(je,{strong:!0,children:"Company:"})}),e.jsx(z,{span:16,children:e.jsx(je,{children:i.companyName})}),e.jsx(z,{span:8,children:e.jsx(je,{strong:!0,children:"Contact Person:"})}),e.jsx(z,{span:16,children:e.jsx(je,{children:i.contactPerson})}),e.jsx(z,{span:8,children:e.jsx(je,{strong:!0,children:"Email:"})}),e.jsx(z,{span:16,children:e.jsx(je,{children:i.email})}),e.jsx(z,{span:8,children:e.jsx(je,{strong:!0,children:"Address:"})}),e.jsx(z,{span:16,children:e.jsx(je,{children:i.address||"Not provided"})}),e.jsx(z,{span:8,children:e.jsx(je,{strong:!0,children:"Current Status:"})}),e.jsx(z,{span:16,children:D(i.status)})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ss,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(je,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(St.Group,{value:f,onChange:U=>x(U.target.value),buttonStyle:"solid",children:[e.jsx(St.Button,{value:"pending",children:e.jsxs(X,{children:[e.jsx(Ge,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(St.Button,{value:"approved",children:e.jsxs(X,{children:[e.jsx($e,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(St.Button,{value:"rejected",children:e.jsxs(X,{children:[e.jsx(ts,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),f==="rejected"&&e.jsx("div",{children:e.jsx(L.Item,{label:e.jsx(je,{strong:!0,children:"Rejection Reason:"}),required:f==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:e.jsx(Ca,{rows:4,value:E,onChange:U=>w(U.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),f==="approved"&&e.jsx(_e,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),f==="pending"&&e.jsx(_e,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(q,{onClick:()=>a(!1),children:"Cancel"}),e.jsx(q,{type:"primary",onClick:M,loading:y,disabled:f==="rejected"&&!E.trim(),children:"Update Status"})]})]})]})}),e.jsx(ye,{title:"Edit Exhibitor Details",open:p,onCancel:()=>j(!1),footer:null,width:600,children:e.jsxs(L,{form:$,layout:"vertical",onFinish:F,children:[e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"address",label:"Address",children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"website",label:"Website",children:e.jsx(Q,{})}),e.jsx(L.Item,{name:"description",label:"Description",children:e.jsx(Ca,{rows:4})}),e.jsx(L.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(dt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(L.Item,{children:e.jsxs(X,{children:[e.jsx(q,{type:"primary",htmlType:"submit",loading:l,children:"Save Changes"}),e.jsx(q,{onClick:()=>j(!1),children:"Cancel"})]})})]})})]})},Be=({children:t,requiredPermission:s,requiredPermissions:n=[]})=>{const i=Tt(),r=he(d=>d.auth.isAuthenticated),{hasPermission:o,hasAllPermissions:a}=Za();c.useEffect(()=>{i.pathname==="/dashboard"&&console.log("[ProtectedRoute] Dashboard path check:",{requiredPermission:s,location:i.pathname,state:i.state,isRedirectFromPermissionCheck:i.state&&i.state.isPermissionRedirect})},[i,s]);const p=i.state&&i.state.isPermissionRedirect,j=i.pathname==="/dashboard";return r?p||j?e.jsx(e.Fragment,{children:t}):s&&!o(s)?(console.log("[ProtectedRoute] Access denied for path:",{path:i.pathname,requiredPermission:s,result:!1}),e.jsx(Ss,{to:"/dashboard",state:{unauthorized:!0,isPermissionRedirect:!0,message:"You don't have permission to access this page."},replace:!0})):n.length>0&&!a(n)?e.jsx(Ss,{to:"/dashboard",state:{unauthorized:!0,isPermissionRedirect:!0,message:"You don't have all required permissions to access this page."},replace:!0}):e.jsx(e.Fragment,{children:t}):e.jsx(Ss,{to:"/login",state:{from:i},replace:!0})},js=({children:t})=>he(n=>n.exhibitorAuth.isAuthenticated)?t:e.jsx(Ss,{to:"/"});function Wp(){return e.jsx(Je,{children:e.jsx(an,{children:e.jsx(vl,{children:e.jsxs(wl,{children:[e.jsx(be,{path:"/",element:e.jsx(_p,{})}),e.jsx(be,{path:"/login",element:e.jsx(Yc,{})}),e.jsx(be,{path:"/exhibitions",element:e.jsx(sp,{})}),e.jsx(be,{path:"/exhibitions/:id",element:e.jsx(qh,{})}),e.jsx(be,{path:"/exhibitions/:id/layout",element:e.jsx(Bh,{})}),e.jsx(be,{path:"/exhibitor/dashboard",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx(Zc,{})})})}),e.jsx(be,{path:"/exhibitor/profile",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx(ad,{})})})}),e.jsx(be,{path:"/exhibitor/bookings",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx(sd,{})})})}),e.jsx(be,{path:"/exhibitor/bookings/:id",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx(nd,{})})})}),e.jsx(be,{path:"/exhibitor/support",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx("div",{children:"Help & Support"})})})}),e.jsx(be,{path:"/exhibitor/invoice/:id",element:e.jsx(js,{children:e.jsx(cs,{children:e.jsx(Jd,{})})})}),e.jsx(be,{path:"/dashboard",element:e.jsx(Be,{requiredPermission:"dashboard_view",children:e.jsx(Me,{children:e.jsx(Kc,{})})})}),e.jsx(be,{path:"/account",element:e.jsx(Be,{children:e.jsx(Me,{children:e.jsx(eu,{})})})}),e.jsx(be,{path:"/exhibition",element:e.jsx(Be,{requiredPermission:"exhibitions_view",children:e.jsx(Me,{children:e.jsx(zu,{})})})}),e.jsx(be,{path:"/exhibition/create",element:e.jsx(Be,{requiredPermission:"exhibitions_create",children:e.jsx(Me,{children:e.jsx(Hu,{})})})}),e.jsx(be,{path:"/exhibition/:id",element:e.jsx(Be,{requiredPermission:"exhibitions_view",children:e.jsx(Me,{children:e.jsx(Wu,{})})})}),e.jsx(be,{path:"/exhibition/:id/space",element:e.jsx(Be,{requiredPermission:"exhibitions_view",children:e.jsx(Me,{children:e.jsx(oh,{})})})}),e.jsx(be,{path:"/exhibition/:id/layout",element:e.jsx(Be,{requiredPermission:"manage_layout",children:e.jsx(Me,{children:e.jsx(ch,{})})})}),e.jsx(be,{path:"/exhibition/:id/halls",element:e.jsx(Be,{requiredPermission:"exhibitions_edit",children:e.jsx(Me,{children:e.jsx(uh,{})})})}),e.jsx(be,{path:"/exhibition/:id/stalls",element:e.jsx(Be,{requiredPermission:"exhibitions_edit",children:e.jsx(Me,{children:e.jsx(ip,{})})})}),e.jsx(be,{path:"/exhibition/:id/fixtures",element:e.jsx(Be,{requiredPermission:"view_fixtures",children:e.jsx(Me,{children:e.jsx(op,{})})})}),e.jsx(be,{path:"/exhibition/:id/edit",element:e.jsx(Be,{requiredPermission:"exhibitions_edit",children:e.jsx(Me,{children:e.jsx(Yu,{})})})}),e.jsx(be,{path:"/stall/list",element:e.jsx(Be,{requiredPermission:"view_stalls",children:e.jsx(Me,{children:e.jsx(dp,{})})})}),e.jsx(be,{path:"/stall-types",element:e.jsx(Be,{requiredPermission:"view_stall_types",children:e.jsx(Me,{children:e.jsx(mp,{})})})}),e.jsx(be,{path:"/bookings",element:e.jsx(Be,{requiredPermission:"bookings_view",children:e.jsx(Me,{children:e.jsx(Ip,{})})})}),e.jsx(be,{path:"/bookings/create",element:e.jsx(Be,{requiredPermission:"bookings_create",children:e.jsx(Me,{children:e.jsx(Np,{})})})}),e.jsx(be,{path:"/invoice/:id",element:e.jsx(Be,{requiredPermission:"view_invoices",children:e.jsx(Me,{children:e.jsx(Tp,{})})})}),e.jsx(be,{path:"/index",element:e.jsx(Be,{requiredPermission:"users_view",children:e.jsx(Me,{children:e.jsx(Nu,{})})})}),e.jsx(be,{path:"/settings",element:e.jsx(Be,{requiredPermission:"settings_view",children:e.jsx(Me,{children:e.jsx(nu,{})})})}),e.jsx(be,{path:"/roles",element:e.jsx(Be,{requiredPermission:"roles_view",children:e.jsx(Me,{children:e.jsx(xu,{})})})}),e.jsx(be,{path:"/notifications",element:e.jsx(Be,{children:e.jsx(Me,{children:e.jsx(Fu,{})})})}),e.jsx(be,{path:"/exhibitors",element:e.jsx(Be,{requiredPermission:"exhibitors_view",children:e.jsx(Me,{children:e.jsx(Hp,{})})})}),e.jsx(be,{path:"*",element:e.jsx(Ss,{to:"/",replace:!0})})]})})})})}const zi=pr({reducerPath:"bookingApi",baseQuery:cr({baseUrl:"/api"}),endpoints:t=>({getBookings:t.query({query:()=>"/bookings"}),getBooking:t.query({query:s=>`/bookings/${s}`}),createBooking:t.mutation({query:s=>({url:"/bookings",method:"POST",body:s})}),updateBookingStatus:t.mutation({query:({id:s,status:n})=>({url:`/bookings/${s}/status`,method:"PATCH",body:{status:n}})})})}),Yp=Sl({reducer:{auth:Ml,exhibitorAuth:oc,exhibition:Lu,booking:fp,exhibitor:Pp,settings:Xl,role:du,user:vu,[zi.reducerPath]:zi.reducer,[Hn.reducerPath]:Hn.reducer,[Nn.reducerPath]:Nn.reducer},middleware:t=>t().concat(zi.middleware).concat(Hn.middleware).concat(Nn.middleware)}),Qp={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};Oi.createRoot(document.getElementById("root")).render(e.jsx(Pe.StrictMode,{children:e.jsx(kl,{store:Yp,children:e.jsx(ul,{theme:Qp,children:e.jsx(Je,{children:e.jsx(Wp,{})})})})}));
