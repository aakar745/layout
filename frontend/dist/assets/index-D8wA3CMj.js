import{j as e}from"./vendor-pdf-Cn0rG44s.js";import{a4 as re,r as g,y as E,z as p,S as r,T as de,h as d,af as ce,G as m,H as w,q as W,k as O,t as xe,ai as pe,Z as A,al as he,am as ue,a7 as P,i as R,K as I,d as F,P as ge,e as V,ac as L,ag as U,o as me,f}from"./vendor-antd-B8jUXf3i.js";import{b as fe,u as ye}from"./vendor-redux-rS0pI56E.js";import{q as S,t as K,v as q,w as be,x as G}from"./index-bCNJQtew.js";import{u as je}from"./reduxHooks-BvSvK4-5.js";import{u as ve}from"./vendor-react-DW9h-haf.js";import{l as $,W as X,X as we,I as Se,V as Ce}from"./vendor-antd-icons-BoTJB7uA.js";import"./vendor-http-t--hEgTQ.js";import"./vendor-ui-BmMA_ojr.js";import"./vendor-canvas-DrFPvyt4.js";const{Title:De,Text:y}=de,{RangePicker:ke}=he,Le=()=>{const{message:h,modal:B}=re.useApp(),z=ve(),u=fe(),{exhibitions:o,loading:Z}=ye(t=>t.exhibition),[c,Y]=g.useState([]),[H,C]=g.useState(!1),[j,D]=g.useState(!1),[n,k]=g.useState({status:[],dateRange:null,search:"",activeStatus:null}),[T,J]=g.useState("all"),{hasPermission:_}=je();g.useEffect(()=>{u(S())},[u]);const v=g.useMemo(()=>{const t=o.length,i=o.filter(x=>x.status==="published").length,s=o.filter(x=>new Date(x.startDate)>new Date).length,a=o.filter(x=>x.status==="completed").length,l=o.filter(x=>x.isActive).length;return{total:t,active:i,upcoming:s,completed:a,activeCount:l}},[o]),Q=async t=>{const i=t._id||t.id;try{C(!0),await u(K(i)).unwrap(),h.success("Exhibition deleted successfully")}catch(s){h.error(s.message||"Failed to delete exhibition")}finally{C(!1)}},N=async()=>{B.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(R,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsxs("strong",{children:[c.length," selected exhibitions"]}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(d,{onClick:()=>I.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(d,{danger:!0,type:"primary",onClick:async()=>{try{C(!0),await Promise.all(c.map(t=>u(K(t._id||t.id)).unwrap())),h.success(`Successfully deleted ${c.length} exhibitions`),Y([])}catch(t){h.error(t.message||"Failed to delete some exhibitions")}finally{C(!1),I.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},M=async(t,i)=>{try{D(!0);const s=t._id||t.id;await G.updateExhibition(s,{status:i});const a=o.map(l=>(l._id||l.id)===s?{...l,status:i}:l);u(S.fulfilled(a,"",void 0)),h.success("Status updated successfully")}catch{h.error("Failed to update status"),u(S())}finally{D(!1)}},ee=async(t,i)=>{try{D(!0);const s=t._id||t.id;await G.updateExhibition(s,{isActive:i});const a=o.map(l=>(l._id||l.id)===s?{...l,isActive:i}:l);u(S.fulfilled(a,"",void 0)),h.success(`Exhibition ${i?"activated":"deactivated"} successfully`)}catch{h.error("Failed to update active status"),u(S())}finally{D(!1)}},b=(t,i)=>{const s=t._id||t.id;i==="/layout"?z(q(t,"layout"),{state:{exhibitionId:s}}):z(q(t)+i,{state:{exhibitionId:s}})},te=t=>{switch(t.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},ie=(t,i)=>{const s=te(t);return e.jsxs(r,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[e.jsx(f,{color:s,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:t}),!i&&e.jsx(f,{color:"red",style:{margin:0},children:"Inactive"})]})},se=t=>{const i=new Date,s=new Date(t.startDate),a=new Date(t.endDate);if(i<s)return 0;if(i>a)return 100;const l=a.getTime()-s.getTime(),x=i.getTime()-s.getTime();return Math.round(x/l*100)},le=t=>{B.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(R,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsx("strong",{children:t.name}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(d,{onClick:()=>I.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(d,{danger:!0,type:"primary",onClick:()=>{Q(t),I.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},ae=t=>[{key:"view",label:"View Details",icon:e.jsx(L,{}),onClick:()=>b(t,"")},{key:"edit",label:"Edit Exhibition",icon:e.jsx(U,{}),onClick:()=>b(t,"/edit")},{key:"layout",label:"Manage Layout",icon:e.jsx(Se,{}),onClick:()=>b(t,"/layout")},{type:"divider"},...t.status==="published"?[{key:"public-view",label:"Public View",icon:e.jsx(L,{}),onClick:()=>window.open(be(t),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:e.jsx(Ce,{}),children:[{key:"draft",label:e.jsxs(r,{children:[e.jsx(f,{color:"#faad14",style:{margin:0},children:"Draft"}),e.jsx("span",{children:"Set as Draft"})]}),icon:e.jsx(W,{}),onClick:()=>M(t,"draft"),disabled:t.status==="draft"||j},{key:"published",label:e.jsxs(r,{children:[e.jsx(f,{color:"#52c41a",style:{margin:0},children:"Published"}),e.jsx("span",{children:"Publish"})]}),icon:e.jsx($,{}),onClick:()=>M(t,"published"),disabled:t.status==="published"||j},{key:"completed",label:e.jsxs(r,{children:[e.jsx(f,{color:"#1890ff",style:{margin:0},children:"Completed"}),e.jsx("span",{children:"Mark as Completed"})]}),icon:e.jsx(O,{}),onClick:()=>M(t,"completed"),disabled:t.status==="completed"||j}]},{key:"active-status",label:e.jsxs(r,{children:[t.isActive?e.jsx(f,{color:"red",style:{margin:0},children:"Deactivate"}):e.jsx(f,{color:"#52c41a",style:{margin:0},children:"Activate"}),e.jsx("span",{children:t.isActive?"Deactivate":"Activate"})]}),icon:e.jsx(X,{}),onClick:()=>ee(t,!t.isActive),disabled:j},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(R,{}),danger:!0,onClick:()=>le(t)}],ne=g.useMemo(()=>o.filter(t=>{if(n.search&&!t.name.toLowerCase().includes(n.search.toLowerCase())||n.status.length>0&&!n.status.includes(t.status)||n.activeStatus!==null&&t.isActive!==n.activeStatus)return!1;if(n.dateRange){const[i,s]=n.dateRange,a=new Date(t.startDate),l=new Date(t.endDate);if(a<new Date(i)||l>new Date(s))return!1}switch(T){case"active":return t.status==="published";case"upcoming":return new Date(t.startDate)>new Date;case"completed":return t.status==="completed";default:return!0}}),[o,n,T]),oe=[{title:"Exhibition Details",key:"details",render:(t,i)=>e.jsx(y,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>b(i,""),children:i.name})},{title:"Status",key:"status",width:180,align:"center",render:(t,i)=>ie(i.status,i.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(t,i)=>i.status===t},{title:"Start Date",key:"startDate",width:130,render:(t,i)=>e.jsx(y,{children:F(i.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(t,i)=>e.jsx(y,{children:F(i.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(t,i)=>e.jsx(y,{children:F(i.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(t,i)=>e.jsx(ge,{percent:se(i),size:"small",status:i.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(t,i)=>e.jsxs(r,{size:"middle",children:[_("exhibitions_view")&&e.jsx(V,{title:"View Details",children:e.jsx(d,{type:"text",icon:e.jsx(L,{}),onClick:()=>b(i,"")})}),_("exhibitions_edit")&&e.jsx(V,{title:"Edit Exhibition",children:e.jsx(d,{type:"text",icon:e.jsx(U,{}),onClick:()=>b(i,"/edit")})}),_("exhibitions_delete")&&e.jsx(me,{menu:{items:ae(i)},trigger:["click"],placement:"bottomRight",children:e.jsx(d,{type:"text",icon:e.jsx(we,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(E,{gutter:[24,24],align:"middle",children:[e.jsx(p,{flex:"auto",children:e.jsxs(r,{direction:"vertical",size:4,children:[e.jsx(De,{level:4,style:{margin:0},children:"Exhibitions"}),e.jsx(y,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),e.jsx(p,{children:e.jsx(d,{type:"primary",icon:e.jsx(ce,{}),onClick:()=>z("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),e.jsxs(E,{gutter:[24,24],style:{marginBottom:"24px"},children:[e.jsx(p,{xs:24,sm:12,md:6,lg:4,children:e.jsx(m,{children:e.jsx(w,{title:"Total Exhibitions",value:v.total,prefix:e.jsx(W,{})})})}),e.jsx(p,{xs:24,sm:12,md:6,lg:5,children:e.jsx(m,{children:e.jsx(w,{title:"Published Exhibitions",value:v.active,prefix:e.jsx($,{style:{color:"#52c41a"}})})})}),e.jsx(p,{xs:24,sm:12,md:6,lg:5,children:e.jsx(m,{children:e.jsx(w,{title:"Upcoming Exhibitions",value:v.upcoming,prefix:e.jsx(O,{style:{color:"#1890ff"}})})})}),e.jsx(p,{xs:24,sm:12,md:6,lg:5,children:e.jsx(m,{children:e.jsx(w,{title:"Completed Exhibitions",value:v.completed,prefix:e.jsx($,{style:{color:"#8c8c8c"}})})})}),e.jsx(p,{xs:24,sm:12,md:6,lg:5,children:e.jsx(m,{children:e.jsx(w,{title:"Active Status",value:v.activeCount,prefix:e.jsx(X,{style:{color:"#52c41a"}})})})})]}),e.jsx(m,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:e.jsxs(r,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(E,{gutter:[16,16],align:"middle",children:[e.jsx(p,{flex:"auto",children:e.jsxs(r,{size:"middle",wrap:!0,children:[e.jsx(xe,{placeholder:"Search exhibitions",prefix:e.jsx(pe,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:n.search,onChange:t=>k(i=>({...i,search:t.target.value})),allowClear:!0}),e.jsx(A,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:n.status,onChange:t=>k(i=>({...i,status:t})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),e.jsxs(A,{placeholder:"Active Status",style:{width:"150px"},value:n.activeStatus,onChange:t=>k(i=>({...i,activeStatus:t})),allowClear:!0,children:[e.jsx(A.Option,{value:!0,children:"Active"}),e.jsx(A.Option,{value:!1,children:"Inactive"})]}),e.jsx(ke,{onChange:t=>k(i=>{var s,a;return{...i,dateRange:t?[((s=t[0])==null?void 0:s.toISOString())||"",((a=t[1])==null?void 0:a.toISOString())||""]:null}})})]})}),e.jsx(p,{children:e.jsx(ue,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:T,onChange:t=>J(t)})})]}),c.length>0&&e.jsx(E,{children:e.jsxs(r,{children:[e.jsxs(y,{children:["Selected ",c.length," items"]}),e.jsx(d,{danger:!0,onClick:N,children:"Delete Selected"})]})})]})}),e.jsx(m,{className:"info-card",styles:{body:{padding:0}},children:e.jsx(P,{columns:oe,dataSource:ne.map(t=>({...t,key:t._id||t.id})),rowKey:t=>t._id||t.id,loading:Z||H||j,rowSelection:{selectedRowKeys:c.map(t=>t._id||t.id),onChange:(t,i)=>Y(i),selections:[P.SELECTION_ALL,P.SELECTION_NONE]},footer:()=>c.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[e.jsxs(y,{children:["Selected ",e.jsx("strong",{children:c.length})," ",c.length===1?"exhibition":"exhibitions"]}),e.jsx(d,{danger:!0,onClick:N,icon:e.jsx(R,{}),loading:H,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:t=>`Total ${t} items`,style:{marginTop:"16px"}}})})]})};export{Le as default};
