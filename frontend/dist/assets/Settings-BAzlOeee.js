import{j as e}from"./vendor-pdf-Cn0rG44s.js";import{a4 as E,F as n,r as j,y as U,z as y,S as I,T as z,G as k,t as v,Z as T,$ as C,a3 as B,P as L,h as R}from"./vendor-antd-B8jUXf3i.js";import{f as A,b as S,u as V,c as q}from"./index-bCNJQtew.js";import{b as O,u as M}from"./vendor-redux-rS0pI56E.js";import{N as D,U as G,K}from"./vendor-antd-icons-BoTJB7uA.js";import"./vendor-react-DW9h-haf.js";import"./vendor-http-t--hEgTQ.js";import"./vendor-ui-BmMA_ojr.js";import"./vendor-canvas-DrFPvyt4.js";const{Option:d}=T,{Title:Z,Text:H}=z,ae=()=>{const h=O(),{message:u}=E.useApp(),[c]=n.useForm(),{settings:t,loading:$}=M(a=>a.settings),[f,r]=j.useState([]),[p,g]=j.useState(0);j.useEffect(()=>{h(A())},[h]),j.useEffect(()=>{if(t&&(c.setFieldsValue({siteName:t.siteName,adminEmail:t.adminEmail,language:t.language,timezone:t.timezone,emailNotifications:t.emailNotifications,footerText:t.footerText}),t.logo)){const a=s=>{const l=localStorage.getItem("token");return{url:`${S.defaults.baseURL}/uploads/${s}`,token:l}},{url:i,token:o}=a(t.logo);fetch(i,{headers:{authorization:`Bearer ${o}`}}).then(s=>s.blob()).then(s=>{var m;const l=URL.createObjectURL(s);r([{uid:"-1",name:((m=t.logo)==null?void 0:m.split("/").pop())||"logo",status:"done",url:l,thumbUrl:l,type:s.type,response:{path:t.logo}}])}).catch(()=>{r([])})}},[t,c]);const F=a=>{h(V(a)).unwrap().then(()=>u.success("Settings updated successfully")).catch(i=>u.error(`Failed to update settings: ${i}`))},N={name:"file",action:`${S.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:f,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:i,name:o,response:s,uid:l}=a.file;if(i==="uploading"){r([...a.fileList]);return}if(i==="done"&&s){g(0);const m=localStorage.getItem("token"),w=`${S.defaults.baseURL}/uploads/${s.path}`;fetch(w,{headers:{authorization:`Bearer ${m}`}}).then(x=>x.blob()).then(x=>{const b=URL.createObjectURL(x);r([{uid:a.file.uid,name:o,status:"done",url:b,thumbUrl:b,type:x.type,response:s}]),u.success(`${o} uploaded successfully`),c.setFieldValue("logo",s.path)}).catch(()=>{u.error(`${o} preview failed to load`),r([])})}else i==="error"?(u.error(`${o} upload failed.`),r([]),g(0)):i==="removed"&&(r([]),c.setFieldValue("logo",null),g(0))},onRemove(){return r([]),c.setFieldValue("logo",null),g(0),!0},customRequest:async({file:a,onSuccess:i,onError:o,onProgress:s})=>{try{h(q(a)).unwrap().then(l=>{i&&i(l)}).catch(l=>{o&&o(new Error(l))})}catch(l){o&&o(l)}}},P=e.jsx("div",{children:p>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(L,{type:"circle",percent:p,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(U,{gutter:[24,24],align:"middle",children:e.jsx(y,{flex:"auto",children:e.jsxs(I,{direction:"vertical",size:4,children:[e.jsx(Z,{level:4,style:{margin:0},children:"Settings"}),e.jsx(H,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(k,{className:"info-card",children:e.jsxs(n,{form:c,layout:"vertical",onFinish:F,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(U,{gutter:24,children:[e.jsxs(y,{span:12,children:[e.jsx(n.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Language",name:"language",children:e.jsxs(T,{children:[e.jsx(d,{value:"en",children:"English"}),e.jsx(d,{value:"es",children:"Spanish"}),e.jsx(d,{value:"fr",children:"French"})]})}),e.jsx(n.Item,{label:"Timezone",name:"timezone",children:e.jsxs(T,{children:[e.jsx(d,{value:"UTC",children:"UTC"}),e.jsx(d,{value:"EST",children:"EST"}),e.jsx(d,{value:"PST",children:"PST"})]})}),e.jsx(n.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(C,{})})]}),e.jsxs(y,{span:12,children:[e.jsxs(n.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(B,{...N,children:f.length<1&&P}),f.length>0&&p>0&&e.jsx(L,{percent:p,status:"active",style:{marginTop:8}})]}),e.jsx(n.Item,{label:"Footer Text",name:"footerText",children:e.jsx(v.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(n.Item,{children:e.jsxs(I,{children:[e.jsx(R,{type:"primary",htmlType:"submit",icon:e.jsx(D,{}),loading:$,children:"Save Settings"}),e.jsx(R,{onClick:()=>c.resetFields(),icon:e.jsx(G,{}),children:"Reset"})]})})]})})]})};export{ae as default};
