var Rl=Object.defineProperty;var _l=(s,t,n)=>t in s?Rl(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var ao=(s,t,n)=>_l(s,typeof t!="symbol"?t+"":t,n);import{j as e}from"./vendor-pdf-CG94LN5B.js";import{b as Dl,c as Ll,g as $l,d as Ae,T as pe,L as $t,e as _e,S as J,f as le,B as gt,A as wt,h as O,i as ot,j as $r,k as Pe,l as Fl,m as et,n as dn,r as l,o as yn,p as Fr,q as gi,s as Nt,t as at,u as Pt,E as Ve,D as Te,v as vs,w as qe,M as jt,x as wa,y as Sa,z as fi,C as yi,F as Br,G as ut,H as Be,I as Jt,J as Mr,K as Bl,N as Ml,O as G,P as L,Q as jr,U as zr,V as He,W as Kt,X as Tt,Y as Rt,Z as se,$ as vr,a0 as bi,a1 as zl,a2 as ie,a3 as F,a4 as K,a as De,a5 as ke,a6 as Ft,a7 as ka,a8 as de,a9 as Ne,aa as Et,ab as Xt,ac as je,ad as qs,ae as as,af as fe,ag as qr,ah as Ot,ai as Or,aj as ws,ak as Ur,al as Ca,am as st,an as xt,ao as un,ap as ql,aq as hn,ar as lt,as as Ms,at as Ol,au as os,av as Ul,aw as Ht,ax as Ii,ay as pn,az as Os,aA as lo,aB as Vl,aC as Vr,aD as Ss,aE as ze,aF as xs,aG as ys,aH as bn,aI as Hl,aJ as Wl,aK as Yl,aL as Ia,aM as Ql,aN as co,aO as Gl,aP as Kl,aQ as Xl,aR as Ea,aS as jn,aT as Jl,aU as uo,aV as Zl,aW as ec,aX as tc,aY as ho,aZ as Aa,a_ as sc,a$ as nc,b0 as ic,b1 as rc,b2 as oc,b3 as ac,b4 as lc,b5 as wr,b6 as cc,b7 as Bt,b8 as dc,b9 as uc,ba as po,bb as hc,bc as pc}from"./vendor-antd-BNA5dld-.js";import{c as Ce,a as dt,u as Ie,b as ge,d as Re,e as Zt,L as pt,f as ft,w as mo,n as Ta,g as Na,i as mn,h as mc,j as Us,k as Pa,p as Hr,l as Ys,m as ji,o as Wr,q as bs,r as xo,s as xc,S as Ra,t as $i,v as Yr,x as _a,y as gc,z as Da,A as fc,B as go,C as yc,D as bc,E as jc,F as vc,G as nn,N as Ei,H as wc,I as Sc,R as kc,J as Se,K as Cc,P as Ic}from"./vendor-react-lX1aYT_Q.js";import{a as ht}from"./vendor-utils-yeEhIob8.js";import{n as te,k as ls}from"./vendor-ui-D3b2tKg7.js";import{E as Ec}from"./vendor-editor-BYve5TpA.js";import{L as vi,G as zs,R as Ai,T as xn,u as Ac,a as Tc,I as Nc,C as Pc,b as Rc,c as _c,K as Fi,S as Dc,F as Lc,d as $c}from"./vendor-canvas-DSskLsu-.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Sr={},fo=Dl;Sr.createRoot=fo.createRoot,Sr.hydrateRoot=fo.hydrateRoot;const Ti="/api",ne=ht.create({baseURL:Ti,headers:{"Content-Type":"application/json",Accept:"application/json"}}),ds=ht.create({baseURL:Ti,headers:{"Content-Type":"application/json",Accept:"application/json"}}),La=ht.create({baseURL:Ti,headers:{"Content-Type":"application/json",Accept:"application/json"}});ne.interceptors.request.use(s=>{var o,a,u,y,d,f,x,h,R;const t=localStorage.getItem("token"),n=localStorage.getItem("exhibitor_token"),i=((o=s.url)==null?void 0:o.startsWith("/bookings/"))&&s.method==="patch"||((a=s.url)==null?void 0:a.includes("/exhibition/"))||((u=s.url)==null?void 0:u.includes("/stalls/"))||((y=s.url)==null?void 0:y.includes("/halls/"))||((d=s.url)==null?void 0:d.includes("/users/"))||((f=s.url)==null?void 0:f.includes("/roles/")),r=((x=s.url)==null?void 0:x.includes("/test-booking"))||((h=s.url)==null?void 0:h.includes("/exhibitor-bookings"))||((R=s.url)==null?void 0:R.startsWith("/exhibitors/"));return i?t?s.headers.Authorization=`Bearer ${t}`:console.warn("Admin token required but not found for:",s.url):r&&n?s.headers.Authorization=`Bearer ${n}`:t?s.headers.Authorization=`Bearer ${t}`:n&&(s.headers.Authorization=`Bearer ${n}`),s},s=>Promise.reject(s));La.interceptors.request.use(s=>{const t=localStorage.getItem("exhibitor_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));ne.interceptors.response.use(s=>s,s=>{var n,i,r;((n=s.response)==null?void 0:n.status)===401&&localStorage.removeItem("token");const t=((r=(i=s.response)==null?void 0:i.data)==null?void 0:r.message)||s.message;return Promise.reject(new Error(t))});La.interceptors.response.use(s=>s,s=>{var n,i,r;((n=s.response)==null?void 0:n.status)===401&&localStorage.removeItem("exhibitor_token");const t=((r=(i=s.response)==null?void 0:i.data)==null?void 0:r.message)||s.message;return Promise.reject(new Error(t))});const $a=async(s,t=!1,n)=>{const i=t?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return ht.get(`${Ti}${s}`,{responseType:"blob",headers:{Authorization:`Bearer ${i}`},onDownloadProgress:n})},wi={login:async s=>await ne.post("/auth/login",s),getProfile:async()=>await ne.get("/auth/me"),changePassword:async s=>await ne.post("/auth/change-password",s)},yo=localStorage.getItem("token"),Bi=localStorage.getItem("user");let Fa=null;try{Fa=Bi&&Bi!=="undefined"?JSON.parse(Bi):null}catch(s){console.error("Failed to parse user data from localStorage",s),localStorage.removeItem("user")}const Fc={isAuthenticated:!!yo,user:Fa,token:yo,loading:!1,error:null},Yn=Ce("auth/refreshUser",async(s,{rejectWithValue:t})=>{var n,i;try{return(await wi.getProfile()).data}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to refresh user data")}}),Ba=dt({name:"auth",initialState:Fc,reducers:{setCredentials:(s,t)=>{s.user=t.payload.user,s.token=t.payload.token,s.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:s=>{s.user=null,s.token=null,s.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:s=>{s.addCase(Yn.pending,t=>{t.loading=!0,t.error=null}).addCase(Yn.fulfilled,(t,n)=>{t.loading=!1,t.user=n.payload,localStorage.setItem("user",JSON.stringify(n.payload))}).addCase(Yn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{setCredentials:Ma,logout:bo}=Ba.actions,Bc=Ba.reducer,Ut=Object.create(null);Ut.open="0";Ut.close="1";Ut.ping="2";Ut.pong="3";Ut.message="4";Ut.upgrade="5";Ut.noop="6";const Qn=Object.create(null);Object.keys(Ut).forEach(s=>{Qn[Ut[s]]=s});const kr={type:"error",data:"parser error"},za=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",qa=typeof ArrayBuffer=="function",Oa=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,Qr=({type:s,data:t},n,i)=>za&&t instanceof Blob?n?i(t):jo(t,i):qa&&(t instanceof ArrayBuffer||Oa(t))?n?i(t):jo(new Blob([t]),i):i(Ut[s]+(t||"")),jo=(s,t)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];t("b"+(i||""))},n.readAsDataURL(s)};function vo(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Mi;function Mc(s,t){if(za&&s.data instanceof Blob)return s.data.arrayBuffer().then(vo).then(t);if(qa&&(s.data instanceof ArrayBuffer||Oa(s.data)))return t(vo(s.data));Qr(s,!1,n=>{Mi||(Mi=new TextEncoder),t(Mi.encode(n))})}const wo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sn=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<wo.length;s++)sn[wo.charCodeAt(s)]=s;const zc=s=>{let t=s.length*.75,n=s.length,i,r=0,o,a,u,y;s[s.length-1]==="="&&(t--,s[s.length-2]==="="&&t--);const d=new ArrayBuffer(t),f=new Uint8Array(d);for(i=0;i<n;i+=4)o=sn[s.charCodeAt(i)],a=sn[s.charCodeAt(i+1)],u=sn[s.charCodeAt(i+2)],y=sn[s.charCodeAt(i+3)],f[r++]=o<<2|a>>4,f[r++]=(a&15)<<4|u>>2,f[r++]=(u&3)<<6|y&63;return d},qc=typeof ArrayBuffer=="function",Gr=(s,t)=>{if(typeof s!="string")return{type:"message",data:Ua(s,t)};const n=s.charAt(0);return n==="b"?{type:"message",data:Oc(s.substring(1),t)}:Qn[n]?s.length>1?{type:Qn[n],data:s.substring(1)}:{type:Qn[n]}:kr},Oc=(s,t)=>{if(qc){const n=zc(s);return Ua(n,t)}else return{base64:!0,data:s}},Ua=(s,t)=>{switch(t){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},Va="",Uc=(s,t)=>{const n=s.length,i=new Array(n);let r=0;s.forEach((o,a)=>{Qr(o,!1,u=>{i[a]=u,++r===n&&t(i.join(Va))})})},Vc=(s,t)=>{const n=s.split(Va),i=[];for(let r=0;r<n.length;r++){const o=Gr(n[r],t);if(i.push(o),o.type==="error")break}return i};function Hc(){return new TransformStream({transform(s,t){Mc(s,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);const o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(n)})}})}let zi;function kn(s){return s.reduce((t,n)=>t+n.length,0)}function Cn(s,t){if(s[0].length===t)return s.shift();const n=new Uint8Array(t);let i=0;for(let r=0;r<t;r++)n[r]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),n}function Wc(s,t){zi||(zi=new TextDecoder);const n=[];let i=0,r=-1,o=!1;return new TransformStream({transform(a,u){for(n.push(a);;){if(i===0){if(kn(n)<1)break;const y=Cn(n,1);o=(y[0]&128)===128,r=y[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(kn(n)<2)break;const y=Cn(n,2);r=new DataView(y.buffer,y.byteOffset,y.length).getUint16(0),i=3}else if(i===2){if(kn(n)<8)break;const y=Cn(n,8),d=new DataView(y.buffer,y.byteOffset,y.length),f=d.getUint32(0);if(f>Math.pow(2,21)-1){u.enqueue(kr);break}r=f*Math.pow(2,32)+d.getUint32(4),i=3}else{if(kn(n)<r)break;const y=Cn(n,r);u.enqueue(Gr(o?y:zi.decode(y),t)),i=0}if(r===0||r>s){u.enqueue(kr);break}}}})}const Ha=4;function Ge(s){if(s)return Yc(s)}function Yc(s){for(var t in Ge.prototype)s[t]=Ge.prototype[t];return s}Ge.prototype.on=Ge.prototype.addEventListener=function(s,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(t),this};Ge.prototype.once=function(s,t){function n(){this.off(s,n),t.apply(this,arguments)}return n.fn=t,this.on(s,n),this};Ge.prototype.off=Ge.prototype.removeListener=Ge.prototype.removeAllListeners=Ge.prototype.removeEventListener=function(s,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+s];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+s],this};Ge.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+s],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,t)}return this};Ge.prototype.emitReserved=Ge.prototype.emit;Ge.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ge.prototype.hasListeners=function(s){return!!this.listeners(s).length};const Ni=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),bt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Qc="arraybuffer";function Wa(s,...t){return t.reduce((n,i)=>(s.hasOwnProperty(i)&&(n[i]=s[i]),n),{})}const Gc=bt.setTimeout,Kc=bt.clearTimeout;function Pi(s,t){t.useNativeTimers?(s.setTimeoutFn=Gc.bind(bt),s.clearTimeoutFn=Kc.bind(bt)):(s.setTimeoutFn=bt.setTimeout.bind(bt),s.clearTimeoutFn=bt.clearTimeout.bind(bt))}const Xc=1.33;function Jc(s){return typeof s=="string"?Zc(s):Math.ceil((s.byteLength||s.size)*Xc)}function Zc(s){let t=0,n=0;for(let i=0,r=s.length;i<r;i++)t=s.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function Ya(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ed(s){let t="";for(let n in s)s.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(s[n]));return t}function td(s){let t={},n=s.split("&");for(let i=0,r=n.length;i<r;i++){let o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}class sd extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}}class Kr extends Ge{constructor(t){super(),this.writable=!1,Pi(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,i){return super.emitReserved("error",new sd(t,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Gr(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=ed(t);return n.length?"?"+n:""}}class nd extends Kr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Vc(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Uc(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Ya()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Qa=!1;try{Qa=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const id=Qa;function rd(){}class od extends nd{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,n){const i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=t}}let $s=class Gn extends Ge{constructor(t,n,i){super(),this.createRequest=t,Pi(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const n=Wa(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Gn.requestsCount++,Gn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=rd,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Gn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};$s.requestsCount=0;$s.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",So);else if(typeof addEventListener=="function"){const s="onpagehide"in bt?"pagehide":"unload";addEventListener(s,So,!1)}}function So(){for(let s in $s.requests)$s.requests.hasOwnProperty(s)&&$s.requests[s].abort()}const ad=function(){const s=Ga({xdomain:!1});return s&&s.responseType!==null}();class ld extends od{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=ad&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new $s(Ga,this.uri(),t)}}function Ga(s){const t=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||id))return new XMLHttpRequest}catch{}if(!t)try{return new bt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ka=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class cd extends Kr{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,i=Ka?{}:Wa(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],r=n===t.length-1;Qr(i,this.supportsBinary,o=>{try{this.doWrite(i,o)}catch{}r&&Ni(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Ya()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const qi=bt.WebSocket||bt.MozWebSocket;class dd extends cd{createSocket(t,n,i){return Ka?new qi(t,n,i):n?new qi(t,n):new qi(t)}doWrite(t,n){this.ws.send(n)}}class ud extends Kr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=Wc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(n).getReader(),r=Hc();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();const o=()=>{i.read().then(({done:u,value:y})=>{u||(this.onPacket(y),o())}).catch(u=>{})};o();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],r=n===t.length-1;this._writer.write(i).then(()=>{r&&Ni(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const hd={websocket:dd,webtransport:ud,polling:ld},pd=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,md=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Cr(s){if(s.length>8e3)throw"URI too long";const t=s,n=s.indexOf("["),i=s.indexOf("]");n!=-1&&i!=-1&&(s=s.substring(0,n)+s.substring(n,i).replace(/:/g,";")+s.substring(i,s.length));let r=pd.exec(s||""),o={},a=14;for(;a--;)o[md[a]]=r[a]||"";return n!=-1&&i!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=xd(o,o.path),o.queryKey=gd(o,o.query),o}function xd(s,t){const n=/\/{2,9}/g,i=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function gd(s,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,o){r&&(n[r]=o)}),n}const Ir=typeof addEventListener=="function"&&typeof removeEventListener=="function",Kn=[];Ir&&addEventListener("offline",()=>{Kn.forEach(s=>s())},!1);class rs extends Ge{constructor(t,n){if(super(),this.binaryType=Qc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const i=Cr(t);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=Cr(n.host).host);Pi(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=td(this.opts.query)),Ir&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Kn.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Ha,n.transport=t,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&rs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",rs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(n+=Jc(r)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ni(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,i){return this._sendPacket("message",t,n,i),this}send(t,n,i){return this._sendPacket("message",t,n,i),this}_sendPacket(t,n,i,r){if(typeof n=="function"&&(r=n,n=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const o={type:t,data:n,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(rs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ir&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Kn.indexOf(this._offlineEventListener);i!==-1&&Kn.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}rs.protocol=Ha;class fd extends rs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),i=!1;rs.priorWebsocketSuccess=!1;const r=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",x=>{if(!i)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;rs.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(f(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function o(){i||(i=!0,f(),n.close(),n=null)}const a=x=>{const h=new Error("probe error: "+x);h.transport=n.name,o(),this.emitReserved("upgradeError",h)};function u(){a("transport closed")}function y(){a("socket closed")}function d(x){n&&x.name!==n.name&&o()}const f=()=>{n.removeListener("open",r),n.removeListener("error",a),n.removeListener("close",u),this.off("close",y),this.off("upgrading",d)};n.once("open",r),n.once("error",a),n.once("close",u),this.once("close",y),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&n.push(t[i]);return n}}let yd=class extends fd{constructor(t,n={}){const i=typeof t=="object"?t:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>hd[r]).filter(r=>!!r)),super(t,i)}};function bd(s,t="",n){let i=s;n=n||typeof location<"u"&&location,s==null&&(s=n.protocol+"//"+n.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=n.protocol+s:s=n.host+s),/^(https?|wss?):\/\//.test(s)||(typeof n<"u"?s=n.protocol+"//"+s:s="https://"+s),i=Cr(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+t,i.href=i.protocol+"://"+o+(n&&n.port===i.port?"":":"+i.port),i}const jd=typeof ArrayBuffer=="function",vd=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Xa=Object.prototype.toString,wd=typeof Blob=="function"||typeof Blob<"u"&&Xa.call(Blob)==="[object BlobConstructor]",Sd=typeof File=="function"||typeof File<"u"&&Xa.call(File)==="[object FileConstructor]";function Xr(s){return jd&&(s instanceof ArrayBuffer||vd(s))||wd&&s instanceof Blob||Sd&&s instanceof File}function Xn(s,t){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let n=0,i=s.length;n<i;n++)if(Xn(s[n]))return!0;return!1}if(Xr(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return Xn(s.toJSON(),!0);for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)&&Xn(s[n]))return!0;return!1}function kd(s){const t=[],n=s.data,i=s;return i.data=Er(n,t),i.attachments=t.length,{packet:i,buffers:t}}function Er(s,t){if(!s)return s;if(Xr(s)){const n={_placeholder:!0,num:t.length};return t.push(s),n}else if(Array.isArray(s)){const n=new Array(s.length);for(let i=0;i<s.length;i++)n[i]=Er(s[i],t);return n}else if(typeof s=="object"&&!(s instanceof Date)){const n={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=Er(s[i],t));return n}return s}function Cd(s,t){return s.data=Ar(s.data,t),delete s.attachments,s}function Ar(s,t){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<t.length)return t[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let n=0;n<s.length;n++)s[n]=Ar(s[n],t);else if(typeof s=="object")for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(s[n]=Ar(s[n],t));return s}const Id=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ed=5;var ve;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(ve||(ve={}));class Ad{constructor(t){this.replacer=t}encode(t){return(t.type===ve.EVENT||t.type===ve.ACK)&&Xn(t)?this.encodeAsBinary({type:t.type===ve.EVENT?ve.BINARY_EVENT:ve.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===ve.BINARY_EVENT||t.type===ve.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=kd(t),i=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(i),r}}function ko(s){return Object.prototype.toString.call(s)==="[object Object]"}class Jr extends Ge{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const i=n.type===ve.BINARY_EVENT;i||n.type===ve.BINARY_ACK?(n.type=i?ve.EVENT:ve.ACK,this.reconstructor=new Td(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Xr(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const i={type:Number(t.charAt(0))};if(ve[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ve.BINARY_EVENT||i.type===ve.BINARY_ACK){const o=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const a=t.substring(o,n);if(a!=Number(a)||t.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(a)}if(t.charAt(n+1)==="/"){const o=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););i.nsp=t.substring(o,n)}else i.nsp="/";const r=t.charAt(n+1);if(r!==""&&Number(r)==r){const o=n+1;for(;++n;){const a=t.charAt(n);if(a==null||Number(a)!=a){--n;break}if(n===t.length)break}i.id=Number(t.substring(o,n+1))}if(t.charAt(++n)){const o=this.tryParse(t.substr(n));if(Jr.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case ve.CONNECT:return ko(n);case ve.DISCONNECT:return n===void 0;case ve.CONNECT_ERROR:return typeof n=="string"||ko(n);case ve.EVENT:case ve.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Id.indexOf(n[0])===-1);case ve.ACK:case ve.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Td{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=Cd(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Nd=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Jr,Encoder:Ad,get PacketType(){return ve},protocol:Ed},Symbol.toStringTag,{value:"Module"}));function Ct(s,t,n){return s.on(t,n),function(){s.off(t,n)}}const Pd=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ja extends Ge{constructor(t,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ct(t,"open",this.onopen.bind(this)),Ct(t,"packet",this.onpacket.bind(this)),Ct(t,"error",this.onerror.bind(this)),Ct(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var i,r,o;if(Pd.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const a={type:ve.EVENT,data:n};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const f=this.ids++,x=n.pop();this._registerAckCallback(f,x),a.id=f}const u=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,y=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!u||(y?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,n){var i;const r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[t]=n;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===t&&this.sendBuffer.splice(u,1);n.call(this,new Error("operation has timed out"))},r),a=(...u)=>{this.io.clearTimeoutFn(o),n.apply(this,u)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...n){return new Promise((i,r)=>{const o=(a,u)=>a?r(a):i(u);o.withError=!0,n.push(o),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...o)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ve.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ve.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ve.EVENT:case ve.BINARY_EVENT:this.onevent(t);break;case ve.ACK:case ve.BINARY_ACK:this.onack(t);break;case ve.DISCONNECT:this.ondisconnect();break;case ve.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let i=!1;return function(...r){i||(i=!0,n.packet({type:ve.ACK,id:t,data:r}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ve.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,t.data)}}}function Vs(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Vs.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*s);s=Math.floor(t*10)&1?s+n:s-n}return Math.min(s,this.max)|0};Vs.prototype.reset=function(){this.attempts=0};Vs.prototype.setMin=function(s){this.ms=s};Vs.prototype.setMax=function(s){this.max=s};Vs.prototype.setJitter=function(s){this.jitter=s};class Tr extends Ge{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Pi(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Vs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const r=n.parser||Nd;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new yd(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=Ct(n,"open",function(){i.onopen(),t&&t()}),o=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),t?t(u):this.maybeReconnectOnOpen()},a=Ct(n,"error",o);if(this._timeout!==!1){const u=this._timeout,y=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),n.close()},u);this.opts.autoUnref&&y.unref(),this.subs.push(()=>{this.clearTimeoutFn(y)})}return this.subs.push(r),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ct(t,"ping",this.onping.bind(this)),Ct(t,"data",this.ondata.bind(this)),Ct(t,"error",this.onerror.bind(this)),Ct(t,"close",this.onclose.bind(this)),Ct(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Ni(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Ja(this,t,n),this.nsps[t]=i),i}_destroy(t){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Qs={};function Jn(s,t){typeof s=="object"&&(t=s,s=void 0),t=t||{};const n=bd(s,t.path||"/socket.io"),i=n.source,r=n.id,o=n.path,a=Qs[r]&&o in Qs[r].nsps,u=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let y;return u?y=new Tr(i,t):(Qs[r]||(Qs[r]=new Tr(i,t)),y=Qs[r]),n.query&&!t.query&&(t.query=n.queryKey),y.socket(n.path,t)}Object.assign(Jn,{Manager:Tr,Socket:Ja,io:Jn,connect:Jn});const Rd=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",Lt=Rd?"https://aakardata.in/api":"http://localhost:5000/api",_d="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class Dd{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",n=localStorage.getItem(t);n?this.init(n,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(n=>{this.triggerEvent("notification",n)})}}init(t,n=!1){var i;if(!((i=this.socket)!=null&&i.connected&&this.lastToken===t&&this.isExhibitor===n)){this.isExhibitor=n,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const r=Lt.replace("/api",""),o=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Jn(r,{auth:{token:o,type:n?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(r){console.error("Error initializing notification socket:",r),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}removeEventListener(t,n){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(i=>i!==n))}triggerEvent(t,n){this.listeners[t]&&this.listeners[t].forEach(i=>{try{i(n)}catch(r){console.error(`Error in notification ${t} listener:`,r)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",n={limit:1,page:1,unreadOnly:!0},i=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(i);if(!r)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const o=await ht.get(t,{baseURL:Lt,params:n,headers:{Authorization:`Bearer ${r}`}});return o.data&&o.data.success?(this.unreadCount=o.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,n=10,i=!1){try{const r=this.isExhibitor?"notifications/exhibitor":"notifications/admin",o={page:t,limit:n,unreadOnly:i},a=this.isExhibitor?"exhibitor_token":"token",u=localStorage.getItem(a);if(!u)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await ht.get(r,{baseURL:Lt,params:o,headers:{Authorization:`Bearer ${u}`}})).data}catch(r){return console.error("Error fetching notifications:",r),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const n=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,i=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(i);if(!r)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const o=await ht.put(n,{},{baseURL:Lt,headers:{Authorization:`Bearer ${r}`}});return o.data&&o.data.success&&(this.unreadCount=o.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),o.data}catch(n){throw console.error("Error marking notification as read:",n),n}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",n=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(n);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const r=await ht.put(t,{},{baseURL:Lt,headers:{Authorization:`Bearer ${i}`}});return r.data&&r.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),r.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const n=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,i=await ht.delete(n,{baseURL:Lt,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(i.data.success)return i.data.data.unreadCount!==void 0&&(this.unreadCount=i.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),i.data;throw new Error("Failed to delete notification")}catch(n){throw console.error("Error deleting notification:",n),n}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",n=await ht.delete(t,{baseURL:Lt,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(n.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),n.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const Le=new Dd;var Qe=(s=>(s.NEW_LEAD="New Lead",s.FOLLOWUP_DUE="Follow-up Due",s.STATUS_CHANGE="Status Changed",s.ASSIGNMENT="Lead Assigned",s.NEW_BOOKING="NEW_BOOKING",s.BOOKING_CONFIRMED="BOOKING_CONFIRMED",s.BOOKING_CANCELLED="BOOKING_CANCELLED",s.PAYMENT_RECEIVED="PAYMENT_RECEIVED",s.INVOICE_GENERATED="INVOICE_GENERATED",s.EXHIBITION_UPDATE="EXHIBITION_UPDATE",s.SYSTEM_MESSAGE="SYSTEM_MESSAGE",s.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",s.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",s))(Qe||{}),is=(s=>(s.HIGH="HIGH",s.MEDIUM="MEDIUM",s.LOW="LOW",s))(is||{}),Nr=(s=>(s.READ="Read",s.UNREAD="Unread",s))(Nr||{}),Za={exports:{}};(function(s,t){(function(n,i){s.exports=i()})(Ll,function(){return function(n,i,r){n=n||{};var o=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function u(d,f,x,h){return o.fromToBase(d,f,x,h)}r.en.relativeTime=a,o.fromToBase=function(d,f,x,h,R){for(var S,j,k,v=x.$locale().relativeTime||a,T=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],A=T.length,c=0;c<A;c+=1){var p=T[c];p.d&&(S=h?r(d).diff(x,p.d,!0):x.diff(d,p.d,!0));var _=(n.rounding||Math.round)(Math.abs(S));if(k=S>0,_<=p.r||!p.r){_<=1&&c>0&&(p=T[c-1]);var N=v[p.l];R&&(_=R(""+_)),j=typeof N=="string"?N.replace("%d",_):N(_,f,p.l,k);break}}if(f)return j;var g=k?v.future:v.past;return typeof g=="function"?g(j):g.replace("%s",j)},o.to=function(d,f){return u(d,f,this,!0)},o.from=function(d,f){return u(d,f,this)};var y=function(d){return d.$u?r.utc():r()};o.toNow=function(d){return this.to(y(this),d)},o.fromNow=function(d){return this.from(y(this),d)}}})})(Za);var Ld=Za.exports;const $d=$l(Ld);Ae.extend($d);const Co=s=>{switch(s){case is.HIGH:return"#f5222d";case is.MEDIUM:return"#faad14";case is.LOW:return"#52c41a";default:return"#1677ff"}},Fd=s=>Ae(s).fromNow(),Bd=s=>Ae(s).format("YYYY-MM-DD HH:mm"),Md=s=>s.filter(t=>t.isRead===!1).length,zd=s=>{if(!s.entityId||!s.entityType)return"/notifications";switch(s.entityType){case"lead":return`/leads/${s.entityId}`;case"followup":return`/followups/${s.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${s.entityId}`;case"Exhibition":return`/exhibition/${s.entityId}`;case"Exhibitor":return`/exhibitors?id=${s.entityId}`;default:return"/notifications"}},{Text:Io,Paragraph:qd}=pe,el=({notification:s,onView:t,onMarkAsRead:n,onDelete:i})=>{const r=()=>{switch(s.type){case Qe.NEW_LEAD:return e.jsx(dn,{style:{color:"#1677ff"}});case Qe.FOLLOWUP_DUE:return e.jsx(et,{style:{color:"#faad14"}});case Qe.STATUS_CHANGE:return e.jsx(Fl,{style:{color:"#722ed1"}});case Qe.ASSIGNMENT:return e.jsx(Pe,{style:{color:"#52c41a"}});default:return e.jsx($r,{style:{color:"#1677ff"}})}},o=()=>{s.isRead||n(s),t(s)},a=u=>{u.stopPropagation(),i(s)};return e.jsx($t.Item,{onClick:o,className:s.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:s.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[e.jsx(_e,{title:"Delete notification",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(ot,{}),onClick:a,"aria-label":"Delete notification"})})],children:e.jsx($t.Item.Meta,{avatar:e.jsx(gt,{dot:!s.isRead,color:Co(s.priority),children:e.jsx(wt,{icon:r(),size:"large",style:{backgroundColor:"white",border:`1px solid ${Co(s.priority)}`}})}),title:e.jsxs(J,{children:[e.jsx(Io,{strong:!0,children:s.title}),!s.isRead&&e.jsx(le,{color:"blue",children:"New"})]}),description:e.jsxs("div",{children:[e.jsx(qd,{ellipsis:{rows:2},style:{marginBottom:4},children:s.message}),e.jsx(_e,{title:Bd(s.createdAt),children:e.jsx(Io,{type:"secondary",style:{fontSize:12},children:Fd(s.createdAt)})})]})})})},{Title:Od,Text:rg}=pe,Ud=s=>{switch(s){case"NEW_BOOKING":return Qe.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return Qe.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return Qe.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return Qe.NEW_LEAD;default:return Qe.STATUS_CHANGE}},Vd=s=>{switch(s){case"HIGH":return is.HIGH;case"MEDIUM":return is.MEDIUM;case"LOW":return is.LOW;default:return is.MEDIUM}},Hd=({isExhibitor:s=!1})=>{const t=Ie(),[n,i]=l.useState([]),[r,o]=l.useState(!1),[a,u]=l.useState(!1),[y,d]=l.useState(0),[f,x]=l.useState(!1),[h,R]=l.useState("all"),S=l.useRef(null),{isAuthenticated:j,user:k}=ge(w=>w.auth),{isAuthenticated:v}=ge(w=>w.exhibitorAuth||{isAuthenticated:!1}),T=s?v:j,[A,c]=l.useState(!1);l.useEffect(()=>{if(T){const w=s?"exhibitor_token":"token",D=localStorage.getItem(w);if(D){Le.init(D,s),Le.subscribeToNotifications();const M=Y=>{d(Y),Y>0&&!a&&(x(!0),setTimeout(()=>{x(!1)},2e3))},V=Y=>{i(Z=>[Y,...Z])},U=()=>{c(!0),p()},H=()=>{c(!1)};return Le.addEventListener("unreadCount",M),Le.addEventListener("notification",V),Le.addEventListener("connected",U),Le.addEventListener("disconnected",H),p(),()=>{Le.removeEventListener("unreadCount",M),Le.removeEventListener("notification",V),Le.removeEventListener("connected",U),Le.removeEventListener("disconnected",H),Le.unsubscribeFromNotifications()}}else console.error(`No ${s?"exhibitor":"admin"} token found in localStorage`)}},[T,s]);const p=async()=>{if(T){o(!0);try{const w=await Le.getNotifications(1,10);w.success&&(i(w.data.notifications),d(w.data.unreadCount))}catch(w){console.error("Error fetching notifications:",w)}finally{o(!1)}}},_=w=>{u(w),w&&(S.current&&S.current.classList.remove("bell-animate"),p())},N=async w=>{if(w.isRead||await g(w),u(!1),w.entityId&&w.entityType){let D="";switch(w.entityType){case"Booking":D=s?`/exhibitor/bookings/${w.entityId}`:"/bookings";break;case"Invoice":D=s?`/exhibitor/invoice/${w.entityId}`:`/invoice/${w.entityId}`;break;case"Exhibition":D=`/exhibition/${w.entityId}`;break;case"Exhibitor":D=`/exhibitors?id=${w.entityId}`;break;default:D=""}t(D||"/notifications")}else t("/notifications")},g=async w=>{try{await Le.markAsRead(w._id),i(n.map(D=>D._id===w._id?{...D,isRead:!0}:D))}catch(D){console.error("Error marking notification as read:",D)}},$=async w=>{try{await Le.deleteNotification(w._id),i(n.filter(D=>D._id!==w._id)),w.isRead||d(D=>Math.max(0,D-1))}catch(D){console.error("Error deleting notification:",D)}},b=()=>{u(!1),t("/notifications")},C=async()=>{try{await Le.markAllAsRead(),i(n.map(w=>({...w,isRead:!0}))),d(0)}catch(w){console.error("Error marking all notifications as read:",w)}},E=async()=>{try{await Le.deleteAllNotifications(),i([]),d(0)}catch(w){console.error("Error deleting all notifications:",w)}},P=()=>h==="unread"?n.filter(w=>!w.isRead):n.slice(0,10),m=w=>{R(w)},B=w=>{var D;return{_id:w._id,recipient:w.recipient,recipientType:w.recipientType||"admin",title:w.title,message:w.message,type:Ud(w.type),priority:Vd(w.priority),isRead:w.isRead,readAt:w.readAt,entityId:w.entityId,entityType:w.entityType,data:w.data,createdAt:w.createdAt,updatedAt:w.updatedAt||w.createdAt,id:w._id,userId:w.recipient,source:(D=w.data)==null?void 0:D.source,status:w.isRead?Nr.READ:Nr.UNREAD}},I=e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx(Od,{level:5,style:{margin:0},children:"Notifications"}),e.jsxs(J,{children:[e.jsx(O,{type:"text",size:"small",icon:e.jsx(yn,{}),onClick:p,loading:r,className:"header-btn",title:"Refresh notifications"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(Fr,{}),onClick:C,disabled:y===0,className:"header-btn",title:"Mark all as read"}),e.jsx(O,{type:"text",size:"small",danger:!0,icon:e.jsx(ot,{}),onClick:E,disabled:n.length===0,className:"header-btn",title:"Clear all notifications"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(gi,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(Nt,{}),onClick:()=>u(!1),className:"header-btn",title:"Close"})]})]}),e.jsx(at,{activeKey:h,onChange:m,size:"small",className:"notification-tabs",items:[{key:"all",label:e.jsx("span",{children:"All"})},{key:"unread",label:e.jsxs("span",{className:"tab-label",children:["Unread",e.jsx(gt,{count:y,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),e.jsx("div",{className:"notification-list",children:e.jsx(Pt,{spinning:r,children:P().length===0?e.jsx(Ve,{image:Ve.PRESENTED_IMAGE_SIMPLE,description:h==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):e.jsx($t,{dataSource:P(),renderItem:w=>e.jsx(el,{notification:B(w),onView:()=>N(w),onMarkAsRead:()=>g(w),onDelete:$})})})}),e.jsx(Te,{style:{margin:"0"}}),e.jsx("div",{className:"notification-footer",children:e.jsx(O,{type:"link",onClick:b,children:"View All Notifications"})})]});return e.jsx("div",{ref:S,className:`bell-container ${f?"bell-animate":""}`,children:e.jsx(vs,{overlay:I,trigger:["click"],open:a,onOpenChange:_,placement:"bottomRight",getPopupContainer:w=>w.parentNode,overlayClassName:"notification-dropdown-overlay",children:e.jsx(gt,{count:y,offset:[-2,10],size:"small",children:e.jsx($r,{className:"notification-bell-icon"})})})})};class Wd{async getSettings(){return(await ne.get("/settings")).data}async updateSettings(t){return(await ne.put("/settings",t)).data}async uploadLogo(t){const n=new FormData;return n.append("file",t),(await ne.post("/settings/upload/logo",n,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Zr=new Wd,Yd={settings:null,loading:!1,error:null},rn=Ce("settings/fetchSettings",async(s,{rejectWithValue:t})=>{var n,i;try{return await Zr.getSettings()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch settings")}}),on=Ce("settings/updateSettings",async(s,{rejectWithValue:t})=>{var n,i;try{return await Zr.updateSettings(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to update settings")}}),Zn=Ce("settings/uploadLogo",async(s,{dispatch:t,rejectWithValue:n})=>{var i,r;try{const o=await Zr.uploadLogo(s);return o.path&&await t(on({logo:o.path})),o}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to upload logo")}}),Qd=dt({name:"settings",initialState:Yd,reducers:{},extraReducers:s=>{s.addCase(rn.pending,t=>{t.loading=!0,t.error=null}).addCase(rn.fulfilled,(t,n)=>{t.settings=n.payload,t.loading=!1}).addCase(rn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(on.pending,t=>{t.loading=!0,t.error=null}).addCase(on.fulfilled,(t,n)=>{t.settings=n.payload,t.loading=!1}).addCase(on.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Zn.pending,t=>{t.loading=!0,t.error=null}).addCase(Zn.fulfilled,t=>{t.loading=!1}).addCase(Zn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),Gd=Qd.reducer,Kd=()=>{const{user:s}=ge(n=>n.auth),t=n=>{if(!s||!s.role||!s.role.permissions)return!1;const i=s.role.permissions;if(i.includes(n)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access")||i.includes("manage_all"))return!0;const r=n.split("_");if(r.length===2){const o=r[0],a=r[1],u=[`${o}.*`,`*.${a}`,`view_${o}`,`${o}_view`,`${o}s_${a}`,`${a}_${o}`,`${o}`,`${a}`,o.endsWith("s")?`${o.slice(0,-1)}_${a}`:`${o}s_${a}`,`${o}_${a==="view"?"read":a}`,`${a==="view"?"read":a}_${o}`];for(const y of u)if(i.includes(y))return!0}return!1};return{hasPermission:t,hasAnyPermission:n=>n.some(i=>t(i)),hasAllPermissions:n=>n.every(i=>t(i))}},{Header:Xd,Sider:Jd,Content:Zd}=qe,eu=te.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,tu=te.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,su=te.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;te.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const Oe=({children:s})=>{const[t,n]=l.useState(!1),i=Ie(),r=Re(),o=Zt(),a=ge(p=>p.auth.user),{settings:u}=ge(p=>p.settings),[y,d]=l.useState("/logo.png"),[f,x]=l.useState(!1),{hasPermission:h}=Kd(),R=l.useCallback(async()=>{try{x(!0),await r(Yn()).unwrap()}catch{}finally{x(!1)}},[r]);l.useEffect(()=>{const p=setInterval(()=>{R()},3e5);return()=>clearInterval(p)},[R]),l.useEffect(()=>{R()},[o.pathname,R]),l.useEffect(()=>{},[a,h]),l.useEffect(()=>{r(rn())},[r]);const S=[{key:"dashboard",icon:e.jsx(yi,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>i("/dashboard")},{key:"exhibition",icon:e.jsx(Br,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>i("/exhibition")},{key:"stalls",icon:e.jsx(ut,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>i("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>i("/stall-types")}]},{key:"bookings",icon:e.jsx(Be,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>i("/bookings")},{key:"invoices",icon:e.jsx(Jt,{}),label:"Invoices",requiredPermission:"view_invoices",onClick:()=>i("/invoices")},{key:"exhibitors",icon:e.jsx(Mr,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>i("/exhibitors")},{key:"index",icon:e.jsx(Pe,{}),label:"Users",requiredPermission:"users_view",onClick:()=>i("/index")},{key:"roles",icon:e.jsx(Bl,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>i("/roles")},{key:"settings",icon:e.jsx(gi,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>i("/settings")}],j=p=>p.filter(_=>{if(_.requiredPermission&&!h(_.requiredPermission))return!1;if(_.children){const N=j(_.children);if(N.length===0)return!1;_.children=N}return!0}),k=j(S),v=p=>p.map(_=>{const{requiredPermission:N,...g}=_;return g.children&&(g.children=v(g.children)),g}),T=v(k);l.useEffect(()=>{const p={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",invoices:"view_invoices",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},_=o.pathname.substring(1)||"dashboard",N=p[_];if(N&&!h(N)){const g=k.length>0?k[0]:null;g?i(`/${g.key}`):(r(bo()),i("/login"))}},[o.pathname,h,k,i,r]),l.useEffect(()=>{const p=localStorage.getItem("cachedLogoUrl"),_=localStorage.getItem("logoTimestamp"),N=new Date().getTime();if(p&&_&&N-parseInt(_)<36e5)d(p);else if(u!=null&&u.logo){const g=`${ne.defaults.baseURL}/public/logo`;d(g),localStorage.setItem("cachedLogoUrl",g),localStorage.setItem("logoTimestamp",N.toString());const $=new Image;$.src=g}},[u]);const A=[{key:"profile",label:"Profile",icon:e.jsx(Pe,{}),onClick:()=>i("/account")},{key:"settings",label:"Settings",icon:e.jsx(gi,{}),onClick:()=>i("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(fi,{}),onClick:()=>{r(bo()),i("/login")}}],c=()=>{const p=o.pathname.substring(1);return p.charAt(0).toUpperCase()+p.slice(1)};return e.jsxs(qe,{style:{minHeight:"100vh"},children:[e.jsxs(Jd,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsx(eu,{children:e.jsx(tu,{children:e.jsx(su,{src:y,alt:"Logo",onError:()=>d("/logo.png")})})}),e.jsx(jt,{mode:"inline",selectedKeys:[o.pathname.substring(1)||"dashboard"],items:T,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),e.jsxs(qe,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[e.jsxs(Xd,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(O,{type:"text",icon:t?e.jsx(wa,{}):e.jsx(Sa,{}),onClick:()=>n(!t),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:c()})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{marginRight:20},children:e.jsx(Hd,{isExhibitor:!1})}),e.jsx(vs,{menu:{items:A},placement:"bottomRight",children:e.jsxs(J,{align:"center",style:{cursor:"pointer"},children:[e.jsx(wt,{size:"small",icon:e.jsx(Pe,{}),style:{backgroundColor:"#5046e5"}}),e.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(a==null?void 0:a.username)||"User"})]})})]})]}),e.jsx(Zd,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:s})]})]})},Eo=localStorage.getItem("exhibitor_token"),nu=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,iu={isAuthenticated:!!Eo,exhibitor:nu,token:Eo,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},tl=dt({name:"exhibitorAuth",initialState:iu,reducers:{setExhibitorCredentials:(s,t)=>{s.exhibitor=t.payload.exhibitor,s.token=t.payload.token,s.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:s=>{s.exhibitor=null,s.token=null,s.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(s,t)=>{s.showLoginModal=!0,s.showForgotPasswordModal=!1,s.loginContext=t.payload||null},hideLoginModal:s=>{s.showLoginModal=!1,s.loginContext=null},showForgotPasswordModal:s=>{s.showForgotPasswordModal=!0,s.showLoginModal=!1},hideForgotPasswordModal:s=>{s.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:Pr,exhibitorLogout:sl,showLoginModal:js,hideLoginModal:In,showForgotPasswordModal:ru,hideForgotPasswordModal:Oi}=tl.actions,ou=tl.reducer,{Header:au,Sider:lu,Content:cu}=qe,ks=({children:s})=>{var x;const[t,n]=l.useState(!1),i=Ie(),r=Re(),o=Zt(),a=ge(h=>h.exhibitorAuth.exhibitor),u=()=>{const h=o.pathname;return h.includes("/exhibitor/dashboard")?"dashboard":h.includes("/exhibitor/bookings")?"bookings":h.includes("/exhibitor/profile")?"profile":h.includes("/exhibitions")?"exhibitions":h.includes("/exhibitor/support")?"help":"dashboard"},y=[{key:"dashboard",icon:e.jsx(yi,{}),label:"Dashboard",onClick:()=>i("/exhibitor/dashboard")},{key:"bookings",icon:e.jsx(ut,{}),label:"My Bookings",onClick:()=>i("/exhibitor/bookings")},{key:"profile",icon:e.jsx(Pe,{}),label:"My Profile",onClick:()=>i("/exhibitor/profile")},{key:"exhibitions",icon:e.jsx(Jt,{}),label:"Exhibitions",onClick:()=>i("/exhibitions")},{key:"help",icon:e.jsx(Ml,{}),label:"Help & Support",onClick:()=>i("/exhibitor/support")}],d=[{key:"profile",label:"My Profile",icon:e.jsx(Pe,{}),onClick:()=>i("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:e.jsx(ut,{}),onClick:()=>i("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(fi,{}),onClick:()=>{r(sl()),i("/")}}],f=()=>{const h=o.pathname.replace("/exhibitor/","");return h==="dashboard"?"Dashboard":h.startsWith("bookings")?h.includes("/")?"Booking Details":"My Bookings":h==="profile"?"My Profile":h==="support"?"Help & Support":h.charAt(0).toUpperCase()+h.slice(1)};return e.jsxs(qe,{style:{minHeight:"100vh"},children:[e.jsxs(lu,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[e.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&e.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),e.jsx(jt,{mode:"inline",selectedKeys:[u()],items:y,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),e.jsxs(qe,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[e.jsxs(au,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(O,{type:"text",icon:t?e.jsx(wa,{}):e.jsx(Sa,{}),onClick:()=>n(!t),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:f()})]}),e.jsx(vs,{menu:{items:d},placement:"bottomRight",children:e.jsxs(J,{align:"center",style:{cursor:"pointer"},children:[e.jsx(wt,{size:"small",style:{backgroundColor:"#5046e5"},children:((x=a==null?void 0:a.companyName)==null?void 0:x.charAt(0).toUpperCase())||"E"}),e.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(a==null?void 0:a.companyName)||"Exhibitor"})]})})]}),e.jsx(cu,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:s})]})]})},{Title:nl,Text:Gs,Paragraph:du}=pe,vn=ls`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,uu=ls`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,hu=ls`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,eo=ls`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,il=ls`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,pu=ls`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,mu=ls`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,xu=ls`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,gu=te.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,fu=te.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${uu} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,yu=te.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${s=>.1+s.index%3*.05}), transparent);
  left: ${s=>20+s.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${s=>s.isHovered?pu:mu} ${s=>1.5+s.index*.2}s ease-out;
  animation-delay: ${s=>s.index*.1}s;
  animation-fill-mode: forwards;
`,bu=te.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${hu} 0.8s ease-out forwards;
`,ju=te.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,vu=te.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${xu} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${eo} 2s ease-in-out infinite;
  }
`,wu=te.span`
  margin-left: 10px;
  animation: ${vn} 0.5s ease-out;
`,Su=te.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,ku=te.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,Cu=te.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${vn} 0.8s ease-out forwards;
`,Iu=te.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,Eu=te.img`
  width: 140px;
  height: auto;
  animation: ${il} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;te.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const Au=te.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${vn} 0.8s ease-out forwards;
`,Tu=te.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,Nu=te(nl)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,Pu=te(du)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,Ru=te.div`
  width: 100%;
  max-width: 400px;
  animation: ${vn} 0.6s ease-out;
`,_u=te(G)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Du=te(G.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Lu=te(O)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${eo} 0.5s ease-in-out;
  }
`,$u=te.div`
  margin-bottom: 2rem;
  text-align: center;
`,En=te(L.Item)`
  margin-bottom: 24px;
`,Fu=te.div`
  margin-top: 8px;
`,Bu=te.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,Mu=te(jr)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,zu=te.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${vn} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${eo} 0.5s ease-in-out;
  }
`,Ao=()=>e.jsxs(ju,{children:[e.jsxs(vu,{viewBox:"0 0 50 50",children:[e.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),e.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),e.jsx(wu,{children:"Signing in..."})]}),qu=te.div`
  position: absolute;
  width: ${s=>s.size}px;
  height: ${s=>s.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${il} ${s=>s.duration}s ease-in-out infinite;
  animation-delay: ${s=>s.delay}s;
  top: ${s=>s.top}%;
  left: ${s=>s.left}%;
  z-index: 1;
`,Ou=s=>{if(!s)return 0;const t=s.length>=8,n=/[A-Z]/.test(s),i=/[a-z]/.test(s),r=/\d/.test(s),o=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(s),a=[t,n,i,r,o];return a.filter(y=>y).length/a.length*100},Uu=s=>s<30?"#ff4d4f":s<60?"#faad14":s<80?"#1890ff":"#52c41a",Vu=s=>s<30?"Weak":s<60?"Fair":s<80?"Good":"Strong",Hu=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],Wu=()=>{const s=Ie(),t=Re(),[n,i]=l.useState(null),[r,o]=l.useState(!1),[a,u]=l.useState(!1),[y,d]=l.useState(""),[f,x]=l.useState(!1),h=ge(w=>w.auth.isAuthenticated),R=l.useRef(null),[S,j]=l.useState({x:0,y:0}),[k,v]=l.useState(!1),[T,A]=l.useState(!1),[c]=L.useForm(),[p,_]=l.useState("/logo.png"),[N,g]=l.useState("EXHIBITION MANAGER");l.useEffect(()=>{const w=localStorage.getItem("cachedLogoUrl"),D=localStorage.getItem("logoTimestamp"),M=new Date().getTime();if(w&&D&&M-parseInt(D)<36e5)_(w);else{const V=`${ne.defaults.baseURL}/public/logo`;_(V),localStorage.setItem("cachedLogoUrl",V),localStorage.setItem("logoTimestamp",M.toString());const U=new Image;U.src=V}fetch(`${ne.defaults.baseURL}/public/site-info`).then(V=>V.json()).then(V=>{V.siteName&&g(V.siteName)}).catch(V=>{console.error("Error fetching site info:",V)})},[]),l.useEffect(()=>{const w=localStorage.getItem("rememberedUser");if(w)try{const D=JSON.parse(w);c.setFieldsValue({username:D.username,password:D.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[c]),l.useEffect(()=>{const w=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(w)},[]),l.useEffect(()=>{h&&s("/dashboard")},[h,s]),l.useEffect(()=>{const w=D=>{if(R.current){const M=R.current.getBoundingClientRect(),V=D.clientX-M.left,U=D.clientY-M.top;V>=0&&V<=M.width&&U>=0&&U<=M.height&&j({x:V,y:U})}};return window.addEventListener("mousemove",w),()=>{window.removeEventListener("mousemove",w)}},[]);const $=async w=>{var D;try{i(null),o(!0);const M=await wi.login({username:w.username,password:w.password}),{user:V,token:U}=M.data;if(!V||!U)throw new Error("Invalid response from server");w.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:w.username,password:w.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),u(!0),setTimeout(()=>{t(Ma({user:V,token:U})),se.success("Login successful!"),s("/dashboard")},1200)}catch(M){console.error("Login Error:",M),console.error("Response Data:",(D=M.response)==null?void 0:D.data);let V="Authentication Error",U="Invalid username or password.";if(M.response&&typeof M.response=="object"){const{status:H,data:Y}=M.response;H===401?(V="Invalid Credentials",U="The username or password you entered is incorrect."):H===403?(V="Access Denied",U="You do not have permission to access this resource."):H===400?(V="Invalid Request",U="Please check your input and try again."):H===500&&(V="Server Error",U="A server error occurred. Please try again later."),Y&&typeof Y=="object"&&Y.message&&(U=Y.message)}else M.request?(V="Connection Error",U="Unable to connect to the server. Please check your internet connection."):M.message&&(U=M.message);i({title:V,message:U})}finally{o(!1)}},b=Ou(y),C=Uu(b),E=Vu(b),P=localStorage.getItem("rememberUser")==="true";if(h)return e.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[e.jsx(Ao,{}),e.jsx(Gs,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const m=w=>{const D=[];for(let M=0;M<w;M++){const V=Math.random()*20+8,U=Math.random()*3,H=Math.random()*10+6,Y=Math.random()*100,Z=Math.random()*100;D.push(e.jsx(qu,{size:V,delay:U,duration:H,top:Y,left:Z,style:{transform:`translate(${S.x/50*(M%5-2)}px, ${S.y/50*(M%5-2)}px)`,opacity:T?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},M))}return D},B=w=>{const D=[];for(let M=0;M<w;M++)D.push(e.jsx(yu,{index:M,isHovered:T},M));return D},I=w=>{A(w)};return e.jsxs(gu,{style:{opacity:k?1:0,transition:"opacity 0.3s ease-out"},children:[a&&e.jsx(zu,{children:e.jsx(zr,{})}),e.jsxs(fu,{onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),children:[e.jsx(Cu,{children:e.jsx(Iu,{children:e.jsx(Eu,{src:p,alt:"Exhibition Manager Logo",onError:()=>_("/logo.png")})})}),e.jsxs(Su,{ref:R,children:[m(12),B(8)]}),e.jsxs(ku,{children:[e.jsx(Au,{children:e.jsx(Tu,{children:N})}),e.jsx(Nu,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),e.jsx(Pu,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),e.jsx(bu,{children:e.jsxs(Ru,{children:[e.jsxs($u,{children:[e.jsx(nl,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),e.jsx(Gs,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),n&&e.jsx(He,{message:n.title,description:n.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:e.jsx(O,{size:"small",type:"text",onClick:()=>i(null),children:"Dismiss"})}),e.jsxs(L,{form:c,name:"login",initialValues:{remember:P},onFinish:$,layout:"vertical",children:[e.jsx(En,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:e.jsx(_u,{prefix:e.jsx(Pe,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:r,autoComplete:"username"})}),e.jsx(En,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:f&&e.jsxs(Fu,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx(Gs,{type:"secondary",children:"Password Strength:"}),e.jsx(Gs,{strong:!0,style:{color:C},children:E})]}),e.jsx(Tt,{percent:b,showInfo:!1,strokeColor:C,size:"small"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(_e,{title:e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Hu.map((w,D)=>e.jsx("li",{children:w},D))}),children:e.jsxs(Gs,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[e.jsx(Rt,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:e.jsx(Du,{prefix:e.jsx(Kt,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:r,autoComplete:"current-password",onChange:w=>d(w.target.value),onFocus:()=>x(!0),onBlur:()=>x(!1)})}),e.jsx(Bu,{children:e.jsx(En,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(Mu,{children:"Remember me"})})}),e.jsx(En,{children:r?e.jsx(Ao,{}):e.jsx(Lu,{type:"primary",htmlType:"submit",block:!0,className:a?"success":"",children:"Sign in"})})]})]})})]})},rl={getDashboardStats:async()=>{try{const t=(await ne.get("/users")).data||[],i=(await ne.get("/bookings")).data||[],o=(await ne.get("/exhibitions")).data||[],a=i.filter(d=>d.status==="confirmed"||d.status==="approved").reduce((d,f)=>d+(f.amount||0),0),u=[...i].sort((d,f)=>new Date(f.createdAt).getTime()-new Date(d.createdAt).getTime()).slice(0,5),y=[...t].sort((d,f)=>new Date(f.createdAt||0).getTime()-new Date(d.createdAt||0).getTime()).slice(0,5);return{userCount:t.length,bookingCount:i.length,totalRevenue:a,exhibitionCount:o.length,recentBookings:u,recentUsers:y}}catch(s){return console.error("Error fetching dashboard stats:",s),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:s,recentUsers:t}=await rl.getDashboardStats();return[...s.map(i=>({id:i._id,type:"booking",title:`New booking ${i._id.substring(0,8)}`,timestamp:i.createdAt,data:i})),...t.map(i=>({id:i._id,type:"user",title:`User ${i.username||"unknown"}`,timestamp:i.createdAt,data:i}))].sort((i,r)=>new Date(r.timestamp).getTime()-new Date(i.timestamp).getTime())}catch(s){return console.error("Error fetching recent activities:",s),[]}}},{Title:Yu,Text:it}=pe,Qu=({title:s,value:t,icon:n,color:i,gradient:r,loading:o})=>e.jsxs(K,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:r,border:"none",overflow:"hidden",position:"relative"},children:[e.jsx("div",{className:"stat-card-background"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx(it,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:s}),e.jsx(it,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:o?e.jsx(Pt,{size:"small"}):t})]}),e.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:n})]})]}),Gu=()=>{const[s,t]=l.useState(!0),[n,i]=l.useState(0),[r,o]=l.useState(0),[a,u]=l.useState(0),[y,d]=l.useState(0),[f,x]=l.useState([]),[h,R]=l.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});l.useEffect(()=>{(async()=>{t(!0);try{const k=await rl.getDashboardStats();i(k.userCount),o(k.bookingCount),u(k.totalRevenue),d(k.exhibitionCount);const v=[];k.recentBookings.slice(0,3).forEach(T=>{v.push({id:T._id,icon:e.jsx(vr,{}),color:"#2563EB",text:e.jsxs(it,{children:["New booking ",e.jsxs(it,{strong:!0,children:["#",T._id.substring(0,8)]})," received"]}),timestamp:new Date(T.createdAt).toLocaleString()})}),k.recentUsers.slice(0,2).forEach(T=>{v.push({id:T._id,icon:e.jsx(Pe,{}),color:"#7C3AED",text:e.jsxs(it,{children:["User ",e.jsxs(it,{strong:!0,children:["'",T.username,"'"]})," ",T.createdAt?"registered":"active"]}),timestamp:T.createdAt?new Date(T.createdAt).toLocaleString():"Recently"})}),v.sort((T,A)=>new Date(A.timestamp).getTime()-new Date(T.timestamp).getTime()),x(v)}catch(k){console.error("Error fetching dashboard data:",k)}finally{t(!1)}})()},[]);const S=[{title:"Total Users",value:n,icon:e.jsx(Pe,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:r,icon:e.jsx(vr,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`${a.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:e.jsx(bi,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:y,icon:e.jsx(zl,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(Yu,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),e.jsx(ie,{gutter:[24,24],children:S.map((j,k)=>e.jsx(F,{xs:24,sm:12,lg:6,children:e.jsx(Qu,{...j,loading:s})},k))}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(F,{xs:24,lg:12,children:e.jsx(K,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:s,children:f.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:f.map(j=>e.jsxs("div",{className:"activity-item",children:[De.cloneElement(j.icon,{style:{color:j.color}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[j.text,e.jsx(it,{type:"secondary",style:{fontSize:"12px"},children:j.timestamp})]})]},j.id))}):e.jsx(it,{type:"secondary",children:"No recent activity found"})})}),e.jsx(F,{xs:24,lg:12,children:e.jsx(K,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator online"}),e.jsxs(it,{children:["Server Status: ",e.jsx(it,{strong:!0,type:"success",children:h.server})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator connected"}),e.jsxs(it,{children:["Database Status: ",e.jsx(it,{strong:!0,type:"success",children:h.database})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator backup"}),e.jsxs(it,{children:["Last Backup: ",e.jsx(it,{strong:!0,children:h.lastBackup})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator normal"}),e.jsxs(it,{children:["System Load: ",e.jsx(it,{strong:!0,children:h.systemLoad})]})]})]})})})]})]})},mt={getExhibitions:()=>ds.get("/public/exhibitions"),getExhibition:s=>ds.get(`/public/exhibitions/${s}`),getLayout:s=>ds.get(`/public/exhibitions/${s}/layout`),getStallDetails:(s,t)=>ds.get(`/public/exhibitions/${s}/stalls/${t}`),bookStall:(s,t,n)=>ds.post(`/public/exhibitions/${s}/stalls/${t}/book`,n),bookMultipleStalls:(s,t)=>ds.post(`/public/exhibitions/${s}/stalls/book-multiple`,t),searchExhibitors:s=>ds.get("/public/exhibitors/search",{params:{query:s}}),exhibitorBookStalls:s=>ne.post(`/exhibitor-bookings/${s.exhibitionId}`,s),getExhibitorBookings:()=>ne.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:s=>ne.get(`/exhibitor-bookings/${s}`),cancelExhibitorBooking:s=>ne.patch(`/exhibitor-bookings/${s}/cancel`),getExhibitorBookingInvoice:s=>ne.get(`/exhibitor-bookings/${s}/invoice`)},{Title:Ku,Text:Wt,Paragraph:og}=pe,Xu=()=>{const[s,t]=l.useState([]),[n,i]=l.useState(!0),[r,o]=l.useState(null),[a,u]=l.useState([]),[y,d]=l.useState(!0),f=ge(c=>c.exhibitorAuth.exhibitor),x=Ie();l.useEffect(()=>{h(),R()},[]);const h=async()=>{try{i(!0),o(null);const c=await mt.getExhibitorBookings();t(c.data||[])}catch(c){console.error("Failed to fetch bookings:",c),o("Unable to load your bookings at this time. Please try again later.")}finally{i(!1)}},R=async()=>{try{d(!0);const c=await mt.getExhibitions(),p=Ae(),_=(c.data||[]).filter(N=>N.isActive&&Ae(N.endDate).isAfter(p)).slice(0,3);u(_)}catch(c){console.error("Failed to fetch upcoming exhibitions:",c)}finally{d(!1)}},S=s.filter(c=>c.status==="approved").length,j=s.filter(c=>c.status==="pending").length;s.filter(c=>c.status==="rejected").length;const k=s.filter(c=>c.status==="confirmed").length,v=c=>{switch(c){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Be,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(et,{})," Pending"]});case"rejected":return e.jsxs(le,{color:"error",children:[e.jsx(Nt,{})," Rejected"]});case"confirmed":return e.jsxs(le,{color:"blue",children:[e.jsx(Be,{})," Confirmed"]});case"cancelled":return e.jsxs(le,{color:"default",children:[e.jsx(Nt,{})," Cancelled"]});default:return e.jsx(le,{children:"Unknown"})}},T=c=>{x(`/exhibitor/invoice/${c}`)},A=(c,p)=>c.status===p;return e.jsxs("div",{children:[e.jsxs(Ku,{level:2,children:["Welcome, ",(f==null?void 0:f.companyName)||"Exhibitor"]}),e.jsx(Wt,{type:"secondary",children:"Here's an overview of your exhibition activities"}),r&&e.jsx(He,{message:"Error",description:r,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),j>0&&e.jsx(He,{message:"Pending Approvals",description:`You have ${j} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(O,{size:"small",type:"primary",onClick:()=>x("/exhibitor/bookings"),children:"View Bookings"})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:24},children:[e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Total Bookings",value:n?"-":s.length,prefix:e.jsx(ut,{}),loading:n})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Confirmed",value:n?"-":k,valueStyle:{color:"#1890ff"},prefix:e.jsx(Be,{}),loading:n})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Approved",value:n?"-":S,valueStyle:{color:"#3f8600"},prefix:e.jsx(Be,{}),loading:n})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Pending",value:n?"-":j,valueStyle:{color:"#faad14"},prefix:e.jsx(et,{}),loading:n})})})]}),e.jsx(K,{title:"Recent Bookings",extra:e.jsx(pt,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:n,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:3}}):s.length>0?e.jsx($t,{dataSource:s.slice(0,5),renderItem:c=>{var p,_,N,g,$;return e.jsxs($t.Item,{actions:[e.jsx(O,{type:"link",onClick:()=>x(`/exhibitor/bookings/${c._id}`),children:"View Details"},"view"),A(c,"approved")||A(c,"confirmed")?e.jsx(O,{type:"link",icon:e.jsx(ka,{}),onClick:()=>T(c._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[e.jsx($t.Item.Meta,{title:e.jsxs("div",{children:[e.jsx(Wt,{strong:!0,children:((p=c.exhibitionId)==null?void 0:p.name)||"Exhibition"}),e.jsxs(Wt,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((_=c.stallIds)==null?void 0:_.map(b=>b.number).join(", "))||"N/A"]})]}),description:e.jsxs(J,{direction:"vertical",size:1,children:[e.jsxs("div",{children:[e.jsxs(Wt,{children:["Booked on: ",Ae(c.createdAt).format("MMM D, YYYY")]}),e.jsx(Te,{type:"vertical"}),e.jsxs(Wt,{children:["Amount: ",((N=c.amount)==null?void 0:N.toLocaleString())||"N/A"]})]}),e.jsx("div",{children:e.jsxs(Wt,{children:["Exhibition date: ",Ae((g=c.exhibitionId)==null?void 0:g.startDate).format("MMM D")," - ",Ae(($=c.exhibitionId)==null?void 0:$.endDate).format("MMM D, YYYY")]})})]})}),v(c.status)]})}}):e.jsx(Ve,{description:"No bookings found",image:Ve.PRESENTED_IMAGE_SIMPLE})}),e.jsx(K,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:y,extra:e.jsx(pt,{to:"/exhibitions",children:"View All"}),children:y?e.jsx(Ft,{active:!0,paragraph:{rows:3}}):a.length>0?e.jsx($t,{dataSource:a,renderItem:c=>e.jsx($t.Item,{actions:[e.jsx(O,{type:"primary",onClick:()=>x(`/exhibitions/${c._id}/layout`),children:"Book Stall"},"book")],children:e.jsx($t.Item.Meta,{title:c.name,description:e.jsxs(J,{direction:"vertical",size:1,children:[e.jsx(Wt,{children:c.venue}),e.jsxs(Wt,{type:"secondary",children:[Ae(c.startDate).format("MMM D")," - ",Ae(c.endDate).format("MMM D, YYYY")]})]})})})}):e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(Jt,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs("div",{children:[e.jsx(Wt,{children:"No upcoming exhibitions at the moment"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(pt,{to:"/exhibitions",children:e.jsx(O,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),e.jsx(ie,{gutter:[24,24],style:{marginTop:24},children:e.jsx(F,{span:24,children:e.jsx(K,{title:"Quick Actions",children:e.jsxs(ie,{gutter:[16,16],children:[e.jsx(F,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{type:"primary",icon:e.jsx(ut,{}),block:!0,onClick:()=>x("/exhibitions"),children:"Book New Stall"})}),e.jsx(F,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(Jt,{}),block:!0,onClick:()=>x("/exhibitor/bookings"),children:"View All Bookings"})}),e.jsx(F,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(bi,{}),block:!0,onClick:()=>x("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),e.jsx(F,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(Pe,{}),block:!0,onClick:()=>x("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},{Title:Ju,Text:ts}=pe,{Option:ag}=de,{TabPane:Cs}=at,{confirm:Zu}=je,{Search:eh}=G,th=()=>{const[s,t]=l.useState([]),[n,i]=l.useState(!0),[r,o]=l.useState(null),[a,u]=l.useState(""),[y,d]=l.useState("all"),f=Ie(),x=Zt();l.useEffect(()=>{h()},[]),l.useEffect(()=>{const C=new URLSearchParams(x.search).get("status");C&&d(C)},[x]);const h=async()=>{try{i(!0),o(null);const b=await mt.getExhibitorBookings();t(b.data||[])}catch(b){console.error("Error fetching bookings:",b),o("Failed to load bookings. Please try again.")}finally{i(!1)}},R=b=>{Zu({title:"Are you sure you want to cancel this booking?",icon:e.jsx(qs,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await mt.cancelExhibitorBooking(b),se.success("Booking cancelled successfully"),h()}catch(C){console.error("Error cancelling booking:",C),se.error("Failed to cancel booking")}}})},S=b=>{switch(b){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Be,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(et,{})," Pending"]});case"rejected":return e.jsxs(le,{color:"error",children:[e.jsx(Nt,{})," Rejected"]});case"confirmed":return e.jsxs(le,{color:"blue",children:[e.jsx(Be,{})," Confirmed"]});case"cancelled":return e.jsxs(le,{color:"default",children:[e.jsx(Nt,{})," Cancelled"]});default:return e.jsx(le,{children:"Unknown"})}},j=b=>{switch(b){case"paid":return e.jsxs(le,{color:"success",children:[e.jsx(bi,{})," Paid"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(et,{})," Pending"]});case"refunded":return e.jsxs(le,{color:"default",children:[e.jsx(bi,{})," Refunded"]});default:return e.jsx(le,{children:"Unknown"})}},k=async b=>{try{f(`/exhibitor/invoice/${b}`)}catch(C){console.error("Error navigating to invoice:",C),se.error("Failed to access invoice. Please try again.")}},v=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(b,C)=>{var E,P;return e.jsxs(J,{direction:"vertical",size:0,children:[e.jsx(ts,{strong:!0,children:((E=C.exhibitionId)==null?void 0:E.name)||"N/A"}),e.jsx(ts,{type:"secondary",style:{fontSize:"12px"},children:((P=C.exhibitionId)==null?void 0:P.venue)||"N/A"})]})},sorter:(b,C)=>{var E,P;return(((E=b.exhibitionId)==null?void 0:E.name)||"").localeCompare(((P=C.exhibitionId)==null?void 0:P.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:b=>e.jsx(J,{direction:"vertical",size:4,children:(b==null?void 0:b.map(C=>e.jsx(le,{children:C.number},C._id)))||"N/A"})},{title:"Type",key:"stallType",render:(b,C)=>{var E;return e.jsx(J,{direction:"vertical",size:4,children:((E=C.stallIds)==null?void 0:E.map(P=>{var m;return(m=P.stallTypeId)!=null&&m.name?e.jsx(le,{color:"blue",children:P.stallTypeId.name},P._id):e.jsx(ts,{type:"secondary",children:"N/A"},P._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(b,C)=>{var E;return e.jsx(J,{direction:"vertical",size:4,children:((E=C.stallIds)==null?void 0:E.map(P=>e.jsxs(ts,{children:[P.dimensions.width,"m x ",P.dimensions.height,"m"]},P._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(b,C)=>{var E,P;return e.jsxs(J,{direction:"vertical",size:0,children:[e.jsxs(ts,{children:[e.jsx(Et,{style:{marginRight:4}}),Ae((E=C.exhibitionId)==null?void 0:E.startDate).format("MMM D")," - ",Ae((P=C.exhibitionId)==null?void 0:P.endDate).format("MMM D, YYYY")]}),e.jsxs(ts,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",Ae(C.createdAt).format("MMM D, YYYY")]})]})},sorter:(b,C)=>Ae(b.createdAt).unix()-Ae(C.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:b=>e.jsxs(ts,{strong:!0,children:["",b.toLocaleString()]}),sorter:(b,C)=>b.amount-C.amount},{title:"Status",key:"status",dataIndex:"status",render:(b,C)=>b==="rejected"&&C.rejectionReason?e.jsxs(_e,{title:C.rejectionReason,children:[S(b),e.jsx(Rt,{style:{marginLeft:4,color:"#ff4d4f"}})]}):S(b),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(b,C)=>C.status===b},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:b=>j(b),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(b,C)=>C.paymentStatus===b},{title:"Actions",key:"actions",render:(b,C)=>e.jsxs(J,{children:[e.jsx(O,{type:"link",icon:e.jsx(Xt,{}),onClick:()=>f(`/exhibitor/bookings/${C._id}`),children:"Details"}),(C.status==="approved"||C.status==="confirmed")&&e.jsx(O,{type:"link",icon:e.jsx(ka,{}),onClick:()=>k(C._id),children:"Invoice"}),C.status==="pending"&&e.jsx(O,{type:"link",danger:!0,onClick:()=>R(C._id),children:"Cancel"})]})}],T=b=>{u(b)},A=s.filter(b=>{var P,m;const C=(((P=b.exhibitionId)==null?void 0:P.name)||"").toLowerCase().includes(a.toLowerCase())||b.stallIds.some(B=>B.number.toLowerCase().includes(a.toLowerCase()))||(((m=b.exhibitionId)==null?void 0:m.venue)||"").toLowerCase().includes(a.toLowerCase())||(b.customerName||"").toLowerCase().includes(a.toLowerCase()),E=y==="all"||b.status===y;return C&&E}),c=()=>s.length,p=()=>s.filter(b=>b.status==="pending").length,_=()=>s.filter(b=>b.status==="approved").length,N=()=>s.filter(b=>b.status==="confirmed").length,g=()=>s.filter(b=>b.status==="rejected").length,$=()=>s.filter(b=>b.status==="cancelled").length;return e.jsxs("div",{children:[e.jsx(Ju,{level:2,children:"My Bookings"}),e.jsx(ts,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),r&&e.jsx(He,{message:"Error",description:r,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(O,{type:"primary",onClick:h,children:"Retry"})}),e.jsxs(K,{style:{marginTop:24},children:[e.jsxs(ie,{gutter:[16,16],style:{marginBottom:16},children:[e.jsx(F,{flex:"auto",children:e.jsx(eh,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:T,onChange:b=>u(b.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),e.jsx(F,{children:e.jsx(O,{icon:e.jsx(yn,{}),onClick:h,children:"Refresh"})})]}),e.jsxs(at,{defaultActiveKey:y,onChange:b=>d(b),children:[e.jsx(Cs,{tab:`All Bookings (${c()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):A.length>0?e.jsx(Ne,{columns:v,dataSource:A,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):e.jsx(Ve,{description:a?"No bookings match your search criteria":"No bookings found",image:Ve.PRESENTED_IMAGE_SIMPLE})},"all"),e.jsx(Cs,{tab:`Pending (${p()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):e.jsx(Ne,{columns:v,dataSource:s.filter(b=>b.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Ve,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),e.jsx(Cs,{tab:`Approved (${_()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):e.jsx(Ne,{columns:v,dataSource:s.filter(b=>b.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Ve,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),e.jsx(Cs,{tab:`Confirmed (${N()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):e.jsx(Ne,{columns:v,dataSource:s.filter(b=>b.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Ve,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),e.jsx(Cs,{tab:`Rejected (${g()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):e.jsx(Ne,{columns:v,dataSource:s.filter(b=>b.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Ve,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),e.jsx(Cs,{tab:`Cancelled (${$()})`,children:n?e.jsx(Ft,{active:!0,paragraph:{rows:5}}):e.jsx(Ne,{columns:v,dataSource:s.filter(b=>b.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Ve,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:To,Text:Ui}=pe,sh=()=>{var x,h,R,S,j,k,v,T,A,c,p,_,N;const{id:s}=ft(),t=Ie(),[n,i]=l.useState(null),[r,o]=l.useState(!0);l.useEffect(()=>{a()},[s]);const a=async()=>{try{o(!0);const g=await mt.getExhibitorBooking(s||"");i(g.data)}catch(g){console.error("Error fetching booking details:",g),se.error("Failed to load booking details")}finally{o(!1)}},u=async()=>{try{t(`/exhibitor/invoice/${s}`)}catch(g){console.error("Error fetching invoice:",g),se.error("Failed to retrieve invoice")}},y=g=>{switch(g){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Be,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(et,{})," Pending"]});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(le,{color:"blue",children:[e.jsx(Be,{})," Confirmed"]});case"cancelled":return e.jsx(le,{color:"default",children:"Cancelled"});default:return e.jsx(le,{children:"Unknown"})}},d=g=>{switch(g){case"paid":return e.jsx(le,{color:"success",children:"Paid"});case"pending":return e.jsx(le,{color:"warning",children:"Pending"});case"refunded":return e.jsx(le,{color:"default",children:"Refunded"});default:return e.jsx(le,{children:"Unknown"})}},f=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:g=>`${g.dimensions.width}m  ${g.dimensions.height}m`},{title:"Size",key:"size",render:g=>`${g.dimensions.width*g.dimensions.height} m`},{title:"Rate per m",dataIndex:"ratePerSqm",key:"ratePerSqm",render:g=>`${g.toLocaleString()}`},{title:"Amount",key:"amount",render:(g,$,b)=>{var E;const C=(E=n.calculations)==null?void 0:E.stalls[b];return C?`${C.baseAmount.toLocaleString()}`:"N/A"}}];return r?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(Pt,{size:"large"})}):n?e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(n.status)&&e.jsx(O,{type:"primary",icon:e.jsx(Jt,{}),onClick:u,children:"View Invoice"})]}),e.jsxs(K,{title:"Booking Details",style:{marginBottom:20},children:[e.jsxs(fe,{bordered:!0,column:{xs:1,sm:2,md:3},children:[e.jsx(fe.Item,{label:"Booking ID",children:n._id}),e.jsx(fe.Item,{label:"Exhibition",children:((x=n.exhibitionId)==null?void 0:x.name)||"N/A"}),e.jsx(fe.Item,{label:"Venue",children:((h=n.exhibitionId)==null?void 0:h.venue)||"N/A"}),e.jsx(fe.Item,{label:"Booking Date",children:Ae(n.createdAt).format("MMM D, YYYY")}),e.jsxs(fe.Item,{label:"Exhibition Dates",children:[Ae((R=n.exhibitionId)==null?void 0:R.startDate).format("MMM D, YYYY")," -",Ae((S=n.exhibitionId)==null?void 0:S.endDate).format("MMM D, YYYY")]}),e.jsx(fe.Item,{label:"Status",children:y(n.status)}),e.jsx(fe.Item,{label:"Payment Status",children:d(n.paymentStatus||"pending")}),e.jsxs(fe.Item,{label:"Total Amount",children:["",((j=n.amount)==null?void 0:j.toLocaleString())||"N/A"]})]}),n.rejectionReason&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(To,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),e.jsx(Ui,{children:n.rejectionReason})]})]}),e.jsx(K,{title:"Stall Details",style:{marginBottom:20},children:e.jsx(Ne,{dataSource:n.stallIds||[],columns:f,rowKey:"_id",pagination:!1})}),e.jsx(K,{title:"Calculation Summary",children:e.jsx(ie,{gutter:[16,16],children:e.jsx(F,{span:24,children:e.jsxs(fe,{bordered:!0,column:1,children:[e.jsxs(fe.Item,{label:"Base Amount",children:["",((k=n.calculations)==null?void 0:k.totalBaseAmount.toLocaleString())||"N/A"]}),((v=n.calculations)==null?void 0:v.totalDiscountAmount)>0&&e.jsxs(fe.Item,{label:"Discount",children:["- ",((T=n.calculations)==null?void 0:T.totalDiscountAmount.toLocaleString())||"N/A"]}),((A=n.calculations)==null?void 0:A.totalDiscountAmount)>0&&e.jsxs(fe.Item,{label:"Amount After Discount",children:["",((c=n.calculations)==null?void 0:c.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(_=(p=n.calculations)==null?void 0:p.taxes)==null?void 0:_.map(g=>e.jsxs(fe.Item,{label:`${g.name} (${g.rate}%)`,children:["+ ",g.amount.toLocaleString()||"N/A"]},g.name)),e.jsx(fe.Item,{label:"Total Amount",children:e.jsxs(Ui,{strong:!0,style:{fontSize:"16px"},children:["",((N=n.amount)==null?void 0:N.toLocaleString())||"N/A"]})})]})})})}),e.jsx(K,{title:"Customer Information",style:{marginTop:20},children:e.jsxs(fe,{bordered:!0,column:{xs:1,sm:2},children:[e.jsx(fe.Item,{label:"Company Name",children:n.companyName}),e.jsx(fe.Item,{label:"Contact Person",children:n.customerName}),e.jsx(fe.Item,{label:"Email",children:n.customerEmail}),e.jsx(fe.Item,{label:"Phone",children:n.customerPhone})]})})]}):e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[e.jsx(To,{level:3,children:"Booking Not Found"}),e.jsx(Ui,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),e.jsx("div",{style:{marginTop:20},children:e.jsx(O,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},Rr=ht.create({baseURL:Lt}),Is=ht.create({baseURL:Lt});Rr.interceptors.request.use(s=>{const t=localStorage.getItem("exhibitor_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));const ms=ht.create({baseURL:Lt});ms.interceptors.request.use(s=>{const t=localStorage.getItem("token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));const rt={sendRegistrationOTP:async s=>await Is.post("/exhibitors/send-otp",{email:s}),verifyOTP:async s=>await Is.post("/exhibitors/verify-otp",s),register:async s=>await Is.post("/exhibitors/register",s),login:async s=>await Is.post("/exhibitors/login",s),requestPasswordReset:async s=>await Is.post("/exhibitors/forgot-password",s),resetPassword:async s=>await Is.post("/exhibitors/reset-password",s),getProfile:async()=>await Rr.get("/exhibitors/profile"),updateProfile:async s=>await Rr.put("/exhibitors/profile",s),getExhibitors:async()=>await ms.get("/exhibitors/admin/exhibitors"),getExhibitor:async s=>await ms.get(`/exhibitors/admin/exhibitors/${s}`),createExhibitor:async s=>await ms.post("/exhibitors/admin/exhibitors",s),updateStatus:async(s,t,n)=>await ms.put(`/exhibitors/admin/exhibitors/${s}/status`,{status:t,rejectionReason:n}),updateExhibitor:async(s,t)=>await ms.put(`/exhibitors/admin/exhibitors/${s}`,t),deleteExhibitor:async s=>await ms.delete(`/exhibitors/admin/exhibitors/${s}`)},{Title:No,Text:Po}=pe,{TabPane:Ro}=at,nh=()=>{var y;const[s]=L.useForm(),[t,n]=l.useState(!1),[i,r]=l.useState(!1),o=Re(),a=ge(d=>d.exhibitorAuth.exhibitor);l.useEffect(()=>{(async()=>{try{r(!0);const f=await rt.getProfile();f.data&&o(Pr({exhibitor:f.data,token:(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||""}))}catch{se.error("Failed to fetch exhibitor profile")}finally{r(!1)}})()},[o]),l.useEffect(()=>{a&&s.setFieldsValue({companyName:a.companyName||"",contactPerson:a.contactPerson||"",email:a.email||"",phone:a.phone||"",address:a.address||"",website:a.website||"",description:a.description||"",panNumber:a.panNumber||"",gstNumber:a.gstNumber||"",city:a.city||"",state:a.state||"",pinCode:a.pinCode||""})},[a,s]);const u=async d=>{try{n(!0);const f=await rt.updateProfile(d),x=(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||"";o(Pr({exhibitor:{...a,...d},token:x})),se.success("Profile updated successfully")}catch{se.error("Failed to update profile")}finally{n(!1)}};return e.jsxs("div",{children:[e.jsx(No,{level:2,children:"My Profile"}),e.jsx(Po,{type:"secondary",children:"Manage your exhibitor profile information"}),e.jsx(K,{style:{marginTop:24},loading:i,children:e.jsxs(at,{defaultActiveKey:"profile",children:[e.jsx(Ro,{tab:"Profile Information",children:e.jsxs(ie,{gutter:32,children:[e.jsx(F,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(wt,{size:100,icon:e.jsx(Pe,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((y=a==null?void 0:a.companyName)==null?void 0:y.charAt(0).toUpperCase())||"E"}),e.jsx(No,{level:4,children:a==null?void 0:a.companyName}),e.jsx(Po,{type:"secondary",children:a==null?void 0:a.email})]})}),e.jsx(F,{span:18,children:e.jsxs(L,{form:s,layout:"vertical",onFinish:u,initialValues:{companyName:(a==null?void 0:a.companyName)||"",contactPerson:(a==null?void 0:a.contactPerson)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",address:(a==null?void 0:a.address)||"",website:(a==null?void 0:a.website)||"",description:(a==null?void 0:a.description)||"",panNumber:(a==null?void 0:a.panNumber)||"",gstNumber:(a==null?void 0:a.gstNumber)||"",city:(a==null?void 0:a.city)||"",state:(a==null?void 0:a.state)||"",pinCode:(a==null?void 0:a.pinCode)||""},children:[e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:e.jsx(G,{prefix:e.jsx(qr,{}),placeholder:"Company Name"})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:e.jsx(G,{prefix:e.jsx(Pe,{}),placeholder:"Contact Person"})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Ot,{}),placeholder:"Email",disabled:!0})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:e.jsx(G,{prefix:e.jsx(Or,{}),placeholder:"Phone Number"})})})]}),e.jsx(L.Item,{name:"address",label:"Address",children:e.jsx(G.TextArea,{rows:2,placeholder:"Company Address"})}),e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:8,children:e.jsx(L.Item,{name:"city",label:"City",children:e.jsx(G,{placeholder:"City"})})}),e.jsx(F,{span:8,children:e.jsx(L.Item,{name:"state",label:"State",children:e.jsx(G,{placeholder:"State"})})}),e.jsx(F,{span:8,children:e.jsx(L.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(G,{placeholder:"PIN Code",maxLength:6})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(G,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(G,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),e.jsx(L.Item,{name:"website",label:"Website",children:e.jsx(G,{placeholder:"https://www.yourcompany.com"})}),e.jsx(L.Item,{name:"description",label:"Company Description",children:e.jsx(G.TextArea,{rows:4,placeholder:"Brief description of your company"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",loading:t,icon:e.jsx(ws,{}),children:"Save Changes"})})]})})]})},"profile"),e.jsx(Ro,{tab:"Change Password",children:e.jsxs(L,{layout:"vertical",onFinish:d=>{se.success("Password updated successfully")},children:[e.jsx(L.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(G.Password,{placeholder:"Current Password"})}),e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:d})=>({validator(f,x){return!x||d("newPassword")===x?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{placeholder:"Confirm New Password"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var ih=class extends Error{constructor(t){super(t[0].message);ao(this,"issues");this.name="SchemaError",this.issues=t}},ol=(s=>(s.uninitialized="uninitialized",s.pending="pending",s.fulfilled="fulfilled",s.rejected="rejected",s))(ol||{});function _o(s){return{status:s,isUninitialized:s==="uninitialized",isLoading:s==="pending",isSuccess:s==="fulfilled",isError:s==="rejected"}}var Do=mn;function al(s,t){if(s===t||!(Do(s)&&Do(t)||Array.isArray(s)&&Array.isArray(t)))return t;const n=Object.keys(t),i=Object.keys(s);let r=n.length===i.length;const o=Array.isArray(t)?[]:{};for(const a of n)o[a]=al(s[a],t[a]),r&&(r=s[a]===o[a]);return r?s:o}function Fs(s){let t=0;for(const n in s)t++;return t}var Lo=s=>[].concat(...s);function rh(s){return new RegExp("(^|:)//").test(s)}function oh(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function Si(s){return s!=null}function ah(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var lh=s=>s.replace(/\/$/,""),ch=s=>s.replace(/^\//,"");function dh(s,t){if(!s)return t;if(!t)return s;if(rh(t))return t;const n=s.endsWith("/")||!t.startsWith("?")?"/":"";return s=lh(s),t=ch(t),`${s}${n}${t}`}function uh(s,t,n){return s.has(t)?s.get(t):s.set(t,n).get(t)}var $o=(...s)=>fetch(...s),hh=s=>s.status>=200&&s.status<=299,ph=s=>/ion\/(vnd\.api\+)?json/.test(s.get("content-type")||"");function Fo(s){if(!mn(s))return s;const t={...s};for(const[n,i]of Object.entries(t))i===void 0&&delete t[n];return t}function to({baseUrl:s,prepareHeaders:t=x=>x,fetchFn:n=$o,paramsSerializer:i,isJsonContentType:r=ph,jsonContentType:o="application/json",jsonReplacer:a,timeout:u,responseHandler:y,validateStatus:d,...f}={}){return typeof fetch>"u"&&n===$o&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(h,R,S)=>{const{getState:j,extra:k,endpoint:v,forced:T,type:A}=R;let c,{url:p,headers:_=new Headers(f.headers),params:N=void 0,responseHandler:g=y??"json",validateStatus:$=d??hh,timeout:b=u,...C}=typeof h=="string"?{url:h}:h,E,P=R.signal;b&&(E=new AbortController,R.signal.addEventListener("abort",E.abort),P=E.signal);let m={...f,signal:P,...C};_=new Headers(Fo(_)),m.headers=await t(_,{getState:j,arg:h,extra:k,endpoint:v,forced:T,type:A,extraOptions:S})||_;const B=Z=>typeof Z=="object"&&(mn(Z)||Array.isArray(Z)||typeof Z.toJSON=="function");if(!m.headers.has("content-type")&&B(m.body)&&m.headers.set("content-type",o),B(m.body)&&r(m.headers)&&(m.body=JSON.stringify(m.body,a)),N){const Z=~p.indexOf("?")?"&":"?",q=i?i(N):new URLSearchParams(Fo(N));p+=Z+q}p=dh(s,p);const I=new Request(p,m);c={request:new Request(p,m)};let D,M=!1,V=E&&setTimeout(()=>{M=!0,E.abort()},b);try{D=await n(I)}catch(Z){return{error:{status:M?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(Z)},meta:c}}finally{V&&clearTimeout(V),E==null||E.signal.removeEventListener("abort",E.abort)}const U=D.clone();c.response=U;let H,Y="";try{let Z;if(await Promise.all([x(D,g).then(q=>H=q,q=>Z=q),U.text().then(q=>Y=q,()=>{})]),Z)throw Z}catch(Z){return{error:{status:"PARSING_ERROR",originalStatus:D.status,data:Y,error:String(Z)},meta:c}}return $(D,H)?{data:H,meta:c}:{error:{status:D.status,data:H},meta:c}};async function x(h,R){if(typeof R=="function")return R(h);if(R==="content-type"&&(R=r(h.headers)?"json":"text"),R==="json"){const S=await h.text();return S.length?JSON.parse(S):null}return h.text()}}var Bo=class{constructor(s,t=void 0){this.value=s,this.meta=t}},so=Us("__rtkq/focused"),ll=Us("__rtkq/unfocused"),no=Us("__rtkq/online"),cl=Us("__rtkq/offline");function Ri(s){return s.type==="query"}function mh(s){return s.type==="mutation"}function _i(s){return s.type==="infinitequery"}function ki(s){return Ri(s)||_i(s)}function io(s,t,n,i,r,o){return xh(s)?s(t,n,i,r).filter(Si).map(_r).map(o):Array.isArray(s)?s.map(_r).map(o):[]}function xh(s){return typeof s=="function"}function _r(s){return typeof s=="string"?{type:s}:s}function gh(s,t){return s.catch(t)}var gn=Symbol("forceQueryFn"),Dr=s=>typeof s[gn]=="function";function fh({serializeQueryArgs:s,queryThunk:t,infiniteQueryThunk:n,mutationThunk:i,api:r,context:o}){const a=new Map,u=new Map,{unsubscribeQueryResult:y,removeMutationResult:d,updateSubscriptionOptions:f}=r.internalActions;return{buildInitiateQuery:k,buildInitiateInfiniteQuery:v,buildInitiateMutation:T,getRunningQueryThunk:x,getRunningMutationThunk:h,getRunningQueriesThunk:R,getRunningMutationsThunk:S};function x(A,c){return p=>{var g;const _=o.endpointDefinitions[A],N=s({queryArgs:c,endpointDefinition:_,endpointName:A});return(g=a.get(p))==null?void 0:g[N]}}function h(A,c){return p=>{var _;return(_=u.get(p))==null?void 0:_[c]}}function R(){return A=>Object.values(a.get(A)||{}).filter(Si)}function S(){return A=>Object.values(u.get(A)||{}).filter(Si)}function j(A,c){const p=(_,{subscribe:N=!0,forceRefetch:g,subscriptionOptions:$,[gn]:b,...C}={})=>(E,P)=>{var X;const m=s({queryArgs:_,endpointDefinition:c,endpointName:A});let B;const I={...C,type:"query",subscribe:N,forceRefetch:g,subscriptionOptions:$,endpointName:A,originalArgs:_,queryCacheKey:m,[gn]:b};if(Ri(c))B=t(I);else{const{direction:z,initialPageParam:ee}=C;B=n({...I,direction:z,initialPageParam:ee})}const w=r.endpoints[A].select(_),D=E(B),M=w(P()),{requestId:V,abort:U}=D,H=M.requestId!==V,Y=(X=a.get(E))==null?void 0:X[m],Z=()=>w(P()),q=Object.assign(b?D.then(Z):H&&!Y?Promise.resolve(M):Promise.all([Y,D]).then(Z),{arg:_,requestId:V,subscriptionOptions:$,queryCacheKey:m,abort:U,async unwrap(){const z=await q;if(z.isError)throw z.error;return z.data},refetch:()=>E(p(_,{subscribe:!1,forceRefetch:!0})),unsubscribe(){N&&E(y({queryCacheKey:m,requestId:V}))},updateSubscriptionOptions(z){q.subscriptionOptions=z,E(f({endpointName:A,requestId:V,queryCacheKey:m,options:z}))}});if(!Y&&!H&&!b){const z=uh(a,E,{});z[m]=q,q.then(()=>{delete z[m],Fs(z)||a.delete(E)})}return q};return p}function k(A,c){return j(A,c)}function v(A,c){return j(A,c)}function T(A){return(c,{track:p=!0,fixedCacheKey:_}={})=>(N,g)=>{const $=i({type:"mutation",endpointName:A,originalArgs:c,track:p,fixedCacheKey:_}),b=N($),{requestId:C,abort:E,unwrap:P}=b,m=gh(b.unwrap().then(D=>({data:D})),D=>({error:D})),B=()=>{N(d({requestId:C,fixedCacheKey:_}))},I=Object.assign(m,{arg:b.arg,requestId:C,abort:E,unwrap:P,reset:B}),w=u.get(N)||{};return u.set(N,w),w[C]=I,I.then(()=>{delete w[C],Fs(w)||u.delete(N)}),_&&(w[_]=I,I.then(()=>{w[_]===I&&(delete w[_],Fs(w)||u.delete(N))})),I}}}var dl=class extends ih{constructor(s,t,n,i){super(s),this.value=t,this.schemaName=n,this._bqMeta=i}};async function us(s,t,n,i){const r=await s["~standard"].validate(t);if(r.issues)throw new dl(r.issues,t,n,i);return r.value}function yh(s){return s}var Ks=(s={})=>({...s,[Ra]:!0});function bh({reducerPath:s,baseQuery:t,context:{endpointDefinitions:n},serializeQueryArgs:i,api:r,assertTagType:o,selectors:a,onSchemaFailure:u,catchSchemaFailure:y,skipSchemaValidation:d}){const f=(C,E,P,m)=>(B,I)=>{const w=n[C],D=i({queryArgs:E,endpointDefinition:w,endpointName:C});if(B(r.internalActions.queryResultPatched({queryCacheKey:D,patches:P})),!m)return;const M=r.endpoints[C].select(E)(I()),V=io(w.providesTags,M.data,void 0,E,{},o);B(r.internalActions.updateProvidedBy([{queryCacheKey:D,providedTags:V}]))};function x(C,E,P=0){const m=[E,...C];return P&&m.length>P?m.slice(0,-1):m}function h(C,E,P=0){const m=[...C,E];return P&&m.length>P?m.slice(1):m}const R=(C,E,P,m=!0)=>(B,I)=>{const D=r.endpoints[C].select(E)(I()),M={patches:[],inversePatches:[],undo:()=>B(r.util.patchQueryData(C,E,M.inversePatches,m))};if(D.status==="uninitialized")return M;let V;if("data"in D)if(gc(D.data)){const[U,H,Y]=Da(D.data,P);M.patches.push(...H),M.inversePatches.push(...Y),V=U}else V=P(D.data),M.patches.push({op:"replace",path:[],value:V}),M.inversePatches.push({op:"replace",path:[],value:D.data});return M.patches.length===0||B(r.util.patchQueryData(C,E,M.patches,m)),M},S=(C,E,P)=>m=>m(r.endpoints[C].initiate(E,{subscribe:!1,forceRefetch:!0,[gn]:()=>({data:P})})),j=(C,E)=>C.query&&C[E]?C[E]:yh,k=async(C,{signal:E,abort:P,rejectWithValue:m,fulfillWithValue:B,dispatch:I,getState:w,extra:D})=>{var H,Y;const M=n[C.endpointName],{metaSchema:V,skipSchemaValidation:U=d}=M;try{let Z=j(M,"transformResponse");const q={signal:E,abort:P,dispatch:I,getState:w,extra:D,endpoint:C.endpointName,type:C.type,forced:C.type==="query"?v(C,w()):void 0,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0},X=C.type==="query"?C[gn]:void 0;let z;const ee=async(ae,Q,re,be)=>{if(Q==null&&ae.pages.length)return Promise.resolve({data:ae});const W={queryArg:C.originalArgs,pageParam:Q},he=await ce(W),xe=be?x:h;return{data:{pages:xe(ae.pages,he.data,re),pageParams:xe(ae.pageParams,Q,re)},meta:he.meta}};async function ce(ae){let Q;const{extraOptions:re,argSchema:be,rawResponseSchema:W,responseSchema:he}=M;if(be&&!U&&(ae=await us(be,ae,"argSchema",{})),X?Q=X():M.query?Q=await t(M.query(ae),q,re):Q=await M.queryFn(ae,q,re,$e=>t($e,q,re)),typeof process<"u",Q.error)throw new Bo(Q.error,Q.meta);let{data:xe}=Q;W&&!U&&(xe=await us(W,Q.data,"rawResponseSchema",Q.meta));let we=await Z(xe,Q.meta,ae);return he&&!U&&(we=await us(he,we,"responseSchema",Q.meta)),{...Q,data:we}}if(C.type==="query"&&"infiniteQueryOptions"in M){const{infiniteQueryOptions:ae}=M,{maxPages:Q=1/0}=ae;let re;const be={pages:[],pageParams:[]},W=(H=a.selectQueryEntry(w(),C.queryCacheKey))==null?void 0:H.data,xe=v(C,w())&&!C.direction||!W?be:W;if("direction"in C&&C.direction&&xe.pages.length){const we=C.direction==="backward",tt=(we?ul:Lr)(ae,xe);re=await ee(xe,tt,Q,we)}else{const{initialPageParam:we=ae.initialPageParam}=C,$e=(W==null?void 0:W.pageParams)??[],tt=$e[0]??we,es=$e.length;re=await ee(xe,tt,Q),X&&(re={data:re.data.pages[0]});for(let Vt=1;Vt<es;Vt++){const St=Lr(ae,re.data);re=await ee(re.data,St,Q)}}z=re}else z=await ce(C.originalArgs);return V&&!U&&z.meta&&(z.meta=await us(V,z.meta,"metaSchema",z.meta)),B(z.data,Ks({fulfilledTimeStamp:Date.now(),baseQueryMeta:z.meta}))}catch(Z){let q=Z;if(q instanceof Bo){let X=j(M,"transformErrorResponse");const{rawErrorResponseSchema:z,errorResponseSchema:ee}=M;let{value:ce,meta:ae}=q;try{z&&!U&&(ce=await us(z,ce,"rawErrorResponseSchema",ae)),V&&!U&&(ae=await us(V,ae,"metaSchema",ae));let Q=await X(ce,ae,C.originalArgs);return ee&&!U&&(Q=await us(ee,Q,"errorResponseSchema",ae)),m(Q,Ks({baseQueryMeta:ae}))}catch(Q){q=Q}}try{if(q instanceof dl){const X={endpoint:C.endpointName,arg:C.originalArgs,type:C.type,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0};(Y=M.onSchemaFailure)==null||Y.call(M,q,X),u==null||u(q,X);const{catchSchemaFailure:z=y}=M;if(z)return m(z(q,X),Ks({baseQueryMeta:q._bqMeta}))}}catch(X){q=X}throw console.error(q),q}};function v(C,E){const P=a.selectQueryEntry(E,C.queryCacheKey),m=a.selectConfig(E).refetchOnMountOrArgChange,B=P==null?void 0:P.fulfilledTimeStamp,I=C.forceRefetch??(C.subscribe&&m);return I?I===!0||(Number(new Date)-Number(B))/1e3>=I:!1}const T=()=>Ce(`${s}/executeQuery`,k,{getPendingMeta({arg:E}){const P=n[E.endpointName];return Ks({startedTimeStamp:Date.now(),..._i(P)?{direction:E.direction}:{}})},condition(E,{getState:P}){var U;const m=P(),B=a.selectQueryEntry(m,E.queryCacheKey),I=B==null?void 0:B.fulfilledTimeStamp,w=E.originalArgs,D=B==null?void 0:B.originalArgs,M=n[E.endpointName],V=E.direction;return Dr(E)?!0:(B==null?void 0:B.status)==="pending"?!1:v(E,m)||Ri(M)&&((U=M==null?void 0:M.forceRefetch)!=null&&U.call(M,{currentArg:w,previousArg:D,endpointState:B,state:m}))?!0:!(I&&!V)},dispatchConditionRejection:!0}),A=T(),c=T(),p=Ce(`${s}/executeMutation`,k,{getPendingMeta(){return Ks({startedTimeStamp:Date.now()})}}),_=C=>"force"in C,N=C=>"ifOlderThan"in C,g=(C,E,P)=>(m,B)=>{const I=_(P)&&P.force,w=N(P)&&P.ifOlderThan,D=(V=!0)=>{const U={forceRefetch:V,isPrefetch:!0};return r.endpoints[C].initiate(E,U)},M=r.endpoints[C].select(E)(B());if(I)m(D());else if(w){const V=M==null?void 0:M.fulfilledTimeStamp;if(!V){m(D());return}(Number(new Date)-Number(new Date(V)))/1e3>=w&&m(D())}else m(D(!1))};function $(C){return E=>{var P,m;return((m=(P=E==null?void 0:E.meta)==null?void 0:P.arg)==null?void 0:m.endpointName)===C}}function b(C,E){return{matchPending:$i(_a(C),$(E)),matchFulfilled:$i(bs(C),$(E)),matchRejected:$i(Yr(C),$(E))}}return{queryThunk:A,mutationThunk:p,infiniteQueryThunk:c,prefetch:g,updateQueryData:R,upsertQueryData:S,patchQueryData:f,buildMatchThunkActions:b}}function Lr(s,{pages:t,pageParams:n}){const i=t.length-1;return s.getNextPageParam(t[i],t,n[i],n)}function ul(s,{pages:t,pageParams:n}){var i;return(i=s.getPreviousPageParam)==null?void 0:i.call(s,t[0],t,n[0],n)}function hl(s,t,n,i){return io(n[s.meta.arg.endpointName][t],bs(s)?s.payload:void 0,Wr(s)?s.payload:void 0,s.meta.arg.originalArgs,"baseQueryMeta"in s.meta?s.meta.baseQueryMeta:void 0,i)}function An(s,t,n){const i=s[t];i&&n(i)}function fn(s){return("arg"in s?s.arg.fixedCacheKey:s.fixedCacheKey)??s.requestId}function Mo(s,t,n){const i=s[fn(t)];i&&n(i)}var Tn={};function jh({reducerPath:s,queryThunk:t,mutationThunk:n,serializeQueryArgs:i,context:{endpointDefinitions:r,apiUid:o,extractRehydrationInfo:a,hasRehydrationInfo:u},assertTagType:y,config:d}){const f=Us(`${s}/resetApiState`);function x($,b,C,E){var P;$[P=b.queryCacheKey]??($[P]={status:"uninitialized",endpointName:b.endpointName}),An($,b.queryCacheKey,m=>{m.status="pending",m.requestId=C&&m.requestId?m.requestId:E.requestId,b.originalArgs!==void 0&&(m.originalArgs=b.originalArgs),m.startedTimeStamp=E.startedTimeStamp;const B=r[E.arg.endpointName];_i(B)&&"direction"in b&&(m.direction=b.direction)})}function h($,b,C,E){An($,b.arg.queryCacheKey,P=>{if(P.requestId!==b.requestId&&!E)return;const{merge:m}=r[b.arg.endpointName];if(P.status="fulfilled",m)if(P.data!==void 0){const{fulfilledTimeStamp:B,arg:I,baseQueryMeta:w,requestId:D}=b;let M=Hr(P.data,V=>m(V,C,{arg:I.originalArgs,baseQueryMeta:w,fulfilledTimeStamp:B,requestId:D}));P.data=M}else P.data=C;else P.data=r[b.arg.endpointName].structuralSharing??!0?al(yc(P.data)?bc(P.data):P.data,C):C;delete P.error,P.fulfilledTimeStamp=b.fulfilledTimeStamp})}const R=dt({name:`${s}/queries`,initialState:Tn,reducers:{removeQueryResult:{reducer($,{payload:{queryCacheKey:b}}){delete $[b]},prepare:Ys()},cacheEntriesUpserted:{reducer($,b){for(const C of b.payload){const{queryDescription:E,value:P}=C;x($,E,!0,{arg:E,requestId:b.meta.requestId,startedTimeStamp:b.meta.timestamp}),h($,{arg:E,requestId:b.meta.requestId,fulfilledTimeStamp:b.meta.timestamp,baseQueryMeta:{}},P,!0)}},prepare:$=>({payload:$.map(E=>{const{endpointName:P,arg:m,value:B}=E,I=r[P];return{queryDescription:{type:"query",endpointName:P,originalArgs:E.arg,queryCacheKey:i({queryArgs:m,endpointDefinition:I,endpointName:P})},value:B}}),meta:{[Ra]:!0,requestId:Ta(),timestamp:Date.now()}})},queryResultPatched:{reducer($,{payload:{queryCacheKey:b,patches:C}}){An($,b,E=>{E.data=xo(E.data,C.concat())})},prepare:Ys()}},extraReducers($){$.addCase(t.pending,(b,{meta:C,meta:{arg:E}})=>{const P=Dr(E);x(b,E,P,C)}).addCase(t.fulfilled,(b,{meta:C,payload:E})=>{const P=Dr(C.arg);h(b,C,E,P)}).addCase(t.rejected,(b,{meta:{condition:C,arg:E,requestId:P},error:m,payload:B})=>{An(b,E.queryCacheKey,I=>{if(!C){if(I.requestId!==P)return;I.status="rejected",I.error=B??m}})}).addMatcher(u,(b,C)=>{const{queries:E}=a(C);for(const[P,m]of Object.entries(E))((m==null?void 0:m.status)==="fulfilled"||(m==null?void 0:m.status)==="rejected")&&(b[P]=m)})}}),S=dt({name:`${s}/mutations`,initialState:Tn,reducers:{removeMutationResult:{reducer($,{payload:b}){const C=fn(b);C in $&&delete $[C]},prepare:Ys()}},extraReducers($){$.addCase(n.pending,(b,{meta:C,meta:{requestId:E,arg:P,startedTimeStamp:m}})=>{P.track&&(b[fn(C)]={requestId:E,status:"pending",endpointName:P.endpointName,startedTimeStamp:m})}).addCase(n.fulfilled,(b,{payload:C,meta:E})=>{E.arg.track&&Mo(b,E,P=>{P.requestId===E.requestId&&(P.status="fulfilled",P.data=C,P.fulfilledTimeStamp=E.fulfilledTimeStamp)})}).addCase(n.rejected,(b,{payload:C,error:E,meta:P})=>{P.arg.track&&Mo(b,P,m=>{m.requestId===P.requestId&&(m.status="rejected",m.error=C??E)})}).addMatcher(u,(b,C)=>{const{mutations:E}=a(C);for(const[P,m]of Object.entries(E))((m==null?void 0:m.status)==="fulfilled"||(m==null?void 0:m.status)==="rejected")&&P!==(m==null?void 0:m.requestId)&&(b[P]=m)})}}),j={tags:{},keys:{}},k=dt({name:`${s}/invalidation`,initialState:j,reducers:{updateProvidedBy:{reducer($,b){var C,E,P;for(const{queryCacheKey:m,providedTags:B}of b.payload){v($,m);for(const{type:I,id:w}of B){const D=(E=(C=$.tags)[I]??(C[I]={}))[P=w||"__internal_without_id"]??(E[P]=[]);D.includes(m)||D.push(m)}$.keys[m]=B}},prepare:Ys()}},extraReducers($){$.addCase(R.actions.removeQueryResult,(b,{payload:{queryCacheKey:C}})=>{v(b,C)}).addMatcher(u,(b,C)=>{var P,m,B;const{provided:E}=a(C);for(const[I,w]of Object.entries(E))for(const[D,M]of Object.entries(w)){const V=(m=(P=b.tags)[I]??(P[I]={}))[B=D||"__internal_without_id"]??(m[B]=[]);for(const U of M)V.includes(U)||V.push(U)}}).addMatcher(ji(bs(t),Wr(t)),(b,C)=>{T(b,[C])}).addMatcher(R.actions.cacheEntriesUpserted.match,(b,C)=>{const E=C.payload.map(({queryDescription:P,value:m})=>({type:"UNKNOWN",payload:m,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:P}}));T(b,E)})}});function v($,b){var E;const C=$.keys[b]??[];for(const P of C){const m=P.type,B=P.id??"__internal_without_id",I=(E=$.tags[m])==null?void 0:E[B];I&&($.tags[m][B]=I.filter(w=>w!==b))}delete $.keys[b]}function T($,b){const C=b.map(E=>{const P=hl(E,"providesTags",r,y),{queryCacheKey:m}=E.meta.arg;return{queryCacheKey:m,providedTags:P}});k.caseReducers.updateProvidedBy($,k.actions.updateProvidedBy(C))}const A=dt({name:`${s}/subscriptions`,initialState:Tn,reducers:{updateSubscriptionOptions($,b){},unsubscribeQueryResult($,b){},internal_getRTKQSubscriptions(){}}}),c=dt({name:`${s}/internalSubscriptions`,initialState:Tn,reducers:{subscriptionsUpdated:{reducer($,b){return xo($,b.payload)},prepare:Ys()}}}),p=dt({name:`${s}/config`,initialState:{online:ah(),focused:oh(),middlewareRegistered:!1,...d},reducers:{middlewareRegistered($,{payload:b}){$.middlewareRegistered=$.middlewareRegistered==="conflict"||o!==b?"conflict":!0}},extraReducers:$=>{$.addCase(no,b=>{b.online=!0}).addCase(cl,b=>{b.online=!1}).addCase(so,b=>{b.focused=!0}).addCase(ll,b=>{b.focused=!1}).addMatcher(u,b=>({...b}))}}),_=xc({queries:R.reducer,mutations:S.reducer,provided:k.reducer,subscriptions:c.reducer,config:p.reducer}),N=($,b)=>_(f.match(b)?void 0:$,b),g={...p.actions,...R.actions,...A.actions,...c.actions,...S.actions,...k.actions,resetApiState:f};return{reducer:N,actions:g}}var kt=Symbol.for("RTKQ/skipToken"),pl={status:"uninitialized"},zo=Hr(pl,()=>{}),qo=Hr(pl,()=>{});function vh({serializeQueryArgs:s,reducerPath:t,createSelector:n}){const i=A=>zo,r=A=>qo;return{buildQuerySelector:h,buildInfiniteQuerySelector:R,buildMutationSelector:S,selectInvalidatedBy:j,selectCachedArgsForQuery:k,selectApiState:a,selectQueries:u,selectMutations:d,selectQueryEntry:y,selectConfig:f};function o(A){return{...A,..._o(A.status)}}function a(A){return A[t]}function u(A){var c;return(c=a(A))==null?void 0:c.queries}function y(A,c){var p;return(p=u(A))==null?void 0:p[c]}function d(A){var c;return(c=a(A))==null?void 0:c.mutations}function f(A){var c;return(c=a(A))==null?void 0:c.config}function x(A,c,p){return _=>{if(_===kt)return n(i,p);const N=s({queryArgs:_,endpointDefinition:c,endpointName:A});return n($=>y($,N)??zo,p)}}function h(A,c){return x(A,c,o)}function R(A,c){const{infiniteQueryOptions:p}=c;function _(N){const g={...N,..._o(N.status)},{isLoading:$,isError:b,direction:C}=g,E=C==="forward",P=C==="backward";return{...g,hasNextPage:v(p,g.data),hasPreviousPage:T(p,g.data),isFetchingNextPage:$&&E,isFetchingPreviousPage:$&&P,isFetchNextPageError:b&&E,isFetchPreviousPageError:b&&P}}return x(A,c,_)}function S(){return A=>{let c;return typeof A=="object"?c=fn(A)??kt:c=A,n(c===kt?r:N=>{var g,$;return(($=(g=a(N))==null?void 0:g.mutations)==null?void 0:$[c])??qo},o)}}function j(A,c){const p=A[t],_=new Set;for(const N of c.filter(Si).map(_r)){const g=p.provided.tags[N.type];if(!g)continue;let $=(N.id!==void 0?g[N.id]:Lo(Object.values(g)))??[];for(const b of $)_.add(b)}return Lo(Array.from(_.values()).map(N=>{const g=p.queries[N];return g?[{queryCacheKey:N,endpointName:g.endpointName,originalArgs:g.originalArgs}]:[]}))}function k(A,c){return Object.values(u(A)).filter(p=>(p==null?void 0:p.endpointName)===c&&p.status!=="uninitialized").map(p=>p.originalArgs)}function v(A,c){return c?Lr(A,c)!=null:!1}function T(A,c){return!c||!A.getPreviousPageParam?!1:ul(A,c)!=null}}var Es=WeakMap?new WeakMap:void 0,Ci=({endpointName:s,queryArgs:t})=>{let n="";const i=Es==null?void 0:Es.get(t);if(typeof i=="string")n=i;else{const r=JSON.stringify(t,(o,a)=>(a=typeof a=="bigint"?{$bigint:a.toString()}:a,a=mn(a)?Object.keys(a).sort().reduce((u,y)=>(u[y]=a[y],u),{}):a,a));mn(t)&&(Es==null||Es.set(t,r)),n=r}return`${s}(${n})`};function ml(...s){return function(n){const i=mo(d=>{var f;return(f=n.extractRehydrationInfo)==null?void 0:f.call(n,d,{reducerPath:n.reducerPath??"api"})}),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...n,extractRehydrationInfo:i,serializeQueryArgs(d){let f=Ci;if("serializeQueryArgs"in d.endpointDefinition){const x=d.endpointDefinition.serializeQueryArgs;f=h=>{const R=x(h);return typeof R=="string"?R:Ci({...h,queryArgs:R})}}else n.serializeQueryArgs&&(f=n.serializeQueryArgs);return f(d)},tagTypes:[...n.tagTypes||[]]},o={endpointDefinitions:{},batch(d){d()},apiUid:Ta(),extractRehydrationInfo:i,hasRehydrationInfo:mo(d=>i(d)!=null)},a={injectEndpoints:y,enhanceEndpoints({addTagTypes:d,endpoints:f}){if(d)for(const x of d)r.tagTypes.includes(x)||r.tagTypes.push(x);if(f)for(const[x,h]of Object.entries(f))typeof h=="function"?h(o.endpointDefinitions[x]):Object.assign(o.endpointDefinitions[x]||{},h);return a}},u=s.map(d=>d.init(a,r,o));function y(d){const f=d.endpoints({query:x=>({...x,type:"query"}),mutation:x=>({...x,type:"mutation"}),infiniteQuery:x=>({...x,type:"infinitequery"})});for(const[x,h]of Object.entries(f)){if(d.overrideExisting!==!0&&x in o.endpointDefinitions){if(d.overrideExisting==="throw")throw new Error(Na(39));continue}o.endpointDefinitions[x]=h;for(const R of u)R.injectEndpoint(x,h)}return a}return a.injectEndpoints({endpoints:n.endpoints})}}function Yt(s,...t){return Object.assign(s,...t)}var wh=({api:s,queryThunk:t,internalState:n})=>{const i=`${s.reducerPath}/subscriptions`;let r=null,o=null;const{updateSubscriptionOptions:a,unsubscribeQueryResult:u}=s.internalActions,y=(R,S)=>{var k,v,T;if(a.match(S)){const{queryCacheKey:A,requestId:c,options:p}=S.payload;return(k=R==null?void 0:R[A])!=null&&k[c]&&(R[A][c]=p),!0}if(u.match(S)){const{queryCacheKey:A,requestId:c}=S.payload;return R[A]&&delete R[A][c],!0}if(s.internalActions.removeQueryResult.match(S))return delete R[S.payload.queryCacheKey],!0;if(t.pending.match(S)){const{meta:{arg:A,requestId:c}}=S,p=R[v=A.queryCacheKey]??(R[v]={});return p[`${c}_running`]={},A.subscribe&&(p[c]=A.subscriptionOptions??p[c]??{}),!0}let j=!1;if(t.fulfilled.match(S)||t.rejected.match(S)){const A=R[S.meta.arg.queryCacheKey]||{},c=`${S.meta.requestId}_running`;j||(j=!!A[c]),delete A[c]}if(t.rejected.match(S)){const{meta:{condition:A,arg:c,requestId:p}}=S;if(A&&c.subscribe){const _=R[T=c.queryCacheKey]??(R[T]={});_[p]=c.subscriptionOptions??_[p]??{},j=!0}}return j},d=()=>n.currentSubscriptions,h={getSubscriptions:d,getSubscriptionCount:R=>{const j=d()[R]??{};return Fs(j)},isRequestSubscribed:(R,S)=>{var k;const j=d();return!!((k=j==null?void 0:j[R])!=null&&k[S])}};return(R,S)=>{if(r||(r=JSON.parse(JSON.stringify(n.currentSubscriptions))),s.util.resetApiState.match(R))return r=n.currentSubscriptions={},o=null,[!0,!1];if(s.internalActions.internal_getRTKQSubscriptions.match(R))return[!1,h];const j=y(n.currentSubscriptions,R);let k=!0;if(j){o||(o=setTimeout(()=>{const A=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,c]=Da(r,()=>A);S.next(s.internalActions.subscriptionsUpdated(c)),r=A,o=null},500));const v=typeof R.type=="string"&&!!R.type.startsWith(i),T=t.rejected.match(R)&&R.meta.condition&&!!R.meta.arg.subscribe;k=!v&&!T}return[k,!1]}};function Sh(s){for(const t in s)return!1;return!0}var kh=2147483647/1e3-1,Ch=({reducerPath:s,api:t,queryThunk:n,context:i,internalState:r,selectors:{selectQueryEntry:o,selectConfig:a}})=>{const{removeQueryResult:u,unsubscribeQueryResult:y,cacheEntriesUpserted:d}=t.internalActions,f=ji(y.match,n.fulfilled,n.rejected,d.match);function x(k){const v=r.currentSubscriptions[k];return!!v&&!Sh(v)}const h={},R=(k,v,T)=>{const A=v.getState(),c=a(A);if(f(k)){let p;if(d.match(k))p=k.payload.map(_=>_.queryDescription.queryCacheKey);else{const{queryCacheKey:_}=y.match(k)?k.payload:k.meta.arg;p=[_]}S(p,v,c)}if(t.util.resetApiState.match(k))for(const[p,_]of Object.entries(h))_&&clearTimeout(_),delete h[p];if(i.hasRehydrationInfo(k)){const{queries:p}=i.extractRehydrationInfo(k);S(Object.keys(p),v,c)}};function S(k,v,T){const A=v.getState();for(const c of k){const p=o(A,c);j(c,p==null?void 0:p.endpointName,v,T)}}function j(k,v,T,A){const c=i.endpointDefinitions[v],p=(c==null?void 0:c.keepUnusedDataFor)??A.keepUnusedDataFor;if(p===1/0)return;const _=Math.max(0,Math.min(p,kh));if(!x(k)){const N=h[k];N&&clearTimeout(N),h[k]=setTimeout(()=>{x(k)||T.dispatch(u({queryCacheKey:k})),delete h[k]},_*1e3)}}return R},Oo=new Error("Promise never resolved before cacheEntryRemoved."),Ih=({api:s,reducerPath:t,context:n,queryThunk:i,mutationThunk:r,internalState:o,selectors:{selectQueryEntry:a,selectApiState:u}})=>{const y=go(i),d=go(r),f=bs(i,r),x={};function h(v,T,A){const c=x[v];c!=null&&c.valueResolved&&(c.valueResolved({data:T,meta:A}),delete c.valueResolved)}function R(v){const T=x[v];T&&(delete x[v],T.cacheEntryRemoved())}const S=(v,T,A)=>{const c=j(v);function p(_,N,g,$){const b=a(A,N),C=a(T.getState(),N);!b&&C&&k(_,$,N,T,g)}if(i.pending.match(v))p(v.meta.arg.endpointName,c,v.meta.requestId,v.meta.arg.originalArgs);else if(s.internalActions.cacheEntriesUpserted.match(v))for(const{queryDescription:_,value:N}of v.payload){const{endpointName:g,originalArgs:$,queryCacheKey:b}=_;p(g,b,v.meta.requestId,$),h(b,N,{})}else if(r.pending.match(v))T.getState()[t].mutations[c]&&k(v.meta.arg.endpointName,v.meta.arg.originalArgs,c,T,v.meta.requestId);else if(f(v))h(c,v.payload,v.meta.baseQueryMeta);else if(s.internalActions.removeQueryResult.match(v)||s.internalActions.removeMutationResult.match(v))R(c);else if(s.util.resetApiState.match(v))for(const _ of Object.keys(x))R(_)};function j(v){return y(v)?v.meta.arg.queryCacheKey:d(v)?v.meta.arg.fixedCacheKey??v.meta.requestId:s.internalActions.removeQueryResult.match(v)?v.payload.queryCacheKey:s.internalActions.removeMutationResult.match(v)?fn(v.payload):""}function k(v,T,A,c,p){const _=n.endpointDefinitions[v],N=_==null?void 0:_.onCacheEntryAdded;if(!N)return;const g={},$=new Promise(B=>{g.cacheEntryRemoved=B}),b=Promise.race([new Promise(B=>{g.valueResolved=B}),$.then(()=>{throw Oo})]);b.catch(()=>{}),x[A]=g;const C=s.endpoints[v].select(ki(_)?T:A),E=c.dispatch((B,I,w)=>w),P={...c,getCacheEntry:()=>C(c.getState()),requestId:p,extra:E,updateCachedData:ki(_)?B=>c.dispatch(s.util.updateQueryData(v,T,B)):void 0,cacheDataLoaded:b,cacheEntryRemoved:$},m=N(T,P);Promise.resolve(m).catch(B=>{if(B!==Oo)throw B})}return S},Eh=({api:s,context:{apiUid:t},reducerPath:n})=>(i,r)=>{s.util.resetApiState.match(i)&&r.dispatch(s.internalActions.middlewareRegistered(t))},Ah=({reducerPath:s,context:t,context:{endpointDefinitions:n},mutationThunk:i,queryThunk:r,api:o,assertTagType:a,refetchQuery:u,internalState:y})=>{const{removeQueryResult:d}=o.internalActions,f=ji(bs(i),Wr(i)),x=ji(bs(i,r),Yr(i,r));let h=[];const R=(k,v)=>{f(k)?j(hl(k,"invalidatesTags",n,a),v):x(k)?j([],v):o.util.invalidateTags.match(k)&&j(io(k.payload,void 0,void 0,void 0,void 0,a),v)};function S(k){var A;const{queries:v,mutations:T}=k;for(const c of[v,T])for(const p in c)if(((A=c[p])==null?void 0:A.status)==="pending")return!0;return!1}function j(k,v){const T=v.getState(),A=T[s];if(h.push(...k),A.config.invalidationBehavior==="delayed"&&S(A))return;const c=h;if(h=[],c.length===0)return;const p=o.util.selectInvalidatedBy(T,c);t.batch(()=>{const _=Array.from(p.values());for(const{queryCacheKey:N}of _){const g=A.queries[N],$=y.currentSubscriptions[N]??{};g&&(Fs($)===0?v.dispatch(d({queryCacheKey:N})):g.status!=="uninitialized"&&v.dispatch(u(g)))}})}return R},Th=({reducerPath:s,queryThunk:t,api:n,refetchQuery:i,internalState:r})=>{const o={},a=(h,R)=>{(n.internalActions.updateSubscriptionOptions.match(h)||n.internalActions.unsubscribeQueryResult.match(h))&&y(h.payload,R),(t.pending.match(h)||t.rejected.match(h)&&h.meta.condition)&&y(h.meta.arg,R),(t.fulfilled.match(h)||t.rejected.match(h)&&!h.meta.condition)&&u(h.meta.arg,R),n.util.resetApiState.match(h)&&f()};function u({queryCacheKey:h},R){const S=R.getState()[s],j=S.queries[h],k=r.currentSubscriptions[h];if(!j||j.status==="uninitialized")return;const{lowestPollingInterval:v,skipPollingIfUnfocused:T}=x(k);if(!Number.isFinite(v))return;const A=o[h];A!=null&&A.timeout&&(clearTimeout(A.timeout),A.timeout=void 0);const c=Date.now()+v;o[h]={nextPollTimestamp:c,pollingInterval:v,timeout:setTimeout(()=>{(S.config.focused||!T)&&R.dispatch(i(j)),u({queryCacheKey:h},R)},v)}}function y({queryCacheKey:h},R){const j=R.getState()[s].queries[h],k=r.currentSubscriptions[h];if(!j||j.status==="uninitialized")return;const{lowestPollingInterval:v}=x(k);if(!Number.isFinite(v)){d(h);return}const T=o[h],A=Date.now()+v;(!T||A<T.nextPollTimestamp)&&u({queryCacheKey:h},R)}function d(h){const R=o[h];R!=null&&R.timeout&&clearTimeout(R.timeout),delete o[h]}function f(){for(const h of Object.keys(o))d(h)}function x(h={}){let R=!1,S=Number.POSITIVE_INFINITY;for(let j in h)h[j].pollingInterval&&(S=Math.min(h[j].pollingInterval,S),R=h[j].skipPollingIfUnfocused||R);return{lowestPollingInterval:S,skipPollingIfUnfocused:R}}return a},Nh=({api:s,context:t,queryThunk:n,mutationThunk:i})=>{const r=_a(n,i),o=Yr(n,i),a=bs(n,i),u={};return(d,f)=>{var x,h;if(r(d)){const{requestId:R,arg:{endpointName:S,originalArgs:j}}=d.meta,k=t.endpointDefinitions[S],v=k==null?void 0:k.onQueryStarted;if(v){const T={},A=new Promise((N,g)=>{T.resolve=N,T.reject=g});A.catch(()=>{}),u[R]=T;const c=s.endpoints[S].select(ki(k)?j:R),p=f.dispatch((N,g,$)=>$),_={...f,getCacheEntry:()=>c(f.getState()),requestId:R,extra:p,updateCachedData:ki(k)?N=>f.dispatch(s.util.updateQueryData(S,j,N)):void 0,queryFulfilled:A};v(j,_)}}else if(a(d)){const{requestId:R,baseQueryMeta:S}=d.meta;(x=u[R])==null||x.resolve({data:d.payload,meta:S}),delete u[R]}else if(o(d)){const{requestId:R,rejectedWithValue:S,baseQueryMeta:j}=d.meta;(h=u[R])==null||h.reject({error:d.payload??d.error,isUnhandledError:!S,meta:j}),delete u[R]}}},Ph=({reducerPath:s,context:t,api:n,refetchQuery:i,internalState:r})=>{const{removeQueryResult:o}=n.internalActions,a=(y,d)=>{so.match(y)&&u(d,"refetchOnFocus"),no.match(y)&&u(d,"refetchOnReconnect")};function u(y,d){const f=y.getState()[s],x=f.queries,h=r.currentSubscriptions;t.batch(()=>{for(const R of Object.keys(h)){const S=x[R],j=h[R];if(!j||!S)continue;(Object.values(j).some(v=>v[d]===!0)||Object.values(j).every(v=>v[d]===void 0)&&f.config[d])&&(Fs(j)===0?y.dispatch(o({queryCacheKey:R})):S.status!=="uninitialized"&&y.dispatch(i(S)))}})}return a};function Rh(s){const{reducerPath:t,queryThunk:n,api:i,context:r}=s,{apiUid:o}=r,a={invalidateTags:Us(`${t}/invalidateTags`)},u=x=>x.type.startsWith(`${t}/`),y=[Eh,Ch,Ah,Th,Ih,Nh];return{middleware:x=>{let h=!1;const S={...s,internalState:{currentSubscriptions:{}},refetchQuery:f,isThisApiSliceAction:u},j=y.map(T=>T(S)),k=wh(S),v=Ph(S);return T=>A=>{if(!fc(A))return T(A);h||(h=!0,x.dispatch(i.internalActions.middlewareRegistered(o)));const c={...x,next:T},p=x.getState(),[_,N]=k(A,c,p);let g;if(_?g=T(A):g=N,x.getState()[t]&&(v(A,c,p),u(A)||r.hasRehydrationInfo(A)))for(const $ of j)$(A,c,p);return g}},actions:a};function f(x){return s.api.endpoints[x.endpointName].initiate(x.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Uo=Symbol(),xl=({createSelector:s=Pa}={})=>({name:Uo,init(t,{baseQuery:n,tagTypes:i,reducerPath:r,serializeQueryArgs:o,keepUnusedDataFor:a,refetchOnMountOrArgChange:u,refetchOnFocus:y,refetchOnReconnect:d,invalidationBehavior:f,onSchemaFailure:x,catchSchemaFailure:h,skipSchemaValidation:R},S){mc();const j=q=>q;Object.assign(t,{reducerPath:r,endpoints:{},internalActions:{onOnline:no,onOffline:cl,onFocus:so,onFocusLost:ll},util:{}});const k=vh({serializeQueryArgs:o,reducerPath:r,createSelector:s}),{selectInvalidatedBy:v,selectCachedArgsForQuery:T,buildQuerySelector:A,buildInfiniteQuerySelector:c,buildMutationSelector:p}=k;Yt(t.util,{selectInvalidatedBy:v,selectCachedArgsForQuery:T});const{queryThunk:_,infiniteQueryThunk:N,mutationThunk:g,patchQueryData:$,updateQueryData:b,upsertQueryData:C,prefetch:E,buildMatchThunkActions:P}=bh({baseQuery:n,reducerPath:r,context:S,api:t,serializeQueryArgs:o,assertTagType:j,selectors:k,onSchemaFailure:x,catchSchemaFailure:h,skipSchemaValidation:R}),{reducer:m,actions:B}=jh({context:S,queryThunk:_,mutationThunk:g,serializeQueryArgs:o,reducerPath:r,assertTagType:j,config:{refetchOnFocus:y,refetchOnReconnect:d,refetchOnMountOrArgChange:u,keepUnusedDataFor:a,reducerPath:r,invalidationBehavior:f}});Yt(t.util,{patchQueryData:$,updateQueryData:b,upsertQueryData:C,prefetch:E,resetApiState:B.resetApiState,upsertQueryEntries:B.cacheEntriesUpserted}),Yt(t.internalActions,B);const{middleware:I,actions:w}=Rh({reducerPath:r,context:S,queryThunk:_,mutationThunk:g,infiniteQueryThunk:N,api:t,assertTagType:j,selectors:k});Yt(t.util,w),Yt(t,{reducer:m,middleware:I});const{buildInitiateQuery:D,buildInitiateInfiniteQuery:M,buildInitiateMutation:V,getRunningMutationThunk:U,getRunningMutationsThunk:H,getRunningQueriesThunk:Y,getRunningQueryThunk:Z}=fh({queryThunk:_,mutationThunk:g,infiniteQueryThunk:N,api:t,serializeQueryArgs:o,context:S});return Yt(t.util,{getRunningMutationThunk:U,getRunningMutationsThunk:H,getRunningQueryThunk:Z,getRunningQueriesThunk:Y}),{name:Uo,injectEndpoint(q,X){var ce;const ee=(ce=t.endpoints)[q]??(ce[q]={});Ri(X)&&Yt(ee,{name:q,select:A(q,X),initiate:D(q,X)},P(_,q)),mh(X)&&Yt(ee,{name:q,select:p(),initiate:V(q)},P(g,q)),_i(X)&&Yt(ee,{name:q,select:c(q,X),initiate:M(q,X)},P(_,q))}}}});xl();function Nn(s){return s.replace(s[0],s[0].toUpperCase())}function _h(s){return s.type==="query"}function Dh(s){return s.type==="mutation"}function gl(s){return s.type==="infinitequery"}function Xs(s,...t){return Object.assign(s,...t)}var Vi=Symbol();function Hi(s,t,n,i){const r=l.useMemo(()=>({queryArgs:s,serialized:typeof s=="object"?t({queryArgs:s,endpointDefinition:n,endpointName:i}):s}),[s,t,n,i]),o=l.useRef(r);return l.useEffect(()=>{o.current.serialized!==r.serialized&&(o.current=r)},[r]),o.current.serialized===r.serialized?o.current.queryArgs:s}function Pn(s){const t=l.useRef(s);return l.useEffect(()=>{nn(t.current,s)||(t.current=s)},[s]),nn(t.current,s)?t.current:s}var Lh=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$h=Lh(),Fh=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Bh=Fh(),Mh=()=>$h||Bh?l.useLayoutEffect:l.useEffect,zh=Mh(),Vo=s=>s.isUninitialized?{...s,isUninitialized:!1,isFetching:!0,isLoading:s.data===void 0,status:ol.pending}:s;function Wi(s,...t){const n={};return t.forEach(i=>{n[i]=s[i]}),n}var Yi=["data","status","isLoading","isSuccess","isError","error"];function qh({api:s,moduleOptions:{batch:t,hooks:{useDispatch:n,useSelector:i,useStore:r},unstable__sideEffectsInRender:o,createSelector:a},serializeQueryArgs:u,context:y}){const d=o?c=>c():l.useEffect;return{buildQueryHooks:v,buildInfiniteQueryHooks:T,buildMutationHook:A,usePrefetch:h};function f(c,p,_){if(p!=null&&p.endpointName&&c.isUninitialized){const{endpointName:E}=p,P=y.endpointDefinitions[E];_!==kt&&u({queryArgs:p.originalArgs,endpointDefinition:P,endpointName:E})===u({queryArgs:_,endpointDefinition:P,endpointName:E})&&(p=void 0)}let N=c.isSuccess?c.data:p==null?void 0:p.data;N===void 0&&(N=c.data);const g=N!==void 0,$=c.isLoading,b=(!p||p.isLoading||p.isUninitialized)&&!g&&$,C=c.isSuccess||g&&($&&!(p!=null&&p.isError)||c.isUninitialized);return{...c,data:N,currentData:c.data,isFetching:$,isLoading:b,isSuccess:C}}function x(c,p,_){if(p!=null&&p.endpointName&&c.isUninitialized){const{endpointName:E}=p,P=y.endpointDefinitions[E];_!==kt&&u({queryArgs:p.originalArgs,endpointDefinition:P,endpointName:E})===u({queryArgs:_,endpointDefinition:P,endpointName:E})&&(p=void 0)}let N=c.isSuccess?c.data:p==null?void 0:p.data;N===void 0&&(N=c.data);const g=N!==void 0,$=c.isLoading,b=(!p||p.isLoading||p.isUninitialized)&&!g&&$,C=c.isSuccess||$&&g;return{...c,data:N,currentData:c.data,isFetching:$,isLoading:b,isSuccess:C}}function h(c,p){const _=n(),N=Pn(p);return l.useCallback((g,$)=>_(s.util.prefetch(c,g,{...N,...$})),[c,_,N])}function R(c,p,{refetchOnReconnect:_,refetchOnFocus:N,refetchOnMountOrArgChange:g,skip:$=!1,pollingInterval:b=0,skipPollingIfUnfocused:C=!1,...E}={}){const{initiate:P}=s.endpoints[c],m=n(),B=l.useRef(void 0);if(!B.current){const q=m(s.internalActions.internal_getRTKQSubscriptions());B.current=q}const I=Hi($?kt:p,Ci,y.endpointDefinitions[c],c),w=Pn({refetchOnReconnect:_,refetchOnFocus:N,pollingInterval:b,skipPollingIfUnfocused:C}),D=E.initialPageParam,M=Pn(D),V=l.useRef(void 0);let{queryCacheKey:U,requestId:H}=V.current||{},Y=!1;U&&H&&(Y=B.current.isRequestSubscribed(U,H));const Z=!Y&&V.current!==void 0;return d(()=>{Z&&(V.current=void 0)},[Z]),d(()=>{var z;const q=V.current;if(I===kt){q==null||q.unsubscribe(),V.current=void 0;return}const X=(z=V.current)==null?void 0:z.subscriptionOptions;if(!q||q.arg!==I){q==null||q.unsubscribe();const ee=m(P(I,{subscriptionOptions:w,forceRefetch:g,...gl(y.endpointDefinitions[c])?{initialPageParam:M}:{}}));V.current=ee}else w!==X&&q.updateSubscriptionOptions(w)},[m,P,g,I,w,Z,M,c]),[V,m,P,w]}function S(c,p){return(N,{skip:g=!1,selectFromResult:$}={})=>{const{select:b}=s.endpoints[c],C=Hi(g?kt:N,u,y.endpointDefinitions[c],c),E=l.useRef(void 0),P=l.useMemo(()=>a([b(C),(D,M)=>M,D=>C],p,{memoizeOptions:{resultEqualityCheck:nn}}),[b,C]),m=l.useMemo(()=>$?a([P],$,{devModeChecks:{identityFunctionCheck:"never"}}):P,[P,$]),B=i(D=>m(D,E.current),nn),I=r(),w=P(I.getState(),E.current);return zh(()=>{E.current=w},[w]),B}}function j(c){l.useEffect(()=>()=>{var p,_;(_=(p=c.current)==null?void 0:p.unsubscribe)==null||_.call(p),c.current=void 0},[c])}function k(c){if(!c.current)throw new Error(Na(38));return c.current.refetch()}function v(c){const p=(g,$={})=>{const[b]=R(c,g,$);return j(b),l.useMemo(()=>({refetch:()=>k(b)}),[b])},_=({refetchOnReconnect:g,refetchOnFocus:$,pollingInterval:b=0,skipPollingIfUnfocused:C=!1}={})=>{const{initiate:E}=s.endpoints[c],P=n(),[m,B]=l.useState(Vi),I=l.useRef(void 0),w=Pn({refetchOnReconnect:g,refetchOnFocus:$,pollingInterval:b,skipPollingIfUnfocused:C});d(()=>{var H,Y;const U=(H=I.current)==null?void 0:H.subscriptionOptions;w!==U&&((Y=I.current)==null||Y.updateSubscriptionOptions(w))},[w]);const D=l.useRef(w);d(()=>{D.current=w},[w]);const M=l.useCallback(function(U,H=!1){let Y;return t(()=>{var Z;(Z=I.current)==null||Z.unsubscribe(),I.current=Y=P(E(U,{subscriptionOptions:D.current,forceRefetch:!H})),B(U)}),Y},[P,E]),V=l.useCallback(()=>{var U,H;(U=I.current)!=null&&U.queryCacheKey&&P(s.internalActions.removeQueryResult({queryCacheKey:(H=I.current)==null?void 0:H.queryCacheKey}))},[P]);return l.useEffect(()=>()=>{var U;(U=I==null?void 0:I.current)==null||U.unsubscribe()},[]),l.useEffect(()=>{m!==Vi&&!I.current&&M(m,!0)},[m,M]),l.useMemo(()=>[M,m,{reset:V}],[M,m,V])},N=S(c,f);return{useQueryState:N,useQuerySubscription:p,useLazyQuerySubscription:_,useLazyQuery(g){const[$,b,{reset:C}]=_(g),E=N(b,{...g,skip:b===Vi}),P=l.useMemo(()=>({lastArg:b}),[b]);return l.useMemo(()=>[$,{...E,reset:C},P],[$,E,C,P])},useQuery(g,$){const b=p(g,$),C=N(g,{selectFromResult:g===kt||$!=null&&$.skip?void 0:Vo,...$}),E=Wi(C,...Yi);return l.useDebugValue(E),l.useMemo(()=>({...C,...b}),[C,b])}}}function T(c){const p=(N,g={})=>{const[$,b,C,E]=R(c,N,g),P=l.useRef(E);d(()=>{P.current=E},[E]);const m=l.useCallback(function(w,D){let M;return t(()=>{var V;(V=$.current)==null||V.unsubscribe(),$.current=M=b(C(w,{subscriptionOptions:P.current,direction:D}))}),M},[$,b,C]);j($);const B=Hi(g.skip?kt:N,Ci,y.endpointDefinitions[c],c),I=l.useCallback(()=>k($),[$]);return l.useMemo(()=>({trigger:m,refetch:I,fetchNextPage:()=>m(B,"forward"),fetchPreviousPage:()=>m(B,"backward")}),[I,m,B])},_=S(c,x);return{useInfiniteQueryState:_,useInfiniteQuerySubscription:p,useInfiniteQuery(N,g){const{refetch:$,fetchNextPage:b,fetchPreviousPage:C}=p(N,g),E=_(N,{selectFromResult:N===kt||g!=null&&g.skip?void 0:Vo,...g}),P=Wi(E,...Yi,"hasNextPage","hasPreviousPage");return l.useDebugValue(P),l.useMemo(()=>({...E,fetchNextPage:b,fetchPreviousPage:C,refetch:$}),[E,b,C,$])}}}function A(c){return({selectFromResult:p,fixedCacheKey:_}={})=>{const{select:N,initiate:g}=s.endpoints[c],$=n(),[b,C]=l.useState();l.useEffect(()=>()=>{b!=null&&b.arg.fixedCacheKey||b==null||b.reset()},[b]);const E=l.useCallback(function(U){const H=$(g(U,{fixedCacheKey:_}));return C(H),H},[$,g,_]),{requestId:P}=b||{},m=l.useMemo(()=>N({fixedCacheKey:_,requestId:b==null?void 0:b.requestId}),[_,b,N]),B=l.useMemo(()=>p?a([m],p):m,[p,m]),I=i(B,nn),w=_==null?b==null?void 0:b.arg.originalArgs:void 0,D=l.useCallback(()=>{t(()=>{b&&C(void 0),_&&$(s.internalActions.removeMutationResult({requestId:P,fixedCacheKey:_}))})},[$,_,b,P]),M=Wi(I,...Yi,"endpointName");l.useDebugValue(M);const V=l.useMemo(()=>({...I,originalArgs:w,reset:D}),[I,w,D]);return l.useMemo(()=>[E,V],[E,V])}}}var Oh=Symbol(),Uh=({batch:s=jc,hooks:t={useDispatch:Re,useSelector:ge,useStore:vc},createSelector:n=Pa,unstable__sideEffectsInRender:i=!1,...r}={})=>({name:Oh,init(o,{serializeQueryArgs:a},u){const y=o,{buildQueryHooks:d,buildInfiniteQueryHooks:f,buildMutationHook:x,usePrefetch:h}=qh({api:o,moduleOptions:{batch:s,hooks:t,unstable__sideEffectsInRender:i,createSelector:n},serializeQueryArgs:a,context:u});return Xs(y,{usePrefetch:h}),Xs(u,{batch:s}),{injectEndpoint(R,S){if(_h(S)){const{useQuery:j,useLazyQuery:k,useLazyQuerySubscription:v,useQueryState:T,useQuerySubscription:A}=d(R);Xs(y.endpoints[R],{useQuery:j,useLazyQuery:k,useLazyQuerySubscription:v,useQueryState:T,useQuerySubscription:A}),o[`use${Nn(R)}Query`]=j,o[`useLazy${Nn(R)}Query`]=k}if(Dh(S)){const j=x(R);Xs(y.endpoints[R],{useMutation:j}),o[`use${Nn(R)}Mutation`]=j}else if(gl(S)){const{useInfiniteQuery:j,useInfiniteQuerySubscription:k,useInfiniteQueryState:v}=f(R);Xs(y.endpoints[R],{useInfiniteQuery:j,useInfiniteQuerySubscription:k,useInfiniteQueryState:v}),o[`use${Nn(R)}InfiniteQuery`]=j}}}}}),ro=ml(xl(),Uh());const Vh="/api",ei=ro({reducerPath:"exhibitorInvoiceApi",baseQuery:to({baseUrl:Vh,credentials:"include",prepareHeaders:s=>{const t=localStorage.getItem("exhibitor_token");return t&&s.set("authorization",`Bearer ${t}`),s.set("Content-Type","application/json"),s.set("Accept","application/json"),s}}),tagTypes:["ExhibitorInvoice"],endpoints:s=>({getExhibitorInvoice:s.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,n,i)=>[{type:"ExhibitorInvoice",id:i}]}),downloadExhibitorInvoice:s.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:s.mutation({query:({bookingId:t,...n})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:n})}),shareViaWhatsApp:s.mutation({query:({bookingId:t,...n})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:n})})})}),{useGetExhibitorInvoiceQuery:Hh,useDownloadExhibitorInvoiceMutation:Wh,useShareViaEmailMutation:Yh,useShareViaWhatsAppMutation:Qh}=ei,fl=({booking:s})=>{var b,C,E;const[t,n]=l.useState(null),[i,r]=l.useState(!0),o=ge(P=>P.settings.settings);l.useEffect(()=>{(async()=>{r(!0);try{if(s.exhibitionId.headerLogo){const m=s.exhibitionId.headerLogo;n(`${ne.defaults.baseURL}/public/uploads/${m}`),console.log("Using exhibition header logo:",m)}else if(o!=null&&o.logo){const m=o.logo;n(`${ne.defaults.baseURL}/public/uploads/${m}`),console.log("Using global settings logo:",m)}else{const m=`${ne.defaults.baseURL}/public/logo`;n(m),console.log("Using public logo endpoint:",m)}}catch(m){console.error("Error loading logo:",m),n(null)}finally{r(!1)}})()},[s.exhibitionId.headerLogo,o==null?void 0:o.logo]);const a=()=>{const P=new Date(s.exhibitionId.startDate||""),m=new Date(s.exhibitionId.endDate||""),B={};let I=new Date(P);for(;I<=m;){const D=I.toLocaleString("default",{month:"short",year:"numeric"});B[D]||(B[D]=[]),B[D].push(I.getDate().toString().padStart(2,"0")),I=new Date(I),I.setDate(I.getDate()+1)}const w=Object.entries(B).map(([D,M])=>`${M.join(", ")} ${D}`);return`${s.exhibitionId.name||"ABSE"} (${w.join(" & ")})`},u=P=>{const m=new Date(P);return{date:m.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:m.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},y=s.stallIds.map((P,m)=>{var D;const B=P,I=P.dimensions.width*P.dimensions.height,w=I*P.ratePerSqm;return{key:P._id,sn:m+1,stallNo:P.number,stallType:((D=B.stallTypeId)==null?void 0:D.name)||"Standard",dimensions:`${P.dimensions.width}x${P.dimensions.height}m`,area:I.toFixed(0),rate:P.ratePerSqm.toFixed(0),amount:w}}),d=y.reduce((P,m)=>P+m.amount,0),f=s.calculations,x=((b=f.stalls[0])==null?void 0:b.discount)!==void 0&&((C=f.stalls[0])==null?void 0:C.discount)!==null,h=x?(E=f.stalls[0])==null?void 0:E.discount:null,R=(h==null?void 0:h.type)||"percentage",S=(h==null?void 0:h.value)||0;let j=0;x&&S>0&&(R==="percentage"?j=Math.round(d*S/100*100)/100:R==="fixed"&&(j=Math.min(S,d)));const k=d-j,v=f.taxes.find(P=>P.name.includes("GST")),T=v?v.rate:18,A=Math.round(k*T/100*100)/100,c=k+A,p=d,_=j,N=k,g=A,$=c;return e.jsx("div",{className:"invoice-container",children:e.jsxs("div",{className:"proforma-invoice",children:[e.jsxs("div",{className:"header-section",children:[e.jsx("div",{className:"logo-cell",children:i?e.jsx("div",{className:"logo-loading",children:"Loading..."}):t?e.jsx("img",{src:t,alt:s.exhibitionId.companyName,className:"logo-image",onError:()=>n(null)}):s.exhibitionId.companyName}),e.jsxs("div",{className:"title-company",children:[e.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),e.jsx("div",{className:"company-cell",children:s.exhibitionId.companyName})]})]}),e.jsxs("div",{className:"bill-to-section",children:[e.jsx("div",{className:"bill-to-cell",children:"Bill To"}),e.jsxs("div",{className:"bill-to-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Company Name"}),e.jsx("div",{className:"value-cell",children:s.companyName}),e.jsx("div",{className:"date-label-cell",children:"Date"}),e.jsx("div",{className:"date-value-cell",children:u(s.createdAt).date})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Phone No."}),e.jsx("div",{className:"value-cell",children:s.customerPhone}),e.jsx("div",{className:"date-label-cell",children:"Time"}),e.jsx("div",{className:"date-value-cell",children:u(s.createdAt).time})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"GST No."}),e.jsx("div",{className:"value-cell",children:s.customerGSTIN}),e.jsx("div",{className:"date-label-cell",children:"Invoice No"}),e.jsx("div",{className:"date-value-cell",children:s.invoiceNumber})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Address"}),e.jsx("div",{className:"value-cell",children:s.customerAddress})]})]})]}),e.jsxs("div",{className:"expo-venue-section",children:[e.jsxs("div",{className:"expo-column",children:[e.jsx("div",{className:"heading",children:"Expo Name"}),e.jsx("div",{className:"content",children:a()})]}),e.jsxs("div",{className:"venue-column",children:[e.jsx("div",{className:"heading",children:"Venue"}),e.jsx("div",{className:"content",children:s.exhibitionId.venue})]})]}),e.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),e.jsxs("div",{className:"stall-table",children:[e.jsxs("div",{className:"stall-header",children:[e.jsx("div",{className:"stall-header-cell",children:"S/N"}),e.jsx("div",{className:"stall-header-cell",children:"Stall No."}),e.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),e.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),e.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),y.map(P=>e.jsxs("div",{className:"stall-row",children:[e.jsx("div",{className:"stall-cell",children:P.sn}),e.jsx("div",{className:"stall-cell",children:P.stallNo}),e.jsx("div",{className:"stall-cell",children:P.stallType}),e.jsx("div",{className:"stall-cell",children:P.dimensions}),e.jsx("div",{className:"stall-cell",children:P.area}),e.jsx("div",{className:"stall-cell",children:Number(P.rate).toLocaleString("en-IN")}),e.jsx("div",{className:"stall-cell",children:P.amount.toLocaleString("en-IN")})]},P.key))]}),e.jsx("div",{className:"section-header",children:"Calculation Summary"}),e.jsxs("div",{className:"calc-table",children:[e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),e.jsxs("div",{className:"calc-value",children:["",p.toLocaleString("en-IN")]})]}),x&&_>0&&e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:R==="percentage"?`Discount (${S}%)`:`Discount (Fixed ${S.toLocaleString("en-IN")})`}),e.jsxs("div",{className:"calc-value",children:["-",_.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:x&&_>0?"Amount after Discount":"Net Amount"}),e.jsxs("div",{className:"calc-value",children:["",N.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["GST (",T,"%)"]}),e.jsxs("div",{className:"calc-value",children:["",g.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row total-row",children:[e.jsx("div",{className:"calc-label",children:"Total Amount"}),e.jsxs("div",{className:"calc-value",children:["",$.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"details-section",children:[e.jsxs("div",{className:"bank-details",children:[e.jsx("div",{className:"details-header",children:"Bank Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Bank Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Account No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccount})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccountName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Branch"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankBranch})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"IFSC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankIFSC})]})]}),e.jsxs("div",{className:"company-details",children:[e.jsx("div",{className:"details-header",children:"Company Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"CIN No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyCIN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Pan No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyPAN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"SAC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companySAC})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"GST No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyGST})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Email"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyEmail})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Website"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyWebsite})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Address"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyAddress})]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"PI Instruction"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),e.jsx("div",{className:"signature-section",children:e.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},{Title:Gh,Text:Kh}=pe,Xh=()=>{var _,N,g,$,b,C,E,P,m,B,I,w,D,M,V,U,H,Y,Z;const{id:s}=ft(),{data:t,isLoading:n,error:i}=Hh(s||""),[r]=Wh(),[o]=Yh(),[a]=Qh(),[u,y]=l.useState(!1),[d,f]=l.useState(!1),[x]=L.useForm(),[h]=L.useForm(),[R,S]=l.useState(0),[j,k]=l.useState(!1),v=async()=>{if(s)try{k(!0),S(0),se.loading({content:"Preparing invoice...",key:"download"});const X=(()=>{let z=0;const ee=setInterval(()=>{z+=5,z<=90?(S(z),z%25===0&&se.loading({content:`Downloading: ${z}% complete`,key:"download"})):clearInterval(ee)},200);return ee})();try{const z=await r(s).unwrap();clearInterval(X),S(100),se.loading({content:"Finalizing download...",key:"download"});const ee=URL.createObjectURL(z),ce=document.createElement("a");ce.href=ee,ce.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||s||"download"}.pdf`,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(ee),se.success({content:"Invoice downloaded successfully",key:"download"})}catch(z){throw clearInterval(X),z}}catch(q){console.error("Error downloading PDF:",q),se.error({content:"Failed to download invoice",key:"download"})}finally{k(!1),setTimeout(()=>S(0),500)}},T=()=>{y(!0)},A=()=>{f(!0)},c=async q=>{try{await o({bookingId:s||"",email:q.email,message:q.message}).unwrap(),se.success(`Invoice sent to ${q.email}`),y(!1),x.resetFields()}catch(X){console.error("Error sending email:",X),se.error("Failed to send email")}},p=async q=>{try{await a({bookingId:s||"",phoneNumber:q.phoneNumber}).unwrap();const X=q.phoneNumber.replace(/\D/g,""),z=encodeURIComponent(q.message);window.open(`https://wa.me/${X}?text=${z}`,"_blank"),f(!1),h.resetFields()}catch(X){console.error("Error opening WhatsApp:",X),se.error("Failed to open WhatsApp")}};return n?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(Pt,{size:"large"})}):i||!t?e.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[e.jsx(Gh,{level:3,children:"Invoice Not Found"}),e.jsx(Kh,{children:"The requested invoice could not be loaded. Please try again later."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{title:"Invoice Details",style:{margin:"20px"},children:[e.jsx(ie,{gutter:[16,24],children:e.jsx(F,{span:24,children:e.jsxs(J,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(J,{children:[e.jsx(O,{icon:e.jsx(Ur,{}),onClick:v,loading:j&&R<100,disabled:j&&R>=100,children:"Download PDF"}),e.jsx(O,{icon:e.jsx(Ot,{}),onClick:T,disabled:j,children:"Share via Email"}),e.jsx(O,{icon:e.jsx(Ca,{}),onClick:A,disabled:j,children:"Share via WhatsApp"})]}),j&&e.jsx(Tt,{percent:R,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),e.jsx(Te,{}),e.jsx(fl,{booking:{...t.bookingId,customerGSTIN:(_=t.bookingId)!=null&&_.customerGSTIN||((N=t.bookingId)==null?void 0:N.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(g=t.bookingId)!=null&&g.customerAddress||(($=t.bookingId)==null?void 0:$.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((b=t.bookingId.exhibitionId)==null?void 0:b.companyName)||"",bankName:((C=t.bookingId.exhibitionId)==null?void 0:C.bankName)||"",bankAccount:((E=t.bookingId.exhibitionId)==null?void 0:E.bankAccount)||"",bankAccountName:((P=t.bookingId.exhibitionId)==null?void 0:P.bankAccountName)||"",bankBranch:((m=t.bookingId.exhibitionId)==null?void 0:m.bankBranch)||"",bankIFSC:((B=t.bookingId.exhibitionId)==null?void 0:B.bankIFSC)||"",companyCIN:((I=t.bookingId.exhibitionId)==null?void 0:I.companyCIN)||"",companyPAN:((w=t.bookingId.exhibitionId)==null?void 0:w.companyPAN)||"",companySAC:((D=t.bookingId.exhibitionId)==null?void 0:D.companySAC)||"",companyGST:((M=t.bookingId.exhibitionId)==null?void 0:M.companyGST)||"",companyEmail:((V=t.bookingId.exhibitionId)==null?void 0:V.companyEmail)||"",companyWebsite:((U=t.bookingId.exhibitionId)==null?void 0:U.companyWebsite)||"",companyAddress:((H=t.bookingId.exhibitionId)==null?void 0:H.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((Z=(Y=t.bookingId.calculations)==null?void 0:Y.stalls)==null?void 0:Z.map(q=>({...q,discount:q.discount?{...q.discount,type:q.discount.type||"percentage",value:q.discount.value}:void 0})))||[]}}})]}),e.jsx(je,{title:"Share Invoice via Email",visible:u,onCancel:()=>y(!1),footer:null,children:e.jsxs(L,{form:x,layout:"vertical",onFinish:c,children:[e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(G,{placeholder:"example@example.com"})}),e.jsx(L.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:e.jsx(G.TextArea,{rows:4})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(je,{title:"Share Invoice via WhatsApp",visible:d,onCancel:()=>f(!1),footer:null,children:e.jsxs(L,{form:h,layout:"vertical",onFinish:p,children:[e.jsx(L.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:e.jsx(G,{placeholder:"+1234567890"})}),e.jsx(L.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:e.jsx(G.TextArea,{rows:4})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Ho,Text:Wo}=pe,{TabPane:Yo}=at,Jh=()=>{var j;const{notification:s}=st.useApp(),[t]=L.useForm(),[n]=L.useForm(),[i,r]=l.useState(!1),[o,a]=l.useState(!1),[u,y]=l.useState(!1),[d,f]=l.useState(null),x=Re(),h=ge(k=>k.auth.user);l.useEffect(()=>{(async()=>{try{y(!0);const v=await wi.getProfile();v.data&&x(Ma({user:v.data,token:localStorage.getItem("token")||""}))}catch{se.error("Failed to fetch profile")}finally{y(!1)}})()},[x]);const R=async k=>{var v,T;try{f(null),a(!0),await wi.changePassword({currentPassword:k.currentPassword,newPassword:k.newPassword}),s.success({message:"Success",description:"Password has been changed successfully"}),n.resetFields()}catch(A){f(((T=(v=A.response)==null?void 0:v.data)==null?void 0:T.message)||"Failed to change password. Please try again.")}finally{a(!1)}},S=()=>h!=null&&h.role?typeof h.role=="string"?h.role:typeof h.role=="object"&&"name"in h.role?h.role.name:"User":"User";return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ie,{gutter:[24,24],align:"middle",children:e.jsxs(F,{flex:"auto",children:[e.jsx(Ho,{level:4,children:"My Account"}),e.jsx(Wo,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),e.jsx(K,{loading:u,children:e.jsxs(at,{defaultActiveKey:"account",children:[e.jsx(Yo,{tab:"Account Information",children:e.jsxs(ie,{gutter:32,children:[e.jsx(F,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(wt,{size:100,icon:e.jsx(Pe,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((j=h==null?void 0:h.username)==null?void 0:j.charAt(0).toUpperCase())||"U"}),e.jsx(Ho,{level:4,children:h==null?void 0:h.username}),e.jsx(Wo,{type:"secondary",children:S()})]})}),e.jsx(F,{span:18,children:e.jsx(L,{layout:"vertical",initialValues:{username:h==null?void 0:h.username,email:h==null?void 0:h.email},disabled:!0,children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:e.jsx(G,{prefix:e.jsx(Pe,{}),placeholder:"Username"})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Ot,{}),placeholder:"Email Address"})})})]})})})]})},"account"),e.jsxs(Yo,{tab:"Change Password",children:[d&&e.jsx(He,{message:"Error",description:d,type:"error",showIcon:!0,style:{marginBottom:24}}),e.jsxs(L,{form:n,layout:"vertical",onFinish:R,children:[e.jsx(L.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Current Password"})}),e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:k})=>({validator(v,T){return!T||k("newPassword")===T?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Confirm New Password"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",loading:o,icon:e.jsx(ws,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:As}=de,{Title:Zh,Text:ep}=pe,tp=()=>{const s=Re(),{message:t}=st.useApp(),[n]=L.useForm(),{settings:i,loading:r}=ge(h=>h.settings),[o,a]=l.useState([]),[u,y]=l.useState(0);l.useEffect(()=>{s(rn())},[s]),l.useEffect(()=>{if(i&&(n.setFieldsValue({siteName:i.siteName,adminEmail:i.adminEmail,language:i.language,timezone:i.timezone,emailNotifications:i.emailNotifications,footerText:i.footerText}),i.logo)){const h=j=>{const k=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${j}`,token:k}},{url:R,token:S}=h(i.logo);fetch(R,{headers:{authorization:`Bearer ${S}`}}).then(j=>j.blob()).then(j=>{var v;const k=URL.createObjectURL(j);a([{uid:"-1",name:((v=i.logo)==null?void 0:v.split("/").pop())||"logo",status:"done",url:k,thumbUrl:k,type:j.type,response:{path:i.logo}}])}).catch(()=>{a([])})}},[i,n]);const d=h=>{s(on(h)).unwrap().then(()=>t.success("Settings updated successfully")).catch(R=>t.error(`Failed to update settings: ${R}`))},f={name:"file",action:`${ne.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:o,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(h){const{status:R,name:S,response:j,uid:k}=h.file;if(R==="uploading"){a([...h.fileList]);return}if(R==="done"&&j){y(0);const v=localStorage.getItem("token"),T=`${ne.defaults.baseURL}/uploads/${j.path}`;fetch(T,{headers:{authorization:`Bearer ${v}`}}).then(A=>A.blob()).then(A=>{const c=URL.createObjectURL(A);a([{uid:h.file.uid,name:S,status:"done",url:c,thumbUrl:c,type:A.type,response:j}]),t.success(`${S} uploaded successfully`),n.setFieldValue("logo",j.path)}).catch(()=>{t.error(`${S} preview failed to load`),a([])})}else R==="error"?(t.error(`${S} upload failed.`),a([]),y(0)):R==="removed"&&(a([]),n.setFieldValue("logo",null),y(0))},onRemove(){return a([]),n.setFieldValue("logo",null),y(0),!0},customRequest:async({file:h,onSuccess:R,onError:S,onProgress:j})=>{try{s(Zn(h)).unwrap().then(k=>{R&&R(k)}).catch(k=>{S&&S(new Error(k))})}catch(k){S&&S(k)}}},x=e.jsx("div",{children:u>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Tt,{type:"circle",percent:u,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hn,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ie,{gutter:[24,24],align:"middle",children:e.jsx(F,{flex:"auto",children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(Zh,{level:4,style:{margin:0},children:"Settings"}),e.jsx(ep,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(K,{className:"info-card",children:e.jsxs(L,{form:n,layout:"vertical",onFinish:d,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(ie,{gutter:24,children:[e.jsxs(F,{span:12,children:[e.jsx(L.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(G,{})}),e.jsx(L.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(G,{})}),e.jsx(L.Item,{label:"Language",name:"language",children:e.jsxs(de,{children:[e.jsx(As,{value:"en",children:"English"}),e.jsx(As,{value:"es",children:"Spanish"}),e.jsx(As,{value:"fr",children:"French"})]})}),e.jsx(L.Item,{label:"Timezone",name:"timezone",children:e.jsxs(de,{children:[e.jsx(As,{value:"UTC",children:"UTC"}),e.jsx(As,{value:"EST",children:"EST"}),e.jsx(As,{value:"PST",children:"PST"})]})}),e.jsx(L.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(xt,{})})]}),e.jsxs(F,{span:12,children:[e.jsxs(L.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(un,{...f,children:o.length<1&&x}),o.length>0&&u>0&&e.jsx(Tt,{percent:u,status:"active",style:{marginTop:8}})]}),e.jsx(L.Item,{label:"Footer Text",name:"footerText",children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(L.Item,{children:e.jsxs(J,{children:[e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(ws,{}),loading:r,children:"Save Settings"}),e.jsx(O,{onClick:()=>n.resetFields(),icon:e.jsx(ql,{}),children:"Reset"})]})})]})})]})},sp=async()=>{try{return(await ne.get("/roles")).data}catch(s){throw console.error("Error fetching roles:",s),s}},np=async s=>{try{return(await ne.get(`/roles/${s}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},ip=async s=>{try{return(await ne.post("/roles",s)).data}catch(t){throw console.error("Error creating role:",t),t}},rp=async(s,t)=>{try{return(await ne.put(`/roles/${s}`,t)).data}catch(n){throw console.error("Error updating role:",n),n}},op=async s=>{try{await ne.delete(`/roles/${s}`)}catch(t){throw console.error("Error deleting role:",t),t}},ap={roles:[],role:null,loading:!1,error:null},Bs=Ce("roles/fetchRoles",async(s,{rejectWithValue:t})=>{var n,i;try{return await sp()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch roles")}}),Qi=Ce("roles/fetchRoleById",async(s,{rejectWithValue:t})=>{var n,i;try{return await np(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch role")}}),ti=Ce("roles/addRole",async(s,{rejectWithValue:t})=>{var n,i;try{return await ip(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create role")}}),si=Ce("roles/modifyRole",async({id:s,roleData:t},{rejectWithValue:n})=>{var i,r;try{return await rp(s,t)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update role")}}),ni=Ce("roles/removeRole",async(s,{rejectWithValue:t})=>{var n,i;try{return await op(s),s}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete role")}}),yl=dt({name:"roles",initialState:ap,reducers:{clearRoleError:s=>{s.error=null},setSelectedRole:(s,t)=>{s.role=t.payload}},extraReducers:s=>{s.addCase(Bs.pending,t=>{t.loading=!0,t.error=null}).addCase(Bs.fulfilled,(t,n)=>{t.loading=!1,t.roles=n.payload}).addCase(Bs.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Qi.pending,t=>{t.loading=!0,t.error=null}).addCase(Qi.fulfilled,(t,n)=>{t.loading=!1,t.role=n.payload}).addCase(Qi.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ti.pending,t=>{t.loading=!0,t.error=null}).addCase(ti.fulfilled,(t,n)=>{t.loading=!1,t.roles.push(n.payload)}).addCase(ti.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(si.pending,t=>{t.loading=!0,t.error=null}).addCase(si.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.roles.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.roles[i]=n.payload),((r=t.role)==null?void 0:r._id)===n.payload._id&&(t.role=n.payload)}).addCase(si.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ni.pending,t=>{t.loading=!0,t.error=null}).addCase(ni.fulfilled,(t,n)=>{var i;t.loading=!1,t.roles=t.roles.filter(r=>r._id!==n.payload),((i=t.role)==null?void 0:i._id)===n.payload&&(t.role=null)}).addCase(ni.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearRoleError:lg,setSelectedRole:cg}=yl.actions,lp=yl.reducer,{Text:Qo}=pe,cp=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],Gi=cp.reduce((s,t)=>(s[t.group]||(s[t.group]=[]),s[t.group].push({key:t.key,label:t.label}),s),{}),dp=({visible:s,onCancel:t,onSave:n,role:i,loading:r})=>{const[o]=L.useForm(),a=!!i,[u,y]=l.useState([]);l.useEffect(()=>{if(s)if(i){const S=i.permissions||[];o.setFieldsValue({name:i.name,description:i.description,permissions:S}),y(S)}else o.resetFields(),y([])},[s,i,o]);const d=()=>{o.setFieldsValue({permissions:u}),o.validateFields().then(S=>{n(S)})},f=S=>{const j=Gi[S].map(k=>k.key);return j.length>0&&j.every(k=>u.includes(k))},x=(S,j)=>{let k;j?k=[...u,S]:k=u.filter(v=>v!==S),y(k)},h=(S,j)=>{const k=Gi[S].map(T=>T.key);let v;if(j){const T=k.filter(A=>!u.includes(A));v=[...u,...T]}else v=u.filter(T=>!k.includes(T));y(v)},R=S=>u.includes(S);return e.jsx(je,{title:a?"Edit Role":"Add New Role",open:s,onCancel:t,width:700,footer:[e.jsx(O,{onClick:t,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:r,onClick:d,children:a?"Update":"Create"},"submit")],children:e.jsxs(L,{form:o,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[e.jsx(L.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:e.jsx(G,{placeholder:"e.g., Administrator, Editor, Viewer"})}),e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:e.jsx(G.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),e.jsx(Te,{plain:!0,children:"Permissions"}),e.jsx(L.Item,{name:"permissions",hidden:!0,children:e.jsx(G,{})}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(Gi).map(([S,j])=>e.jsx(K,{size:"small",title:e.jsxs(J,{children:[e.jsx(Qo,{strong:!0,children:S}),e.jsx(jr,{checked:f(S),onChange:k=>h(S,k.target.checked),children:"Select All"})]}),style:{marginBottom:16},children:e.jsx(ie,{gutter:[16,12],children:j.map(k=>e.jsx(F,{span:12,children:e.jsx(jr,{checked:R(k.key),onChange:v=>x(k.key,v.target.checked),children:e.jsx(Qo,{children:k.label})})},k.key))})},S))})]})})},Di=()=>{const{user:s}=ge(n=>n.auth),t=n=>{if(!s||!s.role||!s.role.permissions)return!1;const i=s.role.permissions;if(i.includes(n)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access"))return!0;const r=n.split("_");if(r.length===2){const o=r[0],a=r[1],u=[`${o}.*`,`*.${a}`,`view_${o}`,`${o}_view`,`${o}s_${a}`,`${a}_${o}`,o.endsWith("s")?`${o.slice(0,-1)}_${a}`:`${o}s_${a}`,`${o}_${a==="view"?"read":a}`,`${a==="view"?"read":a}_${o}`];for(const y of u)if(i.includes(y))return!0}return!1};return{hasPermission:t,hasAnyPermission:n=>n.some(i=>t(i)),hasAllPermissions:n=>n.every(i=>t(i))}},{Title:Rn,Paragraph:Go,Text:Ts}=pe,{confirm:up}=je;function Ki({allowed:s}){return s?e.jsx(zr,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):e.jsx(Ol,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function hp(){const{message:s,notification:t}=st.useApp(),n=Re(),{roles:i,loading:r,error:o}=ge(N=>N.role),[a,u]=l.useState(""),[y,d]=l.useState(!1),[f,x]=l.useState(null),{hasPermission:h}=Di();l.useEffect(()=>{n(Bs())},[n]),l.useEffect(()=>{o&&t.error({message:"Error",description:o})},[o,t]);const R=()=>{x(null),d(!0)},S=N=>{x(N),d(!0)},j=N=>{f?n(si({id:f._id,roleData:N})).unwrap().then(()=>{d(!1),s.success("Role updated successfully")}).catch(g=>{s.error(`Failed to update role: ${g.message}`)}):n(ti(N)).unwrap().then(()=>{d(!1),s.success("Role created successfully")}).catch(g=>{s.error(`Failed to create role: ${g.message}`)})},k=N=>{up({title:"Are you sure you want to delete this role?",icon:e.jsx(qs,{}),content:`This will permanently delete the ${N.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){n(ni(N._id)).unwrap().then(()=>{s.success(`${N.name} role deleted successfully`)}).catch(g=>{s.error(`Failed to delete role: ${g.message}`)})}})},v=[{title:"Role",dataIndex:"name",key:"name",render:(N,g)=>e.jsxs(J,{children:[e.jsx(wt,{style:{backgroundColor:p(g.name)},children:N.charAt(0).toUpperCase()}),e.jsx(Ts,{strong:!0,children:N})]})},{title:"Description",dataIndex:"description",key:"description",render:N=>e.jsx(Ts,{type:"secondary",children:N})},{title:"Read",key:"read",align:"center",render:(N,g)=>e.jsx(Ki,{allowed:T(g)})},{title:"Write",key:"write",align:"center",render:(N,g)=>e.jsx(Ki,{allowed:A(g)})},{title:"Delete",key:"delete",align:"center",render:(N,g)=>e.jsx(Ki,{allowed:c(g)})},{title:"Actions",key:"actions",align:"right",render:(N,g)=>e.jsxs(J,{children:[h("roles_edit")&&e.jsx(_e,{title:g.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:e.jsx(O,{type:"primary",shape:"circle",icon:e.jsx(Ms,{}),size:"small",onClick:()=>S(g),disabled:g.name==="Administrator"})}),h("roles_delete")&&e.jsx(_e,{title:"Delete role",children:e.jsx(O,{danger:!0,shape:"circle",icon:e.jsx(ot,{}),size:"small",onClick:()=>k(g),disabled:g.name==="Administrator"})})]})}],T=N=>N.permissions.some(g=>g.endsWith("_view")),A=N=>N.permissions.some(g=>g.endsWith("_create")||g.endsWith("_edit")),c=N=>N.permissions.some(g=>g.endsWith("_delete")),p=N=>{const g=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let $=0;for(let b=0;b<N.length;b++)$=N.charCodeAt(b)+(($<<5)-$);return g[Math.abs($)%g.length]},_=i.filter(N=>N.name.toLowerCase().includes(a.toLowerCase())||N.description.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(Rn,{level:2,children:"Roles & Permissions"}),e.jsx(Go,{children:"Manage role-based access control and permissions for your users."})]}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:r&&i.length===0,children:[e.jsxs(ie,{gutter:16,style:{marginBottom:16},children:[e.jsx(F,{span:16,children:e.jsx(G,{placeholder:"Search roles...",allowClear:!0,value:a,onChange:N=>u(N.target.value),prefix:e.jsx(Ts,{type:"secondary",style:{fontSize:16},children:""})})}),e.jsx(F,{span:8,style:{textAlign:"right"},children:h("roles_create")&&e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),style:{borderRadius:6},onClick:R,children:"Add Role"})})]}),e.jsx(Ne,{columns:v,dataSource:_,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(N,g)=>`Showing ${g[0]}-${g[1]} of ${N} roles`},style:{marginTop:8},loading:r&&i.length>0})]}),e.jsx(K,{title:e.jsx(Rn,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsxs(J,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(Rn,{level:5,children:"Best Practices"}),e.jsxs("ul",{style:{paddingLeft:20},children:[e.jsx("li",{children:e.jsx(Ts,{children:"Follow the principle of least privilege"})}),e.jsx("li",{children:e.jsx(Ts,{children:"Regularly audit user roles"})}),e.jsx("li",{children:e.jsx(Ts,{children:"Document role responsibilities"})})]})]}),e.jsxs(J,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(Rn,{level:5,children:"Role Inheritance"}),e.jsx(Go,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),e.jsx(dp,{visible:y,onCancel:()=>d(!1),onSave:j,role:f,loading:r})]})}const pp=async()=>{try{return(await ne.get("/users")).data}catch(s){throw console.error("Error fetching users:",s),s}},mp=async s=>{try{return(await ne.get(`/users/${s}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},xp=async s=>{try{return(await ne.post("/users",s)).data}catch(t){throw console.error("Error creating user:",t),t}},gp=async(s,t)=>{try{return(await ne.put(`/users/${s}`,t)).data}catch(n){throw console.error("Error updating user:",n),n}},fp=async s=>{try{await ne.delete(`/users/${s}`)}catch(t){throw console.error("Error deleting user:",t),t}},yp={users:[],selectedUser:null,loading:!1,error:null},gs=Ce("users/fetchUsers",async(s,{rejectWithValue:t})=>{var n,i;try{return await pp()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch users")}}),Xi=Ce("users/fetchUserById",async(s,{rejectWithValue:t})=>{var n,i;try{return await mp(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch user")}}),ii=Ce("users/addUser",async(s,{rejectWithValue:t})=>{var n,i;try{return await xp(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create user")}}),ri=Ce("users/modifyUser",async({id:s,userData:t},{rejectWithValue:n})=>{var i,r;try{return await gp(s,t)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update user")}}),oi=Ce("users/removeUser",async(s,{rejectWithValue:t})=>{var n,i;try{return await fp(s),s}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete user")}}),bl=dt({name:"users",initialState:yp,reducers:{clearUserError:s=>{s.error=null},setSelectedUser:(s,t)=>{s.selectedUser=t.payload}},extraReducers:s=>{s.addCase(gs.pending,t=>{t.loading=!0,t.error=null}).addCase(gs.fulfilled,(t,n)=>{t.loading=!1,t.users=n.payload}).addCase(gs.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Xi.pending,t=>{t.loading=!0,t.error=null}).addCase(Xi.fulfilled,(t,n)=>{t.loading=!1,t.selectedUser=n.payload}).addCase(Xi.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ii.pending,t=>{t.loading=!0,t.error=null}).addCase(ii.fulfilled,(t,n)=>{t.loading=!1,t.users.push(n.payload)}).addCase(ii.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ri.pending,t=>{t.loading=!0,t.error=null}).addCase(ri.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.users.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.users[i]=n.payload),((r=t.selectedUser)==null?void 0:r._id)===n.payload._id&&(t.selectedUser=n.payload)}).addCase(ri.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(oi.pending,t=>{t.loading=!0,t.error=null}).addCase(oi.fulfilled,(t,n)=>{var i;t.loading=!1,t.users=t.users.filter(r=>r._id!==n.payload),((i=t.selectedUser)==null?void 0:i._id)===n.payload&&(t.selectedUser=null)}).addCase(oi.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearUserError:dg,setSelectedUser:_n}=bl.actions,bp=bl.reducer,{Text:jp}=pe,vp=({visible:s,user:t,onClose:n})=>{if(!t)return null;const i=r=>typeof r=="string"?r:r&&typeof r=="object"&&r.name?r.name:"Unknown";return e.jsxs(je,{title:"User Details",open:s,onCancel:n,footer:null,width:600,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Pe,{}),style:{backgroundColor:"#1677ff"}}),e.jsxs("div",{style:{marginLeft:20},children:[e.jsx(jp,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),e.jsxs("div",{children:[e.jsx(le,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),e.jsx(le,{color:"blue",children:i(t.role)})]})]})]}),e.jsx(Te,{}),e.jsxs(fe,{bordered:!0,column:1,children:[e.jsx(fe.Item,{label:"Username",children:t.username}),e.jsx(fe.Item,{label:"Email",children:t.email}),e.jsx(fe.Item,{label:"Role",children:i(t.role)}),e.jsx(fe.Item,{label:"Status",children:e.jsx(le,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),e.jsx(fe.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),e.jsx(fe.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:Dn}=de,{Text:wp}=pe,Sp=({visible:s,user:t,onClose:n,onSuccess:i})=>{const{message:r}=st.useApp(),[o]=L.useForm(),a=Re(),{roles:u,loading:y}=ge(x=>x.role),{loading:d}=ge(x=>x.user);l.useEffect(()=>{s&&t&&o.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:typeof t.role=="object"?t.role._id:t.role,isActive:t.isActive})},[s,t,o]),l.useEffect(()=>{s&&a(Bs())},[s,a]);const f=async()=>{if(t)try{const x=await o.validateFields(),h={username:x.username,name:x.name,email:x.email,role:x.role,isActive:x.isActive};x.password&&x.password.trim()!==""&&(h.password=x.password),a(ri({id:t._id,userData:h})).unwrap().then(()=>{r.success("User updated successfully"),i(),n()}).catch(R=>{r.error(`Failed to update user: ${R}`)})}catch(x){console.error("Validation error:",x)}};return t?e.jsx(je,{title:"Edit User",open:s,onCancel:n,width:600,footer:[e.jsx(O,{onClick:n,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:d,onClick:f,children:"Update User"},"submit")],children:e.jsxs(L,{form:o,layout:"vertical",children:[e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(G,{placeholder:"Username"})}),e.jsx(L.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:e.jsx(G,{placeholder:"Full name"})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Email address"})}),e.jsx(Te,{children:e.jsx(wp,{type:"secondary",children:"Change Password (Optional)"})}),e.jsx(L.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"New password (optional)"})}),e.jsx(Te,{}),e.jsx(L.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(de,{loading:y,children:u.length>0?u.map(x=>e.jsx(Dn,{value:x._id,children:x.name},x._id)):e.jsxs(e.Fragment,{children:[e.jsx(Dn,{value:"admin",children:"Admin"}),e.jsx(Dn,{value:"manager",children:"Manager"}),e.jsx(Dn,{value:"agent",children:"Agent"})]})})}),e.jsx(L.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:Ln}=de,{Text:ug}=pe,kp=({visible:s,onClose:t,onSuccess:n})=>{const{message:i}=st.useApp(),[r]=L.useForm(),o=Re(),{roles:a,loading:u}=ge(f=>f.role),{loading:y}=ge(f=>f.user);l.useEffect(()=>{s&&o(Bs())},[s,o]),l.useEffect(()=>{s&&r.resetFields()},[s,r]);const d=async()=>{try{const f=await r.validateFields(),x={username:f.username,name:f.name,email:f.email,password:f.password,role:f.role,isActive:f.status};o(ii(x)).unwrap().then(h=>{i.success("User created successfully"),r.resetFields(),n(),t()}).catch(h=>{i.error(`Failed to create user: ${h}`)})}catch(f){console.error("Validation error:",f)}};return e.jsx(je,{title:"Create New User",open:s,onCancel:t,width:600,footer:[e.jsx(O,{onClick:t,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:y,onClick:d,children:"Create User"},"submit")],children:e.jsxs(L,{form:r,layout:"vertical",requiredMark:!1,children:[e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(G,{placeholder:"Username"})}),e.jsx(L.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:e.jsx(G,{placeholder:"Full name"})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Email address"})}),e.jsx(L.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"Enter password"})}),e.jsx(Te,{}),e.jsx(L.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(de,{placeholder:"Select role",loading:u,children:a.length>0?a.map(f=>e.jsx(Ln,{value:f._id,children:f.name},f._id)):e.jsxs(e.Fragment,{children:[e.jsx(Ln,{value:"admin",children:"Admin"}),e.jsx(Ln,{value:"manager",children:"Manager"}),e.jsx(Ln,{value:"agent",children:"Agent"})]})})}),e.jsx(L.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:Cp,Paragraph:Ip,Text:Js}=pe,{TabPane:Ji}=at,{confirm:Ep}=je;function Ap(){const{message:s,notification:t}=st.useApp(),n=Re(),{users:i,loading:r,error:o,selectedUser:a}=ge(E=>E.user),[u,y]=l.useState(""),[d,f]=l.useState("all"),[x,h]=l.useState(!1),[R,S]=l.useState(!1),[j,k]=l.useState(!1),{hasPermission:v}=Di();l.useEffect(()=>{n(gs())},[n]),l.useEffect(()=>{o&&t.error({message:"Error",description:o})},[o,t]),l.useEffect(()=>{a||(h(!1),S(!1))},[a]);const T=(E,P)=>{Ep({title:"Are you sure you want to delete this user?",icon:e.jsx(qs,{}),content:`This will permanently delete ${P}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{n(oi(E)).unwrap().then(()=>{s.success(`${P} has been deleted successfully.`)}).catch(m=>{s.error(`Failed to delete user: ${m}`)})}})},A=E=>{n(_n(E)),h(!0)},c=E=>{n(_n(E)),S(!0)},p=()=>{k(!0)},_=[{title:"User",key:"user",render:(E,P)=>e.jsxs(J,{children:[e.jsx(wt,{icon:e.jsx(Pe,{}),size:"large"}),e.jsxs(J,{direction:"vertical",size:0,children:[e.jsx(Js,{strong:!0,children:P.name||P.username}),e.jsx(Js,{type:"secondary",style:{fontSize:"12px"},children:P.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:E=>{const P=$(E);let m=P.toLowerCase()==="admin"||P.toLowerCase()==="administrator"?"#1677ff":P.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx(le,{color:m,style:{fontWeight:500,borderRadius:"4px"},children:P.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(E,P)=>$(P.role).toLowerCase().indexOf(E.toLowerCase())===0},{title:"Status",key:"status",render:(E,P)=>e.jsx(J,{children:P.isActive?e.jsx(gt,{status:"success",text:e.jsx(Js,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(gt,{status:"default",text:e.jsx(Js,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(E,P)=>P.isActive===E},{title:"Last Active",key:"lastLogin",render:(E,P)=>e.jsxs(J,{children:[e.jsx(et,{style:{color:"#8c8c8c"}}),e.jsx(Js,{type:"secondary",children:P.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(E,P)=>e.jsxs(J,{size:"small",children:[v("users_view")&&e.jsx(_e,{title:"View details",children:e.jsx(O,{type:"text",icon:e.jsx(Xt,{}),size:"small",onClick:()=>A(P)})}),v("users_edit")&&e.jsx(_e,{title:"Edit user",children:e.jsx(O,{type:"text",icon:e.jsx(Ms,{}),size:"small",onClick:()=>c(P)})}),v("users_delete")&&e.jsx(_e,{title:"Delete user",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(ot,{}),size:"small",onClick:()=>T(P._id,P.name||P.username)})})]})}],N=E=>E.isActive?"active":"inactive",g=i.filter(E=>(d==="all"||d==="active"&&N(E)==="active"||d==="inactive"&&N(E)==="inactive")&&Object.values(E).some(P=>typeof P=="string"&&P.toLowerCase().includes(u.toLowerCase()))),$=E=>typeof E=="string"?E:E&&typeof E=="object"&&E.name?E.name:"Unknown",b={admin:i.filter(E=>{const P=$(E.role).toLowerCase();return P==="admin"||P==="administrator"}).length,manager:i.filter(E=>$(E.role).toLowerCase()==="manager").length,agent:i.filter(E=>$(E.role).toLowerCase()==="agent").length},C={active:i.filter(E=>E.isActive).length,inactive:i.filter(E=>!E.isActive).length};return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(Cp,{level:2,children:"User Management"}),e.jsx(Ip,{children:"Manage user accounts, permissions, and access control."})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(F,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ke,{title:"Total Users",value:i.length,prefix:e.jsx(Pe,{}),valueStyle:{color:"#1677ff"},loading:r})})}),e.jsx(F,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ke,{title:"Active Users",value:C.active,prefix:e.jsx(zr,{}),valueStyle:{color:"#52c41a"},loading:r})})}),e.jsx(F,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ke,{title:"Admin Users",value:b.admin,prefix:e.jsx(Pe,{}),valueStyle:{color:"#faad14"},loading:r})})})]}),e.jsx(K,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs(ie,{gutter:[16,16],justify:"space-between",align:"middle",children:[e.jsx(F,{xs:24,md:12,children:e.jsx(G,{placeholder:"Search users...",prefix:e.jsx(os,{style:{color:"rgba(0,0,0,.45)"}}),onChange:E=>y(E.target.value),allowClear:!0,size:"middle"})}),e.jsx(F,{xs:24,md:12,style:{textAlign:"right"},children:e.jsxs(J,{wrap:!0,children:[e.jsx(_e,{title:"Refresh data",children:e.jsx(O,{icon:r?e.jsx(Ul,{}):e.jsx(os,{}),onClick:()=>n(gs()),disabled:r,children:"Refresh"})}),e.jsx(O,{type:"primary",icon:e.jsx(dn,{}),onClick:p,children:"Add User"})]})})]})}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(at,{defaultActiveKey:"all",onChange:f,tabBarStyle:{marginBottom:24},children:[e.jsx(Ji,{tab:`All Users (${i.length})`},"all"),e.jsx(Ji,{tab:`Active (${C.active})`},"active"),e.jsx(Ji,{tab:`Inactive (${C.inactive})`},"inactive")]}),e.jsx(Ne,{columns:_,dataSource:g,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(E,P)=>`${P[0]}-${P[1]} of ${E} users`},loading:r})]}),e.jsx(vp,{user:i.find(E=>E._id===(a==null?void 0:a._id))||null,visible:x,onClose:()=>n(_n(null))}),e.jsx(Sp,{user:i.find(E=>E._id===(a==null?void 0:a._id))||null,visible:R,onClose:()=>n(_n(null)),onSuccess:()=>n(gs())}),e.jsx(kp,{visible:j,onClose:()=>k(!1),onSuccess:()=>n(gs())})]})}const{Title:hg,Text:$n,Paragraph:Zs}=pe,Tp=({settings:s,onSave:t,loading:n})=>{const[i]=L.useForm();De.useEffect(()=>{i.setFieldsValue(s)},[s,i]);const r=o=>{t(o)};return e.jsxs(K,{title:e.jsxs(J,{children:[e.jsx(Ot,{}),e.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[e.jsx(Zs,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),e.jsx(He,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(L,{form:i,layout:"vertical",initialValues:s,onFinish:r,children:[e.jsxs(ie,{gutter:[24,16],children:[e.jsxs(F,{span:24,children:[e.jsx(L.Item,{name:"newLeads",valuePropName:"checked",label:e.jsx($n,{strong:!0,children:"New Lead Notifications"}),children:e.jsx(xt,{})}),e.jsx(Zs,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),e.jsxs(F,{span:24,children:[e.jsx(L.Item,{name:"followUpReminders",valuePropName:"checked",label:e.jsx($n,{strong:!0,children:"Follow-up Reminders"}),children:e.jsx(xt,{})}),e.jsx(Zs,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),e.jsxs(F,{span:24,children:[e.jsx(L.Item,{name:"statusChanges",valuePropName:"checked",label:e.jsx($n,{strong:!0,children:"Status Change Notifications"}),children:e.jsx(xt,{})}),e.jsx(Zs,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),e.jsxs(F,{span:24,children:[e.jsx(L.Item,{name:"leadAssignments",valuePropName:"checked",label:e.jsx($n,{strong:!0,children:"Lead Assignment Notifications"}),children:e.jsx(xt,{})}),e.jsx(Zs,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),e.jsx(Te,{}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(ws,{}),loading:n,children:"Save Email Preferences"})})]})]})},Zi=s=>{switch(s){case"NEW_BOOKING":return Qe.NEW_BOOKING;case"BOOKING_CONFIRMED":return Qe.BOOKING_CONFIRMED;case"BOOKING_CANCELLED":return Qe.BOOKING_CANCELLED;case"PAYMENT_RECEIVED":return Qe.PAYMENT_RECEIVED;case"INVOICE_GENERATED":return Qe.INVOICE_GENERATED;case"EXHIBITION_UPDATE":return Qe.EXHIBITION_UPDATE;case"SYSTEM_MESSAGE":return Qe.SYSTEM_MESSAGE;case"EXHIBITOR_MESSAGE":return Qe.EXHIBITOR_MESSAGE;case"EXHIBITOR_REGISTERED":return Qe.EXHIBITOR_REGISTERED;default:return Qe.SYSTEM_MESSAGE}},{Title:Np,Text:pg,Paragraph:Ko}=pe,{Search:Pp}=G,{TabPane:Xo}=at,Rp=()=>{const s=Ie();ft();const[t,n]=l.useState([]),[i,r]=l.useState([]),[o,a]=l.useState(!1),[u,y]=l.useState(""),[d,f]=l.useState("ALL"),[x,h]=l.useState("ALL"),[R,S]=l.useState({newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0}),[j,k]=l.useState(!1),[v,T]=l.useState("all");l.useEffect(()=>{const B=localStorage.getItem("token");B&&Le.init(B,!1),A(),Le.subscribeToNotifications();const I=D=>{const M={...D,type:Zi(D.type)};n(V=>V.some(U=>U._id===D._id)?V:[M,...V])},w=D=>{if(D.newNotifications&&D.newNotifications.length>0){const M=D.newNotifications.map(V=>({...V,type:Zi(V.type)}));n(V=>[...M.filter(H=>!V.some(Y=>Y._id===H._id)),...V])}};return Le.addEventListener("notification",I),Le.addEventListener("notification_update",w),()=>{Le.removeEventListener("notification",I),Le.removeEventListener("notification_update",w)}},[]),l.useEffect(()=>{c()},[t,u,d,x,v]),l.useEffect(()=>{A();const m=()=>{t.length===0&&A()};return window.addEventListener("focus",m),()=>{window.removeEventListener("focus",m)}},[t.length]);const A=async()=>{a(!0);try{const m=await Le.getNotifications(1,50);if(m.success){const B=m.data.notifications.map(I=>({...I,type:Zi(I.type)}));n(B)}}catch{Ht.error({message:"Failed to fetch notifications",description:"There was an error loading your notifications. Please try again later."})}finally{a(!1)}},c=()=>{let m=t;if(v==="unread"&&(m=m.filter(B=>B.isRead===!1)),u){const B=u.toLowerCase();m=m.filter(I=>I.title.toLowerCase().includes(B)||I.message.toLowerCase().includes(B))}d!=="ALL"&&(m=m.filter(B=>B.type===d)),x!=="ALL"&&(m=m.filter(B=>B.source===x)),r(m)},p=m=>{T(m)},_=m=>{y(m)},N=()=>{y(""),f("ALL"),h("ALL"),T("all")},g=m=>{const B=zd(m);s(B)},$=async m=>{try{await Le.markAsRead(m._id);const B=t.map(I=>I._id===m._id?{...I,isRead:!0,readAt:new Date().toISOString()}:I);n(B)}catch{Ht.error({message:"Failed to mark notification as read",description:"There was an error updating the notification status. Please try again later."})}},b=async m=>{try{await Le.deleteNotification(m._id);const B=t.filter(I=>I._id!==m._id);n(B),Ht.success({message:"Notification deleted",description:"The notification has been deleted successfully."})}catch{Ht.error({message:"Failed to delete notification",description:"There was an error deleting the notification. Please try again later."})}},C=async()=>{try{await Le.markAllAsRead();const m=t.map(B=>({...B,isRead:!0,readAt:new Date().toISOString()}));n(m),Ht.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})}catch{Ht.error({message:"Failed to mark all notifications as read",description:"There was an error updating the notification status. Please try again later."})}},E=async()=>{try{await Le.deleteAllNotifications(),n([]),Ht.success({message:"All notifications cleared",description:"All notifications have been deleted successfully."})}catch{Ht.error({message:"Failed to clear notifications",description:"There was an error deleting the notifications. Please try again later."})}},P=m=>{k(!0),setTimeout(()=>{S(m),k(!1),Ht.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return e.jsx("div",{className:"notifications-page",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:24,children:e.jsx(K,{children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsxs(F,{children:[e.jsx(Np,{level:4,children:e.jsxs(J,{children:[e.jsx($r,{}),"Notifications ",t.length>0?`(${t.length})`:""]})}),e.jsx(Ko,{children:"Stay updated with all your lead activities and follow-ups"})]}),e.jsx(F,{children:e.jsxs(J,{children:[e.jsx(_e,{title:"Refresh notifications",children:e.jsx(O,{icon:e.jsx(yn,{}),onClick:A,loading:o,children:"Refresh"})}),e.jsx(O,{type:"primary",icon:e.jsx(Fr,{}),onClick:C,disabled:t.filter(m=>!m.isRead).length===0,children:"Mark All as Read"}),e.jsx(O,{type:"primary",danger:!0,icon:e.jsx(ot,{}),onClick:E,disabled:t.length===0,children:"Clear All"})]})})]})})}),e.jsx(F,{xs:24,lg:16,children:e.jsxs(K,{className:"notifications-list-card",style:{marginBottom:24},children:[e.jsxs(at,{activeKey:v,onChange:p,tabBarExtraContent:e.jsx(J,{children:e.jsx(gt,{count:Md(t),offset:[-5,0],children:e.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[e.jsx(Xo,{tab:"All Notifications"},"all"),e.jsx(Xo,{tab:"Unread"},"unread")]}),e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsx(Pp,{placeholder:"Search notifications...",onSearch:_,style:{width:300},allowClear:!0}),e.jsx(J,{children:e.jsx(O,{icon:e.jsx(Ii,{}),onClick:N,disabled:u===""&&d==="ALL"&&x==="ALL",children:"Reset Filters"})})]}),e.jsx($t,{dataSource:i,renderItem:m=>e.jsx(el,{notification:m,onView:g,onMarkAsRead:$,onDelete:b}),pagination:{pageSize:10,showTotal:(m,B)=>`${B[0]}-${B[1]} of ${m} notifications`},rowKey:"_id",loading:o,locale:{emptyText:e.jsx(Ve,{description:e.jsx("span",{children:"No notifications found"})})}})]})}),e.jsxs(F,{xs:24,lg:8,children:[e.jsx(Tp,{settings:R,onSave:P,loading:j}),e.jsx(K,{title:e.jsxs(J,{children:[e.jsx(gi,{}),e.jsx("span",{children:"Notification Tips"})]}),children:e.jsx(Ko,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),e.jsx("li",{children:"Use email notifications for critical updates when you're away"}),e.jsx("li",{children:"Click on a notification to see more details or take action"}),e.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class wn extends De.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Error caught by boundary:",t,n)}render(){var t;return this.state.hasError?e.jsx(pn,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[e.jsx(O,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),e.jsx(O,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Xe=s=>{var n,i;const t=((i=(n=s.response)==null?void 0:n.data)==null?void 0:i.message)||"An error occurred";throw new Error(t)},Fe={getExhibitions:async()=>{try{return await ne.get("/exhibitions")}catch(s){return Xe(s)}},getActiveExhibitions:async()=>{try{return await ne.get("/exhibitions/active")}catch(s){return Xe(s)}},getExhibition:async s=>{try{return await ne.get(`/exhibitions/${s}`)}catch(t){return Xe(t)}},createExhibition:async s=>{try{return await ne.post("/exhibitions",s)}catch(t){return Xe(t)}},updateExhibition:async(s,t)=>{try{return await ne.put(`/exhibitions/${s}`,t)}catch(n){return Xe(n)}},deleteExhibition:async s=>{try{return await ne.delete(`/exhibitions/${s}`)}catch(t){return Xe(t)}},getHalls:async s=>{try{return await ne.get(`/exhibitions/${s}/halls`)}catch(t){return Xe(t)}},createHall:async(s,t)=>{try{const{_id:n,id:i,createdAt:r,updatedAt:o,...a}=t;return console.log("Creating hall with data:",{exhibitionId:s,data:a}),(await ne.post(`/exhibitions/${s}/halls`,a)).data}catch(n){throw console.error("Error creating hall:",n),n}},updateHall:async(s,t,n)=>{try{const{_id:i,id:r,createdAt:o,updatedAt:a,...u}=n;console.log("Updating hall with data:",{exhibitionId:s,hallId:t,data:u});const y=await ne.put(`/exhibitions/${s}/halls/${t}`,u);return console.log("Hall updated:",y.data),y}catch(i){return console.error("Error updating hall:",i),Xe(i)}},deleteHall:async(s,t)=>{var n,i,r;try{if(!s||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:s,hallId:t});const o=await ne.delete(`/exhibitions/${s}/halls/${t}`);if(!o.data)throw new Error("No response received from server");return o}catch(o){throw console.error("Error deleting hall:",o),((n=o.response)==null?void 0:n.status)===401?new Error("Unauthorized. Please log in again."):((i=o.response)==null?void 0:i.status)===403?new Error("You do not have permission to delete halls."):((r=o.response)==null?void 0:r.status)===404?new Error("Hall not found."):o}},saveLayout:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(n){return Xe(n)}},getLayout:async s=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${s}/layout`)}catch(t){return Xe(t)}},getStalls:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${s}/stalls`,{params:{hallId:t}})}catch(n){return Xe(n)}},createStall:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.post(`/exhibitions/${s}/stalls`,t)}catch(n){return Xe(n)}},updateStall:async(s,t,n)=>{try{if(!s||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:s,stallId:t,data:n});const i=await ne.put(`/exhibitions/${s}/stalls/${t}`,n);return console.log("Stall update response:",i),i}catch(i){return console.error("Error updating stall:",i),Xe(i)}},deleteStall:async(s,t)=>{try{if(!s||!t)throw new Error("Exhibition ID and Stall ID are required");return await ne.delete(`/exhibitions/${s}/stalls/${t}`)}catch(n){return Xe(n)}},getFixtures:async(s,t)=>{try{const n=`/exhibitions/${s}/fixtures`,i=t?{type:t}:void 0;return await ne.get(n,{params:i})}catch(n){return Xe(n)}},getFixture:async(s,t)=>{try{return await ne.get(`/exhibitions/${s}/fixtures/${t}`)}catch(n){return Xe(n)}},createFixture:async(s,t)=>{try{return await ne.post(`/exhibitions/${s}/fixtures`,t)}catch(n){return Xe(n)}},updateFixture:async(s,t,n)=>{try{return await ne.put(`/exhibitions/${s}/fixtures/${t}`,n)}catch(i){return Xe(i)}},deleteFixture:async(s,t)=>{try{return await ne.delete(`/exhibitions/${s}/fixtures/${t}`)}catch(n){return Xe(n)}}},_p={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},It=Ce("exhibition/fetchExhibitions",async(s,{rejectWithValue:t})=>{try{return(await Fe.getExhibitions()).data.map(r=>({...r,id:r._id||r.id})).filter(r=>r.id)}catch(n){return t(n.message)}}),vt=Ce("exhibition/fetchExhibition",async(s,{rejectWithValue:t})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.getExhibition(s)).data}catch(n){return t(n.message)}}),ai=Ce("exhibition/createExhibition",async(s,{rejectWithValue:t})=>{try{return(await Fe.createExhibition(s)).data}catch(n){return t(n.message)}}),li=Ce("exhibition/updateExhibition",async({id:s,data:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.updateExhibition(s,t)).data}catch(i){return n(i.message)}}),qt=Ce("exhibition/fetchHalls",async(s,{rejectWithValue:t})=>{var n;try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.getHalls(s)).data}catch(i){return((n=i.response)==null?void 0:n.status)===404?[]:t(i.message)}}),zt=Ce("exhibition/fetchStalls",async({exhibitionId:s,hallId:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.getStalls(s,t)).data}catch(i){return n(i.message)}}),an=Ce("exhibition/deleteExhibition",async(s,{rejectWithValue:t})=>{try{return await Fe.deleteExhibition(s),s}catch(n){return t(n.message)}}),ln=Ce("exhibition/fetchFixtures",async({exhibitionId:s,type:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.getFixtures(s,t)).data}catch(i){return n(i.message)}}),ci=Ce("exhibition/createFixture",async({exhibitionId:s,data:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Fe.createFixture(s,t)).data}catch(i){return n(i.message)}}),di=Ce("exhibition/updateFixture",async({exhibitionId:s,id:t,data:n},{rejectWithValue:i})=>{try{if(!s||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await Fe.updateFixture(s,t,n)).data}catch(r){return i(r.message)}}),ui=Ce("exhibition/deleteFixture",async({exhibitionId:s,id:t},{rejectWithValue:n})=>{try{if(!s||!t)throw new Error("Exhibition ID and Fixture ID are required");return await Fe.deleteFixture(s,t),t}catch(i){return n(i.message)}}),jl=dt({name:"exhibition",initialState:_p,reducers:{clearCurrentExhibition:s=>{s.currentExhibition=null,s.halls=[],s.stalls=[],s.fixtures=[],s.error=null},clearError:s=>{s.error=null},clearStalls:s=>{s.stalls=[]},clearFixtures:s=>{s.fixtures=[]}},extraReducers:s=>{s.addCase(It.pending,t=>{t.loading=!0,t.error=null}).addCase(It.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions=n.payload}).addCase(It.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(vt.pending,t=>{t.loading=!0,t.error=null}).addCase(vt.fulfilled,(t,n)=>{t.loading=!1,t.currentExhibition=n.payload}).addCase(vt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ai.pending,t=>{t.loading=!0,t.error=null}).addCase(ai.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions.push(n.payload)}).addCase(ai.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(li.pending,t=>{t.loading=!0,t.error=null}).addCase(li.fulfilled,(t,n)=>{t.loading=!1,t.currentExhibition=n.payload;const i=t.exhibitions.findIndex(r=>r.id===n.payload.id);i!==-1&&(t.exhibitions[i]=n.payload)}).addCase(li.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(qt.pending,t=>{t.loading=!0,t.error=null}).addCase(qt.fulfilled,(t,n)=>{t.loading=!1,t.halls=n.payload}).addCase(qt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(zt.pending,t=>{t.loading=!0,t.error=null}).addCase(zt.fulfilled,(t,n)=>{t.loading=!1;const i=n.payload.map(r=>{var o;return{...r,id:r._id||r.id,_id:r._id||r.id,stallTypeId:typeof r.stallTypeId=="string"?r.stallTypeId:(o=r.stallTypeId)==null?void 0:o._id,stallType:r.stallType||{name:"N/A",description:null}}});n.meta.arg.hallId,t.stalls=i}).addCase(zt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(an.pending,t=>{t.loading=!0,t.error=null}).addCase(an.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(i=>(i._id||i.id)!==n.payload)}).addCase(an.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ln.pending,t=>{t.loading=!0,t.error=null}).addCase(ln.fulfilled,(t,n)=>{t.loading=!1,t.fixtures=n.payload.map(i=>({...i,id:i._id||i.id,_id:i._id||i.id}))}).addCase(ln.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ci.pending,t=>{t.loading=!0,t.error=null}).addCase(ci.fulfilled,(t,n)=>{t.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id};t.fixtures.push(i)}).addCase(ci.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(di.pending,t=>{t.loading=!0,t.error=null}).addCase(di.fulfilled,(t,n)=>{t.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id},r=t.fixtures.findIndex(o=>o.id===i.id||o._id===i._id);r!==-1&&(t.fixtures[r]=i)}).addCase(di.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ui.pending,t=>{t.loading=!0,t.error=null}).addCase(ui.fulfilled,(t,n)=>{t.loading=!1,t.fixtures=t.fixtures.filter(i=>i.id!==n.payload&&i._id!==n.payload)}).addCase(ui.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearCurrentExhibition:mg,clearError:xg,clearStalls:gg,clearFixtures:fg}=jl.actions,Dp=jl.reducer,Ke=(s,t)=>{if(!s)return"";let i=`/exhibition/${s.slug||s._id||s.id}`;return t&&(i+=`/${t}`),i},Li=(s,t)=>s?`/exhibitions/${s.slug||s._id||s.id}`:"",{Title:Lp,Text:hs}=pe,{RangePicker:$p}=Os,Fp=()=>{const{message:s,modal:t}=st.useApp(),n=Ie(),i=Re(),{exhibitions:r,loading:o}=ge(m=>m.exhibition),[a,u]=l.useState([]),[y,d]=l.useState(!1),[f,x]=l.useState(!1),[h,R]=l.useState({status:[],dateRange:null,search:"",activeStatus:null}),[S,j]=l.useState("all"),{hasPermission:k}=Di();l.useEffect(()=>{i(It())},[i]);const v=l.useMemo(()=>{const m=r.length,B=r.filter(M=>M.status==="published").length,I=r.filter(M=>new Date(M.startDate)>new Date).length,w=r.filter(M=>M.status==="completed").length,D=r.filter(M=>M.isActive).length;return{total:m,active:B,upcoming:I,completed:w,activeCount:D}},[r]),T=async m=>{const B=m._id||m.id;try{d(!0),await i(an(B)).unwrap(),s.success("Exhibition deleted successfully")}catch(I){s.error(I.message||"Failed to delete exhibition")}finally{d(!1)}},A=async()=>{t.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ot,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsxs("strong",{children:[a.length," selected exhibitions"]}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(O,{onClick:()=>je.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(O,{danger:!0,type:"primary",onClick:async()=>{try{d(!0),await Promise.all(a.map(m=>i(an(m._id||m.id)).unwrap())),s.success(`Successfully deleted ${a.length} exhibitions`),u([])}catch(m){s.error(m.message||"Failed to delete some exhibitions")}finally{d(!1),je.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},c=async(m,B)=>{try{x(!0);const I=m._id||m.id;await Fe.updateExhibition(I,{status:B});const w=r.map(D=>(D._id||D.id)===I?{...D,status:B}:D);i(It.fulfilled(w,"",void 0)),s.success("Status updated successfully")}catch{s.error("Failed to update status"),i(It())}finally{x(!1)}},p=async(m,B)=>{try{x(!0);const I=m._id||m.id;await Fe.updateExhibition(I,{isActive:B});const w=r.map(D=>(D._id||D.id)===I?{...D,isActive:B}:D);i(It.fulfilled(w,"",void 0)),s.success(`Exhibition ${B?"activated":"deactivated"} successfully`)}catch{s.error("Failed to update active status"),i(It())}finally{x(!1)}},_=(m,B)=>{const I=m._id||m.id;B==="/layout"?n(Ke(m,"layout"),{state:{exhibitionId:I}}):n(Ke(m)+B,{state:{exhibitionId:I}})},N=m=>{switch(m.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},g=(m,B)=>{const I=N(m);return e.jsxs(J,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[e.jsx(le,{color:I,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:m}),!B&&e.jsx(le,{color:"red",style:{margin:0},children:"Inactive"})]})},$=m=>{const B=new Date,I=new Date(m.startDate),w=new Date(m.endDate);if(B<I)return 0;if(B>w)return 100;const D=w.getTime()-I.getTime(),M=B.getTime()-I.getTime();return Math.round(M/D*100)},b=m=>{t.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ot,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsx("strong",{children:m.name}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(O,{onClick:()=>je.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(O,{danger:!0,type:"primary",onClick:()=>{T(m),je.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},C=m=>[{key:"view",label:"View Details",icon:e.jsx(Xt,{}),onClick:()=>_(m,"")},{key:"edit",label:"Edit Exhibition",icon:e.jsx(Ms,{}),onClick:()=>_(m,"/edit")},{key:"layout",label:"Manage Layout",icon:e.jsx(Ss,{}),onClick:()=>_(m,"/layout")},{type:"divider"},...m.status==="published"?[{key:"public-view",label:"Public View",icon:e.jsx(Xt,{}),onClick:()=>window.open(Li(m),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:e.jsx(Ii,{}),children:[{key:"draft",label:e.jsxs(J,{children:[e.jsx(le,{color:"#faad14",style:{margin:0},children:"Draft"}),e.jsx("span",{children:"Set as Draft"})]}),icon:e.jsx(Jt,{}),onClick:()=>c(m,"draft"),disabled:m.status==="draft"||f},{key:"published",label:e.jsxs(J,{children:[e.jsx(le,{color:"#52c41a",style:{margin:0},children:"Published"}),e.jsx("span",{children:"Publish"})]}),icon:e.jsx(Be,{}),onClick:()=>c(m,"published"),disabled:m.status==="published"||f},{key:"completed",label:e.jsxs(J,{children:[e.jsx(le,{color:"#1890ff",style:{margin:0},children:"Completed"}),e.jsx("span",{children:"Mark as Completed"})]}),icon:e.jsx(et,{}),onClick:()=>c(m,"completed"),disabled:m.status==="completed"||f}]},{key:"active-status",label:e.jsxs(J,{children:[m.isActive?e.jsx(le,{color:"red",style:{margin:0},children:"Deactivate"}):e.jsx(le,{color:"#52c41a",style:{margin:0},children:"Activate"}),e.jsx("span",{children:m.isActive?"Deactivate":"Activate"})]}),icon:e.jsx(lo,{}),onClick:()=>p(m,!m.isActive),disabled:f},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(ot,{}),danger:!0,onClick:()=>b(m)}],E=l.useMemo(()=>r.filter(m=>{if(h.search&&!m.name.toLowerCase().includes(h.search.toLowerCase())||h.status.length>0&&!h.status.includes(m.status)||h.activeStatus!==null&&m.isActive!==h.activeStatus)return!1;if(h.dateRange){const[B,I]=h.dateRange,w=new Date(m.startDate),D=new Date(m.endDate);if(w<new Date(B)||D>new Date(I))return!1}switch(S){case"active":return m.status==="published";case"upcoming":return new Date(m.startDate)>new Date;case"completed":return m.status==="completed";default:return!0}}),[r,h,S]),P=[{title:"Exhibition Details",key:"details",render:(m,B)=>e.jsx(hs,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>_(B,""),children:B.name})},{title:"Status",key:"status",width:180,align:"center",render:(m,B)=>g(B.status,B.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(m,B)=>B.status===m},{title:"Start Date",key:"startDate",width:130,render:(m,B)=>e.jsx(hs,{children:Ae(B.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(m,B)=>e.jsx(hs,{children:Ae(B.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(m,B)=>e.jsx(hs,{children:Ae(B.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(m,B)=>e.jsx(Tt,{percent:$(B),size:"small",status:B.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(m,B)=>e.jsxs(J,{size:"middle",children:[k("exhibitions_view")&&e.jsx(_e,{title:"View Details",children:e.jsx(O,{type:"text",icon:e.jsx(Xt,{}),onClick:()=>_(B,"")})}),k("exhibitions_edit")&&e.jsx(_e,{title:"Edit Exhibition",children:e.jsx(O,{type:"text",icon:e.jsx(Ms,{}),onClick:()=>_(B,"/edit")})}),k("exhibitions_delete")&&e.jsx(vs,{menu:{items:C(B)},trigger:["click"],placement:"bottomRight",children:e.jsx(O,{type:"text",icon:e.jsx(Vr,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(F,{flex:"auto",children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(Lp,{level:4,style:{margin:0},children:"Exhibitions"}),e.jsx(hs,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),e.jsx(F,{children:e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:()=>n("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginBottom:"24px"},children:[e.jsx(F,{xs:24,sm:12,md:6,lg:4,children:e.jsx(K,{children:e.jsx(ke,{title:"Total Exhibitions",value:v.total,prefix:e.jsx(Jt,{})})})}),e.jsx(F,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ke,{title:"Published Exhibitions",value:v.active,prefix:e.jsx(Be,{style:{color:"#52c41a"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ke,{title:"Upcoming Exhibitions",value:v.upcoming,prefix:e.jsx(et,{style:{color:"#1890ff"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ke,{title:"Completed Exhibitions",value:v.completed,prefix:e.jsx(Be,{style:{color:"#8c8c8c"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(ke,{title:"Active Status",value:v.activeCount,prefix:e.jsx(lo,{style:{color:"#52c41a"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:e.jsxs(J,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(F,{flex:"auto",children:e.jsxs(J,{size:"middle",wrap:!0,children:[e.jsx(G,{placeholder:"Search exhibitions",prefix:e.jsx(os,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:h.search,onChange:m=>R(B=>({...B,search:m.target.value})),allowClear:!0}),e.jsx(de,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:h.status,onChange:m=>R(B=>({...B,status:m})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),e.jsxs(de,{placeholder:"Active Status",style:{width:"150px"},value:h.activeStatus,onChange:m=>R(B=>({...B,activeStatus:m})),allowClear:!0,children:[e.jsx(de.Option,{value:!0,children:"Active"}),e.jsx(de.Option,{value:!1,children:"Inactive"})]}),e.jsx($p,{onChange:m=>R(B=>{var I,w;return{...B,dateRange:m?[((I=m[0])==null?void 0:I.toISOString())||"",((w=m[1])==null?void 0:w.toISOString())||""]:null}})})]})}),e.jsx(F,{children:e.jsx(Vl,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:S,onChange:m=>j(m)})})]}),a.length>0&&e.jsx(ie,{children:e.jsxs(J,{children:[e.jsxs(hs,{children:["Selected ",a.length," items"]}),e.jsx(O,{danger:!0,onClick:A,children:"Delete Selected"})]})})]})}),e.jsx(K,{className:"info-card",styles:{body:{padding:0}},children:e.jsx(Ne,{columns:P,dataSource:E.map(m=>({...m,key:m._id||m.id})),rowKey:m=>m._id||m.id,loading:o||y||f,rowSelection:{selectedRowKeys:a.map(m=>m._id||m.id),onChange:(m,B)=>u(B),selections:[Ne.SELECTION_ALL,Ne.SELECTION_NONE]},footer:()=>a.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[e.jsxs(hs,{children:["Selected ",e.jsx("strong",{children:a.length})," ",a.length===1?"exhibition":"exhibitions"]}),e.jsx(O,{danger:!0,onClick:A,icon:e.jsx(ot,{}),loading:y,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:m=>`Total ${m} items`,style:{marginTop:"16px"}}})})]})},Ls={getStallTypes:async()=>ne.get("/stall-types"),createStallType:async s=>ne.post("/stall-types",s),updateStallType:async(s,t)=>ne.put(`/stall-types/${s}`,t),deleteStallType:async s=>ne.delete(`/stall-types/${s}`)},{RangePicker:Bp}=Os,{Title:Qt,Text:Gt}=pe,Jo=({value:s="",onChange:t})=>{const n=De.useRef(null),[i]=De.useState(s);return e.jsx(Ec,{apiKey:_d,onInit:(r,o)=>{n.current=o},value:s,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:r=>{r.on("init",()=>{r.undoManager.clear(),r.undoManager.add()}),r.on("change",()=>{r.undoManager.add()})}},onEditorChange:r=>{t==null||t(r)}})},Mp=({form:s})=>{const[t,n]=l.useState([]),[i,r]=l.useState(!1);return l.useEffect(()=>{(async()=>{try{r(!0);const a=await Ls.getStallTypes();n(a.data.filter(u=>u.status==="active"))}catch(a){console.error("Failed to fetch stall types:",a)}finally{r(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(Qt,{level:4,children:"Basic Information"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:e.jsx(G,{placeholder:"Enter exhibition name"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:e.jsx(G.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:e.jsx(G,{placeholder:"Enter invoice prefix (default: INV)"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:e.jsx(Bp,{style:{width:"100%"}})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Qt,{level:4,children:"Company Details"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(F,{span:12,children:[e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{placeholder:"Enter company name"})}),e.jsx(L.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:e.jsx(G,{placeholder:"Enter contact number"})}),e.jsx(L.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Enter email address"})}),e.jsx(L.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter company address"})}),e.jsx(L.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:e.jsx(Jo,{})})]}),e.jsxs(F,{span:12,children:[e.jsx(L.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:e.jsx(G,{placeholder:"Enter PAN number"})}),e.jsx(L.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:e.jsx(G,{placeholder:"Enter GST number"})}),e.jsx(L.Item,{name:"companySAC",label:"SAC Code No.",children:e.jsx(G,{placeholder:"Enter SAC code number"})}),e.jsx(L.Item,{name:"companyCIN",label:"CIN No.",children:e.jsx(G,{placeholder:"Enter CIN number"})}),e.jsx(L.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:e.jsx(G,{placeholder:"Enter website URL"})}),e.jsx(L.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:e.jsx(Jo,{})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Qt,{level:4,children:"Bank Details"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(F,{span:12,children:[e.jsx(L.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:e.jsx(G,{placeholder:"Enter bank name"})}),e.jsx(L.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:e.jsx(G,{placeholder:"Enter branch name"})}),e.jsx(L.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:e.jsx(G,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),e.jsxs(F,{span:12,children:[e.jsx(L.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:e.jsx(G,{placeholder:"Enter account name"})}),e.jsx(L.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:e.jsx(G,{placeholder:"Enter account number"})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Qt,{level:4,children:"Stall Rates & Pricing"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Qt,{level:5,children:"Stall Type Rates"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),e.jsx(L.List,{name:"stallRates",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:y,name:d,...f})=>e.jsxs(J,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...f,name:[d,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(de,{loading:i,placeholder:"Select stall type",style:{width:200},children:t.map(x=>e.jsx(de.Option,{value:x._id,children:x.name},x._id))})}),e.jsx(L.Item,{...f,name:[d,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:e.jsx(ze,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"",formatter:x=>`${x}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:x=>{const h=x?Number(x.replace(/\\s?|(,*)/g,"")):0;return isNaN(h)?0:h}})}),e.jsx(xs,{onClick:()=>u(d)})]},y)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Stall Type Rate"})})]})})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Qt,{level:5,children:"Tax Configuration"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),e.jsx(L.List,{name:"taxConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:y,name:d,...f})=>e.jsxs(J,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...f,name:[d,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:e.jsx(G,{placeholder:"Tax name",style:{width:150}})}),e.jsx(L.Item,{...f,name:[d,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:e.jsx(ze,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:x=>`${x}%`,parser:x=>{const h=x?Number(x.replace("%","")):0;return isNaN(h)?0:Math.min(h,100)}})}),e.jsx(L.Item,{...f,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(xs,{onClick:()=>u(d)})]},y)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Tax"})})]})})]}),e.jsxs("div",{children:[e.jsx(Qt,{level:5,children:"Admin Discount Configuration"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),e.jsx(L.List,{name:"discountConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:y,name:d,...f})=>e.jsxs(J,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...f,name:[d,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(G,{placeholder:"Discount",style:{width:150}})}),e.jsx(L.Item,{...f,name:[d,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(de,{style:{width:150},children:[e.jsx(de.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(de.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx(L.Item,{noStyle:!0,shouldUpdate:(x,h)=>{var R,S,j,k;return((S=(R=x==null?void 0:x.discountConfig)==null?void 0:R[d])==null?void 0:S.type)!==((k=(j=h==null?void 0:h.discountConfig)==null?void 0:j[d])==null?void 0:k.type)},children:({getFieldValue:x})=>{const h=x(["discountConfig",d,"type"]);return e.jsx(L.Item,{...f,name:[d,"value"],rules:[{required:!0,message:`Please enter ${h==="percentage"?"percentage":"amount"}`}],children:e.jsx(ze,{min:0,max:h==="percentage"?100:void 0,placeholder:h==="percentage"?"Percentage":"Amount",style:{width:150},formatter:R=>h==="percentage"?`${R}%`:`${R}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:R=>{const S=R?Number(R.replace(/[%,]/g,"")):0;return isNaN(S)?0:S}})})}}),e.jsx(L.Item,{...f,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(xs,{onClick:()=>u(d)})]},y)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Admin Discount"})})]})})]}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(Qt,{level:5,children:"Public Discount Configuration"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),e.jsx(L.List,{name:"publicDiscountConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:y,name:d,...f})=>e.jsxs(J,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(L.Item,{...f,name:[d,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(G,{placeholder:"Discount",style:{width:150}})}),e.jsx(L.Item,{...f,name:[d,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(de,{style:{width:150},children:[e.jsx(de.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(de.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx(L.Item,{noStyle:!0,shouldUpdate:(x,h)=>{var R,S,j,k;return((S=(R=x==null?void 0:x.publicDiscountConfig)==null?void 0:R[d])==null?void 0:S.type)!==((k=(j=h==null?void 0:h.publicDiscountConfig)==null?void 0:j[d])==null?void 0:k.type)},children:({getFieldValue:x})=>{const h=x(["publicDiscountConfig",d,"type"]);return e.jsx(L.Item,{...f,name:[d,"value"],rules:[{required:!0,message:`Please enter ${h==="percentage"?"percentage":"amount"}`}],children:e.jsx(ze,{min:0,max:h==="percentage"?100:void 0,placeholder:h==="percentage"?"Percentage":"Amount",style:{width:150},formatter:R=>h==="percentage"?`${R}%`:`${R}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:R=>{const S=R?Number(R.replace(/[%,]/g,"")):0;return isNaN(S)?0:S}})})}}),e.jsx(L.Item,{...f,name:[d,"isActive"],valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(xs,{onClick:()=>u(d)})]},y)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Public Discount"})})]})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Qt,{level:4,children:"Status Settings"}),e.jsx(Gt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(de,{children:[e.jsx(de.Option,{value:"draft",children:"Draft"}),e.jsx(de.Option,{value:"published",children:"Published"}),e.jsx(de.Option,{value:"completed",children:"Completed"})]})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:Zo,Text:er}=pe,zp=({form:s})=>{const{message:t}=st.useApp(),[n,i]=l.useState([]),[r,o]=l.useState([]),[a,u]=l.useState(0),[y,d]=l.useState({}),f=j=>{const k=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${j}`,token:k}};l.useEffect(()=>{const j=s.getFieldValue("headerLogo");if(j){const{url:k,token:v}=f(j);fetch(k,{headers:{authorization:`Bearer ${v}`}}).then(T=>T.blob()).then(T=>{const A=URL.createObjectURL(T);i([{uid:"-1",name:j.split("/").pop()||"logo",status:"done",url:A,thumbUrl:A,type:T.type,response:{path:j}}])}).catch(()=>{i([])})}},[s]),l.useEffect(()=>{const j=s.getFieldValue("sponsorLogos")||[];j.length>0&&Promise.all(j.map(async(k,v)=>{const{url:T,token:A}=f(k);try{const p=await(await fetch(T,{headers:{authorization:`Bearer ${A}`}})).blob(),_=URL.createObjectURL(p);return{uid:`-${v+1}`,name:k.split("/").pop()||`sponsor-${v+1}`,status:"done",url:_,thumbUrl:_,type:p.type,response:{path:k}}}catch{return null}})).then(k=>{o(k.filter(Boolean))})},[s]);const x={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(j){const{status:k,name:v,response:T,uid:A}=j.file;if(k==="uploading"){i([...j.fileList]);return}if(k==="done"&&T){const{url:c,token:p}=f(T.path);u(0),fetch(c,{headers:{authorization:`Bearer ${p}`}}).then(_=>_.blob()).then(_=>{const N=URL.createObjectURL(_);i([{uid:j.file.uid,name:v,status:"done",url:N,thumbUrl:N,type:_.type,response:T}]),t.success(`${v} uploaded successfully`),s.setFieldValue("headerLogo",T.path),T.thumbnail&&s.setFieldValue("headerLogoThumbnail",T.thumbnail)}).catch(()=>{t.error(`${v} preview failed to load`),i([])})}else k==="error"?(t.error(`${v} upload failed.`),i([]),u(0)):k==="removed"&&(i([]),s.setFieldValue("headerLogo",null),s.setFieldValue("headerLogoThumbnail",null),u(0))},customRequest:async j=>{const{onProgress:k,onSuccess:v,onError:T,file:A,action:c,headers:p}=j;try{const _=new FormData;_.append("file",A);const N=new XMLHttpRequest;N.open("POST",c||"",!0),p&&Object.keys(p).forEach(g=>{N.setRequestHeader(g,p[g])}),N.upload.onprogress=g=>{g.lengthComputable&&k&&(k({percent:g.loaded/g.total*100}),u(Math.round(g.loaded/g.total*100)))},N.onload=()=>{if(N.status>=200&&N.status<300)try{const g=JSON.parse(N.response);v==null||v(g,A),u(0)}catch(g){T==null||T(g)}else T==null||T(new Error("Upload failed"))},N.onerror=()=>{u(0),T==null||T(new Error("Upload request failed"))},N.send(_)}catch(_){u(0),T==null||T(_)}},onRemove(){return i([]),s.setFieldValue("headerLogo",null),s.setFieldValue("headerLogoThumbnail",null),u(0),!0},onPreview:async j=>{if(!j.url)return;const k=window.open("");k&&(k.document.write(`
          <img src="${j.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),k.document.head.innerHTML="<title>Image Preview</title>")}},h={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:r,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(j){const{status:k,name:v,response:T,uid:A}=j.file;if(k==="uploading"){o([...j.fileList]);return}if(k==="done"&&T&&T.paths&&T.paths.length>0){d(N=>{const g={...N};return delete g[A],g});const c=T.paths[0],{url:p,token:_}=f(c);fetch(p,{headers:{authorization:`Bearer ${_}`}}).then(N=>N.blob()).then(N=>{const g=URL.createObjectURL(N),$=[...r],b=$.findIndex(P=>P.uid===j.file.uid),C={uid:j.file.uid,name:v,status:"done",url:g,thumbUrl:g,type:N.type,response:{path:c}};b>-1?$[b]=C:$.push(C),o($),t.success(`${v} uploaded successfully`);const E=$.filter(P=>{var m;return P.status==="done"&&((m=P.response)==null?void 0:m.path)}).map(P=>P.response.path);if(s.setFieldValue("sponsorLogos",E),T.thumbnails&&T.thumbnails.length>0){const P=s.getFieldValue("sponsorLogoThumbnails")||[];s.setFieldValue("sponsorLogoThumbnails",[...P,...T.thumbnails])}}).catch(()=>{t.error(`${v} preview failed to load`),o(N=>N.filter(g=>g.uid!==j.file.uid))})}else k==="error"?(t.error(`${v} upload failed.`),o(c=>c.filter(p=>p.uid!==j.file.uid)),d(c=>{const p={...c};return delete p[A],p})):k==="removed"&&d(c=>{const p={...c};return delete p[A],p})},customRequest:async j=>{const{onProgress:k,onSuccess:v,onError:T,file:A,action:c,headers:p}=j,_=typeof A=="object"&&"uid"in A?A.uid:String(Date.now());try{const N=new FormData;N.append("file",A);const g=new XMLHttpRequest;g.open("POST",c||"",!0),p&&Object.keys(p).forEach($=>{g.setRequestHeader($,p[$])}),g.upload.onprogress=$=>{if($.lengthComputable&&k){const b=$.loaded/$.total*100;k({percent:b}),d(C=>({...C,[_]:Math.round(b)}))}},g.onload=()=>{if(g.status>=200&&g.status<300)try{const $=JSON.parse(g.response);v==null||v($,A),d(b=>{const C={...b};return delete C[_],C})}catch($){T==null||T($)}else T==null||T(new Error("Upload failed"))},g.onerror=()=>{d($=>{const b={...$};return delete b[_],b}),T==null||T(new Error("Upload request failed"))},g.send(N)}catch(N){d(g=>{const $={...g};return delete $[_],$}),T==null||T(N)}},onRemove(j){var A;const k=r.filter(c=>c.uid!==j.uid);o(k);const v=k.filter(c=>{var p;return c.status==="done"&&((p=c.response)==null?void 0:p.path)}).map(c=>c.response.path);s.setFieldValue("sponsorLogos",v);const T=s.getFieldValue("sponsorLogoThumbnails")||[];if(T.length>0&&(A=j.response)!=null&&A.path){const c=j.response.path.split("/"),p=c[c.length-1],_=T.filter(N=>!N.includes(p));s.setFieldValue("sponsorLogoThumbnails",_)}return d(c=>{const p={...c};return delete p[j.uid],p}),!0},onPreview:async j=>{if(!j.url)return;const k=window.open("");k&&(k.document.write(`
          <img src="${j.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),k.document.head.innerHTML="<title>Image Preview</title>")}},R=e.jsx("div",{children:a>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Tt,{type:"circle",percent:a,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hn,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),S=e.jsxs("div",{children:[e.jsx(hn,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return e.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:e.jsxs(K,{className:"settings-card",children:[e.jsx(Zo,{level:4,children:"Header Settings"}),e.jsx(er,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),e.jsxs(ie,{gutter:24,children:[e.jsx(F,{span:24,children:e.jsxs(L.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(un,{...x,children:n.length<1&&R}),n.length>0&&a>0&&e.jsx(Tt,{percent:a,status:"active",style:{marginTop:8}})]})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:e.jsx(G,{placeholder:"Enter a title for your exhibition header"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:e.jsx(G,{placeholder:"Enter a subtitle (optional)"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:e.jsx(G.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),e.jsxs(F,{span:24,children:[e.jsx(Te,{}),e.jsx(Zo,{level:5,children:"Sponsor Logos"}),e.jsx(er,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),e.jsxs(L.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[e.jsx(un,{...h,children:S}),Object.entries(y).map(([j,k])=>{var v;return e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[e.jsxs(er,{style:{marginRight:10,width:150},ellipsis:!0,children:[((v=r.find(T=>T.uid===j))==null?void 0:v.name)||"File",":"]}),e.jsx(Tt,{percent:k,status:"active",style:{flex:1}})]},j)})]})]})]})]})})},{Title:ea,Text:ta}=pe,qp=({form:s})=>{const{message:t}=st.useApp(),[n,i]=l.useState([]),r=a=>{const u=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${a}`,token:u}};l.useEffect(()=>{const a=s.getFieldValue("footerLogo");if(a){const{url:u,token:y}=r(a);fetch(u,{headers:{authorization:`Bearer ${y}`}}).then(d=>d.blob()).then(d=>{const f=URL.createObjectURL(d);i([{uid:"-1",name:a.split("/").pop()||"logo",status:"done",url:f,thumbUrl:f,type:d.type,response:{path:a}}])}).catch(()=>{i([])})}},[s]);const o={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:u,name:y,response:d}=a.file;if(u==="uploading"){i([...a.fileList]);return}if(u==="done"&&d){const{url:f,token:x}=r(d.path);fetch(f,{headers:{authorization:`Bearer ${x}`}}).then(h=>h.blob()).then(h=>{const R=URL.createObjectURL(h);i([{uid:a.file.uid,name:y,status:"done",url:R,thumbUrl:R,type:h.type,response:d}]),t.success(`${y} uploaded successfully`),s.setFieldValue("footerLogo",d.path)}).catch(()=>{t.error(`${y} preview failed to load`),i([])})}else u==="error"?(t.error(`${y} upload failed.`),i([])):u==="removed"&&(i([]),s.setFieldValue("footerLogo",null))},onRemove(){return i([]),s.setFieldValue("footerLogo",null),!0},onPreview:async a=>{if(!a.url)return;const u=window.open("");u&&(u.document.write(`
          <img src="${a.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),u.document.head.innerHTML="<title>Image Preview</title>")}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(ea,{level:4,children:"Footer Content"}),e.jsx(ta,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),e.jsxs(ie,{gutter:24,children:[e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:e.jsx(un,{...o,children:n.length<1&&e.jsxs("div",{children:[e.jsx(hn,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:e.jsx(G,{placeholder:"Enter contact email"})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:e.jsx(G,{placeholder:"Enter contact phone number"})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(ea,{level:4,children:"Footer Links"}),e.jsx(ta,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),e.jsx(L.List,{name:"footerLinks",children:(a,{add:u,remove:y})=>e.jsxs(e.Fragment,{children:[a.map(({key:d,name:f,...x})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(F,{span:11,children:e.jsx(L.Item,{...x,name:[f,"label"],rules:[{required:!0,message:"Please enter link label"}],children:e.jsx(G,{placeholder:"Link Label"})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{...x,name:[f,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:e.jsx(G,{placeholder:"URL (e.g., https://example.com)"})})}),e.jsx(F,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(xs,{onClick:()=>y(f)})})]},d)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>u(),block:!0,icon:e.jsx(lt,{}),children:"Add Footer Link"})})]})})]})]})},{Title:tr,Text:sr}=pe,{TabPane:sa}=at,Op=({form:s})=>e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(at,{defaultActiveKey:"basic",type:"card",children:[e.jsx(sa,{tab:"Basic Amenities",children:e.jsxs(K,{className:"settings-card",children:[e.jsx(tr,{level:4,children:"Basic Amenities"}),e.jsx(sr,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),e.jsx(L.List,{name:"basicAmenities",children:(t,{add:n,remove:i})=>e.jsxs(e.Fragment,{children:[t.map(({key:r,name:o,...a})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(F,{span:5,children:e.jsx(L.Item,{...a,name:[o,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(de,{placeholder:"Select type",children:[e.jsx(de.Option,{value:"facility",children:"Facility"}),e.jsx(de.Option,{value:"service",children:"Service"}),e.jsx(de.Option,{value:"equipment",children:"Equipment"}),e.jsx(de.Option,{value:"other",children:"Other"})]})})}),e.jsx(F,{span:6,children:e.jsx(L.Item,{...a,name:[o,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(G,{placeholder:"Enter name (e.g. Tables)"})})}),e.jsx(F,{span:6,children:e.jsx(L.Item,{...a,name:[o,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(G.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(F,{span:3,children:e.jsx(L.Item,{...a,name:[o,"perSqm"],label:e.jsxs(J,{children:["Per sqm",e.jsx(_e,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:e.jsx(Rt,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:e.jsx(ze,{style:{width:"100%"},placeholder:"9",min:1})})}),e.jsx(F,{span:3,children:e.jsx(L.Item,{...a,name:[o,"quantity"],label:e.jsxs(J,{children:["Quantity",e.jsx(_e,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:e.jsx(Rt,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:e.jsx(ze,{style:{width:"100%"},placeholder:"1",min:1})})}),e.jsx(F,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:e.jsx(xs,{onClick:()=>i(o)})})]},r)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>n({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:e.jsx(lt,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),e.jsx(sa,{tab:"Extra Amenities",children:e.jsxs(K,{className:"settings-card",children:[e.jsx(tr,{level:4,children:"Extra Amenities"}),e.jsx(sr,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),e.jsx(L.List,{name:"amenities",children:(t,{add:n,remove:i})=>e.jsxs(e.Fragment,{children:[t.map(({key:r,name:o,...a})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(F,{span:5,children:e.jsx(L.Item,{...a,name:[o,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(de,{placeholder:"Select type",children:[e.jsx(de.Option,{value:"facility",children:"Facility"}),e.jsx(de.Option,{value:"service",children:"Service"}),e.jsx(de.Option,{value:"equipment",children:"Equipment"}),e.jsx(de.Option,{value:"other",children:"Other"})]})})}),e.jsx(F,{span:6,children:e.jsx(L.Item,{...a,name:[o,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(G,{placeholder:"Enter name (e.g. Power)"})})}),e.jsx(F,{span:8,children:e.jsx(L.Item,{...a,name:[o,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(G.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(F,{span:4,children:e.jsx(L.Item,{...a,name:[o,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:e.jsx(ze,{style:{width:"100%"},placeholder:"Enter rate",prefix:"",min:0,formatter:u=>`${u}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:u=>{const y=u?Number(u.replace(/\\s?|(,*)/g,"")):0;return isNaN(y)?0:y}})})}),e.jsx(F,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(xs,{onClick:()=>i(o)})})]},r)),e.jsx(L.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>n({type:"service"}),block:!0,icon:e.jsx(lt,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(tr,{level:4,children:"Special Requirements"}),e.jsx(sr,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),e.jsx(ie,{gutter:24,children:e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),vl=({initialValues:s,onSubmit:t,submitText:n="Submit"})=>{const[i]=L.useForm(),r=a=>{t(a)},o=[{key:"general",label:"General",children:e.jsx(Mp,{form:i})},{key:"header",label:"Header",children:e.jsx(zp,{form:i})},{key:"footer",label:"Footer",children:e.jsx(qp,{form:i})},{key:"amenities",label:"Amenities",children:e.jsx(Op,{form:i})}];return e.jsx(L,{form:i,layout:"vertical",initialValues:s,onFinish:r,style:{height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,marginBottom:"24px"},children:e.jsx(at,{defaultActiveKey:"general",items:o,type:"card"})}),e.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:e.jsx(O,{type:"primary",htmlType:"submit",children:n})})]})})},Up=()=>{const s=Ie(),t=Re(),n=async i=>{var r,o;try{const[a,u]=i.dateRange,y={name:i.name,description:i.description,venue:i.venue,startDate:a.toISOString(),endDate:u.toISOString(),status:i.status||"draft",isActive:i.isActive??!0,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:{width:100,height:100},taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((r=i.amenities)==null?void 0:r.map(x=>({type:x.type,name:x.name,description:x.description,rate:x.rate})))||[],basicAmenities:((o=i.basicAmenities)==null?void 0:o.map(x=>({type:x.type,name:x.name,description:x.description,perSqm:x.perSqm,quantity:x.quantity})))||[],specialRequirements:i.specialRequirements},d=await t(ai(y)).unwrap();se.success("Exhibition created successfully");const f=d._id||d.id;f?s(Ke({_id:f,id:f,name:y.name}),{state:{exhibitionId:f}}):(se.error("Exhibition ID not found in response"),s("/exhibition"))}catch(a){se.error(a.message||"Failed to create exhibition"),console.error("Error creating exhibition:",a)}};return e.jsx(K,{title:"Create New Exhibition",children:e.jsx(vl,{onSubmit:n,submitText:"Create Exhibition"})})},{Title:na,Text:nt,Paragraph:nr}=pe,ir=()=>{const s=Ie();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>s("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Vp=()=>{const{id:s}=ft(),t=Ie(),n=Re(),{currentExhibition:i,halls:r,stalls:o,loading:a}=ge(j=>j.exhibition),[u,y]=l.useState(0);l.useEffect(()=>{s&&(n(vt(s)),n(qt(s)),n(zt({exhibitionId:s})))},[s,n]),l.useEffect(()=>{i&&f()},[i]);const d=()=>{if(!i)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const j=r.length||0;let k=o.length||0,v=o.filter(T=>T.status==="booked"||T.status==="reserved").length;return k===0&&(i.stalls&&i.stalls.length>0?(k=i.stalls.length,v=i.stalls.filter(T=>T.status==="booked"||T.status==="reserved").length):(k=i.stallCount||0,v=i.bookedStallCount||0)),{hallCount:j,stallCount:k,bookedStallCount:v,availableStallCount:k-v}},f=()=>{if(!i)return 0;const j=new Date,k=new Date(i.startDate),v=new Date(i.endDate);if(j<k)return y(0);if(j>v)return y(100);const T=v.getTime()-k.getTime(),A=j.getTime()-k.getTime();y(Math.round(A/T*100))},x=j=>{switch(j.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},h=()=>{if(!i)return{text:"",count:0,isPast:!1};const j=new Date,k=new Date(i.startDate),v=new Date(i.endDate);return j>v?{text:"Ended",count:Math.ceil((j.getTime()-v.getTime())/864e5),isPast:!0}:j>=k&&j<=v?{text:"Days Remaining",count:Math.ceil((v.getTime()-j.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((k.getTime()-j.getTime())/(1e3*60*60*24)),isPast:!1}},R=j=>{t(Ke(i,j))};if(a)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ir,{}),e.jsx(K,{children:e.jsx(Ft,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!i)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ir,{}),e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(Rt,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx(na,{level:4,children:"Exhibition not found"}),e.jsx(nr,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const S=h();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(ir,{}),e.jsx(K,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsxs(F,{xs:24,md:16,children:[e.jsx(na,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:i.name}),e.jsx(nr,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:i.description}),e.jsxs(J,{split:e.jsx(Te,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(J,{children:[e.jsx(Et,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(nt,{style:{color:"rgba(255,255,255,0.8)"},children:[Ae(i.startDate).format("MMM D, YYYY")," - ",Ae(i.endDate).format("MMM D, YYYY")]})]}),i.venue&&e.jsxs(J,{children:[e.jsx(ys,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(nt,{style:{color:"rgba(255,255,255,0.8)"},children:i.venue})]})]})]}),e.jsx(F,{xs:24,md:8,children:e.jsxs(K,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:x(i.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:i.status.toUpperCase()}),e.jsx(ke,{title:S.text,value:S.count,suffix:"days",valueStyle:{color:S.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(et,{})}),e.jsx(Te,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(nt,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(Tt,{percent:u,status:u===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(F,{xs:24,sm:8,children:e.jsx(O,{type:"primary",icon:e.jsx(Ss,{}),onClick:()=>R(`${s}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(F,{xs:24,sm:8,children:e.jsx(O,{icon:e.jsx(Ms,{}),onClick:()=>R(`${s}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(F,{xs:24,sm:8,children:e.jsx(O,{icon:e.jsx(Xt,{}),onClick:()=>window.open(Li(i),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:i.status!=="published",children:"View Public Page"})})]}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:24,lg:16,children:e.jsxs(K,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsxs(F,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(nt,{strong:!0,style:{fontSize:"16px"},children:Ae(i.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(nt,{strong:!0,style:{fontSize:"16px"},children:Ae(i.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(nt,{strong:!0,style:{fontSize:"16px"},children:Ae(i.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(F,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(le,{color:x(i.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(le,{color:i.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.isActive?"ACTIVE":"INACTIVE"})]}),i.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(nt,{strong:!0,style:{fontSize:"16px"},children:i.venue})]})]})]}),e.jsx(Te,{}),e.jsxs("div",{children:[e.jsx(nt,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(nr,{children:i.description||"No description provided."})]})]})}),e.jsxs(F,{xs:24,lg:8,children:[e.jsx(K,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:e.jsxs(ie,{gutter:[16,24],children:[e.jsx(F,{span:12,children:e.jsx(ke,{title:"Halls",value:d().hallCount,prefix:e.jsx(bn,{})})}),e.jsx(F,{span:12,children:e.jsx(ke,{title:"Stalls",value:d().stallCount,prefix:e.jsx(ut,{})})}),e.jsx(F,{span:12,children:e.jsx(ke,{title:"Booked Stalls",value:d().bookedStallCount,prefix:e.jsx(Be,{})})}),e.jsx(F,{span:12,children:e.jsx(ke,{title:"Available Stalls",value:d().availableStallCount,prefix:e.jsx(Hl,{})})})]})}),e.jsx(K,{title:"Created By",style:{borderRadius:"12px"},children:i.createdBy?e.jsxs(J,{children:[e.jsx(wt,{icon:e.jsx(Pe,{})}),e.jsx(nt,{children:i.createdByName||"Administrator"})]}):e.jsx(nt,{type:"secondary",children:"Information not available"})})]})]})]})},Hp=()=>{var R;const{message:s}=st.useApp(),{id:t}=ft(),i=(R=Zt().state)==null?void 0:R.exhibitionId,r=Ie(),o=Re(),{currentExhibition:a,loading:u,error:y}=ge(S=>S.exhibition),[d,f]=l.useState(!1);l.useEffect(()=>{(async()=>{if(!i){s.error("Exhibition ID not found"),r("/exhibition");return}try{await o(vt(i)).unwrap()}catch(j){s.error(j.message||"Failed to fetch exhibition"),r("/exhibition")}finally{f(!0)}})()},[i,o,s,r]),l.useEffect(()=>{y&&s.error(y)},[y,s]);const x=async S=>{var j,k;if(!(!i||!a))try{const[v,T]=S.dateRange,A={name:S.name,description:S.description,venue:S.venue,startDate:v.toISOString(),endDate:T.toISOString(),status:S.status,isActive:S.isActive,invoicePrefix:S.invoicePrefix,stallRates:S.stallRates||[],dimensions:a.dimensions,taxConfig:S.taxConfig||[],discountConfig:S.discountConfig||[],publicDiscountConfig:S.publicDiscountConfig||[],companyName:S.companyName,companyContactNo:S.companyContactNo,companyEmail:S.companyEmail,companyAddress:S.companyAddress,companyWebsite:S.companyWebsite,companyPAN:S.companyPAN,companyGST:S.companyGST,companySAC:S.companySAC,companyCIN:S.companyCIN,termsAndConditions:S.termsAndConditions,piInstructions:S.piInstructions,bankName:S.bankName,bankBranch:S.bankBranch,bankIFSC:S.bankIFSC,bankAccountName:S.bankAccountName,bankAccount:S.bankAccount,headerTitle:S.headerTitle,headerSubtitle:S.headerSubtitle,headerDescription:S.headerDescription,headerLogo:S.headerLogo,sponsorLogos:S.sponsorLogos||[],footerText:S.footerText,footerLogo:S.footerLogo,contactEmail:S.contactEmail,contactPhone:S.contactPhone,footerLinks:S.footerLinks||[],amenities:((j=S.amenities)==null?void 0:j.map(c=>({type:c.type,name:c.name,description:c.description,rate:c.rate})))||[],basicAmenities:((k=S.basicAmenities)==null?void 0:k.map(c=>({type:c.type,name:c.name,description:c.description,perSqm:c.perSqm,quantity:c.quantity})))||[],specialRequirements:S.specialRequirements};await o(li({id:i,data:A})).unwrap(),s.success("Exhibition updated successfully"),r(Ke(a),{state:{exhibitionId:i}})}catch(v){s.error(v.message||"Failed to update exhibition")}};if(!d)return e.jsx(K,{loading:!0});if(!i)return e.jsx(Ei,{to:"/exhibition",replace:!0});if(u||!a)return e.jsx(K,{loading:!0});const h={name:a.name,description:a.description,venue:a.venue,dateRange:[Ae(a.startDate),Ae(a.endDate)],status:a.status,isActive:a.isActive,invoicePrefix:a.invoicePrefix,stallRates:a.stallRates||[],taxConfig:a.taxConfig||[],discountConfig:a.discountConfig||[],publicDiscountConfig:a.publicDiscountConfig||[],companyName:a.companyName,companyContactNo:a.companyContactNo,companyEmail:a.companyEmail,companyAddress:a.companyAddress,companyWebsite:a.companyWebsite,companyPAN:a.companyPAN,companyGST:a.companyGST,companySAC:a.companySAC,companyCIN:a.companyCIN,termsAndConditions:a.termsAndConditions,piInstructions:a.piInstructions,bankName:a.bankName,bankBranch:a.bankBranch,bankIFSC:a.bankIFSC,bankAccountName:a.bankAccountName,bankAccount:a.bankAccount,headerTitle:a.headerTitle,headerSubtitle:a.headerSubtitle,headerDescription:a.headerDescription,headerLogo:a.headerLogo,sponsorLogos:a.sponsorLogos||[],footerText:a.footerText,footerLogo:a.footerLogo,contactEmail:a.contactEmail,contactPhone:a.contactPhone,footerLinks:a.footerLinks||[],amenities:a.amenities||[],basicAmenities:a.basicAmenities||[],specialRequirements:a.specialRequirements};return e.jsx(K,{title:"Edit Exhibition",extra:e.jsx("a",{onClick:()=>r(Ke(a),{state:{exhibitionId:i}}),children:"Back to Details"}),children:e.jsx(vl,{initialValues:h,onSubmit:x,submitText:"Update Exhibition"})})},ia=({width:s,height:t,scale:n=1,position:i={x:0,y:0},isSelected:r=!1,onSelect:o=()=>{},onChange:a=()=>{},children:u,isEditable:y=!0})=>{const d=x=>{y&&(o(),x.cancelBubble=!0)},f=De.useMemo(()=>{const x=[];for(let R=0;R<=s;R+=5)x.push(e.jsx(vi,{points:[R,0,R,t],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`v${R}`));for(let R=0;R<=t;R+=5)x.push(e.jsx(vi,{points:[0,R,s,R],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`h${R}`));return x},[s,t,n]);return e.jsxs(zs,{x:i.x,y:i.y,width:s,height:t,onClick:d,children:[e.jsx(Ai,{width:s,height:t,fill:"#ffffff",stroke:r&&y?"#1890ff":"#d9d9d9",strokeWidth:r&&y?2/n:1/n,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/n,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/n}),e.jsx(zs,{children:f}),e.jsx(xn,{text:`${s}m  ${t}m`,fontSize:14/n,fill:"#666666",x:5,y:5}),u]})},Wp=({visible:s,width:t,height:n,onCancel:i,onSubmit:r})=>{const[o]=L.useForm();De.useEffect(()=>{s&&o.setFieldsValue({width:t,height:n})},[s,t,n,o]);const a=()=>{o.validateFields().then(u=>{r(u),o.resetFields()})};return e.jsx(je,{title:"Edit Exhibition Space",open:s,onCancel:()=>{o.resetFields(),i()},onOk:a,destroyOnClose:!0,children:e.jsxs(L,{form:o,layout:"vertical",initialValues:{width:t,height:n},children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},wl=({hall:s,isSelected:t=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:u=100,isStallMode:y=!1})=>{const d=De.useRef(null),f=De.useRef(null),x=De.useMemo(()=>{const v=[],{width:T,height:A}=s.dimensions,c=1;for(let p=0;p<=T;p+=c)v.push(e.jsx(vi,{points:[p,0,p,A],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`v${p}`));for(let p=0;p<=A;p+=c)v.push(e.jsx(vi,{points:[0,p,T,p],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`h${p}`));return v},[s.dimensions.width,s.dimensions.height,r]);De.useEffect(()=>{var v;t&&f.current&&d.current&&(f.current.nodes([d.current]),(v=f.current.getLayer())==null||v.batchDraw())},[t]);const h=v=>{v.cancelBubble=!0;const T=v.target,A=T.x(),c=T.y(),p=Math.max(0,Math.min(A,a-s.dimensions.width)),_=Math.max(0,Math.min(c,u-s.dimensions.height));T.x(Math.round(p)),T.y(Math.round(_))},R=v=>{v.cancelBubble=!0;const T=v.target,A=Math.max(0,Math.min(T.x(),a-s.dimensions.width)),c=Math.max(0,Math.min(T.y(),u-s.dimensions.height));i==null||i({...s,_id:s._id,id:s.id||s._id,exhibitionId:s.exhibitionId,dimensions:{...s.dimensions,x:Math.round(A),y:Math.round(c)}})},S=v=>{v.cancelBubble=!0},j=v=>{if(!d.current)return;const T=d.current,A=T.scaleX(),c=T.scaleY();T.scaleX(1),T.scaleY(1);const p=Math.round(T.width()*A),_=Math.round(T.height()*c),N=T.x(),g=T.y(),$=Math.max(0,Math.min(N,a-p)),b=Math.max(0,Math.min(g,u-_));i==null||i({...s,_id:s._id,id:s.id||s._id,exhibitionId:s.exhibitionId,dimensions:{x:$,y:b,width:Math.max(5,Math.min(p,a-$)),height:Math.max(5,Math.min(_,u-b))}})},k=v=>{v.cancelBubble=!0,n==null||n(s)};return e.jsxs(zs,{ref:d,x:s.dimensions.x,y:s.dimensions.y,width:s.dimensions.width,height:s.dimensions.height,draggable:!y&&!!i,onClick:k,onTap:k,onDragStart:S,onDragMove:h,onDragEnd:R,onTransformEnd:j,children:[e.jsx(Ai,{width:s.dimensions.width,height:s.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}),e.jsx(zs,{children:x}),e.jsx(xn,{text:s.name,fontSize:14/r,fill:"#000000",width:s.dimensions.width,align:"center",y:s.dimensions.height/2-7/r})]})},Yp=s=>{if(!s)return"";const t=window.location.origin,n=s.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${t}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${n}?token=${i}`:""},Sl=({fixture:s,isSelected:t=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:u=100,isEditable:y=!0})=>{const d=De.useRef(null),f=De.useRef(null),[x,h]=l.useState("");l.useEffect(()=>{if(s.icon){const c=Yp(s.icon);h(c)}else h("")},[s.icon]);const[R]=Ac(x);De.useEffect(()=>{var c;t&&f.current&&d.current&&(f.current.nodes([d.current]),(c=f.current.getLayer())==null||c.batchDraw())},[t]);const S=c=>{c.cancelBubble=!0},j=c=>{c.cancelBubble=!0;const p=c.target,_=p.x(),N=p.y(),g=Math.max(0,Math.min(_,a-s.dimensions.width)),$=Math.max(0,Math.min(N,u-s.dimensions.height));p.x(Math.round(g)),p.y(Math.round($))},k=c=>{c.cancelBubble=!0;const p=c.target,_=p.x(),N=p.y(),g=Math.max(0,Math.min(_,a-s.dimensions.width)),$=Math.max(0,Math.min(N,u-s.dimensions.height)),b=s._id||s.id;i==null||i({...s,_id:b,id:b,exhibitionId:s.exhibitionId,position:{x:Math.round(g),y:Math.round($)}})},v=c=>{if(!d.current)return;const p=d.current,_=p.scaleX(),N=p.scaleY(),g=p.rotation();p.scaleX(1),p.scaleY(1);const $=Math.round(s.dimensions.width*_),b=Math.round(s.dimensions.height*N),C=p.x(),E=p.y(),P=Math.max(0,Math.min(C,a-$)),m=Math.max(0,Math.min(E,u-b)),B=s._id||s.id;i==null||i({...s,_id:B,id:B,exhibitionId:s.exhibitionId,position:{x:P,y:m},dimensions:{width:Math.max(.5,Math.min($,a-P)),height:Math.max(.5,Math.min(b,u-m))},rotation:g})},T=c=>{c.cancelBubble=!0,n==null||n(s)},A=()=>{const c=s.borderColor||(t?"#1890ff":"#d9d9d9"),p=s.borderRadius!==void 0?s.borderRadius/r:3/r;return R?e.jsx(Nc,{image:R,width:s.dimensions.width,height:s.dimensions.height,fill:s.color||"#ffffff",stroke:c,strokeWidth:t?2/r:1/r,cornerRadius:p,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}):e.jsx(Ai,{width:s.dimensions.width,height:s.dimensions.height,fill:s.color||"#f0f2f5",stroke:c,strokeWidth:t?2/r:1/r,cornerRadius:p,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5})};return e.jsxs(e.Fragment,{children:[e.jsxs(zs,{ref:d,x:s.position.x,y:s.position.y,width:s.dimensions.width,height:s.dimensions.height,rotation:s.rotation||0,draggable:y&&!!i,onClick:T,onTap:T,onDragStart:S,onDragMove:j,onDragEnd:k,onTransformEnd:v,children:[A(),s.name&&s.showName!==!1&&e.jsx(xn,{text:s.name,fontSize:12/r,fill:"#000000",width:s.dimensions.width,align:"center",y:-16/r})]}),t&&y&&e.jsx(Tc,{ref:f,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(c,p)=>p.width<.5||p.height<.5?c:p})]})},Qp=({visible:s,x:t,y:n,onExhibitionClick:i,onHallClick:r,onStallClick:o,onFixtureClick:a,onClose:u})=>{if(!s)return null;const y=[{key:"exhibition",icon:e.jsx(Ss,{}),label:"Exhibition Space",onClick:()=>{i(),u()}},{key:"hall",icon:e.jsx(bn,{}),label:"Add Hall",onClick:()=>{r(),u()}}];return o&&y.push({key:"stall",icon:e.jsx(ut,{}),label:"Add Stall",onClick:()=>{o(),u()}}),a&&y.push({key:"fixture",icon:e.jsx(Br,{}),label:"Add Fixture",onClick:()=>{a(),u()}}),e.jsx("div",{style:{position:"fixed",top:n,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:e.jsx(jt,{items:y})})},Gp=({stall:s,isSelected:t=!1,onSelect:n,onChange:i,hallWidth:r=0,hallHeight:o=0,hallX:a=0,hallY:u=0,scale:y=1,isDragging:d=!1})=>{const f=l.useRef(null),[x,h]=l.useState(!1),[R,S]=l.useState(!1),[j,k]=l.useState(!1);l.useEffect(()=>{k(window.innerWidth<768);const B=()=>{k(window.innerWidth<768)};return window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),l.useEffect(()=>{if(x&&!d)S(!0);else if(d)S(!1);else{const B=setTimeout(()=>{S(!1)},100);return()=>clearTimeout(B)}},[x,d]),l.useEffect(()=>{if(x&&f.current&&!d){if(j&&!t)return;f.current.getStage()&&f.current.moveToTop()}},[x,t,j,d]);const v=t||s.isSelected,T=l.useCallback(B=>{switch(B){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),A=l.useCallback(B=>{switch(B){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),c=l.useCallback(B=>{B.cancelBubble=!0;const I=B.target,w=I.x()-a,D=I.y()-u,M=Math.max(0,Math.min(w,r-s.dimensions.width)),V=Math.max(0,Math.min(D,o-s.dimensions.height));I.x(Math.round(M+a)),I.y(Math.round(V+u))},[a,u,r,o,s.dimensions.width,s.dimensions.height]),p=l.useCallback(B=>{if(B.cancelBubble=!0,!i)return;const I=B.target,w=I.x()-a,D=I.y()-u,M=Math.max(0,Math.min(w,r-s.dimensions.width)),V=Math.max(0,Math.min(D,o-s.dimensions.height));i({...s,id:s.id||s._id,_id:s._id||s.id,dimensions:{...s.dimensions,x:Math.round(M),y:Math.round(V)}})},[i,a,u,r,o,s]),_=l.useCallback(B=>{B.cancelBubble=!0},[]),N=l.useCallback(B=>{B.cancelBubble=!0,n&&!d&&n()},[n,d]),g=l.useCallback(()=>{j&&!v||d||h(!0)},[j,v,d]),$=l.useCallback(()=>{h(!1)},[]),b={x:0,y:0,width:10,height:10},C=s.dimensions||b,E=s.typeName||"Standard";s.ratePerSqm*C.width*C.height;const P=0,m=l.useMemo(()=>s.status!=="available"&&s.companyName?`${E} - ${C.width}${C.height}m - ${s.companyName}`:`${E} - ${C.width}${C.height}m`,[E,C.width,C.height,s.status,s.companyName]);return e.jsxs(zs,{ref:f,x:C.x+a,y:C.y+u,width:C.width,height:C.height,draggable:!!i,onClick:N,onTap:N,onDragStart:_,onDragMove:c,onDragEnd:p,opacity:s.status==="available"?1:.7,cursor:s.status==="available"?"pointer":"default",onMouseEnter:g,onMouseLeave:$,listening:d?!1:!j||s.status==="available",transformsEnabled:d||j?"position":"all",children:[e.jsx(Ai,{width:C.width,height:C.height,fill:v?"rgba(24, 144, 255, 0.1)":A(s.status),stroke:v?"#1890ff":T(s.status),strokeWidth:v?2/y:1/y,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:d?0:j?2:3,shadowOffset:{x:1,y:1},shadowOpacity:d?0:.3,rotation:P,perfectDrawEnabled:!d,transformsEnabled:d?"position":"all",cornerRadius:.05}),e.jsx(xn,{text:s.number,fontSize:Math.min(C.width,C.height)*.25,fill:"#000000",width:C.width,height:C.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!d,fontStyle:"bold",listening:!1}),v&&!d&&e.jsx(Pc,{x:C.width-2,y:2,radius:Math.min(.8,C.width*.05),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/y,transformsEnabled:"position",listening:!1}),R&&!d&&e.jsxs(Rc,{x:C.width/2,y:0,opacity:1,listening:!1,children:[e.jsx(_c,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),e.jsx(xn,{text:m,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(m.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},oo=l.memo(Gp),Sn=({width:s,height:t,exhibitionWidth:n=100,exhibitionHeight:i=100,halls:r=[],stalls:o=[],fixtures:a=[],selectedHall:u=null,selectedFixture:y=null,onSelectHall:d=()=>{},onSelectFixture:f=()=>{},onHallChange:x=()=>{},onFixtureChange:h=()=>{},onExhibitionChange:R=()=>{},onAddHall:S=()=>{},onAddStall:j=()=>{},onAddFixture:k=()=>{},children:v,isStallMode:T=!1,isFixtureMode:A=!1,isPublicView:c=!1})=>{const p=l.useRef(null),_=l.useRef(null),N=l.useRef(null),[g,$]=l.useState(1),[b,C]=l.useState({x:0,y:0}),[E,P]=l.useState(!1),[m,B]=l.useState(!1),[I,w]=l.useState({visible:!1,x:0,y:0}),[D,M]=l.useState(!1),[V,U]=l.useState(!1),[H,Y]=l.useState(!1),[Z,q]=l.useState(void 0);l.useEffect(()=>{const ue=()=>{Y(window.innerWidth<768)};return ue(),window.addEventListener("resize",ue),()=>{window.removeEventListener("resize",ue)}},[]);const X=l.useCallback(ue=>{if(ue.evt.preventDefault(),!p.current)return;const oe=p.current,ye=g,me=oe.getPointerPosition(),Ye={x:(me.x-oe.x())/ye,y:(me.y-oe.y())/ye},ct=1.15,yt=ue.evt.deltaY<0?ye*ct:ye/ct,cs=Math.min(Math.max(.1,yt),20),Ws={x:me.x-Ye.x*cs,y:me.y-Ye.y*cs};$(cs),C(Ws)},[g]),z=l.useCallback(()=>{if(!p.current)return;const ue=p.current,oe=Math.min(g*1.15,20),ye=ue.width()/2,me=ue.height()/2,Ye={x:(ye-b.x)/g,y:(me-b.y)/g},ct={x:ye-Ye.x*oe,y:me-Ye.y*oe};$(oe),C(ct)},[g,b]),ee=l.useCallback(()=>{if(!p.current)return;const ue=p.current,oe=Math.max(g/1.15,.1),ye=ue.width()/2,me=ue.height()/2,Ye={x:(ye-b.x)/g,y:(me-b.y)/g},ct={x:ye-Ye.x*oe,y:me-Ye.y*oe};$(oe),C(ct)},[g,b]),ce=l.useCallback(ue=>{ue?(q(Fi.pixelRatio),Fi.pixelRatio=H?.8:1):Z&&(Fi.pixelRatio=Z)},[Z,H]),ae=l.useCallback(ue=>{if(ue.target===p.current&&(w({...I,visible:!1}),B(!0),ce(!0),_.current)){if(c){const oe=H?{x:-10,y:-10,width:s+20,height:t+20}:void 0;_.current.cache(oe)}if(_.current.hitGraphEnabled(!1),c&&p.current){const oe=p.current.container();oe.style.cursor="grabbing",oe.classList.add("dragging"),p.current.batchDraw(),_.current.getChildren().forEach(me=>{if(me.shadowForStrokeEnabled&&(me._savedShadowForStroke=me.shadowForStrokeEnabled(),me.shadowForStrokeEnabled(!1)),me.perfectDrawEnabled&&(me._savedPerfectDraw=me.perfectDrawEnabled(),me.perfectDrawEnabled(!1)),me.cache&&!me.isCached&&me.width&&me.height){me._dragCached=!0;try{H?me.cache({offset:10,pixelRatio:.8}):me.cache()}catch{me._dragCached=!1}}})}}},[I,c,ce,H,s,t]),Q=l.useCallback(ue=>{if(c&&ue.target===p.current){if(ue.evt&&ue.evt._dragSkipUpdate)return;if(ue.evt&&(ue.evt._dragSkipUpdate=!0),p.current&&_.current){const oe=H?.85:.7;Math.random()>oe&&p.current.batchDraw()}return}ue.target===p.current&&H&&_.current&&(ue.cancelBubble=!0)},[H,c]),re=l.useCallback(ue=>{if(ue.target===p.current){if(C({x:ue.target.x(),y:ue.target.y()}),ce(!1),_.current&&(_.current.hitGraphEnabled(!0),c&&_.current.clearCache(),c&&p.current)){const oe=p.current.container();oe.style.cursor="",oe.classList.remove("dragging"),_.current.getChildren().forEach(me=>{me._savedShadowForStroke!==void 0&&(me.shadowForStrokeEnabled(me._savedShadowForStroke),delete me._savedShadowForStroke),me._savedPerfectDraw!==void 0&&(me.perfectDrawEnabled(me._savedPerfectDraw),delete me._savedPerfectDraw),me._dragCached&&(me.clearCache(),delete me._dragCached)})}setTimeout(()=>{p.current&&p.current.batchDraw()},50),B(!1)}},[c,ce]),be=l.useCallback(()=>{P(!0),document.body.style.cursor=m?"grabbing":"grab"},[m]),W=l.useCallback(()=>{P(!1),document.body.style.cursor="default"},[]),he=ue=>{var ye,me,Ye;const oe=ue.target.getClassName();if(oe==="Stage"||oe==="Layer"){w({...I,visible:!1});return}if(oe==="Group"||oe==="Rect"){d(null),f(null);const ct=(ye=p.current)==null?void 0:ye.getPointerPosition();if(ct&&xe(ct)){const{x:yt,y:cs}=ct,{x:Ws,y:El}=((me=p.current)==null?void 0:me.position())||{x:0,y:0},{x:Al,y:Tl}=((Ye=p.current)==null?void 0:Ye.scale())||{x:1,y:1},Nl=(yt-Ws)/Al,Pl=(cs-El)/Tl;w({x:Nl,y:Pl,visible:!0})}else w({...I,visible:!1})}else w({...I,visible:!1})},xe=ue=>{if(!n||!i||!p.current)return!1;const{x:oe,y:ye}=ue,{x:me,y:Ye}=p.current.position(),{x:ct}=p.current.scale(),yt={x:(oe-me)/ct,y:(ye-Ye)/ct};return yt.x>=0&&yt.x<=n&&yt.y>=0&&yt.y<=i},we=l.useCallback(()=>{d(null),f(null),M(!0),U(!0),w({...I,visible:!1})},[d,f,I]),$e=l.useCallback(ue=>{R(ue),U(!1)},[R]),tt=()=>{M(!0),U(!0),w({...I,visible:!1})},es=()=>{S(),w({...I,visible:!1})},Vt=()=>{j(),w({...I,visible:!1})};l.useEffect(()=>{if(s>0&&t>0&&n>0&&i>0){const ue=T?20:40,oe=s-ue*2,ye=t-ue*2,me=oe/n,Ye=ye/i,yt=Math.min(me,Ye),cs=(s-n*yt)/2,Ws=(t-i*yt)/2;$(yt),C({x:cs,y:Ws}),p.current&&p.current.batchDraw()}},[s,t,n,i,T]);const St=De.Children.map(v,ue=>De.isValidElement(ue)?De.cloneElement(ue,{scale:g,position:b}):ue),Hs=e.jsx(ia,{width:n,height:i,scale:g,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return s<=0||t<=0||n<=0||i<=0?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:E?m?"grabbing":"grab":"default"},children:[e.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:e.jsxs(J,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[e.jsx(O,{icon:e.jsx(Wl,{}),onClick:ee,disabled:g<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),e.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(g*100),"%"]}),e.jsx(O,{icon:e.jsx(Yl,{}),onClick:z,disabled:g>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),e.jsxs(Dc,{ref:p,width:s,height:t,onClick:he,draggable:!0,onDragStart:ae,onDragMove:Q,onDragEnd:re,onMouseEnter:be,onMouseLeave:W,onWheel:X,x:b.x,y:b.y,scaleX:g,scaleY:g,perfectDrawEnabled:!m&&!c,hitGraphEnabled:!m,pixelRatio:m?H?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:c?H?5:3:0,children:[c&&e.jsx(Lc,{ref:N,listening:!1,children:Hs}),e.jsxs($c,{ref:_,imageSmoothingEnabled:!m||!c,children:[!c&&e.jsx(ia,{width:n,height:i,scale:g,position:{x:0,y:0},isSelected:D,onSelect:A?void 0:we,onChange:T||A?void 0:R,isEditable:!T&&!A}),r.map(ue=>e.jsx(wl,{hall:ue,isSelected:(u==null?void 0:u.id)===ue.id,onSelect:()=>d(ue),onChange:T||A?void 0:x,scale:g,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isStallMode:T||A},ue._id||ue.id)),o.map(ue=>{const oe=ue._id||ue.id,ye=r.find(me=>me.id===ue.hallId||me._id===ue.hallId);return ye?e.jsx(oo,{stall:{...ue,_id:oe,id:oe},hallX:ye.dimensions.x,hallY:ye.dimensions.y,hallWidth:ye.dimensions.width,hallHeight:ye.dimensions.height,scale:g,isDragging:m&&c},oe):null}),a.map(ue=>{const oe=ue._id||ue.id,me=((y==null?void 0:y._id)||(y==null?void 0:y.id))===oe;return e.jsx(Sl,{fixture:{...ue,_id:oe,id:oe},isSelected:me,onSelect:()=>f(ue),onChange:A?h:void 0,scale:g,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isEditable:A},oe)}),St]})]}),e.jsx(Qp,{visible:I.visible,x:I.x,y:I.y,onExhibitionClick:tt,onHallClick:es,onStallClick:Vt,onClose:()=>w({...I,visible:!1})}),e.jsx(Wp,{visible:V,width:n,height:i,onCancel:()=>U(!1),onSubmit:$e})]})},Kp=({visible:s,hall:t,exhibitionWidth:n,exhibitionHeight:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[u]=L.useForm();De.useEffect(()=>{s&&(t?u.setFieldsValue({name:t.name,width:t.dimensions.width,height:t.dimensions.height}):u.setFieldsValue({name:"",width:Math.min(10,n),height:Math.min(10,i)}))},[s,t,n,i,u]);const y=async()=>{var h,R;const f=await u.validateFields(),x=t?{...t,_id:t._id,id:t.id||t._id,name:f.name,dimensions:{x:((h=t.dimensions)==null?void 0:h.x)||0,y:((R=t.dimensions)==null?void 0:R.y)||0,width:f.width,height:f.height},exhibitionId:t.exhibitionId}:{name:f.name,dimensions:{x:0,y:0,width:f.width,height:f.height}};o(x),u.resetFields()},d=()=>{t&&a&&je.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${t.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>a(t)})};return e.jsx(je,{title:t?"Edit Hall":"Add New Hall",open:s,onCancel:()=>{u.resetFields(),r()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:e.jsxs(L,{form:u,layout:"vertical",style:{marginTop:"16px"},children:[e.jsx(L.Item,{name:"name",label:e.jsxs("span",{style:{color:"#000"},children:["Hall Name ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:e.jsx(G,{placeholder:"Enter hall name"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsx(L.Item,{name:"width",label:e.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:n,message:`Width cannot exceed ${n} meters`}],children:e.jsx(ze,{min:5,max:n,style:{width:"100%"},placeholder:"Enter width"})}),e.jsx(L.Item,{name:"height",label:e.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:i,message:`Height cannot exceed ${i} meters`}],children:e.jsx(ze,{min:5,max:i,style:{width:"100%"},placeholder:"Enter height"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[e.jsx(J,{children:t&&a&&e.jsx(O,{className:"delete-button",icon:e.jsx(ot,{}),onClick:d,children:"Delete Hall"})}),e.jsxs(J,{children:[e.jsx(O,{onClick:()=>{u.resetFields(),r()},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:y,className:"update-button",children:t?"Update Hall":"Create Hall"})]})]})]})})},{Title:Xp}=pe,Jp=({visible:s,stall:t,hall:n,exhibition:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[u]=L.useForm(),[y,d]=l.useState([]),[f,x]=l.useState(!1),h=(v,T,A,c,p)=>{const N=[...A].sort(($,b)=>{const C=Math.floor($.dimensions.y/5),E=Math.floor(b.dimensions.y/5);return C===E?$.dimensions.x-b.dimensions.x:$.dimensions.y-b.dimensions.y}),g=($,b)=>$+v>c||b+T>p?!1:!N.some(C=>{const E=C.dimensions.x,P=C.dimensions.y,m=C.dimensions.width,B=C.dimensions.height,I=1;return!($+v+I<=E||$>=E+m+I||b+T+I<=P||b>=P+B+I)});for(const $ of N){const b=$.dimensions.x+$.dimensions.width+1,C=$.dimensions.y;if(g(b,C))return{x:b,y:C};const E=$.dimensions.x,P=$.dimensions.y+$.dimensions.height+1;if(g(E,P))return{x:E,y:P}}for(let $=0;$<p;$+=5)for(let b=0;b<c;b+=5)if(g(b,$))return{x:b,y:$};return{x:0,y:0}};l.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const v={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",v),u.setFieldsValue(v)}else n&&!u.getFieldValue("status")&&u.setFieldsValue({status:"available",width:Math.min(20,n.dimensions.width/4),height:Math.min(20,n.dimensions.height/4),ratePerSqm:0})},[t,n,u]),l.useEffect(()=>{s&&(async()=>{var T;try{x(!0);const A=await Ls.getStallTypes();console.log("Fetched stall types:",A.data);const c=((T=i.stallRates)==null?void 0:T.map(_=>_.stallTypeId))||[];console.log("Configured stall type IDs:",c);const p=A.data.filter(_=>_.status==="active"&&_._id&&c.includes(_._id));console.log("Filtered stall types:",p),d(p)}catch(A){console.error("Failed to fetch stall types:",A)}finally{x(!1)}})()},[s,i.stallRates]);const R=v=>{var A;console.log("Stall type changed to:",v);const T=(A=i.stallRates)==null?void 0:A.find(c=>c.stallTypeId===v);console.log("Found stall rate:",T),T&&u.setFieldsValue({ratePerSqm:T.rate})},S=()=>{u.resetFields(),r()},j=()=>{if(console.log("Hall data:",n),!n||!n._id&&!n.id){se.error("Invalid hall selected. Please try again.");return}u.validateFields().then(v=>{var p;const T=n._id||n.id;if(!T){se.error("Hall ID is missing. Please select a hall again.");return}const A=t?{x:t.dimensions.x,y:t.dimensions.y}:h(v.width,v.height,((p=i.stalls)==null?void 0:p.filter(_=>_.hallId===T))||[],n.dimensions.width,n.dimensions.height),c={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:v.number,stallTypeId:v.stallTypeId,dimensions:{x:A.x,y:A.y,width:v.width,height:v.height},ratePerSqm:v.ratePerSqm,status:v.status,hallId:T};console.log("Submitting stall data:",c),o(c)})},k=v=>{switch(v){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return e.jsx(e.Fragment,{children:e.jsx(je,{title:e.jsxs(J,{children:[e.jsx(ut,{style:{fontSize:"20px"}}),e.jsx(Xp,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:s,onCancel:S,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[e.jsxs(J,{size:"middle",children:[t&&a&&e.jsx(O,{danger:!0,icon:e.jsx(ot,{}),onClick:()=>a(t),children:"Delete"}),e.jsx(O,{onClick:S,children:"Cancel"}),e.jsx(O,{type:"primary",onClick:j,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:e.jsxs(L,{form:u,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[e.jsx(L.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:e.jsx(G,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),e.jsx(L.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(de,{loading:f,placeholder:"Select stall type",size:"large",onChange:R,children:y.map(v=>e.jsx(de.Option,{value:v._id,children:v.name},v._id))})}),e.jsx(Te,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),e.jsxs(J,{style:{width:"100%",gap:"16px"},children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:e.jsx(ze,{min:1,max:(n==null?void 0:n.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:e.jsx(ze,{min:1,max:(n==null?void 0:n.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),e.jsx(Te,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),e.jsx(L.Item,{name:"ratePerSqm",label:"Rate per sq.m ()",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:e.jsx(ze,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"",disabled:!0,formatter:v=>`${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>{const T=v?Number(v.replace(/\\s?|(,*)/g,"")):0;return isNaN(T)?0:T}})}),e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(de,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[e.jsx(de.Option,{value:"available",children:e.jsxs(J,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:k("available")}}),"Available"]})}),e.jsx(de.Option,{value:"booked",children:e.jsxs(J,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:k("booked")}}),"Booked"]})}),e.jsx(de.Option,{value:"reserved",children:e.jsxs(J,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:k("reserved")}}),"Reserved"]})})]})})]})})})},ra=s=>{if(!s)return"";const t=window.location.origin,n=s.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${t}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${n}?token=${i}`:""},Zp=({name:s,type:t,color:n,rotation:i,showName:r,iconUrl:o,defaultIcons:a,borderColor:u=null,borderRadius:y=0})=>{l.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:s,type:t,color:n,rotation:i,showName:r,iconUrl:o,defaultIconAvailable:!!a[t],borderColor:u,borderRadius:y})},[s,t,n,i,r,o,a,u,y]);const d=a[t]||"";return e.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[e.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${y||4}px`,backgroundColor:n||"#f0f0f0",transform:`rotate(${i}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:u?`1px solid ${u}`:"1px solid rgba(0,0,0,0.05)"},children:o?e.jsx("img",{src:o,alt:s,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):e.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:d})}),r&&e.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:s}),e.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[e.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),e.jsx("span",{children:""}),e.jsx("span",{children:n}),i>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[i,""]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Border: ",u]})]}),y>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Radius: ",y,"px"]})]})]})]})},{Text:em}=pe,rr=({activeKey:s,form:t,fixture:n,exhibitionWidth:i,exhibitionHeight:r,selectedType:o,showName:a,iconFileList:u,fixtureTypes:y,fixtureIcons:d,defaultColors:f,defaultDimensions:x,colorPresets:h,uploadProps:R,iconPreviewVisible:S=!1,previewImage:j="",onTypeChange:k,onColorChange:v,onShowNameChange:T,onIconPreviewCancel:A=()=>{}})=>{switch(s){case"basic":return c();case"position":return p();case"appearance":return _();default:return c()}function c(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(L.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:e.jsx(G,{placeholder:"Enter fixture name",prefix:e.jsx(Rt,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(L.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:e.jsx(xt,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:N=>{T(N),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),e.jsx(L.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:e.jsx(de,{placeholder:"Select fixture type",onChange:k,options:y.map(N=>({...N,label:e.jsxs(J,{children:[e.jsx("span",{style:{fontSize:16},children:d[N.value]}),e.jsx("span",{children:N.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function p(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(K,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"X position"})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:0,max:r,step:.1,precision:1,placeholder:"Y position"})})})]})}),e.jsx(K,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:e.jsx(ze,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),e.jsx(K,{size:"small",title:e.jsxs("span",{children:[e.jsx(Ql,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsx(L.Item,{name:"rotation",noStyle:!0,children:e.jsx(Ia,{min:0,max:360,marks:{0:"0",90:"90",180:"180",270:"270",360:"360"},tooltip:{formatter:N=>`${N}`},style:{marginTop:10},keyboard:!1})})})]})}function _(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(L.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(N,g)=>{try{return g?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:e.jsx(co,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:h,onChange:v,style:{width:"100%"}})}),e.jsx(L.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:e.jsx(co,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:h,style:{width:"100%"}})}),e.jsx(L.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:e.jsx(ze,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),e.jsxs(K,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[e.jsx("div",{style:{marginBottom:0},children:e.jsx(un,{...R,children:u.length<1&&e.jsxs("div",{children:[e.jsx(Gl,{style:{fontSize:20}}),e.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),e.jsx(em,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),e.jsx(L.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:e.jsx(G,{placeholder:"https://example.com/icon.png",prefix:e.jsx(Kl,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(je,{open:S,title:"Icon Preview",footer:null,onCancel:A,children:e.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:j})})]})}},tm=s=>[{key:"basic",label:e.jsxs("span",{children:[e.jsx(bn,{}),"Basic Info"]}),children:e.jsx(rr,{...s,activeKey:"basic"})},{key:"position",label:e.jsxs("span",{children:[e.jsx(ys,{}),"Position"]}),children:e.jsx(rr,{...s,activeKey:"position"})},{key:"appearance",label:e.jsxs("span",{children:[e.jsx(hn,{}),"Appearance"]}),children:e.jsx(rr,{...s,activeKey:"appearance"})}],{Text:yg,Title:bg}=pe,{TabPane:jg}=at,sm=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],Fn={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},ss={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},or={sofa:"",chair:"",table:"",desk:"",plant:"",entrance:"",exit:"",info:"",restroom:"",food:"",custom:""},nm=({visible:s,fixture:t,onCancel:n,onSubmit:i,onDelete:r,exhibitionWidth:o,exhibitionHeight:a})=>{const[u]=L.useForm(),[y,d]=l.useState(!1),[f,x]=l.useState(""),[h,R]=l.useState("basic"),[S,j]=l.useState(""),[k,v]=l.useState([]),[T,A]=l.useState(!1),[c,p]=l.useState(""),{message:_}=st.useApp(),[N,g]=l.useState("#f0f0f0"),[$,b]=l.useState("New Fixture"),[C,E]=l.useState("chair"),[P,m]=l.useState(0),[B,I]=l.useState(!0),[w,D]=l.useState(null),[M,V]=l.useState(0);l.useEffect(()=>{if(s)if(t){const W=z(t.color),he=ss[t.type]||"#f0f0f0",xe=W||he;console.log("Setting up fixture colors:",{original:t.color,normalized:W,fallback:he,final:xe}),g(xe),b(t.name),E(t.type),m(t.rotation||0),x(t.type),I(t.showName!==!1),D(t.borderColor||null),V(t.borderRadius||0)}else{const W="chair",he=ss[W];g(he),b("New Fixture"),E(W),m(0),x(W),I(!0),D(null),V(0)}},[s,t]),l.useEffect(()=>{if(s&&u){if(t){const W=z(t.color),he=ss[t.type]||"#f0f0f0",xe=W||he;u.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:xe,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const we=t.icon?ra(t.icon):"";j(we),t.icon?v([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:we,thumbUrl:we}]):v([])}else{const W="chair",he=ss[W];u.setFieldsValue({name:"New Fixture",type:W,position:{x:Math.floor(o/2),y:Math.floor(a/2)},dimensions:Fn[W],rotation:0,color:he,icon:"",showName:!0,borderColor:null,borderRadius:0}),j(""),v([])}R("basic")}},[s,t,u,o,a]);const U=()=>{if(u&&s)try{const W=u.getFieldsValue(!0);if(W.name&&b(W.name),W.type&&E(W.type),W.rotation!==void 0&&m(W.rotation),W.color){const he=z(W.color);he&&g(he)}if(W.showName!==void 0&&I(W.showName),W.borderColor!==void 0){const he=W.borderColor?z(W.borderColor):null;D(he)}W.borderRadius!==void 0&&V(W.borderRadius)}catch(W){console.log("Error updating preview",W)}};l.useEffect(()=>{if(u&&s)return u.getFieldsValue,U(),()=>{}},[u,s]);const H=W=>{if(x(W),E(W),!t){const he=ss[W]||ss.custom;u.setFieldsValue({dimensions:Fn[W]||Fn.custom,color:he}),g(he)}},Y=W=>{const he=z(W);u.setFieldValue("color",he),g(he);const xe=Object.entries(ss).find(([we,$e])=>$e.toLowerCase()===he.toLowerCase());xe&&!t&&(u.setFieldValue("type",xe[0]),x(xe[0]),E(xe[0]))},Z=()=>(console.log("Rendering fixture preview with:",{name:$,type:C,color:N,rotation:P,showName:B,iconUrl:S,borderColor:w,borderRadius:M}),e.jsx(Zp,{name:$,type:C,color:N,rotation:P,showName:B,iconUrl:S,defaultIcons:or,borderColor:w,borderRadius:M})),q=({file:W,fileList:he})=>{var xe;if(W.status==="uploading"&&v(he),W.status==="done"){_.success(`${W.name} uploaded successfully`);let $e=(((xe=W.response)==null?void 0:xe.url)||"").replace(/^\/api\/uploads\//,"");$e&&!$e.startsWith("fixtures/")&&($e=`fixtures/${$e.replace(/^\//,"")}`),console.log("Icon path stored in form:",$e),u.setFieldValue("icon",$e);const tt=ra($e);console.log("Using direct backend URL:",tt),j(tt);const es=W.name.toLowerCase().endsWith(".svg"),Vt=he.map(St=>St.uid===W.uid?{...St,url:tt,thumbUrl:tt,type:es?"image/svg+xml":St.type}:St);v(Vt),console.log("Form values after icon upload:",u.getFieldsValue(!0))}W.status==="error"&&(_.error(`${W.name} upload failed.`),v(he.filter(we=>we.uid!==W.uid)))},X={name:"file",action:`${ne.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:k,onChange:q,onPreview:W=>{p(W.url||W.thumbUrl||""),A(!0)},onRemove:()=>(j(""),v([]),u.setFieldValue("icon",""),console.log("Form values after icon removal:",u.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:e.jsx(ot,{style:{color:"#ff4d4f"}})}},z=W=>{try{if(!W)return"#f0f0f0";if(typeof W=="object"&&W!==null){if(typeof W.toHexString=="function")return W.toHexString();if(W.rgb||W.hex)return W.hex||`rgb(${W.rgb.r},${W.rgb.g},${W.rgb.b})`}if(typeof W=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(W))return W;if(/^([0-9A-F]{3}){1,2}$/i.test(W))return`#${W}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(W))return W}return"#f0f0f0"}catch(he){return console.error("Error normalizing color:",he),"#f0f0f0"}},ee=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],ce=De.useCallback(()=>{t&&r&&r(t)},[t,r]),ae=W=>{R(W),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},Q=tm({form:u,fixture:t,exhibitionWidth:o,exhibitionHeight:a,selectedType:f,showName:B,iconFileList:k,fixtureTypes:sm,fixtureIcons:or,defaultColors:ss,defaultDimensions:Fn,colorPresets:ee,uploadProps:X,iconPreviewVisible:T,previewImage:c,onTypeChange:H,onColorChange:Y,onShowNameChange:W=>I(W),onIconPreviewCancel:()=>A(!1),activeKey:h}),re=async()=>{try{d(!0);const W=await u.validateFields();b(W.name),E(W.type),m(W.rotation||0),g(z(W.color)),I(W.showName),D(W.borderColor?z(W.borderColor):null),V(W.borderRadius||0);let he="";W.icon?he=be(W.icon):t!=null&&t.icon&&(he=t.icon),console.log("Form values being submitted:",{name:W.name,type:W.type,color:W.color,icon:W.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:he,showName:W.showName,borderColor:W.borderColor,borderRadius:W.borderRadius});const xe=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",we=W.color?z(W.color):(t==null?void 0:t.color)||"#f0f0f0",$e=W.borderColor?z(W.borderColor):null,tt={...t,id:xe,_id:xe,name:W.name,type:W.type,position:W.position,dimensions:W.dimensions,rotation:W.rotation,color:we,icon:he,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:$e,borderRadius:W.borderRadius||0};xe&&(tt.showName=W.showName),console.log("Submitting fixture with icon path:",he),console.log("Color being submitted:",we),await i(tt),n()}catch(W){console.error("Fixture submission failed:",W),_.error("Failed to save fixture. Please check the form and try again.")}finally{d(!1)}},be=W=>{if(!W||typeof W!="string")return"";if(W.startsWith("fixtures/")&&!W.includes("?")&&!W.includes("http"))return W;let he=W.replace(/^\/api\/uploads\//,"");if(he=he.replace(/^\//,""),he.includes("?")||he.includes("http")){const xe=he.split("?")[0].split("/").pop()||"";if(xe)return`fixtures/${xe}`}return he&&!he.startsWith("fixtures/")?`fixtures/${he}`:he};return e.jsxs(je,{title:e.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:24,marginRight:8},children:t?or[t.type]:""}),e.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:s,onCancel:n,confirmLoading:y,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:t&&r&&e.jsx(O,{danger:!0,icon:e.jsx(ot,{}),onClick:ce,style:{borderRadius:"6px"},children:"Delete"})}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(O,{onClick:n,icon:e.jsx(Xl,{}),style:{borderRadius:"6px"},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:re,icon:e.jsx(ws,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),Z(),e.jsx(L,{form:u,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:U,children:e.jsx(at,{activeKey:h,onChange:ae,items:Q,tabBarStyle:{marginBottom:16},centered:!0})})]})},im=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=Ie(),{currentExhibition:r}=ge(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>i(Ke(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},rm=()=>{var S;const{id:s}=ft(),t=Zt(),n=Ie(),i=Re(),r=((S=t.state)==null?void 0:S.exhibitionId)||s,{currentExhibition:o}=ge(j=>j.exhibition),a=l.useRef(null),[u,y]=l.useState({width:100,height:100}),[d,f]=l.useState({width:0,height:0}),[x]=L.useForm();l.useEffect(()=>{if(!r){se.error("Exhibition ID not found"),n("/exhibition");return}i(vt(r))},[r,i,n]),l.useEffect(()=>{o!=null&&o.dimensions&&(y(o.dimensions),x.setFieldsValue(o.dimensions))},[o,x]),l.useEffect(()=>{const j=()=>{a.current&&f({width:a.current.clientWidth,height:a.current.clientHeight})};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]);const h=async()=>{try{const j=await x.validateFields();await Fe.updateExhibition(r,{dimensions:j}),se.success("Exhibition space saved successfully"),await i(vt(r)).unwrap(),n(Ke(o,"layout"),{state:{exhibitionId:r}})}catch{se.error("Failed to save exhibition space")}},R=j=>{y(k=>({...k,...j})),x.setFieldsValue(j)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(im,{exhibitionId:r}),e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Space Setup"}),e.jsx(O,{type:"primary",icon:e.jsx(ws,{}),onClick:h,children:"Save and Continue"})]}),children:e.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[e.jsx("div",{style:{flex:"0 0 300px"},children:e.jsxs(L,{form:x,layout:"vertical",initialValues:u,children:[e.jsx(L.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},onChange:j=>R({width:j||10})})}),e.jsx(L.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(ze,{min:10,max:1e3,style:{width:"100%"},onChange:j=>R({height:j||10})})})]})}),e.jsx("div",{ref:a,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:e.jsx(wn,{children:e.jsx(Sn,{width:d.width,height:d.height,exhibitionWidth:u.width,exhibitionHeight:u.height,onExhibitionChange:R})})})]})})]})},om=({exhibitionId:s})=>{const t=Ie(),{currentExhibition:n}=ge(i=>i.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>t(Ke(n),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},am=()=>{var u,y,d,f,x;const{id:s}=ft(),t=Zt(),n=Ie(),i=Re(),r=((u=t.state)==null?void 0:u.exhibitionId)||s,{currentExhibition:o,halls:a}=ge(h=>h.exhibition);return l.useEffect(()=>{r&&(i(vt(r)),i(qt(r)))},[r,i]),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(om,{exhibitionId:r}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Ss,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",onClick:()=>n(Ke(o,"space"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(F,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(bn,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!((y=o==null?void 0:o.dimensions)!=null&&y.width)||!((d=o==null?void 0:o.dimensions)!=null&&d.height),onClick:()=>n(Ke(o,"halls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(F,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(ut,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!a.length,onClick:()=>n(Ke(o,"stalls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(F,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Br,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!((f=o==null?void 0:o.dimensions)!=null&&f.width)||!((x=o==null?void 0:o.dimensions)!=null&&x.height),onClick:()=>n(Ke(o,"fixtures"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},lm=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=Ie(),{currentExhibition:r}=ge(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>i(Ke(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},cm=()=>{var p,_,N;const{id:s}=ft(),t=Zt(),n=Ie(),i=Re(),r=((p=t.state)==null?void 0:p.exhibitionId)||s,{currentExhibition:o,halls:a}=ge(g=>g.exhibition),u=l.useRef(null),[y,d]=se.useMessage(),[f,x]=l.useState(!1),[h,R]=l.useState(null),[S,j]=l.useState({width:0,height:0});l.useEffect(()=>{const g=()=>{if(u.current){const{clientWidth:b,clientHeight:C}=u.current;j({width:Math.max(b||400,400),height:Math.max(C||400,400)})}};g();const $=new ResizeObserver(g);return u.current&&$.observe(u.current),window.addEventListener("resize",g),()=>{$.disconnect(),window.removeEventListener("resize",g)}},[]),l.useEffect(()=>{if(!r){y.error("Exhibition ID not found"),n("/exhibition");return}i(vt(r))},[r,i,n,y]),l.useEffect(()=>{var g,$;if(o){if(!((g=o.dimensions)!=null&&g.width)||!(($=o.dimensions)!=null&&$.height)){y.info("Please set up exhibition space first"),n(Ke(o,"space"),{state:{exhibitionId:r}});return}i(qt(r))}},[o,r,i,n,y]);const k=()=>{R(null),x(!0)},v=g=>{R(g),x(!!g)},T=async g=>{var $;try{g.id?(await Fe.updateHall(r,g.id,g),y.success("Hall updated successfully"),x(!1)):(await Fe.createHall(r,g),y.success("Hall created successfully"),x(!1)),i(qt(r))}catch(b){console.error("Hall operation failed:",b),(($=b.response)==null?void 0:$.status)===409?y.warning({content:b.response.data.message,duration:6,style:{marginTop:"20vh"}}):(y.error(b.message||"Failed to save hall"),x(!1))}},A=async g=>{var $,b;try{const C=g._id||g.id;if(!C)throw new Error("Hall ID is required");await Fe.deleteHall(r,C),y.success("Hall deleted successfully"),x(!1),R(null),i(qt(r))}catch(C){console.error("Failed to delete hall:",C),y.error(((b=($=C.response)==null?void 0:$.data)==null?void 0:b.message)||"Failed to delete hall")}},c=async()=>{try{await Fe.saveLayout(r,a),y.success("Layout saved successfully")}catch{y.error("Failed to save layout")}};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(lm,{exhibitionId:r}),d,e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(J,{children:[e.jsx("span",{children:"Hall Management"}),e.jsx(O,{icon:e.jsx(Ea,{}),onClick:()=>n(Ke(o,"space"),{state:{exhibitionId:r}}),children:"Back to Space Setup"})]}),e.jsxs(J,{children:[e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:k,children:"Add Hall"}),e.jsx(O,{type:"primary",icon:e.jsx(ws,{}),onClick:c,disabled:!a.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:e.jsx("div",{ref:u,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(wn,{children:S.width>0&&S.height>0&&(o==null?void 0:o.dimensions)&&e.jsx(Sn,{width:S.width,height:S.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:a,selectedHall:h,onSelectHall:v,onHallChange:T,onAddHall:k})})})}),e.jsx(Kp,{visible:f,hall:h,onCancel:()=>x(!1),onSubmit:T,onDelete:A,exhibitionWidth:((_=o==null?void 0:o.dimensions)==null?void 0:_.width)||100,exhibitionHeight:((N=o==null?void 0:o.dimensions)==null?void 0:N.height)||100})]})},dm=te(je)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,um=te.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,cn=te.div`
  padding: 24px 32px 32px;
`,hm=te.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,pm=te.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;te.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;te.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;te.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;te.div`
  border: 1px solid ${s=>s.selected?"#4b47b9":"#e6e6f0"};
  background: ${s=>s.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${s=>s.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${s=>s.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${s=>s.selected?"#4b47b9":"white"};
    border: 2px solid ${s=>s.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const mm=te(K)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;te(O)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;te.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;te(K)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;te(G)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const ar=te(O)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;te(fe)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;te.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;te(jn)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;te.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;te.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;te.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;te.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;te.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px  3) + (16px  2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;te(K)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const oa=({form:s,stallDetails:t=[],selectedStallId:n,selectedStallIds:i=[],exhibition:r})=>{const[o,a]=l.useState([]);l.useEffect(()=>{let R=[...(s.getFieldValue("selectedStalls")||[]).map(S=>String(S))];if(n){const S=String(n);R.some(j=>j===S)||R.push(S)}i.length>0&&i.forEach(S=>{const j=String(S);R.some(k=>k===j)||R.push(j)}),console.log("StallDetailsStep - Initial stalls after normalization:",R),s.setFieldsValue({selectedStalls:R}),a(R)},[s,n,i]),l.useEffect(()=>{if(o.length>0){const x=s.getFieldValue("selectedStalls")||[],h=new Set(x.map(j=>String(j))),R=new Set(o.map(j=>String(j)));let S=h.size!==R.size;if(!S){for(const j of R)if(!h.has(j)){S=!0;break}}if(S){console.log("Syncing form with selected stalls:",o);const j=o.map(k=>String(k));s.setFieldsValue({selectedStalls:j}),s.validateFields(["selectedStalls"]).catch(k=>{})}}},[o,s]);const u=l.useMemo(()=>!t||t.length===0?[]:t.filter(x=>o.includes(x.id)),[t,o]),y=l.useMemo(()=>{var c,p,_;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const x=t.filter(N=>o.includes(N.id)),h=x.reduce((N,g)=>N+(g.price||g.ratePerSqm*g.dimensions.width*g.dimensions.height),0),S=(((c=r==null?void 0:r.publicDiscountConfig)==null?void 0:c.filter(N=>N.isActive))||[]).map(N=>{const g=N.type==="percentage"?h*(Math.min(Math.max(0,N.value),100)/100):Math.min(N.value,h);return{name:N.name,type:N.type,value:N.value,amount:g}}),j=S.reduce((N,g)=>N+g.amount,0),k=h-j,v=((_=(p=r==null?void 0:r.taxConfig)==null?void 0:p.filter(N=>N.isActive))==null?void 0:_.map(N=>({name:N.name,rate:N.rate,amount:k*(N.rate/100)})))||[],T=v.reduce((N,g)=>N+g.amount,0),A=k+T;return{baseAmount:h,discounts:S,totalDiscountAmount:j,amountAfterDiscount:k,taxes:v,totalTaxAmount:T,total:A,selectedStallNumbers:x.map(N=>`${N.number||N.stallNumber||`Stall ${N.id}`} (${N.hallName||`Hall ${N.hallId||1}`})`).join(", ")}},[t,o,r==null?void 0:r.taxConfig,r==null?void 0:r.publicDiscountConfig]),d=x=>{const h=String(x);if(o.some(S=>String(S)===h)){const S=o.filter(j=>String(j)!==h);a(S),s.setFieldsValue({selectedStalls:S}),se.info("Stall removed from selection")}},f=x=>`${x.toLocaleString("en-IN")}`;return e.jsxs(cn,{children:[e.jsx(hm,{children:"Your Selected Stalls"}),e.jsx(pm,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),e.jsx(L.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:e.jsx(de,{mode:"multiple"})}),u.length>0?e.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:e.jsx(Ne,{dataSource:u.map(x=>({...x,key:x.id,price:x.price||x.ratePerSqm*x.dimensions.width*x.dimensions.height,area:x.dimensions.width*x.dimensions.height,dimensions:`${x.dimensions.width}m  ${x.dimensions.height}m`,size:`${x.dimensions.width}m  ${x.dimensions.height}m`,stallType:x.stallType||{name:x.typeName||x.type||"Standard"},type:x.typeName||x.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(x,h)=>e.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",x||h.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(x,h)=>e.jsx(le,{color:"blue",style:{borderRadius:"4px"},children:x||`Hall ${h.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(x,h)=>{var S;const R=((S=h.stallType)==null?void 0:S.name)||h.type||"Standard";return e.jsx(le,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:R})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(x,h)=>e.jsxs(J,{direction:"vertical",size:0,children:[e.jsx("span",{style:{fontWeight:500},children:x}),e.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[h.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(x,h)=>e.jsxs("span",{style:{color:"#555"},children:["",(h.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:x=>e.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:f(x)})},{title:"",key:"action",width:70,align:"center",render:(x,h)=>e.jsx(_e,{title:"Remove from selection",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(ot,{}),onClick:()=>d(h.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):e.jsx(Ve,{description:"No stalls selected yet. Please select stalls from the layout.",image:Ve.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),o.length>0&&e.jsxs(mm,{title:e.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Selected Stalls"}),e.jsxs("div",{className:"value",children:[o.length," stall(s) selected"]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Stall Numbers"}),e.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:y.selectedStallNumbers})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Base Amount"}),e.jsx("div",{className:"value",children:f(y.baseAmount)})]}),y.discounts.map((x,h)=>e.jsxs("div",{className:"summary-row discount",children:[e.jsxs("div",{className:"label",children:[x.name,x.type==="percentage"?` (${x.value}%)`:""]}),e.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",f(x.amount)]})]},`discount-${h}`)),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Amount after Discount"}),e.jsx("div",{className:"value",style:{fontWeight:500},children:f(y.amountAfterDiscount)})]}),y.taxes.map((x,h)=>e.jsxs("div",{className:"summary-row",children:[e.jsxs("div",{className:"label",children:[x.name," (",x.rate,"%)"]}),e.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",f(x.amount)]})]},`tax-${h}`)),e.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[e.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),e.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:f(y.total)})]})]})]})},{Title:xm,Paragraph:aa,Text:ns}=pe,{Panel:vg}=Jl,{Option:gm}=de,la=({form:s,formValues:t,selectedStallIds:n=[],exhibition:i,stallDetails:r=[]})=>{const o=s.getFieldValue("selectedStalls")||n||[],[a,u]=l.useState(s.getFieldValue("amenities")||[]),y=l.useMemo(()=>r!=null&&r.length?r.filter(A=>o.includes(A.id)):[],[r,o]),d=l.useMemo(()=>y.reduce((A,c)=>A+c.dimensions.width*c.dimensions.height,0),[y]),f=(i==null?void 0:i.basicAmenities)&&i.basicAmenities.length>0,x=(i==null?void 0:i.amenities)&&i.amenities.length>0,h=l.useMemo(()=>!f||d===0?[]:((i==null?void 0:i.basicAmenities)||[]).map(A=>{const c=Math.floor(d/A.perSqm)*A.quantity;return{...A,calculatedQuantity:c>0?c:0,key:A._id||A.id}}),[i,f,d]),R=A=>{u(A)},S=A=>(A._id||A.id||"").toString();De.useEffect(()=>{s.setFieldsValue({amenities:a})},[a,s]);const j=A=>`${A.toLocaleString("en-IN")}`,k=l.useMemo(()=>x?((i==null?void 0:i.amenities)||[]).filter(A=>a.includes(S(A))).map(A=>({...A,key:S(A)})):[],[i,x,a]),v=[{title:"Name",dataIndex:"name",key:"name",render:(A,c)=>e.jsxs(J,{children:[e.jsx(ns,{strong:!0,children:A}),e.jsx(le,{color:"blue",children:c.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:A=>e.jsxs(le,{color:"green",children:[A," ",A===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(A,c)=>e.jsx(_e,{title:c.description,children:e.jsxs(ns,{type:"secondary",children:[e.jsx(Rt,{style:{marginRight:5}}),"1 ",c.quantity>1?`set of ${c.quantity}`:"unit"," per ",A," sqm"]})})}],T=[{title:"Name",dataIndex:"name",key:"name",render:(A,c)=>e.jsxs(J,{align:"center",children:[e.jsx(ns,{strong:!0,children:A}),e.jsx(le,{color:"blue",children:c.type}),e.jsx(ns,{type:"secondary",style:{fontSize:"13px"},children:c.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:A=>e.jsx(ns,{strong:!0,style:{color:"#1890ff"},children:j(A)})}];return e.jsxs(cn,{children:[e.jsx(xm,{level:4,children:"Stall Amenities"}),e.jsx(aa,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),e.jsx(K,{title:`Selected Stalls: ${o.length}`,style:{marginBottom:24},children:o.length>0?e.jsxs(aa,{children:["You've selected ",o.length," stall(s) with a total area of ",d," sq. meters."]}):e.jsx(Ve,{image:Ve.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),e.jsx(K,{title:e.jsxs(J,{children:[e.jsx(gt,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:o.length===0?e.jsx(He,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):f?e.jsx(Ne,{dataSource:h.filter(A=>A.calculatedQuantity>0),columns:v,pagination:!1,size:"small",locale:{emptyText:e.jsx(Ve,{image:Ve.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):e.jsx(Ve,{image:e.jsx(uo,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),e.jsx(Te,{}),e.jsx(K,{title:"Additional Amenities (Extra Charges)",children:x?e.jsxs("div",{children:[e.jsx(L.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:e.jsx(de,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:a,onChange:R,optionLabelProp:"label",children:((i==null?void 0:i.amenities)||[]).map(A=>e.jsxs(gm,{value:S(A),label:`${A.name} (${j(A.rate)})`,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(J,{children:[e.jsx(ns,{strong:!0,children:A.name}),e.jsx(le,{color:"blue",children:A.type})]}),e.jsx(ns,{style:{color:"#1890ff"},children:j(A.rate)})]}),e.jsx("div",{children:e.jsx(ns,{type:"secondary",children:A.description})})]},S(A)))})}),k.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(Te,{orientation:"left",children:"Selected Amenities"}),e.jsx(Ne,{dataSource:k,columns:T,pagination:!1,size:"small"})]})]}):e.jsx(Ve,{image:e.jsx(uo,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),e.jsx(L.Item,{name:"amenities",hidden:!0,children:e.jsx("input",{type:"hidden"})}),e.jsx(L.Item,{name:"selectedStalls",hidden:!0,children:e.jsx("input",{type:"hidden"})})]})},{Title:lr,Paragraph:ca,Text:We}=pe,da=({form:s,stallDetails:t=[],selectedStallId:n,selectedStallIds:i=[],selectedStalls:r=[],exhibition:o,onPrev:a,onFinish:u,loading:y=!1,formValues:d={}})=>{const[f,x]=l.useState([]),h=l.useMemo(()=>{const _=(s.getFieldValue("selectedStalls")||[]).map(g=>String(g));if(console.log("ReviewStep - Form has selectedStalls:",_),console.log("ReviewStep - Props selectedStallIds:",i),console.log("ReviewStep - Props selectedStalls:",r),_.length>0)return _;const N=[];if(n){const g=String(n);N.push(g)}return i&&i.length&&i.forEach(g=>{const $=String(g);N.includes($)||N.push($)}),r&&r.length&&r.forEach(g=>{const $=String(g);N.includes($)||N.push($)}),console.log("ReviewStep - Final consolidated stall IDs:",N),N},[s,n,i,r]);l.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",h),console.log("ReviewStep - Available stall details:",t),t&&t.length&&h.length){const p=t.filter(N=>h.includes(String(N.id)));console.log("ReviewStep - Matched stalls:",p.length);const _=p.map(N=>({key:N.id,id:N.id,number:N.number||N.stallNumber||`Stall ${N.id}`,hallName:N.hallName||`Hall ${N.hallId}`,size:`${N.dimensions.width}m  ${N.dimensions.height}m`,area:N.dimensions.width*N.dimensions.height,rate:N.ratePerSqm,price:N.price||N.ratePerSqm*N.dimensions.width*N.dimensions.height,type:N.typeName||N.type||"Standard"}));x(_)}},[t,h]);const R=s.getFieldValue("amenities")||[],S=l.useMemo(()=>{var w,D,M,V;const p=f.reduce((U,H)=>U+H.price,0),_=f.reduce((U,H)=>U+(H.area||0),0),N=((w=o==null?void 0:o.basicAmenities)==null?void 0:w.map(U=>{const H=Math.floor(_/U.perSqm)*U.quantity;return{...U,calculatedQuantity:H>0?H:0}}))||[];let g=0;const $=R.map(U=>{var Y;const H=(Y=o==null?void 0:o.amenities)==null?void 0:Y.find(Z=>Z.id===U||Z._id===U);return H?(g+=H.rate||0,{name:H.name,rate:H.rate,type:H.type,description:H.description}):null}).filter(Boolean),C=(((D=o==null?void 0:o.publicDiscountConfig)==null?void 0:D.filter(U=>U.isActive))||[]).map(U=>{const H=U.type==="percentage"?p*(Math.min(Math.max(0,U.value),100)/100):Math.min(U.value,p);return{name:U.name,type:U.type,value:U.value,amount:H}}),E=C.reduce((U,H)=>U+H.amount,0),P=p-E,m=P,B=((V=(M=o==null?void 0:o.taxConfig)==null?void 0:M.filter(U=>U.isActive))==null?void 0:V.map(U=>({name:U.name,rate:U.rate,amount:m*(U.rate/100)})))||[],I=B.reduce((U,H)=>U+H.amount,0);return{baseAmount:p,basicAmenities:N,totalStallArea:_,amenities:$,amenitiesTotal:g,discounts:C,totalDiscountAmount:E,amountAfterDiscount:P,subtotal:m,taxes:B,totalTaxAmount:I,total:m+I,stallCount:f.length}},[f,R,o]);l.useEffect(()=>{var _;const p=((_=o==null?void 0:o.publicDiscountConfig)==null?void 0:_.filter(N=>N.isActive))||[];if(p.length>0){const N=p[0];console.log("Setting discountId in form to:",N),s.setFieldsValue({discountId:{name:N.name,type:N.type,value:N.value}})}},[o,s]);const j=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:p=>e.jsx(le,{color:"purple",children:p})},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:p=>`${p} sqm`},{title:"Rate",dataIndex:"rate",key:"rate",render:p=>`${p}/sqm`},{title:"Price",dataIndex:"price",key:"price",render:p=>`${p.toLocaleString()}`}],k=p=>`${p.toLocaleString("en-IN")}`,v=d.customerName||s.getFieldValue("customerName"),T=d.customerPhone||s.getFieldValue("customerPhone"),A=d.email||s.getFieldValue("email"),c=d.companyName||s.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:v,companyName:c,customerPhone:T,customerEmail:A,formValues:d,formFieldValues:{customerName:s.getFieldValue("customerName"),companyName:s.getFieldValue("companyName"),customerPhone:s.getFieldValue("customerPhone"),email:s.getFieldValue("email")}}),y?e.jsx(cn,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:e.jsx(Pt,{size:"large",tip:"Processing your booking..."})}):h.length===0?e.jsxs(cn,{children:[e.jsx(He,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(O,{onClick:a,children:"Back to Stall Selection"})})]}):e.jsxs(cn,{children:[e.jsx(L.Item,{name:"discountId",hidden:!0,children:e.jsx(G,{})}),e.jsx(lr,{level:4,children:"Booking Summary"}),e.jsx(ca,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),e.jsx(K,{title:"Exhibitor Information",style:{marginBottom:24},children:e.jsxs(fe,{column:2,children:[e.jsx(fe.Item,{label:"Name",children:v||"Not provided"}),e.jsx(fe.Item,{label:"Company",children:c||"Not provided"}),e.jsx(fe.Item,{label:"Phone",children:T||"Not provided"}),e.jsx(fe.Item,{label:"Email",children:A||"Not provided"})]})}),e.jsxs(K,{title:"Selected Stalls",className:"review-card",size:"small",children:[e.jsx(Ne,{dataSource:f,columns:j,pagination:!1,size:"small",style:{marginBottom:16}}),e.jsxs(We,{strong:!0,children:["Total Base Amount: ",k(S.baseAmount)]})]}),S.basicAmenities&&S.basicAmenities.length>0&&e.jsxs(K,{title:e.jsxs(J,{children:[e.jsx(gt,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[e.jsxs(ca,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",S.totalStallArea," sqm."]}),e.jsx(Ne,{dataSource:S.basicAmenities.filter(p=>p.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(p,_)=>e.jsxs(J,{children:[e.jsx(We,{strong:!0,children:p}),e.jsx(le,{color:"blue",children:_.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:p=>e.jsxs(le,{color:"green",children:[p," ",p===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(p,_)=>e.jsxs(We,{type:"secondary",children:[e.jsx(Rt,{style:{marginRight:5}}),"1 ",_.quantity>1?`set of ${_.quantity}`:"unit"," per ",p," sqm"]})},{title:"Status",key:"status",width:100,align:"right",render:()=>e.jsx(We,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:e.jsx(He,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),S.amenities&&S.amenities.length>0&&e.jsxs(K,{title:"Selected Amenities",style:{marginBottom:24},children:[e.jsx(Ne,{dataSource:S.amenities.map((p,_)=>({...p,key:_})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(p,_)=>e.jsxs(J,{children:[e.jsx(We,{strong:!0,children:p}),e.jsx(le,{color:"blue",children:_.type})]})},{title:"Description",dataIndex:"description",key:"description",render:p=>e.jsx(We,{type:"secondary",style:{fontSize:"13px"},children:p||"No description provided"})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:p=>e.jsx(We,{strong:!0,style:{color:"#1890ff"},children:k(p)})}],pagination:!1,size:"small"}),e.jsx(Te,{}),e.jsx("div",{style:{textAlign:"right"},children:e.jsxs(We,{strong:!0,children:["Amenities Total: ",k(S.amenitiesTotal)]})})]}),e.jsxs(K,{title:"Price Calculation",style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(We,{children:"Base Amount:"}),e.jsx(We,{children:k(S.baseAmount)})]}),S.discounts.length>0&&e.jsxs(e.Fragment,{children:[S.discounts.map((p,_)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(We,{children:[p.name," (",p.type==="percentage"?`${p.value}%`:k(p.value),"):"]}),e.jsxs(We,{type:"danger",children:["- ",k(p.amount)]})]},_)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(We,{children:"Amount after Discount:"}),e.jsx(We,{children:k(S.amountAfterDiscount)})]})]}),S.amenitiesTotal>0&&e.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx(We,{type:"secondary",children:"Selected Amenities (for information only):"}),e.jsx(We,{type:"secondary",children:k(S.amenitiesTotal)})]}),e.jsx(We,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(We,{strong:!0,children:"Subtotal:"}),e.jsx(We,{strong:!0,children:k(S.subtotal)})]}),S.taxes.length>0&&e.jsx(e.Fragment,{children:S.taxes.map((p,_)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(We,{children:[p.name," (",p.rate,"%):"]}),e.jsx(We,{children:k(p.amount)})]},_))}),e.jsx(Te,{}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(lr,{level:5,children:"Total:"}),e.jsx(lr,{level:5,children:k(S.total)})]})]})]})},{confirm:fm}=je,ym=({visible:s,stallDetails:t,selectedStallId:n,selectedStallIds:i,loading:r,exhibition:o,onCancel:a,onSubmit:u})=>{const[y]=L.useForm(),[d,f]=l.useState(0),[x]=l.useState(3),[h,R]=l.useState({}),[S,j]=l.useState(!1),[k,v]=l.useState(!1),T=ge(C=>C.exhibitorAuth.exhibitor);l.useEffect(()=>{if(s){f(0),j(!1),R({}),y.resetFields();const C=i.map(m=>String(m));n&&C.push(String(n));const E=[...new Set(C)],P={selectedStalls:E,exhibitionId:o==null?void 0:o._id};T&&(P.customerName=T.contactPerson||"",P.companyName=T.companyName||"",P.email=T.email||"",P.customerPhone=T.phone||""),y.setFieldsValue(P),R(P),console.log("Booking form initialized with stalls:",E),console.log("Exhibitor profile data:",T)}},[s,y,n,i,o,T]);const A=()=>{j(!0)},c=()=>{S?fm({title:"Discard changes?",icon:e.jsx(qs,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){a()}}):a()},p=()=>{v(!0),y.validateFields().then(C=>{const E={...h,...C},P={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},m={...E,...P};R(m),console.log("Step completed, saving form values:",m),console.log("Selected stalls are:",m.selectedStalls||[]),console.log("Exhibitor info:",P),f(d+1),v(!1)}).catch(C=>{v(!1),console.error("Form validation failed:",C),se.error("Please complete all required fields")})},_=()=>{f(d-1)},N=()=>{y.validateFields().then(C=>{const E={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},P={...h,...C,...E};console.log("Submitting booking with values:",P),u(P)}).catch(C=>{console.error("Form validation failed:",C),se.error("Please complete all required fields")})},g=["Stall Details","Amenities","Review"],$=[{title:"Stall Details",icon:e.jsx(Zl,{}),content:e.jsx(oa,{form:y,stallDetails:t,selectedStallId:n,selectedStallIds:i,exhibition:o})},{title:"Amenities",icon:e.jsx(bn,{}),content:e.jsx(la,{form:y,stallDetails:t,selectedStallIds:y.getFieldValue("selectedStalls")||[],exhibition:o,formValues:h})},{title:"Review",icon:e.jsx(Be,{}),content:e.jsx(da,{form:y,formValues:h,loading:r,exhibition:o,selectedStalls:y.getFieldValue("selectedStalls")||[],selectedStallIds:y.getFieldValue("selectedStalls")||[],stallDetails:t})}];l.useEffect(()=>{const C=y.getFieldValue("selectedStalls");console.log(`Step ${d} - Form has selectedStalls:`,C)},[d,y]);const b=C=>{const E=y.getFieldValue("selectedStalls")||[],P={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},m={...h,...P};switch(console.log(`Rendering step ${C} with:`,{selectedStalls:E,exhibitorInfo:P}),C){case 0:return e.jsx(oa,{form:y,stallDetails:t,selectedStallId:n,selectedStallIds:i,exhibition:o});case 1:return e.jsx(la,{form:y,stallDetails:t,selectedStallIds:E,exhibition:o,formValues:m});case 2:return e.jsx(da,{form:y,formValues:m,loading:r,exhibition:o,selectedStalls:E,selectedStallIds:E,stallDetails:t,onPrev:_,onFinish:N});default:return null}};return e.jsx(dm,{title:`Book Exhibition Stall - ${g[d]}`,open:s,onCancel:c,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[d>0&&e.jsx(ar,{onClick:_,disabled:k||r,size:"large",children:"Back"}),e.jsx("div",{children:d<x-1?e.jsx(ar,{type:"primary",onClick:p,loading:k,disabled:r,size:"large",children:"Next"}):e.jsx(ar,{type:"primary",onClick:N,loading:r,disabled:k,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:e.jsxs(Pt,{spinning:r||k,tip:r?"Processing your booking...":"Validating...",children:[e.jsx(um,{children:$.map((C,E)=>e.jsxs("div",{className:`step-item ${d===E?"active":""} ${d>E?"completed":""}`,onClick:()=>d>E?f(E):null,style:{cursor:d>E?"pointer":"default"},children:[e.jsx("span",{className:"step-icon",children:d>E?e.jsx(Fr,{}):E+1}),C.title]},E))}),e.jsx(L,{form:y,layout:"vertical",preserve:!0,onFieldsChange:A,children:b(d)},`form-step-${d}`)]})})},{Step:cr}=jn,{Text:bm}=pe,jm=({loginModalVisible:s,registerModalVisible:t,setRegisterModalVisible:n,setExhibitorCredentials:i,onForgotPassword:r})=>{const o=Re(),a=ge(U=>U.exhibitorAuth),[u,y]=l.useState(!1),[d,f]=l.useState(null),[x]=L.useForm(),[h]=L.useForm(),[R]=L.useForm(),[S,j]=l.useState(0),[k,v]=l.useState(""),[T,A]=l.useState(!1),[c,p]=l.useState(!1),[_,N]=l.useState(0),[g,$]=l.useState({companyName:"",contactPerson:""}),b=l.useRef(null),C=async U=>{var H,Y,Z,q,X,z,ee,ce,ae;try{f(null),y(!0);const Q=await rt.login(U),{exhibitor:re,token:be}=Q.data;if(!re||!be)throw new Error("Invalid response from server");i({exhibitor:re,token:be}),o(In()),x.resetFields(),se.success("Login successful!")}catch(Q){if(((H=Q.response)==null?void 0:H.status)===403){const re=(Z=(Y=Q.response)==null?void 0:Y.data)==null?void 0:Z.status;if(re==="pending")f("Your account is pending approval. You will be able to log in after admin approval.");else if(re==="rejected"){const be=(X=(q=Q.response)==null?void 0:q.data)==null?void 0:X.rejectionReason;f(be?`Your registration has been rejected. Reason: ${be}`:"Your registration has been rejected. Please contact the administrator for more details.")}else f(((ee=(z=Q.response)==null?void 0:z.data)==null?void 0:ee.message)||"Access denied. Please contact administrator.")}else f(((ae=(ce=Q.response)==null?void 0:ce.data)==null?void 0:ae.message)||"Login failed. Please try again.")}finally{y(!1)}},E=async()=>{var U,H;try{const Y=await h.validateFields(["email","companyName","contactPerson"]);y(!0),f(null),v(Y.email),$({companyName:Y.companyName,contactPerson:Y.contactPerson}),await rt.sendRegistrationOTP(Y.email),A(!0),se.success("OTP sent to your email address"),N(60),P(),j(1)}catch(Y){if(Y.name==="ValidationError")return;const Z=((H=(U=Y.response)==null?void 0:U.data)==null?void 0:H.message)||"Failed to send OTP. Please try again.";f(Z),se.error(Z)}finally{y(!1)}},P=()=>{b.current&&clearInterval(b.current),b.current=setInterval(()=>{N(U=>U<=1?(b.current&&clearInterval(b.current),0):U-1)},1e3)},m=async()=>{var U,H;try{y(!0),f(null),await rt.sendRegistrationOTP(k),se.success("New OTP sent to your email address"),N(60),P()}catch(Y){const Z=((H=(U=Y.response)==null?void 0:U.data)==null?void 0:H.message)||"Failed to resend OTP. Please try again.";f(Z),se.error(Z)}finally{y(!1)}},B=async U=>{var H,Y;try{y(!0),f(null);const Z={email:k,otp:U.otp};await rt.verifyOTP(Z),p(!0),se.success("Email verified successfully"),b.current&&clearInterval(b.current),j(2)}catch(Z){const q=((Y=(H=Z.response)==null?void 0:H.data)==null?void 0:Y.message)||"Invalid OTP. Please try again.";f(q),se.error(q)}finally{y(!1)}},I=()=>{A(!1),p(!1),v(""),N(0),j(0),$({companyName:"",contactPerson:""}),b.current&&clearInterval(b.current),R.resetFields()},w=async U=>{var H,Y,Z;try{if(f(null),y(!0),!c){f("Email verification required");return}const{confirmPassword:q,...X}=U,z={...X,email:k,companyName:g.companyName,contactPerson:g.contactPerson};console.log("Sending registration data:",z);const ee=await rt.register(z);se.success("Registration successful! You can log in and book a stall only after admin approval."),n(!1),h.resetFields(),I(),setTimeout(()=>{o(js(void 0))},500)}catch(q){console.error("Registration error:",q),console.error("Response data:",(H=q.response)==null?void 0:H.data);const X=((Z=(Y=q.response)==null?void 0:Y.data)==null?void 0:Z.message)||"Registration failed. Please try again.";f(X),se.error(X)}finally{y(!1)}};De.useEffect(()=>()=>{b.current&&clearInterval(b.current)},[]);const D=()=>{n(!1),f(null),h.resetFields(),I()},M=()=>{o(In()),n(!0),x.resetFields()},V=()=>{n(!1),o(js(void 0)),h.resetFields()};return e.jsxs(e.Fragment,{children:[e.jsxs(je,{title:"Exhibitor Login",open:s,onCancel:()=>{o(In()),f(null),x.resetFields()},footer:null,width:400,children:[a.loginContext==="stall-booking"&&e.jsx(He,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),d&&e.jsx(He,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:x,name:"exhibitor_login_modal",onFinish:C,layout:"vertical",children:[e.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(G,{prefix:e.jsx(Ot,{}),placeholder:"Email",size:"large",disabled:u})}),e.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Password",size:"large",disabled:u})}),e.jsxs(L.Item,{children:[e.jsx("div",{style:{textAlign:"right",marginBottom:10},children:e.jsx(O,{type:"link",onClick:()=>{o(In()),r()},style:{padding:0},children:"Forgot password?"})}),e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Login"})]})]}),e.jsx(Te,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),e.jsx(O,{type:"default",block:!0,onClick:M,children:"Register as Exhibitor"})]}),e.jsxs(je,{title:"Exhibitor Registration",open:t,onCancel:D,footer:null,width:500,children:[e.jsxs(jn,{current:S,style:{marginBottom:24},children:[e.jsx(cr,{title:"Basic Info"}),e.jsx(cr,{title:"Verify Email"}),e.jsx(cr,{title:"Complete"})]}),d&&e.jsx(He,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),S===0&&e.jsxs(e.Fragment,{children:[e.jsx(He,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:h,name:"exhibitor_register_step1",layout:"vertical",children:[e.jsx(L.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:e.jsx(G,{prefix:e.jsx(qr,{}),placeholder:"Company Name",size:"large",disabled:u})}),e.jsx(L.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:e.jsx(G,{prefix:e.jsx(Pe,{}),placeholder:"Contact Person",size:"large",disabled:u})}),e.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(G,{prefix:e.jsx(Ot,{}),placeholder:"Email",size:"large",disabled:u})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",onClick:E,block:!0,size:"large",loading:u,children:"Continue & Verify Email"})})]}),e.jsx(Te,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),e.jsx(O,{type:"default",block:!0,onClick:V,children:"Login"})]}),S===1&&e.jsxs(e.Fragment,{children:[e.jsx(He,{message:"Email Verification",description:`We've sent a verification code to ${k}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:R,name:"verify_otp",onFinish:B,layout:"vertical",children:[e.jsx(L.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:e.jsx(G,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:u})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Verify & Continue"})})]}),e.jsxs(ie,{justify:"space-between",align:"middle",style:{marginTop:16},children:[e.jsx(F,{children:e.jsx(O,{type:"link",disabled:_>0||u,onClick:m,children:"Resend Code"})}),e.jsx(F,{children:_>0&&e.jsxs(bm,{type:"secondary",children:["Resend in ",_,"s"]})})]}),e.jsx(Te,{}),e.jsx(O,{type:"default",block:!0,onClick:()=>j(0),children:"Back"})]}),S===2&&e.jsxs(e.Fragment,{children:[e.jsx(He,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),e.jsxs(L,{form:h,name:"exhibitor_register_step2",onFinish:w,layout:"vertical",children:[e.jsx(L.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:e.jsx(G,{prefix:e.jsx(Or,{}),placeholder:"Phone Number",size:"large",disabled:u})}),e.jsx(L.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:e.jsx(G.TextArea,{placeholder:"Address",rows:3,disabled:u})}),e.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Password",size:"large",disabled:u})}),e.jsx(L.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:U})=>({validator(H,Y){return!Y||U("password")===Y?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Confirm Password",size:"large",disabled:u})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Complete Registration"})})]})]})]})]})},{Step:wg}=jn,{Text:Sg}=pe,vm=({visible:s})=>{const t=Re(),[n,i]=l.useState(!1),[r,o]=l.useState(null),[a,u]=l.useState(0),[y,d]=l.useState(""),[f,x]=l.useState(!1),[h,R]=l.useState(0),S=L.useForm()[0],j=L.useForm()[0],k=L.useForm()[0],v=l.useRef(null),T=async b=>{var C,E;try{i(!0),o(null);const P=await rt.requestPasswordReset(b);d(b.email),x(!0),u(1),se.success("Password reset code sent to your email"),R(60),A()}catch(P){const m=((E=(C=P.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to send password reset code. Please try again.";o(m)}finally{i(!1)}},A=()=>{v.current&&clearInterval(v.current),v.current=setInterval(()=>{R(b=>b<=1?(v.current&&clearInterval(v.current),0):b-1)},1e3)},c=async()=>{var b,C;try{i(!0),o(null),await rt.requestPasswordReset({email:y}),se.success("New password reset code sent to your email"),R(60),A()}catch(E){const P=((C=(b=E.response)==null?void 0:b.data)==null?void 0:C.message)||"Failed to resend password reset code. Please try again.";o(P)}finally{i(!1)}},p=async b=>{var C,E;try{i(!0),o(null),u(2),v.current&&clearInterval(v.current)}catch(P){const m=((E=(C=P.response)==null?void 0:C.data)==null?void 0:E.message)||"Invalid code. Please try again.";o(m)}finally{i(!1)}},_=async b=>{var C,E;try{i(!0),o(null);const P=j.getFieldValue("otp"),m={email:y,otp:P,newPassword:b.newPassword};await rt.resetPassword(m),se.success("Password reset successful. You can now log in with your new password."),N(),t(Oi()),t(js())}catch(P){const m=((E=(C=P.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to reset password. Please try again.";o(m)}finally{i(!1)}},N=()=>{u(0),d(""),x(!1),R(0),v.current&&clearInterval(v.current),S.resetFields(),j.resetFields(),k.resetFields()},g=()=>{N(),t(Oi())},$=()=>{N(),t(Oi()),t(js())};return De.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),e.jsxs(je,{title:"Forgot Password",open:s,onCancel:g,footer:null,width:400,children:[r&&e.jsx(He,{message:r,type:"error",style:{marginBottom:16}}),e.jsx(jn,{current:a,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),a===0&&e.jsxs(L,{form:S,onFinish:T,layout:"vertical",children:[e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Ot,{}),placeholder:"Email"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Send Reset Code"})}),e.jsx(Te,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),e.jsx(O,{type:"link",onClick:$,block:!0,children:"Back to Login"})]}),a===1&&e.jsxs(L,{form:j,onFinish:p,layout:"vertical",children:[e.jsxs("p",{children:["We've sent a verification code to ",e.jsx("strong",{children:y}),". Please check your email and enter the code below."]}),e.jsx(L.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:e.jsx(G,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Verify Code"})}),e.jsx("div",{style:{textAlign:"center",marginTop:8},children:h>0?e.jsxs(pe.Text,{type:"secondary",children:["Resend code in ",h,"s"]}):e.jsx(O,{type:"link",onClick:c,disabled:n,children:"Resend Code"})}),e.jsx(Te,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),e.jsx(O,{type:"link",onClick:()=>{u(0),v.current&&(clearInterval(v.current),R(0))},block:!0,children:"Change Email"})]}),a===2&&e.jsxs(L,{form:k,onFinish:_,layout:"vertical",children:[e.jsx(L.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"New Password"})}),e.jsx(L.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:b})=>({validator(C,E){return!E||b("newPassword")===E?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Kt,{}),placeholder:"Confirm Password"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Reset Password"})})]})]})},{Header:wm}=qe,Sm=te(wm)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,km=te.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,Cm=te.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,Im=te.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,Em=te.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,ua=te(wt)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,ha=te(jt)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,Am=te(jt)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,Tm=te(O)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,Nm=te.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,Pm=te(pt)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,Bn=te(O)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,Rm=te.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,_m=te.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,At=()=>{var g;const s=Ie(),t=Re(),[n,i]=l.useState(!1),[r,o]=l.useState(!1),[a,u]=l.useState(!1),[y,d]=l.useState("/logo.png"),[f,x]=l.useState("Exhibition Manager"),h=ge($=>$.exhibitorAuth),{exhibitor:R,isAuthenticated:S,showLoginModal:j,showForgotPasswordModal:k}=h;l.useEffect(()=>{const $=localStorage.getItem("cachedLogoUrl"),b=localStorage.getItem("logoTimestamp"),C=new Date().getTime();if($&&b&&C-parseInt(b)<36e5)d($);else{const E=`${ne.defaults.baseURL}/public/logo`;d(E),localStorage.setItem("cachedLogoUrl",E),localStorage.setItem("logoTimestamp",C.toString());const P=new Image;P.src=E}fetch(`${ne.defaults.baseURL}/public/site-info`).then(E=>E.json()).then(E=>{E.siteName&&x(E.siteName)}).catch(E=>{console.error("Error fetching site info:",E)})},[]),l.useEffect(()=>(se.config({top:84,duration:3,maxCount:1}),()=>{se.destroy()}),[]);const v=()=>{t(sl()),se.success("Successfully logged out"),s("/"),i(!1),o(!1)},T=()=>{t(js(void 0)),i(!1),o(!1)},A=()=>{u(!0),i(!1),o(!1)},c=()=>{t(ru())},p=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],_=e.jsx(ha,{items:[{key:"exhibitor-login",icon:e.jsx(ho,{}),label:e.jsx("a",{onClick:T,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:e.jsx(dn,{}),label:e.jsx("a",{onClick:A,children:"Register as Exhibitor"})}]}),N=e.jsx(ha,{items:[{key:"exhibitor-dashboard",icon:e.jsx(yi,{}),label:e.jsx(pt,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:e.jsx(Pe,{}),label:e.jsx(pt,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:e.jsx(ut,{}),label:e.jsx(pt,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:e.jsx(fi,{}),label:e.jsx("a",{onClick:v,children:"Logout"})}]});return e.jsxs(e.Fragment,{children:[e.jsx(Sm,{children:e.jsxs(km,{children:[e.jsx(Cm,{children:e.jsx(pt,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:e.jsx(Im,{children:e.jsx(Em,{src:y,alt:"Logo",onError:()=>d("/logo.png")})})})}),e.jsx(Am,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:p.map($=>({key:$.key,label:e.jsx(pt,{to:$.path,children:$.label})}))}),e.jsx(Rm,{children:e.jsx(vs,{overlay:h.isAuthenticated?N:_,trigger:["click"],placement:"bottomRight",open:n,onOpenChange:i,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:h.isAuthenticated?e.jsxs(J,{style:{cursor:"pointer"},children:[e.jsx(_m,{children:((g=h.exhibitor)==null?void 0:g.companyName)||"Exhibitor"}),e.jsx(ua,{icon:e.jsx(Pe,{}),size:"large"})]}):e.jsx(ua,{icon:e.jsx(Pe,{}),size:"large"})})}),e.jsx(Tm,{icon:e.jsx(ec,{}),onClick:()=>o(!0)})]})}),e.jsx(Nm,{children:e.jsxs(tc,{title:"Exhibition Management System",placement:"right",onClose:()=>o(!1),open:r,width:280,closeIcon:e.jsx("span",{style:{fontSize:"16px"},children:""}),children:[e.jsx("div",{style:{marginBottom:24},children:p.map($=>e.jsx(Pm,{to:$.path,onClick:()=>o(!1),children:$.label},$.key))}),e.jsx("div",{style:{marginTop:40},children:h.isAuthenticated?e.jsxs(e.Fragment,{children:[e.jsx(Bn,{type:"primary",icon:e.jsx(yi,{}),onClick:()=>{s("/exhibitor/dashboard"),o(!1)},children:"Dashboard"}),e.jsx(Bn,{type:"default",icon:e.jsx(fi,{}),onClick:v,children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Bn,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:e.jsx(ho,{}),onClick:()=>{T(),o(!1)},children:"Exhibitor Login"}),e.jsx(Bn,{type:"default",icon:e.jsx(dn,{}),onClick:()=>{A(),o(!1)},children:"Register as Exhibitor"})]})})]})}),e.jsx(jm,{loginModalVisible:j,registerModalVisible:a,setRegisterModalVisible:u,setExhibitorCredentials:$=>t(Pr($)),onForgotPassword:c}),e.jsx(vm,{visible:k})]})},{Content:Mn}=qe,{Title:kg}=pe,Dm=s=>{if(!s)return"";if(s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;if(t.includes("logos/"))return`${ne.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},Lm=()=>{var D,M,V,U;const{id:s}=ft(),t=Ie(),n=Re(),[i,r]=l.useState(null),[o,a]=l.useState(null),[u,y]=l.useState(null),[d,f]=l.useState([]),[x,h]=l.useState(!1),[R,S]=l.useState(!0),[j,k]=l.useState(null),[v,T]=l.useState(!1),[A,c]=l.useState(null),p=l.useRef(null),[_,N]=l.useState({width:800,height:600}),[g,$]=l.useState(!1),[b]=L.useForm(),{isAuthenticated:C}=ge(H=>H.exhibitorAuth);l.useEffect(()=>{const H=()=>{$(window.innerWidth<768)};return H(),window.addEventListener("resize",H),()=>{window.removeEventListener("resize",H)}},[]);const E=l.useCallback(H=>H.status==="booked"||H.status==="reserved",[]),P=l.useCallback(()=>{if(p.current){const{clientWidth:H,clientHeight:Y}=p.current,Z=g?320:800,q=g?480:600,X=Math.max(H||Z,Z),z=Math.max(Y||q,q);(Math.abs(X-_.width)>5||Math.abs(z-_.height)>5)&&N({width:X,height:z})}},[_.width,_.height,g]);l.useEffect(()=>{let H=null;const Y=()=>{H===null&&(H=window.setTimeout(()=>{H=null,P()},g?100:50))};P();const Z=new ResizeObserver(Y);return p.current&&Z.observe(p.current),window.addEventListener("resize",Y),()=>{H!==null&&window.clearTimeout(H),Z.disconnect(),window.removeEventListener("resize",Y)}},[P,g]),l.useEffect(()=>{(async()=>{try{if(!s){k("Exhibition ID is missing"),S(!1);return}S(!0),k(null);const Y=await mt.getLayout(s);r(Y.data)}catch(Y){k(Y.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",Y)}finally{S(!1)}})()},[s]),l.useEffect(()=>{i&&P()},[i]),l.useEffect(()=>{C&&i&&(y(null),f([]),P(),se.info("You can now select stalls to book.",3))},[C]);const m=l.useCallback(async H=>{if(E(H)){se.info(`This stall (${H.stallNumber}) is already booked.`);return}if(!C){n(js("stall-booking"));return}const Z=H._id||H.id;f(q=>q.includes(Z)?(se.info(`Stall ${H.stallNumber} removed from selection`),q.filter(X=>X!==Z)):(se.success(`Stall ${H.stallNumber} added to selection`),[...q,Z]))},[E,C,n]),B=async H=>{try{T(!0);const Y={...H,exhibitionId:i==null?void 0:i.exhibition._id,stallIds:H.selectedStalls};if(C){const Z=await mt.exhibitorBookStalls(Y);se.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const Z=await mt.bookMultipleStalls(s,Y);se.success("Your booking request has been submitted successfully!")}if(h(!1),f([]),s)try{const Z=await mt.getLayout(s);r(Z.data)}catch(Z){console.error("Error refreshing layout data:",Z)}}catch(Y){console.error("Error booking stall",Y),se.error("Failed to book stall. Please try again.")}finally{T(!1)}},I=async()=>{var H;try{if(!i)return;T(!0);let Y=null;if(u){const q=i.layout.find(X=>X.stalls.some(z=>z.id===u));q?Y=q.stalls.find(X=>X.id===u)||null:console.error("Selected stall not found in any hall")}const Z=i.layout.flatMap(q=>q.stalls.map(X=>({...X,hallId:q.id,hallName:q.name}))).filter(q=>q.status==="available");if(d.length===0&&u===null&&Z.length===0){se.error("No stalls are available for booking");return}if(!i.exhibition.basicAmenities)try{const q=await mt.getExhibition(s||"");(H=q==null?void 0:q.data)!=null&&H.basicAmenities&&r({...i,exhibition:{...i.exhibition,basicAmenities:q.data.basicAmenities}})}catch(q){console.error("Error fetching exhibition details with amenities:",q)}c(Z),h(!0)}catch(Y){console.error("Error opening booking modal:",Y),se.error("Failed to open booking form")}finally{T(!1)}};l.useCallback(H=>{H.cancelBubble=!0},[]);const w=l.useMemo(()=>{var H;return i?{halls:i.layout.map(Y=>e.jsx(wl,{hall:{...Y,exhibitionId:s||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},Y.id)),stalls:i.layout.flatMap(Y=>Y.stalls.map(Z=>{var q,X,z,ee,ce,ae,Q,re;return e.jsx(oo,{stall:{...Z,hallId:Y.id,hallName:Y.name,isSelected:d.includes(Z.id),stallTypeId:"default",number:Z.stallNumber,typeName:Z.type||"Standard",ratePerSqm:Z.price||0,rotation:0,dimensions:{x:((q=Z.position)==null?void 0:q.x)||0,y:((X=Z.position)==null?void 0:X.y)||0,width:((z=Z.dimensions)==null?void 0:z.width)||0,height:((ee=Z.dimensions)==null?void 0:ee.height)||0},status:Z.status==="maintenance"?"booked":Z.status},isSelected:u===Z.id||d.includes(Z.id),onSelect:Z.status==="available"?()=>m(Z):void 0,hallWidth:((ce=Y.dimensions)==null?void 0:ce.width)||0,hallHeight:((ae=Y.dimensions)==null?void 0:ae.height)||0,hallX:((Q=Y.dimensions)==null?void 0:Q.x)||0,hallY:((re=Y.dimensions)==null?void 0:re.y)||0},Z.id)})),fixtures:(H=i.fixtures)==null?void 0:H.map(Y=>{var Z,q;return e.jsx(Sl,{fixture:{...Y,id:Y.id||Y._id,_id:Y._id||Y.id,exhibitionId:s||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((Z=i.exhibition.dimensions)==null?void 0:Z.width)||0,exhibitionHeight:((q=i.exhibition.dimensions)==null?void 0:q.height)||0},Y.id||Y._id)})}:null},[i,s,u,d,m]);return R?e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(Mn,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Pt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):j||!i?e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(Mn,{style:{paddingTop:"64px"},children:e.jsx(pn,{status:"error",title:"Failed to load exhibition layout",subTitle:j||"The exhibition layout couldn't be loaded.",extra:[e.jsx(O,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((D=i.exhibition.dimensions)!=null&&D.width)||!((M=i.exhibition.dimensions)!=null&&M.height)?e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(Mn,{style:{paddingTop:"64px"},children:e.jsx(K,{children:e.jsx(pn,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):e.jsxs(qe,{children:[e.jsx(At,{}),e.jsxs(Mn,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[g&&e.jsx("div",{style:{height:"16px",width:"100%"}}),e.jsxs(K,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:g?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:g?"5px":"24px"},children:[e.jsxs(ie,{gutter:[24,24],style:{marginBottom:g?16:32},children:[e.jsx(F,{xs:24,sm:24,md:12,children:e.jsxs("div",{style:{padding:g?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:g?"column":"row",alignItems:g?"flex-start":"center",gap:g?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:g?"center":"flex-start",width:g?"100%":"auto"},children:i.exhibition.headerLogo?e.jsx(Aa,{src:Dm(i.exhibition.headerLogo),alt:`${i.exhibition.name} logo`,style:{maxHeight:g?70:90,maxWidth:g?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:g?200:250,height:g?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:e.jsx(Pt,{size:"small"})})}):e.jsx("div",{style:{width:g?70:90,height:g?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Et,{style:{fontSize:g?24:32,color:"#aaa"}})})}),!g&&e.jsx(Te,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),e.jsxs("div",{style:{flex:1,width:g?"100%":"auto"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:g?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i.exhibition.name}),e.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:g?"13px":"14px"},children:[e.jsx(Et,{style:{fontSize:g?"14px":"16px",color:"#1890ff"}}),e.jsxs("span",{children:[new Date(i.exhibition.startDate).toLocaleDateString()," -",new Date(i.exhibition.endDate).toLocaleDateString()]})]}),e.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:g?"13px":"14px"},children:[e.jsx(Rt,{style:{fontSize:g?"14px":"16px",color:"#1890ff"}}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:g?"nowrap":"normal",maxWidth:g?"260px":"none"},children:i.exhibition.venue})]})]})]})}),e.jsx(F,{xs:24,sm:24,md:12,children:e.jsxs("div",{style:{padding:g?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{marginBottom:"16px",fontSize:g?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),e.jsxs("div",{style:{display:"flex",flexDirection:g?"column":"row",justifyContent:"center",alignItems:"center",gap:g?"10px":"16px",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:g?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[e.jsx(gt,{status:"success"}),e.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:g?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[e.jsx(gt,{status:"processing",color:"#1890ff"}),e.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:g?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[e.jsx(gt,{status:"warning"}),e.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),e.jsxs("div",{ref:p,style:{width:"100%",height:g?"70vh":"80vh",minHeight:g?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[e.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Base canvas optimization */
                .konvajs-content {
                  will-change: transform;
                  transform: translateZ(0);
                  backface-visibility: hidden;
                  transition: filter 0.2s ease-out;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Canvas optimization for all canvases */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                  transition: filter 0.15s linear;
                }
                
                /* Dragging state - apply blur effect with better control */
                .public-canvas-container .konvajs-content.dragging {
                  filter: blur(1px);
                }
                
                /* Mobile-specific blur - slightly stronger */
                @media (max-width: 768px) {
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(1.5px);
                  }
                }
                
                /* Performance optimizations for dragging */
                .public-canvas-container .konvajs-content:active canvas {
                  image-rendering: optimizeSpeed;
                }
                
                /* Touch device optimizations */
                @media (pointer: coarse) {
                  .public-canvas-container .konvajs-content:active {
                    touch-action: none;
                  }
                  
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(2px); /* Stronger blur for touch devices */
                  }
                }
                
                /* Animation smoothing to reduce flickering */
                .public-canvas-container .konvajs-content canvas {
                  will-change: filter;
                  transform: translateZ(0);
                }
                
                /* Low-end device optimizations */
                @media (max-width: 480px), 
                       (resolution: 150dpi),
                       (any-pointer: coarse) {
                  .public-canvas-container .konvajs-content:active canvas {
                    image-rendering: optimizeSpeed;
                  }
                }
              `}),e.jsxs(Sn,{width:_.width,height:_.height,exhibitionWidth:((V=i==null?void 0:i.exhibition.dimensions)==null?void 0:V.width)||0,exhibitionHeight:((U=i==null?void 0:i.exhibition.dimensions)==null?void 0:U.height)||0,halls:(i==null?void 0:i.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[w==null?void 0:w.halls,w==null?void 0:w.stalls,w==null?void 0:w.fixtures]})]})]})]}),d.length>0&&e.jsx(sc,{offsetBottom:20,children:e.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:e.jsxs(O,{type:"primary",size:"large",icon:e.jsx(vr,{}),onClick:I,loading:v,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",d.length,")"]})})}),e.jsx(ym,{visible:x,stallDetails:A,selectedStallId:u,selectedStallIds:d,loading:v,exhibition:i==null?void 0:i.exhibition,onCancel:()=>{h(!1)},onSubmit:B})]})},$m=De.memo(Lm),{Content:dr}=qe,{Title:ur,Text:ps,Paragraph:pa}=pe,hr=s=>{if(!s)return"";if(s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;if(t.includes("logos/")||t.includes("sponsors/"))return`${ne.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},Fm=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},zn=s=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},Bm=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);if(n<i){const o=i.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} until start`,count:a,isPast:!1}}else if(n>r){const o=n.getTime()-r.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} since end`,count:a,isPast:!0}}else{const o=r.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} remaining`,count:a,isPast:!1}}},Mm=()=>{const{id:s}=ft(),t=Ie(),[n,i]=l.useState(null),[r,o]=l.useState(!0),[a,u]=l.useState(null),[y,d]=l.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(l.useEffect(()=>{(async()=>{try{if(!s){u("Exhibition ID is missing");return}o(!0),u(null);const S=await mt.getExhibition(s);if(i(S.data),S.data.headerBackground){const j=hr(S.data.headerBackground);d(j);const k=new window.Image;k.src=j}else if(S.data.headerLogo){const j=hr(S.data.headerLogo),k=new window.Image;k.src=j}}catch(S){console.error("Error fetching exhibition:",S),u(S.message||"Error fetching exhibition")}finally{o(!1)}})()},[s]),r)return e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(dr,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Pt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(a||!n)return e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(dr,{style:{paddingTop:"64px"},children:e.jsx(pn,{status:"404",title:"Exhibition not found",subTitle:a||"The exhibition you're looking for doesn't exist or has been removed.",extra:e.jsx(O,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:f,color:x}=Fm(n.startDate,n.endDate),h=Bm(n.startDate,n.endDate);return e.jsxs(qe,{className:"exhibition-details-layout",children:[e.jsx(At,{}),e.jsxs(dr,{className:"exhibition-content",children:[e.jsx("div",{className:"breadcrumb-container",children:e.jsx(nc,{items:[{title:e.jsx(pt,{to:"/",children:e.jsx(qr,{})})},{title:e.jsx(pt,{to:"/exhibitions",children:"Exhibitions"})},{title:n.name}]})}),e.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${y}')`},children:e.jsx("div",{className:"hero-overlay",children:e.jsxs("div",{className:"hero-content",children:[e.jsxs("div",{className:"hero-main",children:[e.jsx(ur,{level:1,className:"exhibition-title",children:n.name}),e.jsxs(J,{size:24,className:"exhibition-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx(Et,{}),e.jsxs(ps,{children:[zn(n.startDate)," - ",zn(n.endDate)]})]}),n.venue&&e.jsxs("div",{className:"meta-item",children:[e.jsx(ys,{}),e.jsx(ps,{children:n.venue})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(et,{}),e.jsxs(ps,{children:[h.text,": ",e.jsx("strong",{children:h.count})]})]})]})]}),e.jsxs("div",{className:"hero-actions",children:[e.jsx(O,{type:"primary",size:"large",icon:e.jsx(Ss,{}),onClick:()=>t(`/exhibitions/${s}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),e.jsx(O,{size:"large",icon:e.jsx(ut,{}),onClick:()=>t(`/exhibitions/${s}/layout`),className:"action-button book-button",children:"Book a Stall"}),h.isPast?null:e.jsx(O,{size:"large",icon:e.jsx(Mr,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),e.jsx("div",{className:"stats-container",children:e.jsxs(ie,{gutter:[16,16],className:"stats-row",children:[e.jsx(F,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon duration-icon",children:e.jsx(Et,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:Math.ceil((new Date(n.endDate).getTime()-new Date(n.startDate).getTime())/(1e3*60*60*24))}),e.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),e.jsx(F,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon countdown-icon",children:e.jsx(et,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:h.count}),e.jsx("div",{className:"stat-label",children:h.text})]})]})}),e.jsx(F,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:x+"20",color:x},children:e.jsx(Rt,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value status-value",style:{color:x},children:f}),e.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),n.sponsorLogos&&n.sponsorLogos.length>0&&e.jsxs("div",{className:"sponsors-section",children:[e.jsx("div",{className:"sponsors-header",children:e.jsx(ps,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),e.jsx("div",{className:"sponsors-container",children:n.sponsorLogos.map((R,S)=>e.jsx("div",{className:"sponsor-logo-wrapper",children:e.jsx("div",{className:"sponsor-logo",children:e.jsx("img",{src:hr(R),alt:`Sponsor ${S+1}`,className:"sponsor-logo-img",onError:j=>{j.target.src="/placeholder-logo.png"}})})},S))})]}),e.jsx("div",{className:"exhibition-details-container",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:24,lg:16,children:e.jsxs(K,{className:"details-card about-card",bordered:!1,children:[e.jsx(ur,{level:3,className:"section-title",children:"About This Exhibition"}),e.jsx(pa,{className:"main-description",children:n.description}),n.headerDescription&&e.jsx(pa,{className:"extended-description",children:n.headerDescription}),n.headerSubtitle&&e.jsxs("div",{className:"subtitle-section",children:[e.jsx(ur,{level:4,children:n.headerSubtitle}),e.jsx(Te,{})]})]})}),e.jsx(F,{xs:24,lg:8,children:e.jsx(J,{direction:"vertical",style:{width:"100%"},size:24,children:e.jsx(K,{title:"Key Information",className:"details-card info-card",bordered:!1,children:e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon start-icon",children:e.jsx(Et,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(ps,{type:"secondary",className:"info-label",children:"Start Date"}),e.jsx("div",{className:"info-value",children:zn(n.startDate)})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon end-icon",children:e.jsx(Et,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(ps,{type:"secondary",className:"info-label",children:"End Date"}),e.jsx("div",{className:"info-value",children:zn(n.endDate)})]})]}),n.venue&&e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon venue-icon",children:e.jsx(ys,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(ps,{type:"secondary",className:"info-label",children:"Venue"}),e.jsx("div",{className:"info-value",children:n.venue})]})]})]})})})})]})})]}),e.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:zm}=qe,{Title:qm,Paragraph:Om,Text:Um}=pe,Vm=te(zm)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Hm=te.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,qn=te(qm)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Wm=te.div`
  margin-bottom: 20px;
`,Ym=te.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,_t=te(pt)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,pr=te.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,mr=te.div`
  margin-right: 10px;
  color: #4158D0;
`,On=te.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Qm=te(G)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,Gm=te(O)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Km=te(Um)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Xm=te(Te)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,kl=()=>{const[s,t]=l.useState("/logo.png"),[n,i]=l.useState("Exhibition Manager"),r=new Date().getFullYear();return l.useEffect(()=>{const o=`${ne.defaults.baseURL}/public/logo`;t(o),fetch(`${ne.defaults.baseURL}/public/site-info`).then(a=>a.json()).then(a=>{a.siteName&&i(a.siteName)}).catch(a=>{console.error("Error fetching site info:",a)})},[]),e.jsx(Vm,{children:e.jsxs(Hm,{children:[e.jsxs(ie,{gutter:[48,40],children:[e.jsxs(F,{xs:24,sm:24,md:8,lg:7,children:[e.jsx(Wm,{children:e.jsx(pt,{to:"/",children:e.jsx(Ym,{src:s,alt:n,onError:()=>t("/logo.png")})})}),e.jsx(Om,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),e.jsxs(J,{children:[e.jsx(On,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(ic,{})}),e.jsx(On,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(rc,{})}),e.jsx(On,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(oc,{})}),e.jsx(On,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(ac,{})})]})]}),e.jsxs(F,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(qn,{level:4,children:"Quick Links"}),e.jsx(_t,{to:"/exhibitions",children:"Exhibitions"}),e.jsx(_t,{to:"/about",children:"About Us"}),e.jsx(_t,{to:"/contact",children:"Contact Us"}),e.jsx(_t,{to:"/privacy-policy",children:"Privacy Policy"}),e.jsx(_t,{to:"/terms",children:"Terms & Conditions"})]}),e.jsxs(F,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(qn,{level:4,children:"For Exhibitors"}),e.jsx(_t,{to:"/exhibitor/login",children:"Login"}),e.jsx(_t,{to:"/exhibitor/register",children:"Register"}),e.jsx(_t,{to:"/exhibitor/dashboard",children:"Dashboard"}),e.jsx(_t,{to:"/exhibitor/bookings",children:"My Bookings"}),e.jsx(_t,{to:"/faq",children:"FAQ"})]}),e.jsxs(F,{xs:24,sm:24,md:6,lg:7,children:[e.jsx(qn,{level:4,children:"Contact Us"}),e.jsxs(pr,{children:[e.jsx(mr,{children:e.jsx(ys,{})}),e.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),e.jsxs(pr,{children:[e.jsx(mr,{children:e.jsx(Or,{})}),e.jsx("div",{children:"+91 98765 43210"})]}),e.jsxs(pr,{children:[e.jsx(mr,{children:e.jsx(Ot,{})}),e.jsx("div",{children:"info@exhibitionmanager.com"})]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx(qn,{level:4,children:"Newsletter"}),e.jsx(L,{children:e.jsxs(J.Compact,{style:{width:"100%"},children:[e.jsx(Qm,{placeholder:"Your email address"}),e.jsx(Gm,{type:"primary",icon:e.jsx(lc,{}),children:"Subscribe"})]})})]})]})]}),e.jsx(Xm,{}),e.jsxs(Km,{children:[" ",r," ",n,". All rights reserved."]})]})})},{Title:ma,Text:xr,Paragraph:xa}=pe,{Content:gr}=qe,Jm=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},ga=s=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},Zm=s=>{const t=new Date,i=new Date(s).getTime()-t.getTime();return Math.ceil(i/(1e3*60*60*24))},fa=s=>{if(!s)return"/exhibition-placeholder.jpg";if(s.startsWith("/")||s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s,n=t.includes("logos/")?t:`logos/${t}`;return`${ne.defaults.baseURL}/public/images/${n}`},ex=()=>{const s=Ie(),[t,n]=l.useState([]),[i,r]=l.useState(!0),[o,a]=l.useState(null),[u,y]=l.useState({});return l.useEffect(()=>{(async()=>{try{r(!0),a(null);const f=await mt.getExhibitions();n(f.data);const x={};f.data.forEach(h=>{if(h.headerLogo){const R=fa(h.headerLogo),S=new window.Image;S.onload=()=>{x[h._id]=!0,y(j=>({...j,[h._id]:!0}))},S.onerror=()=>{console.warn(`Failed to preload image: ${R}`),x[h._id]=!1,y(j=>({...j,[h._id]:!1}))},S.src=R}})}catch(f){a(f.message||"Failed to fetch exhibitions")}finally{r(!1)}})()},[]),i?e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(gr,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Pt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):o?e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(gr,{style:{paddingTop:"64px"},children:e.jsx(pn,{status:"error",title:"Failed to load exhibitions",subTitle:o,extra:[e.jsx(O,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):e.jsxs(qe,{children:[e.jsx(At,{}),e.jsx(gr,{style:{paddingTop:"64px",background:"#f5f5f5"},children:e.jsxs("div",{style:{padding:"80px 16px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[e.jsx(ma,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),e.jsx(xa,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?e.jsx(ie,{gutter:[24,24],children:t.map(d=>{const{status:f,color:x}=Jm(d.startDate,d.endDate),h=Zm(d.startDate),R=d.headerLogo?fa(d.headerLogo):void 0;return e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(K,{hoverable:!0,onClick:()=>s(Li(d)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[e.jsx(gt.Ribbon,{text:f,color:x,style:{right:"-1px",top:"10px",zIndex:2}}),e.jsxs("div",{className:"exhibition-card-container",children:[e.jsx("div",{className:"exhibition-card-logo-container",children:R&&e.jsx("div",{className:"exhibition-logo",children:e.jsx(Aa,{src:R,alt:`${d.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:e.jsx(Pt,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),e.jsxs("div",{className:"exhibition-card-content",children:[e.jsx("div",{className:"exhibition-title",children:e.jsx(ma,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:d.name})}),e.jsx(xa,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:d.description}),e.jsxs("div",{className:"exhibition-card-details",children:[e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Et,{style:{color:"#722ED1"}}),e.jsx(_e,{title:"Exhibition Date Range",children:e.jsxs(xr,{style:{fontSize:14},children:[ga(d.startDate)," - ",ga(d.endDate)]})})]}),d.venue&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(ys,{style:{color:"#F5222D"}}),e.jsx(_e,{title:"Venue",children:e.jsx(xr,{style:{fontSize:14},ellipsis:!0,children:d.venue})})]}),f==="Upcoming"&&h>0&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(et,{style:{color:"#1890FF"}}),e.jsx(_e,{title:"Time Remaining",children:e.jsxs(xr,{style:{fontSize:14},children:["Starts in ",h," day",h!==1?"s":""]})})]})]}),e.jsx("div",{className:"exhibition-card-footer",children:e.jsxs(O,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",e.jsx(wr,{})]})})]})]})]})},d._id)})}):e.jsx(Ve,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:Ve.PRESENTED_IMAGE_SIMPLE})]})}),e.jsx(kl,{}),e.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},tx=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=Ie(),{currentExhibition:r}=ge(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>i(Ke(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},sx=()=>{var B,I,w;const{message:s}=st.useApp(),{id:t}=ft(),n=Zt(),i=Ie(),r=Re(),[o,a]=wc(),u=((B=n.state)==null?void 0:B.exhibitionId)||t,{currentExhibition:y,halls:d,stalls:f,loading:x}=ge(D=>D.exhibition),h=l.useRef(null),[R,S]=l.useState(!1),[j,k]=l.useState(null),[v,T]=l.useState(null),[A,c]=l.useState({width:0,height:0}),[p,_]=l.useState(!1);l.useEffect(()=>{if(!u){s.error("Exhibition ID not found"),i("/exhibitions");return}},[u,i,s]),l.useEffect(()=>{if(!u){s.error("Exhibition ID not found"),i("/exhibition");return}(async()=>{try{await r(vt(u)).unwrap(),await r(qt(u)).unwrap(),_(!0)}catch{s.error("Failed to load data")}})()},[u,r,i]),l.useEffect(()=>{var D,M;!p||!y||(!((D=y.dimensions)!=null&&D.width)||!((M=y.dimensions)!=null&&M.height))&&(s.info("Please set up exhibition space first"),i(Ke(y,"space"),{state:{exhibitionId:u}}))},[y,u,i,p]),l.useEffect(()=>{!p||x||d.length===0&&(s.info("Please create halls first"),i(Ke(y,"halls"),{state:{exhibitionId:u}}))},[d,u,i,x,p]),l.useEffect(()=>{p&&y&&d.length>0&&(async()=>{try{const M=d.map(V=>r(zt({exhibitionId:u,hallId:V.id})).unwrap());await Promise.all(M)}catch(M){console.error("Error fetching stalls:",M),s.error("Failed to load stalls")}})()},[y,u,d,r,p]);const N=f.filter(D=>D.hallId===((j==null?void 0:j.id)||(j==null?void 0:j._id)));l.useEffect(()=>{if(!p||d.length===0)return;const D=o.get("hallId");if(D){const M=d.find(V=>V.id===D||V._id===D);if(M)k(M);else if(d.length>0){k(d[0]);const V=d[0].id||d[0]._id;V&&a({hallId:V.toString()})}}else if(d.length>0){k(d[0]);const M=d[0].id||d[0]._id;M&&a({hallId:M.toString()})}},[d,o,p,a]),l.useEffect(()=>{const D=()=>{if(h.current){const{clientWidth:V,clientHeight:U}=h.current;c({width:Math.max(V||400,400),height:Math.max(U||400,400)})}};D();const M=new ResizeObserver(D);return h.current&&M.observe(h.current),window.addEventListener("resize",D),()=>{M.disconnect(),window.removeEventListener("resize",D)}},[]);const g=()=>{if(!j){s.warning("Please select a hall first");return}T(null),S(!0)},$=D=>{if(k(D),T(null),D){const M=D.id||D._id;a(M?{hallId:M.toString()}:{})}else a({})},b=D=>{var V;const M=D?{...D,id:D.id||D._id,_id:D._id||D.id,stallTypeId:typeof D.stallTypeId=="string"?D.stallTypeId:((V=D.stallTypeId)==null?void 0:V._id)||D.stallTypeId,stallType:D.stallType}:null;console.log("Selected stall data:",M),T(M),S(!!M)},C=async D=>{var M,V;try{if(!(j!=null&&j.id)&&!(j!=null&&j._id)){s.error("No hall selected");return}const U=j.id,H=j._id||j.id;if(D.hallId&&D.hallId!==H){s.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",D),D.id||D._id){const Y={...D,id:D.id,_id:D._id,hallId:H,stallTypeId:D.stallTypeId};console.log("Update data:",Y);const Z=D.id||D._id;if(!Z)throw new Error("Stall ID is missing");await Fe.updateStall(u,Z,Y),s.success("Stall updated successfully")}else{const{id:Y,_id:Z,...q}=D,X={...q,hallId:H,stallTypeId:D.stallTypeId};console.log("Creating new stall with data:",X),await Fe.createStall(u,X),s.success("Stall created successfully")}S(!1),r(zt({exhibitionId:u,hallId:U}))}catch(U){console.error("Error saving stall:",U),s.error(((V=(M=U.response)==null?void 0:M.data)==null?void 0:V.message)||"Failed to save stall")}},E=async D=>{var M,V;try{if(!u){s.error("Exhibition ID not found");return}const U=j;if(!U){s.error("No hall selected");return}const H=U.id||U._id;if(!H){s.error("Invalid hall ID");return}await Fe.deleteStall(u,D),S(!1),T(null),await r(zt({exhibitionId:u,hallId:H})).unwrap(),s.success("Stall deleted successfully")}catch(U){console.error("Error deleting stall:",U),s.error(((V=(M=U.response)==null?void 0:M.data)==null?void 0:V.message)||"Failed to delete stall")}},P=async D=>{var H,Y;if(!u){s.error("Exhibition ID not found");return}const M=D.id||D._id;if(!M){console.error("Stall data:",D),s.error("Stall ID not found");return}if(!(j!=null&&j.id)&&!(j!=null&&j._id)){s.error("No hall selected");return}const V=j.id,U=j._id||j.id;try{await Fe.updateStall(u,M,{...D,id:M,hallId:U}),r(zt({exhibitionId:u,hallId:V}))}catch(Z){console.error("Stall update error:",Z),s.error(((Y=(H=Z.response)==null?void 0:H.data)==null?void 0:Y.message)||"Failed to update stall position")}},m=()=>{S(!1),T(null)};return e.jsx(wn,{children:e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{padding:"24px 24px 0"},children:e.jsx(tx,{exhibitionId:u})}),e.jsx(K,{title:"Stall Manager",extra:e.jsxs(J,{children:[e.jsx(O,{icon:e.jsx(Ea,{}),onClick:()=>i(`/exhibition/${u}`,{state:{exhibitionId:u}}),children:"Back to Exhibition"}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:g,disabled:!j,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:e.jsx("div",{ref:h,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:y&&e.jsx(Sn,{width:A.width,height:A.height,exhibitionWidth:((I=y.dimensions)==null?void 0:I.width)||100,exhibitionHeight:((w=y.dimensions)==null?void 0:w.height)||100,halls:d,selectedHall:j,onSelectHall:$,isStallMode:!0,children:j&&N.map(D=>e.jsx(oo,{stall:D,isSelected:(v==null?void 0:v.id)===D.id||(v==null?void 0:v._id)===D._id,onSelect:()=>b(D),onChange:P,hallWidth:j.dimensions.width,hallHeight:j.dimensions.height,hallX:j.dimensions.x,hallY:j.dimensions.y},D.id||D._id))})})}),y&&e.jsx(Jp,{visible:R,stall:v,hall:j,exhibition:y,onCancel:m,onSubmit:C,onDelete:v?()=>E(v.id||v._id):void 0})]})})},nx=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=Ie(),{currentExhibition:r}=ge(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>i(Ke(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ix=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],rx=()=>{var C,E,P;const{message:s}=st.useApp(),{id:t}=ft(),n=Zt(),i=Ie(),r=Re(),o=((C=n.state)==null?void 0:C.exhibitionId)||t,{currentExhibition:a,fixtures:u,halls:y,stalls:d,loading:f}=ge(m=>m.exhibition),x=l.useRef(null),[h,R]=l.useState(!1),[S,j]=l.useState(null),[k,v]=l.useState({width:0,height:0}),[T,A]=l.useState("all"),[c,p]=l.useState([]);l.useEffect(()=>{if(!o){s.error("Exhibition ID not found"),i("/exhibitions");return}},[o,i,s]),l.useEffect(()=>{(async()=>{try{await r(vt(o)).unwrap(),await r(ln({exhibitionId:o})).unwrap(),await r(qt(o)).unwrap(),await r(zt({exhibitionId:o})).unwrap()}catch{s.error("Failed to load data")}})()},[o,r,s]),l.useEffect(()=>{p(T==="all"?u:u.filter(m=>m.type===T))},[u,T]),l.useEffect(()=>{const m=()=>{if(x.current){const{clientWidth:I,clientHeight:w}=x.current;v({width:Math.max(I||400,400),height:Math.max(w||400,400)})}};m();const B=new ResizeObserver(m);return x.current&&B.observe(x.current),window.addEventListener("resize",m),()=>{B.disconnect(),window.removeEventListener("resize",m)}},[]);const _=()=>{j(null),R(!0)},N=m=>{j(m),R(!!m)},g=async m=>{try{m.id||m._id?(await r(di({exhibitionId:o,id:m.id||m._id||"",data:m})).unwrap(),s.success("Fixture updated successfully")):(await r(ci({exhibitionId:o,data:m})).unwrap(),s.success("Fixture created successfully")),await r(ln({exhibitionId:o})).unwrap(),R(!1)}catch(B){console.error("Failed to save fixture:",B),s.error(B.message||"Failed to save fixture")}},$=async m=>{try{const B=m.id||m._id;if(!B)throw new Error("Fixture ID is required");await r(ui({exhibitionId:o,id:B})).unwrap(),s.success("Fixture deleted successfully"),R(!1),j(null)}catch(B){console.error("Failed to delete fixture:",B),s.error(B.message||"Failed to delete fixture")}},b=m=>{A(m)};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(nx,{exhibitionId:o}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(J,{children:e.jsx("span",{children:"Fixture Management"})}),e.jsxs(J,{children:[e.jsx(de,{style:{width:180},value:T,onChange:b,options:ix}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:_,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[e.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),e.jsx("div",{ref:x,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(wn,{children:k.width>0&&k.height>0&&(a==null?void 0:a.dimensions)&&e.jsx(Sn,{width:k.width,height:k.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:y,stalls:d,fixtures:c,selectedFixture:S,onSelectFixture:N,onFixtureChange:g,onAddFixture:_,isFixtureMode:!0})})})]}),e.jsx(nm,{visible:h,fixture:S,onCancel:()=>R(!1),onSubmit:g,onDelete:$,exhibitionWidth:((E=a==null?void 0:a.dimensions)==null?void 0:E.width)||100,exhibitionHeight:((P=a==null?void 0:a.dimensions)==null?void 0:P.height)||100})]})},{Title:ox,Text:ax}=pe,{Option:Ns}=de,lx=()=>{const s=Ie(),t=Re(),{stalls:n,loading:i}=ge(I=>I.exhibition),[r,o]=l.useState([]),[a,u]=l.useState([]),[y,d]=l.useState(null),[f,x]=l.useState(null),[h,R]=l.useState(!1),S=De.useMemo(()=>Math.max(...n.map(I=>I.ratePerSqm*I.dimensions.width*I.dimensions.height),1e6),[n]),j=De.useMemo(()=>{const I=Math.pow(10,Math.floor(Math.log10(S)));return Math.ceil(S/I)*I},[S]),[k,v]=l.useState(""),[T,A]=l.useState(null),[c,p]=l.useState([0,j]),[_,N]=l.useState("number"),[g,$]=l.useState("ascend"),b=I=>{d(I),x(null),t({type:"exhibition/clearStalls"})},C=I=>{x(I),t(y&&I?zt({exhibitionId:y,hallId:I}):{type:"exhibition/clearStalls"})};l.useEffect(()=>{(async()=>{try{R(!0),console.log("Fetching exhibitions...");const w=await Fe.getActiveExhibitions();console.log("Exhibitions response:",w.data),o(w.data)}catch(w){console.error("Failed to fetch exhibitions:",w)}finally{R(!1)}})()},[]),l.useEffect(()=>{y?(async()=>{try{R(!0),console.log("Fetching halls for exhibition:",y);const w=await Fe.getHalls(y);console.log("Halls response:",w.data),u(w.data)}catch(w){console.error("Failed to fetch halls:",w)}finally{R(!1)}})():u([])},[y]);const E=De.useMemo(()=>{console.log("Filtering stalls from Redux:",n);const I=n.filter(w=>{const D=!k||w.number.toLowerCase().includes(k.toLowerCase()),M=!T||w.status===T,V=!f||w.hallId===f,U=w.ratePerSqm*w.dimensions.width*w.dimensions.height,H=U>=c[0]&&U<=c[1];return D&&M&&V&&H}).sort((w,D)=>_==="number"?g==="ascend"?w.number.localeCompare(D.number):D.number.localeCompare(w.number):0);return console.log("Filtered stalls:",I),I},[n,k,T,f,c,_,g]),P=I=>{switch(I){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},B=(I=>{const w=I.reduce((D,M)=>{var V,U;return(V=M==null?void 0:M.dimensions)!=null&&V.width&&((U=M==null?void 0:M.dimensions)!=null&&U.height)?D+M.dimensions.width*M.dimensions.height:D},0);return{totalStalls:I.length,totalSize:w}})(E);return e.jsx("div",{className:"dashboard-container",children:e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{span:24,children:e.jsxs(J,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx(ox,{level:4,style:{margin:0},children:"Stalls"}),e.jsx(ax,{type:"secondary",children:"Manage your exhibition stalls"})]})}),e.jsx(F,{span:24,children:e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(de,{style:{width:"100%"},placeholder:"Select Exhibition",value:y,onChange:b,allowClear:!0,children:r.map(I=>e.jsx(Ns,{value:I._id||I.id,children:I.name},I._id||I.id))})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(de,{style:{width:"100%"},placeholder:"Select Hall",value:f,onChange:C,disabled:!y||a.length===0,allowClear:!0,children:a.map(I=>e.jsx(Ns,{value:I._id||I.id,children:I.name},I._id||I.id))})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(G,{placeholder:"Search by stall number",prefix:e.jsx(os,{}),value:k,onChange:I=>v(I.target.value),allowClear:!0})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsxs(de,{style:{width:"100%"},placeholder:"Filter by status",value:T,onChange:A,allowClear:!0,children:[e.jsx(Ns,{value:"available",children:"Available"}),e.jsx(Ns,{value:"booked",children:"Booked"}),e.jsx(Ns,{value:"reserved",children:"Reserved"}),e.jsx(Ns,{value:"sold",children:"Sold"})]})})]})}),e.jsx(F,{span:24,children:e.jsx(K,{size:"small",children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{xs:12,sm:12,md:6,children:e.jsx(ke,{title:"Total Stalls",value:B.totalStalls,prefix:e.jsx(cc,{})})}),e.jsx(F,{xs:12,sm:12,md:6,children:e.jsx(ke,{title:"Total Area",value:B.totalSize,suffix:"sqm",prefix:e.jsx(Ss,{}),precision:2})})]})})}),e.jsx(F,{span:24,children:e.jsx(K,{size:"small",title:"Price Range Filter",children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:24,style:{marginBottom:16},children:e.jsxs(J,{children:[e.jsx(O,{size:"small",onClick:()=>p([0,5e5]),children:"Under 5L"}),e.jsx(O,{size:"small",onClick:()=>p([5e5,1e6]),children:"5L - 10L"}),e.jsx(O,{size:"small",onClick:()=>p([1e6,2e6]),children:"10L - 20L"}),e.jsx(O,{size:"small",onClick:()=>p([2e6,j]),children:"Above 20L"}),e.jsx(O,{size:"small",onClick:()=>p([0,j]),children:"All"})]})}),e.jsx(F,{span:16,children:e.jsx(Ia,{range:!0,min:0,max:j,value:c,onChange:I=>p(I),step:Math.max(1e3,Math.floor(j/1e3)),tooltip:{formatter:I=>`${(I||0).toLocaleString()}`}})}),e.jsx(F,{span:4,children:e.jsx(ze,{style:{width:"100%"},min:0,max:c[1],value:c[0],onChange:I=>p([I||0,c[1]]),formatter:I=>` ${I}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:I=>I?Number(I.replace(/[^\d.-]/g,"")):0,step:1e3})}),e.jsx(F,{span:4,children:e.jsx(ze,{style:{width:"100%"},min:c[0],max:j,value:c[1],onChange:I=>p([c[0],I||j]),formatter:I=>` ${I}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:I=>I?Number(I.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),e.jsx(F,{span:24,children:e.jsx(Ne,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(I,w)=>I.number.localeCompare(w.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(I,w)=>{var D;return((D=w.stallType)==null?void 0:D.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:I=>I?`${I.toLocaleString()}`:"N/A",sorter:(I,w)=>(I.ratePerSqm||0)-(w.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(I,w)=>{var D,M;return(D=w==null?void 0:w.dimensions)!=null&&D.width&&((M=w==null?void 0:w.dimensions)!=null&&M.height)?`${w.dimensions.width*w.dimensions.height} sqm`:"N/A"},sorter:(I,w)=>{var V,U,H,Y;const D=(((V=I.dimensions)==null?void 0:V.width)||0)*(((U=I.dimensions)==null?void 0:U.height)||0),M=(((H=w.dimensions)==null?void 0:H.width)||0)*(((Y=w.dimensions)==null?void 0:Y.height)||0);return D-M}},{title:"Dimensions",key:"dimensions",render:(I,w)=>{var D,M;return(D=w==null?void 0:w.dimensions)!=null&&D.width&&((M=w==null?void 0:w.dimensions)!=null&&M.height)?`${w.dimensions.width}m  ${w.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(I,w)=>{var D,M;return(D=w==null?void 0:w.dimensions)!=null&&D.width&&((M=w==null?void 0:w.dimensions)!=null&&M.height)&&w.ratePerSqm?`${(w.ratePerSqm*w.dimensions.width*w.dimensions.height).toLocaleString()}`:"N/A"},sorter:(I,w)=>{var V,U,H,Y;const D=(I.ratePerSqm||0)*(((V=I.dimensions)==null?void 0:V.width)||0)*(((U=I.dimensions)==null?void 0:U.height)||0),M=(w.ratePerSqm||0)*(((H=w.dimensions)==null?void 0:H.width)||0)*(((Y=w.dimensions)==null?void 0:Y.height)||0);return D-M}},{title:"Status",dataIndex:"status",key:"status",render:I=>e.jsx(le,{color:P(I),style:{textTransform:"capitalize"},children:I||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(I,w)=>w.status===I},{title:"Actions",key:"actions",render:(I,w)=>e.jsxs(J,{children:[e.jsx("a",{onClick:()=>s(`/stall/edit/${w._id||w.id}`),children:"Edit"}),e.jsx("a",{onClick:()=>s(`/stall/view/${w._id||w.id}`),children:"View"})]})}],dataSource:E,rowKey:I=>I._id||I.id,loading:h||i,pagination:{total:E.length,pageSize:10,showSizeChanger:!0,showTotal:I=>`Total ${I} stalls`},onChange:(I,w,D)=>{D.field&&(N(D.field),$(D.order))}})})]})})})},{Title:cx,Text:dx}=pe,{TextArea:ux}=G,{Search:hx}=G,{Option:ya}=de,px=()=>{Ie();const{message:s}=st.useApp(),[t,n]=l.useState(!1),[i]=L.useForm(),[r,o]=l.useState(!1),[a,u]=l.useState([]),[y,d]=l.useState(!1),[f,x]=l.useState(null);l.useEffect(()=>{h()},[]),l.useEffect(()=>{var T;if(console.log("Modal visibility changed:",t),console.log("Editing stall type:",f),t&&f){const A=((T=f.features)==null?void 0:T.map(c=>c.feature).join(", "))||"";console.log("Setting form values:",{name:f.name,description:f.description,features:A,status:f.status}),setTimeout(()=>{i.setFieldsValue({name:f.name,description:f.description,features:A,status:f.status})},0)}else t&&(i.resetFields(),i.setFieldsValue({status:"active"}))},[f,i,t]);const h=async()=>{try{d(!0);const T=await Ls.getStallTypes();u(T.data)}catch(T){s.error("Failed to fetch stall types: "+T.message)}finally{d(!1)}},R=async T=>{try{o(!0),console.log("Form values:",T);const A={name:T.name,description:T.description,status:T.status,features:T.features?T.features.split(",").map(c=>({feature:c.trim()})):[]};console.log("Submitting data:",A),f?(await Ls.updateStallType(f._id,A),s.success("Stall type updated successfully")):(await Ls.createStallType(A),s.success("Stall type created successfully")),n(!1),x(null),i.resetFields(),h()}catch(A){s.error(`Failed to ${f?"update":"create"} stall type: `+A.message)}finally{o(!1)}},S=T=>{console.log("Editing stall type:",T),x(T),n(!0)},j=async T=>{try{await Ls.deleteStallType(T._id),s.success("Stall type deleted successfully"),h()}catch(A){s.error("Failed to delete stall type: "+A.message)}},k=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(T,A)=>T.name.localeCompare(A.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:T=>e.jsx(J,{wrap:!0,children:T==null?void 0:T.map(({feature:A})=>e.jsx(le,{children:A},A))})},{title:"Status",dataIndex:"status",key:"status",render:T=>e.jsx(le,{color:T==="active"?"success":"default",children:T.toUpperCase()})},{title:"Actions",key:"actions",render:(T,A)=>e.jsxs(J,{children:[e.jsx(O,{type:"link",onClick:()=>S(A),children:"Edit"}),e.jsx(O,{type:"link",danger:!0,onClick:()=>j(A),children:"Delete"})]})}],v=()=>{n(!1),x(null),i.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsx(F,{children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(cx,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(dx,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(F,{children:e.jsxs(J,{children:[e.jsx(hx,{placeholder:"Search stall types",style:{width:200},onSearch:T=>console.log(T)}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:()=>n(!0),children:"Add Stall Type"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx(Ne,{columns:k,dataSource:a,rowKey:T=>T._id,loading:y})}),e.jsx(je,{title:f?"Edit Stall Type":"Add Stall Type",open:t,onCancel:v,footer:null,destroyOnClose:!1,children:e.jsxs(L,{form:i,layout:"vertical",onFinish:R,initialValues:{status:"active"},preserve:!0,children:[e.jsx(L.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(G,{placeholder:"e.g., 1 Side Open"})}),e.jsx(L.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(ux,{rows:4,placeholder:"Enter description"})}),e.jsx(L.Item,{name:"features",label:"Features",children:e.jsx(G,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(L.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(de,{children:[e.jsx(ya,{value:"active",children:"Active"}),e.jsx(ya,{value:"inactive",children:"Inactive"})]})}),e.jsx(L.Item,{children:e.jsxs(O,{type:"primary",htmlType:"submit",loading:r,block:!0,children:[f?"Update":"Create"," Stall Type"]})})]})})]})},mx={bookings:[],currentBooking:null,loading:!1,error:null},fs=Ce("booking/fetchBookings",async()=>(await ne.get("/bookings")).data),fr=Ce("booking/fetchBooking",async s=>(await ne.get(`/bookings/${s}`)).data),hi=Ce("booking/createBooking",async s=>(await ne.post("/bookings",s)).data),pi=Ce("booking/updateStatus",async({id:s,status:t,rejectionReason:n})=>(await ne.patch(`/bookings/${s}`,{status:t,...n&&{rejectionReason:n}})).data),yr=Ce("booking/updatePaymentStatus",async({id:s,paymentStatus:t,paymentDetails:n})=>(await ne.patch(`/bookings/${s}/payment`,{paymentStatus:t,paymentDetails:n})).data),mi=Ce("booking/deleteBooking",async s=>(await ne.delete(`/bookings/${s}`),s)),Cl=dt({name:"booking",initialState:mx,reducers:{clearCurrentBooking:s=>{s.currentBooking=null},clearBookingError:s=>{s.error=null}},extraReducers:s=>{s.addCase(fs.pending,t=>{t.loading=!0,t.error=null}).addCase(fs.fulfilled,(t,n)=>{t.loading=!1,t.bookings=n.payload}).addCase(fs.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to fetch bookings"}).addCase(fr.pending,t=>{t.loading=!0,t.error=null}).addCase(fr.fulfilled,(t,n)=>{t.loading=!1,t.currentBooking=n.payload}).addCase(fr.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to fetch booking"}).addCase(hi.pending,t=>{t.loading=!0,t.error=null}).addCase(hi.fulfilled,(t,n)=>{t.loading=!1,t.bookings.unshift(n.payload),t.currentBooking=n.payload}).addCase(hi.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to create booking"}).addCase(pi.pending,t=>{t.loading=!0,t.error=null}).addCase(pi.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.bookings[i]=n.payload),((r=t.currentBooking)==null?void 0:r._id)===n.payload._id&&(t.currentBooking=n.payload)}).addCase(pi.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to update booking status"}).addCase(yr.pending,t=>{t.loading=!0,t.error=null}).addCase(yr.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.bookings[i]=n.payload),((r=t.currentBooking)==null?void 0:r._id)===n.payload._id&&(t.currentBooking=n.payload)}).addCase(yr.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to update payment status"}).addCase(mi.pending,t=>{t.loading=!0,t.error=null}).addCase(mi.fulfilled,(t,n)=>{var i;t.loading=!1,t.bookings=t.bookings.filter(r=>r._id!==n.payload),((i=t.currentBooking)==null?void 0:i._id)===n.payload&&(t.currentBooking=null)}).addCase(mi.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:Cg,clearBookingError:Ig}=Cl.actions,xx=Cl.reducer,gx="/api",xi=ro({reducerPath:"invoiceApi",baseQuery:to({baseUrl:gx,credentials:"include",prepareHeaders:s=>{const t=localStorage.getItem("token");return t&&s.set("authorization",`Bearer ${t}`),s.set("Content-Type","application/json"),s.set("Accept","application/json"),s}}),tagTypes:["Invoice"],endpoints:s=>({getInvoices:s.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:s.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,n,i)=>[{type:"Invoice",id:i}]}),downloadInvoice:s.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:s.mutation({query:({id:t,...n})=>({url:`/invoices/${t}/share/email`,method:"POST",body:n})}),shareViaWhatsApp:s.mutation({query:({id:t,...n})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:n})})})}),{useGetInvoicesQuery:Il,useGetInvoiceQuery:fx,useShareViaEmailMutation:yx}=xi,bx=({bookings:s})=>{const n={total:s.length,pending:s.filter(r=>r.status==="pending").length,approved:s.filter(r=>r.status==="approved").length,rejected:s.filter(r=>r.status==="rejected").length,confirmed:s.filter(r=>r.status==="confirmed").length,cancelled:s.filter(r=>r.status==="cancelled").length,totalRevenue:s.filter(r=>r.status==="confirmed"||r.status==="approved").reduce((r,o)=>r+o.amount,0),totalActiveBookings:s.filter(r=>r.status==="confirmed"||r.status==="approved").length,totalDeclinedBookings:s.filter(r=>r.status==="cancelled"||r.status==="rejected").length};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Total Bookings",value:n.total,prefix:e.jsx(Ii,{})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Pending Bookings",value:n.pending,prefix:e.jsx(et,{style:{color:"#faad14"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Approved Bookings",value:n.approved,prefix:e.jsx(Be,{style:{color:"#52c41a"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Confirmed Bookings",value:n.confirmed,prefix:e.jsx(Be,{style:{color:"#52c41a"}})})})})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Rejected Bookings",value:n.rejected,prefix:e.jsx(Nt,{style:{color:"#f5222d"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Cancelled Bookings",value:n.cancelled,prefix:e.jsx(Nt,{style:{color:"#f5222d"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Total Revenue",value:n.totalRevenue,prefix:"",precision:2})})}),e.jsx(F,{xs:24,sm:12,md:6})]})]})},{RangePicker:jx}=Os,vx=({filters:s,exhibitions:t,onFilterChange:n,onRefresh:i})=>e.jsx(K,{style:{marginBottom:"24px"},children:e.jsxs(J,{wrap:!0,children:[e.jsx(G,{placeholder:"Search by company name",prefix:e.jsx(os,{}),value:s.search,onChange:r=>n({...s,search:r.target.value}),style:{width:200},allowClear:!0}),e.jsx(de,{placeholder:"Filter by exhibition",value:s.exhibition,onChange:r=>n({...s,exhibition:r}),style:{minWidth:200},allowClear:!0,options:t.map(r=>({label:r.name,value:r._id}))}),e.jsx(de,{mode:"multiple",placeholder:"Filter by status",value:s.status,onChange:r=>n({...s,status:r}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),e.jsx(jx,{onChange:r=>{var o,a;return n({...s,dateRange:r?[((o=r[0])==null?void 0:o.toISOString())||"",((a=r[1])==null?void 0:a.toISOString())||""]:null})}}),e.jsx(O,{icon:e.jsx(yn,{}),onClick:i,children:"Refresh"})]})}),{Title:wx,Text:Me}=pe,{RangePicker:Eg}=Os,Sx=()=>{const s=Re(),{bookings:t,loading:n}=ge(I=>I.booking),{exhibitions:i}=ge(I=>I.exhibition),[r,o]=l.useState(null),[a,u]=l.useState(!1),[y,d]=l.useState({search:"",status:[],dateRange:null,exhibition:null}),f=Ie(),{data:x,isLoading:h,error:R,refetch:S}=Il({page:1,limit:100}),[j,k]=l.useState(!1),[v,T]=l.useState("pending"),[A,c]=l.useState(""),[p,_]=l.useState(!1),{hasPermission:N}=Di();l.useEffect(()=>{s(fs())},[s]),l.useEffect(()=>{s(It())},[s]),l.useEffect(()=>{t.length>0&&[...new Set(t.map(w=>w.exhibitionId._id))].forEach(w=>{s(vt(w))})},[t,s]);const g=async(I,w,D)=>{try{_(!0),await s(pi({id:I,status:w,...D&&{rejectionReason:D}})).unwrap(),se.success(`Booking ${w} successfully`),s(fs()),w==="approved"&&setTimeout(async()=>{await S()},1e3),u(!1),k(!1),o(null)}catch{se.error("Failed to update booking status")}finally{_(!1)}},$=async I=>{try{await s(mi(I)).unwrap(),se.success("Booking deleted successfully"),s(fs())}catch(w){se.error((w==null?void 0:w.message)||"Failed to delete booking")}},b=I=>{d(I)},C=t.filter(I=>{var w;if(y.search&&!((w=I.companyName)!=null&&w.toLowerCase().includes(y.search.toLowerCase()))||y.status.length>0&&!y.status.includes(I.status)||y.exhibition&&I.exhibitionId._id!==y.exhibition)return!1;if(y.dateRange){const[D,M]=y.dateRange,V=new Date(I.createdAt);if(V<new Date(D)||V>new Date(M))return!1}return!0}),E=(I,w)=>{const D=new Date(w).getFullYear(),M=t.find(q=>q._id===I);if(!M)return`--/${D}/--`;const H=(t.filter(q=>q.exhibitionId._id===M.exhibitionId._id).sort((q,X)=>new Date(q.createdAt).getTime()-new Date(X.createdAt).getTime()).findIndex(q=>q._id===I)+1).toString().padStart(2,"0"),Y=i.find(q=>q._id===M.exhibitionId._id);return`${(Y==null?void 0:Y.invoicePrefix)||M.exhibitionId.invoicePrefix||"BK"}/${D}/${H}`},P=I=>{if(h)return console.log("Loading invoices..."),null;if(R)return console.error("Error loading invoices:",R),null;if(!x)return console.log("No invoices available"),null;const w=x.data||[];console.log("Looking for invoice with booking ID:",I);const D=w.find(M=>M.bookingId&&typeof M.bookingId=="object"&&M.bookingId._id===I);return console.log("Found invoice:",D),D==null?void 0:D._id},m=async I=>{if(h){se.loading("Loading invoice data...");return}let w=P(I._id);if(w)f(`/invoice/${w}`);else{const D="invoice-loading";if(se.loading({content:"Checking for invoice...",key:D}),await S(),w=P(I._id),w){se.success({content:"Invoice found!",key:D,duration:1}),f(`/invoice/${w}`);return}const M=new Date(I.createdAt),V=new Date(Date.now()-30*60*1e3);if(M>V||I.status==="approved"){se.info({content:"Invoice is still being generated. Checking again in a moment...",key:D});let H=0;const Y=5,Z=[2e3,3e3,5e3,8e3,1e4],q=async()=>{H++,await S();const X=P(I._id);if(X)se.success({content:"Invoice is ready!",key:D,duration:1}),f(`/invoice/${X}`);else if(H<Y){const z=Z[H]||5e3,ee=z/1e3;se.info({content:`Attempt ${H}/${Y}: Invoice not ready yet. Trying again in ${ee} seconds...`,key:D}),setTimeout(q,z)}else se.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:D})};setTimeout(q,Z[0])}else se.error({content:"No invoice found for this booking. Please contact support if this persists.",key:D})}},B=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(I,w)=>e.jsx(O,{type:"link",onClick:()=>{o(t.find(D=>D._id===I)||null),u(!0)},children:E(I,w.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(I,w)=>w.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:I=>I||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(I,w)=>w.stallIds.map(D=>D.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:I=>`${I.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(I,w)=>{const D=w.calculations.totalDiscountAmount;if(!D||D===0)return"-";const M=w.calculations.stalls.filter(U=>U.discount).map(U=>U.discount);if(M.length===0)return"-";const V=M[0];return e.jsx(_e,{title:e.jsx("div",{children:M.map((U,H)=>e.jsxs("div",{children:[U==null?void 0:U.name,": ",(U==null?void 0:U.type)==="percentage"?`${U==null?void 0:U.value}%`:`${U==null?void 0:U.value}`,e.jsx("br",{}),"Amount: ",U==null?void 0:U.amount.toLocaleString()]},H))}),children:e.jsxs(le,{color:"red",children:["-",D.toLocaleString(),(V==null?void 0:V.type)==="percentage"&&` (${V.value}%)`,M.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:I=>`${I.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:I=>e.jsx(le,{color:I==="confirmed"?"success":I==="approved"?"blue":I==="pending"?"warning":I==="rejected"?"error":"default",children:I.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:I=>Ae(I).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(I,w)=>e.jsxs(J,{children:[e.jsx(_e,{title:"View Details",children:e.jsx(O,{icon:e.jsx(Xt,{}),onClick:()=>{o(w),u(!0)}})}),e.jsx(vs,{overlay:e.jsxs(jt,{children:[w.status!=="cancelled"&&N("view_bookings")&&e.jsx(jt.Item,{icon:e.jsx(Jt,{}),disabled:h,onClick:()=>m(w),children:"View Invoice"},"invoice"),e.jsx(jt.Item,{icon:e.jsx(Be,{}),onClick:()=>{o(w),T(w.status),c(w.rejectionReason||""),k(!0)},children:"Update Status"},"updateStatus"),N("bookings_delete")&&e.jsx(jt.Item,{icon:e.jsx(ot,{}),danger:!0,onClick:()=>{je.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>$(w._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(O,{icon:e.jsx(Vr,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(F,{flex:"auto",children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(wx,{level:4,style:{margin:0},children:"Stall Bookings"}),e.jsx(Me,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),e.jsx(F,{children:e.jsx(O,{type:"primary",size:"large",icon:e.jsx(lt,{}),onClick:()=>f("/bookings/create"),children:"Create Booking"})})]})}),e.jsx(bx,{bookings:t}),e.jsx(vx,{filters:y,exhibitions:i,onFilterChange:b,onRefresh:()=>s(fs())}),e.jsx(K,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:e.jsx(Ne,{columns:B,dataSource:C,loading:n,rowKey:"_id",scroll:{x:1500},pagination:{total:C.length,pageSize:10,showSizeChanger:!0,showTotal:I=>`Total ${I} items`,position:["bottomRight"]}})}),e.jsx(je,{title:"Booking Details",open:a,onCancel:()=>{u(!1),o(null)},footer:[e.jsx(O,{type:"primary",disabled:!r,onClick:()=>{r&&(T(r.status),c(r.rejectionReason||""),k(!0))},children:"Update Status"},"updateStatus"),e.jsx(O,{onClick:()=>{u(!1),o(null)},children:"Close"},"close")],width:800,children:r&&e.jsxs(J,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(fe,{bordered:!0,column:2,children:[e.jsxs(fe.Item,{label:"Booking Number",span:2,children:[E(r._id,r.createdAt),e.jsxs(Me,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",r._id,")"]})]}),e.jsx(fe.Item,{label:"Exhibition",span:2,children:r.exhibitionId.name}),e.jsxs(fe.Item,{label:"Status",span:2,children:[e.jsx(le,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()}),r.rejectionReason&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Me,{type:"secondary",children:"Rejection Reason:"}),e.jsx("br",{}),e.jsx(Me,{children:r.rejectionReason})]})]}),e.jsx(fe.Item,{label:"Customer Name",children:r.customerName}),e.jsx(fe.Item,{label:"Customer Email",children:r.customerEmail}),e.jsx(fe.Item,{label:"Customer Phone",children:r.customerPhone}),e.jsx(fe.Item,{label:"Company Name",children:r.companyName})]}),e.jsx(K,{title:"Stall Details",size:"small",children:e.jsx(Ne,{dataSource:r.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:I=>e.jsxs(le,{color:"blue",children:[I.dimensions.width,"x",I.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:I=>`${I.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:I=>{const w=r.calculations.stalls.find(D=>D.stallId===I._id);return w?`${w.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:I=>{const w=r.calculations.stalls.find(D=>D.stallId===I._id);return w!=null&&w.discount?e.jsxs(le,{color:"red",children:["-",w.discount.amount.toLocaleString(),w.discount.type==="percentage"&&` (${w.discount.value}%)`]}):"-"}}]})}),e.jsx(K,{title:"Financial Summary",size:"small",children:e.jsxs(J,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Total Base Amount:"}),e.jsxs(Me,{children:["",r.calculations.totalBaseAmount.toLocaleString()]})]}),r.calculations.totalDiscountAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Total Discount:"}),e.jsxs(Me,{type:"danger",children:["-",r.calculations.totalDiscountAmount.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Amount after Discount:"}),e.jsxs(Me,{children:["",r.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),e.jsx(Te,{style:{margin:"8px 0"}}),r.calculations.taxes.map(I=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Me,{children:[I.name," (",I.rate,"%):"]}),e.jsxs(Me,{children:["",I.amount.toLocaleString()]})]},I.name)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Me,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Me,{strong:!0,children:["",r.amount.toLocaleString()]})]})]})})]})}),e.jsx(je,{title:"Update Booking Status",open:j,onCancel:()=>{k(!1),c("")},footer:null,width:600,children:r&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Jt,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(F,{span:8,children:e.jsx(Me,{strong:!0,children:"Booking Number:"})}),e.jsx(F,{span:16,children:e.jsx(Me,{children:E(r._id,r.createdAt)})}),e.jsx(F,{span:8,children:e.jsx(Me,{strong:!0,children:"Company:"})}),e.jsx(F,{span:16,children:e.jsx(Me,{children:r.companyName})}),e.jsx(F,{span:8,children:e.jsx(Me,{strong:!0,children:"Exhibition:"})}),e.jsx(F,{span:16,children:e.jsx(Me,{children:r.exhibitionId.name})}),e.jsx(F,{span:8,children:e.jsx(Me,{strong:!0,children:"Current Status:"})}),e.jsx(F,{span:16,children:e.jsx(le,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()})})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(qs,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Me,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(Bt.Group,{value:v,onChange:I=>T(I.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[e.jsx(Bt.Button,{value:"pending",style:{flex:"0 0 auto"},children:e.jsxs(J,{children:[e.jsx(et,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(Bt.Button,{value:"approved",style:{flex:"0 0 auto"},children:e.jsxs(J,{children:[e.jsx(Be,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(Bt.Button,{value:"rejected",style:{flex:"0 0 auto"},children:e.jsxs(J,{children:[e.jsx(Nt,{style:{color:"#f5222d"}}),"Rejected"]})}),e.jsx(Bt.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:e.jsxs(J,{children:[e.jsx(Be,{style:{color:"#1890ff"}}),"Confirmed"]})}),e.jsx(Bt.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:e.jsxs(J,{children:[e.jsx(Nt,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),v==="rejected"&&e.jsx("div",{children:e.jsx(L.Item,{label:e.jsx(Me,{strong:!0,children:"Rejection Reason:"}),required:v==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:e.jsx(G.TextArea,{rows:4,value:A,onChange:I=>c(I.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),v==="approved"&&e.jsx(He,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),v==="confirmed"&&e.jsx(He,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),v==="cancelled"&&e.jsx(He,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),v==="pending"&&e.jsx(He,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(O,{onClick:()=>{k(!1),c("")},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:()=>{if(v==="rejected"&&!A.trim()){se.error("Rejection reason is required when rejecting a booking");return}g(r._id,v,v==="rejected"?A:void 0)},loading:p,disabled:v==="rejected"&&!A.trim(),children:"Update Status"})]})]})]})})]})},kx={exhibitors:[],loading:!1,error:null},Mt=Ce("exhibitors/fetchAll",async(s,{rejectWithValue:t})=>{var n,i;try{return(await rt.getExhibitors()).data}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch exhibitors")}}),Cx=dt({name:"exhibitor",initialState:kx,reducers:{},extraReducers:s=>{s.addCase(Mt.pending,t=>{t.loading=!0,t.error=null}).addCase(Mt.fulfilled,(t,n)=>{t.exhibitors=n.payload,t.loading=!1}).addCase(Mt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),Ix=Cx.reducer,{Title:Ex,Text:Dt}=pe,Ax=()=>{var Z,q,X;const[s]=L.useForm(),[t]=L.useForm(),[n,i]=l.useState(!1),[r,o]=l.useState([]),[a,u]=l.useState(!1),[y,d]=l.useState([]),[f,x]=l.useState(null),[h,R]=l.useState(),[S,j]=l.useState([]),[k,v]=l.useState([]),[T,A]=l.useState(0),c=Ie(),p=Re(),{loading:_}=ge(z=>z.booking),{exhibitions:N=[],loading:g}=ge(z=>z.exhibition),{exhibitors:$=[],loading:b}=ge(z=>z.exhibitor),{isAuthenticated:C}=ge(z=>z.auth);l.useEffect(()=>{if(!C){se.error("Please login to create a booking"),c("/login");return}p(It()),p(Mt())},[p,C,c]);const E=async z=>{try{u(!0),s.setFieldValue("stallIds",[]),s.setFieldValue("discountId",void 0),s.setFieldValue("extraAmenities",[]),d([]),j([]),v([]),A(0);const ee=await Fe.getExhibition(z);x(ee.data);const ae=(await Fe.getStalls(z)).data.filter(Q=>Q.status==="available");o(ae)}catch(ee){console.error("Failed to fetch exhibition data:",ee),se.error("Failed to fetch exhibition data")}finally{u(!1)}},P=z=>Math.round(z.ratePerSqm*z.dimensions.width*z.dimensions.height*100)/100,m=z=>{var ae;const ee=r.filter(Q=>{const re=Q._id||Q.id;return re&&z.includes(re)});d(ee);const ce=ee.reduce((Q,re)=>Q+re.dimensions.width*re.dimensions.height,0);if(A(ce),(ae=f==null?void 0:f.basicAmenities)!=null&&ae.length){const Q=f.basicAmenities.map(re=>{const be=Math.floor(ce/re.perSqm)*re.quantity;return{...re,calculatedQuantity:be>0?be:0,key:re._id||re.id}});v(Q)}},B=(z,ee,ce)=>{if(!(ce!=null&&ce.isActive))return 0;let ae=0;if(ce.type==="percentage")ae=z*(Math.max(0,Math.min(100,ce.value))/100);else{const Q=z/ee*ce.value;ae=Math.min(Q,z)}return Math.round(ae*100)/100},I=async z=>{var ee,ce;try{const ae=$.find(oe=>oe._id===z.exhibitorId);if(!ae)throw new Error("Selected exhibitor not found");const[Q,re,be]=z.discountId?z.discountId.split("-"):[],W=(ee=f==null?void 0:f.discountConfig)==null?void 0:ee.find(oe=>`${oe.name}-${oe.value}-${oe.type}`===z.discountId),he=y.map(oe=>{const ye=oe._id||oe.id;if(!ye)throw new Error(`Invalid stall ID for stall number ${oe.number}`);return{stall:oe,stallId:ye,baseAmount:P(oe)}}),xe=he.reduce((oe,{baseAmount:ye})=>oe+ye,0),we=he.map(({stall:oe,stallId:ye,baseAmount:me})=>{const Ye=W?B(me,xe,W):0;return{stallId:ye,number:oe.number,baseAmount:me,discount:W?{name:W.name,type:W.type,value:W.value,amount:Ye}:void 0,amountAfterDiscount:Math.round((me-Ye)*100)/100}}),$e=we.reduce((oe,ye)=>{var me;return oe+(((me=ye.discount)==null?void 0:me.amount)||0)},0),tt=Math.round((xe-$e)*100)/100,es=((ce=f==null?void 0:f.taxConfig)==null?void 0:ce.filter(oe=>oe.isActive).map(oe=>({name:oe.name,rate:oe.rate,amount:Math.round(tt*oe.rate/100*100)/100})))||[],Vt=es.reduce((oe,ye)=>oe+ye.amount,0),St=Math.round((tt+Vt)*100)/100,Hs={exhibitionId:z.exhibitionId,exhibitorId:z.exhibitorId,stallIds:we.map(oe=>oe.stallId),customerName:ae.contactPerson,customerEmail:ae.email,customerPhone:ae.phone,customerAddress:ae.address||"N/A",customerGSTIN:ae.gstNumber||"N/A",customerPAN:ae.panNumber||"N/A",companyName:ae.companyName,discount:W?{name:W.name,type:W.type,value:W.value}:void 0,amount:St,calculations:{stalls:we,totalBaseAmount:xe,totalDiscountAmount:$e,totalAmountAfterDiscount:tt,taxes:es,totalTaxAmount:Vt,totalAmount:St}};k.length&&(Hs.basicAmenities=k.filter(oe=>oe.calculatedQuantity>0).map(oe=>({name:oe.name,type:oe.type,perSqm:oe.perSqm,quantity:oe.quantity,calculatedQuantity:oe.calculatedQuantity,description:oe.description}))),S.length&&(Hs.extraAmenities=H());const ue=await p(hi(Hs)).unwrap();ue&&ue.invoiceId?(se.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{c(`/invoice/${ue.invoiceId}`)},2e3)):(se.success("Booking created successfully"),c("/bookings")),ue&&ue.warning&&se.warning(ue.warning)}catch(ae){console.error("Error creating booking:",ae),se.error("Failed to create booking")}},w=async z=>{try{const ee=await rt.createExhibitor(z);se.success("Exhibitor added successfully"),p(Mt()),s.setFieldsValue({exhibitorId:ee.data._id}),i(!1),t.resetFields()}catch(ee){const ce=(ee==null?void 0:ee.message)||"Failed to add exhibitor";se.error(ce),ce==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},D=N.map(z=>({label:z.name,value:z._id||z.id})),M=$.map(z=>({label:z.companyName,value:z._id}));r.map(z=>({label:`Stall ${z.number} (${z.dimensions.width}m  ${z.dimensions.height}m = ${(z.dimensions.width*z.dimensions.height).toFixed(2)} sqm) - ${z.ratePerSqm.toLocaleString()}/sq.m`,value:z._id||z.id}));const V=z=>{R(z),s.setFieldValue("discountId",z)},U=()=>{var W,he;const z=y.reduce((xe,we)=>xe+P(we),0),ee=(W=f==null?void 0:f.discountConfig)==null?void 0:W.find(xe=>`${xe.name}-${xe.value}-${xe.type}`===h&&xe.isActive),ce=ee?ee.type==="percentage"?Math.round(z*ee.value/100*100)/100:Math.min(ee.value,z):0,ae=Math.round((z-ce)*100)/100,Q=((he=f==null?void 0:f.taxConfig)==null?void 0:he.filter(xe=>xe.isActive).map(xe=>({name:xe.name,rate:xe.rate,amount:Math.round(ae*xe.rate/100*100)/100})))||[],re=Q.reduce((xe,we)=>xe+we.amount,0),be=Math.round((ae+re)*100)/100;return{baseAmount:z,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:ae,taxes:Q,totalTaxAmount:re,totalAmount:be}},H=()=>{var z;return(z=f==null?void 0:f.amenities)!=null&&z.length?f.amenities.filter(ee=>{const ce=ee._id||ee.id;return ce&&S.includes(ce.toString())}).map(ee=>({id:ee._id||ee.id,name:ee.name,type:ee.type,rate:ee.rate,description:ee.description})):[]},Y=z=>{j(z)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{span:24,children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(Ex,{level:2,style:{margin:0},children:"Create Booking"}),e.jsx(pe.Text,{type:"secondary",children:"Create a new stall booking"})]})}),e.jsx(F,{span:24,children:e.jsx(K,{children:e.jsx(L,{form:s,layout:"vertical",onFinish:I,style:{maxWidth:800},children:e.jsxs(ie,{gutter:16,children:[e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:e.jsx(de,{placeholder:"Select exhibition",loading:g,options:D,onChange:E})})}),e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"exhibitorId",label:e.jsxs(J,{children:[e.jsx("span",{children:"Exhibitor"}),e.jsx(O,{type:"link",icon:e.jsx(lt,{}),onClick:()=>i(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:e.jsx(de,{showSearch:!0,placeholder:"Select exhibitor",loading:b,options:M,filterOption:(z,ee)=>{var ce;return(((ce=ee==null?void 0:ee.label)==null?void 0:ce.toString())??"").toLowerCase().includes(z.toLowerCase())}})})}),e.jsx(F,{span:24,children:e.jsx(L.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:e.jsx(de,{mode:"multiple",placeholder:a?"Loading stalls...":"Select stalls",loading:a,onChange:m,options:r.map(z=>({label:`Stall ${z.number} (${z.dimensions.width}m  ${z.dimensions.height}m = ${(z.dimensions.width*z.dimensions.height).toFixed(2)} sqm) - ${z.ratePerSqm.toLocaleString()}/sq.m`,value:z._id||z.id}))})})}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(F,{span:24,children:e.jsx(K,{title:"Selected Stalls Summary",size:"small",children:e.jsx(Ne,{dataSource:y.map(z=>({...z,key:z._id||z.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(z,ee)=>{var ce,ae;return((ce=ee.stallType)==null?void 0:ce.name)||(typeof ee.stallTypeId=="object"?(ae=ee.stallTypeId)==null?void 0:ae.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(z,ee)=>`${ee.dimensions.width}m  ${ee.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(z,ee)=>(ee.dimensions.width*ee.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:z=>`${z.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(z,ee)=>`${P(ee).toLocaleString()}`}],summary:()=>{const z=y.reduce((ee,ce)=>ee+P(ce),0);return e.jsxs(Ne.Summary.Row,{children:[e.jsx(Ne.Summary.Cell,{index:0,colSpan:5,children:e.jsx("strong",{children:"Total Base Amount"})}),e.jsx(Ne.Summary.Cell,{index:1,children:e.jsxs("strong",{children:["",z.toLocaleString()]})})]},"summary")}})})}),e.jsx(F,{span:24,children:e.jsx(K,{title:"Stall Amenities",size:"small",children:e.jsxs(ie,{gutter:[16,24],children:[e.jsxs(F,{span:24,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(pe.Title,{level:5,style:{margin:0},children:e.jsxs(J,{children:[e.jsx("span",{children:"Included Basic Amenities"}),e.jsx(le,{color:"green",children:"Based on stall area"})]})}),e.jsxs(pe.Text,{type:"secondary",children:["The following amenities are included based on your total stall area of ",T.toFixed(2)," sqm."]})]}),(Z=f==null?void 0:f.basicAmenities)!=null&&Z.length?e.jsx(Ne,{dataSource:k.filter(z=>z.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(z,ee)=>e.jsxs(J,{children:[e.jsx(pe.Text,{strong:!0,children:z}),e.jsx(le,{color:"blue",children:ee.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:z=>e.jsxs(le,{color:"green",children:[z," ",z===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(z,ee)=>e.jsx(_e,{title:ee.description,children:e.jsxs(pe.Text,{type:"secondary",children:[e.jsx(Rt,{style:{marginRight:5}}),"1 ",ee.quantity>1?`set of ${ee.quantity}`:"unit"," per ",z," sqm"]})})},{title:"Status",key:"status",width:100,align:"right",render:()=>e.jsx(pe.Text,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:e.jsx(pe.Text,{children:"No basic amenities qualify based on the selected stall area."})}}):e.jsx(pe.Text,{type:"secondary",children:"No basic amenities have been configured for this exhibition."})]}),e.jsxs(F,{span:24,children:[e.jsx(Te,{style:{margin:"12px 0 24px"}}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(pe.Title,{level:5,style:{margin:0},children:e.jsxs(J,{children:[e.jsx("span",{children:"Additional Amenities"}),e.jsx(le,{color:"blue",children:"Optional"})]})}),e.jsx(pe.Text,{type:"secondary",children:"Select any additional amenities for the booking."})]}),(q=f==null?void 0:f.amenities)!=null&&q.length?e.jsxs(e.Fragment,{children:[e.jsx(L.Item,{name:"extraAmenities",label:"Select Additional Amenities",children:e.jsx(de,{mode:"multiple",placeholder:"Select amenities",style:{width:"100%"},onChange:Y,optionLabelProp:"label",options:f.amenities.map(z=>({label:`${z.name} (${z.rate?`${z.rate.toLocaleString()}`:"N/A"})`,value:z._id||z.id,key:z._id||z.id}))})}),S.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(pe.Text,{strong:!0,children:"Selected Amenities:"}),e.jsx(Ne,{dataSource:H(),columns:[{title:"Name",dataIndex:"name",key:"name",render:(z,ee)=>e.jsxs(J,{align:"center",children:[e.jsx(pe.Text,{strong:!0,children:z}),e.jsx(le,{color:"blue",children:ee.type}),e.jsx(pe.Text,{type:"secondary",style:{fontSize:"13px"},children:ee.description||""})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:z=>e.jsxs(pe.Text,{strong:!0,style:{color:"#1890ff"},children:["",z.toLocaleString("en-IN")]})}],pagination:!1,size:"small"})]})]}):e.jsx(pe.Text,{type:"secondary",children:"No additional amenities have been configured for this exhibition."})]})]})})}),e.jsx(F,{span:24,children:e.jsxs(K,{title:"Price Calculations",size:"small",children:[e.jsx(ie,{gutter:[16,16],children:e.jsx(F,{span:12,children:e.jsx(L.Item,{name:"discountId",label:"Available Discounts",children:e.jsx(de,{placeholder:"Select discount",allowClear:!0,onChange:V,options:(X=f==null?void 0:f.discountConfig)==null?void 0:X.map(z=>({label:`${z.name} (${z.type==="percentage"?z.value+"%":""+z.value})${z.isActive?"":" - Inactive"}`,value:`${z.name}-${z.value}-${z.type}`,disabled:!z.isActive}))})})})}),e.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:e.jsx(J,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:z,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:ae,taxes:Q,totalAmount:re}=U();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Dt,{children:"Total Base Amount:"}),e.jsxs(Dt,{children:["",z.toLocaleString()]})]}),ee&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Dt,{children:["Discount (",ee.type==="percentage"?`${ee.value}%`:`${ee.value.toLocaleString()}`,"):"]}),e.jsxs(Dt,{type:"danger",children:["-",ce.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Dt,{children:"Amount after Discount:"}),e.jsxs(Dt,{children:["",ae.toLocaleString()]})]}),e.jsx(Te,{style:{margin:"8px 0"}}),Q.map(be=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Dt,{children:[be.name," (",be.rate,"%):"]}),e.jsxs(Dt,{children:["",be.amount.toLocaleString()]})]},`tax-${be.name}`)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Dt,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Dt,{strong:!0,children:["",re.toLocaleString()]})]})]})})()})})]})})]}),e.jsx(F,{span:24,children:e.jsx(L.Item,{children:e.jsxs(J,{children:[e.jsx(O,{type:"primary",htmlType:"submit",loading:_,children:"Create Booking"}),e.jsx(O,{onClick:()=>c("/bookings"),children:"Cancel"})]})})})]})})})})]}),e.jsx(je,{title:e.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:n,onCancel:()=>{i(!1),t.resetFields()},width:800,footer:e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[e.jsx(O,{onClick:()=>{i(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:e.jsx(L,{form:t,layout:"vertical",onFinish:w,requiredMark:!1,children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(G.TextArea,{rows:3})}),e.jsx(L.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"status",label:"Status",initialValue:"active",children:e.jsxs(de,{children:[e.jsx(de.Option,{value:"active",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),e.jsx(de.Option,{value:"inactive",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(G,{placeholder:"ABCDE1234F"})}),e.jsx(L.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(G,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})},Tx=()=>{const{id:s}=ft(),t=Ie(),{data:n,isLoading:i}=fx(s||""),[r,o]=l.useState(!1),[a,u]=l.useState(!1),[y]=L.useForm(),[d,f]=l.useState(0),[x,h]=l.useState(!1),R=async()=>{if(s)try{h(!0),f(0),se.loading({content:"Preparing invoice...",key:"download"});const k=await $a(`/invoices/${s}/download?force=false`,!1,A=>{const c=A.total,p=A.loaded;if(c){const _=Math.round(p*100/c);f(_),_%25===0&&se.loading({content:`Downloading: ${_}% complete`,key:"download"})}}),v=window.URL.createObjectURL(new Blob([k.data])),T=document.createElement("a");T.href=v,T.setAttribute("download",`invoice-${s}.pdf`),document.body.appendChild(T),T.click(),T.remove(),window.URL.revokeObjectURL(v),se.success({content:"Invoice downloaded successfully",key:"download"})}catch(k){console.error("Download error:",k),se.error({content:"Failed to download invoice",key:"download"})}finally{h(!1),f(0)}},S=async k=>{try{await ne.post(`/invoices/${s}/share/email`,k),se.success("Invoice shared via email successfully"),o(!1),y.resetFields()}catch(v){console.error("Email sharing error:",v),se.error("Failed to share invoice via email")}},j=async k=>{try{await ne.post(`/invoices/${s}/share/whatsapp`,k),se.success("Invoice shared via WhatsApp successfully"),u(!1),y.resetFields()}catch(v){console.error("WhatsApp sharing error:",v),se.error("Failed to share invoice via WhatsApp")}};return i||!n?e.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",n),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(K,{title:"Invoice Details",extra:e.jsxs(J,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(J,{children:[e.jsx(O,{icon:e.jsx(as,{}),onClick:()=>t(-1),disabled:x,children:"Back"}),e.jsx(O,{type:"primary",icon:e.jsx(Ur,{}),onClick:R,loading:x&&d<100,disabled:x&&d>=100,children:"Download"}),e.jsx(O,{icon:e.jsx(Ot,{}),onClick:()=>o(!0),disabled:x,children:"Share via Email"}),e.jsx(O,{icon:e.jsx(Ca,{}),onClick:()=>u(!0),disabled:x,children:"Share via WhatsApp"})]}),x&&e.jsx(Tt,{percent:d,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:e.jsx(fl,{booking:{...n.bookingId,customerGSTIN:n.bookingId.customerGSTIN||"",invoiceNumber:n.invoiceNumber,exhibitionId:{...n.bookingId.exhibitionId,companyName:n.bookingId.exhibitionId.companyName||"Company Name",bankName:n.bookingId.exhibitionId.bankName||"",bankAccount:n.bookingId.exhibitionId.bankAccount||"",bankAccountName:n.bookingId.exhibitionId.bankAccountName||"",bankBranch:n.bookingId.exhibitionId.bankBranch||"",bankIFSC:n.bookingId.exhibitionId.bankIFSC||"",companyCIN:n.bookingId.exhibitionId.companyCIN||"",companyPAN:n.bookingId.exhibitionId.companyPAN||"",companySAC:n.bookingId.exhibitionId.companySAC||"",companyGST:n.bookingId.exhibitionId.companyGST||"",companyEmail:n.bookingId.exhibitionId.companyEmail||"",companyWebsite:n.bookingId.exhibitionId.companyWebsite||"",companyAddress:n.bookingId.exhibitionId.companyAddress||"",headerLogo:n.bookingId.exhibitionId.headerLogo||void 0},calculations:{...n.bookingId.calculations,stalls:n.bookingId.calculations.stalls.map(k=>({discount:k.discount?{...k.discount,type:k.discount.type||"percentage",value:k.discount.value}:void 0}))}}})}),e.jsx(je,{title:"Share Invoice via Email",open:r,onCancel:()=>o(!1),footer:null,children:e.jsxs(L,{form:y,onFinish:S,layout:"vertical",children:[e.jsx(L.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(G,{placeholder:"Enter email address"})}),e.jsx(L.Item,{name:"message",label:"Message (Optional)",children:e.jsx(G.TextArea,{placeholder:"Enter optional message"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(je,{title:"Share Invoice via WhatsApp",open:a,onCancel:()=>u(!1),footer:null,children:e.jsxs(L,{form:y,onFinish:j,layout:"vertical",children:[e.jsx(L.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:e.jsx(G,{placeholder:"Enter phone number with country code"})}),e.jsx(L.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:Nx,Text:Ps}=pe,{Option:Un}=de,{RangePicker:Px}=Os,Rx=()=>{var ae;const s=Ie(),t=Re(),[n,i]=l.useState(1),[r,o]=l.useState(10),[a,u]=l.useState(""),[y,d]=l.useState(null),[f,x]=l.useState(null),[h,R]=l.useState(null),[S,j]=l.useState(!1),[k,v]=l.useState(null),[T,A]=l.useState(""),[c,p]=l.useState(""),[_,N]=l.useState("createdAt"),[g,$]=l.useState("descend"),[b,C]=se.useMessage(),[E,P]=l.useState(null),[m,B]=l.useState(0),{exhibitions:I,loading:w}=ge(Q=>Q.exhibition);l.useEffect(()=>{t(It())},[t]);const{data:D,isLoading:M,refetch:V}=Il({page:n,limit:r}),[U,{isLoading:H}]=yx(),Y=De.useMemo(()=>D!=null&&D.data?D.data.filter(Q=>{const re=a.toLowerCase(),be=a===""||Q.invoiceNumber&&Q.invoiceNumber.toLowerCase().includes(re)||Q._id.toLowerCase().includes(re)||Q.bookingId.customerName&&Q.bookingId.customerName.toLowerCase().includes(re)||Q.bookingId.companyName&&Q.bookingId.companyName.toLowerCase().includes(re),W=!y||Q.status===y,he=!f||Q.bookingId.exhibitionId&&Q.bookingId.exhibitionId._id===f;let xe=!0;if(h&&h[0]&&h[1]){const we=Ae(Q.createdAt);xe=we.isAfter(h[0])&&we.isBefore(h[1])}return be&&W&&he&&xe}):[],[D,a,y,f,h]),Z=async Q=>{try{P(Q),B(0),b.loading({content:"Preparing invoice...",key:Q});const re=await $a(`/invoices/${Q}/download?force=false`,!1,he=>{const xe=he.total,we=he.loaded;if(xe){const $e=Math.round(we*100/xe);B($e),$e%25===0&&b.loading({content:`Downloading: ${$e}% complete`,key:Q})}}),be=window.URL.createObjectURL(new Blob([re.data])),W=document.createElement("a");W.href=be,W.setAttribute("download",`invoice-${Q}.pdf`),document.body.appendChild(W),W.click(),W.remove(),window.URL.revokeObjectURL(be),b.success({content:"Invoice downloaded successfully",key:Q})}catch(re){console.error("Download error:",re),b.error({content:"Failed to download invoice",key:Q})}finally{P(null),B(0)}},q=async()=>{if(!(!k||!T))try{b.loading({content:"Sending email...",key:"email"}),await U({id:k,email:T,message:c||void 0}).unwrap(),b.success({content:"Invoice sent via email successfully",key:"email"}),j(!1),A(""),p(""),v(null)}catch(Q){console.error("Email error:",Q),b.error({content:"Failed to send invoice via email",key:"email"})}},X=Q=>{v(Q),j(!0)},z=()=>{u(""),d(null),x(null),R(null)},ee=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:_==="invoiceNumber"?g:null,render:(Q,re)=>e.jsx("a",{onClick:()=>s(`/invoice/${re._id}`),children:Q||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:_==="companyName"?g:null,render:Q=>Q||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:_==="exhibitionName"?g:null,render:(Q,re)=>e.jsx("a",{onClick:()=>s(`/exhibition/${re.bookingId.exhibitionId._id}`),children:Q})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:_==="amount"?g:null,render:Q=>`${Q.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:_==="status"?g:null,render:Q=>e.jsx(le,{color:Q==="paid"?"green":Q==="pending"?"gold":Q==="cancelled"?"red":"blue",children:Q.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:_==="dueDate"?g:null,render:Q=>Q?Ae(Q).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:_==="createdAt"?g:null,render:Q=>Ae(Q).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(Q,re)=>e.jsxs(J,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs(J,{children:[e.jsx(_e,{title:"View Invoice",children:e.jsx(O,{type:"text",icon:e.jsx(Xt,{}),onClick:()=>s(`/invoice/${re._id}`)})}),e.jsx(_e,{title:"Download",children:e.jsx(O,{type:"text",icon:e.jsx(Ur,{}),onClick:()=>Z(re._id),loading:E===re._id&&m<100,disabled:E!==null&&E!==re._id})}),e.jsx(_e,{title:"Email",children:e.jsx(O,{type:"text",icon:e.jsx(Ot,{}),onClick:()=>X(re._id),disabled:E!==null})})]}),E===re._id&&e.jsx(Tt,{percent:m,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],ce=(Q,re,be)=>{be&&be.field&&(N(be.field),$(be.order||"descend"))};return e.jsxs(st,{children:[C,e.jsxs("div",{className:"invoice-list-container",children:[e.jsx(K,{children:e.jsxs(J,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Nx,{level:2,style:{margin:0},children:"Invoices"}),e.jsx(J,{children:e.jsx(_e,{title:"Refresh",children:e.jsx(O,{icon:e.jsx(yn,{}),onClick:()=>V(),loading:M})})})]}),e.jsx(K,{size:"small",title:e.jsxs(J,{children:[e.jsx(Ii,{})," Filters"]}),children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[e.jsxs("div",{style:{minWidth:"200px",flex:1},children:[e.jsx(Ps,{strong:!0,children:"Search"}),e.jsx(G,{placeholder:"Search by invoice #, company...",value:a,onChange:Q=>u(Q.target.value),prefix:e.jsx(os,{}),allowClear:!0})]}),e.jsxs("div",{style:{minWidth:"150px"},children:[e.jsx(Ps,{strong:!0,children:"Status"}),e.jsxs(de,{style:{width:"100%"},placeholder:"Filter by status",value:y,onChange:d,allowClear:!0,children:[e.jsx(Un,{value:"pending",children:"Pending"}),e.jsx(Un,{value:"paid",children:"Paid"}),e.jsx(Un,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{style:{minWidth:"200px"},children:[e.jsx(Ps,{strong:!0,children:"Exhibition"}),e.jsx(de,{style:{width:"100%"},placeholder:"Filter by exhibition",value:f,onChange:x,loading:w,allowClear:!0,children:I.map(Q=>e.jsx(Un,{value:Q._id||Q.id,children:Q.name},Q._id||Q.id))})]}),e.jsxs("div",{style:{minWidth:"300px"},children:[e.jsx(Ps,{strong:!0,children:"Date Range"}),e.jsx(Px,{style:{width:"100%"},value:h,onChange:R})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx(O,{icon:e.jsx(dc,{}),onClick:z,children:"Clear Filters"})})]})}),e.jsx(Ne,{columns:ee,dataSource:Y,rowKey:"_id",loading:M,pagination:{current:n,pageSize:r,total:((ae=D==null?void 0:D.pagination)==null?void 0:ae.total)||0,onChange:(Q,re)=>{i(Q),re&&o(re)},showSizeChanger:!0,showTotal:Q=>`Total ${Q} invoices`},onChange:ce})]})}),e.jsxs(je,{title:"Send Invoice via Email",open:S,onCancel:()=>j(!1),onOk:q,okText:"Send",confirmLoading:H,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(Ps,{strong:!0,children:"Email Address"}),e.jsx(G,{placeholder:"Enter recipient email",value:T,onChange:Q=>A(Q.target.value),style:{width:"100%"}})]}),e.jsxs("div",{children:[e.jsx(Ps,{strong:!0,children:"Message (Optional)"}),e.jsx(G.TextArea,{placeholder:"Enter optional message",value:c,onChange:Q=>p(Q.target.value),rows:4})]})]})]})]})},{Title:Ze,Paragraph:Je,Text:Vn}=pe,{Content:_x}=qe,Dx=s=>{if(!s)return"/exhibition-placeholder.jpg";if(s.startsWith("/")||s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;return t.includes("logos/")||t.includes("sponsors/")?`${ne.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},Lx=te(_x)`
  padding-top: 64px;
`,$x=te.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,Fx=te.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Bx=te.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Rs=te(K)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Mx=te(K)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,en=te(Ze)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,_s=te.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,Hn=te.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,ba=te.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,zx=te(le)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,ja=te(O)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,tn=te.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;te.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const qx=()=>{const s=Ie(),t=Re(),[n,i]=l.useState([]),[r,o]=l.useState(!0);l.useEffect(()=>{(async()=>{try{o(!0);const f=await mt.getExhibitions();i(f.data.slice(0,4))}catch(f){console.error("Failed to fetch exhibitions:",f)}finally{o(!1)}})()},[]);const a=d=>{const f={year:"numeric",month:"short",day:"numeric"};return new Date(d).toLocaleDateString(void 0,f)},u=(d,f)=>{const x=new Date,h=new Date(d),R=new Date(f);return x<h?{status:"Upcoming",color:"#722ED1"}:x>R?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},y=()=>{t(js(void 0))};return e.jsxs(qe,{children:[e.jsx(At,{}),e.jsxs(Lx,{children:[e.jsxs($x,{children:[e.jsx(Fx,{}),e.jsx(Bx,{children:e.jsxs(ie,{gutter:[48,48],align:"middle",children:[e.jsxs(F,{xs:24,lg:14,children:[e.jsx(Ze,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),e.jsx(Je,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),e.jsx(J,{size:16,wrap:!0,children:e.jsx(ja,{type:"primary",size:"large",onClick:()=>s("/exhibitions"),icon:e.jsx(wr,{}),children:"Explore Exhibitions"})})]}),e.jsx(F,{xs:24,lg:10,children:e.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:d=>{const f=d.target;f.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",f.onerror=()=>{f.style.height="300px",f.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",f.onerror=null;const x=f.parentElement;if(x){const h=document.createElement("div");h.style.position="absolute",h.style.top="50%",h.style.left="50%",h.style.transform="translate(-50%, -50%)",h.style.color="white",h.style.fontSize="18px",h.style.fontWeight="bold",h.style.textAlign="center",h.textContent="Exhibition Venue",x.appendChild(h)}}}})})]})})]}),e.jsx(tn,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(en,{level:2,children:"Featured Exhibitions"}),r?e.jsx(ie,{gutter:[24,24],children:[1,2,3,4].map(d=>e.jsx(F,{xs:24,sm:12,lg:6,children:e.jsx(K,{style:{borderRadius:"12px"},children:e.jsx(Ft,{active:!0,avatar:!0,paragraph:{rows:3}})})},d))}):n.length>0?e.jsx(ie,{gutter:[24,24],children:n.map((d,f)=>{const{status:x,color:h}=u(d.startDate,d.endDate);return e.jsx(F,{xs:24,sm:12,lg:6,children:e.jsxs(Mx,{onClick:()=>s(Li(d)),cover:e.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[e.jsx("img",{alt:d.name,src:d.headerLogo?Dx(d.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0.95)"}}),e.jsx(le,{color:h,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:x}),f===0&&e.jsx(zx,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[e.jsx(Ze,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:d.name}),e.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[e.jsx(Et,{style:{color:"#4158D0"}}),e.jsxs(Vn,{type:"secondary",style:{fontSize:13},children:[a(d.startDate)," - ",a(d.endDate)]})]}),d.venue&&e.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[e.jsx(ys,{style:{color:"#C850C0"}}),e.jsx(Vn,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:d.venue})]}),e.jsx(O,{type:"link",style:{padding:0,height:"auto"},icon:e.jsx(wr,{}),children:"View Details"})]})},d._id)})}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(Je,{children:"No exhibitions available at the moment. Check back soon!"})}),e.jsx("div",{style:{textAlign:"center",marginTop:40},children:e.jsx(O,{type:"primary",size:"large",onClick:()=>s("/exhibitions"),icon:e.jsx(uc,{}),children:"View All Exhibitions"})})]})}),e.jsx(tn,{className:"how-it-works",children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(en,{level:2,children:"How to Book Stall"}),e.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:e.jsx(Je,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),e.jsxs("div",{className:"booking-steps",children:[e.jsx("div",{className:"step-indicator",children:e.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(d=>e.jsxs("div",{className:"step-dot-container",children:[e.jsx("div",{className:"step-dot",children:d}),e.jsx("div",{className:"step-label",children:`Step ${d}`})]},d)),e.jsx("div",{className:"step-progress-line"})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:40},children:[e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"1"}),e.jsx("div",{className:"step-icon",children:e.jsx(Pe,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Register"}),e.jsx(Je,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"2"}),e.jsx("div",{className:"step-icon",children:e.jsx(Be,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Admin Approval"}),e.jsx(Je,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsx("div",{className:"step-icon",children:e.jsx(ut,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Login & Book Stall"}),e.jsx(Je,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"4"}),e.jsx("div",{className:"step-icon",children:e.jsx(et,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Stall Goes to Reserved"}),e.jsx(Je,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"5"}),e.jsx("div",{className:"step-icon",children:e.jsx(Be,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Admin Final Approval"}),e.jsx(Je,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"6"}),e.jsx("div",{className:"step-icon",children:e.jsx(Be,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Stall Becomes Booked"}),e.jsx(Je,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),e.jsx(F,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"7"}),e.jsx("div",{className:"step-icon",children:e.jsx(po,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ze,{level:5,children:"Make Payment in 3 Days"}),e.jsx(Je,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),e.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),e.jsx("div",{style:{textAlign:"center",marginTop:60},children:e.jsx(ja,{type:"primary",size:"large",onClick:y,icon:e.jsx(Pe,{}),children:"Register as Exhibitor"})})]})}),e.jsx(tn,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(en,{level:2,children:"Why Choose Us"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:e.jsx(Ss,{})}),e.jsx(Ze,{level:4,children:"Interactive Layouts"}),e.jsx(Je,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:e.jsx(ut,{})}),e.jsx(Ze,{level:4,children:"Real-time Availability"}),e.jsx(Je,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:e.jsx(po,{})}),e.jsx(Ze,{level:4,children:"Secure Payments"}),e.jsx(Je,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:e.jsx(Mr,{})}),e.jsx(Ze,{level:4,children:"Exhibitor Dashboard"}),e.jsx(Je,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:e.jsx(Et,{})}),e.jsx(Ze,{level:4,children:"Schedule Management"}),e.jsx(Je,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),e.jsx(F,{xs:24,sm:12,lg:8,children:e.jsxs(Rs,{children:[e.jsx(_s,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:e.jsx(Be,{})}),e.jsx(Ze,{level:4,children:"Support & Assistance"}),e.jsx(Je,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),e.jsx(tn,{className:"gray-bg",children:e.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:e.jsxs(ie,{gutter:[48,48],children:[e.jsxs(F,{xs:24,lg:12,children:[e.jsx(en,{level:2,children:"Our Impact"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(F,{xs:12,children:e.jsx(Hn,{children:e.jsx(ke,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),e.jsx(F,{xs:12,children:e.jsx(Hn,{children:e.jsx(ke,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),e.jsx(F,{xs:12,children:e.jsx(Hn,{children:e.jsx(ke,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),e.jsx(F,{xs:12,children:e.jsx(Hn,{children:e.jsx(ke,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),e.jsxs(F,{xs:24,lg:12,children:[e.jsx(en,{level:2,children:"What Exhibitors Say"}),e.jsxs(hc,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[e.jsx("div",{children:e.jsxs(ba,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Pe,{}),style:{backgroundColor:"#4158D0"}}),e.jsxs("div",{children:[e.jsx(Ze,{level:5,style:{margin:0},children:"Sarah Johnson"}),e.jsx(Vn,{type:"secondary",children:"Tech Innovations Inc."})]})]}),e.jsx(Je,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),e.jsx("div",{children:e.jsxs(ba,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Pe,{}),style:{backgroundColor:"#C850C0"}}),e.jsxs("div",{children:[e.jsx(Ze,{level:5,style:{margin:0},children:"Michael Chen"}),e.jsx(Vn,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),e.jsx(Je,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),e.jsx(tn,{style:{padding:"60px 0"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Ze,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),e.jsx(Je,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),e.jsxs(J,{size:16,wrap:!0,style:{justifyContent:"center"},children:[e.jsx(O,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>s("/exhibitions"),icon:e.jsx(ut,{}),children:"Browse Exhibitions"}),e.jsx(O,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:y,icon:e.jsx(Pe,{}),children:"Register as Exhibitor"})]})]})})]}),e.jsx(kl,{})]})},{Title:Ox,Text:Ee,Paragraph:Ux}=pe,{Option:Wn}=de,{TextArea:va,Search:Vx}=G,{RangePicker:Hx}=Os,Wx=()=>{const s=Re(),{exhibitors:t,loading:n}=ge(q=>q.exhibitor),[i,r]=l.useState(null),[o,a]=l.useState(!1),[u,y]=l.useState(!1),[d,f]=l.useState(!1),[x,h]=l.useState("approved"),[R,S]=l.useState(""),[j,k]=l.useState(!1),[v,T]=l.useState(!1),[A,c]=l.useState(!1),[p,_]=l.useState(""),[N,g]=l.useState([]),[$]=L.useForm(),[b,C]=l.useState([]);b.length>0;const[E,P]=l.useState({total:0,pending:0,approved:0,rejected:0});l.useEffect(()=>{s(Mt())},[s]),l.useEffect(()=>{if(t!=null&&t.length){g(t);const q={total:t.length,pending:t.filter(X=>X.status==="pending").length,approved:t.filter(X=>X.status==="approved").length,rejected:t.filter(X=>X.status==="rejected").length};P(q)}},[t]),l.useEffect(()=>{i&&u&&$.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,u,$]);const m=q=>{switch(q){case"approved":return e.jsx(le,{color:"success",children:"Approved"});case"pending":return e.jsx(le,{color:"warning",children:"Pending"});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});default:return e.jsx(le,{children:"Unknown"})}},B=async()=>{var q,X;if(i)try{k(!0),await rt.updateStatus(i._id,x,x==="rejected"?R:void 0),se.success(`Exhibitor status updated to ${x}`),a(!1),s(Mt())}catch(z){se.error(((X=(q=z.response)==null?void 0:q.data)==null?void 0:X.message)||"Failed to update exhibitor status")}finally{k(!1)}},I=async q=>{var X,z;if(i)try{T(!0),await rt.updateExhibitor(i._id,q),se.success("Exhibitor details updated successfully"),y(!1),s(Mt())}catch(ee){se.error(((z=(X=ee.response)==null?void 0:X.data)==null?void 0:z.message)||"Failed to update exhibitor details")}finally{T(!1)}},w=async q=>{var X,z;try{c(!0),await rt.deleteExhibitor(q),se.success("Exhibitor deleted successfully"),s(Mt())}catch(ee){se.error(((z=(X=ee.response)==null?void 0:X.data)==null?void 0:z.message)||"Failed to delete exhibitor")}finally{c(!1)}},D=q=>{if(_(q),!q){g(t);return}const X=q.toLowerCase(),z=t.filter(ee=>ee.companyName.toLowerCase().includes(X)||ee.contactPerson.toLowerCase().includes(X)||ee.email.toLowerCase().includes(X)||ee.phone.toLowerCase().includes(X));g(z)},M=q=>{if(q==="all"){g(t);return}const X=t.filter(z=>z.status===q);g(X)},V=q=>{if(!q||q.length!==2){g(t);return}const X=q[0].startOf("day").toISOString(),z=q[1].endOf("day").toISOString(),ee=t.filter(ce=>{const ae=new Date(ce.createdAt).toISOString();return ae>=X&&ae<=z});g(ee)},U=()=>{const q=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],X=N.map(Q=>[Q.companyName,Q.contactPerson,Q.email,Q.phone,Q.status,Q.isActive?"Yes":"No",new Date(Q.createdAt).toLocaleDateString(),Q.address||"",Q.website||""]);X.unshift(q);const z=X.map(Q=>Q.map(re=>typeof re=="string"&&(re.includes(",")||re.includes('"')||re.includes(`
`))?`"${re.replace(/"/g,'""')}"`:re).join(",")).join(`
`),ee=new Blob([z],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(ee),ae=document.createElement("a");ae.setAttribute("href",ce),ae.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),ae.style.visibility="hidden",document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),se.success("Exhibitor data exported successfully")},H=()=>{je.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${b.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{c(!0);const q=b.map(X=>rt.deleteExhibitor(X.toString()));await Promise.all(q),se.success(`${b.length} exhibitors deleted successfully`),C([]),s(Mt())}catch{se.error("Failed to delete some exhibitors")}finally{c(!1)}}})},Y={selectedRowKeys:b,onChange:q=>{C(q)}},Z=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(q,X)=>q.companyName.localeCompare(X.companyName),filterDropdown:({setSelectedKeys:q,selectedKeys:X,confirm:z,clearFilters:ee})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(G,{placeholder:"Search company or contact",value:X[0],onChange:ce=>q(ce.target.value?[ce.target.value]:[]),onPressEnter:()=>z(),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(J,{children:[e.jsx(O,{type:"primary",onClick:()=>z(),icon:e.jsx(os,{}),size:"small",style:{width:90},children:"Filter"}),e.jsx(O,{onClick:()=>{ee&&ee(),z()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:q=>e.jsx(os,{style:{color:q?"#1890ff":void 0}}),onFilter:(q,X)=>{const z=String(q).toLowerCase();return X.companyName.toLowerCase().includes(z)||X.contactPerson.toLowerCase().includes(z)},render:(q,X)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:q}),e.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",X.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(q,X)=>e.jsxs("div",{children:[e.jsx("div",{children:q}),e.jsx("div",{style:{fontSize:"12px"},children:X.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(q,X)=>X.status===q,render:q=>m(q)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(q,X)=>X.isActive===q,render:q=>e.jsx(le,{color:q?"green":"red",children:q?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(q,X)=>new Date(q.createdAt).getTime()-new Date(X.createdAt).getTime(),render:q=>e.jsx(_e,{title:new Date(q).toLocaleString(),children:new Date(q).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:q=>q?e.jsx("a",{href:q,target:"_blank",rel:"noopener noreferrer",children:q.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(q,X)=>e.jsxs(J,{children:[e.jsx(_e,{title:"View Details",children:e.jsx(O,{icon:e.jsx(Xt,{}),onClick:()=>{r(X),f(!0)}})}),e.jsx(O,{type:"primary",onClick:()=>{r(X),h(X.status),S(X.rejectionReason||""),a(!0)},children:"Update Status"}),e.jsx(vs,{overlay:e.jsxs(jt,{children:[e.jsx(jt.Item,{icon:e.jsx(Ms,{}),onClick:()=>{r(X),y(!0)},children:"Edit"},"edit"),e.jsx(jt.Item,{icon:e.jsx(ot,{}),danger:!0,onClick:z=>{z.domEvent.stopPropagation(),je.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>w(X._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(O,{icon:e.jsx(Vr,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(F,{flex:"auto",children:e.jsxs(J,{direction:"vertical",size:4,children:[e.jsx(Ox,{level:4,style:{margin:0},children:"Exhibitors"}),e.jsx(Ee,{type:"secondary",children:"Manage exhibitors and their information"})]})}),e.jsx(F,{children:e.jsx(O,{type:"primary",icon:e.jsx(dn,{}),onClick:()=>y(!0),size:"large",children:"Add Exhibitor"})})]})}),e.jsxs(ie,{gutter:[16,24],style:{marginBottom:"24px"},children:[e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Total Exhibitors",value:E.total,prefix:e.jsx(Pe,{})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Pending",value:E.pending,prefix:e.jsx(et,{style:{color:"#faad14"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Approved",value:E.approved,prefix:e.jsx(Be,{style:{color:"#52c41a"}})})})}),e.jsx(F,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(ke,{title:"Rejected",value:E.rejected,prefix:e.jsx(Nt,{style:{color:"#ff4d4f"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"24px"},children:e.jsxs(J,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(F,{xs:24,sm:8,md:6,lg:4,children:e.jsx(Vx,{placeholder:"Search exhibitors",allowClear:!0,onSearch:D,style:{width:"100%"}})}),e.jsx(F,{xs:24,sm:8,md:6,lg:4,children:e.jsxs(de,{placeholder:"Filter by status",style:{width:"100%"},onChange:M,allowClear:!0,children:[e.jsx(Wn,{value:"all",children:"All Status"}),e.jsx(Wn,{value:"pending",children:"Pending"}),e.jsx(Wn,{value:"approved",children:"Approved"}),e.jsx(Wn,{value:"rejected",children:"Rejected"})]})}),e.jsx(F,{xs:24,sm:8,md:6,lg:6,children:e.jsx(Hx,{style:{width:"100%"},onChange:V})})]}),b.length>0&&e.jsx(ie,{children:e.jsxs(J,{children:[e.jsxs(Ee,{children:["Selected ",b.length," items"]}),e.jsx(O,{danger:!0,onClick:H,children:"Delete Selected"}),e.jsx(O,{type:"primary",onClick:U,children:"Export Selected"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx(Ne,{rowSelection:Y,dataSource:N,columns:Z,rowKey:"_id",loading:n,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(q,X)=>`${X[0]}-${X[1]} of ${q} items`},scroll:{x:1500}})}),e.jsx(je,{title:"Exhibitor Details",open:d,onCancel:()=>f(!1),footer:[e.jsx(O,{onClick:()=>f(!1),children:"Close"},"close")],width:600,children:i&&e.jsx("div",{children:e.jsxs(ie,{gutter:[16,16],children:[e.jsx(F,{span:24,children:e.jsx(K,{title:"Company Information",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Company Name:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.companyName})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Contact Person:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.contactPerson})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Email:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.email})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Phone:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.phone})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Address:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.address||"Not provided"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Status:"})}),e.jsx(F,{span:12,children:m(i.status)}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Active:"})}),e.jsx(F,{span:12,children:e.jsx(gt,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Registration Date:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:new Date(i.createdAt).toLocaleString()})})]})})}),e.jsx(F,{span:24,children:e.jsxs(K,{title:"Additional Information",children:[e.jsxs(ie,{gutter:[16,8],children:[e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Address:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{children:i.address||"Not provided"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Website:"})}),e.jsx(F,{span:12,children:i.website?e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx(F,{span:12,children:e.jsx(Ee,{strong:!0,children:"Rejection Reason:"})}),e.jsx(F,{span:12,children:e.jsx(Ee,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&e.jsxs(e.Fragment,{children:[e.jsx(Te,{}),e.jsx(Ee,{strong:!0,children:"Description:"}),e.jsx(Ux,{style:{marginTop:8},children:i.description})]})]})})]})})}),e.jsx(je,{title:"Update Exhibitor Status",open:o,onCancel:()=>a(!1),footer:null,width:600,children:i&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Pe,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(F,{span:8,children:e.jsx(Ee,{strong:!0,children:"Company:"})}),e.jsx(F,{span:16,children:e.jsx(Ee,{children:i.companyName})}),e.jsx(F,{span:8,children:e.jsx(Ee,{strong:!0,children:"Contact Person:"})}),e.jsx(F,{span:16,children:e.jsx(Ee,{children:i.contactPerson})}),e.jsx(F,{span:8,children:e.jsx(Ee,{strong:!0,children:"Email:"})}),e.jsx(F,{span:16,children:e.jsx(Ee,{children:i.email})}),e.jsx(F,{span:8,children:e.jsx(Ee,{strong:!0,children:"Address:"})}),e.jsx(F,{span:16,children:e.jsx(Ee,{children:i.address||"Not provided"})}),e.jsx(F,{span:8,children:e.jsx(Ee,{strong:!0,children:"Current Status:"})}),e.jsx(F,{span:16,children:m(i.status)})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(qs,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Ee,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(Bt.Group,{value:x,onChange:q=>h(q.target.value),buttonStyle:"solid",children:[e.jsx(Bt.Button,{value:"pending",children:e.jsxs(J,{children:[e.jsx(et,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(Bt.Button,{value:"approved",children:e.jsxs(J,{children:[e.jsx(Be,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(Bt.Button,{value:"rejected",children:e.jsxs(J,{children:[e.jsx(Nt,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),x==="rejected"&&e.jsx("div",{children:e.jsx(L.Item,{label:e.jsx(Ee,{strong:!0,children:"Rejection Reason:"}),required:x==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:e.jsx(va,{rows:4,value:R,onChange:q=>S(q.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),x==="approved"&&e.jsx(He,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),x==="pending"&&e.jsx(He,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(O,{onClick:()=>a(!1),children:"Cancel"}),e.jsx(O,{type:"primary",onClick:B,loading:j,disabled:x==="rejected"&&!R.trim(),children:"Update Status"})]})]})]})}),e.jsx(je,{title:"Edit Exhibitor Details",open:u,onCancel:()=>y(!1),footer:null,width:600,children:e.jsxs(L,{form:$,layout:"vertical",onFinish:I,children:[e.jsx(L.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(G,{})}),e.jsx(L.Item,{name:"address",label:"Address",children:e.jsx(G,{})}),e.jsx(L.Item,{name:"website",label:"Website",children:e.jsx(G,{})}),e.jsx(L.Item,{name:"description",label:"Description",children:e.jsx(va,{rows:4})}),e.jsx(L.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(xt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(L.Item,{children:e.jsxs(J,{children:[e.jsx(O,{type:"primary",htmlType:"submit",loading:v,children:"Save Changes"}),e.jsx(O,{onClick:()=>y(!1),children:"Cancel"})]})})]})})]})},Ue=({children:s})=>ge(n=>n.auth.isAuthenticated)?s:e.jsx(Ei,{to:"/login"}),Ds=({children:s})=>ge(n=>n.exhibitorAuth.isAuthenticated)?s:e.jsx(Ei,{to:"/"});function Yx(){return e.jsx(st,{children:e.jsx(wn,{children:e.jsx(Sc,{children:e.jsxs(kc,{children:[e.jsx(Se,{path:"/",element:e.jsx(qx,{})}),e.jsx(Se,{path:"/login",element:e.jsx(Wu,{})}),e.jsx(Se,{path:"/exhibitions",element:e.jsx(ex,{})}),e.jsx(Se,{path:"/exhibitions/:id",element:e.jsx(Mm,{})}),e.jsx(Se,{path:"/exhibitions/:id/layout",element:e.jsx($m,{})}),e.jsx(Se,{path:"/exhibitor/dashboard",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx(Xu,{})})})}),e.jsx(Se,{path:"/exhibitor/profile",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx(nh,{})})})}),e.jsx(Se,{path:"/exhibitor/bookings",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx(th,{})})})}),e.jsx(Se,{path:"/exhibitor/bookings/:id",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx(sh,{})})})}),e.jsx(Se,{path:"/exhibitor/support",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx("div",{children:"Help & Support"})})})}),e.jsx(Se,{path:"/exhibitor/invoice/:id",element:e.jsx(Ds,{children:e.jsx(ks,{children:e.jsx(Xh,{})})})}),e.jsx(Se,{path:"/dashboard",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Gu,{})})})}),e.jsx(Se,{path:"/account",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Jh,{})})})}),e.jsx(Se,{path:"/exhibition",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Fp,{})})})}),e.jsx(Se,{path:"/exhibition/create",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Up,{})})})}),e.jsx(Se,{path:"/exhibition/:id",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Vp,{})})})}),e.jsx(Se,{path:"/exhibition/:id/space",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(rm,{})})})}),e.jsx(Se,{path:"/exhibition/:id/layout",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(am,{})})})}),e.jsx(Se,{path:"/exhibition/:id/halls",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(cm,{})})})}),e.jsx(Se,{path:"/exhibition/:id/stalls",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(sx,{})})})}),e.jsx(Se,{path:"/exhibition/:id/fixtures",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(rx,{})})})}),e.jsx(Se,{path:"/exhibition/:id/edit",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Hp,{})})})}),e.jsx(Se,{path:"/stall/list",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(lx,{})})})}),e.jsx(Se,{path:"/stall-types",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(px,{})})})}),e.jsx(Se,{path:"/bookings",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Sx,{})})})}),e.jsx(Se,{path:"/bookings/create",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Ax,{})})})}),e.jsx(Se,{path:"/invoices",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Rx,{})})})}),e.jsx(Se,{path:"/invoice/:id",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Tx,{})})})}),e.jsx(Se,{path:"/index",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Ap,{})})})}),e.jsx(Se,{path:"/settings",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(tp,{})})})}),e.jsx(Se,{path:"/roles",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(hp,{})})})}),e.jsx(Se,{path:"/notifications",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Rp,{})})})}),e.jsx(Se,{path:"/exhibitors",element:e.jsx(Ue,{children:e.jsx(Oe,{children:e.jsx(Wx,{})})})}),e.jsx(Se,{path:"*",element:e.jsx(Ei,{to:"/",replace:!0})})]})})})})}const br=ro({reducerPath:"bookingApi",baseQuery:to({baseUrl:"/api"}),endpoints:s=>({getBookings:s.query({query:()=>"/bookings"}),getBooking:s.query({query:t=>`/bookings/${t}`}),createBooking:s.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:s.mutation({query:({id:t,status:n})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:n}})})})}),Qx=Cc({reducer:{auth:Bc,exhibitorAuth:ou,exhibition:Dp,booking:xx,exhibitor:Ix,settings:Gd,role:lp,user:bp,[br.reducerPath]:br.reducer,[xi.reducerPath]:xi.reducer,[ei.reducerPath]:ei.reducer},middleware:s=>s().concat(br.middleware).concat(xi.middleware).concat(ei.middleware)}),Gx={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};Sr.createRoot(document.getElementById("root")).render(e.jsx(De.StrictMode,{children:e.jsx(Ic,{store:Qx,children:e.jsx(pc,{theme:Gx,children:e.jsx(st,{children:e.jsx(Yx,{})})})})}));
