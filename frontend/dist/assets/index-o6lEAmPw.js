import{j as e}from"./index-DoSueJxk.js";import{u as N,r}from"./vendor-react-dkbxt9Jf.js";import d from"./stall-BMZvk0fo.js";/* empty css                  */import{Y as V,K as i,$ as D,a0 as g,S as p,T as P,J as m,c as u,ah as _,a1 as q,ai as L,ag as O,ab as T,b as j}from"./vendor-antd-mFVHvrVJ.js";import"./vendor-utils-ngrFHoWO.js";import"./vendor-styling-CQa69cNz.js";const{Title:R,Text:B}=P,{TextArea:K}=m,{Search:U}=m,{Option:S}=T,W=()=>{N();const{message:n}=V.useApp(),[c,o]=r.useState(!1),[l]=i.useForm(),[b,f]=r.useState(!1),[v,F]=r.useState([]),[I,x]=r.useState(!1),[a,y]=r.useState(null);r.useEffect(()=>{h()},[]),r.useEffect(()=>{if(console.log("Modal visibility changed:",c),console.log("Editing stall type:",a),c&&a){const t=a.features?.map(s=>s.feature).join(", ")||"";console.log("Setting form values:",{name:a.name,description:a.description,features:t,status:a.status}),setTimeout(()=>{l.setFieldsValue({name:a.name,description:a.description,features:t,status:a.status})},0)}else c&&(l.resetFields(),l.setFieldsValue({status:"active"}))},[a,l,c]);const h=async()=>{try{x(!0);const t=await d.getStallTypes();F(t.data)}catch(t){n.error("Failed to fetch stall types: "+t.message)}finally{x(!1)}},w=async t=>{try{f(!0),console.log("Form values:",t);const s={name:t.name,description:t.description,status:t.status,features:t.features?t.features.split(",").map(M=>({feature:M.trim()})):[]};console.log("Submitting data:",s),a?(await d.updateStallType(a._id,s),n.success("Stall type updated successfully")):(await d.createStallType(s),n.success("Stall type created successfully")),o(!1),y(null),l.resetFields(),h()}catch(s){n.error(`Failed to ${a?"update":"create"} stall type: `+s.message)}finally{f(!1)}},E=t=>{console.log("Editing stall type:",t),y(t),o(!0)},k=async t=>{try{await d.deleteStallType(t._id),n.success("Stall type deleted successfully"),h()}catch(s){n.error("Failed to delete stall type: "+s.message)}},C=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(t,s)=>t.name.localeCompare(s.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:t=>e.jsx(p,{wrap:!0,children:t?.map(({feature:s})=>e.jsx(j,{children:s},s))})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(j,{color:t==="active"?"success":"default",children:t.toUpperCase()})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(p,{children:[e.jsx(u,{type:"link",onClick:()=>E(s),children:"Edit"}),e.jsx(u,{type:"link",danger:!0,onClick:()=>k(s),children:"Delete"})]})}],A=()=>{o(!1),y(null),l.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(D,{justify:"space-between",align:"middle",children:[e.jsx(g,{children:e.jsxs(p,{direction:"vertical",size:4,children:[e.jsx(R,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(B,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(g,{children:e.jsxs(p,{children:[e.jsx(U,{placeholder:"Search stall types",style:{width:200},onSearch:t=>console.log(t)}),e.jsx(u,{type:"primary",icon:e.jsx(_,{}),onClick:()=>o(!0),children:"Add Stall Type"})]})})]})}),e.jsx(q,{className:"info-card",children:e.jsx(L,{columns:C,dataSource:v,rowKey:t=>t._id,loading:I})}),e.jsx(O,{title:a?"Edit Stall Type":"Add Stall Type",open:c,onCancel:A,footer:null,destroyOnHidden:!1,children:e.jsxs(i,{form:l,layout:"vertical",onFinish:w,initialValues:{status:"active"},preserve:!0,children:[e.jsx(i.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(m,{placeholder:"e.g., 1 Side Open"})}),e.jsx(i.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(K,{rows:4,placeholder:"Enter description"})}),e.jsx(i.Item,{name:"features",label:"Features",children:e.jsx(m,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(i.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(T,{children:[e.jsx(S,{value:"active",children:"Active"}),e.jsx(S,{value:"inactive",children:"Inactive"})]})}),e.jsx(i.Item,{children:e.jsxs(u,{type:"primary",htmlType:"submit",loading:b,block:!0,children:[a?"Update":"Create"," Stall Type"]})})]})})]})};export{W as default};
