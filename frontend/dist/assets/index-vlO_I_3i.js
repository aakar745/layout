var fx=Object.defineProperty;var xx=(e,t,r)=>t in e?fx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var cd=(e,t,r)=>xx(e,typeof t!="symbol"?t+"":t,r);import{j as n}from"./vendor-pdf-BUV7_PsA.js";import{b as px,c as Os,g as mx,d as et,T as Le,L as on,e as ct,S as xe,f as Te,B as xr,A as Mr,h as ne,i as or,j as mc,k as at,l as gx,m as Yt,n as Ni,r as _,o as Xs,p as gc,q as Fi,s as Qr,t as Kt,u as Jr,E as mt,D as nt,v as Vn,w as Ct,M as lr,x as fu,y as xu,z as lo,C as co,F as Ro,G as yr,H as vt,I as yx,J as Cn,K as yc,N as vx,O as bx,P as fe,Q as H,U as Ql,V as vc,W as kt,X as En,Y as Kr,Z as Zr,$ as je,a0 as ho,a1 as uo,a2 as wx,a3 as Ae,a4 as Q,a5 as ue,a as xt,a6 as Xe,a7 as ln,a8 as pu,a9 as Pe,aa as tt,ab as Vr,ac as hn,ad as Ve,ae as Qs,af as Gn,ag as We,ah as bc,ai as fn,aj as wc,ak as fs,al as Po,am as mu,an as Xt,ao as Ir,ap as Ri,aq as jx,ar as Pi,as as fr,at as as,au as Sx,av as An,aw as Ex,ax as gn,ay as Gi,az as Di,aA as xs,aB as dd,aC as Tx,aD as jc,aE as ps,aF as yt,aG as ns,aH as os,aI as ms,aJ as _x,aK as kx,aL as Cx,aM as gu,aN as Ax,aO as hd,aP as Ix,aQ as Nx,aR as Fx,aS as yu,aT as Yi,aU as Rx,aV as ud,aW as Px,aX as Dx,aY as Lx,aZ as fd,a_ as vu,a$ as Ox,b0 as Bx,b1 as Mx,b2 as $x,b3 as Ux,b4 as zx,b5 as qx,b6 as Jl,b7 as Wx,b8 as mr,b9 as Hx,ba as Vx,bb as xd,bc as Gx,bd as Yx,be as Kx,bf as Xx,bg as Qx,bh as Jx}from"./vendor-antd-BvnfjvBw.js";import{c as Qe,a as gr,u as Je,b as $e,d as it,e as Fn,L as Cr,f as Fr,w as pd,n as bu,g as wu,i as Li,h as Zx,j as Js,k as ju,p as Sc,l as oi,m as fo,o as Ec,q as ls,r as md,s as ep,S as Su,t as rl,v as Tc,x as Eu,y as tp,z as Tu,A as rp,B as gd,C as np,D as sp,E as ip,F as ap,G as vi,N as Do,H as op,I as lp,R as cp,J as Ge,K as dp,P as hp}from"./vendor-react-BKuczOpz.js";import{a as Tr}from"./vendor-utils-D85JRr-X.js";import{n as we,k as Yn}from"./vendor-ui-BBmc9poM.js";import{E as up}from"./vendor-editor-B_qKlG3f.js";import{L as xo,G as Ys,R as Lo,T as Oi,u as fp,a as xp,I as pp,C as mp,b as gp,c as yp,K as nl,S as vp,F as bp,d as wp}from"./vendor-canvas-CwpfxZ4P.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Zl={},yd=px;Zl.createRoot=yd.createRoot,Zl.hydrateRoot=yd.hydrateRoot;const Oo="/api",_e=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Qn=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),_u=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}});_e.interceptors.request.use(e=>{var a,o,l,d,c,h,x,u,p;const t=localStorage.getItem("token"),r=localStorage.getItem("exhibitor_token"),s=((a=e.url)==null?void 0:a.startsWith("/bookings/"))&&e.method==="patch"||((o=e.url)==null?void 0:o.includes("/exhibition/"))||((l=e.url)==null?void 0:l.includes("/stalls/"))||((d=e.url)==null?void 0:d.includes("/halls/"))||((c=e.url)==null?void 0:c.includes("/users/"))||((h=e.url)==null?void 0:h.includes("/roles/")),i=((x=e.url)==null?void 0:x.includes("/test-booking"))||((u=e.url)==null?void 0:u.includes("/exhibitor-bookings"))||((p=e.url)==null?void 0:p.startsWith("/exhibitors/"));return s?t?e.headers.Authorization=`Bearer ${t}`:console.warn("Admin token required but not found for:",e.url):i&&r?e.headers.Authorization=`Bearer ${r}`:t?e.headers.Authorization=`Bearer ${t}`:r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));_u.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));_e.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});_u.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("exhibitor_token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});const ku=async(e,t=!1,r)=>{const s=t?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return Tr.get(`${Oo}${e}`,{responseType:"blob",headers:{Authorization:`Bearer ${s}`},onDownloadProgress:r})},po={login:async e=>await _e.post("/auth/login",e),getProfile:async()=>await _e.get("/auth/me"),changePassword:async e=>await _e.post("/auth/change-password",e)},vd=localStorage.getItem("token"),sl=localStorage.getItem("user");let Cu=null;try{Cu=sl&&sl!=="undefined"?JSON.parse(sl):null}catch(e){console.error("Failed to parse user data from localStorage",e),localStorage.removeItem("user")}const jp={isAuthenticated:!!vd,user:Cu,token:vd,loading:!1,error:null},Ma=Qe("auth/refreshUser",async(e,{rejectWithValue:t})=>{var r,s;try{return(await po.getProfile()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to refresh user data")}}),Au=gr({name:"auth",initialState:jp,reducers:{setCredentials:(e,t)=>{e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:e=>{e.addCase(Ma.pending,t=>{t.loading=!0,t.error=null}).addCase(Ma.fulfilled,(t,r)=>{t.loading=!1,t.user=r.payload,localStorage.setItem("user",JSON.stringify(r.payload))}).addCase(Ma.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{setCredentials:Iu,logout:bd}=Au.actions,Sp=Au.reducer,xn=Object.create(null);xn.open="0";xn.close="1";xn.ping="2";xn.pong="3";xn.message="4";xn.upgrade="5";xn.noop="6";const $a=Object.create(null);Object.keys(xn).forEach(e=>{$a[xn[e]]=e});const ec={type:"error",data:"parser error"},Nu=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Fu=typeof ArrayBuffer=="function",Ru=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,_c=({type:e,data:t},r,s)=>Nu&&t instanceof Blob?r?s(t):wd(t,s):Fu&&(t instanceof ArrayBuffer||Ru(t))?r?s(t):wd(new Blob([t]),s):s(xn[e]+(t||"")),wd=(e,t)=>{const r=new FileReader;return r.onload=function(){const s=r.result.split(",")[1];t("b"+(s||""))},r.readAsDataURL(e)};function jd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let il;function Ep(e,t){if(Nu&&e.data instanceof Blob)return e.data.arrayBuffer().then(jd).then(t);if(Fu&&(e.data instanceof ArrayBuffer||Ru(e.data)))return t(jd(e.data));_c(e,!1,r=>{il||(il=new TextEncoder),t(il.encode(r))})}const Sd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gi=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Sd.length;e++)gi[Sd.charCodeAt(e)]=e;const Tp=e=>{let t=e.length*.75,r=e.length,s,i=0,a,o,l,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const c=new ArrayBuffer(t),h=new Uint8Array(c);for(s=0;s<r;s+=4)a=gi[e.charCodeAt(s)],o=gi[e.charCodeAt(s+1)],l=gi[e.charCodeAt(s+2)],d=gi[e.charCodeAt(s+3)],h[i++]=a<<2|o>>4,h[i++]=(o&15)<<4|l>>2,h[i++]=(l&3)<<6|d&63;return c},_p=typeof ArrayBuffer=="function",kc=(e,t)=>{if(typeof e!="string")return{type:"message",data:Pu(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:kp(e.substring(1),t)}:$a[r]?e.length>1?{type:$a[r],data:e.substring(1)}:{type:$a[r]}:ec},kp=(e,t)=>{if(_p){const r=Tp(e);return Pu(r,t)}else return{base64:!0,data:e}},Pu=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Du="",Cp=(e,t)=>{const r=e.length,s=new Array(r);let i=0;e.forEach((a,o)=>{_c(a,!1,l=>{s[o]=l,++i===r&&t(s.join(Du))})})},Ap=(e,t)=>{const r=e.split(Du),s=[];for(let i=0;i<r.length;i++){const a=kc(r[i],t);if(s.push(a),a.type==="error")break}return s};function Ip(){return new TransformStream({transform(e,t){Ep(e,r=>{const s=r.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,s)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(s))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(r)})}})}let al;function la(e){return e.reduce((t,r)=>t+r.length,0)}function ca(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let s=0;for(let i=0;i<t;i++)r[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function Np(e,t){al||(al=new TextDecoder);const r=[];let s=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(s===0){if(la(r)<1)break;const d=ca(r,1);a=(d[0]&128)===128,i=d[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(la(r)<2)break;const d=ca(r,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),s=3}else if(s===2){if(la(r)<8)break;const d=ca(r,8),c=new DataView(d.buffer,d.byteOffset,d.length),h=c.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(ec);break}i=h*Math.pow(2,32)+c.getUint32(4),s=3}else{if(la(r)<i)break;const d=ca(r,i);l.enqueue(kc(a?d:al.decode(d),t)),s=0}if(i===0||i>e){l.enqueue(ec);break}}}})}const Lu=4;function Dt(e){if(e)return Fp(e)}function Fp(e){for(var t in Dt.prototype)e[t]=Dt.prototype[t];return e}Dt.prototype.on=Dt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Dt.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Dt.prototype.off=Dt.prototype.removeListener=Dt.prototype.removeAllListeners=Dt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var s,i=0;i<r.length;i++)if(s=r[i],s===t||s.fn===t){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Dt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,i=r.length;s<i;++s)r[s].apply(this,t)}return this};Dt.prototype.emitReserved=Dt.prototype.emit;Dt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Dt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Bo=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Lr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Rp="arraybuffer";function Ou(e,...t){return t.reduce((r,s)=>(e.hasOwnProperty(s)&&(r[s]=e[s]),r),{})}const Pp=Lr.setTimeout,Dp=Lr.clearTimeout;function Mo(e,t){t.useNativeTimers?(e.setTimeoutFn=Pp.bind(Lr),e.clearTimeoutFn=Dp.bind(Lr)):(e.setTimeoutFn=Lr.setTimeout.bind(Lr),e.clearTimeoutFn=Lr.clearTimeout.bind(Lr))}const Lp=1.33;function Op(e){return typeof e=="string"?Bp(e):Math.ceil((e.byteLength||e.size)*Lp)}function Bp(e){let t=0,r=0;for(let s=0,i=e.length;s<i;s++)t=e.charCodeAt(s),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}function Bu(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Mp(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function $p(e){let t={},r=e.split("&");for(let s=0,i=r.length;s<i;s++){let a=r[s].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class Up extends Error{constructor(t,r,s){super(t),this.description=r,this.context=s,this.type="TransportError"}}class Cc extends Dt{constructor(t){super(),this.writable=!1,Mo(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,s){return super.emitReserved("error",new Up(t,r,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=kc(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=Mp(t);return r.length?"?"+r:""}}class zp extends Cc{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||r()})),this.writable||(s++,this.once("drain",function(){--s||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Ap(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Cp(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Bu()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let Mu=!1;try{Mu=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const qp=Mu;function Wp(){}class Hp extends zp{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let s=location.port;s||(s=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,r){const s=this.request({method:"POST",data:t});s.on("success",r),s.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,s)=>{this.onError("xhr poll error",r,s)}),this.pollXhr=t}}let Us=class Ua extends Dt{constructor(t,r,s){super(),this.createRequest=t,Mo(this,s),this._opts=s,this._method=s.method||"GET",this._uri=r,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const r=Ou(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(r);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Ua.requestsCount++,Ua.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Wp,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ua.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Us.requestsCount=0;Us.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ed);else if(typeof addEventListener=="function"){const e="onpagehide"in Lr?"pagehide":"unload";addEventListener(e,Ed,!1)}}function Ed(){for(let e in Us.requests)Us.requests.hasOwnProperty(e)&&Us.requests[e].abort()}const Vp=function(){const e=$u({xdomain:!1});return e&&e.responseType!==null}();class Gp extends Hp{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=Vp&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Us($u,this.uri(),t)}}function $u(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||qp))return new XMLHttpRequest}catch{}if(!t)try{return new Lr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Uu=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Yp extends Cc{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,s=Uu?{}:Ou(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;_c(s,this.supportsBinary,a=>{try{this.doWrite(s,a)}catch{}i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Bu()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const ol=Lr.WebSocket||Lr.MozWebSocket;class Kp extends Yp{createSocket(t,r,s){return Uu?new ol(t,r,s):r?new ol(t,r):new ol(t)}doWrite(t,r){this.ws.send(r)}}class Xp extends Cc{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=Np(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(r).getReader(),i=Ip();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{s.read().then(({done:l,value:d})=>{l||(this.onPacket(d),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;this._writer.write(s).then(()=>{i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Qp={websocket:Kp,webtransport:Xp,polling:Gp},Jp=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Zp=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tc(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),s=e.indexOf("]");r!=-1&&s!=-1&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));let i=Jp.exec(e||""),a={},o=14;for(;o--;)a[Zp[o]]=i[o]||"";return r!=-1&&s!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=em(a,a.path),a.queryKey=tm(a,a.query),a}function em(e,t){const r=/\/{2,9}/g,s=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function tm(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,a){i&&(r[i]=a)}),r}const rc=typeof addEventListener=="function"&&typeof removeEventListener=="function",za=[];rc&&addEventListener("offline",()=>{za.forEach(e=>e())},!1);class zn extends Dt{constructor(t,r){if(super(),this.binaryType=Rp,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const s=tc(t);r.hostname=s.host,r.secure=s.protocol==="https"||s.protocol==="wss",r.port=s.port,s.query&&(r.query=s.query)}else r.host&&(r.hostname=tc(r.host).host);Mo(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(s=>{const i=s.prototype.name;this.transports.push(i),this._transportsByName[i]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$p(this.opts.query)),rc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},za.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Lu,r.transport=t,this.id&&(r.sid=this.id);const s=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&zn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",zn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(r+=Op(i)),s>0&&r>this._maxPayload)return this.writeBuffer.slice(0,s);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Bo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,s){return this._sendPacket("message",t,r,s),this}send(t,r,s){return this._sendPacket("message",t,r,s),this}_sendPacket(t,r,s,i){if(typeof r=="function"&&(i=r,r=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const a={type:t,data:r,options:s};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},s=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(zn.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),rc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=za.indexOf(this._offlineEventListener);s!==-1&&za.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}zn.protocol=Lu;class rm extends zn{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),s=!1;zn.priorWebsocketSuccess=!1;const i=()=>{s||(r.send([{type:"ping",data:"probe"}]),r.once("packet",x=>{if(!s)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;zn.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function a(){s||(s=!0,h(),r.close(),r=null)}const o=x=>{const u=new Error("probe error: "+x);u.transport=r.name,a(),this.emitReserved("upgradeError",u)};function l(){o("transport closed")}function d(){o("socket closed")}function c(x){r&&x.name!==r.name&&a()}const h=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",l),this.off("close",d),this.off("upgrading",c)};r.once("open",i),r.once("error",o),r.once("close",l),this.once("close",d),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&r.push(t[s]);return r}}let nm=class extends rm{constructor(t,r={}){const s=typeof t=="object"?t:r;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(i=>Qp[i]).filter(i=>!!i)),super(t,s)}};function sm(e,t="",r){let s=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),s=tc(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const a=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+a+":"+s.port+t,s.href=s.protocol+"://"+a+(r&&r.port===s.port?"":":"+s.port),s}const im=typeof ArrayBuffer=="function",am=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,zu=Object.prototype.toString,om=typeof Blob=="function"||typeof Blob<"u"&&zu.call(Blob)==="[object BlobConstructor]",lm=typeof File=="function"||typeof File<"u"&&zu.call(File)==="[object FileConstructor]";function Ac(e){return im&&(e instanceof ArrayBuffer||am(e))||om&&e instanceof Blob||lm&&e instanceof File}function qa(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,s=e.length;r<s;r++)if(qa(e[r]))return!0;return!1}if(Ac(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return qa(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&qa(e[r]))return!0;return!1}function cm(e){const t=[],r=e.data,s=e;return s.data=nc(r,t),s.attachments=t.length,{packet:s,buffers:t}}function nc(e,t){if(!e)return e;if(Ac(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=nc(e[s],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=nc(e[s],t));return r}return e}function dm(e,t){return e.data=sc(e.data,t),delete e.attachments,e}function sc(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=sc(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=sc(e[r],t));return e}const hm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],um=5;var Ye;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Ye||(Ye={}));class fm{constructor(t){this.replacer=t}encode(t){return(t.type===Ye.EVENT||t.type===Ye.ACK)&&qa(t)?this.encodeAsBinary({type:t.type===Ye.EVENT?Ye.BINARY_EVENT:Ye.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===Ye.BINARY_EVENT||t.type===Ye.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=cm(t),s=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(s),i}}function Td(e){return Object.prototype.toString.call(e)==="[object Object]"}class Ic extends Dt{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const s=r.type===Ye.BINARY_EVENT;s||r.type===Ye.BINARY_ACK?(r.type=s?Ye.EVENT:Ye.ACK,this.reconstructor=new xm(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Ac(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const s={type:Number(t.charAt(0))};if(Ye[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Ye.BINARY_EVENT||s.type===Ye.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(a,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););s.nsp=t.substring(a,r)}else s.nsp="/";const i=t.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}s.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Ic.isPayloadValid(s.type,a))s.data=a;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case Ye.CONNECT:return Td(r);case Ye.DISCONNECT:return r===void 0;case Ye.CONNECT_ERROR:return typeof r=="string"||Td(r);case Ye.EVENT:case Ye.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&hm.indexOf(r[0])===-1);case Ye.ACK:case Ye.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class xm{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=dm(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const pm=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ic,Encoder:fm,get PacketType(){return Ye},protocol:um},Symbol.toStringTag,{value:"Module"}));function Wr(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const mm=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class qu extends Dt{constructor(t,r,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Wr(t,"open",this.onopen.bind(this)),Wr(t,"packet",this.onpacket.bind(this)),Wr(t,"error",this.onerror.bind(this)),Wr(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var s,i,a;if(mm.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Ye.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,x=r.pop();this._registerAckCallback(h,x),o.id=h}const l=(i=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(d?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((s,i)=>{const a=(o,l)=>o?i(o):s(l);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ye.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ye.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ye.EVENT:case Ye.BINARY_EVENT:this.onevent(t);break;case Ye.ACK:case Ye.BINARY_ACK:this.onack(t);break;case Ye.DISCONNECT:this.ondisconnect();break;case Ye.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const s of r)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let s=!1;return function(...i){s||(s=!0,r.packet({type:Ye.ACK,id:t,data:i}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ye.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const s of r)s.apply(this,t.data)}}}function Zs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Zs.prototype.reset=function(){this.attempts=0};Zs.prototype.setMin=function(e){this.ms=e};Zs.prototype.setMax=function(e){this.max=e};Zs.prototype.setJitter=function(e){this.jitter=e};class ic extends Dt{constructor(t,r){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Mo(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((s=r.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Zs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const i=r.parser||pm;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new nm(this.uri,this.opts);const r=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=Wr(r,"open",function(){s.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Wr(r,"error",a);if(this._timeout!==!1){const l=this._timeout,d=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Wr(t,"ping",this.onping.bind(this)),Wr(t,"data",this.ondata.bind(this)),Wr(t,"error",this.onerror.bind(this)),Wr(t,"close",this.onclose.bind(this)),Wr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Bo(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new qu(this,t,r),this.nsps[t]=s),s}_destroy(t){const r=Object.keys(this.nsps);for(const s of r)if(this.nsps[s].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let s=0;s<r.length;s++)this.engine.write(r[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},r);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const li={};function Wa(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=sm(e,t.path||"/socket.io"),s=r.source,i=r.id,a=r.path,o=li[i]&&a in li[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let d;return l?d=new ic(s,t):(li[i]||(li[i]=new ic(s,t)),d=li[i]),r.query&&!t.query&&(t.query=r.queryKey),d.socket(r.path,t)}Object.assign(Wa,{Manager:ic,Socket:qu,io:Wa,connect:Wa});const gm=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",an=gm?"https://aakardata.in/api":"http://localhost:5000/api",ym="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class vm{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(t);r?this.init(r,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(r=>{this.triggerEvent("notification",r)})}}init(t,r=!1){var s;if(!((s=this.socket)!=null&&s.connected&&this.lastToken===t&&this.isExhibitor===r)){this.isExhibitor=r,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const i=an.replace("/api",""),a=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Wa(i,{auth:{token:a,type:r?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(i){console.error("Error initializing notification socket:",i),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r)}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(s=>s!==r))}triggerEvent(t,r){this.listeners[t]&&this.listeners[t].forEach(s=>{try{s(r)}catch(i){console.error(`Error in notification ${t} listener:`,i)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",r={limit:1,page:1,unreadOnly:!0},s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const a=await Tr.get(t,{baseURL:an,params:r,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success?(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,r=10,s=!1){try{const i=this.isExhibitor?"notifications/exhibitor":"notifications/admin",a={page:t,limit:r,unreadOnly:s},o=this.isExhibitor?"exhibitor_token":"token",l=localStorage.getItem(o);if(!l)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await Tr.get(i,{baseURL:an,params:a,headers:{Authorization:`Bearer ${l}`}})).data}catch(i){return console.error("Error fetching notifications:",i),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const r=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const a=await Tr.put(r,{},{baseURL:an,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success&&(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),a.data}catch(r){throw console.error("Error marking notification as read:",r),r}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",r=this.isExhibitor?"exhibitor_token":"token",s=localStorage.getItem(r);if(!s)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const i=await Tr.put(t,{},{baseURL:an,headers:{Authorization:`Bearer ${s}`}});return i.data&&i.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),i.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const r=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,s=await Tr.delete(r,{baseURL:an,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(s.data.success)return s.data.data.unreadCount!==void 0&&(this.unreadCount=s.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),s.data;throw new Error("Failed to delete notification")}catch(r){throw console.error("Error deleting notification:",r),r}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",r=await Tr.delete(t,{baseURL:an,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(r.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),r.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const pt=new vm;var Pt=(e=>(e.NEW_LEAD="New Lead",e.FOLLOWUP_DUE="Follow-up Due",e.STATUS_CHANGE="Status Changed",e.ASSIGNMENT="Lead Assigned",e.NEW_BOOKING="NEW_BOOKING",e.BOOKING_CONFIRMED="BOOKING_CONFIRMED",e.BOOKING_CANCELLED="BOOKING_CANCELLED",e.PAYMENT_RECEIVED="PAYMENT_RECEIVED",e.INVOICE_GENERATED="INVOICE_GENERATED",e.EXHIBITION_UPDATE="EXHIBITION_UPDATE",e.SYSTEM_MESSAGE="SYSTEM_MESSAGE",e.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",e.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",e))(Pt||{}),Bn=(e=>(e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW",e))(Bn||{}),ac=(e=>(e.READ="Read",e.UNREAD="Unread",e))(ac||{}),Wu={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(Os,function(){return function(r,s,i){r=r||{};var a=s.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(c,h,x,u){return a.fromToBase(c,h,x,u)}i.en.relativeTime=o,a.fromToBase=function(c,h,x,u,p){for(var g,f,m,v=x.$locale().relativeTime||o,S=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],T=S.length,y=0;y<T;y+=1){var w=S[y];w.d&&(g=u?i(c).diff(x,w.d,!0):x.diff(c,w.d,!0));var k=(r.rounding||Math.round)(Math.abs(g));if(m=g>0,k<=w.r||!w.r){k<=1&&y>0&&(w=S[y-1]);var b=v[w.l];p&&(k=p(""+k)),f=typeof b=="string"?b.replace("%d",k):b(k,h,w.l,m);break}}if(h)return f;var j=m?v.future:v.past;return typeof j=="function"?j(f):j.replace("%s",f)},a.to=function(c,h){return l(c,h,this,!0)},a.from=function(c,h){return l(c,h,this)};var d=function(c){return c.$u?i.utc():i()};a.toNow=function(c){return this.to(d(this),c)},a.fromNow=function(c){return this.from(d(this),c)}}})})(Wu);var bm=Wu.exports;const wm=mx(bm);et.extend(wm);const _d=e=>{switch(e){case Bn.HIGH:return"#f5222d";case Bn.MEDIUM:return"#faad14";case Bn.LOW:return"#52c41a";default:return"#1677ff"}},jm=e=>et(e).fromNow(),Sm=e=>et(e).format("YYYY-MM-DD HH:mm"),Em=e=>e.filter(t=>t.isRead===!1).length,Tm=e=>{if(!e.entityId||!e.entityType)return"/notifications";switch(e.entityType){case"lead":return`/leads/${e.entityId}`;case"followup":return`/followups/${e.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${e.entityId}`;case"Exhibition":return`/exhibition/${e.entityId}`;case"Exhibitor":return`/exhibitors?id=${e.entityId}`;default:return"/notifications"}},{Text:kd,Paragraph:_m}=Le,Hu=({notification:e,onView:t,onMarkAsRead:r,onDelete:s})=>{const i=()=>{switch(e.type){case Pt.NEW_LEAD:return n.jsx(Ni,{style:{color:"#1677ff"}});case Pt.FOLLOWUP_DUE:return n.jsx(Yt,{style:{color:"#faad14"}});case Pt.STATUS_CHANGE:return n.jsx(gx,{style:{color:"#722ed1"}});case Pt.ASSIGNMENT:return n.jsx(at,{style:{color:"#52c41a"}});default:return n.jsx(mc,{style:{color:"#1677ff"}})}},a=()=>{e.isRead||r(e),t(e)},o=l=>{l.stopPropagation(),s(e)};return n.jsx(on.Item,{onClick:a,className:e.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:e.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[n.jsx(ct,{title:"Delete notification",children:n.jsx(ne,{type:"text",danger:!0,icon:n.jsx(or,{}),onClick:o,"aria-label":"Delete notification"})})],children:n.jsx(on.Item.Meta,{avatar:n.jsx(xr,{dot:!e.isRead,color:_d(e.priority),children:n.jsx(Mr,{icon:i(),size:"large",style:{backgroundColor:"white",border:`1px solid ${_d(e.priority)}`}})}),title:n.jsxs(xe,{children:[n.jsx(kd,{strong:!0,children:e.title}),!e.isRead&&n.jsx(Te,{color:"blue",children:"New"})]}),description:n.jsxs("div",{children:[n.jsx(_m,{ellipsis:{rows:2},style:{marginBottom:4},children:e.message}),n.jsx(ct,{title:Sm(e.createdAt),children:n.jsx(kd,{type:"secondary",style:{fontSize:12},children:jm(e.createdAt)})})]})})})},{Title:km,Text:Bk}=Le,Cm=e=>{switch(e){case"NEW_BOOKING":return Pt.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return Pt.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return Pt.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return Pt.NEW_LEAD;default:return Pt.STATUS_CHANGE}},Am=e=>{switch(e){case"HIGH":return Bn.HIGH;case"MEDIUM":return Bn.MEDIUM;case"LOW":return Bn.LOW;default:return Bn.MEDIUM}},Im=({isExhibitor:e=!1})=>{const t=Je(),[r,s]=_.useState([]),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState(0),[h,x]=_.useState(!1),[u,p]=_.useState("all"),g=_.useRef(null),{isAuthenticated:f,user:m}=$e(R=>R.auth),{isAuthenticated:v}=$e(R=>R.exhibitorAuth||{isAuthenticated:!1}),S=e?v:f,[T,y]=_.useState(!1);_.useEffect(()=>{if(S){const R=e?"exhibitor_token":"token",O=localStorage.getItem(R);if(O){pt.init(O,e),pt.subscribeToNotifications();const X=q=>{c(q),q>0&&!o&&(x(!0),setTimeout(()=>{x(!1)},2e3))},re=q=>{s(B=>[q,...B])},ee=()=>{y(!0),w()},D=()=>{y(!1)};return pt.addEventListener("unreadCount",X),pt.addEventListener("notification",re),pt.addEventListener("connected",ee),pt.addEventListener("disconnected",D),w(),()=>{pt.removeEventListener("unreadCount",X),pt.removeEventListener("notification",re),pt.removeEventListener("connected",ee),pt.removeEventListener("disconnected",D),pt.unsubscribeFromNotifications()}}else console.error(`No ${e?"exhibitor":"admin"} token found in localStorage`)}},[S,e]);const w=async()=>{if(S){a(!0);try{const R=await pt.getNotifications(1,10);R.success&&(s(R.data.notifications),c(R.data.unreadCount))}catch(R){console.error("Error fetching notifications:",R)}finally{a(!1)}}},k=R=>{l(R),R&&(g.current&&g.current.classList.remove("bell-animate"),w())},b=async R=>{if(R.isRead||await j(R),l(!1),R.entityId&&R.entityType){let O="";switch(R.entityType){case"Booking":O=e?`/exhibitor/bookings/${R.entityId}`:"/bookings";break;case"Invoice":O=e?`/exhibitor/invoice/${R.entityId}`:`/invoice/${R.entityId}`;break;case"Exhibition":O=`/exhibition/${R.entityId}`;break;case"Exhibitor":O=`/exhibitors?id=${R.entityId}`;break;default:O=""}t(O||"/notifications")}else t("/notifications")},j=async R=>{try{await pt.markAsRead(R._id),s(r.map(O=>O._id===R._id?{...O,isRead:!0}:O))}catch(O){console.error("Error marking notification as read:",O)}},A=async R=>{try{await pt.deleteNotification(R._id),s(r.filter(O=>O._id!==R._id)),R.isRead||c(O=>Math.max(0,O-1))}catch(O){console.error("Error deleting notification:",O)}},E=()=>{l(!1),t("/notifications")},C=async()=>{try{await pt.markAllAsRead(),s(r.map(R=>({...R,isRead:!0}))),c(0)}catch(R){console.error("Error marking all notifications as read:",R)}},I=async()=>{try{await pt.deleteAllNotifications(),s([]),c(0)}catch(R){console.error("Error deleting all notifications:",R)}},F=()=>u==="unread"?r.filter(R=>!R.isRead):r.slice(0,10),N=R=>{p(R)},z=R=>{var O;return{_id:R._id,recipient:R.recipient,recipientType:R.recipientType||"admin",title:R.title,message:R.message,type:Cm(R.type),priority:Am(R.priority),isRead:R.isRead,readAt:R.readAt,entityId:R.entityId,entityType:R.entityType,data:R.data,createdAt:R.createdAt,updatedAt:R.updatedAt||R.createdAt,id:R._id,userId:R.recipient,source:(O=R.data)==null?void 0:O.source,status:R.isRead?ac.READ:ac.UNREAD}},U=n.jsxs("div",{className:"notification-dropdown",children:[n.jsxs("div",{className:"notification-header",children:[n.jsx(km,{level:5,style:{margin:0},children:"Notifications"}),n.jsxs(xe,{children:[n.jsx(ne,{type:"text",size:"small",icon:n.jsx(Xs,{}),onClick:w,loading:i,className:"header-btn",title:"Refresh notifications"}),n.jsx(ne,{type:"text",size:"small",icon:n.jsx(gc,{}),onClick:C,disabled:d===0,className:"header-btn",title:"Mark all as read"}),n.jsx(ne,{type:"text",size:"small",danger:!0,icon:n.jsx(or,{}),onClick:I,disabled:r.length===0,className:"header-btn",title:"Clear all notifications"}),n.jsx(ne,{type:"text",size:"small",icon:n.jsx(Fi,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),n.jsx(ne,{type:"text",size:"small",icon:n.jsx(Qr,{}),onClick:()=>l(!1),className:"header-btn",title:"Close"})]})]}),n.jsx(Kt,{activeKey:u,onChange:N,size:"small",className:"notification-tabs",items:[{key:"all",label:n.jsx("span",{children:"All"})},{key:"unread",label:n.jsxs("span",{className:"tab-label",children:["Unread",n.jsx(xr,{count:d,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),n.jsx("div",{className:"notification-list",children:n.jsx(Jr,{spinning:i,children:F().length===0?n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:u==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):n.jsx(on,{dataSource:F(),renderItem:R=>n.jsx(Hu,{notification:z(R),onView:()=>b(R),onMarkAsRead:()=>j(R),onDelete:A})})})}),n.jsx(nt,{style:{margin:"0"}}),n.jsx("div",{className:"notification-footer",children:n.jsx(ne,{type:"link",onClick:E,children:"View All Notifications"})})]});return n.jsx("div",{ref:g,className:`bell-container ${h?"bell-animate":""}`,children:n.jsx(Vn,{overlay:U,trigger:["click"],open:o,onOpenChange:k,placement:"bottomRight",getPopupContainer:R=>R.parentNode,overlayClassName:"notification-dropdown-overlay",children:n.jsx("div",{className:"bell-trigger",children:n.jsx(xr,{count:d,className:"notification-badge",size:"default",overflowCount:99,children:n.jsx(mc,{className:"notification-bell-icon"})})})})})};class Nm{async getSettings(){return(await _e.get("/settings")).data}async updateSettings(t){return(await _e.put("/settings",t)).data}async uploadLogo(t){const r=new FormData;return r.append("file",t),(await _e.post("/settings/upload/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Nc=new Nm,Fm={settings:null,loading:!1,error:null},bi=Qe("settings/fetchSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Nc.getSettings()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch settings")}}),wi=Qe("settings/updateSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Nc.updateSettings(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to update settings")}}),Ha=Qe("settings/uploadLogo",async(e,{dispatch:t,rejectWithValue:r})=>{var s,i;try{const a=await Nc.uploadLogo(e);return a.path&&await t(wi({logo:a.path})),a}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to upload logo")}}),Rm=gr({name:"settings",initialState:Fm,reducers:{},extraReducers:e=>{e.addCase(bi.pending,t=>{t.loading=!0,t.error=null}).addCase(bi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(bi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(wi.pending,t=>{t.loading=!0,t.error=null}).addCase(wi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(wi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ha.pending,t=>{t.loading=!0,t.error=null}).addCase(Ha.fulfilled,t=>{t.loading=!1}).addCase(Ha.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),Pm=Rm.reducer,Dm=()=>{const{user:e}=$e(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access")||s.includes("manage_all"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,`${a}`,`${o}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Header:Lm,Sider:Om,Content:Bm}=Ct,Mm=we.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,$m=we.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,Um=we.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;we.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const Et=({children:e})=>{const[t,r]=_.useState(!1),s=Je(),i=it(),a=Fn(),o=$e(w=>w.auth.user),{settings:l}=$e(w=>w.settings),[d,c]=_.useState("/logo.png"),[h,x]=_.useState(!1),{hasPermission:u}=Dm(),p=_.useCallback(async()=>{try{x(!0),await i(Ma()).unwrap()}catch{}finally{x(!1)}},[i]);_.useEffect(()=>{const w=setInterval(()=>{p()},3e5);return()=>clearInterval(w)},[p]),_.useEffect(()=>{p()},[a.pathname,p]),_.useEffect(()=>{},[o,u]),_.useEffect(()=>{i(bi())},[i]);const g=[{key:"dashboard",icon:n.jsx(co,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>s("/dashboard")},{key:"exhibition",icon:n.jsx(Ro,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>s("/exhibition")},{key:"stalls",icon:n.jsx(yr,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>s("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>s("/stall-types")}]},{key:"bookings",icon:n.jsx(vt,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>s("/bookings")},{key:"amenities",icon:n.jsx(yx,{}),label:"Amenities",requiredPermission:"view_amenities",onClick:()=>s("/amenities")},{key:"invoices",icon:n.jsx(Cn,{}),label:"Invoices",requiredPermission:"view_invoices",onClick:()=>s("/invoices")},{key:"exhibitors",icon:n.jsx(yc,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>s("/exhibitors")},{key:"index",icon:n.jsx(at,{}),label:"Users",requiredPermission:"users_view",onClick:()=>s("/index")},{key:"roles",icon:n.jsx(vx,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>s("/roles")},{key:"settings",icon:n.jsx(Fi,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>s("/settings")}],f=w=>w.filter(k=>{if(k.requiredPermission&&!u(k.requiredPermission))return!1;if(k.children){const b=f(k.children);if(b.length===0)return!1;k.children=b}return!0}),m=f(g),v=w=>w.map(k=>{const{requiredPermission:b,...j}=k;return j.children&&(j.children=v(j.children)),j}),S=v(m);_.useEffect(()=>{const w={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",amenities:"view_amenities",invoices:"view_invoices",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},k=a.pathname.substring(1)||"dashboard",b=w[k];if(b&&!u(b)){const j=m.length>0?m[0]:null;j?s(`/${j.key}`):(i(bd()),s("/login"))}},[a.pathname,u,m,s,i]),_.useEffect(()=>{const w=localStorage.getItem("cachedLogoUrl"),k=localStorage.getItem("logoTimestamp"),b=new Date().getTime();if(w&&k&&b-parseInt(k)<36e5)c(w);else if(l!=null&&l.logo){const j=`${_e.defaults.baseURL}/public/logo`;c(j),localStorage.setItem("cachedLogoUrl",j),localStorage.setItem("logoTimestamp",b.toString());const A=new Image;A.src=j}},[l]);const T=[{key:"profile",label:"Profile",icon:n.jsx(at,{}),onClick:()=>s("/account")},{key:"settings",label:"Settings",icon:n.jsx(Fi,{}),onClick:()=>s("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(lo,{}),onClick:()=>{i(bd()),s("/login")}}],y=()=>{const w=a.pathname.substring(1);return w.charAt(0).toUpperCase()+w.slice(1)};return n.jsxs(Ct,{style:{minHeight:"100vh"},children:[n.jsxs(Om,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsx(Mm,{children:n.jsx($m,{children:n.jsx(Um,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})}),n.jsx(lr,{mode:"inline",selectedKeys:[a.pathname.substring(1)||"dashboard"],items:S,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Ct,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Lm,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(ne,{type:"text",icon:t?n.jsx(fu,{}):n.jsx(xu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:y()})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("div",{style:{marginRight:20},children:n.jsx(Im,{isExhibitor:!1})}),n.jsx(Vn,{menu:{items:T},placement:"bottomRight",children:n.jsxs(xe,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Mr,{size:"small",icon:n.jsx(at,{}),style:{backgroundColor:"#5046e5"}}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.username)||"User"})]})})]})]}),n.jsx(Bm,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},Cd=localStorage.getItem("exhibitor_token"),zm=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,qm={isAuthenticated:!!Cd,exhibitor:zm,token:Cd,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},Vu=gr({name:"exhibitorAuth",initialState:qm,reducers:{setExhibitorCredentials:(e,t)=>{e.exhibitor=t.payload.exhibitor,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:e=>{e.exhibitor=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(e,t)=>{e.showLoginModal=!0,e.showForgotPasswordModal=!1,e.loginContext=t.payload||null},hideLoginModal:e=>{e.showLoginModal=!1,e.loginContext=null},showForgotPasswordModal:e=>{e.showForgotPasswordModal=!0,e.showLoginModal=!1},hideForgotPasswordModal:e=>{e.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:oc,exhibitorLogout:Gu,showLoginModal:cs,hideLoginModal:da,showForgotPasswordModal:Wm,hideForgotPasswordModal:ll}=Vu.actions,Hm=Vu.reducer,{Header:Vm,Sider:Gm,Content:Ym}=Ct,js=({children:e})=>{var x;const[t,r]=_.useState(!1),s=Je(),i=it(),a=Fn(),o=$e(u=>u.exhibitorAuth.exhibitor),l=()=>{const u=a.pathname;return u.includes("/exhibitor/dashboard")?"dashboard":u.includes("/exhibitor/bookings")?"bookings":u.includes("/exhibitor/profile")?"profile":u.includes("/exhibitions")?"exhibitions":u.includes("/exhibitor/support")?"help":"dashboard"},d=[{key:"dashboard",icon:n.jsx(co,{}),label:"Dashboard",onClick:()=>s("/exhibitor/dashboard")},{key:"bookings",icon:n.jsx(yr,{}),label:"My Bookings",onClick:()=>s("/exhibitor/bookings")},{key:"profile",icon:n.jsx(at,{}),label:"My Profile",onClick:()=>s("/exhibitor/profile")},{key:"exhibitions",icon:n.jsx(Cn,{}),label:"Exhibitions",onClick:()=>s("/exhibitions")},{key:"help",icon:n.jsx(bx,{}),label:"Help & Support",onClick:()=>s("/exhibitor/support")}],c=[{key:"profile",label:"My Profile",icon:n.jsx(at,{}),onClick:()=>s("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:n.jsx(yr,{}),onClick:()=>s("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(lo,{}),onClick:()=>{i(Gu()),s("/")}}],h=()=>{const u=a.pathname.replace("/exhibitor/","");return u==="dashboard"?"Dashboard":u.startsWith("bookings")?u.includes("/")?"Booking Details":"My Bookings":u==="profile"?"My Profile":u==="support"?"Help & Support":u.charAt(0).toUpperCase()+u.slice(1)};return n.jsxs(Ct,{style:{minHeight:"100vh"},children:[n.jsxs(Gm,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[n.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&n.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),n.jsx(lr,{mode:"inline",selectedKeys:[l()],items:d,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Ct,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Vm,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(ne,{type:"text",icon:t?n.jsx(fu,{}):n.jsx(xu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:h()})]}),n.jsx(Vn,{menu:{items:c},placement:"bottomRight",children:n.jsxs(xe,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Mr,{size:"small",style:{backgroundColor:"#5046e5"},children:((x=o==null?void 0:o.companyName)==null?void 0:x.charAt(0).toUpperCase())||"E"}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.companyName)||"Exhibitor"})]})})]}),n.jsx(Ym,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},{Title:Yu,Text:ci,Paragraph:Km}=Le,Ki=Yn`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,Xm=Yn`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,Qm=Yn`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Fc=Yn`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,Ku=Yn`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,Jm=Yn`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,Zm=Yn`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,eg=Yn`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,tg=we.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,rg=we.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${Xm} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,ng=we.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${e=>.1+e.index%3*.05}), transparent);
  left: ${e=>20+e.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${e=>e.isHovered?Jm:Zm} ${e=>1.5+e.index*.2}s ease-out;
  animation-delay: ${e=>e.index*.1}s;
  animation-fill-mode: forwards;
`,sg=we.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${Qm} 0.8s ease-out forwards;
`,ig=we.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,ag=we.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${eg} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Fc} 2s ease-in-out infinite;
  }
`,og=we.span`
  margin-left: 10px;
  animation: ${Ki} 0.5s ease-out;
`,lg=we.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,cg=we.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,dg=we.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${Ki} 0.8s ease-out forwards;
`,hg=we.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,ug=we.img`
  width: 140px;
  height: auto;
  animation: ${Ku} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;we.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const fg=we.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${Ki} 0.8s ease-out forwards;
`,xg=we.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,pg=we(Yu)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,mg=we(Km)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,gg=we.div`
  width: 100%;
  max-width: 400px;
  animation: ${Ki} 0.6s ease-out;
`,yg=we(fe)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,vg=we(fe.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,bg=we(ne)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Fc} 0.5s ease-in-out;
  }
`,wg=we.div`
  margin-bottom: 2rem;
  text-align: center;
`,ha=we(H.Item)`
  margin-bottom: 24px;
`,jg=we.div`
  margin-top: 8px;
`,Sg=we.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,Eg=we(Ql)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,Tg=we.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${Ki} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Fc} 0.5s ease-in-out;
  }
`,Ad=()=>n.jsxs(ig,{children:[n.jsxs(ag,{viewBox:"0 0 50 50",children:[n.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),n.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),n.jsx(og,{children:"Signing in..."})]}),_g=we.div`
  position: absolute;
  width: ${e=>e.size}px;
  height: ${e=>e.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${Ku} ${e=>e.duration}s ease-in-out infinite;
  animation-delay: ${e=>e.delay}s;
  top: ${e=>e.top}%;
  left: ${e=>e.left}%;
  z-index: 1;
`,kg=e=>{if(!e)return 0;const t=e.length>=8,r=/[A-Z]/.test(e),s=/[a-z]/.test(e),i=/\d/.test(e),a=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e),o=[t,r,s,i,a];return o.filter(d=>d).length/o.length*100},Cg=e=>e<30?"#ff4d4f":e<60?"#faad14":e<80?"#1890ff":"#52c41a",Ag=e=>e<30?"Weak":e<60?"Fair":e<80?"Good":"Strong",Ig=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],Ng=()=>{const e=Je(),t=it(),[r,s]=_.useState(null),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState(""),[h,x]=_.useState(!1),u=$e(R=>R.auth.isAuthenticated),p=_.useRef(null),[g,f]=_.useState({x:0,y:0}),[m,v]=_.useState(!1),[S,T]=_.useState(!1),[y]=H.useForm(),[w,k]=_.useState("/logo.png"),[b,j]=_.useState("EXHIBITION MANAGER");_.useEffect(()=>{const R=localStorage.getItem("cachedLogoUrl"),O=localStorage.getItem("logoTimestamp"),X=new Date().getTime();if(R&&O&&X-parseInt(O)<36e5)k(R);else{const re=`${_e.defaults.baseURL}/public/logo`;k(re),localStorage.setItem("cachedLogoUrl",re),localStorage.setItem("logoTimestamp",X.toString());const ee=new Image;ee.src=re}fetch(`${_e.defaults.baseURL}/public/site-info`).then(re=>re.json()).then(re=>{re.siteName&&j(re.siteName)}).catch(re=>{console.error("Error fetching site info:",re)})},[]),_.useEffect(()=>{const R=localStorage.getItem("rememberedUser");if(R)try{const O=JSON.parse(R);y.setFieldsValue({username:O.username,password:O.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[y]),_.useEffect(()=>{const R=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(R)},[]),_.useEffect(()=>{u&&e("/dashboard")},[u,e]),_.useEffect(()=>{const R=O=>{if(p.current){const X=p.current.getBoundingClientRect(),re=O.clientX-X.left,ee=O.clientY-X.top;re>=0&&re<=X.width&&ee>=0&&ee<=X.height&&f({x:re,y:ee})}};return window.addEventListener("mousemove",R),()=>{window.removeEventListener("mousemove",R)}},[]);const A=async R=>{var O;try{s(null),a(!0);const X=await po.login({username:R.username,password:R.password}),{user:re,token:ee}=X.data;if(!re||!ee)throw new Error("Invalid response from server");R.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:R.username,password:R.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),l(!0),setTimeout(()=>{t(Iu({user:re,token:ee})),je.success("Login successful!"),e("/dashboard")},1200)}catch(X){console.error("Login Error:",X),console.error("Response Data:",(O=X.response)==null?void 0:O.data);let re="Authentication Error",ee="Invalid username or password.";if(X.response&&typeof X.response=="object"){const{status:D,data:q}=X.response;D===401?(re="Invalid Credentials",ee="The username or password you entered is incorrect."):D===403?(re="Access Denied",ee="You do not have permission to access this resource."):D===400?(re="Invalid Request",ee="Please check your input and try again."):D===500&&(re="Server Error",ee="A server error occurred. Please try again later."),q&&typeof q=="object"&&q.message&&(ee=q.message)}else X.request?(re="Connection Error",ee="Unable to connect to the server. Please check your internet connection."):X.message&&(ee=X.message);s({title:re,message:ee})}finally{a(!1)}},E=kg(d),C=Cg(E),I=Ag(E),F=localStorage.getItem("rememberUser")==="true";if(u)return n.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[n.jsx(Ad,{}),n.jsx(ci,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const N=R=>{const O=[];for(let X=0;X<R;X++){const re=Math.random()*20+8,ee=Math.random()*3,D=Math.random()*10+6,q=Math.random()*100,B=Math.random()*100;O.push(n.jsx(_g,{size:re,delay:ee,duration:D,top:q,left:B,style:{transform:`translate(${g.x/50*(X%5-2)}px, ${g.y/50*(X%5-2)}px)`,opacity:S?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},X))}return O},z=R=>{const O=[];for(let X=0;X<R;X++)O.push(n.jsx(ng,{index:X,isHovered:S},X));return O},U=R=>{T(R)};return n.jsxs(tg,{style:{opacity:m?1:0,transition:"opacity 0.3s ease-out"},children:[o&&n.jsx(Tg,{children:n.jsx(vc,{})}),n.jsxs(rg,{onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[n.jsx(dg,{children:n.jsx(hg,{children:n.jsx(ug,{src:w,alt:"Exhibition Manager Logo",onError:()=>k("/logo.png")})})}),n.jsxs(lg,{ref:p,children:[N(12),z(8)]}),n.jsxs(cg,{children:[n.jsx(fg,{children:n.jsx(xg,{children:b})}),n.jsx(pg,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),n.jsx(mg,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),n.jsx(sg,{children:n.jsxs(gg,{children:[n.jsxs(wg,{children:[n.jsx(Yu,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),n.jsx(ci,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),r&&n.jsx(kt,{message:r.title,description:r.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:n.jsx(ne,{size:"small",type:"text",onClick:()=>s(null),children:"Dismiss"})}),n.jsxs(H,{form:y,name:"login",initialValues:{remember:F},onFinish:A,layout:"vertical",children:[n.jsx(ha,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:n.jsx(yg,{prefix:n.jsx(at,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:i,autoComplete:"username"})}),n.jsx(ha,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:h&&n.jsxs(jg,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[n.jsx(ci,{type:"secondary",children:"Password Strength:"}),n.jsx(ci,{strong:!0,style:{color:C},children:I})]}),n.jsx(Kr,{percent:E,showInfo:!1,strokeColor:C,size:"small"}),n.jsx("div",{style:{marginTop:"8px"},children:n.jsx(ct,{title:n.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Ig.map((R,O)=>n.jsx("li",{children:R},O))}),children:n.jsxs(ci,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx(Zr,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:n.jsx(vg,{prefix:n.jsx(En,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:i,autoComplete:"current-password",onChange:R=>c(R.target.value),onFocus:()=>x(!0),onBlur:()=>x(!1)})}),n.jsx(Sg,{children:n.jsx(ha,{name:"remember",valuePropName:"checked",noStyle:!0,children:n.jsx(Eg,{children:"Remember me"})})}),n.jsx(ha,{children:i?n.jsx(Ad,{}):n.jsx(bg,{type:"primary",htmlType:"submit",block:!0,className:o?"success":"",children:"Sign in"})})]})]})})]})},Xu={getDashboardStats:async()=>{var e;try{const r=(await _e.get("/users")).data||[],s=await _e.get("/bookings"),i=((e=s.data)==null?void 0:e.data)||s.data||[],o=(await _e.get("/exhibitions")).data||[],l=i.filter(h=>h.status==="confirmed"||h.status==="approved").reduce((h,x)=>h+(x.amount||0),0),d=[...i].sort((h,x)=>new Date(x.createdAt).getTime()-new Date(h.createdAt).getTime()).slice(0,5),c=[...r].sort((h,x)=>new Date(x.createdAt||0).getTime()-new Date(h.createdAt||0).getTime()).slice(0,5);return{userCount:r.length,bookingCount:i.length,totalRevenue:l,exhibitionCount:o.length,recentBookings:d,recentUsers:c}}catch(t){return console.error("Error fetching dashboard stats:",t),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:e,recentUsers:t}=await Xu.getDashboardStats();return[...e.map(s=>({id:s._id,type:"booking",title:`New booking ${s._id.substring(0,8)}`,timestamp:s.createdAt,data:s})),...t.map(s=>({id:s._id,type:"user",title:`User ${s.username||"unknown"}`,timestamp:s.createdAt,data:s}))].sort((s,i)=>new Date(i.timestamp).getTime()-new Date(s.timestamp).getTime())}catch(e){return console.error("Error fetching recent activities:",e),[]}}},{Title:Fg,Text:ir}=Le,Rg=({title:e,value:t,icon:r,color:s,gradient:i,loading:a})=>n.jsxs(ue,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:i,border:"none",overflow:"hidden",position:"relative"},children:[n.jsx("div",{className:"stat-card-background"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[n.jsx(ir,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:e}),n.jsx(ir,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:a?n.jsx(Jr,{size:"small"}):t})]}),n.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:r})]})]}),Pg=()=>{const[e,t]=_.useState(!0),[r,s]=_.useState(0),[i,a]=_.useState(0),[o,l]=_.useState(0),[d,c]=_.useState(0),[h,x]=_.useState([]),[u,p]=_.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});_.useEffect(()=>{(async()=>{t(!0);try{const m=await Xu.getDashboardStats();s(m.userCount),a(m.bookingCount),l(m.totalRevenue),c(m.exhibitionCount);const v=[];m.recentBookings.slice(0,3).forEach(S=>{v.push({id:S._id,icon:n.jsx(ho,{}),color:"#2563EB",text:n.jsxs(ir,{children:["New booking ",n.jsxs(ir,{strong:!0,children:["#",S._id.substring(0,8)]})," received"]}),timestamp:new Date(S.createdAt).toLocaleString()})}),m.recentUsers.slice(0,2).forEach(S=>{v.push({id:S._id,icon:n.jsx(at,{}),color:"#7C3AED",text:n.jsxs(ir,{children:["User ",n.jsxs(ir,{strong:!0,children:["'",S.username,"'"]})," ",S.createdAt?"registered":"active"]}),timestamp:S.createdAt?new Date(S.createdAt).toLocaleString():"Recently"})}),v.sort((S,T)=>new Date(T.timestamp).getTime()-new Date(S.timestamp).getTime()),x(v)}catch(m){console.error("Error fetching dashboard data:",m)}finally{t(!1)}})()},[]);const g=[{title:"Total Users",value:r,icon:n.jsx(at,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:i,icon:n.jsx(ho,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`${o.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:n.jsx(uo,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:d,icon:n.jsx(wx,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx(Fg,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),n.jsx(Ae,{gutter:[24,24],children:g.map((f,m)=>n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsx(Rg,{...f,loading:e})},m))}),n.jsxs(Ae,{gutter:[24,24],style:{marginTop:"24px"},children:[n.jsx(Q,{xs:24,lg:12,children:n.jsx(ue,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:e,children:h.length>0?n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:h.map(f=>n.jsxs("div",{className:"activity-item",children:[xt.cloneElement(f.icon,{style:{color:f.color}}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[f.text,n.jsx(ir,{type:"secondary",style:{fontSize:"12px"},children:f.timestamp})]})]},f.id))}):n.jsx(ir,{type:"secondary",children:"No recent activity found"})})}),n.jsx(Q,{xs:24,lg:12,children:n.jsx(ue,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator online"}),n.jsxs(ir,{children:["Server Status: ",n.jsx(ir,{strong:!0,type:"success",children:u.server})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator connected"}),n.jsxs(ir,{children:["Database Status: ",n.jsx(ir,{strong:!0,type:"success",children:u.database})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator backup"}),n.jsxs(ir,{children:["Last Backup: ",n.jsx(ir,{strong:!0,children:u.lastBackup})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator normal"}),n.jsxs(ir,{children:["System Load: ",n.jsx(ir,{strong:!0,children:u.systemLoad})]})]})]})})})]})]})},Ar={getExhibitions:()=>Qn.get("/public/exhibitions"),getExhibition:e=>Qn.get(`/public/exhibitions/${e}`),getLayout:e=>Qn.get(`/public/exhibitions/${e}/layout`),getStallDetails:(e,t)=>Qn.get(`/public/exhibitions/${e}/stalls/${t}`),bookStall:(e,t,r)=>Qn.post(`/public/exhibitions/${e}/stalls/${t}/book`,r),bookMultipleStalls:(e,t)=>Qn.post(`/public/exhibitions/${e}/stalls/book-multiple`,t),searchExhibitors:e=>Qn.get("/public/exhibitors/search",{params:{query:e}}),exhibitorBookStalls:e=>_e.post(`/exhibitor-bookings/${e.exhibitionId}`,e),getExhibitorBookings:()=>_e.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:e=>_e.get(`/exhibitor-bookings/${e}`),cancelExhibitorBooking:e=>_e.patch(`/exhibitor-bookings/${e}/cancel`),getExhibitorBookingInvoice:e=>_e.get(`/exhibitor-bookings/${e}/invoice`)},{Title:Dg,Text:yn,Paragraph:Mk}=Le,Lg=()=>{const[e,t]=_.useState([]),[r,s]=_.useState(!0),[i,a]=_.useState(null),[o,l]=_.useState([]),[d,c]=_.useState(!0),h=$e(y=>y.exhibitorAuth.exhibitor),x=Je();_.useEffect(()=>{u(),p()},[]);const u=async()=>{try{s(!0),a(null);const y=await Ar.getExhibitorBookings();t(y.data||[])}catch(y){console.error("Failed to fetch bookings:",y),a("Unable to load your bookings at this time. Please try again later.")}finally{s(!1)}},p=async()=>{try{c(!0);const y=await Ar.getExhibitions(),w=et(),k=(y.data||[]).filter(b=>b.isActive&&et(b.endDate).isAfter(w)).slice(0,3);l(k)}catch(y){console.error("Failed to fetch upcoming exhibitions:",y)}finally{c(!1)}},g=e.filter(y=>y.status==="approved").length,f=e.filter(y=>y.status==="pending").length;e.filter(y=>y.status==="rejected").length;const m=e.filter(y=>y.status==="confirmed").length,v=y=>{switch(y){case"approved":return n.jsxs(Te,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Te,{color:"warning",children:[n.jsx(Yt,{})," Pending"]});case"rejected":return n.jsxs(Te,{color:"error",children:[n.jsx(Qr,{})," Rejected"]});case"confirmed":return n.jsxs(Te,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsxs(Te,{color:"default",children:[n.jsx(Qr,{})," Cancelled"]});default:return n.jsx(Te,{children:"Unknown"})}},S=y=>{x(`/exhibitor/invoice/${y}`)},T=(y,w)=>y.status===w;return n.jsxs("div",{children:[n.jsxs(Dg,{level:2,children:["Welcome, ",(h==null?void 0:h.companyName)||"Exhibitor"]}),n.jsx(yn,{type:"secondary",children:"Here's an overview of your exhibition activities"}),i&&n.jsx(kt,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),f>0&&n.jsx(kt,{message:"Pending Approvals",description:`You have ${f} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(ne,{size:"small",type:"primary",onClick:()=>x("/exhibitor/bookings"),children:"View Bookings"})}),n.jsxs(Ae,{gutter:[24,24],style:{marginTop:24},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Total Bookings",value:r?"-":e.length,prefix:n.jsx(yr,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Confirmed",value:r?"-":m,valueStyle:{color:"#1890ff"},prefix:n.jsx(vt,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Approved",value:r?"-":g,valueStyle:{color:"#3f8600"},prefix:n.jsx(vt,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Pending",value:r?"-":f,valueStyle:{color:"#faad14"},prefix:n.jsx(Yt,{}),loading:r})})})]}),n.jsx(ue,{title:"Recent Bookings",extra:n.jsx(Cr,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:r,children:r?n.jsx(ln,{active:!0,paragraph:{rows:3}}):e.length>0?n.jsx(on,{dataSource:e.slice(0,5),renderItem:y=>{var w,k,b,j,A;return n.jsxs(on.Item,{actions:[n.jsx(ne,{type:"link",onClick:()=>x(`/exhibitor/bookings/${y._id}`),children:"View Details"},"view"),T(y,"approved")||T(y,"confirmed")?n.jsx(ne,{type:"link",icon:n.jsx(pu,{}),onClick:()=>S(y._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[n.jsx(on.Item.Meta,{title:n.jsxs("div",{children:[n.jsx(yn,{strong:!0,children:((w=y.exhibitionId)==null?void 0:w.name)||"Exhibition"}),n.jsxs(yn,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((k=y.stallIds)==null?void 0:k.map(E=>E.number).join(", "))||"N/A"]})]}),description:n.jsxs(xe,{direction:"vertical",size:1,children:[n.jsxs("div",{children:[n.jsxs(yn,{children:["Booked on: ",et(y.createdAt).format("MMM D, YYYY")]}),n.jsx(nt,{type:"vertical"}),n.jsxs(yn,{children:["Amount: ",((b=y.amount)==null?void 0:b.toLocaleString())||"N/A"]})]}),n.jsx("div",{children:n.jsxs(yn,{children:["Exhibition date: ",et((j=y.exhibitionId)==null?void 0:j.startDate).format("MMM D")," - ",et((A=y.exhibitionId)==null?void 0:A.endDate).format("MMM D, YYYY")]})})]})}),v(y.status)]})}}):n.jsx(mt,{description:"No bookings found",image:mt.PRESENTED_IMAGE_SIMPLE})}),n.jsx(ue,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:d,extra:n.jsx(Cr,{to:"/exhibitions",children:"View All"}),children:d?n.jsx(ln,{active:!0,paragraph:{rows:3}}):o.length>0?n.jsx(on,{dataSource:o,renderItem:y=>n.jsx(on.Item,{actions:[n.jsx(ne,{type:"primary",onClick:()=>x(`/exhibitions/${y._id}/layout`),children:"Book Stall"},"book")],children:n.jsx(on.Item.Meta,{title:y.name,description:n.jsxs(xe,{direction:"vertical",size:1,children:[n.jsx(yn,{children:y.venue}),n.jsxs(yn,{type:"secondary",children:[et(y.startDate).format("MMM D")," - ",et(y.endDate).format("MMM D, YYYY")]})]})})})}):n.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[n.jsx(Cn,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),n.jsxs("div",{children:[n.jsx(yn,{children:"No upcoming exhibitions at the moment"}),n.jsx("div",{style:{marginTop:16},children:n.jsx(Cr,{to:"/exhibitions",children:n.jsx(ne,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),n.jsx(Ae,{gutter:[24,24],style:{marginTop:24},children:n.jsx(Q,{span:24,children:n.jsx(ue,{title:"Quick Actions",children:n.jsxs(Ae,{gutter:[16,16],children:[n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(ne,{type:"primary",icon:n.jsx(yr,{}),block:!0,onClick:()=>x("/exhibitions"),children:"Book New Stall"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(ne,{icon:n.jsx(Cn,{}),block:!0,onClick:()=>x("/exhibitor/bookings"),children:"View All Bookings"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(ne,{icon:n.jsx(uo,{}),block:!0,onClick:()=>x("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(ne,{icon:n.jsx(at,{}),block:!0,onClick:()=>x("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},{Title:Og,Text:Dn}=Le,{Option:$k}=Pe,{TabPane:Ss}=Kt,{confirm:Bg}=Ve,{Search:Mg}=fe,$g=()=>{const[e,t]=_.useState([]),[r,s]=_.useState(!0),[i,a]=_.useState(null),[o,l]=_.useState(""),[d,c]=_.useState("all"),h=Je(),x=Fn();_.useEffect(()=>{u()},[]),_.useEffect(()=>{const C=new URLSearchParams(x.search).get("status");C&&c(C)},[x]);const u=async()=>{try{s(!0),a(null);const E=await Ar.getExhibitorBookings();t(E.data||[])}catch(E){console.error("Error fetching bookings:",E),a("Failed to load bookings. Please try again.")}finally{s(!1)}},p=E=>{Bg({title:"Are you sure you want to cancel this booking?",icon:n.jsx(Qs,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await Ar.cancelExhibitorBooking(E),je.success("Booking cancelled successfully"),u()}catch(C){console.error("Error cancelling booking:",C),je.error("Failed to cancel booking")}}})},g=E=>{switch(E){case"approved":return n.jsxs(Te,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Te,{color:"warning",children:[n.jsx(Yt,{})," Pending"]});case"rejected":return n.jsxs(Te,{color:"error",children:[n.jsx(Qr,{})," Rejected"]});case"confirmed":return n.jsxs(Te,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsxs(Te,{color:"default",children:[n.jsx(Qr,{})," Cancelled"]});default:return n.jsx(Te,{children:"Unknown"})}},f=E=>{switch(E){case"paid":return n.jsxs(Te,{color:"success",children:[n.jsx(uo,{})," Paid"]});case"pending":return n.jsxs(Te,{color:"warning",children:[n.jsx(Yt,{})," Pending"]});case"refunded":return n.jsxs(Te,{color:"default",children:[n.jsx(uo,{})," Refunded"]});default:return n.jsx(Te,{children:"Unknown"})}},m=async E=>{try{h(`/exhibitor/invoice/${E}`)}catch(C){console.error("Error navigating to invoice:",C),je.error("Failed to access invoice. Please try again.")}},v=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(E,C)=>{var I,F;return n.jsxs(xe,{direction:"vertical",size:0,children:[n.jsx(Dn,{strong:!0,children:((I=C.exhibitionId)==null?void 0:I.name)||"N/A"}),n.jsx(Dn,{type:"secondary",style:{fontSize:"12px"},children:((F=C.exhibitionId)==null?void 0:F.venue)||"N/A"})]})},sorter:(E,C)=>{var I,F;return(((I=E.exhibitionId)==null?void 0:I.name)||"").localeCompare(((F=C.exhibitionId)==null?void 0:F.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:E=>n.jsx(xe,{direction:"vertical",size:4,children:(E==null?void 0:E.map(C=>n.jsx(Te,{children:C.number},C._id)))||"N/A"})},{title:"Type",key:"stallType",render:(E,C)=>{var I;return n.jsx(xe,{direction:"vertical",size:4,children:((I=C.stallIds)==null?void 0:I.map(F=>{var N;return(N=F.stallTypeId)!=null&&N.name?n.jsx(Te,{color:"blue",children:F.stallTypeId.name},F._id):n.jsx(Dn,{type:"secondary",children:"N/A"},F._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(E,C)=>{var I;return n.jsx(xe,{direction:"vertical",size:4,children:((I=C.stallIds)==null?void 0:I.map(F=>n.jsxs(Dn,{children:[F.dimensions.width,"m x ",F.dimensions.height,"m"]},F._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(E,C)=>{var I,F;return n.jsxs(xe,{direction:"vertical",size:0,children:[n.jsxs(Dn,{children:[n.jsx(Vr,{style:{marginRight:4}}),et((I=C.exhibitionId)==null?void 0:I.startDate).format("MMM D")," - ",et((F=C.exhibitionId)==null?void 0:F.endDate).format("MMM D, YYYY")]}),n.jsxs(Dn,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",et(C.createdAt).format("MMM D, YYYY")]})]})},sorter:(E,C)=>et(E.createdAt).unix()-et(C.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:E=>n.jsxs(Dn,{strong:!0,children:["",E.toLocaleString()]}),sorter:(E,C)=>E.amount-C.amount},{title:"Status",key:"status",dataIndex:"status",render:(E,C)=>E==="rejected"&&C.rejectionReason?n.jsxs(ct,{title:C.rejectionReason,children:[g(E),n.jsx(Zr,{style:{marginLeft:4,color:"#ff4d4f"}})]}):g(E),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(E,C)=>C.status===E},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:E=>f(E),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(E,C)=>C.paymentStatus===E},{title:"Actions",key:"actions",render:(E,C)=>n.jsxs(xe,{children:[n.jsx(ne,{type:"link",icon:n.jsx(hn,{}),onClick:()=>h(`/exhibitor/bookings/${C._id}`),children:"Details"}),(C.status==="approved"||C.status==="confirmed")&&n.jsx(ne,{type:"link",icon:n.jsx(pu,{}),onClick:()=>m(C._id),children:"Invoice"}),C.status==="pending"&&n.jsx(ne,{type:"link",danger:!0,onClick:()=>p(C._id),children:"Cancel"})]})}],S=E=>{l(E)},T=e.filter(E=>{var F,N;const C=(((F=E.exhibitionId)==null?void 0:F.name)||"").toLowerCase().includes(o.toLowerCase())||E.stallIds.some(z=>z.number.toLowerCase().includes(o.toLowerCase()))||(((N=E.exhibitionId)==null?void 0:N.venue)||"").toLowerCase().includes(o.toLowerCase())||(E.customerName||"").toLowerCase().includes(o.toLowerCase()),I=d==="all"||E.status===d;return C&&I}),y=()=>e.length,w=()=>e.filter(E=>E.status==="pending").length,k=()=>e.filter(E=>E.status==="approved").length,b=()=>e.filter(E=>E.status==="confirmed").length,j=()=>e.filter(E=>E.status==="rejected").length,A=()=>e.filter(E=>E.status==="cancelled").length;return n.jsxs("div",{children:[n.jsx(Og,{level:2,children:"My Bookings"}),n.jsx(Dn,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),i&&n.jsx(kt,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(ne,{type:"primary",onClick:u,children:"Retry"})}),n.jsxs(ue,{style:{marginTop:24},children:[n.jsxs(Ae,{gutter:[16,16],style:{marginBottom:16},children:[n.jsx(Q,{flex:"auto",children:n.jsx(Mg,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:S,onChange:E=>l(E.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),n.jsx(Q,{children:n.jsx(ne,{icon:n.jsx(Xs,{}),onClick:u,children:"Refresh"})})]}),n.jsxs(Kt,{defaultActiveKey:d,onChange:E=>c(E),children:[n.jsx(Ss,{tab:`All Bookings (${y()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):T.length>0?n.jsx(tt,{columns:v,dataSource:T,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):n.jsx(mt,{description:o?"No bookings match your search criteria":"No bookings found",image:mt.PRESENTED_IMAGE_SIMPLE})},"all"),n.jsx(Ss,{tab:`Pending (${w()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(E=>E.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),n.jsx(Ss,{tab:`Approved (${k()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(E=>E.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),n.jsx(Ss,{tab:`Confirmed (${b()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(E=>E.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),n.jsx(Ss,{tab:`Rejected (${j()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(E=>E.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),n.jsx(Ss,{tab:`Cancelled (${A()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(E=>E.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:Id,Text:cl}=Le,Ug=()=>{var x,u,p,g,f,m,v,S,T,y,w,k,b;const{id:e}=Fr(),t=Je(),[r,s]=_.useState(null),[i,a]=_.useState(!0);_.useEffect(()=>{o()},[e]);const o=async()=>{try{a(!0);const j=await Ar.getExhibitorBooking(e||"");s(j.data)}catch(j){console.error("Error fetching booking details:",j),je.error("Failed to load booking details")}finally{a(!1)}},l=async()=>{try{t(`/exhibitor/invoice/${e}`)}catch(j){console.error("Error fetching invoice:",j),je.error("Failed to retrieve invoice")}},d=j=>{switch(j){case"approved":return n.jsxs(Te,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Te,{color:"warning",children:[n.jsx(Yt,{})," Pending"]});case"rejected":return n.jsx(Te,{color:"error",children:"Rejected"});case"confirmed":return n.jsxs(Te,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsx(Te,{color:"default",children:"Cancelled"});default:return n.jsx(Te,{children:"Unknown"})}},c=j=>{switch(j){case"paid":return n.jsx(Te,{color:"success",children:"Paid"});case"pending":return n.jsx(Te,{color:"warning",children:"Pending"});case"refunded":return n.jsx(Te,{color:"default",children:"Refunded"});default:return n.jsx(Te,{children:"Unknown"})}},h=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:j=>`${j.dimensions.width}m  ${j.dimensions.height}m`},{title:"Size",key:"size",render:j=>`${j.dimensions.width*j.dimensions.height} m`},{title:"Rate per m",dataIndex:"ratePerSqm",key:"ratePerSqm",render:j=>`${j.toLocaleString()}`},{title:"Amount",key:"amount",render:(j,A,E)=>{var I;const C=(I=r.calculations)==null?void 0:I.stalls[E];return C?`${C.baseAmount.toLocaleString()}`:"N/A"}}];return i?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:n.jsx(Jr,{size:"large"})}):r?n.jsxs("div",{style:{padding:"20px"},children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(r.status)&&n.jsx(ne,{type:"primary",icon:n.jsx(Cn,{}),onClick:l,children:"View Invoice"})]}),n.jsxs(ue,{title:"Booking Details",style:{marginBottom:20},children:[n.jsxs(We,{bordered:!0,column:{xs:1,sm:2,md:3},children:[n.jsx(We.Item,{label:"Booking ID",children:r._id}),n.jsx(We.Item,{label:"Exhibition",children:((x=r.exhibitionId)==null?void 0:x.name)||"N/A"}),n.jsx(We.Item,{label:"Venue",children:((u=r.exhibitionId)==null?void 0:u.venue)||"N/A"}),n.jsx(We.Item,{label:"Booking Date",children:et(r.createdAt).format("MMM D, YYYY")}),n.jsxs(We.Item,{label:"Exhibition Dates",children:[et((p=r.exhibitionId)==null?void 0:p.startDate).format("MMM D, YYYY")," -",et((g=r.exhibitionId)==null?void 0:g.endDate).format("MMM D, YYYY")]}),n.jsx(We.Item,{label:"Status",children:d(r.status)}),n.jsx(We.Item,{label:"Payment Status",children:c(r.paymentStatus||"pending")}),n.jsxs(We.Item,{label:"Total Amount",children:["",((f=r.amount)==null?void 0:f.toLocaleString())||"N/A"]})]}),r.rejectionReason&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Id,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),n.jsx(cl,{children:r.rejectionReason})]})]}),n.jsx(ue,{title:"Stall Details",style:{marginBottom:20},children:n.jsx(tt,{dataSource:r.stallIds||[],columns:h,rowKey:"_id",pagination:!1})}),n.jsx(ue,{title:"Calculation Summary",children:n.jsx(Ae,{gutter:[16,16],children:n.jsx(Q,{span:24,children:n.jsxs(We,{bordered:!0,column:1,children:[n.jsxs(We.Item,{label:"Base Amount",children:["",((m=r.calculations)==null?void 0:m.totalBaseAmount.toLocaleString())||"N/A"]}),((v=r.calculations)==null?void 0:v.totalDiscountAmount)>0&&n.jsxs(We.Item,{label:"Discount",children:["- ",((S=r.calculations)==null?void 0:S.totalDiscountAmount.toLocaleString())||"N/A"]}),((T=r.calculations)==null?void 0:T.totalDiscountAmount)>0&&n.jsxs(We.Item,{label:"Amount After Discount",children:["",((y=r.calculations)==null?void 0:y.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(k=(w=r.calculations)==null?void 0:w.taxes)==null?void 0:k.map(j=>n.jsxs(We.Item,{label:`${j.name} (${j.rate}%)`,children:["+ ",j.amount.toLocaleString()||"N/A"]},j.name)),n.jsx(We.Item,{label:"Total Amount",children:n.jsxs(cl,{strong:!0,style:{fontSize:"16px"},children:["",((b=r.amount)==null?void 0:b.toLocaleString())||"N/A"]})})]})})})}),n.jsx(ue,{title:"Customer Information",style:{marginTop:20},children:n.jsxs(We,{bordered:!0,column:{xs:1,sm:2},children:[n.jsx(We.Item,{label:"Company Name",children:r.companyName}),n.jsx(We.Item,{label:"Contact Person",children:r.customerName}),n.jsx(We.Item,{label:"Email",children:r.customerEmail}),n.jsx(We.Item,{label:"Phone",children:r.customerPhone})]})})]}):n.jsx(ue,{children:n.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[n.jsx(Id,{level:3,children:"Booking Not Found"}),n.jsx(cl,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),n.jsx("div",{style:{marginTop:20},children:n.jsx(ne,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},lc=Tr.create({baseURL:an}),Es=Tr.create({baseURL:an});lc.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const ts=Tr.create({baseURL:an});ts.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const ar={sendRegistrationOTP:async e=>await Es.post("/exhibitors/send-otp",{email:e}),verifyOTP:async e=>await Es.post("/exhibitors/verify-otp",e),register:async e=>await Es.post("/exhibitors/register",e),login:async e=>await Es.post("/exhibitors/login",e),requestPasswordReset:async e=>await Es.post("/exhibitors/forgot-password",e),resetPassword:async e=>await Es.post("/exhibitors/reset-password",e),getProfile:async()=>await lc.get("/exhibitors/profile"),updateProfile:async e=>await lc.put("/exhibitors/profile",e),getExhibitors:async()=>await ts.get("/exhibitors/admin/exhibitors"),getExhibitor:async e=>await ts.get(`/exhibitors/admin/exhibitors/${e}`),createExhibitor:async e=>await ts.post("/exhibitors/admin/exhibitors",e),updateStatus:async(e,t,r)=>await ts.put(`/exhibitors/admin/exhibitors/${e}/status`,{status:t,rejectionReason:r}),updateExhibitor:async(e,t)=>await ts.put(`/exhibitors/admin/exhibitors/${e}`,t),deleteExhibitor:async e=>await ts.delete(`/exhibitors/admin/exhibitors/${e}`)},{Title:Nd,Text:Fd}=Le,{TabPane:Rd}=Kt,zg=()=>{var d;const[e]=H.useForm(),[t,r]=_.useState(!1),[s,i]=_.useState(!1),a=it(),o=$e(c=>c.exhibitorAuth.exhibitor);_.useEffect(()=>{(async()=>{try{i(!0);const h=await ar.getProfile();h.data&&a(oc({exhibitor:h.data,token:(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||""}))}catch{je.error("Failed to fetch exhibitor profile")}finally{i(!1)}})()},[a]),_.useEffect(()=>{o&&e.setFieldsValue({companyName:o.companyName||"",contactPerson:o.contactPerson||"",email:o.email||"",phone:o.phone||"",address:o.address||"",website:o.website||"",description:o.description||"",panNumber:o.panNumber||"",gstNumber:o.gstNumber||"",city:o.city||"",state:o.state||"",pinCode:o.pinCode||""})},[o,e]);const l=async c=>{try{r(!0);const h=await ar.updateProfile(c),x=(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||"";a(oc({exhibitor:{...o,...c},token:x})),je.success("Profile updated successfully")}catch{je.error("Failed to update profile")}finally{r(!1)}};return n.jsxs("div",{children:[n.jsx(Nd,{level:2,children:"My Profile"}),n.jsx(Fd,{type:"secondary",children:"Manage your exhibitor profile information"}),n.jsx(ue,{style:{marginTop:24},loading:s,children:n.jsxs(Kt,{defaultActiveKey:"profile",children:[n.jsx(Rd,{tab:"Profile Information",children:n.jsxs(Ae,{gutter:32,children:[n.jsx(Q,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Mr,{size:100,icon:n.jsx(at,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((d=o==null?void 0:o.companyName)==null?void 0:d.charAt(0).toUpperCase())||"E"}),n.jsx(Nd,{level:4,children:o==null?void 0:o.companyName}),n.jsx(Fd,{type:"secondary",children:o==null?void 0:o.email})]})}),n.jsx(Q,{span:18,children:n.jsxs(H,{form:e,layout:"vertical",onFinish:l,initialValues:{companyName:(o==null?void 0:o.companyName)||"",contactPerson:(o==null?void 0:o.contactPerson)||"",email:(o==null?void 0:o.email)||"",phone:(o==null?void 0:o.phone)||"",address:(o==null?void 0:o.address)||"",website:(o==null?void 0:o.website)||"",description:(o==null?void 0:o.description)||"",panNumber:(o==null?void 0:o.panNumber)||"",gstNumber:(o==null?void 0:o.gstNumber)||"",city:(o==null?void 0:o.city)||"",state:(o==null?void 0:o.state)||"",pinCode:(o==null?void 0:o.pinCode)||""},children:[n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:n.jsx(fe,{prefix:n.jsx(bc,{}),placeholder:"Company Name"})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:n.jsx(fe,{prefix:n.jsx(at,{}),placeholder:"Contact Person"})})})]}),n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{prefix:n.jsx(fn,{}),placeholder:"Email",disabled:!0})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:n.jsx(fe,{prefix:n.jsx(wc,{}),placeholder:"Phone Number"})})})]}),n.jsx(H.Item,{name:"address",label:"Address",children:n.jsx(fe.TextArea,{rows:2,placeholder:"Company Address"})}),n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:8,children:n.jsx(H.Item,{name:"city",label:"City",children:n.jsx(fe,{placeholder:"City"})})}),n.jsx(Q,{span:8,children:n.jsx(H.Item,{name:"state",label:"State",children:n.jsx(fe,{placeholder:"State"})})}),n.jsx(Q,{span:8,children:n.jsx(H.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(fe,{placeholder:"PIN Code",maxLength:6})})})]}),n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(fe,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(fe,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),n.jsx(H.Item,{name:"website",label:"Website",children:n.jsx(fe,{placeholder:"https://www.yourcompany.com"})}),n.jsx(H.Item,{name:"description",label:"Company Description",children:n.jsx(fe.TextArea,{rows:4,placeholder:"Brief description of your company"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",loading:t,icon:n.jsx(fs,{}),children:"Save Changes"})})]})})]})},"profile"),n.jsx(Rd,{tab:"Change Password",children:n.jsxs(H,{layout:"vertical",onFinish:c=>{je.success("Password updated successfully")},children:[n.jsx(H.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(fe.Password,{placeholder:"Current Password"})}),n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(fe.Password,{placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:c})=>({validator(h,x){return!x||c("newPassword")===x?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(fe.Password,{placeholder:"Confirm New Password"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var qg=class extends Error{constructor(t){super(t[0].message);cd(this,"issues");this.name="SchemaError",this.issues=t}},Qu=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(Qu||{});function Pd(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var Dd=Li;function Ju(e,t){if(e===t||!(Dd(e)&&Dd(t)||Array.isArray(e)&&Array.isArray(t)))return t;const r=Object.keys(t),s=Object.keys(e);let i=r.length===s.length;const a=Array.isArray(t)?[]:{};for(const o of r)a[o]=Ju(e[o],t[o]),i&&(i=e[o]===a[o]);return i?e:a}function zs(e){let t=0;for(const r in e)t++;return t}var Ld=e=>[].concat(...e);function Wg(e){return new RegExp("(^|:)//").test(e)}function Hg(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function mo(e){return e!=null}function Vg(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var Gg=e=>e.replace(/\/$/,""),Yg=e=>e.replace(/^\//,"");function Kg(e,t){if(!e)return t;if(!t)return e;if(Wg(t))return t;const r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=Gg(e),t=Yg(t),`${e}${r}${t}`}function Xg(e,t,r){return e.has(t)?e.get(t):e.set(t,r).get(t)}var Od=(...e)=>fetch(...e),Qg=e=>e.status>=200&&e.status<=299,Jg=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function Bd(e){if(!Li(e))return e;const t={...e};for(const[r,s]of Object.entries(t))s===void 0&&delete t[r];return t}function Rc({baseUrl:e,prepareHeaders:t=x=>x,fetchFn:r=Od,paramsSerializer:s,isJsonContentType:i=Jg,jsonContentType:a="application/json",jsonReplacer:o,timeout:l,responseHandler:d,validateStatus:c,...h}={}){return typeof fetch>"u"&&r===Od&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(u,p,g)=>{const{getState:f,extra:m,endpoint:v,forced:S,type:T}=p;let y,{url:w,headers:k=new Headers(h.headers),params:b=void 0,responseHandler:j=d??"json",validateStatus:A=c??Qg,timeout:E=l,...C}=typeof u=="string"?{url:u}:u,I,F=p.signal;E&&(I=new AbortController,p.signal.addEventListener("abort",I.abort),F=I.signal);let N={...h,signal:F,...C};k=new Headers(Bd(k)),N.headers=await t(k,{getState:f,arg:u,extra:m,endpoint:v,forced:S,type:T,extraOptions:g})||k;const z=B=>typeof B=="object"&&(Li(B)||Array.isArray(B)||typeof B.toJSON=="function");if(!N.headers.has("content-type")&&z(N.body)&&N.headers.set("content-type",a),z(N.body)&&i(N.headers)&&(N.body=JSON.stringify(N.body,o)),b){const B=~w.indexOf("?")?"&":"?",P=s?s(b):new URLSearchParams(Bd(b));w+=B+P}w=Kg(e,w);const U=new Request(w,N);y={request:new Request(w,N)};let O,X=!1,re=I&&setTimeout(()=>{X=!0,I.abort()},E);try{O=await r(U)}catch(B){return{error:{status:X?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(B)},meta:y}}finally{re&&clearTimeout(re),I==null||I.signal.removeEventListener("abort",I.abort)}const ee=O.clone();y.response=ee;let D,q="";try{let B;if(await Promise.all([x(O,j).then(P=>D=P,P=>B=P),ee.text().then(P=>q=P,()=>{})]),B)throw B}catch(B){return{error:{status:"PARSING_ERROR",originalStatus:O.status,data:q,error:String(B)},meta:y}}return A(O,D)?{data:D,meta:y}:{error:{status:O.status,data:D},meta:y}};async function x(u,p){if(typeof p=="function")return p(u);if(p==="content-type"&&(p=i(u.headers)?"json":"text"),p==="json"){const g=await u.text();return g.length?JSON.parse(g):null}return u.text()}}var Md=class{constructor(e,t=void 0){this.value=e,this.meta=t}},Pc=Js("__rtkq/focused"),Zu=Js("__rtkq/unfocused"),Dc=Js("__rtkq/online"),ef=Js("__rtkq/offline");function $o(e){return e.type==="query"}function Zg(e){return e.type==="mutation"}function Uo(e){return e.type==="infinitequery"}function go(e){return $o(e)||Uo(e)}function Lc(e,t,r,s,i,a){return e1(e)?e(t,r,s,i).filter(mo).map(cc).map(a):Array.isArray(e)?e.map(cc).map(a):[]}function e1(e){return typeof e=="function"}function cc(e){return typeof e=="string"?{type:e}:e}function t1(e,t){return e.catch(t)}var Bi=Symbol("forceQueryFn"),dc=e=>typeof e[Bi]=="function";function r1({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:r,mutationThunk:s,api:i,context:a}){const o=new Map,l=new Map,{unsubscribeQueryResult:d,removeMutationResult:c,updateSubscriptionOptions:h}=i.internalActions;return{buildInitiateQuery:m,buildInitiateInfiniteQuery:v,buildInitiateMutation:S,getRunningQueryThunk:x,getRunningMutationThunk:u,getRunningQueriesThunk:p,getRunningMutationsThunk:g};function x(T,y){return w=>{var j;const k=a.endpointDefinitions[T],b=e({queryArgs:y,endpointDefinition:k,endpointName:T});return(j=o.get(w))==null?void 0:j[b]}}function u(T,y){return w=>{var k;return(k=l.get(w))==null?void 0:k[y]}}function p(){return T=>Object.values(o.get(T)||{}).filter(mo)}function g(){return T=>Object.values(l.get(T)||{}).filter(mo)}function f(T,y){const w=(k,{subscribe:b=!0,forceRefetch:j,subscriptionOptions:A,[Bi]:E,...C}={})=>(I,F)=>{var Z;const N=e({queryArgs:k,endpointDefinition:y,endpointName:T});let z;const U={...C,type:"query",subscribe:b,forceRefetch:j,subscriptionOptions:A,endpointName:T,originalArgs:k,queryCacheKey:N,[Bi]:E};if($o(y))z=t(U);else{const{direction:se,initialPageParam:ie}=C;z=r({...U,direction:se,initialPageParam:ie})}const R=i.endpoints[T].select(k),O=I(z),X=R(F()),{requestId:re,abort:ee}=O,D=X.requestId!==re,q=(Z=o.get(I))==null?void 0:Z[N],B=()=>R(F()),P=Object.assign(E?O.then(B):D&&!q?Promise.resolve(X):Promise.all([q,O]).then(B),{arg:k,requestId:re,subscriptionOptions:A,queryCacheKey:N,abort:ee,async unwrap(){const se=await P;if(se.isError)throw se.error;return se.data},refetch:()=>I(w(k,{subscribe:!1,forceRefetch:!0})),unsubscribe(){b&&I(d({queryCacheKey:N,requestId:re}))},updateSubscriptionOptions(se){P.subscriptionOptions=se,I(h({endpointName:T,requestId:re,queryCacheKey:N,options:se}))}});if(!q&&!D&&!E){const se=Xg(o,I,{});se[N]=P,P.then(()=>{delete se[N],zs(se)||o.delete(I)})}return P};return w}function m(T,y){return f(T,y)}function v(T,y){return f(T,y)}function S(T){return(y,{track:w=!0,fixedCacheKey:k}={})=>(b,j)=>{const A=s({type:"mutation",endpointName:T,originalArgs:y,track:w,fixedCacheKey:k}),E=b(A),{requestId:C,abort:I,unwrap:F}=E,N=t1(E.unwrap().then(O=>({data:O})),O=>({error:O})),z=()=>{b(c({requestId:C,fixedCacheKey:k}))},U=Object.assign(N,{arg:E.arg,requestId:C,abort:I,unwrap:F,reset:z}),R=l.get(b)||{};return l.set(b,R),R[C]=U,U.then(()=>{delete R[C],zs(R)||l.delete(b)}),k&&(R[k]=U,U.then(()=>{R[k]===U&&(delete R[k],zs(R)||l.delete(b))})),U}}}var tf=class extends qg{constructor(e,t,r,s){super(e),this.value=t,this.schemaName=r,this._bqMeta=s}};async function Jn(e,t,r,s){const i=await e["~standard"].validate(t);if(i.issues)throw new tf(i.issues,t,r,s);return i.value}function n1(e){return e}var di=(e={})=>({...e,[Su]:!0});function s1({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:s,api:i,assertTagType:a,selectors:o,onSchemaFailure:l,catchSchemaFailure:d,skipSchemaValidation:c}){const h=(C,I,F,N)=>(z,U)=>{const R=r[C],O=s({queryArgs:I,endpointDefinition:R,endpointName:C});if(z(i.internalActions.queryResultPatched({queryCacheKey:O,patches:F})),!N)return;const X=i.endpoints[C].select(I)(U()),re=Lc(R.providesTags,X.data,void 0,I,{},a);z(i.internalActions.updateProvidedBy([{queryCacheKey:O,providedTags:re}]))};function x(C,I,F=0){const N=[I,...C];return F&&N.length>F?N.slice(0,-1):N}function u(C,I,F=0){const N=[...C,I];return F&&N.length>F?N.slice(1):N}const p=(C,I,F,N=!0)=>(z,U)=>{const O=i.endpoints[C].select(I)(U()),X={patches:[],inversePatches:[],undo:()=>z(i.util.patchQueryData(C,I,X.inversePatches,N))};if(O.status==="uninitialized")return X;let re;if("data"in O)if(tp(O.data)){const[ee,D,q]=Tu(O.data,F);X.patches.push(...D),X.inversePatches.push(...q),re=ee}else re=F(O.data),X.patches.push({op:"replace",path:[],value:re}),X.inversePatches.push({op:"replace",path:[],value:O.data});return X.patches.length===0||z(i.util.patchQueryData(C,I,X.patches,N)),X},g=(C,I,F)=>N=>N(i.endpoints[C].initiate(I,{subscribe:!1,forceRefetch:!0,[Bi]:()=>({data:F})})),f=(C,I)=>C.query&&C[I]?C[I]:n1,m=async(C,{signal:I,abort:F,rejectWithValue:N,fulfillWithValue:z,dispatch:U,getState:R,extra:O})=>{var D,q;const X=r[C.endpointName],{metaSchema:re,skipSchemaValidation:ee=c}=X;try{let B=f(X,"transformResponse");const P={signal:I,abort:F,dispatch:U,getState:R,extra:O,endpoint:C.endpointName,type:C.type,forced:C.type==="query"?v(C,R()):void 0,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0},Z=C.type==="query"?C[Bi]:void 0;let se;const ie=async(G,V,ae,ge)=>{if(V==null&&G.pages.length)return Promise.resolve({data:G});const te={queryArg:C.originalArgs,pageParam:V},be=await de(te),Ie=ge?x:u;return{data:{pages:Ie(G.pages,be.data,ae),pageParams:Ie(G.pageParams,V,ae)},meta:be.meta}};async function de(G){let V;const{extraOptions:ae,argSchema:ge,rawResponseSchema:te,responseSchema:be}=X;if(ge&&!ee&&(G=await Jn(ge,G,"argSchema",{})),Z?V=Z():X.query?V=await t(X.query(G),P,ae):V=await X.queryFn(G,P,ae,Me=>t(Me,P,ae)),typeof process<"u",V.error)throw new Md(V.error,V.meta);let{data:Ie}=V;te&&!ee&&(Ie=await Jn(te,V.data,"rawResponseSchema",V.meta));let ye=await B(Ie,V.meta,G);return be&&!ee&&(ye=await Jn(be,ye,"responseSchema",V.meta)),{...V,data:ye}}if(C.type==="query"&&"infiniteQueryOptions"in X){const{infiniteQueryOptions:G}=X,{maxPages:V=1/0}=G;let ae;const ge={pages:[],pageParams:[]},te=(D=o.selectQueryEntry(R(),C.queryCacheKey))==null?void 0:D.data,Ie=v(C,R())&&!C.direction||!te?ge:te;if("direction"in C&&C.direction&&Ie.pages.length){const ye=C.direction==="backward",Ue=(ye?rf:hc)(G,Ie);ae=await ie(Ie,Ue,V,ye)}else{const{initialPageParam:ye=G.initialPageParam}=C,Me=(te==null?void 0:te.pageParams)??[],Ue=Me[0]??ye,wt=Me.length;ae=await ie(Ie,Ue,V),Z&&(ae={data:ae.data.pages[0]});for(let qt=1;qt<wt;qt++){const Wt=hc(G,ae.data);ae=await ie(ae.data,Wt,V)}}se=ae}else se=await de(C.originalArgs);return re&&!ee&&se.meta&&(se.meta=await Jn(re,se.meta,"metaSchema",se.meta)),z(se.data,di({fulfilledTimeStamp:Date.now(),baseQueryMeta:se.meta}))}catch(B){let P=B;if(P instanceof Md){let Z=f(X,"transformErrorResponse");const{rawErrorResponseSchema:se,errorResponseSchema:ie}=X;let{value:de,meta:G}=P;try{se&&!ee&&(de=await Jn(se,de,"rawErrorResponseSchema",G)),re&&!ee&&(G=await Jn(re,G,"metaSchema",G));let V=await Z(de,G,C.originalArgs);return ie&&!ee&&(V=await Jn(ie,V,"errorResponseSchema",G)),N(V,di({baseQueryMeta:G}))}catch(V){P=V}}try{if(P instanceof tf){const Z={endpoint:C.endpointName,arg:C.originalArgs,type:C.type,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0};(q=X.onSchemaFailure)==null||q.call(X,P,Z),l==null||l(P,Z);const{catchSchemaFailure:se=d}=X;if(se)return N(se(P,Z),di({baseQueryMeta:P._bqMeta}))}}catch(Z){P=Z}throw console.error(P),P}};function v(C,I){const F=o.selectQueryEntry(I,C.queryCacheKey),N=o.selectConfig(I).refetchOnMountOrArgChange,z=F==null?void 0:F.fulfilledTimeStamp,U=C.forceRefetch??(C.subscribe&&N);return U?U===!0||(Number(new Date)-Number(z))/1e3>=U:!1}const S=()=>Qe(`${e}/executeQuery`,m,{getPendingMeta({arg:I}){const F=r[I.endpointName];return di({startedTimeStamp:Date.now(),...Uo(F)?{direction:I.direction}:{}})},condition(I,{getState:F}){var ee;const N=F(),z=o.selectQueryEntry(N,I.queryCacheKey),U=z==null?void 0:z.fulfilledTimeStamp,R=I.originalArgs,O=z==null?void 0:z.originalArgs,X=r[I.endpointName],re=I.direction;return dc(I)?!0:(z==null?void 0:z.status)==="pending"?!1:v(I,N)||$o(X)&&((ee=X==null?void 0:X.forceRefetch)!=null&&ee.call(X,{currentArg:R,previousArg:O,endpointState:z,state:N}))?!0:!(U&&!re)},dispatchConditionRejection:!0}),T=S(),y=S(),w=Qe(`${e}/executeMutation`,m,{getPendingMeta(){return di({startedTimeStamp:Date.now()})}}),k=C=>"force"in C,b=C=>"ifOlderThan"in C,j=(C,I,F)=>(N,z)=>{const U=k(F)&&F.force,R=b(F)&&F.ifOlderThan,O=(re=!0)=>{const ee={forceRefetch:re,isPrefetch:!0};return i.endpoints[C].initiate(I,ee)},X=i.endpoints[C].select(I)(z());if(U)N(O());else if(R){const re=X==null?void 0:X.fulfilledTimeStamp;if(!re){N(O());return}(Number(new Date)-Number(new Date(re)))/1e3>=R&&N(O())}else N(O(!1))};function A(C){return I=>{var F,N;return((N=(F=I==null?void 0:I.meta)==null?void 0:F.arg)==null?void 0:N.endpointName)===C}}function E(C,I){return{matchPending:rl(Eu(C),A(I)),matchFulfilled:rl(ls(C),A(I)),matchRejected:rl(Tc(C),A(I))}}return{queryThunk:T,mutationThunk:w,infiniteQueryThunk:y,prefetch:j,updateQueryData:p,upsertQueryData:g,patchQueryData:h,buildMatchThunkActions:E}}function hc(e,{pages:t,pageParams:r}){const s=t.length-1;return e.getNextPageParam(t[s],t,r[s],r)}function rf(e,{pages:t,pageParams:r}){var s;return(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r)}function nf(e,t,r,s){return Lc(r[e.meta.arg.endpointName][t],ls(e)?e.payload:void 0,Ec(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,s)}function ua(e,t,r){const s=e[t];s&&r(s)}function Mi(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function $d(e,t,r){const s=e[Mi(t)];s&&r(s)}var fa={};function i1({reducerPath:e,queryThunk:t,mutationThunk:r,serializeQueryArgs:s,context:{endpointDefinitions:i,apiUid:a,extractRehydrationInfo:o,hasRehydrationInfo:l},assertTagType:d,config:c}){const h=Js(`${e}/resetApiState`);function x(A,E,C,I){var F;A[F=E.queryCacheKey]??(A[F]={status:"uninitialized",endpointName:E.endpointName}),ua(A,E.queryCacheKey,N=>{N.status="pending",N.requestId=C&&N.requestId?N.requestId:I.requestId,E.originalArgs!==void 0&&(N.originalArgs=E.originalArgs),N.startedTimeStamp=I.startedTimeStamp;const z=i[I.arg.endpointName];Uo(z)&&"direction"in E&&(N.direction=E.direction)})}function u(A,E,C,I){ua(A,E.arg.queryCacheKey,F=>{if(F.requestId!==E.requestId&&!I)return;const{merge:N}=i[E.arg.endpointName];if(F.status="fulfilled",N)if(F.data!==void 0){const{fulfilledTimeStamp:z,arg:U,baseQueryMeta:R,requestId:O}=E;let X=Sc(F.data,re=>N(re,C,{arg:U.originalArgs,baseQueryMeta:R,fulfilledTimeStamp:z,requestId:O}));F.data=X}else F.data=C;else F.data=i[E.arg.endpointName].structuralSharing??!0?Ju(np(F.data)?sp(F.data):F.data,C):C;delete F.error,F.fulfilledTimeStamp=E.fulfilledTimeStamp})}const p=gr({name:`${e}/queries`,initialState:fa,reducers:{removeQueryResult:{reducer(A,{payload:{queryCacheKey:E}}){delete A[E]},prepare:oi()},cacheEntriesUpserted:{reducer(A,E){for(const C of E.payload){const{queryDescription:I,value:F}=C;x(A,I,!0,{arg:I,requestId:E.meta.requestId,startedTimeStamp:E.meta.timestamp}),u(A,{arg:I,requestId:E.meta.requestId,fulfilledTimeStamp:E.meta.timestamp,baseQueryMeta:{}},F,!0)}},prepare:A=>({payload:A.map(I=>{const{endpointName:F,arg:N,value:z}=I,U=i[F];return{queryDescription:{type:"query",endpointName:F,originalArgs:I.arg,queryCacheKey:s({queryArgs:N,endpointDefinition:U,endpointName:F})},value:z}}),meta:{[Su]:!0,requestId:bu(),timestamp:Date.now()}})},queryResultPatched:{reducer(A,{payload:{queryCacheKey:E,patches:C}}){ua(A,E,I=>{I.data=md(I.data,C.concat())})},prepare:oi()}},extraReducers(A){A.addCase(t.pending,(E,{meta:C,meta:{arg:I}})=>{const F=dc(I);x(E,I,F,C)}).addCase(t.fulfilled,(E,{meta:C,payload:I})=>{const F=dc(C.arg);u(E,C,I,F)}).addCase(t.rejected,(E,{meta:{condition:C,arg:I,requestId:F},error:N,payload:z})=>{ua(E,I.queryCacheKey,U=>{if(!C){if(U.requestId!==F)return;U.status="rejected",U.error=z??N}})}).addMatcher(l,(E,C)=>{const{queries:I}=o(C);for(const[F,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&(E[F]=N)})}}),g=gr({name:`${e}/mutations`,initialState:fa,reducers:{removeMutationResult:{reducer(A,{payload:E}){const C=Mi(E);C in A&&delete A[C]},prepare:oi()}},extraReducers(A){A.addCase(r.pending,(E,{meta:C,meta:{requestId:I,arg:F,startedTimeStamp:N}})=>{F.track&&(E[Mi(C)]={requestId:I,status:"pending",endpointName:F.endpointName,startedTimeStamp:N})}).addCase(r.fulfilled,(E,{payload:C,meta:I})=>{I.arg.track&&$d(E,I,F=>{F.requestId===I.requestId&&(F.status="fulfilled",F.data=C,F.fulfilledTimeStamp=I.fulfilledTimeStamp)})}).addCase(r.rejected,(E,{payload:C,error:I,meta:F})=>{F.arg.track&&$d(E,F,N=>{N.requestId===F.requestId&&(N.status="rejected",N.error=C??I)})}).addMatcher(l,(E,C)=>{const{mutations:I}=o(C);for(const[F,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&F!==(N==null?void 0:N.requestId)&&(E[F]=N)})}}),f={tags:{},keys:{}},m=gr({name:`${e}/invalidation`,initialState:f,reducers:{updateProvidedBy:{reducer(A,E){var C,I,F;for(const{queryCacheKey:N,providedTags:z}of E.payload){v(A,N);for(const{type:U,id:R}of z){const O=(I=(C=A.tags)[U]??(C[U]={}))[F=R||"__internal_without_id"]??(I[F]=[]);O.includes(N)||O.push(N)}A.keys[N]=z}},prepare:oi()}},extraReducers(A){A.addCase(p.actions.removeQueryResult,(E,{payload:{queryCacheKey:C}})=>{v(E,C)}).addMatcher(l,(E,C)=>{var F,N,z;const{provided:I}=o(C);for(const[U,R]of Object.entries(I))for(const[O,X]of Object.entries(R)){const re=(N=(F=E.tags)[U]??(F[U]={}))[z=O||"__internal_without_id"]??(N[z]=[]);for(const ee of X)re.includes(ee)||re.push(ee)}}).addMatcher(fo(ls(t),Ec(t)),(E,C)=>{S(E,[C])}).addMatcher(p.actions.cacheEntriesUpserted.match,(E,C)=>{const I=C.payload.map(({queryDescription:F,value:N})=>({type:"UNKNOWN",payload:N,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:F}}));S(E,I)})}});function v(A,E){var I;const C=A.keys[E]??[];for(const F of C){const N=F.type,z=F.id??"__internal_without_id",U=(I=A.tags[N])==null?void 0:I[z];U&&(A.tags[N][z]=U.filter(R=>R!==E))}delete A.keys[E]}function S(A,E){const C=E.map(I=>{const F=nf(I,"providesTags",i,d),{queryCacheKey:N}=I.meta.arg;return{queryCacheKey:N,providedTags:F}});m.caseReducers.updateProvidedBy(A,m.actions.updateProvidedBy(C))}const T=gr({name:`${e}/subscriptions`,initialState:fa,reducers:{updateSubscriptionOptions(A,E){},unsubscribeQueryResult(A,E){},internal_getRTKQSubscriptions(){}}}),y=gr({name:`${e}/internalSubscriptions`,initialState:fa,reducers:{subscriptionsUpdated:{reducer(A,E){return md(A,E.payload)},prepare:oi()}}}),w=gr({name:`${e}/config`,initialState:{online:Vg(),focused:Hg(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(A,{payload:E}){A.middlewareRegistered=A.middlewareRegistered==="conflict"||a!==E?"conflict":!0}},extraReducers:A=>{A.addCase(Dc,E=>{E.online=!0}).addCase(ef,E=>{E.online=!1}).addCase(Pc,E=>{E.focused=!0}).addCase(Zu,E=>{E.focused=!1}).addMatcher(l,E=>({...E}))}}),k=ep({queries:p.reducer,mutations:g.reducer,provided:m.reducer,subscriptions:y.reducer,config:w.reducer}),b=(A,E)=>k(h.match(E)?void 0:A,E),j={...w.actions,...p.actions,...T.actions,...y.actions,...g.actions,...m.actions,resetApiState:h};return{reducer:b,actions:j}}var qr=Symbol.for("RTKQ/skipToken"),sf={status:"uninitialized"},Ud=Sc(sf,()=>{}),zd=Sc(sf,()=>{});function a1({serializeQueryArgs:e,reducerPath:t,createSelector:r}){const s=T=>Ud,i=T=>zd;return{buildQuerySelector:u,buildInfiniteQuerySelector:p,buildMutationSelector:g,selectInvalidatedBy:f,selectCachedArgsForQuery:m,selectApiState:o,selectQueries:l,selectMutations:c,selectQueryEntry:d,selectConfig:h};function a(T){return{...T,...Pd(T.status)}}function o(T){return T[t]}function l(T){var y;return(y=o(T))==null?void 0:y.queries}function d(T,y){var w;return(w=l(T))==null?void 0:w[y]}function c(T){var y;return(y=o(T))==null?void 0:y.mutations}function h(T){var y;return(y=o(T))==null?void 0:y.config}function x(T,y,w){return k=>{if(k===qr)return r(s,w);const b=e({queryArgs:k,endpointDefinition:y,endpointName:T});return r(A=>d(A,b)??Ud,w)}}function u(T,y){return x(T,y,a)}function p(T,y){const{infiniteQueryOptions:w}=y;function k(b){const j={...b,...Pd(b.status)},{isLoading:A,isError:E,direction:C}=j,I=C==="forward",F=C==="backward";return{...j,hasNextPage:v(w,j.data),hasPreviousPage:S(w,j.data),isFetchingNextPage:A&&I,isFetchingPreviousPage:A&&F,isFetchNextPageError:E&&I,isFetchPreviousPageError:E&&F}}return x(T,y,k)}function g(){return T=>{let y;return typeof T=="object"?y=Mi(T)??qr:y=T,r(y===qr?i:b=>{var j,A;return((A=(j=o(b))==null?void 0:j.mutations)==null?void 0:A[y])??zd},a)}}function f(T,y){const w=T[t],k=new Set;for(const b of y.filter(mo).map(cc)){const j=w.provided.tags[b.type];if(!j)continue;let A=(b.id!==void 0?j[b.id]:Ld(Object.values(j)))??[];for(const E of A)k.add(E)}return Ld(Array.from(k.values()).map(b=>{const j=w.queries[b];return j?[{queryCacheKey:b,endpointName:j.endpointName,originalArgs:j.originalArgs}]:[]}))}function m(T,y){return Object.values(l(T)).filter(w=>(w==null?void 0:w.endpointName)===y&&w.status!=="uninitialized").map(w=>w.originalArgs)}function v(T,y){return y?hc(T,y)!=null:!1}function S(T,y){return!y||!T.getPreviousPageParam?!1:rf(T,y)!=null}}var Ts=WeakMap?new WeakMap:void 0,yo=({endpointName:e,queryArgs:t})=>{let r="";const s=Ts==null?void 0:Ts.get(t);if(typeof s=="string")r=s;else{const i=JSON.stringify(t,(a,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=Li(o)?Object.keys(o).sort().reduce((l,d)=>(l[d]=o[d],l),{}):o,o));Li(t)&&(Ts==null||Ts.set(t,i)),r=i}return`${e}(${r})`};function af(...e){return function(r){const s=pd(c=>{var h;return(h=r.extractRehydrationInfo)==null?void 0:h.call(r,c,{reducerPath:r.reducerPath??"api"})}),i={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:s,serializeQueryArgs(c){let h=yo;if("serializeQueryArgs"in c.endpointDefinition){const x=c.endpointDefinition.serializeQueryArgs;h=u=>{const p=x(u);return typeof p=="string"?p:yo({...u,queryArgs:p})}}else r.serializeQueryArgs&&(h=r.serializeQueryArgs);return h(c)},tagTypes:[...r.tagTypes||[]]},a={endpointDefinitions:{},batch(c){c()},apiUid:bu(),extractRehydrationInfo:s,hasRehydrationInfo:pd(c=>s(c)!=null)},o={injectEndpoints:d,enhanceEndpoints({addTagTypes:c,endpoints:h}){if(c)for(const x of c)i.tagTypes.includes(x)||i.tagTypes.push(x);if(h)for(const[x,u]of Object.entries(h))typeof u=="function"?u(a.endpointDefinitions[x]):Object.assign(a.endpointDefinitions[x]||{},u);return o}},l=e.map(c=>c.init(o,i,a));function d(c){const h=c.endpoints({query:x=>({...x,type:"query"}),mutation:x=>({...x,type:"mutation"}),infiniteQuery:x=>({...x,type:"infinitequery"})});for(const[x,u]of Object.entries(h)){if(c.overrideExisting!==!0&&x in a.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(wu(39));continue}a.endpointDefinitions[x]=u;for(const p of l)p.injectEndpoint(x,u)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function vn(e,...t){return Object.assign(e,...t)}var o1=({api:e,queryThunk:t,internalState:r})=>{const s=`${e.reducerPath}/subscriptions`;let i=null,a=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:l}=e.internalActions,d=(p,g)=>{var m,v,S;if(o.match(g)){const{queryCacheKey:T,requestId:y,options:w}=g.payload;return(m=p==null?void 0:p[T])!=null&&m[y]&&(p[T][y]=w),!0}if(l.match(g)){const{queryCacheKey:T,requestId:y}=g.payload;return p[T]&&delete p[T][y],!0}if(e.internalActions.removeQueryResult.match(g))return delete p[g.payload.queryCacheKey],!0;if(t.pending.match(g)){const{meta:{arg:T,requestId:y}}=g,w=p[v=T.queryCacheKey]??(p[v]={});return w[`${y}_running`]={},T.subscribe&&(w[y]=T.subscriptionOptions??w[y]??{}),!0}let f=!1;if(t.fulfilled.match(g)||t.rejected.match(g)){const T=p[g.meta.arg.queryCacheKey]||{},y=`${g.meta.requestId}_running`;f||(f=!!T[y]),delete T[y]}if(t.rejected.match(g)){const{meta:{condition:T,arg:y,requestId:w}}=g;if(T&&y.subscribe){const k=p[S=y.queryCacheKey]??(p[S]={});k[w]=y.subscriptionOptions??k[w]??{},f=!0}}return f},c=()=>r.currentSubscriptions,u={getSubscriptions:c,getSubscriptionCount:p=>{const f=c()[p]??{};return zs(f)},isRequestSubscribed:(p,g)=>{var m;const f=c();return!!((m=f==null?void 0:f[p])!=null&&m[g])}};return(p,g)=>{if(i||(i=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(p))return i=r.currentSubscriptions={},a=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(p))return[!1,u];const f=d(r.currentSubscriptions,p);let m=!0;if(f){a||(a=setTimeout(()=>{const T=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,y]=Tu(i,()=>T);g.next(e.internalActions.subscriptionsUpdated(y)),i=T,a=null},500));const v=typeof p.type=="string"&&!!p.type.startsWith(s),S=t.rejected.match(p)&&p.meta.condition&&!!p.meta.arg.subscribe;m=!v&&!S}return[m,!1]}};function l1(e){for(const t in e)return!1;return!0}var c1=2147483647/1e3-1,d1=({reducerPath:e,api:t,queryThunk:r,context:s,internalState:i,selectors:{selectQueryEntry:a,selectConfig:o}})=>{const{removeQueryResult:l,unsubscribeQueryResult:d,cacheEntriesUpserted:c}=t.internalActions,h=fo(d.match,r.fulfilled,r.rejected,c.match);function x(m){const v=i.currentSubscriptions[m];return!!v&&!l1(v)}const u={},p=(m,v,S)=>{const T=v.getState(),y=o(T);if(h(m)){let w;if(c.match(m))w=m.payload.map(k=>k.queryDescription.queryCacheKey);else{const{queryCacheKey:k}=d.match(m)?m.payload:m.meta.arg;w=[k]}g(w,v,y)}if(t.util.resetApiState.match(m))for(const[w,k]of Object.entries(u))k&&clearTimeout(k),delete u[w];if(s.hasRehydrationInfo(m)){const{queries:w}=s.extractRehydrationInfo(m);g(Object.keys(w),v,y)}};function g(m,v,S){const T=v.getState();for(const y of m){const w=a(T,y);f(y,w==null?void 0:w.endpointName,v,S)}}function f(m,v,S,T){const y=s.endpointDefinitions[v],w=(y==null?void 0:y.keepUnusedDataFor)??T.keepUnusedDataFor;if(w===1/0)return;const k=Math.max(0,Math.min(w,c1));if(!x(m)){const b=u[m];b&&clearTimeout(b),u[m]=setTimeout(()=>{x(m)||S.dispatch(l({queryCacheKey:m})),delete u[m]},k*1e3)}}return p},qd=new Error("Promise never resolved before cacheEntryRemoved."),h1=({api:e,reducerPath:t,context:r,queryThunk:s,mutationThunk:i,internalState:a,selectors:{selectQueryEntry:o,selectApiState:l}})=>{const d=gd(s),c=gd(i),h=ls(s,i),x={};function u(v,S,T){const y=x[v];y!=null&&y.valueResolved&&(y.valueResolved({data:S,meta:T}),delete y.valueResolved)}function p(v){const S=x[v];S&&(delete x[v],S.cacheEntryRemoved())}const g=(v,S,T)=>{const y=f(v);function w(k,b,j,A){const E=o(T,b),C=o(S.getState(),b);!E&&C&&m(k,A,b,S,j)}if(s.pending.match(v))w(v.meta.arg.endpointName,y,v.meta.requestId,v.meta.arg.originalArgs);else if(e.internalActions.cacheEntriesUpserted.match(v))for(const{queryDescription:k,value:b}of v.payload){const{endpointName:j,originalArgs:A,queryCacheKey:E}=k;w(j,E,v.meta.requestId,A),u(E,b,{})}else if(i.pending.match(v))S.getState()[t].mutations[y]&&m(v.meta.arg.endpointName,v.meta.arg.originalArgs,y,S,v.meta.requestId);else if(h(v))u(y,v.payload,v.meta.baseQueryMeta);else if(e.internalActions.removeQueryResult.match(v)||e.internalActions.removeMutationResult.match(v))p(y);else if(e.util.resetApiState.match(v))for(const k of Object.keys(x))p(k)};function f(v){return d(v)?v.meta.arg.queryCacheKey:c(v)?v.meta.arg.fixedCacheKey??v.meta.requestId:e.internalActions.removeQueryResult.match(v)?v.payload.queryCacheKey:e.internalActions.removeMutationResult.match(v)?Mi(v.payload):""}function m(v,S,T,y,w){const k=r.endpointDefinitions[v],b=k==null?void 0:k.onCacheEntryAdded;if(!b)return;const j={},A=new Promise(z=>{j.cacheEntryRemoved=z}),E=Promise.race([new Promise(z=>{j.valueResolved=z}),A.then(()=>{throw qd})]);E.catch(()=>{}),x[T]=j;const C=e.endpoints[v].select(go(k)?S:T),I=y.dispatch((z,U,R)=>R),F={...y,getCacheEntry:()=>C(y.getState()),requestId:w,extra:I,updateCachedData:go(k)?z=>y.dispatch(e.util.updateQueryData(v,S,z)):void 0,cacheDataLoaded:E,cacheEntryRemoved:A},N=b(S,F);Promise.resolve(N).catch(z=>{if(z!==qd)throw z})}return g},u1=({api:e,context:{apiUid:t},reducerPath:r})=>(s,i)=>{e.util.resetApiState.match(s)&&i.dispatch(e.internalActions.middlewareRegistered(t))},f1=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:s,queryThunk:i,api:a,assertTagType:o,refetchQuery:l,internalState:d})=>{const{removeQueryResult:c}=a.internalActions,h=fo(ls(s),Ec(s)),x=fo(ls(s,i),Tc(s,i));let u=[];const p=(m,v)=>{h(m)?f(nf(m,"invalidatesTags",r,o),v):x(m)?f([],v):a.util.invalidateTags.match(m)&&f(Lc(m.payload,void 0,void 0,void 0,void 0,o),v)};function g(m){var T;const{queries:v,mutations:S}=m;for(const y of[v,S])for(const w in y)if(((T=y[w])==null?void 0:T.status)==="pending")return!0;return!1}function f(m,v){const S=v.getState(),T=S[e];if(u.push(...m),T.config.invalidationBehavior==="delayed"&&g(T))return;const y=u;if(u=[],y.length===0)return;const w=a.util.selectInvalidatedBy(S,y);t.batch(()=>{const k=Array.from(w.values());for(const{queryCacheKey:b}of k){const j=T.queries[b],A=d.currentSubscriptions[b]??{};j&&(zs(A)===0?v.dispatch(c({queryCacheKey:b})):j.status!=="uninitialized"&&v.dispatch(l(j)))}})}return p},x1=({reducerPath:e,queryThunk:t,api:r,refetchQuery:s,internalState:i})=>{const a={},o=(u,p)=>{(r.internalActions.updateSubscriptionOptions.match(u)||r.internalActions.unsubscribeQueryResult.match(u))&&d(u.payload,p),(t.pending.match(u)||t.rejected.match(u)&&u.meta.condition)&&d(u.meta.arg,p),(t.fulfilled.match(u)||t.rejected.match(u)&&!u.meta.condition)&&l(u.meta.arg,p),r.util.resetApiState.match(u)&&h()};function l({queryCacheKey:u},p){const g=p.getState()[e],f=g.queries[u],m=i.currentSubscriptions[u];if(!f||f.status==="uninitialized")return;const{lowestPollingInterval:v,skipPollingIfUnfocused:S}=x(m);if(!Number.isFinite(v))return;const T=a[u];T!=null&&T.timeout&&(clearTimeout(T.timeout),T.timeout=void 0);const y=Date.now()+v;a[u]={nextPollTimestamp:y,pollingInterval:v,timeout:setTimeout(()=>{(g.config.focused||!S)&&p.dispatch(s(f)),l({queryCacheKey:u},p)},v)}}function d({queryCacheKey:u},p){const f=p.getState()[e].queries[u],m=i.currentSubscriptions[u];if(!f||f.status==="uninitialized")return;const{lowestPollingInterval:v}=x(m);if(!Number.isFinite(v)){c(u);return}const S=a[u],T=Date.now()+v;(!S||T<S.nextPollTimestamp)&&l({queryCacheKey:u},p)}function c(u){const p=a[u];p!=null&&p.timeout&&clearTimeout(p.timeout),delete a[u]}function h(){for(const u of Object.keys(a))c(u)}function x(u={}){let p=!1,g=Number.POSITIVE_INFINITY;for(let f in u)u[f].pollingInterval&&(g=Math.min(u[f].pollingInterval,g),p=u[f].skipPollingIfUnfocused||p);return{lowestPollingInterval:g,skipPollingIfUnfocused:p}}return o},p1=({api:e,context:t,queryThunk:r,mutationThunk:s})=>{const i=Eu(r,s),a=Tc(r,s),o=ls(r,s),l={};return(c,h)=>{var x,u;if(i(c)){const{requestId:p,arg:{endpointName:g,originalArgs:f}}=c.meta,m=t.endpointDefinitions[g],v=m==null?void 0:m.onQueryStarted;if(v){const S={},T=new Promise((b,j)=>{S.resolve=b,S.reject=j});T.catch(()=>{}),l[p]=S;const y=e.endpoints[g].select(go(m)?f:p),w=h.dispatch((b,j,A)=>A),k={...h,getCacheEntry:()=>y(h.getState()),requestId:p,extra:w,updateCachedData:go(m)?b=>h.dispatch(e.util.updateQueryData(g,f,b)):void 0,queryFulfilled:T};v(f,k)}}else if(o(c)){const{requestId:p,baseQueryMeta:g}=c.meta;(x=l[p])==null||x.resolve({data:c.payload,meta:g}),delete l[p]}else if(a(c)){const{requestId:p,rejectedWithValue:g,baseQueryMeta:f}=c.meta;(u=l[p])==null||u.reject({error:c.payload??c.error,isUnhandledError:!g,meta:f}),delete l[p]}}},m1=({reducerPath:e,context:t,api:r,refetchQuery:s,internalState:i})=>{const{removeQueryResult:a}=r.internalActions,o=(d,c)=>{Pc.match(d)&&l(c,"refetchOnFocus"),Dc.match(d)&&l(c,"refetchOnReconnect")};function l(d,c){const h=d.getState()[e],x=h.queries,u=i.currentSubscriptions;t.batch(()=>{for(const p of Object.keys(u)){const g=x[p],f=u[p];if(!f||!g)continue;(Object.values(f).some(v=>v[c]===!0)||Object.values(f).every(v=>v[c]===void 0)&&h.config[c])&&(zs(f)===0?d.dispatch(a({queryCacheKey:p})):g.status!=="uninitialized"&&d.dispatch(s(g)))}})}return o};function g1(e){const{reducerPath:t,queryThunk:r,api:s,context:i}=e,{apiUid:a}=i,o={invalidateTags:Js(`${t}/invalidateTags`)},l=x=>x.type.startsWith(`${t}/`),d=[u1,d1,f1,x1,h1,p1];return{middleware:x=>{let u=!1;const g={...e,internalState:{currentSubscriptions:{}},refetchQuery:h,isThisApiSliceAction:l},f=d.map(S=>S(g)),m=o1(g),v=m1(g);return S=>T=>{if(!rp(T))return S(T);u||(u=!0,x.dispatch(s.internalActions.middlewareRegistered(a)));const y={...x,next:S},w=x.getState(),[k,b]=m(T,y,w);let j;if(k?j=S(T):j=b,x.getState()[t]&&(v(T,y,w),l(T)||i.hasRehydrationInfo(T)))for(const A of f)A(T,y,w);return j}},actions:o};function h(x){return e.api.endpoints[x.endpointName].initiate(x.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Wd=Symbol(),of=({createSelector:e=ju}={})=>({name:Wd,init(t,{baseQuery:r,tagTypes:s,reducerPath:i,serializeQueryArgs:a,keepUnusedDataFor:o,refetchOnMountOrArgChange:l,refetchOnFocus:d,refetchOnReconnect:c,invalidationBehavior:h,onSchemaFailure:x,catchSchemaFailure:u,skipSchemaValidation:p},g){Zx();const f=P=>P;Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Dc,onOffline:ef,onFocus:Pc,onFocusLost:Zu},util:{}});const m=a1({serializeQueryArgs:a,reducerPath:i,createSelector:e}),{selectInvalidatedBy:v,selectCachedArgsForQuery:S,buildQuerySelector:T,buildInfiniteQuerySelector:y,buildMutationSelector:w}=m;vn(t.util,{selectInvalidatedBy:v,selectCachedArgsForQuery:S});const{queryThunk:k,infiniteQueryThunk:b,mutationThunk:j,patchQueryData:A,updateQueryData:E,upsertQueryData:C,prefetch:I,buildMatchThunkActions:F}=s1({baseQuery:r,reducerPath:i,context:g,api:t,serializeQueryArgs:a,assertTagType:f,selectors:m,onSchemaFailure:x,catchSchemaFailure:u,skipSchemaValidation:p}),{reducer:N,actions:z}=i1({context:g,queryThunk:k,mutationThunk:j,serializeQueryArgs:a,reducerPath:i,assertTagType:f,config:{refetchOnFocus:d,refetchOnReconnect:c,refetchOnMountOrArgChange:l,keepUnusedDataFor:o,reducerPath:i,invalidationBehavior:h}});vn(t.util,{patchQueryData:A,updateQueryData:E,upsertQueryData:C,prefetch:I,resetApiState:z.resetApiState,upsertQueryEntries:z.cacheEntriesUpserted}),vn(t.internalActions,z);const{middleware:U,actions:R}=g1({reducerPath:i,context:g,queryThunk:k,mutationThunk:j,infiniteQueryThunk:b,api:t,assertTagType:f,selectors:m});vn(t.util,R),vn(t,{reducer:N,middleware:U});const{buildInitiateQuery:O,buildInitiateInfiniteQuery:X,buildInitiateMutation:re,getRunningMutationThunk:ee,getRunningMutationsThunk:D,getRunningQueriesThunk:q,getRunningQueryThunk:B}=r1({queryThunk:k,mutationThunk:j,infiniteQueryThunk:b,api:t,serializeQueryArgs:a,context:g});return vn(t.util,{getRunningMutationThunk:ee,getRunningMutationsThunk:D,getRunningQueryThunk:B,getRunningQueriesThunk:q}),{name:Wd,injectEndpoint(P,Z){var de;const ie=(de=t.endpoints)[P]??(de[P]={});$o(Z)&&vn(ie,{name:P,select:T(P,Z),initiate:O(P,Z)},F(k,P)),Zg(Z)&&vn(ie,{name:P,select:w(),initiate:re(P)},F(j,P)),Uo(Z)&&vn(ie,{name:P,select:y(P,Z),initiate:X(P,Z)},F(k,P))}}}});of();function xa(e){return e.replace(e[0],e[0].toUpperCase())}function y1(e){return e.type==="query"}function v1(e){return e.type==="mutation"}function lf(e){return e.type==="infinitequery"}function hi(e,...t){return Object.assign(e,...t)}var dl=Symbol();function hl(e,t,r,s){const i=_.useMemo(()=>({queryArgs:e,serialized:typeof e=="object"?t({queryArgs:e,endpointDefinition:r,endpointName:s}):e}),[e,t,r,s]),a=_.useRef(i);return _.useEffect(()=>{a.current.serialized!==i.serialized&&(a.current=i)},[i]),a.current.serialized===i.serialized?a.current.queryArgs:e}function pa(e){const t=_.useRef(e);return _.useEffect(()=>{vi(t.current,e)||(t.current=e)},[e]),vi(t.current,e)?t.current:e}var b1=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",w1=b1(),j1=()=>typeof navigator<"u"&&navigator.product==="ReactNative",S1=j1(),E1=()=>w1||S1?_.useLayoutEffect:_.useEffect,T1=E1(),Hd=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:Qu.pending}:e;function ul(e,...t){const r={};return t.forEach(s=>{r[s]=e[s]}),r}var fl=["data","status","isLoading","isSuccess","isError","error"];function _1({api:e,moduleOptions:{batch:t,hooks:{useDispatch:r,useSelector:s,useStore:i},unstable__sideEffectsInRender:a,createSelector:o},serializeQueryArgs:l,context:d}){const c=a?y=>y():_.useEffect;return{buildQueryHooks:v,buildInfiniteQueryHooks:S,buildMutationHook:T,usePrefetch:u};function h(y,w,k){if(w!=null&&w.endpointName&&y.isUninitialized){const{endpointName:I}=w,F=d.endpointDefinitions[I];k!==qr&&l({queryArgs:w.originalArgs,endpointDefinition:F,endpointName:I})===l({queryArgs:k,endpointDefinition:F,endpointName:I})&&(w=void 0)}let b=y.isSuccess?y.data:w==null?void 0:w.data;b===void 0&&(b=y.data);const j=b!==void 0,A=y.isLoading,E=(!w||w.isLoading||w.isUninitialized)&&!j&&A,C=y.isSuccess||j&&(A&&!(w!=null&&w.isError)||y.isUninitialized);return{...y,data:b,currentData:y.data,isFetching:A,isLoading:E,isSuccess:C}}function x(y,w,k){if(w!=null&&w.endpointName&&y.isUninitialized){const{endpointName:I}=w,F=d.endpointDefinitions[I];k!==qr&&l({queryArgs:w.originalArgs,endpointDefinition:F,endpointName:I})===l({queryArgs:k,endpointDefinition:F,endpointName:I})&&(w=void 0)}let b=y.isSuccess?y.data:w==null?void 0:w.data;b===void 0&&(b=y.data);const j=b!==void 0,A=y.isLoading,E=(!w||w.isLoading||w.isUninitialized)&&!j&&A,C=y.isSuccess||A&&j;return{...y,data:b,currentData:y.data,isFetching:A,isLoading:E,isSuccess:C}}function u(y,w){const k=r(),b=pa(w);return _.useCallback((j,A)=>k(e.util.prefetch(y,j,{...b,...A})),[y,k,b])}function p(y,w,{refetchOnReconnect:k,refetchOnFocus:b,refetchOnMountOrArgChange:j,skip:A=!1,pollingInterval:E=0,skipPollingIfUnfocused:C=!1,...I}={}){const{initiate:F}=e.endpoints[y],N=r(),z=_.useRef(void 0);if(!z.current){const P=N(e.internalActions.internal_getRTKQSubscriptions());z.current=P}const U=hl(A?qr:w,yo,d.endpointDefinitions[y],y),R=pa({refetchOnReconnect:k,refetchOnFocus:b,pollingInterval:E,skipPollingIfUnfocused:C}),O=I.initialPageParam,X=pa(O),re=_.useRef(void 0);let{queryCacheKey:ee,requestId:D}=re.current||{},q=!1;ee&&D&&(q=z.current.isRequestSubscribed(ee,D));const B=!q&&re.current!==void 0;return c(()=>{B&&(re.current=void 0)},[B]),c(()=>{var se;const P=re.current;if(U===qr){P==null||P.unsubscribe(),re.current=void 0;return}const Z=(se=re.current)==null?void 0:se.subscriptionOptions;if(!P||P.arg!==U){P==null||P.unsubscribe();const ie=N(F(U,{subscriptionOptions:R,forceRefetch:j,...lf(d.endpointDefinitions[y])?{initialPageParam:X}:{}}));re.current=ie}else R!==Z&&P.updateSubscriptionOptions(R)},[N,F,j,U,R,B,X,y]),[re,N,F,R]}function g(y,w){return(b,{skip:j=!1,selectFromResult:A}={})=>{const{select:E}=e.endpoints[y],C=hl(j?qr:b,l,d.endpointDefinitions[y],y),I=_.useRef(void 0),F=_.useMemo(()=>o([E(C),(O,X)=>X,O=>C],w,{memoizeOptions:{resultEqualityCheck:vi}}),[E,C]),N=_.useMemo(()=>A?o([F],A,{devModeChecks:{identityFunctionCheck:"never"}}):F,[F,A]),z=s(O=>N(O,I.current),vi),U=i(),R=F(U.getState(),I.current);return T1(()=>{I.current=R},[R]),z}}function f(y){_.useEffect(()=>()=>{var w,k;(k=(w=y.current)==null?void 0:w.unsubscribe)==null||k.call(w),y.current=void 0},[y])}function m(y){if(!y.current)throw new Error(wu(38));return y.current.refetch()}function v(y){const w=(j,A={})=>{const[E]=p(y,j,A);return f(E),_.useMemo(()=>({refetch:()=>m(E)}),[E])},k=({refetchOnReconnect:j,refetchOnFocus:A,pollingInterval:E=0,skipPollingIfUnfocused:C=!1}={})=>{const{initiate:I}=e.endpoints[y],F=r(),[N,z]=_.useState(dl),U=_.useRef(void 0),R=pa({refetchOnReconnect:j,refetchOnFocus:A,pollingInterval:E,skipPollingIfUnfocused:C});c(()=>{var D,q;const ee=(D=U.current)==null?void 0:D.subscriptionOptions;R!==ee&&((q=U.current)==null||q.updateSubscriptionOptions(R))},[R]);const O=_.useRef(R);c(()=>{O.current=R},[R]);const X=_.useCallback(function(ee,D=!1){let q;return t(()=>{var B;(B=U.current)==null||B.unsubscribe(),U.current=q=F(I(ee,{subscriptionOptions:O.current,forceRefetch:!D})),z(ee)}),q},[F,I]),re=_.useCallback(()=>{var ee,D;(ee=U.current)!=null&&ee.queryCacheKey&&F(e.internalActions.removeQueryResult({queryCacheKey:(D=U.current)==null?void 0:D.queryCacheKey}))},[F]);return _.useEffect(()=>()=>{var ee;(ee=U==null?void 0:U.current)==null||ee.unsubscribe()},[]),_.useEffect(()=>{N!==dl&&!U.current&&X(N,!0)},[N,X]),_.useMemo(()=>[X,N,{reset:re}],[X,N,re])},b=g(y,h);return{useQueryState:b,useQuerySubscription:w,useLazyQuerySubscription:k,useLazyQuery(j){const[A,E,{reset:C}]=k(j),I=b(E,{...j,skip:E===dl}),F=_.useMemo(()=>({lastArg:E}),[E]);return _.useMemo(()=>[A,{...I,reset:C},F],[A,I,C,F])},useQuery(j,A){const E=w(j,A),C=b(j,{selectFromResult:j===qr||A!=null&&A.skip?void 0:Hd,...A}),I=ul(C,...fl);return _.useDebugValue(I),_.useMemo(()=>({...C,...E}),[C,E])}}}function S(y){const w=(b,j={})=>{const[A,E,C,I]=p(y,b,j),F=_.useRef(I);c(()=>{F.current=I},[I]);const N=_.useCallback(function(R,O){let X;return t(()=>{var re;(re=A.current)==null||re.unsubscribe(),A.current=X=E(C(R,{subscriptionOptions:F.current,direction:O}))}),X},[A,E,C]);f(A);const z=hl(j.skip?qr:b,yo,d.endpointDefinitions[y],y),U=_.useCallback(()=>m(A),[A]);return _.useMemo(()=>({trigger:N,refetch:U,fetchNextPage:()=>N(z,"forward"),fetchPreviousPage:()=>N(z,"backward")}),[U,N,z])},k=g(y,x);return{useInfiniteQueryState:k,useInfiniteQuerySubscription:w,useInfiniteQuery(b,j){const{refetch:A,fetchNextPage:E,fetchPreviousPage:C}=w(b,j),I=k(b,{selectFromResult:b===qr||j!=null&&j.skip?void 0:Hd,...j}),F=ul(I,...fl,"hasNextPage","hasPreviousPage");return _.useDebugValue(F),_.useMemo(()=>({...I,fetchNextPage:E,fetchPreviousPage:C,refetch:A}),[I,E,C,A])}}}function T(y){return({selectFromResult:w,fixedCacheKey:k}={})=>{const{select:b,initiate:j}=e.endpoints[y],A=r(),[E,C]=_.useState();_.useEffect(()=>()=>{E!=null&&E.arg.fixedCacheKey||E==null||E.reset()},[E]);const I=_.useCallback(function(ee){const D=A(j(ee,{fixedCacheKey:k}));return C(D),D},[A,j,k]),{requestId:F}=E||{},N=_.useMemo(()=>b({fixedCacheKey:k,requestId:E==null?void 0:E.requestId}),[k,E,b]),z=_.useMemo(()=>w?o([N],w):N,[w,N]),U=s(z,vi),R=k==null?E==null?void 0:E.arg.originalArgs:void 0,O=_.useCallback(()=>{t(()=>{E&&C(void 0),k&&A(e.internalActions.removeMutationResult({requestId:F,fixedCacheKey:k}))})},[A,k,E,F]),X=ul(U,...fl,"endpointName");_.useDebugValue(X);const re=_.useMemo(()=>({...U,originalArgs:R,reset:O}),[U,R,O]);return _.useMemo(()=>[I,re],[I,re])}}}var k1=Symbol(),C1=({batch:e=ip,hooks:t={useDispatch:it,useSelector:$e,useStore:ap},createSelector:r=ju,unstable__sideEffectsInRender:s=!1,...i}={})=>({name:k1,init(a,{serializeQueryArgs:o},l){const d=a,{buildQueryHooks:c,buildInfiniteQueryHooks:h,buildMutationHook:x,usePrefetch:u}=_1({api:a,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:s,createSelector:r},serializeQueryArgs:o,context:l});return hi(d,{usePrefetch:u}),hi(l,{batch:e}),{injectEndpoint(p,g){if(y1(g)){const{useQuery:f,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:S,useQuerySubscription:T}=c(p);hi(d.endpoints[p],{useQuery:f,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:S,useQuerySubscription:T}),a[`use${xa(p)}Query`]=f,a[`useLazy${xa(p)}Query`]=m}if(v1(g)){const f=x(p);hi(d.endpoints[p],{useMutation:f}),a[`use${xa(p)}Mutation`]=f}else if(lf(g)){const{useInfiniteQuery:f,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}=h(p);hi(d.endpoints[p],{useInfiniteQuery:f,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}),a[`use${xa(p)}InfiniteQuery`]=f}}}}}),Oc=af(of(),C1());const A1="/api",Va=Oc({reducerPath:"exhibitorInvoiceApi",baseQuery:Rc({baseUrl:A1,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("exhibitor_token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["ExhibitorInvoice"],endpoints:e=>({getExhibitorInvoice:e.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,r,s)=>[{type:"ExhibitorInvoice",id:s}]}),downloadExhibitorInvoice:e.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:r})})})}),{useGetExhibitorInvoiceQuery:I1,useDownloadExhibitorInvoiceMutation:N1,useShareViaEmailMutation:F1,useShareViaWhatsAppMutation:R1}=Va,cf=({booking:e})=>{var E,C,I;const[t,r]=_.useState(null),[s,i]=_.useState(!0),a=$e(F=>F.settings.settings);_.useEffect(()=>{(async()=>{i(!0);try{if(e.exhibitionId.headerLogo){const N=e.exhibitionId.headerLogo;r(`${_e.defaults.baseURL}/public/uploads/${N}`),console.log("Using exhibition header logo:",N)}else if(a!=null&&a.logo){const N=a.logo;r(`${_e.defaults.baseURL}/public/uploads/${N}`),console.log("Using global settings logo:",N)}else{const N=`${_e.defaults.baseURL}/public/logo`;r(N),console.log("Using public logo endpoint:",N)}}catch(N){console.error("Error loading logo:",N),r(null)}finally{i(!1)}})()},[e.exhibitionId.headerLogo,a==null?void 0:a.logo]);const o=()=>{const F=new Date(e.exhibitionId.startDate||""),N=new Date(e.exhibitionId.endDate||""),z={};let U=new Date(F);for(;U<=N;){const O=U.toLocaleString("default",{month:"short",year:"numeric"});z[O]||(z[O]=[]),z[O].push(U.getDate().toString().padStart(2,"0")),U=new Date(U),U.setDate(U.getDate()+1)}const R=Object.entries(z).map(([O,X])=>`${X.join(", ")} ${O}`);return`${e.exhibitionId.name||"ABSE"} (${R.join(" & ")})`},l=F=>{const N=new Date(F);return{date:N.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:N.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},d=e.stallIds.map((F,N)=>{var O;const z=F,U=F.dimensions.width*F.dimensions.height,R=U*F.ratePerSqm;return{key:F._id,sn:N+1,stallNo:F.number,stallType:((O=z.stallTypeId)==null?void 0:O.name)||"Standard",dimensions:`${F.dimensions.width}x${F.dimensions.height}m`,area:U.toFixed(0),rate:F.ratePerSqm.toFixed(0),amount:R}}),c=d.reduce((F,N)=>F+N.amount,0),h=e.calculations,x=((E=h.stalls[0])==null?void 0:E.discount)!==void 0&&((C=h.stalls[0])==null?void 0:C.discount)!==null,u=x?(I=h.stalls[0])==null?void 0:I.discount:null,p=(u==null?void 0:u.type)||"percentage",g=(u==null?void 0:u.value)||0;let f=0;x&&g>0&&(p==="percentage"?f=Math.round(c*g/100*100)/100:p==="fixed"&&(f=Math.min(g,c)));const m=c-f,v=h.taxes.find(F=>F.name.includes("GST")),S=v?v.rate:18,T=Math.round(m*S/100*100)/100,y=m+T,w=c,k=f,b=m,j=T,A=y;return n.jsx("div",{className:"invoice-container",children:n.jsxs("div",{className:"proforma-invoice",children:[n.jsxs("div",{className:"header-section",children:[n.jsx("div",{className:"logo-cell",children:s?n.jsx("div",{className:"logo-loading",children:"Loading..."}):t?n.jsx("img",{src:t,alt:e.exhibitionId.companyName,className:"logo-image",onError:()=>r(null)}):e.exhibitionId.companyName}),n.jsxs("div",{className:"title-company",children:[n.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),n.jsx("div",{className:"company-cell",children:e.exhibitionId.companyName})]})]}),n.jsxs("div",{className:"bill-to-section",children:[n.jsx("div",{className:"bill-to-cell",children:"Bill To"}),n.jsxs("div",{className:"bill-to-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Company Name"}),n.jsx("div",{className:"value-cell",children:e.companyName}),n.jsx("div",{className:"date-label-cell",children:"Date"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).date})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Phone No."}),n.jsx("div",{className:"value-cell",children:e.customerPhone}),n.jsx("div",{className:"date-label-cell",children:"Time"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).time})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"GST No."}),n.jsx("div",{className:"value-cell",children:e.customerGSTIN}),n.jsx("div",{className:"date-label-cell",children:"Invoice No"}),n.jsx("div",{className:"date-value-cell",children:e.invoiceNumber})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Address"}),n.jsx("div",{className:"value-cell",children:e.customerAddress})]})]})]}),n.jsxs("div",{className:"expo-venue-section",children:[n.jsxs("div",{className:"expo-column",children:[n.jsx("div",{className:"heading",children:"Expo Name"}),n.jsx("div",{className:"content",children:o()})]}),n.jsxs("div",{className:"venue-column",children:[n.jsx("div",{className:"heading",children:"Venue"}),n.jsx("div",{className:"content",children:e.exhibitionId.venue})]})]}),n.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),n.jsxs("div",{className:"stall-table",children:[n.jsxs("div",{className:"stall-header",children:[n.jsx("div",{className:"stall-header-cell",children:"S/N"}),n.jsx("div",{className:"stall-header-cell",children:"Stall No."}),n.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),n.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),n.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),d.map(F=>n.jsxs("div",{className:"stall-row",children:[n.jsx("div",{className:"stall-cell",children:F.sn}),n.jsx("div",{className:"stall-cell",children:F.stallNo}),n.jsx("div",{className:"stall-cell",children:F.stallType}),n.jsx("div",{className:"stall-cell",children:F.dimensions}),n.jsx("div",{className:"stall-cell",children:F.area}),n.jsx("div",{className:"stall-cell",children:Number(F.rate).toLocaleString("en-IN")}),n.jsx("div",{className:"stall-cell",children:F.amount.toLocaleString("en-IN")})]},F.key))]}),n.jsx("div",{className:"section-header",children:"Calculation Summary"}),n.jsxs("div",{className:"calc-table",children:[n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),n.jsxs("div",{className:"calc-value",children:["",w.toLocaleString("en-IN")]})]}),x&&k>0&&n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:p==="percentage"?`Discount (${g}%)`:`Discount (Fixed ${g.toLocaleString("en-IN")})`}),n.jsxs("div",{className:"calc-value",children:["-",k.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:x&&k>0?"Amount after Discount":"Net Amount"}),n.jsxs("div",{className:"calc-value",children:["",b.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsxs("div",{className:"calc-label",children:["GST (",S,"%)"]}),n.jsxs("div",{className:"calc-value",children:["",j.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row total-row",children:[n.jsx("div",{className:"calc-label",children:"Total Amount"}),n.jsxs("div",{className:"calc-value",children:["",A.toLocaleString("en-IN")]})]})]}),n.jsxs("div",{className:"details-section",children:[n.jsxs("div",{className:"bank-details",children:[n.jsx("div",{className:"details-header",children:"Bank Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Bank Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Account No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccount})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccountName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Branch"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankBranch})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"IFSC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankIFSC})]})]}),n.jsxs("div",{className:"company-details",children:[n.jsx("div",{className:"details-header",children:"Company Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"CIN No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyCIN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Pan No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyPAN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"SAC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companySAC})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"GST No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyGST})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Email"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyEmail})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Website"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyWebsite})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Address"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyAddress})]})]})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"PI Instruction"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),n.jsx("div",{className:"signature-section",children:n.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},{Title:P1,Text:D1}=Le,L1=()=>{var k,b,j,A,E,C,I,F,N,z,U,R,O,X,re,ee,D,q,B;const{id:e}=Fr(),{data:t,isLoading:r,error:s}=I1(e||""),[i]=N1(),[a]=F1(),[o]=R1(),[l,d]=_.useState(!1),[c,h]=_.useState(!1),[x]=H.useForm(),[u]=H.useForm(),[p,g]=_.useState(0),[f,m]=_.useState(!1),v=async()=>{if(e)try{m(!0),g(0),je.loading({content:"Preparing invoice...",key:"download"});const Z=(()=>{let se=0;const ie=setInterval(()=>{se+=5,se<=90?(g(se),se%25===0&&je.loading({content:`Downloading: ${se}% complete`,key:"download"})):clearInterval(ie)},200);return ie})();try{const se=await i(e).unwrap();clearInterval(Z),g(100),je.loading({content:"Finalizing download...",key:"download"});const ie=URL.createObjectURL(se),de=document.createElement("a");de.href=ie,de.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||e||"download"}.pdf`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(ie),je.success({content:"Invoice downloaded successfully",key:"download"})}catch(se){throw clearInterval(Z),se}}catch(P){console.error("Error downloading PDF:",P),je.error({content:"Failed to download invoice",key:"download"})}finally{m(!1),setTimeout(()=>g(0),500)}},S=()=>{d(!0)},T=()=>{h(!0)},y=async P=>{try{await a({bookingId:e||"",email:P.email,message:P.message}).unwrap(),je.success(`Invoice sent to ${P.email}`),d(!1),x.resetFields()}catch(Z){console.error("Error sending email:",Z),je.error("Failed to send email")}},w=async P=>{try{await o({bookingId:e||"",phoneNumber:P.phoneNumber}).unwrap();const Z=P.phoneNumber.replace(/\D/g,""),se=encodeURIComponent(P.message);window.open(`https://wa.me/${Z}?text=${se}`,"_blank"),h(!1),u.resetFields()}catch(Z){console.error("Error opening WhatsApp:",Z),je.error("Failed to open WhatsApp")}};return r?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:n.jsx(Jr,{size:"large"})}):s||!t?n.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[n.jsx(P1,{level:3,children:"Invoice Not Found"}),n.jsx(D1,{children:"The requested invoice could not be loaded. Please try again later."})]}):n.jsxs(n.Fragment,{children:[n.jsxs(ue,{title:"Invoice Details",style:{margin:"20px"},children:[n.jsx(Ae,{gutter:[16,24],children:n.jsx(Q,{span:24,children:n.jsxs(xe,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(xe,{children:[n.jsx(ne,{icon:n.jsx(Po,{}),onClick:v,loading:f&&p<100,disabled:f&&p>=100,children:"Download PDF"}),n.jsx(ne,{icon:n.jsx(fn,{}),onClick:S,disabled:f,children:"Share via Email"}),n.jsx(ne,{icon:n.jsx(mu,{}),onClick:T,disabled:f,children:"Share via WhatsApp"})]}),f&&n.jsx(Kr,{percent:p,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),n.jsx(nt,{}),n.jsx(cf,{booking:{...t.bookingId,customerGSTIN:(k=t.bookingId)!=null&&k.customerGSTIN||((b=t.bookingId)==null?void 0:b.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(j=t.bookingId)!=null&&j.customerAddress||((A=t.bookingId)==null?void 0:A.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((E=t.bookingId.exhibitionId)==null?void 0:E.companyName)||"",bankName:((C=t.bookingId.exhibitionId)==null?void 0:C.bankName)||"",bankAccount:((I=t.bookingId.exhibitionId)==null?void 0:I.bankAccount)||"",bankAccountName:((F=t.bookingId.exhibitionId)==null?void 0:F.bankAccountName)||"",bankBranch:((N=t.bookingId.exhibitionId)==null?void 0:N.bankBranch)||"",bankIFSC:((z=t.bookingId.exhibitionId)==null?void 0:z.bankIFSC)||"",companyCIN:((U=t.bookingId.exhibitionId)==null?void 0:U.companyCIN)||"",companyPAN:((R=t.bookingId.exhibitionId)==null?void 0:R.companyPAN)||"",companySAC:((O=t.bookingId.exhibitionId)==null?void 0:O.companySAC)||"",companyGST:((X=t.bookingId.exhibitionId)==null?void 0:X.companyGST)||"",companyEmail:((re=t.bookingId.exhibitionId)==null?void 0:re.companyEmail)||"",companyWebsite:((ee=t.bookingId.exhibitionId)==null?void 0:ee.companyWebsite)||"",companyAddress:((D=t.bookingId.exhibitionId)==null?void 0:D.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((B=(q=t.bookingId.calculations)==null?void 0:q.stalls)==null?void 0:B.map(P=>({...P,discount:P.discount?{...P.discount,type:P.discount.type||"percentage",value:P.discount.value}:void 0})))||[]}}})]}),n.jsx(Ve,{title:"Share Invoice via Email",visible:l,onCancel:()=>d(!1),footer:null,children:n.jsxs(H,{form:x,layout:"vertical",onFinish:y,children:[n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(fe,{placeholder:"example@example.com"})}),n.jsx(H.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(fe.TextArea,{rows:4})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ve,{title:"Share Invoice via WhatsApp",visible:c,onCancel:()=>h(!1),footer:null,children:n.jsxs(H,{form:u,layout:"vertical",onFinish:w,children:[n.jsx(H.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:n.jsx(fe,{placeholder:"+1234567890"})}),n.jsx(H.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(fe.TextArea,{rows:4})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Vd,Text:Gd}=Le,{TabPane:Yd}=Kt,O1=()=>{var f;const{notification:e}=Xt.useApp(),[t]=H.useForm(),[r]=H.useForm(),[s,i]=_.useState(!1),[a,o]=_.useState(!1),[l,d]=_.useState(!1),[c,h]=_.useState(null),x=it(),u=$e(m=>m.auth.user);_.useEffect(()=>{(async()=>{try{d(!0);const v=await po.getProfile();v.data&&x(Iu({user:v.data,token:localStorage.getItem("token")||""}))}catch{je.error("Failed to fetch profile")}finally{d(!1)}})()},[x]);const p=async m=>{var v,S;try{h(null),o(!0),await po.changePassword({currentPassword:m.currentPassword,newPassword:m.newPassword}),e.success({message:"Success",description:"Password has been changed successfully"}),r.resetFields()}catch(T){h(((S=(v=T.response)==null?void 0:v.data)==null?void 0:S.message)||"Failed to change password. Please try again.")}finally{o(!1)}},g=()=>u!=null&&u.role?typeof u.role=="string"?u.role:typeof u.role=="object"&&"name"in u.role?u.role.name:"User":"User";return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ae,{gutter:[24,24],align:"middle",children:n.jsxs(Q,{flex:"auto",children:[n.jsx(Vd,{level:4,children:"My Account"}),n.jsx(Gd,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),n.jsx(ue,{loading:l,children:n.jsxs(Kt,{defaultActiveKey:"account",children:[n.jsx(Yd,{tab:"Account Information",children:n.jsxs(Ae,{gutter:32,children:[n.jsx(Q,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Mr,{size:100,icon:n.jsx(at,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((f=u==null?void 0:u.username)==null?void 0:f.charAt(0).toUpperCase())||"U"}),n.jsx(Vd,{level:4,children:u==null?void 0:u.username}),n.jsx(Gd,{type:"secondary",children:g()})]})}),n.jsx(Q,{span:18,children:n.jsx(H,{layout:"vertical",initialValues:{username:u==null?void 0:u.username,email:u==null?void 0:u.email},disabled:!0,children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:n.jsx(fe,{prefix:n.jsx(at,{}),placeholder:"Username"})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{prefix:n.jsx(fn,{}),placeholder:"Email Address"})})})]})})})]})},"account"),n.jsxs(Yd,{tab:"Change Password",children:[c&&n.jsx(kt,{message:"Error",description:c,type:"error",showIcon:!0,style:{marginBottom:24}}),n.jsxs(H,{form:r,layout:"vertical",onFinish:p,children:[n.jsx(H.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Current Password"})}),n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:m})=>({validator(v,S){return!S||m("newPassword")===S?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm New Password"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",loading:a,icon:n.jsx(fs,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:_s}=Pe,{Title:B1,Text:M1}=Le,$1=()=>{const e=it(),{message:t}=Xt.useApp(),[r]=H.useForm(),{settings:s,loading:i}=$e(u=>u.settings),[a,o]=_.useState([]),[l,d]=_.useState(0);_.useEffect(()=>{e(bi())},[e]),_.useEffect(()=>{if(s&&(r.setFieldsValue({siteName:s.siteName,adminEmail:s.adminEmail,language:s.language,timezone:s.timezone,emailNotifications:s.emailNotifications,footerText:s.footerText}),s.logo)){const u=f=>{const m=localStorage.getItem("token");return{url:`${_e.defaults.baseURL}/uploads/${f}`,token:m}},{url:p,token:g}=u(s.logo);fetch(p,{headers:{authorization:`Bearer ${g}`}}).then(f=>f.blob()).then(f=>{var v;const m=URL.createObjectURL(f);o([{uid:"-1",name:((v=s.logo)==null?void 0:v.split("/").pop())||"logo",status:"done",url:m,thumbUrl:m,type:f.type,response:{path:s.logo}}])}).catch(()=>{o([])})}},[s,r]);const c=u=>{e(wi(u)).unwrap().then(()=>t.success("Settings updated successfully")).catch(p=>t.error(`Failed to update settings: ${p}`))},h={name:"file",action:`${_e.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:a,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(u){const{status:p,name:g,response:f,uid:m}=u.file;if(p==="uploading"){o([...u.fileList]);return}if(p==="done"&&f){d(0);const v=localStorage.getItem("token"),S=`${_e.defaults.baseURL}/uploads/${f.path}`;fetch(S,{headers:{authorization:`Bearer ${v}`}}).then(T=>T.blob()).then(T=>{const y=URL.createObjectURL(T);o([{uid:u.file.uid,name:g,status:"done",url:y,thumbUrl:y,type:T.type,response:f}]),t.success(`${g} uploaded successfully`),r.setFieldValue("logo",f.path)}).catch(()=>{t.error(`${g} preview failed to load`),o([])})}else p==="error"?(t.error(`${g} upload failed.`),o([]),d(0)):p==="removed"&&(o([]),r.setFieldValue("logo",null),d(0))},onRemove(){return o([]),r.setFieldValue("logo",null),d(0),!0},customRequest:async({file:u,onSuccess:p,onError:g,onProgress:f})=>{try{e(Ha(u)).unwrap().then(m=>{p&&p(m)}).catch(m=>{g&&g(new Error(m))})}catch(m){g&&g(m)}}},x=n.jsx("div",{children:l>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Kr,{type:"circle",percent:l,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ae,{gutter:[24,24],align:"middle",children:n.jsx(Q,{flex:"auto",children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(B1,{level:4,style:{margin:0},children:"Settings"}),n.jsx(M1,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),n.jsx(ue,{className:"info-card",children:n.jsxs(H,{form:r,layout:"vertical",onFinish:c,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[n.jsxs(Ae,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(H.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{label:"Language",name:"language",children:n.jsxs(Pe,{children:[n.jsx(_s,{value:"en",children:"English"}),n.jsx(_s,{value:"es",children:"Spanish"}),n.jsx(_s,{value:"fr",children:"French"})]})}),n.jsx(H.Item,{label:"Timezone",name:"timezone",children:n.jsxs(Pe,{children:[n.jsx(_s,{value:"UTC",children:"UTC"}),n.jsx(_s,{value:"EST",children:"EST"}),n.jsx(_s,{value:"PST",children:"PST"})]})}),n.jsx(H.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:n.jsx(Ir,{})})]}),n.jsxs(Q,{span:12,children:[n.jsxs(H.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Ri,{...h,children:a.length<1&&x}),a.length>0&&l>0&&n.jsx(Kr,{percent:l,status:"active",style:{marginTop:8}})]}),n.jsx(H.Item,{label:"Footer Text",name:"footerText",children:n.jsx(fe.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),n.jsx(H.Item,{children:n.jsxs(xe,{children:[n.jsx(ne,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:i,children:"Save Settings"}),n.jsx(ne,{onClick:()=>r.resetFields(),icon:n.jsx(jx,{}),children:"Reset"})]})})]})})]})},U1=async()=>{try{return(await _e.get("/roles")).data}catch(e){throw console.error("Error fetching roles:",e),e}},z1=async e=>{try{return(await _e.get(`/roles/${e}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},q1=async e=>{try{return(await _e.post("/roles",e)).data}catch(t){throw console.error("Error creating role:",t),t}},W1=async(e,t)=>{try{return(await _e.put(`/roles/${e}`,t)).data}catch(r){throw console.error("Error updating role:",r),r}},H1=async e=>{try{await _e.delete(`/roles/${e}`)}catch(t){throw console.error("Error deleting role:",t),t}},V1={roles:[],role:null,loading:!1,error:null},qs=Qe("roles/fetchRoles",async(e,{rejectWithValue:t})=>{var r,s;try{return await U1()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch roles")}}),xl=Qe("roles/fetchRoleById",async(e,{rejectWithValue:t})=>{var r,s;try{return await z1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch role")}}),Ga=Qe("roles/addRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await q1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create role")}}),Ya=Qe("roles/modifyRole",async({id:e,roleData:t},{rejectWithValue:r})=>{var s,i;try{return await W1(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update role")}}),Ka=Qe("roles/removeRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await H1(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete role")}}),df=gr({name:"roles",initialState:V1,reducers:{clearRoleError:e=>{e.error=null},setSelectedRole:(e,t)=>{e.role=t.payload}},extraReducers:e=>{e.addCase(qs.pending,t=>{t.loading=!0,t.error=null}).addCase(qs.fulfilled,(t,r)=>{t.loading=!1,t.roles=r.payload}).addCase(qs.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(xl.pending,t=>{t.loading=!0,t.error=null}).addCase(xl.fulfilled,(t,r)=>{t.loading=!1,t.role=r.payload}).addCase(xl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ga.pending,t=>{t.loading=!0,t.error=null}).addCase(Ga.fulfilled,(t,r)=>{t.loading=!1,t.roles.push(r.payload)}).addCase(Ga.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ya.pending,t=>{t.loading=!0,t.error=null}).addCase(Ya.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.roles.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.roles[s]=r.payload),((i=t.role)==null?void 0:i._id)===r.payload._id&&(t.role=r.payload)}).addCase(Ya.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ka.pending,t=>{t.loading=!0,t.error=null}).addCase(Ka.fulfilled,(t,r)=>{var s;t.loading=!1,t.roles=t.roles.filter(i=>i._id!==r.payload),((s=t.role)==null?void 0:s._id)===r.payload&&(t.role=null)}).addCase(Ka.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearRoleError:Uk,setSelectedRole:zk}=df.actions,G1=df.reducer,{Text:Kd}=Le,Y1=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],pl=Y1.reduce((e,t)=>(e[t.group]||(e[t.group]=[]),e[t.group].push({key:t.key,label:t.label}),e),{}),K1=({visible:e,onCancel:t,onSave:r,role:s,loading:i})=>{const[a]=H.useForm(),o=!!s,[l,d]=_.useState([]);_.useEffect(()=>{if(e)if(s){const g=s.permissions||[];a.setFieldsValue({name:s.name,description:s.description,permissions:g}),d(g)}else a.resetFields(),d([])},[e,s,a]);const c=()=>{a.setFieldsValue({permissions:l}),a.validateFields().then(g=>{r(g)})},h=g=>{const f=pl[g].map(m=>m.key);return f.length>0&&f.every(m=>l.includes(m))},x=(g,f)=>{let m;f?m=[...l,g]:m=l.filter(v=>v!==g),d(m)},u=(g,f)=>{const m=pl[g].map(S=>S.key);let v;if(f){const S=m.filter(T=>!l.includes(T));v=[...l,...S]}else v=l.filter(S=>!m.includes(S));d(v)},p=g=>l.includes(g);return n.jsx(Ve,{title:o?"Edit Role":"Add New Role",open:e,onCancel:t,width:700,footer:[n.jsx(ne,{onClick:t,children:"Cancel"},"cancel"),n.jsx(ne,{type:"primary",loading:i,onClick:c,children:o?"Update":"Create"},"submit")],children:n.jsxs(H,{form:a,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[n.jsx(H.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:n.jsx(fe,{placeholder:"e.g., Administrator, Editor, Viewer"})}),n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:n.jsx(fe.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),n.jsx(nt,{plain:!0,children:"Permissions"}),n.jsx(H.Item,{name:"permissions",hidden:!0,children:n.jsx(fe,{})}),n.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(pl).map(([g,f])=>n.jsx(ue,{size:"small",title:n.jsxs(xe,{children:[n.jsx(Kd,{strong:!0,children:g}),n.jsx(Ql,{checked:h(g),onChange:m=>u(g,m.target.checked),children:"Select All"})]}),style:{marginBottom:16},children:n.jsx(Ae,{gutter:[16,12],children:f.map(m=>n.jsx(Q,{span:12,children:n.jsx(Ql,{checked:p(m.key),onChange:v=>x(m.key,v.target.checked),children:n.jsx(Kd,{children:m.label})})},m.key))})},g))})]})})},zo=()=>{const{user:e}=$e(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Title:ma,Paragraph:Xd,Text:ks}=Le,{confirm:X1}=Ve;function ml({allowed:e}){return e?n.jsx(vc,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):n.jsx(Sx,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function Q1(){const{message:e,notification:t}=Xt.useApp(),r=it(),{roles:s,loading:i,error:a}=$e(b=>b.role),[o,l]=_.useState(""),[d,c]=_.useState(!1),[h,x]=_.useState(null),{hasPermission:u}=zo();_.useEffect(()=>{r(qs())},[r]),_.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]);const p=()=>{x(null),c(!0)},g=b=>{x(b),c(!0)},f=b=>{h?r(Ya({id:h._id,roleData:b})).unwrap().then(()=>{c(!1),e.success("Role updated successfully")}).catch(j=>{e.error(`Failed to update role: ${j.message}`)}):r(Ga(b)).unwrap().then(()=>{c(!1),e.success("Role created successfully")}).catch(j=>{e.error(`Failed to create role: ${j.message}`)})},m=b=>{X1({title:"Are you sure you want to delete this role?",icon:n.jsx(Qs,{}),content:`This will permanently delete the ${b.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){r(Ka(b._id)).unwrap().then(()=>{e.success(`${b.name} role deleted successfully`)}).catch(j=>{e.error(`Failed to delete role: ${j.message}`)})}})},v=[{title:"Role",dataIndex:"name",key:"name",render:(b,j)=>n.jsxs(xe,{children:[n.jsx(Mr,{style:{backgroundColor:w(j.name)},children:b.charAt(0).toUpperCase()}),n.jsx(ks,{strong:!0,children:b})]})},{title:"Description",dataIndex:"description",key:"description",render:b=>n.jsx(ks,{type:"secondary",children:b})},{title:"Read",key:"read",align:"center",render:(b,j)=>n.jsx(ml,{allowed:S(j)})},{title:"Write",key:"write",align:"center",render:(b,j)=>n.jsx(ml,{allowed:T(j)})},{title:"Delete",key:"delete",align:"center",render:(b,j)=>n.jsx(ml,{allowed:y(j)})},{title:"Actions",key:"actions",align:"right",render:(b,j)=>n.jsxs(xe,{children:[u("roles_edit")&&n.jsx(ct,{title:j.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:n.jsx(ne,{type:"primary",shape:"circle",icon:n.jsx(as,{}),size:"small",onClick:()=>g(j),disabled:j.name==="Administrator"})}),u("roles_delete")&&n.jsx(ct,{title:"Delete role",children:n.jsx(ne,{danger:!0,shape:"circle",icon:n.jsx(or,{}),size:"small",onClick:()=>m(j),disabled:j.name==="Administrator"})})]})}],S=b=>b.permissions.some(j=>j.endsWith("_view")),T=b=>b.permissions.some(j=>j.endsWith("_create")||j.endsWith("_edit")),y=b=>b.permissions.some(j=>j.endsWith("_delete")),w=b=>{const j=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let A=0;for(let E=0;E<b.length;E++)A=b.charCodeAt(E)+((A<<5)-A);return j[Math.abs(A)%j.length]},k=s.filter(b=>b.name.toLowerCase().includes(o.toLowerCase())||b.description.toLowerCase().includes(o.toLowerCase()));return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(ma,{level:2,children:"Roles & Permissions"}),n.jsx(Xd,{children:"Manage role-based access control and permissions for your users."})]}),n.jsxs(ue,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:i&&s.length===0,children:[n.jsxs(Ae,{gutter:16,style:{marginBottom:16},children:[n.jsx(Q,{span:16,children:n.jsx(fe,{placeholder:"Search roles...",allowClear:!0,value:o,onChange:b=>l(b.target.value),prefix:n.jsx(ks,{type:"secondary",style:{fontSize:16},children:""})})}),n.jsx(Q,{span:8,style:{textAlign:"right"},children:u("roles_create")&&n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),style:{borderRadius:6},onClick:p,children:"Add Role"})})]}),n.jsx(tt,{columns:v,dataSource:k,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(b,j)=>`Showing ${j[0]}-${j[1]} of ${b} roles`},style:{marginTop:8},loading:i&&s.length>0})]}),n.jsx(ue,{title:n.jsx(ma,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[n.jsxs(xe,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ma,{level:5,children:"Best Practices"}),n.jsxs("ul",{style:{paddingLeft:20},children:[n.jsx("li",{children:n.jsx(ks,{children:"Follow the principle of least privilege"})}),n.jsx("li",{children:n.jsx(ks,{children:"Regularly audit user roles"})}),n.jsx("li",{children:n.jsx(ks,{children:"Document role responsibilities"})})]})]}),n.jsxs(xe,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ma,{level:5,children:"Role Inheritance"}),n.jsx(Xd,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),n.jsx(K1,{visible:d,onCancel:()=>c(!1),onSave:f,role:h,loading:i})]})}const J1=async()=>{try{return(await _e.get("/users")).data}catch(e){throw console.error("Error fetching users:",e),e}},Z1=async e=>{try{return(await _e.get(`/users/${e}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},ey=async e=>{try{return(await _e.post("/users",e)).data}catch(t){throw console.error("Error creating user:",t),t}},ty=async(e,t)=>{try{return(await _e.put(`/users/${e}`,t)).data}catch(r){throw console.error("Error updating user:",r),r}},ry=async e=>{try{await _e.delete(`/users/${e}`)}catch(t){throw console.error("Error deleting user:",t),t}},ny={users:[],selectedUser:null,loading:!1,error:null},ss=Qe("users/fetchUsers",async(e,{rejectWithValue:t})=>{var r,s;try{return await J1()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch users")}}),gl=Qe("users/fetchUserById",async(e,{rejectWithValue:t})=>{var r,s;try{return await Z1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch user")}}),Xa=Qe("users/addUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await ey(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create user")}}),Qa=Qe("users/modifyUser",async({id:e,userData:t},{rejectWithValue:r})=>{var s,i;try{return await ty(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update user")}}),Ja=Qe("users/removeUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await ry(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete user")}}),hf=gr({name:"users",initialState:ny,reducers:{clearUserError:e=>{e.error=null},setSelectedUser:(e,t)=>{e.selectedUser=t.payload}},extraReducers:e=>{e.addCase(ss.pending,t=>{t.loading=!0,t.error=null}).addCase(ss.fulfilled,(t,r)=>{t.loading=!1,t.users=r.payload}).addCase(ss.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(gl.pending,t=>{t.loading=!0,t.error=null}).addCase(gl.fulfilled,(t,r)=>{t.loading=!1,t.selectedUser=r.payload}).addCase(gl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Xa.pending,t=>{t.loading=!0,t.error=null}).addCase(Xa.fulfilled,(t,r)=>{t.loading=!1,t.users.push(r.payload)}).addCase(Xa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Qa.pending,t=>{t.loading=!0,t.error=null}).addCase(Qa.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.users.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.users[s]=r.payload),((i=t.selectedUser)==null?void 0:i._id)===r.payload._id&&(t.selectedUser=r.payload)}).addCase(Qa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ja.pending,t=>{t.loading=!0,t.error=null}).addCase(Ja.fulfilled,(t,r)=>{var s;t.loading=!1,t.users=t.users.filter(i=>i._id!==r.payload),((s=t.selectedUser)==null?void 0:s._id)===r.payload&&(t.selectedUser=null)}).addCase(Ja.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearUserError:qk,setSelectedUser:ga}=hf.actions,sy=hf.reducer,{Text:iy}=Le,ay=({visible:e,user:t,onClose:r})=>{if(!t)return null;const s=i=>typeof i=="string"?i:i&&typeof i=="object"&&i.name?i.name:"Unknown";return n.jsxs(Ve,{title:"User Details",open:e,onCancel:r,footer:null,width:600,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[n.jsx(Mr,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#1677ff"}}),n.jsxs("div",{style:{marginLeft:20},children:[n.jsx(iy,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),n.jsxs("div",{children:[n.jsx(Te,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),n.jsx(Te,{color:"blue",children:s(t.role)})]})]})]}),n.jsx(nt,{}),n.jsxs(We,{bordered:!0,column:1,children:[n.jsx(We.Item,{label:"Username",children:t.username}),n.jsx(We.Item,{label:"Email",children:t.email}),n.jsx(We.Item,{label:"Role",children:s(t.role)}),n.jsx(We.Item,{label:"Status",children:n.jsx(Te,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),n.jsx(We.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),n.jsx(We.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:ya}=Pe,{Text:oy}=Le,ly=({visible:e,user:t,onClose:r,onSuccess:s})=>{const{message:i}=Xt.useApp(),[a]=H.useForm(),o=it(),{roles:l,loading:d}=$e(x=>x.role),{loading:c}=$e(x=>x.user);_.useEffect(()=>{e&&t&&a.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:typeof t.role=="object"?t.role._id:t.role,isActive:t.isActive})},[e,t,a]),_.useEffect(()=>{e&&o(qs())},[e,o]);const h=async()=>{if(t)try{const x=await a.validateFields(),u={username:x.username,name:x.name,email:x.email,role:x.role,isActive:x.isActive};x.password&&x.password.trim()!==""&&(u.password=x.password),o(Qa({id:t._id,userData:u})).unwrap().then(()=>{i.success("User updated successfully"),s(),r()}).catch(p=>{i.error(`Failed to update user: ${p}`)})}catch(x){console.error("Validation error:",x)}};return t?n.jsx(Ve,{title:"Edit User",open:e,onCancel:r,width:600,footer:[n.jsx(ne,{onClick:r,children:"Cancel"},"cancel"),n.jsx(ne,{type:"primary",loading:c,onClick:h,children:"Update User"},"submit")],children:n.jsxs(H,{form:a,layout:"vertical",children:[n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(fe,{placeholder:"Username"})}),n.jsx(H.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:n.jsx(fe,{placeholder:"Full name"})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{placeholder:"Email address"})}),n.jsx(nt,{children:n.jsx(oy,{type:"secondary",children:"Change Password (Optional)"})}),n.jsx(H.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(fe.Password,{placeholder:"New password (optional)"})}),n.jsx(nt,{}),n.jsx(H.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Pe,{loading:d,children:l.length>0?l.map(x=>n.jsx(ya,{value:x._id,children:x.name},x._id)):n.jsxs(n.Fragment,{children:[n.jsx(ya,{value:"admin",children:"Admin"}),n.jsx(ya,{value:"manager",children:"Manager"}),n.jsx(ya,{value:"agent",children:"Agent"})]})})}),n.jsx(H.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:va}=Pe,{Text:Wk}=Le,cy=({visible:e,onClose:t,onSuccess:r})=>{const{message:s}=Xt.useApp(),[i]=H.useForm(),a=it(),{roles:o,loading:l}=$e(h=>h.role),{loading:d}=$e(h=>h.user);_.useEffect(()=>{e&&a(qs())},[e,a]),_.useEffect(()=>{e&&i.resetFields()},[e,i]);const c=async()=>{try{const h=await i.validateFields(),x={username:h.username,name:h.name,email:h.email,password:h.password,role:h.role,isActive:h.status};a(Xa(x)).unwrap().then(u=>{s.success("User created successfully"),i.resetFields(),r(),t()}).catch(u=>{s.error(`Failed to create user: ${u}`)})}catch(h){console.error("Validation error:",h)}};return n.jsx(Ve,{title:"Create New User",open:e,onCancel:t,width:600,footer:[n.jsx(ne,{onClick:t,children:"Cancel"},"cancel"),n.jsx(ne,{type:"primary",loading:d,onClick:c,children:"Create User"},"submit")],children:n.jsxs(H,{form:i,layout:"vertical",requiredMark:!1,children:[n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(fe,{placeholder:"Username"})}),n.jsx(H.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:n.jsx(fe,{placeholder:"Full name"})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{placeholder:"Email address"})}),n.jsx(H.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(fe.Password,{placeholder:"Enter password"})}),n.jsx(nt,{}),n.jsx(H.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Pe,{placeholder:"Select role",loading:l,children:o.length>0?o.map(h=>n.jsx(va,{value:h._id,children:h.name},h._id)):n.jsxs(n.Fragment,{children:[n.jsx(va,{value:"admin",children:"Admin"}),n.jsx(va,{value:"manager",children:"Manager"}),n.jsx(va,{value:"agent",children:"Agent"})]})})}),n.jsx(H.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:dy,Paragraph:hy,Text:ui}=Le,{TabPane:yl}=Kt,{confirm:uy}=Ve;function fy(){const{message:e,notification:t}=Xt.useApp(),r=it(),{users:s,loading:i,error:a,selectedUser:o}=$e(I=>I.user),[l,d]=_.useState(""),[c,h]=_.useState("all"),[x,u]=_.useState(!1),[p,g]=_.useState(!1),[f,m]=_.useState(!1),{hasPermission:v}=zo();_.useEffect(()=>{r(ss())},[r]),_.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]),_.useEffect(()=>{o||(u(!1),g(!1))},[o]);const S=(I,F)=>{uy({title:"Are you sure you want to delete this user?",icon:n.jsx(Qs,{}),content:`This will permanently delete ${F}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{r(Ja(I)).unwrap().then(()=>{e.success(`${F} has been deleted successfully.`)}).catch(N=>{e.error(`Failed to delete user: ${N}`)})}})},T=I=>{r(ga(I)),u(!0)},y=I=>{r(ga(I)),g(!0)},w=()=>{m(!0)},k=[{title:"User",key:"user",render:(I,F)=>n.jsxs(xe,{children:[n.jsx(Mr,{icon:n.jsx(at,{}),size:"large"}),n.jsxs(xe,{direction:"vertical",size:0,children:[n.jsx(ui,{strong:!0,children:F.name||F.username}),n.jsx(ui,{type:"secondary",style:{fontSize:"12px"},children:F.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:I=>{const F=A(I);let N=F.toLowerCase()==="admin"||F.toLowerCase()==="administrator"?"#1677ff":F.toLowerCase()==="manager"?"#52c41a":"#faad14";return n.jsx(Te,{color:N,style:{fontWeight:500,borderRadius:"4px"},children:F.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(I,F)=>A(F.role).toLowerCase().indexOf(I.toLowerCase())===0},{title:"Status",key:"status",render:(I,F)=>n.jsx(xe,{children:F.isActive?n.jsx(xr,{status:"success",text:n.jsx(ui,{style:{color:"#52c41a"},children:"Active"})}):n.jsx(xr,{status:"default",text:n.jsx(ui,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(I,F)=>F.isActive===I},{title:"Last Active",key:"lastLogin",render:(I,F)=>n.jsxs(xe,{children:[n.jsx(Yt,{style:{color:"#8c8c8c"}}),n.jsx(ui,{type:"secondary",children:F.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(I,F)=>n.jsxs(xe,{size:"small",children:[v("users_view")&&n.jsx(ct,{title:"View details",children:n.jsx(ne,{type:"text",icon:n.jsx(hn,{}),size:"small",onClick:()=>T(F)})}),v("users_edit")&&n.jsx(ct,{title:"Edit user",children:n.jsx(ne,{type:"text",icon:n.jsx(as,{}),size:"small",onClick:()=>y(F)})}),v("users_delete")&&n.jsx(ct,{title:"Delete user",children:n.jsx(ne,{type:"text",danger:!0,icon:n.jsx(or,{}),size:"small",onClick:()=>S(F._id,F.name||F.username)})})]})}],b=I=>I.isActive?"active":"inactive",j=s.filter(I=>(c==="all"||c==="active"&&b(I)==="active"||c==="inactive"&&b(I)==="inactive")&&Object.values(I).some(F=>typeof F=="string"&&F.toLowerCase().includes(l.toLowerCase()))),A=I=>typeof I=="string"?I:I&&typeof I=="object"&&I.name?I.name:"Unknown",E={admin:s.filter(I=>{const F=A(I.role).toLowerCase();return F==="admin"||F==="administrator"}).length,manager:s.filter(I=>A(I.role).toLowerCase()==="manager").length,agent:s.filter(I=>A(I.role).toLowerCase()==="agent").length},C={active:s.filter(I=>I.isActive).length,inactive:s.filter(I=>!I.isActive).length};return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(dy,{level:2,children:"User Management"}),n.jsx(hy,{children:"Manage user accounts, permissions, and access control."})]}),n.jsxs(Ae,{gutter:[16,16],style:{marginBottom:24},children:[n.jsx(Q,{xs:24,sm:8,children:n.jsx(ue,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Total Users",value:s.length,prefix:n.jsx(at,{}),valueStyle:{color:"#1677ff"},loading:i})})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(ue,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Active Users",value:C.active,prefix:n.jsx(vc,{}),valueStyle:{color:"#52c41a"},loading:i})})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(ue,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Admin Users",value:E.admin,prefix:n.jsx(at,{}),valueStyle:{color:"#faad14"},loading:i})})})]}),n.jsx(ue,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs(Ae,{gutter:[16,16],justify:"space-between",align:"middle",children:[n.jsx(Q,{xs:24,md:12,children:n.jsx(fe,{placeholder:"Search users...",prefix:n.jsx(An,{style:{color:"rgba(0,0,0,.45)"}}),onChange:I=>d(I.target.value),allowClear:!0,size:"middle"})}),n.jsx(Q,{xs:24,md:12,style:{textAlign:"right"},children:n.jsxs(xe,{wrap:!0,children:[n.jsx(ct,{title:"Refresh data",children:n.jsx(ne,{icon:i?n.jsx(Ex,{}):n.jsx(An,{}),onClick:()=>r(ss()),disabled:i,children:"Refresh"})}),n.jsx(ne,{type:"primary",icon:n.jsx(Ni,{}),onClick:w,children:"Add User"})]})})]})}),n.jsxs(ue,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[n.jsxs(Kt,{defaultActiveKey:"all",onChange:h,tabBarStyle:{marginBottom:24},children:[n.jsx(yl,{tab:`All Users (${s.length})`},"all"),n.jsx(yl,{tab:`Active (${C.active})`},"active"),n.jsx(yl,{tab:`Inactive (${C.inactive})`},"inactive")]}),n.jsx(tt,{columns:k,dataSource:j,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(I,F)=>`${F[0]}-${F[1]} of ${I} users`},loading:i})]}),n.jsx(ay,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:x,onClose:()=>r(ga(null))}),n.jsx(ly,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:p,onClose:()=>r(ga(null)),onSuccess:()=>r(ss())}),n.jsx(cy,{visible:f,onClose:()=>m(!1),onSuccess:()=>r(ss())})]})}const{Title:Hk,Text:ba,Paragraph:fi}=Le,xy=({settings:e,onSave:t,loading:r})=>{const[s]=H.useForm();xt.useEffect(()=>{s.setFieldsValue(e)},[e,s]);const i=a=>{t(a)};return n.jsxs(ue,{title:n.jsxs(xe,{children:[n.jsx(fn,{}),n.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[n.jsx(fi,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),n.jsx(kt,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),n.jsxs(H,{form:s,layout:"vertical",initialValues:e,onFinish:i,children:[n.jsxs(Ae,{gutter:[24,16],children:[n.jsxs(Q,{span:24,children:[n.jsx(H.Item,{name:"newLeads",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"New Lead Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),n.jsxs(Q,{span:24,children:[n.jsx(H.Item,{name:"followUpReminders",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Follow-up Reminders"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),n.jsxs(Q,{span:24,children:[n.jsx(H.Item,{name:"statusChanges",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Status Change Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),n.jsxs(Q,{span:24,children:[n.jsx(H.Item,{name:"leadAssignments",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Lead Assignment Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),n.jsx(nt,{}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:r,children:"Save Email Preferences"})})]})]})},vl=e=>{switch(e){case"NEW_BOOKING":return Pt.NEW_BOOKING;case"BOOKING_CONFIRMED":return Pt.BOOKING_CONFIRMED;case"BOOKING_CANCELLED":return Pt.BOOKING_CANCELLED;case"PAYMENT_RECEIVED":return Pt.PAYMENT_RECEIVED;case"INVOICE_GENERATED":return Pt.INVOICE_GENERATED;case"EXHIBITION_UPDATE":return Pt.EXHIBITION_UPDATE;case"SYSTEM_MESSAGE":return Pt.SYSTEM_MESSAGE;case"EXHIBITOR_MESSAGE":return Pt.EXHIBITOR_MESSAGE;case"EXHIBITOR_REGISTERED":return Pt.EXHIBITOR_REGISTERED;default:return Pt.SYSTEM_MESSAGE}},{Title:py,Text:Vk,Paragraph:Qd}=Le,{Search:my}=fe,{TabPane:Jd}=Kt,gy=()=>{const e=Je();Fr();const[t,r]=_.useState([]),[s,i]=_.useState([]),[a,o]=_.useState(!1),[l,d]=_.useState(""),[c,h]=_.useState("ALL"),[x,u]=_.useState("ALL"),[p,g]=_.useState({newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0}),[f,m]=_.useState(!1),[v,S]=_.useState("all");_.useEffect(()=>{const z=localStorage.getItem("token");z&&pt.init(z,!1),T(),pt.subscribeToNotifications();const U=O=>{const X={...O,type:vl(O.type)};r(re=>re.some(ee=>ee._id===O._id)?re:[X,...re])},R=O=>{if(O.newNotifications&&O.newNotifications.length>0){const X=O.newNotifications.map(re=>({...re,type:vl(re.type)}));r(re=>[...X.filter(D=>!re.some(q=>q._id===D._id)),...re])}};return pt.addEventListener("notification",U),pt.addEventListener("notification_update",R),()=>{pt.removeEventListener("notification",U),pt.removeEventListener("notification_update",R)}},[]),_.useEffect(()=>{y()},[t,l,c,x,v]),_.useEffect(()=>{T();const N=()=>{t.length===0&&T()};return window.addEventListener("focus",N),()=>{window.removeEventListener("focus",N)}},[t.length]);const T=async()=>{o(!0);try{const N=await pt.getNotifications(1,50);if(N.success){const z=N.data.notifications.map(U=>({...U,type:vl(U.type)}));r(z)}}catch{gn.error({message:"Failed to fetch notifications",description:"There was an error loading your notifications. Please try again later."})}finally{o(!1)}},y=()=>{let N=t;if(v==="unread"&&(N=N.filter(z=>z.isRead===!1)),l){const z=l.toLowerCase();N=N.filter(U=>U.title.toLowerCase().includes(z)||U.message.toLowerCase().includes(z))}c!=="ALL"&&(N=N.filter(z=>z.type===c)),x!=="ALL"&&(N=N.filter(z=>z.source===x)),i(N)},w=N=>{S(N)},k=N=>{d(N)},b=()=>{d(""),h("ALL"),u("ALL"),S("all")},j=N=>{const z=Tm(N);e(z)},A=async N=>{try{await pt.markAsRead(N._id);const z=t.map(U=>U._id===N._id?{...U,isRead:!0,readAt:new Date().toISOString()}:U);r(z)}catch{gn.error({message:"Failed to mark notification as read",description:"There was an error updating the notification status. Please try again later."})}},E=async N=>{try{await pt.deleteNotification(N._id);const z=t.filter(U=>U._id!==N._id);r(z),gn.success({message:"Notification deleted",description:"The notification has been deleted successfully."})}catch{gn.error({message:"Failed to delete notification",description:"There was an error deleting the notification. Please try again later."})}},C=async()=>{try{await pt.markAllAsRead();const N=t.map(z=>({...z,isRead:!0,readAt:new Date().toISOString()}));r(N),gn.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})}catch{gn.error({message:"Failed to mark all notifications as read",description:"There was an error updating the notification status. Please try again later."})}},I=async()=>{try{await pt.deleteAllNotifications(),r([]),gn.success({message:"All notifications cleared",description:"All notifications have been deleted successfully."})}catch{gn.error({message:"Failed to clear notifications",description:"There was an error deleting the notifications. Please try again later."})}},F=N=>{m(!0),setTimeout(()=>{g(N),m(!1),gn.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return n.jsx("div",{className:"notifications-page",children:n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,children:n.jsx(ue,{children:n.jsxs(Ae,{justify:"space-between",align:"middle",children:[n.jsxs(Q,{children:[n.jsx(py,{level:4,children:n.jsxs(xe,{children:[n.jsx(mc,{}),"Notifications ",t.length>0?`(${t.length})`:""]})}),n.jsx(Qd,{children:"Stay updated with all your lead activities and follow-ups"})]}),n.jsx(Q,{children:n.jsxs(xe,{children:[n.jsx(ct,{title:"Refresh notifications",children:n.jsx(ne,{icon:n.jsx(Xs,{}),onClick:T,loading:a,children:"Refresh"})}),n.jsx(ne,{type:"primary",icon:n.jsx(gc,{}),onClick:C,disabled:t.filter(N=>!N.isRead).length===0,children:"Mark All as Read"}),n.jsx(ne,{type:"primary",danger:!0,icon:n.jsx(or,{}),onClick:I,disabled:t.length===0,children:"Clear All"})]})})]})})}),n.jsx(Q,{xs:24,lg:16,children:n.jsxs(ue,{className:"notifications-list-card",style:{marginBottom:24},children:[n.jsxs(Kt,{activeKey:v,onChange:w,tabBarExtraContent:n.jsx(xe,{children:n.jsx(xr,{count:Em(t),offset:[-5,0],children:n.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[n.jsx(Jd,{tab:"All Notifications"},"all"),n.jsx(Jd,{tab:"Unread"},"unread")]}),n.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[n.jsx(my,{placeholder:"Search notifications...",onSearch:k,style:{width:300},allowClear:!0}),n.jsx(xe,{children:n.jsx(ne,{icon:n.jsx(Gi,{}),onClick:b,disabled:l===""&&c==="ALL"&&x==="ALL",children:"Reset Filters"})})]}),n.jsx(on,{dataSource:s,renderItem:N=>n.jsx(Hu,{notification:N,onView:j,onMarkAsRead:A,onDelete:E}),pagination:{pageSize:10,showTotal:(N,z)=>`${z[0]}-${z[1]} of ${N} notifications`},rowKey:"_id",loading:a,locale:{emptyText:n.jsx(mt,{description:n.jsx("span",{children:"No notifications found"})})}})]})}),n.jsxs(Q,{xs:24,lg:8,children:[n.jsx(xy,{settings:p,onSave:F,loading:f}),n.jsx(ue,{title:n.jsxs(xe,{children:[n.jsx(Fi,{}),n.jsx("span",{children:"Notification Tips"})]}),children:n.jsx(Qd,{children:n.jsxs("ul",{children:[n.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),n.jsx("li",{children:"Use email notifications for critical updates when you're away"}),n.jsx("li",{children:"Click on a notification to see more details or take action"}),n.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class Xi extends xt.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t;return this.state.hasError?n.jsx(Di,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[n.jsx(ne,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),n.jsx(ne,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Mt=e=>{var r,s;const t=((s=(r=e.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred";throw new Error(t)},gt={getExhibitions:async()=>{try{return await _e.get("/exhibitions")}catch(e){return Mt(e)}},getActiveExhibitions:async()=>{try{return await _e.get("/exhibitions/active")}catch(e){return Mt(e)}},getExhibition:async e=>{try{return await _e.get(`/exhibitions/${e}`)}catch(t){return Mt(t)}},createExhibition:async e=>{try{return await _e.post("/exhibitions",e)}catch(t){return Mt(t)}},updateExhibition:async(e,t)=>{try{return await _e.put(`/exhibitions/${e}`,t)}catch(r){return Mt(r)}},deleteExhibition:async e=>{try{return await _e.delete(`/exhibitions/${e}`)}catch(t){return Mt(t)}},getHalls:async e=>{try{return await _e.get(`/exhibitions/${e}/halls`)}catch(t){return Mt(t)}},createHall:async(e,t)=>{try{const{_id:r,id:s,createdAt:i,updatedAt:a,...o}=t;return console.log("Creating hall with data:",{exhibitionId:e,data:o}),(await _e.post(`/exhibitions/${e}/halls`,o)).data}catch(r){throw console.error("Error creating hall:",r),r}},updateHall:async(e,t,r)=>{try{const{_id:s,id:i,createdAt:a,updatedAt:o,...l}=r;console.log("Updating hall with data:",{exhibitionId:e,hallId:t,data:l});const d=await _e.put(`/exhibitions/${e}/halls/${t}`,l);return console.log("Hall updated:",d.data),d}catch(s){return console.error("Error updating hall:",s),Mt(s)}},deleteHall:async(e,t)=>{var r,s,i;try{if(!e||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:e,hallId:t});const a=await _e.delete(`/exhibitions/${e}/halls/${t}`);if(!a.data)throw new Error("No response received from server");return a}catch(a){throw console.error("Error deleting hall:",a),((r=a.response)==null?void 0:r.status)===401?new Error("Unauthorized. Please log in again."):((s=a.response)==null?void 0:s.status)===403?new Error("You do not have permission to delete halls."):((i=a.response)==null?void 0:i.status)===404?new Error("Hall not found."):a}},saveLayout:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(r){return Mt(r)}},getLayout:async e=>{try{if(!e)throw new Error("Exhibition ID is required");return await _e.get(`/exhibitions/${e}/layout`)}catch(t){return Mt(t)}},getStalls:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await _e.get(`/exhibitions/${e}/stalls`,{params:{hallId:t}})}catch(r){return Mt(r)}},createStall:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await _e.post(`/exhibitions/${e}/stalls`,t)}catch(r){return Mt(r)}},updateStall:async(e,t,r)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:e,stallId:t,data:r});const s=await _e.put(`/exhibitions/${e}/stalls/${t}`,r);return console.log("Stall update response:",s),s}catch(s){return console.error("Error updating stall:",s),Mt(s)}},deleteStall:async(e,t)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");return await _e.delete(`/exhibitions/${e}/stalls/${t}`)}catch(r){return Mt(r)}},getFixtures:async(e,t)=>{try{const r=`/exhibitions/${e}/fixtures`,s=t?{type:t}:void 0;return await _e.get(r,{params:s})}catch(r){return Mt(r)}},getFixture:async(e,t)=>{try{return await _e.get(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Mt(r)}},createFixture:async(e,t)=>{try{return await _e.post(`/exhibitions/${e}/fixtures`,t)}catch(r){return Mt(r)}},updateFixture:async(e,t,r)=>{try{return await _e.put(`/exhibitions/${e}/fixtures/${t}`,r)}catch(s){return Mt(s)}},deleteFixture:async(e,t)=>{try{return await _e.delete(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Mt(r)}}},yy={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},Or=Qe("exhibition/fetchExhibitions",async(e,{rejectWithValue:t})=>{try{return(await gt.getExhibitions()).data.map(i=>({...i,id:i._id||i.id})).filter(i=>i.id)}catch(r){return t(r.message)}}),Br=Qe("exhibition/fetchExhibition",async(e,{rejectWithValue:t})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getExhibition(e)).data}catch(r){return t(r.message)}}),Za=Qe("exhibition/createExhibition",async(e,{rejectWithValue:t})=>{try{return(await gt.createExhibition(e)).data}catch(r){return t(r.message)}}),eo=Qe("exhibition/updateExhibition",async({id:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.updateExhibition(e,t)).data}catch(s){return r(s.message)}}),un=Qe("exhibition/fetchHalls",async(e,{rejectWithValue:t})=>{var r;try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getHalls(e)).data}catch(s){return((r=s.response)==null?void 0:r.status)===404?[]:t(s.message)}}),dn=Qe("exhibition/fetchStalls",async({exhibitionId:e,hallId:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getStalls(e,t)).data}catch(s){return r(s.message)}}),ji=Qe("exhibition/deleteExhibition",async(e,{rejectWithValue:t})=>{try{return await gt.deleteExhibition(e),e}catch(r){return t(r.message)}}),Si=Qe("exhibition/fetchFixtures",async({exhibitionId:e,type:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getFixtures(e,t)).data}catch(s){return r(s.message)}}),to=Qe("exhibition/createFixture",async({exhibitionId:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.createFixture(e,t)).data}catch(s){return r(s.message)}}),ro=Qe("exhibition/updateFixture",async({exhibitionId:e,id:t,data:r},{rejectWithValue:s})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await gt.updateFixture(e,t,r)).data}catch(i){return s(i.message)}}),no=Qe("exhibition/deleteFixture",async({exhibitionId:e,id:t},{rejectWithValue:r})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return await gt.deleteFixture(e,t),t}catch(s){return r(s.message)}}),uf=gr({name:"exhibition",initialState:yy,reducers:{clearCurrentExhibition:e=>{e.currentExhibition=null,e.halls=[],e.stalls=[],e.fixtures=[],e.error=null},clearError:e=>{e.error=null},clearStalls:e=>{e.stalls=[]},clearFixtures:e=>{e.fixtures=[]}},extraReducers:e=>{e.addCase(Or.pending,t=>{t.loading=!0,t.error=null}).addCase(Or.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=r.payload}).addCase(Or.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Br.pending,t=>{t.loading=!0,t.error=null}).addCase(Br.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload}).addCase(Br.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Za.pending,t=>{t.loading=!0,t.error=null}).addCase(Za.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions.push(r.payload)}).addCase(Za.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(eo.pending,t=>{t.loading=!0,t.error=null}).addCase(eo.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload;const s=t.exhibitions.findIndex(i=>i.id===r.payload.id);s!==-1&&(t.exhibitions[s]=r.payload)}).addCase(eo.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(un.pending,t=>{t.loading=!0,t.error=null}).addCase(un.fulfilled,(t,r)=>{t.loading=!1,t.halls=r.payload}).addCase(un.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(dn.pending,t=>{t.loading=!0,t.error=null}).addCase(dn.fulfilled,(t,r)=>{t.loading=!1;const s=r.payload.map(i=>{var a;return{...i,id:i._id||i.id,_id:i._id||i.id,stallTypeId:typeof i.stallTypeId=="string"?i.stallTypeId:(a=i.stallTypeId)==null?void 0:a._id,stallType:i.stallType||{name:"N/A",description:null}}});r.meta.arg.hallId,t.stalls=s}).addCase(dn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ji.pending,t=>{t.loading=!0,t.error=null}).addCase(ji.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(s=>(s._id||s.id)!==r.payload)}).addCase(ji.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Si.pending,t=>{t.loading=!0,t.error=null}).addCase(Si.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=r.payload.map(s=>({...s,id:s._id||s.id,_id:s._id||s.id}))}).addCase(Si.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(to.pending,t=>{t.loading=!0,t.error=null}).addCase(to.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id};t.fixtures.push(s)}).addCase(to.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ro.pending,t=>{t.loading=!0,t.error=null}).addCase(ro.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id},i=t.fixtures.findIndex(a=>a.id===s.id||a._id===s._id);i!==-1&&(t.fixtures[i]=s)}).addCase(ro.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(no.pending,t=>{t.loading=!0,t.error=null}).addCase(no.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=t.fixtures.filter(s=>s.id!==r.payload&&s._id!==r.payload)}).addCase(no.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearCurrentExhibition:Gk,clearError:Yk,clearStalls:Kk,clearFixtures:Xk}=uf.actions,vy=uf.reducer,Lt=(e,t)=>{if(!e)return"";let s=`/exhibition/${e.slug||e._id||e.id}`;return t&&(s+=`/${t}`),s},qo=(e,t)=>e?`/exhibitions/${e.slug||e._id||e.id}`:"",{Title:by,Text:Zn}=Le,{RangePicker:wy}=xs,jy=()=>{const{message:e,modal:t}=Xt.useApp(),r=Je(),s=it(),{exhibitions:i,loading:a}=$e(N=>N.exhibition),[o,l]=_.useState([]),[d,c]=_.useState(!1),[h,x]=_.useState(!1),[u,p]=_.useState({status:[],dateRange:null,search:"",activeStatus:null}),[g,f]=_.useState("all"),{hasPermission:m}=zo();_.useEffect(()=>{s(Or())},[s]);const v=_.useMemo(()=>{const N=i.length,z=i.filter(X=>X.status==="published").length,U=i.filter(X=>new Date(X.startDate)>new Date).length,R=i.filter(X=>X.status==="completed").length,O=i.filter(X=>X.isActive).length;return{total:N,active:z,upcoming:U,completed:R,activeCount:O}},[i]),S=async N=>{const z=N._id||N.id;try{c(!0),await s(ji(z)).unwrap(),e.success("Exhibition deleted successfully")}catch(U){e.error(U.message||"Failed to delete exhibition")}finally{c(!1)}},T=async()=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(or,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsxs("strong",{children:[o.length," selected exhibitions"]}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(ne,{onClick:()=>Ve.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(ne,{danger:!0,type:"primary",onClick:async()=>{try{c(!0),await Promise.all(o.map(N=>s(ji(N._id||N.id)).unwrap())),e.success(`Successfully deleted ${o.length} exhibitions`),l([])}catch(N){e.error(N.message||"Failed to delete some exhibitions")}finally{c(!1),Ve.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},y=async(N,z)=>{try{x(!0);const U=N._id||N.id;await gt.updateExhibition(U,{status:z});const R=i.map(O=>(O._id||O.id)===U?{...O,status:z}:O);s(Or.fulfilled(R,"",void 0)),e.success("Status updated successfully")}catch{e.error("Failed to update status"),s(Or())}finally{x(!1)}},w=async(N,z)=>{try{x(!0);const U=N._id||N.id;await gt.updateExhibition(U,{isActive:z});const R=i.map(O=>(O._id||O.id)===U?{...O,isActive:z}:O);s(Or.fulfilled(R,"",void 0)),e.success(`Exhibition ${z?"activated":"deactivated"} successfully`)}catch{e.error("Failed to update active status"),s(Or())}finally{x(!1)}},k=(N,z)=>{const U=N._id||N.id;z==="/layout"?r(Lt(N,"layout"),{state:{exhibitionId:U}}):r(Lt(N)+z,{state:{exhibitionId:U}})},b=N=>{switch(N.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},j=(N,z)=>{const U=b(N);return n.jsxs(xe,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[n.jsx(Te,{color:U,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:N}),!z&&n.jsx(Te,{color:"red",style:{margin:0},children:"Inactive"})]})},A=N=>{const z=new Date,U=new Date(N.startDate),R=new Date(N.endDate);if(z<U)return 0;if(z>R)return 100;const O=R.getTime()-U.getTime(),X=z.getTime()-U.getTime();return Math.round(X/O*100)},E=N=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(or,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsx("strong",{children:N.name}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(ne,{onClick:()=>Ve.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(ne,{danger:!0,type:"primary",onClick:()=>{S(N),Ve.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},C=N=>[{key:"view",label:"View Details",icon:n.jsx(hn,{}),onClick:()=>k(N,"")},{key:"edit",label:"Edit Exhibition",icon:n.jsx(as,{}),onClick:()=>k(N,"/edit")},{key:"layout",label:"Manage Layout",icon:n.jsx(ps,{}),onClick:()=>k(N,"/layout")},{type:"divider"},...N.status==="published"?[{key:"public-view",label:"Public View",icon:n.jsx(hn,{}),onClick:()=>window.open(qo(N),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:n.jsx(Gi,{}),children:[{key:"draft",label:n.jsxs(xe,{children:[n.jsx(Te,{color:"#faad14",style:{margin:0},children:"Draft"}),n.jsx("span",{children:"Set as Draft"})]}),icon:n.jsx(Cn,{}),onClick:()=>y(N,"draft"),disabled:N.status==="draft"||h},{key:"published",label:n.jsxs(xe,{children:[n.jsx(Te,{color:"#52c41a",style:{margin:0},children:"Published"}),n.jsx("span",{children:"Publish"})]}),icon:n.jsx(vt,{}),onClick:()=>y(N,"published"),disabled:N.status==="published"||h},{key:"completed",label:n.jsxs(xe,{children:[n.jsx(Te,{color:"#1890ff",style:{margin:0},children:"Completed"}),n.jsx("span",{children:"Mark as Completed"})]}),icon:n.jsx(Yt,{}),onClick:()=>y(N,"completed"),disabled:N.status==="completed"||h}]},{key:"active-status",label:n.jsxs(xe,{children:[N.isActive?n.jsx(Te,{color:"red",style:{margin:0},children:"Deactivate"}):n.jsx(Te,{color:"#52c41a",style:{margin:0},children:"Activate"}),n.jsx("span",{children:N.isActive?"Deactivate":"Activate"})]}),icon:n.jsx(dd,{}),onClick:()=>w(N,!N.isActive),disabled:h},{type:"divider"},{key:"delete",label:"Delete",icon:n.jsx(or,{}),danger:!0,onClick:()=>E(N)}],I=_.useMemo(()=>i.filter(N=>{if(u.search&&!N.name.toLowerCase().includes(u.search.toLowerCase())||u.status.length>0&&!u.status.includes(N.status)||u.activeStatus!==null&&N.isActive!==u.activeStatus)return!1;if(u.dateRange){const[z,U]=u.dateRange,R=new Date(N.startDate),O=new Date(N.endDate);if(R<new Date(z)||O>new Date(U))return!1}switch(g){case"active":return N.status==="published";case"upcoming":return new Date(N.startDate)>new Date;case"completed":return N.status==="completed";default:return!0}}),[i,u,g]),F=[{title:"Exhibition Details",key:"details",render:(N,z)=>n.jsx(Zn,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>k(z,""),children:z.name})},{title:"Status",key:"status",width:180,align:"center",render:(N,z)=>j(z.status,z.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(N,z)=>z.status===N},{title:"Start Date",key:"startDate",width:130,render:(N,z)=>n.jsx(Zn,{children:et(z.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(N,z)=>n.jsx(Zn,{children:et(z.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(N,z)=>n.jsx(Zn,{children:et(z.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(N,z)=>n.jsx(Kr,{percent:A(z),size:"small",status:z.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(N,z)=>n.jsxs(xe,{size:"middle",children:[m("exhibitions_view")&&n.jsx(ct,{title:"View Details",children:n.jsx(ne,{type:"text",icon:n.jsx(hn,{}),onClick:()=>k(z,"")})}),m("exhibitions_edit")&&n.jsx(ct,{title:"Edit Exhibition",children:n.jsx(ne,{type:"text",icon:n.jsx(as,{}),onClick:()=>k(z,"/edit")})}),m("exhibitions_delete")&&n.jsx(Vn,{menu:{items:C(z)},trigger:["click"],placement:"bottomRight",children:n.jsx(ne,{type:"text",icon:n.jsx(jc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ae,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(by,{level:4,style:{margin:0},children:"Exhibitions"}),n.jsx(Zn,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),n.jsx(Q,{children:n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),onClick:()=>r("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),n.jsxs(Ae,{gutter:[24,24],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,lg:4,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Total Exhibitions",value:v.total,prefix:n.jsx(Cn,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Published Exhibitions",value:v.active,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Upcoming Exhibitions",value:v.upcoming,prefix:n.jsx(Yt,{style:{color:"#1890ff"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Completed Exhibitions",value:v.completed,prefix:n.jsx(vt,{style:{color:"#8c8c8c"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Active Status",value:v.activeCount,prefix:n.jsx(dd,{style:{color:"#52c41a"}})})})})]}),n.jsx(ue,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:n.jsxs(xe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ae,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(xe,{size:"middle",wrap:!0,children:[n.jsx(fe,{placeholder:"Search exhibitions",prefix:n.jsx(An,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:u.search,onChange:N=>p(z=>({...z,search:N.target.value})),allowClear:!0}),n.jsx(Pe,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:u.status,onChange:N=>p(z=>({...z,status:N})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),n.jsxs(Pe,{placeholder:"Active Status",style:{width:"150px"},value:u.activeStatus,onChange:N=>p(z=>({...z,activeStatus:N})),allowClear:!0,children:[n.jsx(Pe.Option,{value:!0,children:"Active"}),n.jsx(Pe.Option,{value:!1,children:"Inactive"})]}),n.jsx(wy,{onChange:N=>p(z=>{var U,R;return{...z,dateRange:N?[((U=N[0])==null?void 0:U.toISOString())||"",((R=N[1])==null?void 0:R.toISOString())||""]:null}})})]})}),n.jsx(Q,{children:n.jsx(Tx,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:g,onChange:N=>f(N)})})]}),o.length>0&&n.jsx(Ae,{children:n.jsxs(xe,{children:[n.jsxs(Zn,{children:["Selected ",o.length," items"]}),n.jsx(ne,{danger:!0,onClick:T,children:"Delete Selected"})]})})]})}),n.jsx(ue,{className:"info-card",styles:{body:{padding:0}},children:n.jsx(tt,{columns:F,dataSource:I.map(N=>({...N,key:N._id||N.id})),rowKey:N=>N._id||N.id,loading:a||d||h,rowSelection:{selectedRowKeys:o.map(N=>N._id||N.id),onChange:(N,z)=>l(z),selections:[tt.SELECTION_ALL,tt.SELECTION_NONE]},footer:()=>o.length>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[n.jsxs(Zn,{children:["Selected ",n.jsx("strong",{children:o.length})," ",o.length===1?"exhibition":"exhibitions"]}),n.jsx(ne,{danger:!0,onClick:T,icon:n.jsx(or,{}),loading:d,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:N=>`Total ${N} items`,style:{marginTop:"16px"}}})})]})},Ms={getStallTypes:async()=>_e.get("/stall-types"),createStallType:async e=>_e.post("/stall-types",e),updateStallType:async(e,t)=>_e.put(`/stall-types/${e}`,t),deleteStallType:async e=>_e.delete(`/stall-types/${e}`)},{RangePicker:Sy}=xs,{Title:bn,Text:wn}=Le,Zd=({value:e="",onChange:t})=>{const r=xt.useRef(null),[s]=xt.useState(e);return n.jsx(up,{apiKey:ym,onInit:(i,a)=>{r.current=a},value:e,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:i=>{i.on("init",()=>{i.undoManager.clear(),i.undoManager.add()}),i.on("change",()=>{i.undoManager.add()})}},onEditorChange:i=>{t==null||t(i)}})},Ey=({form:e})=>{const[t,r]=_.useState([]),[s,i]=_.useState(!1);return _.useEffect(()=>{(async()=>{try{i(!0);const o=await Ms.getStallTypes();r(o.data.filter(l=>l.status==="active"))}catch(o){console.error("Failed to fetch stall types:",o)}finally{i(!1)}})()},[]),n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(ue,{className:"settings-card",children:[n.jsx(bn,{level:4,children:"Basic Information"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),n.jsxs(Ae,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:n.jsx(fe,{placeholder:"Enter exhibition name"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(fe.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:n.jsx(fe.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:n.jsx(fe,{placeholder:"Enter invoice prefix (default: INV)"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:n.jsx(Sy,{style:{width:"100%"}})})})]})]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Company Details"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),n.jsxs(Ae,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(fe,{placeholder:"Enter company name"})}),n.jsx(H.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:n.jsx(fe,{placeholder:"Enter contact number"})}),n.jsx(H.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{placeholder:"Enter email address"})}),n.jsx(H.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(fe.TextArea,{rows:4,placeholder:"Enter company address"})}),n.jsx(H.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:n.jsx(Zd,{})})]}),n.jsxs(Q,{span:12,children:[n.jsx(H.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:n.jsx(fe,{placeholder:"Enter PAN number"})}),n.jsx(H.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:n.jsx(fe,{placeholder:"Enter GST number"})}),n.jsx(H.Item,{name:"companySAC",label:"SAC Code No.",children:n.jsx(fe,{placeholder:"Enter SAC code number"})}),n.jsx(H.Item,{name:"companyCIN",label:"CIN No.",children:n.jsx(fe,{placeholder:"Enter CIN number"})}),n.jsx(H.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:n.jsx(fe,{placeholder:"Enter website URL"})}),n.jsx(H.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:n.jsx(Zd,{})})]})]})]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Bank Details"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),n.jsxs(Ae,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(H.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:n.jsx(fe,{placeholder:"Enter bank name"})}),n.jsx(H.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:n.jsx(fe,{placeholder:"Enter branch name"})}),n.jsx(H.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:n.jsx(fe,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),n.jsxs(Q,{span:12,children:[n.jsx(H.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:n.jsx(fe,{placeholder:"Enter account name"})}),n.jsx(H.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:n.jsx(fe,{placeholder:"Enter account number"})})]})]})]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Stall Rates & Pricing"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(bn,{level:5,children:"Stall Type Rates"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),n.jsx(H.List,{name:"stallRates",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(xe,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Pe,{loading:s,placeholder:"Select stall type",style:{width:200},children:t.map(x=>n.jsx(Pe.Option,{value:x._id,children:x.name},x._id))})}),n.jsx(H.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:n.jsx(yt,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"",formatter:x=>`${x}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:x=>{const u=x?Number(x.replace(/\\s?|(,*)/g,"")):0;return isNaN(u)?0:u}})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Stall Type Rate"})})]})})]}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(bn,{level:5,children:"Tax Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),n.jsx(H.List,{name:"taxConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(xe,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:n.jsx(fe,{placeholder:"Tax name",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:n.jsx(yt,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:x=>`${x}%`,parser:x=>{const u=x?Number(x.replace("%","")):0;return isNaN(u)?0:Math.min(u,100)}})}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Tax"})})]})})]}),n.jsxs("div",{children:[n.jsx(bn,{level:5,children:"Admin Discount Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),n.jsx(H.List,{name:"discountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(xe,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(fe,{placeholder:"Discount",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Pe,{style:{width:150},children:[n.jsx(Pe.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Pe.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),n.jsx(H.Item,{noStyle:!0,shouldUpdate:(x,u)=>{var p,g,f,m;return((g=(p=x==null?void 0:x.discountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(f=u==null?void 0:u.discountConfig)==null?void 0:f[c])==null?void 0:m.type)},children:({getFieldValue:x})=>{const u=x(["discountConfig",c,"type"]);return n.jsx(H.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(yt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Admin Discount"})})]})})]}),n.jsxs("div",{style:{marginTop:"24px"},children:[n.jsx(bn,{level:5,children:"Public Discount Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),n.jsx(H.List,{name:"publicDiscountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(xe,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(fe,{placeholder:"Discount",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Pe,{style:{width:150},children:[n.jsx(Pe.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Pe.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),n.jsx(H.Item,{noStyle:!0,shouldUpdate:(x,u)=>{var p,g,f,m;return((g=(p=x==null?void 0:x.publicDiscountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(f=u==null?void 0:u.publicDiscountConfig)==null?void 0:f[c])==null?void 0:m.type)},children:({getFieldValue:x})=>{const u=x(["publicDiscountConfig",c,"type"]);return n.jsx(H.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(yt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Public Discount"})})]})})]})]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Status Settings"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),n.jsxs(Ae,{gutter:24,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{children:[n.jsx(Pe.Option,{value:"draft",children:"Draft"}),n.jsx(Pe.Option,{value:"published",children:"Published"}),n.jsx(Pe.Option,{value:"completed",children:"Completed"})]})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:eh,Text:bl}=Le,Ty=({form:e})=>{const{message:t}=Xt.useApp(),[r,s]=_.useState([]),[i,a]=_.useState([]),[o,l]=_.useState(0),[d,c]=_.useState({}),h=f=>{const m=localStorage.getItem("token");return{url:`${_e.defaults.baseURL}/uploads/${f}`,token:m}};_.useEffect(()=>{const f=e.getFieldValue("headerLogo");if(f){const{url:m,token:v}=h(f);fetch(m,{headers:{authorization:`Bearer ${v}`}}).then(S=>S.blob()).then(S=>{const T=URL.createObjectURL(S);s([{uid:"-1",name:f.split("/").pop()||"logo",status:"done",url:T,thumbUrl:T,type:S.type,response:{path:f}}])}).catch(()=>{s([])})}},[e]),_.useEffect(()=>{const f=e.getFieldValue("sponsorLogos")||[];f.length>0&&Promise.all(f.map(async(m,v)=>{const{url:S,token:T}=h(m);try{const w=await(await fetch(S,{headers:{authorization:`Bearer ${T}`}})).blob(),k=URL.createObjectURL(w);return{uid:`-${v+1}`,name:m.split("/").pop()||`sponsor-${v+1}`,status:"done",url:k,thumbUrl:k,type:w.type,response:{path:m}}}catch{return null}})).then(m=>{a(m.filter(Boolean))})},[e]);const x={name:"file",action:`${_e.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(f){const{status:m,name:v,response:S,uid:T}=f.file;if(m==="uploading"){s([...f.fileList]);return}if(m==="done"&&S){const{url:y,token:w}=h(S.path);l(0),fetch(y,{headers:{authorization:`Bearer ${w}`}}).then(k=>k.blob()).then(k=>{const b=URL.createObjectURL(k);s([{uid:f.file.uid,name:v,status:"done",url:b,thumbUrl:b,type:k.type,response:S}]),t.success(`${v} uploaded successfully`),e.setFieldValue("headerLogo",S.path),S.thumbnail&&e.setFieldValue("headerLogoThumbnail",S.thumbnail)}).catch(()=>{t.error(`${v} preview failed to load`),s([])})}else m==="error"?(t.error(`${v} upload failed.`),s([]),l(0)):m==="removed"&&(s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0))},customRequest:async f=>{const{onProgress:m,onSuccess:v,onError:S,file:T,action:y,headers:w}=f;try{const k=new FormData;k.append("file",T);const b=new XMLHttpRequest;b.open("POST",y||"",!0),w&&Object.keys(w).forEach(j=>{b.setRequestHeader(j,w[j])}),b.upload.onprogress=j=>{j.lengthComputable&&m&&(m({percent:j.loaded/j.total*100}),l(Math.round(j.loaded/j.total*100)))},b.onload=()=>{if(b.status>=200&&b.status<300)try{const j=JSON.parse(b.response);v==null||v(j,T),l(0)}catch(j){S==null||S(j)}else S==null||S(new Error("Upload failed"))},b.onerror=()=>{l(0),S==null||S(new Error("Upload request failed"))},b.send(k)}catch(k){l(0),S==null||S(k)}},onRemove(){return s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0),!0},onPreview:async f=>{if(!f.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${f.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},u={name:"file",action:`${_e.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:i,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(f){const{status:m,name:v,response:S,uid:T}=f.file;if(m==="uploading"){a([...f.fileList]);return}if(m==="done"&&S&&S.paths&&S.paths.length>0){c(b=>{const j={...b};return delete j[T],j});const y=S.paths[0],{url:w,token:k}=h(y);fetch(w,{headers:{authorization:`Bearer ${k}`}}).then(b=>b.blob()).then(b=>{const j=URL.createObjectURL(b),A=[...i],E=A.findIndex(F=>F.uid===f.file.uid),C={uid:f.file.uid,name:v,status:"done",url:j,thumbUrl:j,type:b.type,response:{path:y}};E>-1?A[E]=C:A.push(C),a(A),t.success(`${v} uploaded successfully`);const I=A.filter(F=>{var N;return F.status==="done"&&((N=F.response)==null?void 0:N.path)}).map(F=>F.response.path);if(e.setFieldValue("sponsorLogos",I),S.thumbnails&&S.thumbnails.length>0){const F=e.getFieldValue("sponsorLogoThumbnails")||[];e.setFieldValue("sponsorLogoThumbnails",[...F,...S.thumbnails])}}).catch(()=>{t.error(`${v} preview failed to load`),a(b=>b.filter(j=>j.uid!==f.file.uid))})}else m==="error"?(t.error(`${v} upload failed.`),a(y=>y.filter(w=>w.uid!==f.file.uid)),c(y=>{const w={...y};return delete w[T],w})):m==="removed"&&c(y=>{const w={...y};return delete w[T],w})},customRequest:async f=>{const{onProgress:m,onSuccess:v,onError:S,file:T,action:y,headers:w}=f,k=typeof T=="object"&&"uid"in T?T.uid:String(Date.now());try{const b=new FormData;b.append("file",T);const j=new XMLHttpRequest;j.open("POST",y||"",!0),w&&Object.keys(w).forEach(A=>{j.setRequestHeader(A,w[A])}),j.upload.onprogress=A=>{if(A.lengthComputable&&m){const E=A.loaded/A.total*100;m({percent:E}),c(C=>({...C,[k]:Math.round(E)}))}},j.onload=()=>{if(j.status>=200&&j.status<300)try{const A=JSON.parse(j.response);v==null||v(A,T),c(E=>{const C={...E};return delete C[k],C})}catch(A){S==null||S(A)}else S==null||S(new Error("Upload failed"))},j.onerror=()=>{c(A=>{const E={...A};return delete E[k],E}),S==null||S(new Error("Upload request failed"))},j.send(b)}catch(b){c(j=>{const A={...j};return delete A[k],A}),S==null||S(b)}},onRemove(f){var T;const m=i.filter(y=>y.uid!==f.uid);a(m);const v=m.filter(y=>{var w;return y.status==="done"&&((w=y.response)==null?void 0:w.path)}).map(y=>y.response.path);e.setFieldValue("sponsorLogos",v);const S=e.getFieldValue("sponsorLogoThumbnails")||[];if(S.length>0&&(T=f.response)!=null&&T.path){const y=f.response.path.split("/"),w=y[y.length-1],k=S.filter(b=>!b.includes(w));e.setFieldValue("sponsorLogoThumbnails",k)}return c(y=>{const w={...y};return delete w[f.uid],w}),!0},onPreview:async f=>{if(!f.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${f.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},p=n.jsx("div",{children:o>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Kr,{type:"circle",percent:o,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),g=n.jsxs("div",{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return n.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:n.jsxs(ue,{className:"settings-card",children:[n.jsx(eh,{level:4,children:"Header Settings"}),n.jsx(bl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),n.jsxs(Ae,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsxs(H.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Ri,{...x,children:r.length<1&&p}),r.length>0&&o>0&&n.jsx(Kr,{percent:o,status:"active",style:{marginTop:8}})]})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:n.jsx(fe,{placeholder:"Enter a title for your exhibition header"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:n.jsx(fe,{placeholder:"Enter a subtitle (optional)"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:n.jsx(fe.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),n.jsxs(Q,{span:24,children:[n.jsx(nt,{}),n.jsx(eh,{level:5,children:"Sponsor Logos"}),n.jsx(bl,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),n.jsxs(H.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[n.jsx(Ri,{...u,children:g}),Object.entries(d).map(([f,m])=>{var v;return n.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[n.jsxs(bl,{style:{marginRight:10,width:150},ellipsis:!0,children:[((v=i.find(S=>S.uid===f))==null?void 0:v.name)||"File",":"]}),n.jsx(Kr,{percent:m,status:"active",style:{flex:1}})]},f)})]})]})]})]})})},{Title:th,Text:rh}=Le,_y=({form:e})=>{const{message:t}=Xt.useApp(),[r,s]=_.useState([]),i=o=>{const l=localStorage.getItem("token");return{url:`${_e.defaults.baseURL}/uploads/${o}`,token:l}};_.useEffect(()=>{const o=e.getFieldValue("footerLogo");if(o){const{url:l,token:d}=i(o);fetch(l,{headers:{authorization:`Bearer ${d}`}}).then(c=>c.blob()).then(c=>{const h=URL.createObjectURL(c);s([{uid:"-1",name:o.split("/").pop()||"logo",status:"done",url:h,thumbUrl:h,type:c.type,response:{path:o}}])}).catch(()=>{s([])})}},[e]);const a={name:"file",action:`${_e.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(o){const{status:l,name:d,response:c}=o.file;if(l==="uploading"){s([...o.fileList]);return}if(l==="done"&&c){const{url:h,token:x}=i(c.path);fetch(h,{headers:{authorization:`Bearer ${x}`}}).then(u=>u.blob()).then(u=>{const p=URL.createObjectURL(u);s([{uid:o.file.uid,name:d,status:"done",url:p,thumbUrl:p,type:u.type,response:c}]),t.success(`${d} uploaded successfully`),e.setFieldValue("footerLogo",c.path)}).catch(()=>{t.error(`${d} preview failed to load`),s([])})}else l==="error"?(t.error(`${d} upload failed.`),s([])):l==="removed"&&(s([]),e.setFieldValue("footerLogo",null))},onRemove(){return s([]),e.setFieldValue("footerLogo",null),!0},onPreview:async o=>{if(!o.url)return;const l=window.open("");l&&(l.document.write(`
          <img src="${o.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),l.document.head.innerHTML="<title>Image Preview</title>")}};return n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(ue,{className:"settings-card",children:[n.jsx(th,{level:4,children:"Footer Content"}),n.jsx(rh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),n.jsxs(Ae,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:n.jsx(Ri,{...a,children:r.length<1&&n.jsxs("div",{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:n.jsx(fe.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:n.jsx(fe,{placeholder:"Enter contact email"})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:n.jsx(fe,{placeholder:"Enter contact phone number"})})})]})]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(th,{level:4,children:"Footer Links"}),n.jsx(rh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),n.jsx(H.List,{name:"footerLinks",children:(o,{add:l,remove:d})=>n.jsxs(n.Fragment,{children:[o.map(({key:c,name:h,...x})=>n.jsxs(Ae,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:11,children:n.jsx(H.Item,{...x,name:[h,"label"],rules:[{required:!0,message:"Please enter link label"}],children:n.jsx(fe,{placeholder:"Link Label"})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{...x,name:[h,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:n.jsx(fe,{placeholder:"URL (e.g., https://example.com)"})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(ns,{onClick:()=>d(h)})})]},c)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>l(),block:!0,icon:n.jsx(fr,{}),children:"Add Footer Link"})})]})})]})]})},{Title:wl,Text:jl}=Le,{TabPane:nh}=Kt,ky=({form:e})=>n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(Kt,{defaultActiveKey:"basic",type:"card",children:[n.jsx(nh,{tab:"Basic Amenities",children:n.jsxs(ue,{className:"settings-card",children:[n.jsx(wl,{level:4,children:"Basic Amenities"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),n.jsx(H.List,{name:"basicAmenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ae,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:5,children:n.jsx(H.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Pe,{placeholder:"Select type",children:[n.jsx(Pe.Option,{value:"facility",children:"Facility"}),n.jsx(Pe.Option,{value:"service",children:"Service"}),n.jsx(Pe.Option,{value:"equipment",children:"Equipment"}),n.jsx(Pe.Option,{value:"other",children:"Other"})]})})}),n.jsx(Q,{span:6,children:n.jsx(H.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(fe,{placeholder:"Enter name (e.g. Tables)"})})}),n.jsx(Q,{span:6,children:n.jsx(H.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(fe.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(Q,{span:3,children:n.jsx(H.Item,{...o,name:[a,"perSqm"],label:n.jsxs(xe,{children:["Per sqm",n.jsx(ct,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:n.jsx(Zr,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"9",min:1})})}),n.jsx(Q,{span:3,children:n.jsx(H.Item,{...o,name:[a,"quantity"],label:n.jsxs(xe,{children:["Quantity",n.jsx(ct,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:n.jsx(Zr,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"1",min:1})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:n.jsx(ns,{onClick:()=>s(a)})})]},i)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>r({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:n.jsx(fr,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),n.jsx(nh,{tab:"Extra Amenities",children:n.jsxs(ue,{className:"settings-card",children:[n.jsx(wl,{level:4,children:"Extra Amenities"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),n.jsx(H.List,{name:"amenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ae,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:5,children:n.jsx(H.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Pe,{placeholder:"Select type",children:[n.jsx(Pe.Option,{value:"facility",children:"Facility"}),n.jsx(Pe.Option,{value:"service",children:"Service"}),n.jsx(Pe.Option,{value:"equipment",children:"Equipment"}),n.jsx(Pe.Option,{value:"other",children:"Other"})]})})}),n.jsx(Q,{span:6,children:n.jsx(H.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(fe,{placeholder:"Enter name (e.g. Power)"})})}),n.jsx(Q,{span:8,children:n.jsx(H.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(fe.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(Q,{span:4,children:n.jsx(H.Item,{...o,name:[a,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"Enter rate",prefix:"",min:0,formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>{const d=l?Number(l.replace(/\\s?|(,*)/g,"")):0;return isNaN(d)?0:d}})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(ns,{onClick:()=>s(a)})})]},i)),n.jsx(H.Item,{children:n.jsx(ne,{type:"dashed",onClick:()=>r({type:"service"}),block:!0,icon:n.jsx(fr,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),n.jsxs(ue,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(wl,{level:4,children:"Special Requirements"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),n.jsx(Ae,{gutter:24,children:n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:n.jsx(fe.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),ff=({initialValues:e,onSubmit:t,submitText:r="Submit"})=>{const[s]=H.useForm(),i=o=>{t(o)},a=[{key:"general",label:"General",children:n.jsx(Ey,{form:s})},{key:"header",label:"Header",children:n.jsx(Ty,{form:s})},{key:"footer",label:"Footer",children:n.jsx(_y,{form:s})},{key:"amenities",label:"Amenities",children:n.jsx(ky,{form:s})}];return n.jsx(H,{form:s,layout:"vertical",initialValues:e,onFinish:i,style:{height:"100%"},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[n.jsx("div",{style:{flex:1,marginBottom:"24px"},children:n.jsx(Kt,{defaultActiveKey:"general",items:a,type:"card"})}),n.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:n.jsx(ne,{type:"primary",htmlType:"submit",children:r})})]})})},Cy=()=>{const e=Je(),t=it(),r=async s=>{var i,a;try{const[o,l]=s.dateRange,d={name:s.name,description:s.description,venue:s.venue,startDate:o.toISOString(),endDate:l.toISOString(),status:s.status||"draft",isActive:s.isActive??!0,invoicePrefix:s.invoicePrefix,stallRates:s.stallRates||[],dimensions:{width:100,height:100},taxConfig:s.taxConfig||[],discountConfig:s.discountConfig||[],publicDiscountConfig:s.publicDiscountConfig||[],companyName:s.companyName,companyContactNo:s.companyContactNo,companyEmail:s.companyEmail,companyAddress:s.companyAddress,companyWebsite:s.companyWebsite,companyPAN:s.companyPAN,companyGST:s.companyGST,companySAC:s.companySAC,companyCIN:s.companyCIN,termsAndConditions:s.termsAndConditions,piInstructions:s.piInstructions,bankName:s.bankName,bankBranch:s.bankBranch,bankIFSC:s.bankIFSC,bankAccountName:s.bankAccountName,bankAccount:s.bankAccount,headerTitle:s.headerTitle,headerSubtitle:s.headerSubtitle,headerDescription:s.headerDescription,headerLogo:s.headerLogo,sponsorLogos:s.sponsorLogos||[],footerText:s.footerText,footerLogo:s.footerLogo,contactEmail:s.contactEmail,contactPhone:s.contactPhone,footerLinks:s.footerLinks||[],amenities:((i=s.amenities)==null?void 0:i.map(x=>({type:x.type,name:x.name,description:x.description,rate:x.rate})))||[],basicAmenities:((a=s.basicAmenities)==null?void 0:a.map(x=>({type:x.type,name:x.name,description:x.description,perSqm:x.perSqm,quantity:x.quantity})))||[],specialRequirements:s.specialRequirements},c=await t(Za(d)).unwrap();je.success("Exhibition created successfully");const h=c._id||c.id;h?e(Lt({_id:h,id:h,name:d.name}),{state:{exhibitionId:h}}):(je.error("Exhibition ID not found in response"),e("/exhibition"))}catch(o){je.error(o.message||"Failed to create exhibition"),console.error("Error creating exhibition:",o)}};return n.jsx(ue,{title:"Create New Exhibition",children:n.jsx(ff,{onSubmit:r,submitText:"Create Exhibition"})})},{Title:sh,Text:sr,Paragraph:Sl}=Le,El=()=>{const e=Je();return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>e("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Ay=()=>{const{id:e}=Fr(),t=Je(),r=it(),{currentExhibition:s,halls:i,stalls:a,loading:o}=$e(f=>f.exhibition),[l,d]=_.useState(0);_.useEffect(()=>{e&&(r(Br(e)),r(un(e)),r(dn({exhibitionId:e})))},[e,r]),_.useEffect(()=>{s&&h()},[s]);const c=()=>{if(!s)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const f=i.length||0;let m=a.length||0,v=a.filter(S=>S.status==="booked"||S.status==="reserved").length;return m===0&&(s.stalls&&s.stalls.length>0?(m=s.stalls.length,v=s.stalls.filter(S=>S.status==="booked"||S.status==="reserved").length):(m=s.stallCount||0,v=s.bookedStallCount||0)),{hallCount:f,stallCount:m,bookedStallCount:v,availableStallCount:m-v}},h=()=>{if(!s)return 0;const f=new Date,m=new Date(s.startDate),v=new Date(s.endDate);if(f<m)return d(0);if(f>v)return d(100);const S=v.getTime()-m.getTime(),T=f.getTime()-m.getTime();d(Math.round(T/S*100))},x=f=>{switch(f.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},u=()=>{if(!s)return{text:"",count:0,isPast:!1};const f=new Date,m=new Date(s.startDate),v=new Date(s.endDate);return f>v?{text:"Ended",count:Math.ceil((f.getTime()-v.getTime())/864e5),isPast:!0}:f>=m&&f<=v?{text:"Days Remaining",count:Math.ceil((v.getTime()-f.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((m.getTime()-f.getTime())/(1e3*60*60*24)),isPast:!1}},p=f=>{t(Lt(s,f))};if(o)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(El,{}),n.jsx(ue,{children:n.jsx(ln,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!s)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(El,{}),n.jsx(ue,{children:n.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[n.jsx(Zr,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),n.jsx(sh,{level:4,children:"Exhibition not found"}),n.jsx(Sl,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const g=u();return n.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[n.jsx(El,{}),n.jsx(ue,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:n.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:n.jsxs(Ae,{gutter:[24,24],align:"middle",children:[n.jsxs(Q,{xs:24,md:16,children:[n.jsx(sh,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:s.name}),n.jsx(Sl,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:s.description}),n.jsxs(xe,{split:n.jsx(nt,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[n.jsxs(xe,{children:[n.jsx(Vr,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsxs(sr,{style:{color:"rgba(255,255,255,0.8)"},children:[et(s.startDate).format("MMM D, YYYY")," - ",et(s.endDate).format("MMM D, YYYY")]})]}),s.venue&&n.jsxs(xe,{children:[n.jsx(os,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsx(sr,{style:{color:"rgba(255,255,255,0.8)"},children:s.venue})]})]})]}),n.jsx(Q,{xs:24,md:8,children:n.jsxs(ue,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[n.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:x(s.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:s.status.toUpperCase()}),n.jsx(Xe,{title:g.text,value:g.count,suffix:"days",valueStyle:{color:g.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:n.jsx(Yt,{})}),n.jsx(nt,{style:{margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"8px"},children:n.jsx(sr,{type:"secondary",children:"Exhibition Progress"})}),n.jsx(Kr,{percent:l,status:l===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),n.jsxs(Ae,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:8,children:n.jsx(ne,{type:"primary",icon:n.jsx(ps,{}),onClick:()=>p(`${e}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(ne,{icon:n.jsx(as,{}),onClick:()=>p(`${e}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(ne,{icon:n.jsx(hn,{}),onClick:()=>window.open(qo(s),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:s.status!=="published",children:"View Public Page"})})]}),n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,lg:16,children:n.jsxs(ue,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[n.jsxs(Ae,{gutter:[24,24],children:[n.jsxs(Q,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),n.jsx(sr,{strong:!0,style:{fontSize:"16px"},children:et(s.startDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),n.jsx(sr,{strong:!0,style:{fontSize:"16px"},children:et(s.endDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),n.jsx(sr,{strong:!0,style:{fontSize:"16px"},children:et(s.createdAt).format("MMMM D, YYYY")})]})]}),n.jsxs(Q,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),n.jsx(Te,{color:x(s.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.status.toUpperCase()})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),n.jsx(Te,{color:s.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.isActive?"ACTIVE":"INACTIVE"})]}),s.venue&&n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),n.jsx(sr,{strong:!0,style:{fontSize:"16px"},children:s.venue})]})]})]}),n.jsx(nt,{}),n.jsxs("div",{children:[n.jsx(sr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),n.jsx(Sl,{children:s.description||"No description provided."})]})]})}),n.jsxs(Q,{xs:24,lg:8,children:[n.jsx(ue,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:n.jsxs(Ae,{gutter:[16,24],children:[n.jsx(Q,{span:12,children:n.jsx(Xe,{title:"Halls",value:c().hallCount,prefix:n.jsx(ms,{})})}),n.jsx(Q,{span:12,children:n.jsx(Xe,{title:"Stalls",value:c().stallCount,prefix:n.jsx(yr,{})})}),n.jsx(Q,{span:12,children:n.jsx(Xe,{title:"Booked Stalls",value:c().bookedStallCount,prefix:n.jsx(vt,{})})}),n.jsx(Q,{span:12,children:n.jsx(Xe,{title:"Available Stalls",value:c().availableStallCount,prefix:n.jsx(_x,{})})})]})}),n.jsx(ue,{title:"Created By",style:{borderRadius:"12px"},children:s.createdBy?n.jsxs(xe,{children:[n.jsx(Mr,{icon:n.jsx(at,{})}),n.jsx(sr,{children:s.createdByName||"Administrator"})]}):n.jsx(sr,{type:"secondary",children:"Information not available"})})]})]})]})},Iy=()=>{var p;const{message:e}=Xt.useApp(),{id:t}=Fr(),s=(p=Fn().state)==null?void 0:p.exhibitionId,i=Je(),a=it(),{currentExhibition:o,loading:l,error:d}=$e(g=>g.exhibition),[c,h]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!s){e.error("Exhibition ID not found"),i("/exhibition");return}try{await a(Br(s)).unwrap()}catch(f){e.error(f.message||"Failed to fetch exhibition"),i("/exhibition")}finally{h(!0)}})()},[s,a,e,i]),_.useEffect(()=>{d&&e.error(d)},[d,e]);const x=async g=>{var f,m;if(!(!s||!o))try{const[v,S]=g.dateRange,T={name:g.name,description:g.description,venue:g.venue,startDate:v.toISOString(),endDate:S.toISOString(),status:g.status,isActive:g.isActive,invoicePrefix:g.invoicePrefix,stallRates:g.stallRates||[],dimensions:o.dimensions,taxConfig:g.taxConfig||[],discountConfig:g.discountConfig||[],publicDiscountConfig:g.publicDiscountConfig||[],companyName:g.companyName,companyContactNo:g.companyContactNo,companyEmail:g.companyEmail,companyAddress:g.companyAddress,companyWebsite:g.companyWebsite,companyPAN:g.companyPAN,companyGST:g.companyGST,companySAC:g.companySAC,companyCIN:g.companyCIN,termsAndConditions:g.termsAndConditions,piInstructions:g.piInstructions,bankName:g.bankName,bankBranch:g.bankBranch,bankIFSC:g.bankIFSC,bankAccountName:g.bankAccountName,bankAccount:g.bankAccount,headerTitle:g.headerTitle,headerSubtitle:g.headerSubtitle,headerDescription:g.headerDescription,headerLogo:g.headerLogo,sponsorLogos:g.sponsorLogos||[],footerText:g.footerText,footerLogo:g.footerLogo,contactEmail:g.contactEmail,contactPhone:g.contactPhone,footerLinks:g.footerLinks||[],amenities:((f=g.amenities)==null?void 0:f.map(y=>({type:y.type,name:y.name,description:y.description,rate:y.rate})))||[],basicAmenities:((m=g.basicAmenities)==null?void 0:m.map(y=>({type:y.type,name:y.name,description:y.description,perSqm:y.perSqm,quantity:y.quantity})))||[],specialRequirements:g.specialRequirements};await a(eo({id:s,data:T})).unwrap(),e.success("Exhibition updated successfully"),i(Lt(o),{state:{exhibitionId:s}})}catch(v){e.error(v.message||"Failed to update exhibition")}};if(!c)return n.jsx(ue,{loading:!0});if(!s)return n.jsx(Do,{to:"/exhibition",replace:!0});if(l||!o)return n.jsx(ue,{loading:!0});const u={name:o.name,description:o.description,venue:o.venue,dateRange:[et(o.startDate),et(o.endDate)],status:o.status,isActive:o.isActive,invoicePrefix:o.invoicePrefix,stallRates:o.stallRates||[],taxConfig:o.taxConfig||[],discountConfig:o.discountConfig||[],publicDiscountConfig:o.publicDiscountConfig||[],companyName:o.companyName,companyContactNo:o.companyContactNo,companyEmail:o.companyEmail,companyAddress:o.companyAddress,companyWebsite:o.companyWebsite,companyPAN:o.companyPAN,companyGST:o.companyGST,companySAC:o.companySAC,companyCIN:o.companyCIN,termsAndConditions:o.termsAndConditions,piInstructions:o.piInstructions,bankName:o.bankName,bankBranch:o.bankBranch,bankIFSC:o.bankIFSC,bankAccountName:o.bankAccountName,bankAccount:o.bankAccount,headerTitle:o.headerTitle,headerSubtitle:o.headerSubtitle,headerDescription:o.headerDescription,headerLogo:o.headerLogo,sponsorLogos:o.sponsorLogos||[],footerText:o.footerText,footerLogo:o.footerLogo,contactEmail:o.contactEmail,contactPhone:o.contactPhone,footerLinks:o.footerLinks||[],amenities:o.amenities||[],basicAmenities:o.basicAmenities||[],specialRequirements:o.specialRequirements};return n.jsx(ue,{title:"Edit Exhibition",extra:n.jsx("a",{onClick:()=>i(Lt(o),{state:{exhibitionId:s}}),children:"Back to Details"}),children:n.jsx(ff,{initialValues:u,onSubmit:x,submitText:"Update Exhibition"})})},ih=({width:e,height:t,scale:r=1,position:s={x:0,y:0},isSelected:i=!1,onSelect:a=()=>{},onChange:o=()=>{},children:l,isEditable:d=!0})=>{const c=x=>{d&&(a(),x.cancelBubble=!0)},h=xt.useMemo(()=>{const x=[];for(let p=0;p<=e;p+=5)x.push(n.jsx(xo,{points:[p,0,p,t],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`v${p}`));for(let p=0;p<=t;p+=5)x.push(n.jsx(xo,{points:[0,p,e,p],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`h${p}`));return x},[e,t,r]);return n.jsxs(Ys,{x:s.x,y:s.y,width:e,height:t,onClick:c,children:[n.jsx(Lo,{width:e,height:t,fill:"#ffffff",stroke:i&&d?"#1890ff":"#d9d9d9",strokeWidth:i&&d?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/r,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/r}),n.jsx(Ys,{children:h}),n.jsx(Oi,{text:`${e}m  ${t}m`,fontSize:14/r,fill:"#666666",x:5,y:5}),l]})},Ny=({visible:e,width:t,height:r,onCancel:s,onSubmit:i})=>{const[a]=H.useForm();xt.useEffect(()=>{e&&a.setFieldsValue({width:t,height:r})},[e,t,r,a]);const o=()=>{a.validateFields().then(l=>{i(l),a.resetFields()})};return n.jsx(Ve,{title:"Edit Exhibition Space",open:e,onCancel:()=>{a.resetFields(),s()},onOk:o,destroyOnClose:!0,children:n.jsxs(H,{form:a,layout:"vertical",initialValues:{width:t,height:r},children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},xf=({hall:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isStallMode:d=!1})=>{const c=xt.useRef(null),h=xt.useRef(null),x=xt.useMemo(()=>{const v=[],{width:S,height:T}=e.dimensions,y=1;for(let w=0;w<=S;w+=y)v.push(n.jsx(xo,{points:[w,0,w,T],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`v${w}`));for(let w=0;w<=T;w+=y)v.push(n.jsx(xo,{points:[0,w,S,w],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`h${w}`));return v},[e.dimensions.width,e.dimensions.height,i]);xt.useEffect(()=>{var v;t&&h.current&&c.current&&(h.current.nodes([c.current]),(v=h.current.getLayer())==null||v.batchDraw())},[t]);const u=v=>{v.cancelBubble=!0;const S=v.target,T=S.x(),y=S.y(),w=Math.max(0,Math.min(T,o-e.dimensions.width)),k=Math.max(0,Math.min(y,l-e.dimensions.height));S.x(Math.round(w)),S.y(Math.round(k))},p=v=>{v.cancelBubble=!0;const S=v.target,T=Math.max(0,Math.min(S.x(),o-e.dimensions.width)),y=Math.max(0,Math.min(S.y(),l-e.dimensions.height));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{...e.dimensions,x:Math.round(T),y:Math.round(y)}})},g=v=>{v.cancelBubble=!0},f=v=>{if(!c.current)return;const S=c.current,T=S.scaleX(),y=S.scaleY();S.scaleX(1),S.scaleY(1);const w=Math.round(S.width()*T),k=Math.round(S.height()*y),b=S.x(),j=S.y(),A=Math.max(0,Math.min(b,o-w)),E=Math.max(0,Math.min(j,l-k));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{x:A,y:E,width:Math.max(5,Math.min(w,o-A)),height:Math.max(5,Math.min(k,l-E))}})},m=v=>{v.cancelBubble=!0,r==null||r(e)};return n.jsxs(Ys,{ref:c,x:e.dimensions.x,y:e.dimensions.y,width:e.dimensions.width,height:e.dimensions.height,draggable:!d&&!!s,onClick:m,onTap:m,onDragStart:g,onDragMove:u,onDragEnd:p,onTransformEnd:f,children:[n.jsx(Lo,{width:e.dimensions.width,height:e.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/i:1/i,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}),n.jsx(Ys,{children:x}),n.jsx(Oi,{text:e.name,fontSize:14/i,fill:"#000000",width:e.dimensions.width,align:"center",y:e.dimensions.height/2-7/i})]})},Fy=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},pf=({fixture:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isEditable:d=!0})=>{const c=xt.useRef(null),h=xt.useRef(null),[x,u]=_.useState("");_.useEffect(()=>{if(e.icon){const y=Fy(e.icon);u(y)}else u("")},[e.icon]);const[p]=fp(x);xt.useEffect(()=>{var y;t&&h.current&&c.current&&(h.current.nodes([c.current]),(y=h.current.getLayer())==null||y.batchDraw())},[t]);const g=y=>{y.cancelBubble=!0},f=y=>{y.cancelBubble=!0;const w=y.target,k=w.x(),b=w.y(),j=Math.max(0,Math.min(k,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height));w.x(Math.round(j)),w.y(Math.round(A))},m=y=>{y.cancelBubble=!0;const w=y.target,k=w.x(),b=w.y(),j=Math.max(0,Math.min(k,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height)),E=e._id||e.id;s==null||s({...e,_id:E,id:E,exhibitionId:e.exhibitionId,position:{x:Math.round(j),y:Math.round(A)}})},v=y=>{if(!c.current)return;const w=c.current,k=w.scaleX(),b=w.scaleY(),j=w.rotation();w.scaleX(1),w.scaleY(1);const A=Math.round(e.dimensions.width*k),E=Math.round(e.dimensions.height*b),C=w.x(),I=w.y(),F=Math.max(0,Math.min(C,o-A)),N=Math.max(0,Math.min(I,l-E)),z=e._id||e.id;s==null||s({...e,_id:z,id:z,exhibitionId:e.exhibitionId,position:{x:F,y:N},dimensions:{width:Math.max(.5,Math.min(A,o-F)),height:Math.max(.5,Math.min(E,l-N))},rotation:j})},S=y=>{y.cancelBubble=!0,r==null||r(e)},T=()=>{const y=e.borderColor||(t?"#1890ff":"#d9d9d9"),w=e.borderRadius!==void 0?e.borderRadius/i:3/i;return p?n.jsx(pp,{image:p,width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#ffffff",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}):n.jsx(Lo,{width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#f0f2f5",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5})};return n.jsxs(n.Fragment,{children:[n.jsxs(Ys,{ref:c,x:e.position.x,y:e.position.y,width:e.dimensions.width,height:e.dimensions.height,rotation:e.rotation||0,draggable:d&&!!s,onClick:S,onTap:S,onDragStart:g,onDragMove:f,onDragEnd:m,onTransformEnd:v,children:[T(),e.name&&e.showName!==!1&&n.jsx(Oi,{text:e.name,fontSize:12/i,fill:"#000000",width:e.dimensions.width,align:"center",y:-16/i})]}),t&&d&&n.jsx(xp,{ref:h,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(y,w)=>w.width<.5||w.height<.5?y:w})]})},Ry=({visible:e,x:t,y:r,onExhibitionClick:s,onHallClick:i,onStallClick:a,onFixtureClick:o,onClose:l})=>{if(!e)return null;const d=[{key:"exhibition",icon:n.jsx(ps,{}),label:"Exhibition Space",onClick:()=>{s(),l()}},{key:"hall",icon:n.jsx(ms,{}),label:"Add Hall",onClick:()=>{i(),l()}}];return a&&d.push({key:"stall",icon:n.jsx(yr,{}),label:"Add Stall",onClick:()=>{a(),l()}}),o&&d.push({key:"fixture",icon:n.jsx(Ro,{}),label:"Add Fixture",onClick:()=>{o(),l()}}),n.jsx("div",{style:{position:"fixed",top:r,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:n.jsx(lr,{items:d})})},Py=({stall:e,isSelected:t=!1,onSelect:r,onChange:s,hallWidth:i=0,hallHeight:a=0,hallX:o=0,hallY:l=0,scale:d=1,isDragging:c=!1})=>{const h=_.useRef(null),[x,u]=_.useState(!1),[p,g]=_.useState(!1),[f,m]=_.useState(!1);_.useEffect(()=>{m(window.innerWidth<768);const z=()=>{m(window.innerWidth<768)};return window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)},[]),_.useEffect(()=>{if(x&&!c)g(!0);else if(c)g(!1);else{const z=setTimeout(()=>{g(!1)},100);return()=>clearTimeout(z)}},[x,c]),_.useEffect(()=>{if(x&&h.current&&!c){if(f&&!t)return;h.current.getStage()&&h.current.moveToTop()}},[x,t,f,c]);const v=t||e.isSelected,S=_.useCallback(z=>{switch(z){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),T=_.useCallback(z=>{switch(z){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),y=_.useCallback(z=>{z.cancelBubble=!0;const U=z.target,R=U.x()-o,O=U.y()-l,X=Math.max(0,Math.min(R,i-e.dimensions.width)),re=Math.max(0,Math.min(O,a-e.dimensions.height));U.x(Math.round(X+o)),U.y(Math.round(re+l))},[o,l,i,a,e.dimensions.width,e.dimensions.height]),w=_.useCallback(z=>{if(z.cancelBubble=!0,!s)return;const U=z.target,R=U.x()-o,O=U.y()-l,X=Math.max(0,Math.min(R,i-e.dimensions.width)),re=Math.max(0,Math.min(O,a-e.dimensions.height));s({...e,id:e.id||e._id,_id:e._id||e.id,dimensions:{...e.dimensions,x:Math.round(X),y:Math.round(re)}})},[s,o,l,i,a,e]),k=_.useCallback(z=>{z.cancelBubble=!0},[]),b=_.useCallback(z=>{z.cancelBubble=!0,r&&!c&&r()},[r,c]),j=_.useCallback(()=>{f&&!v||c||u(!0)},[f,v,c]),A=_.useCallback(()=>{u(!1)},[]),E={x:0,y:0,width:10,height:10},C=e.dimensions||E,I=e.typeName||"Standard";e.ratePerSqm*C.width*C.height;const F=0,N=_.useMemo(()=>e.status!=="available"&&e.companyName?`${I} - ${C.width}${C.height}m - ${e.companyName}`:`${I} - ${C.width}${C.height}m`,[I,C.width,C.height,e.status,e.companyName]);return n.jsxs(Ys,{ref:h,x:C.x+o,y:C.y+l,width:C.width,height:C.height,draggable:!!s,onClick:b,onTap:b,onDragStart:k,onDragMove:y,onDragEnd:w,opacity:e.status==="available"?1:.7,cursor:e.status==="available"?"pointer":"default",onMouseEnter:j,onMouseLeave:A,listening:c?!1:!f||e.status==="available",transformsEnabled:c||f?"position":"all",children:[n.jsx(Lo,{width:C.width,height:C.height,fill:v?"rgba(24, 144, 255, 0.1)":T(e.status),stroke:v?"#1890ff":S(e.status),strokeWidth:v?2/d:1/d,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:c?0:f?2:3,shadowOffset:{x:1,y:1},shadowOpacity:c?0:.3,rotation:F,perfectDrawEnabled:!c,transformsEnabled:c?"position":"all",cornerRadius:.05}),n.jsx(Oi,{text:e.number,fontSize:Math.min(C.width,C.height)*.25,fill:"#000000",width:C.width,height:C.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!c,fontStyle:"bold",listening:!1}),v&&!c&&n.jsx(mp,{x:C.width-2,y:2,radius:Math.min(.8,C.width*.05),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/d,transformsEnabled:"position",listening:!1}),p&&!c&&n.jsxs(gp,{x:C.width/2,y:0,opacity:1,listening:!1,children:[n.jsx(yp,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),n.jsx(Oi,{text:N,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(N.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},Bc=_.memo(Py),Qi=({width:e,height:t,exhibitionWidth:r=100,exhibitionHeight:s=100,halls:i=[],stalls:a=[],fixtures:o=[],selectedHall:l=null,selectedFixture:d=null,onSelectHall:c=()=>{},onSelectFixture:h=()=>{},onHallChange:x=()=>{},onFixtureChange:u=()=>{},onExhibitionChange:p=()=>{},onAddHall:g=()=>{},onAddStall:f=()=>{},onAddFixture:m=()=>{},children:v,isStallMode:S=!1,isFixtureMode:T=!1,isPublicView:y=!1})=>{const w=_.useRef(null),k=_.useRef(null),b=_.useRef(null),[j,A]=_.useState(1),[E,C]=_.useState({x:0,y:0}),[I,F]=_.useState(!1),[N,z]=_.useState(!1),[U,R]=_.useState({visible:!1,x:0,y:0}),[O,X]=_.useState(!1),[re,ee]=_.useState(!1),[D,q]=_.useState(!1),[B,P]=_.useState(void 0);_.useEffect(()=>{const Fe=()=>{q(window.innerWidth<768)};return Fe(),window.addEventListener("resize",Fe),()=>{window.removeEventListener("resize",Fe)}},[]);const Z=_.useCallback(Fe=>{if(Fe.evt.preventDefault(),!w.current)return;const ze=w.current,Ke=j,Oe=ze.getPointerPosition(),Be={x:(Oe.x-ze.x())/Ke,y:(Oe.y-ze.y())/Ke},ut=1.15,At=Fe.evt.deltaY<0?Ke*ut:Ke/ut,jr=Math.min(Math.max(.1,At),20),Pn={x:Oe.x-Be.x*jr,y:Oe.y-Be.y*jr};A(jr),C(Pn)},[j]),se=_.useCallback(()=>{if(!w.current)return;const Fe=w.current,ze=Math.min(j*1.15,20),Ke=Fe.width()/2,Oe=Fe.height()/2,Be={x:(Ke-E.x)/j,y:(Oe-E.y)/j},ut={x:Ke-Be.x*ze,y:Oe-Be.y*ze};A(ze),C(ut)},[j,E]),ie=_.useCallback(()=>{if(!w.current)return;const Fe=w.current,ze=Math.max(j/1.15,.1),Ke=Fe.width()/2,Oe=Fe.height()/2,Be={x:(Ke-E.x)/j,y:(Oe-E.y)/j},ut={x:Ke-Be.x*ze,y:Oe-Be.y*ze};A(ze),C(ut)},[j,E]),de=_.useCallback(Fe=>{Fe?(P(nl.pixelRatio),nl.pixelRatio=D?.8:1):B&&(nl.pixelRatio=B)},[B,D]),G=_.useCallback(Fe=>{if(Fe.target===w.current&&(R({...U,visible:!1}),z(!0),de(!0),k.current)){if(y){const ze=D?{x:-10,y:-10,width:e+20,height:t+20}:void 0;k.current.cache(ze)}if(k.current.hitGraphEnabled(!1),y&&w.current){const ze=w.current.container();ze.style.cursor="grabbing",ze.classList.add("dragging"),w.current.batchDraw(),k.current.getChildren().forEach(Oe=>{if(Oe.shadowForStrokeEnabled&&(Oe._savedShadowForStroke=Oe.shadowForStrokeEnabled(),Oe.shadowForStrokeEnabled(!1)),Oe.perfectDrawEnabled&&(Oe._savedPerfectDraw=Oe.perfectDrawEnabled(),Oe.perfectDrawEnabled(!1)),Oe.cache&&!Oe.isCached&&Oe.width&&Oe.height){Oe._dragCached=!0;try{D?Oe.cache({offset:10,pixelRatio:.8}):Oe.cache()}catch{Oe._dragCached=!1}}})}}},[U,y,de,D,e,t]),V=_.useCallback(Fe=>{if(y&&Fe.target===w.current){if(Fe.evt&&Fe.evt._dragSkipUpdate)return;if(Fe.evt&&(Fe.evt._dragSkipUpdate=!0),w.current&&k.current){const ze=D?.85:.7;Math.random()>ze&&w.current.batchDraw()}return}Fe.target===w.current&&D&&k.current&&(Fe.cancelBubble=!0)},[D,y]),ae=_.useCallback(Fe=>{if(Fe.target===w.current){if(C({x:Fe.target.x(),y:Fe.target.y()}),de(!1),k.current&&(k.current.hitGraphEnabled(!0),y&&k.current.clearCache(),y&&w.current)){const ze=w.current.container();ze.style.cursor="",ze.classList.remove("dragging"),k.current.getChildren().forEach(Oe=>{Oe._savedShadowForStroke!==void 0&&(Oe.shadowForStrokeEnabled(Oe._savedShadowForStroke),delete Oe._savedShadowForStroke),Oe._savedPerfectDraw!==void 0&&(Oe.perfectDrawEnabled(Oe._savedPerfectDraw),delete Oe._savedPerfectDraw),Oe._dragCached&&(Oe.clearCache(),delete Oe._dragCached)})}setTimeout(()=>{w.current&&w.current.batchDraw()},50),z(!1)}},[y,de]),ge=_.useCallback(()=>{F(!0),document.body.style.cursor=N?"grabbing":"grab"},[N]),te=_.useCallback(()=>{F(!1),document.body.style.cursor="default"},[]),be=Fe=>{var Ke,Oe,Be;const ze=Fe.target.getClassName();if(ze==="Stage"||ze==="Layer"){R({...U,visible:!1});return}if(ze==="Group"||ze==="Rect"){c(null),h(null);const ut=(Ke=w.current)==null?void 0:Ke.getPointerPosition();if(ut&&Ie(ut)){const{x:At,y:jr}=ut,{x:Pn,y:sa}=((Oe=w.current)==null?void 0:Oe.position())||{x:0,y:0},{x:ia,y:aa}=((Be=w.current)==null?void 0:Be.scale())||{x:1,y:1},Jo=(At-Pn)/ia,Zo=(jr-sa)/aa;R({x:Jo,y:Zo,visible:!0})}else R({...U,visible:!1})}else R({...U,visible:!1})},Ie=Fe=>{if(!r||!s||!w.current)return!1;const{x:ze,y:Ke}=Fe,{x:Oe,y:Be}=w.current.position(),{x:ut}=w.current.scale(),At={x:(ze-Oe)/ut,y:(Ke-Be)/ut};return At.x>=0&&At.x<=r&&At.y>=0&&At.y<=s},ye=_.useCallback(()=>{c(null),h(null),X(!0),ee(!0),R({...U,visible:!1})},[c,h,U]),Me=_.useCallback(Fe=>{p(Fe),ee(!1)},[p]),Ue=()=>{X(!0),ee(!0),R({...U,visible:!1})},wt=()=>{g(),R({...U,visible:!1})},qt=()=>{f(),R({...U,visible:!1})};_.useEffect(()=>{if(e>0&&t>0&&r>0&&s>0){const Fe=S?20:40,ze=e-Fe*2,Ke=t-Fe*2,Oe=ze/r,Be=Ke/s,At=Math.min(Oe,Be),jr=(e-r*At)/2,Pn=(t-s*At)/2;A(At),C({x:jr,y:Pn}),w.current&&w.current.batchDraw()}},[e,t,r,s,S]);const Wt=xt.Children.map(v,Fe=>xt.isValidElement(Fe)?xt.cloneElement(Fe,{scale:j,position:E}):Fe),Rr=n.jsx(ih,{width:r,height:s,scale:j,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return e<=0||t<=0||r<=0||s<=0?n.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:I?N?"grabbing":"grab":"default"},children:[n.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:n.jsxs(xe,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[n.jsx(ne,{icon:n.jsx(kx,{}),onClick:ie,disabled:j<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),n.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(j*100),"%"]}),n.jsx(ne,{icon:n.jsx(Cx,{}),onClick:se,disabled:j>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),n.jsxs(vp,{ref:w,width:e,height:t,onClick:be,draggable:!0,onDragStart:G,onDragMove:V,onDragEnd:ae,onMouseEnter:ge,onMouseLeave:te,onWheel:Z,x:E.x,y:E.y,scaleX:j,scaleY:j,perfectDrawEnabled:!N&&!y,hitGraphEnabled:!N,pixelRatio:N?D?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:y?D?5:3:0,children:[y&&n.jsx(bp,{ref:b,listening:!1,children:Rr}),n.jsxs(wp,{ref:k,imageSmoothingEnabled:!N||!y,children:[!y&&n.jsx(ih,{width:r,height:s,scale:j,position:{x:0,y:0},isSelected:O,onSelect:T?void 0:ye,onChange:S||T?void 0:p,isEditable:!S&&!T}),i.map(Fe=>n.jsx(xf,{hall:Fe,isSelected:(l==null?void 0:l.id)===Fe.id,onSelect:()=>c(Fe),onChange:S||T?void 0:x,scale:j,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isStallMode:S||T},Fe._id||Fe.id)),a.map(Fe=>{const ze=Fe._id||Fe.id,Ke=i.find(Oe=>Oe.id===Fe.hallId||Oe._id===Fe.hallId);return Ke?n.jsx(Bc,{stall:{...Fe,_id:ze,id:ze},hallX:Ke.dimensions.x,hallY:Ke.dimensions.y,hallWidth:Ke.dimensions.width,hallHeight:Ke.dimensions.height,scale:j,isDragging:N&&y},ze):null}),o.map(Fe=>{const ze=Fe._id||Fe.id,Oe=((d==null?void 0:d._id)||(d==null?void 0:d.id))===ze;return n.jsx(pf,{fixture:{...Fe,_id:ze,id:ze},isSelected:Oe,onSelect:()=>h(Fe),onChange:T?u:void 0,scale:j,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isEditable:T},ze)}),Wt]})]}),n.jsx(Ry,{visible:U.visible,x:U.x,y:U.y,onExhibitionClick:Ue,onHallClick:wt,onStallClick:qt,onClose:()=>R({...U,visible:!1})}),n.jsx(Ny,{visible:re,width:r,height:s,onCancel:()=>ee(!1),onSubmit:Me})]})},Dy=({visible:e,hall:t,exhibitionWidth:r,exhibitionHeight:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=H.useForm();xt.useEffect(()=>{e&&(t?l.setFieldsValue({name:t.name,width:t.dimensions.width,height:t.dimensions.height}):l.setFieldsValue({name:"",width:Math.min(10,r),height:Math.min(10,s)}))},[e,t,r,s,l]);const d=async()=>{var u,p;const h=await l.validateFields(),x=t?{...t,_id:t._id,id:t.id||t._id,name:h.name,dimensions:{x:((u=t.dimensions)==null?void 0:u.x)||0,y:((p=t.dimensions)==null?void 0:p.y)||0,width:h.width,height:h.height},exhibitionId:t.exhibitionId}:{name:h.name,dimensions:{x:0,y:0,width:h.width,height:h.height}};a(x),l.resetFields()},c=()=>{t&&o&&Ve.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${t.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>o(t)})};return n.jsx(Ve,{title:t?"Edit Hall":"Add New Hall",open:e,onCancel:()=>{l.resetFields(),i()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:n.jsxs(H,{form:l,layout:"vertical",style:{marginTop:"16px"},children:[n.jsx(H.Item,{name:"name",label:n.jsxs("span",{style:{color:"#000"},children:["Hall Name ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:n.jsx(fe,{placeholder:"Enter hall name"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[n.jsx(H.Item,{name:"width",label:n.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:r,message:`Width cannot exceed ${r} meters`}],children:n.jsx(yt,{min:5,max:r,style:{width:"100%"},placeholder:"Enter width"})}),n.jsx(H.Item,{name:"height",label:n.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:s,message:`Height cannot exceed ${s} meters`}],children:n.jsx(yt,{min:5,max:s,style:{width:"100%"},placeholder:"Enter height"})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[n.jsx(xe,{children:t&&o&&n.jsx(ne,{className:"delete-button",icon:n.jsx(or,{}),onClick:c,children:"Delete Hall"})}),n.jsxs(xe,{children:[n.jsx(ne,{onClick:()=>{l.resetFields(),i()},children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:d,className:"update-button",children:t?"Update Hall":"Create Hall"})]})]})]})})},{Title:Ly}=Le,Oy=({visible:e,stall:t,hall:r,exhibition:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=H.useForm(),[d,c]=_.useState([]),[h,x]=_.useState(!1),u=(v,S,T,y,w)=>{const b=[...T].sort((A,E)=>{const C=Math.floor(A.dimensions.y/5),I=Math.floor(E.dimensions.y/5);return C===I?A.dimensions.x-E.dimensions.x:A.dimensions.y-E.dimensions.y}),j=(A,E)=>A+v>y||E+S>w?!1:!b.some(C=>{const I=C.dimensions.x,F=C.dimensions.y,N=C.dimensions.width,z=C.dimensions.height,U=1;return!(A+v+U<=I||A>=I+N+U||E+S+U<=F||E>=F+z+U)});for(const A of b){const E=A.dimensions.x+A.dimensions.width+1,C=A.dimensions.y;if(j(E,C))return{x:E,y:C};const I=A.dimensions.x,F=A.dimensions.y+A.dimensions.height+1;if(j(I,F))return{x:I,y:F}}for(let A=0;A<w;A+=5)for(let E=0;E<y;E+=5)if(j(E,A))return{x:E,y:A};return{x:0,y:0}};_.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const v={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",v),l.setFieldsValue(v)}else r&&!l.getFieldValue("status")&&l.setFieldsValue({status:"available",width:Math.min(20,r.dimensions.width/4),height:Math.min(20,r.dimensions.height/4),ratePerSqm:0})},[t,r,l]),_.useEffect(()=>{e&&(async()=>{var S;try{x(!0);const T=await Ms.getStallTypes();console.log("Fetched stall types:",T.data);const y=((S=s.stallRates)==null?void 0:S.map(k=>k.stallTypeId))||[];console.log("Configured stall type IDs:",y);const w=T.data.filter(k=>k.status==="active"&&k._id&&y.includes(k._id));console.log("Filtered stall types:",w),c(w)}catch(T){console.error("Failed to fetch stall types:",T)}finally{x(!1)}})()},[e,s.stallRates]);const p=v=>{var T;console.log("Stall type changed to:",v);const S=(T=s.stallRates)==null?void 0:T.find(y=>y.stallTypeId===v);console.log("Found stall rate:",S),S&&l.setFieldsValue({ratePerSqm:S.rate})},g=()=>{l.resetFields(),i()},f=()=>{if(console.log("Hall data:",r),!r||!r._id&&!r.id){je.error("Invalid hall selected. Please try again.");return}l.validateFields().then(v=>{var w;const S=r._id||r.id;if(!S){je.error("Hall ID is missing. Please select a hall again.");return}const T=t?{x:t.dimensions.x,y:t.dimensions.y}:u(v.width,v.height,((w=s.stalls)==null?void 0:w.filter(k=>k.hallId===S))||[],r.dimensions.width,r.dimensions.height),y={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:v.number,stallTypeId:v.stallTypeId,dimensions:{x:T.x,y:T.y,width:v.width,height:v.height},ratePerSqm:v.ratePerSqm,status:v.status,hallId:S};console.log("Submitting stall data:",y),a(y)})},m=v=>{switch(v){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return n.jsx(n.Fragment,{children:n.jsx(Ve,{title:n.jsxs(xe,{children:[n.jsx(yr,{style:{fontSize:"20px"}}),n.jsx(Ly,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:e,onCancel:g,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[n.jsxs(xe,{size:"middle",children:[t&&o&&n.jsx(ne,{danger:!0,icon:n.jsx(or,{}),onClick:()=>o(t),children:"Delete"}),n.jsx(ne,{onClick:g,children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:f,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:n.jsxs(H,{form:l,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[n.jsx(H.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:n.jsx(fe,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),n.jsx(H.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Pe,{loading:h,placeholder:"Select stall type",size:"large",onChange:p,children:d.map(v=>n.jsx(Pe.Option,{value:v._id,children:v.name},v._id))})}),n.jsx(nt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),n.jsxs(xe,{style:{width:"100%",gap:"16px"},children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:n.jsx(yt,{min:1,max:(r==null?void 0:r.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:n.jsx(yt,{min:1,max:(r==null?void 0:r.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),n.jsx(nt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),n.jsx(H.Item,{name:"ratePerSqm",label:"Rate per sq.m ()",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:n.jsx(yt,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"",disabled:!0,formatter:v=>`${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>{const S=v?Number(v.replace(/\\s?|(,*)/g,"")):0;return isNaN(S)?0:S}})}),n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[n.jsx(Pe.Option,{value:"available",children:n.jsxs(xe,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("available")}}),"Available"]})}),n.jsx(Pe.Option,{value:"booked",children:n.jsxs(xe,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("booked")}}),"Booked"]})}),n.jsx(Pe.Option,{value:"reserved",children:n.jsxs(xe,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("reserved")}}),"Reserved"]})})]})})]})})})},ah=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},By=({name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIcons:o,borderColor:l=null,borderRadius:d=0})=>{_.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIconAvailable:!!o[t],borderColor:l,borderRadius:d})},[e,t,r,s,i,a,o,l,d]);const c=o[t]||"";return n.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[n.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${d||4}px`,backgroundColor:r||"#f0f0f0",transform:`rotate(${s}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:l?`1px solid ${l}`:"1px solid rgba(0,0,0,0.05)"},children:a?n.jsx("img",{src:a,alt:e,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):n.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:c})}),i&&n.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:e}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[n.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),n.jsx("span",{children:""}),n.jsx("span",{children:r}),s>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:[s,""]})]}),l&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:["Border: ",l]})]}),d>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:["Radius: ",d,"px"]})]})]})]})},{Text:My}=Le,Tl=({activeKey:e,form:t,fixture:r,exhibitionWidth:s,exhibitionHeight:i,selectedType:a,showName:o,iconFileList:l,fixtureTypes:d,fixtureIcons:c,defaultColors:h,defaultDimensions:x,colorPresets:u,uploadProps:p,iconPreviewVisible:g=!1,previewImage:f="",onTypeChange:m,onColorChange:v,onShowNameChange:S,onIconPreviewCancel:T=()=>{}})=>{switch(e){case"basic":return y();case"position":return w();case"appearance":return k();default:return y()}function y(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(H.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:n.jsx(fe,{placeholder:"Enter fixture name",prefix:n.jsx(Zr,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(H.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:n.jsx(Ir,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:b=>{S(b),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),n.jsx(H.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:n.jsx(Pe,{placeholder:"Select fixture type",onChange:m,options:d.map(b=>({...b,label:n.jsxs(xe,{children:[n.jsx("span",{style:{fontSize:16},children:c[b.value]}),n.jsx("span",{children:b.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function w(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(ue,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:0,max:s,step:.1,precision:1,placeholder:"X position"})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"Y position"})})})]})}),n.jsx(ue,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),n.jsx(ue,{size:"small",title:n.jsxs("span",{children:[n.jsx(Ax,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsx(H.Item,{name:"rotation",noStyle:!0,children:n.jsx(gu,{min:0,max:360,marks:{0:"0",90:"90",180:"180",270:"270",360:"360"},tooltip:{formatter:b=>`${b}`},style:{marginTop:10},keyboard:!1})})})]})}function k(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(H.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(b,j)=>{try{return j?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:n.jsx(hd,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,onChange:v,style:{width:"100%"}})}),n.jsx(H.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:n.jsx(hd,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,style:{width:"100%"}})}),n.jsx(H.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:n.jsx(yt,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),n.jsxs(ue,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[n.jsx("div",{style:{marginBottom:0},children:n.jsx(Ri,{...p,children:l.length<1&&n.jsxs("div",{children:[n.jsx(Ix,{style:{fontSize:20}}),n.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),n.jsx(My,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),n.jsx(H.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:n.jsx(fe,{placeholder:"https://example.com/icon.png",prefix:n.jsx(Nx,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(Ve,{open:g,title:"Icon Preview",footer:null,onCancel:T,children:n.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:f})})]})}},$y=e=>[{key:"basic",label:n.jsxs("span",{children:[n.jsx(ms,{}),"Basic Info"]}),children:n.jsx(Tl,{...e,activeKey:"basic"})},{key:"position",label:n.jsxs("span",{children:[n.jsx(os,{}),"Position"]}),children:n.jsx(Tl,{...e,activeKey:"position"})},{key:"appearance",label:n.jsxs("span",{children:[n.jsx(Pi,{}),"Appearance"]}),children:n.jsx(Tl,{...e,activeKey:"appearance"})}],{Text:Qk,Title:Jk}=Le,{TabPane:Zk}=Kt,Uy=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],wa={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},Ln={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},_l={sofa:"",chair:"",table:"",desk:"",plant:"",entrance:"",exit:"",info:"",restroom:"",food:"",custom:""},zy=({visible:e,fixture:t,onCancel:r,onSubmit:s,onDelete:i,exhibitionWidth:a,exhibitionHeight:o})=>{const[l]=H.useForm(),[d,c]=_.useState(!1),[h,x]=_.useState(""),[u,p]=_.useState("basic"),[g,f]=_.useState(""),[m,v]=_.useState([]),[S,T]=_.useState(!1),[y,w]=_.useState(""),{message:k}=Xt.useApp(),[b,j]=_.useState("#f0f0f0"),[A,E]=_.useState("New Fixture"),[C,I]=_.useState("chair"),[F,N]=_.useState(0),[z,U]=_.useState(!0),[R,O]=_.useState(null),[X,re]=_.useState(0);_.useEffect(()=>{if(e)if(t){const te=se(t.color),be=Ln[t.type]||"#f0f0f0",Ie=te||be;console.log("Setting up fixture colors:",{original:t.color,normalized:te,fallback:be,final:Ie}),j(Ie),E(t.name),I(t.type),N(t.rotation||0),x(t.type),U(t.showName!==!1),O(t.borderColor||null),re(t.borderRadius||0)}else{const te="chair",be=Ln[te];j(be),E("New Fixture"),I(te),N(0),x(te),U(!0),O(null),re(0)}},[e,t]),_.useEffect(()=>{if(e&&l){if(t){const te=se(t.color),be=Ln[t.type]||"#f0f0f0",Ie=te||be;l.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:Ie,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const ye=t.icon?ah(t.icon):"";f(ye),t.icon?v([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:ye,thumbUrl:ye}]):v([])}else{const te="chair",be=Ln[te];l.setFieldsValue({name:"New Fixture",type:te,position:{x:Math.floor(a/2),y:Math.floor(o/2)},dimensions:wa[te],rotation:0,color:be,icon:"",showName:!0,borderColor:null,borderRadius:0}),f(""),v([])}p("basic")}},[e,t,l,a,o]);const ee=()=>{if(l&&e)try{const te=l.getFieldsValue(!0);if(te.name&&E(te.name),te.type&&I(te.type),te.rotation!==void 0&&N(te.rotation),te.color){const be=se(te.color);be&&j(be)}if(te.showName!==void 0&&U(te.showName),te.borderColor!==void 0){const be=te.borderColor?se(te.borderColor):null;O(be)}te.borderRadius!==void 0&&re(te.borderRadius)}catch(te){console.log("Error updating preview",te)}};_.useEffect(()=>{if(l&&e)return l.getFieldsValue,ee(),()=>{}},[l,e]);const D=te=>{if(x(te),I(te),!t){const be=Ln[te]||Ln.custom;l.setFieldsValue({dimensions:wa[te]||wa.custom,color:be}),j(be)}},q=te=>{const be=se(te);l.setFieldValue("color",be),j(be);const Ie=Object.entries(Ln).find(([ye,Me])=>Me.toLowerCase()===be.toLowerCase());Ie&&!t&&(l.setFieldValue("type",Ie[0]),x(Ie[0]),I(Ie[0]))},B=()=>(console.log("Rendering fixture preview with:",{name:A,type:C,color:b,rotation:F,showName:z,iconUrl:g,borderColor:R,borderRadius:X}),n.jsx(By,{name:A,type:C,color:b,rotation:F,showName:z,iconUrl:g,defaultIcons:_l,borderColor:R,borderRadius:X})),P=({file:te,fileList:be})=>{var Ie;if(te.status==="uploading"&&v(be),te.status==="done"){k.success(`${te.name} uploaded successfully`);let Me=(((Ie=te.response)==null?void 0:Ie.url)||"").replace(/^\/api\/uploads\//,"");Me&&!Me.startsWith("fixtures/")&&(Me=`fixtures/${Me.replace(/^\//,"")}`),console.log("Icon path stored in form:",Me),l.setFieldValue("icon",Me);const Ue=ah(Me);console.log("Using direct backend URL:",Ue),f(Ue);const wt=te.name.toLowerCase().endsWith(".svg"),qt=be.map(Wt=>Wt.uid===te.uid?{...Wt,url:Ue,thumbUrl:Ue,type:wt?"image/svg+xml":Wt.type}:Wt);v(qt),console.log("Form values after icon upload:",l.getFieldsValue(!0))}te.status==="error"&&(k.error(`${te.name} upload failed.`),v(be.filter(ye=>ye.uid!==te.uid)))},Z={name:"file",action:`${_e.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:m,onChange:P,onPreview:te=>{w(te.url||te.thumbUrl||""),T(!0)},onRemove:()=>(f(""),v([]),l.setFieldValue("icon",""),console.log("Form values after icon removal:",l.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:n.jsx(or,{style:{color:"#ff4d4f"}})}},se=te=>{try{if(!te)return"#f0f0f0";if(typeof te=="object"&&te!==null){if(typeof te.toHexString=="function")return te.toHexString();if(te.rgb||te.hex)return te.hex||`rgb(${te.rgb.r},${te.rgb.g},${te.rgb.b})`}if(typeof te=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(te))return te;if(/^([0-9A-F]{3}){1,2}$/i.test(te))return`#${te}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(te))return te}return"#f0f0f0"}catch(be){return console.error("Error normalizing color:",be),"#f0f0f0"}},ie=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],de=xt.useCallback(()=>{t&&i&&i(t)},[t,i]),G=te=>{p(te),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},V=$y({form:l,fixture:t,exhibitionWidth:a,exhibitionHeight:o,selectedType:h,showName:z,iconFileList:m,fixtureTypes:Uy,fixtureIcons:_l,defaultColors:Ln,defaultDimensions:wa,colorPresets:ie,uploadProps:Z,iconPreviewVisible:S,previewImage:y,onTypeChange:D,onColorChange:q,onShowNameChange:te=>U(te),onIconPreviewCancel:()=>T(!1),activeKey:u}),ae=async()=>{try{c(!0);const te=await l.validateFields();E(te.name),I(te.type),N(te.rotation||0),j(se(te.color)),U(te.showName),O(te.borderColor?se(te.borderColor):null),re(te.borderRadius||0);let be="";te.icon?be=ge(te.icon):t!=null&&t.icon&&(be=t.icon),console.log("Form values being submitted:",{name:te.name,type:te.type,color:te.color,icon:te.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:be,showName:te.showName,borderColor:te.borderColor,borderRadius:te.borderRadius});const Ie=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",ye=te.color?se(te.color):(t==null?void 0:t.color)||"#f0f0f0",Me=te.borderColor?se(te.borderColor):null,Ue={...t,id:Ie,_id:Ie,name:te.name,type:te.type,position:te.position,dimensions:te.dimensions,rotation:te.rotation,color:ye,icon:be,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:Me,borderRadius:te.borderRadius||0};Ie&&(Ue.showName=te.showName),console.log("Submitting fixture with icon path:",be),console.log("Color being submitted:",ye),await s(Ue),r()}catch(te){console.error("Fixture submission failed:",te),k.error("Failed to save fixture. Please check the form and try again.")}finally{c(!1)}},ge=te=>{if(!te||typeof te!="string")return"";if(te.startsWith("fixtures/")&&!te.includes("?")&&!te.includes("http"))return te;let be=te.replace(/^\/api\/uploads\//,"");if(be=be.replace(/^\//,""),be.includes("?")||be.includes("http")){const Ie=be.split("?")[0].split("/").pop()||"";if(Ie)return`fixtures/${Ie}`}return be&&!be.startsWith("fixtures/")?`fixtures/${be}`:be};return n.jsxs(Ve,{title:n.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[n.jsx("span",{style:{fontSize:24,marginRight:8},children:t?_l[t.type]:""}),n.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:e,onCancel:r,confirmLoading:d,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx("div",{children:t&&i&&n.jsx(ne,{danger:!0,icon:n.jsx(or,{}),onClick:de,style:{borderRadius:"6px"},children:"Delete"})}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx(ne,{onClick:r,icon:n.jsx(Fx,{}),style:{borderRadius:"6px"},children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:ae,icon:n.jsx(fs,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),B(),n.jsx(H,{form:l,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:ee,children:n.jsx(Kt,{activeKey:u,onChange:G,items:V,tabBarStyle:{marginBottom:16},centered:!0})})]})},qy=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=$e(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Wy=()=>{var g;const{id:e}=Fr(),t=Fn(),r=Je(),s=it(),i=((g=t.state)==null?void 0:g.exhibitionId)||e,{currentExhibition:a}=$e(f=>f.exhibition),o=_.useRef(null),[l,d]=_.useState({width:100,height:100}),[c,h]=_.useState({width:0,height:0}),[x]=H.useForm();_.useEffect(()=>{if(!i){je.error("Exhibition ID not found"),r("/exhibition");return}s(Br(i))},[i,s,r]),_.useEffect(()=>{a!=null&&a.dimensions&&(d(a.dimensions),x.setFieldsValue(a.dimensions))},[a,x]),_.useEffect(()=>{const f=()=>{o.current&&h({width:o.current.clientWidth,height:o.current.clientHeight})};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const u=async()=>{try{const f=await x.validateFields();await gt.updateExhibition(i,{dimensions:f}),je.success("Exhibition space saved successfully"),await s(Br(i)).unwrap(),r(Lt(a,"layout"),{state:{exhibitionId:i}})}catch{je.error("Failed to save exhibition space")}},p=f=>{d(m=>({...m,...f})),x.setFieldsValue(f)};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(qy,{exhibitionId:i}),n.jsx(ue,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("span",{children:"Exhibition Space Setup"}),n.jsx(ne,{type:"primary",icon:n.jsx(fs,{}),onClick:u,children:"Save and Continue"})]}),children:n.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[n.jsx("div",{style:{flex:"0 0 300px"},children:n.jsxs(H,{form:x,layout:"vertical",initialValues:l,children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},onChange:f=>p({width:f||10})})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},onChange:f=>p({height:f||10})})})]})}),n.jsx("div",{ref:o,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:n.jsx(Xi,{children:n.jsx(Qi,{width:c.width,height:c.height,exhibitionWidth:l.width,exhibitionHeight:l.height,onExhibitionChange:p})})})]})})]})},Hy=({exhibitionId:e})=>{const t=Je(),{currentExhibition:r}=$e(s=>s.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>t(Lt(r),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Vy=()=>{var l,d,c,h,x;const{id:e}=Fr(),t=Fn(),r=Je(),s=it(),i=((l=t.state)==null?void 0:l.exhibitionId)||e,{currentExhibition:a,halls:o}=$e(u=>u.exhibition);return _.useEffect(()=>{i&&(s(Br(i)),s(un(i)))},[i,s]),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Hy,{exhibitionId:i}),n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(ue,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(ps,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(ue.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),n.jsx(ne,{type:"primary",onClick:()=>r(Lt(a,"space"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(ue,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(ms,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(ue.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),n.jsx(ne,{type:"primary",disabled:!((d=a==null?void 0:a.dimensions)!=null&&d.width)||!((c=a==null?void 0:a.dimensions)!=null&&c.height),onClick:()=>r(Lt(a,"halls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(ue,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(yr,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(ue.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),n.jsx(ne,{type:"primary",disabled:!o.length,onClick:()=>r(Lt(a,"stalls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(ue,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(Ro,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(ue.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),n.jsx(ne,{type:"primary",disabled:!((h=a==null?void 0:a.dimensions)!=null&&h.width)||!((x=a==null?void 0:a.dimensions)!=null&&x.height),onClick:()=>r(Lt(a,"fixtures"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},Gy=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=$e(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Yy=()=>{var w,k,b;const{id:e}=Fr(),t=Fn(),r=Je(),s=it(),i=((w=t.state)==null?void 0:w.exhibitionId)||e,{currentExhibition:a,halls:o}=$e(j=>j.exhibition),l=_.useRef(null),[d,c]=je.useMessage(),[h,x]=_.useState(!1),[u,p]=_.useState(null),[g,f]=_.useState({width:0,height:0});_.useEffect(()=>{const j=()=>{if(l.current){const{clientWidth:E,clientHeight:C}=l.current;f({width:Math.max(E||400,400),height:Math.max(C||400,400)})}};j();const A=new ResizeObserver(j);return l.current&&A.observe(l.current),window.addEventListener("resize",j),()=>{A.disconnect(),window.removeEventListener("resize",j)}},[]),_.useEffect(()=>{if(!i){d.error("Exhibition ID not found"),r("/exhibition");return}s(Br(i))},[i,s,r,d]),_.useEffect(()=>{var j,A;if(a){if(!((j=a.dimensions)!=null&&j.width)||!((A=a.dimensions)!=null&&A.height)){d.info("Please set up exhibition space first"),r(Lt(a,"space"),{state:{exhibitionId:i}});return}s(un(i))}},[a,i,s,r,d]);const m=()=>{p(null),x(!0)},v=j=>{p(j),x(!!j)},S=async j=>{var A;try{j.id?(await gt.updateHall(i,j.id,j),d.success("Hall updated successfully"),x(!1)):(await gt.createHall(i,j),d.success("Hall created successfully"),x(!1)),s(un(i))}catch(E){console.error("Hall operation failed:",E),((A=E.response)==null?void 0:A.status)===409?d.warning({content:E.response.data.message,duration:6,style:{marginTop:"20vh"}}):(d.error(E.message||"Failed to save hall"),x(!1))}},T=async j=>{var A,E;try{const C=j._id||j.id;if(!C)throw new Error("Hall ID is required");await gt.deleteHall(i,C),d.success("Hall deleted successfully"),x(!1),p(null),s(un(i))}catch(C){console.error("Failed to delete hall:",C),d.error(((E=(A=C.response)==null?void 0:A.data)==null?void 0:E.message)||"Failed to delete hall")}},y=async()=>{try{await gt.saveLayout(i,o),d.success("Layout saved successfully")}catch{d.error("Failed to save layout")}};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(Gy,{exhibitionId:i}),c,n.jsx(ue,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(xe,{children:[n.jsx("span",{children:"Hall Management"}),n.jsx(ne,{icon:n.jsx(yu,{}),onClick:()=>r(Lt(a,"space"),{state:{exhibitionId:i}}),children:"Back to Space Setup"})]}),n.jsxs(xe,{children:[n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),onClick:m,children:"Add Hall"}),n.jsx(ne,{type:"primary",icon:n.jsx(fs,{}),onClick:y,disabled:!o.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:n.jsx("div",{ref:l,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Xi,{children:g.width>0&&g.height>0&&(a==null?void 0:a.dimensions)&&n.jsx(Qi,{width:g.width,height:g.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:o,selectedHall:u,onSelectHall:v,onHallChange:S,onAddHall:m})})})}),n.jsx(Dy,{visible:h,hall:u,onCancel:()=>x(!1),onSubmit:S,onDelete:T,exhibitionWidth:((k=a==null?void 0:a.dimensions)==null?void 0:k.width)||100,exhibitionHeight:((b=a==null?void 0:a.dimensions)==null?void 0:b.height)||100})]})},Ky=we(Ve)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,Xy=we.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Ei=we.div`
  padding: 24px 32px 32px;
`,Qy=we.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,Jy=we.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;we.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;we.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;we.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;we.div`
  border: 1px solid ${e=>e.selected?"#4b47b9":"#e6e6f0"};
  background: ${e=>e.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${e=>e.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${e=>e.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${e=>e.selected?"#4b47b9":"white"};
    border: 2px solid ${e=>e.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const Zy=we(ue)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;we(ne)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;we.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;we(ue)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;we(fe)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const kl=we(ne)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;we(We)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;we.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;we(Yi)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;we.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;we.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;we.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;we.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;we.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px  3) + (16px  2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;we(ue)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const oh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],exhibition:i})=>{const[a,o]=_.useState([]);_.useEffect(()=>{let p=[...(e.getFieldValue("selectedStalls")||[]).map(g=>String(g))];if(r){const g=String(r);p.some(f=>f===g)||p.push(g)}s.length>0&&s.forEach(g=>{const f=String(g);p.some(m=>m===f)||p.push(f)}),console.log("StallDetailsStep - Initial stalls after normalization:",p),e.setFieldsValue({selectedStalls:p}),o(p)},[e,r,s]),_.useEffect(()=>{if(a.length>0){const x=e.getFieldValue("selectedStalls")||[],u=new Set(x.map(f=>String(f))),p=new Set(a.map(f=>String(f)));let g=u.size!==p.size;if(!g){for(const f of p)if(!u.has(f)){g=!0;break}}if(g){console.log("Syncing form with selected stalls:",a);const f=a.map(m=>String(m));e.setFieldsValue({selectedStalls:f}),e.validateFields(["selectedStalls"]).catch(m=>{})}}},[a,e]);const l=_.useMemo(()=>!t||t.length===0?[]:t.filter(x=>a.includes(x.id)),[t,a]),d=_.useMemo(()=>{var y,w,k;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const x=t.filter(b=>a.includes(b.id)),u=x.reduce((b,j)=>b+(j.price||j.ratePerSqm*j.dimensions.width*j.dimensions.height),0),g=(((y=i==null?void 0:i.publicDiscountConfig)==null?void 0:y.filter(b=>b.isActive))||[]).map(b=>{const j=b.type==="percentage"?u*(Math.min(Math.max(0,b.value),100)/100):Math.min(b.value,u);return{name:b.name,type:b.type,value:b.value,amount:j}}),f=g.reduce((b,j)=>b+j.amount,0),m=u-f,v=((k=(w=i==null?void 0:i.taxConfig)==null?void 0:w.filter(b=>b.isActive))==null?void 0:k.map(b=>({name:b.name,rate:b.rate,amount:m*(b.rate/100)})))||[],S=v.reduce((b,j)=>b+j.amount,0),T=m+S;return{baseAmount:u,discounts:g,totalDiscountAmount:f,amountAfterDiscount:m,taxes:v,totalTaxAmount:S,total:T,selectedStallNumbers:x.map(b=>`${b.number||b.stallNumber||`Stall ${b.id}`} (${b.hallName||`Hall ${b.hallId||1}`})`).join(", ")}},[t,a,i==null?void 0:i.taxConfig,i==null?void 0:i.publicDiscountConfig]),c=x=>{const u=String(x);if(a.some(g=>String(g)===u)){const g=a.filter(f=>String(f)!==u);o(g),e.setFieldsValue({selectedStalls:g}),je.info("Stall removed from selection")}},h=x=>`${x.toLocaleString("en-IN")}`;return n.jsxs(Ei,{children:[n.jsx(Qy,{children:"Your Selected Stalls"}),n.jsx(Jy,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),n.jsx(H.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:n.jsx(Pe,{mode:"multiple"})}),l.length>0?n.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:n.jsx(tt,{dataSource:l.map(x=>({...x,key:x.id,price:x.price||x.ratePerSqm*x.dimensions.width*x.dimensions.height,area:x.dimensions.width*x.dimensions.height,dimensions:`${x.dimensions.width}m  ${x.dimensions.height}m`,size:`${x.dimensions.width}m  ${x.dimensions.height}m`,stallType:x.stallType||{name:x.typeName||x.type||"Standard"},type:x.typeName||x.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(x,u)=>n.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",x||u.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(x,u)=>n.jsx(Te,{color:"blue",style:{borderRadius:"4px"},children:x||`Hall ${u.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(x,u)=>{var g;const p=((g=u.stallType)==null?void 0:g.name)||u.type||"Standard";return n.jsx(Te,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:p})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(x,u)=>n.jsxs(xe,{direction:"vertical",size:0,children:[n.jsx("span",{style:{fontWeight:500},children:x}),n.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[u.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(x,u)=>n.jsxs("span",{style:{color:"#555"},children:["",(u.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:x=>n.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:h(x)})},{title:"",key:"action",width:70,align:"center",render:(x,u)=>n.jsx(ct,{title:"Remove from selection",children:n.jsx(ne,{type:"text",danger:!0,icon:n.jsx(or,{}),onClick:()=>c(u.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):n.jsx(mt,{description:"No stalls selected yet. Please select stalls from the layout.",image:mt.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),a.length>0&&n.jsxs(Zy,{title:n.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Selected Stalls"}),n.jsxs("div",{className:"value",children:[a.length," stall(s) selected"]})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Stall Numbers"}),n.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:d.selectedStallNumbers})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Base Amount"}),n.jsx("div",{className:"value",children:h(d.baseAmount)})]}),d.discounts.map((x,u)=>n.jsxs("div",{className:"summary-row discount",children:[n.jsxs("div",{className:"label",children:[x.name,x.type==="percentage"?` (${x.value}%)`:""]}),n.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",h(x.amount)]})]},`discount-${u}`)),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Amount after Discount"}),n.jsx("div",{className:"value",style:{fontWeight:500},children:h(d.amountAfterDiscount)})]}),d.taxes.map((x,u)=>n.jsxs("div",{className:"summary-row",children:[n.jsxs("div",{className:"label",children:[x.name," (",x.rate,"%)"]}),n.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",h(x.amount)]})]},`tax-${u}`)),n.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[n.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),n.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:h(d.total)})]})]})]})},{Title:ev,Paragraph:lh,Text:jn}=Le,{Panel:e4}=Rx,{Option:tv}=Pe,ch=({form:e,formValues:t,selectedStallIds:r=[],exhibition:s,stallDetails:i=[]})=>{const a=e.getFieldValue("selectedStalls")||r||[],[o,l]=_.useState(e.getFieldValue("amenities")||[]),[d,c]=_.useState({}),h=_.useMemo(()=>i!=null&&i.length?i.filter(k=>a.includes(k.id)):[],[i,a]),x=_.useMemo(()=>h.reduce((k,b)=>k+b.dimensions.width*b.dimensions.height,0),[h]),u=(s==null?void 0:s.basicAmenities)&&s.basicAmenities.length>0,p=(s==null?void 0:s.amenities)&&s.amenities.length>0,g=_.useMemo(()=>!u||x===0?[]:((s==null?void 0:s.basicAmenities)||[]).map(k=>{const b=Math.floor(x/k.perSqm)*k.quantity;return{...k,calculatedQuantity:b>0?b:0,key:k._id||k.id}}),[s,u,x]),f=k=>{const b={...d};k.forEach(j=>{o.includes(j)||(b[j]=1)}),Object.keys(b).forEach(j=>{k.includes(j)||delete b[j]}),c(b),l(k)},m=k=>(k._id||k.id||"").toString(),v=(k,b)=>{c(j=>({...j,[k]:b}))};xt.useEffect(()=>{const k=o.map(b=>({id:b,quantity:d[b]||1}));e.setFieldsValue({amenities:k})},[o,d,e]);const S=k=>`${k.toLocaleString("en-IN")}`,T=_.useMemo(()=>p?((s==null?void 0:s.amenities)||[]).filter(k=>o.includes(m(k))).map(k=>({...k,key:m(k),quantity:d[m(k)]||1})):[],[s,p,o,d]),y=[{title:"Name",dataIndex:"name",key:"name",render:(k,b)=>n.jsxs(xe,{children:[n.jsx(jn,{strong:!0,children:k}),n.jsx(Te,{color:"blue",children:b.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:k=>n.jsxs(Te,{color:"green",children:[k," ",k===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(k,b)=>n.jsx(ct,{title:b.description,children:n.jsxs(jn,{type:"secondary",children:[n.jsx(Zr,{style:{marginRight:5}}),"1 ",b.quantity>1?`set of ${b.quantity}`:"unit"," per ",k," sqm"]})})}],w=[{title:"Name",dataIndex:"name",key:"name",render:(k,b)=>n.jsxs(xe,{align:"center",children:[n.jsx(jn,{strong:!0,children:k}),n.jsx(Te,{color:"blue",children:b.type}),n.jsx(jn,{type:"secondary",style:{fontSize:"13px"},children:b.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:k=>n.jsx(jn,{strong:!0,style:{color:"#1890ff"},children:S(k)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(k,b)=>n.jsx(yt,{min:1,value:d[b.key]||1,onChange:j=>v(b.key,j||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,render:(k,b)=>{const j=d[b.key]||1,A=b.rate*j;return n.jsx(jn,{strong:!0,style:{color:"#1890ff"},children:S(A)})}}];return n.jsxs(Ei,{children:[n.jsx(ev,{level:4,children:"Stall Amenities"}),n.jsx(lh,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),n.jsx(ue,{title:`Selected Stalls: ${a.length}`,style:{marginBottom:24},children:a.length>0?n.jsxs(lh,{children:["You've selected ",a.length," stall(s) with a total area of ",x," sq. meters."]}):n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),n.jsx(ue,{title:n.jsxs(xe,{children:[n.jsx(xr,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:a.length===0?n.jsx(kt,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):u?n.jsx(tt,{dataSource:g.filter(k=>k.calculatedQuantity>0),columns:y,pagination:!1,size:"small",locale:{emptyText:n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):n.jsx(mt,{image:n.jsx(ud,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),n.jsx(nt,{}),n.jsx(ue,{title:"Additional Amenities (Extra Charges)",children:p?n.jsxs("div",{children:[n.jsx(H.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:n.jsx(Pe,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:o,onChange:f,optionLabelProp:"label",children:((s==null?void 0:s.amenities)||[]).map(k=>n.jsxs(tv,{value:m(k),label:`${k.name} (${S(k.rate)})`,children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(xe,{children:[n.jsx(jn,{strong:!0,children:k.name}),n.jsx(Te,{color:"blue",children:k.type})]}),n.jsx(jn,{style:{color:"#1890ff"},children:S(k.rate)})]}),n.jsx("div",{children:n.jsx(jn,{type:"secondary",children:k.description})})]},m(k)))})}),T.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(nt,{orientation:"left",children:"Selected Amenities"}),n.jsx(tt,{dataSource:T,columns:w,pagination:!1,size:"small"})]})]}):n.jsx(mt,{image:n.jsx(ud,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),n.jsx(H.Item,{name:"amenities",hidden:!0,children:n.jsx(fe,{type:"hidden"})}),n.jsx(H.Item,{name:"selectedStalls",hidden:!0,children:n.jsx(fe,{type:"hidden"})})]})},{Title:Cl,Paragraph:dh,Text:It}=Le,hh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],selectedStalls:i=[],exhibition:a,onPrev:o,onFinish:l,loading:d=!1,formValues:c={}})=>{const[h,x]=_.useState([]),u=_.useMemo(()=>{const w=(e.getFieldValue("selectedStalls")||[]).map(b=>String(b));if(console.log("ReviewStep - Form has selectedStalls:",w),console.log("ReviewStep - Props selectedStallIds:",s),console.log("ReviewStep - Props selectedStalls:",i),w.length>0)return w;const k=[];if(r){const b=String(r);k.push(b)}return s&&s.length&&s.forEach(b=>{const j=String(b);k.includes(j)||k.push(j)}),i&&i.length&&i.forEach(b=>{const j=String(b);k.includes(j)||k.push(j)}),console.log("ReviewStep - Final consolidated stall IDs:",k),k},[e,r,s,i]);_.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",u),console.log("ReviewStep - Available stall details:",t),t&&t.length&&u.length){const y=t.filter(k=>u.includes(String(k.id)));console.log("ReviewStep - Matched stalls:",y.length);const w=y.map(k=>({key:k.id,id:k.id,number:k.number||k.stallNumber||`Stall ${k.id}`,hallName:k.hallName||`Hall ${k.hallId}`,size:`${k.dimensions.width}m  ${k.dimensions.height}m`,area:k.dimensions.width*k.dimensions.height,rate:k.ratePerSqm,price:k.price||k.ratePerSqm*k.dimensions.width*k.dimensions.height,type:k.typeName||k.type||"Standard"}));x(w)}},[t,u]);const p=_.useMemo(()=>{var R,O,X,re;const y=h.reduce((ee,D)=>ee+D.price,0),w=h.reduce((ee,D)=>ee+(D.area||0),0),k=((R=a==null?void 0:a.basicAmenities)==null?void 0:R.map(ee=>{const D=Math.floor(w/ee.perSqm)*ee.quantity;return{...ee,calculatedQuantity:D>0?D:0}}))||[],b=e.getFieldValue("amenities")||[];console.log("ReviewStep - Selected amenities with quantities:",b);let j=0;const A=b.map(ee=>{var P;const D=ee.id,q=ee.quantity||1,B=(P=a==null?void 0:a.amenities)==null?void 0:P.find(Z=>Z.id===D||Z._id===D);if(B){const Z=(B.rate||0)*q;return j+=Z,{name:B.name,rate:B.rate,type:B.type,description:B.description,quantity:q,total:Z}}return null}).filter(Boolean);console.log("ReviewStep - Processed amenity items:",A);const C=(((O=a==null?void 0:a.publicDiscountConfig)==null?void 0:O.filter(ee=>ee.isActive))||[]).map(ee=>{const D=ee.type==="percentage"?y*(Math.min(Math.max(0,ee.value),100)/100):Math.min(ee.value,y);return{name:ee.name,type:ee.type,value:ee.value,amount:D}}),I=C.reduce((ee,D)=>ee+D.amount,0),F=y-I,N=F,z=((re=(X=a==null?void 0:a.taxConfig)==null?void 0:X.filter(ee=>ee.isActive))==null?void 0:re.map(ee=>({name:ee.name,rate:ee.rate,amount:N*(ee.rate/100)})))||[],U=z.reduce((ee,D)=>ee+D.amount,0);return{baseAmount:y,basicAmenities:k,totalStallArea:w,amenities:A,amenitiesTotal:j,discounts:C,totalDiscountAmount:I,amountAfterDiscount:F,subtotal:N,taxes:z,totalTaxAmount:U,total:N+U,stallCount:h.length}},[h,e,a]);_.useEffect(()=>{var w;const y=((w=a==null?void 0:a.publicDiscountConfig)==null?void 0:w.filter(k=>k.isActive))||[];if(y.length>0){const k=y[0];console.log("Setting discountId in form to:",k),e.setFieldsValue({discountId:{name:k.name,type:k.type,value:k.value}})}},[a,e]);const g=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:(y,w)=>n.jsx(Te,{color:"purple",children:y},`stall-type-${w.key}`)},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:(y,w)=>n.jsxs("span",{children:[y," sqm"]},`stall-area-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",render:(y,w)=>n.jsxs("span",{children:["",y,"/sqm"]},`stall-rate-${w.key}`)},{title:"Price",dataIndex:"price",key:"price",render:(y,w)=>n.jsxs("span",{children:["",y.toLocaleString()]},`stall-price-${w.key}`)}],f=y=>`${y.toLocaleString("en-IN")}`,m=c.customerName||e.getFieldValue("customerName"),v=c.customerPhone||e.getFieldValue("customerPhone"),S=c.email||e.getFieldValue("email"),T=c.companyName||e.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:m,companyName:T,customerPhone:v,customerEmail:S,formValues:c,formFieldValues:{customerName:e.getFieldValue("customerName"),companyName:e.getFieldValue("companyName"),customerPhone:e.getFieldValue("customerPhone"),email:e.getFieldValue("email")}}),d?n.jsx(Ei,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:n.jsx(Jr,{size:"large",tip:"Processing your booking..."})}):u.length===0?n.jsxs(Ei,{children:[n.jsx(kt,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),n.jsx("div",{style:{marginTop:24,textAlign:"right"},children:n.jsx(ne,{onClick:o,children:"Back to Stall Selection"})})]}):n.jsxs(Ei,{children:[n.jsx(H.Item,{name:"discountId",hidden:!0,children:n.jsx(fe,{})}),n.jsx(Cl,{level:4,children:"Booking Summary"}),n.jsx(dh,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),n.jsx(ue,{title:"Exhibitor Information",style:{marginBottom:24},children:n.jsxs(We,{column:2,children:[n.jsx(We.Item,{label:"Name",children:m||"Not provided"}),n.jsx(We.Item,{label:"Company",children:T||"Not provided"}),n.jsx(We.Item,{label:"Phone",children:v||"Not provided"}),n.jsx(We.Item,{label:"Email",children:S||"Not provided"})]})}),n.jsxs(ue,{title:"Selected Stalls",className:"review-card",size:"small",children:[n.jsx(tt,{dataSource:h,columns:g,pagination:!1,size:"small",style:{marginBottom:16}}),n.jsxs(It,{strong:!0,children:["Total Base Amount: ",f(p.baseAmount)]})]}),p.basicAmenities&&p.basicAmenities.length>0&&n.jsxs(ue,{title:n.jsxs(xe,{children:[n.jsx(xr,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[n.jsxs(dh,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",p.totalStallArea," sqm."]}),n.jsx(tt,{dataSource:p.basicAmenities.filter(y=>y.calculatedQuantity>0).map((y,w)=>({...y,key:`basic-${w}`})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,w)=>n.jsxs(xe,{children:[n.jsx(It,{strong:!0,children:y}),n.jsx(Te,{color:"blue",children:w.type})]},`name-${w.key}`)},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:(y,w)=>n.jsxs(Te,{color:"green",children:[y," ",y===1?"unit":"units"]},`quantity-${w.key}`)},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(y,w)=>n.jsxs(It,{type:"secondary",children:[n.jsx(Zr,{style:{marginRight:5}}),"1 ",w.quantity>1?`set of ${w.quantity}`:"unit"," per ",y," sqm"]},`allocation-${w.key}`)},{title:"Status",key:"status",width:100,align:"right",render:(y,w)=>n.jsx(It,{type:"success",children:"Included"},`status-${w.key}`)}],pagination:!1,size:"small",locale:{emptyText:n.jsx(kt,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),p.amenities&&p.amenities.length>0&&n.jsxs(ue,{title:"Selected Amenities",style:{marginBottom:24},children:[n.jsx(tt,{dataSource:p.amenities.map((y,w)=>({...y,key:w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,w)=>n.jsxs(xe,{children:[n.jsx(It,{strong:!0,children:y}),n.jsx(Te,{color:"blue",children:w.type})]},`amenity-name-${w.key}`)},{title:"Description",dataIndex:"description",key:"description",render:(y,w)=>n.jsx(It,{type:"secondary",style:{fontSize:"13px"},children:y||"No description provided"},`amenity-desc-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",width:110,align:"right",render:(y,w)=>n.jsx(It,{strong:!0,style:{color:"#1890ff"},children:f(y)},`amenity-rate-${w.key}`)},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:90,align:"center",render:(y,w)=>n.jsx(Te,{color:"green",children:y},`amenity-qty-${w.key}`)},{title:"Total",dataIndex:"total",key:"total",width:110,align:"right",render:(y,w)=>n.jsx(It,{strong:!0,style:{color:"#1890ff"},children:f(y)},`amenity-total-${w.key}`)}],pagination:!1,size:"small"}),n.jsx(nt,{}),n.jsx("div",{style:{textAlign:"right"},children:n.jsxs(It,{strong:!0,children:["Amenities Total: ",f(p.amenitiesTotal)]})})]}),n.jsxs(ue,{title:"Price Calculation",style:{marginBottom:24},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(It,{children:"Base Amount:"}),n.jsx(It,{children:f(p.baseAmount)})]}),p.discounts.length>0&&n.jsxs(n.Fragment,{children:[p.discounts.map((y,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(It,{children:[y.name," (",y.type==="percentage"?`${y.value}%`:f(y.value),"):"]}),n.jsxs(It,{type:"danger",children:["- ",f(y.amount)]})]},w)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(It,{children:"Amount after Discount:"}),n.jsx(It,{children:f(p.amountAfterDiscount)})]})]}),p.amenitiesTotal>0&&n.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[n.jsx(It,{type:"secondary",children:"Selected Amenities (for information only):"}),n.jsx(It,{type:"secondary",children:f(p.amenitiesTotal)})]}),n.jsx(It,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(It,{strong:!0,children:"Subtotal:"}),n.jsx(It,{strong:!0,children:f(p.subtotal)})]}),p.taxes.length>0&&n.jsx(n.Fragment,{children:p.taxes.map((y,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(It,{children:[y.name," (",y.rate,"%):"]}),n.jsx(It,{children:f(y.amount)})]},w))}),n.jsx(nt,{}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Cl,{level:5,children:"Total:"}),n.jsx(Cl,{level:5,children:f(p.total)})]})]})]})},{confirm:rv}=Ve,nv=({visible:e,stallDetails:t,selectedStallId:r,selectedStallIds:s,loading:i,exhibition:a,onCancel:o,onSubmit:l})=>{const[d]=H.useForm(),[c,h]=_.useState(0),[x]=_.useState(3),[u,p]=_.useState({}),[g,f]=_.useState(!1),[m,v]=_.useState(!1),S=$e(C=>C.exhibitorAuth.exhibitor);_.useEffect(()=>{if(e){h(0),f(!1),p({}),d.resetFields();const C=s.map(N=>String(N));r&&C.push(String(r));const I=[...new Set(C)],F={selectedStalls:I,exhibitionId:a==null?void 0:a._id};S&&(F.customerName=S.contactPerson||"",F.companyName=S.companyName||"",F.email=S.email||"",F.customerPhone=S.phone||""),d.setFieldsValue(F),p(F),console.log("Booking form initialized with stalls:",I),console.log("Exhibitor profile data:",S)}},[e,d,r,s,a,S]);const T=()=>{f(!0)},y=()=>{g?rv({title:"Discard changes?",icon:n.jsx(Qs,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){o()}}):o()},w=()=>{v(!0),d.validateFields().then(C=>{const I={...u,...C},F={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...I,...F};p(N),console.log("Step completed, saving form values:",N),console.log("Selected stalls are:",N.selectedStalls||[]),console.log("Exhibitor info:",F),h(c+1),v(!1)}).catch(C=>{v(!1),console.error("Form validation failed:",C),je.error("Please complete all required fields")})},k=()=>{h(c-1)},b=()=>{d.validateFields().then(C=>{const I={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},F=d.getFieldValue("selectedStalls")||[],N=d.getFieldValue("amenities")||[],U=t.filter(re=>F.includes(String(re.id))).reduce((re,ee)=>re+ee.dimensions.width*ee.dimensions.height,0);let R=[];a!=null&&a.basicAmenities&&a.basicAmenities.length>0&&(R=a.basicAmenities.filter(re=>Math.floor(U/re.perSqm)*re.quantity>0).map(re=>{const ee=Math.floor(U/re.perSqm)*re.quantity;return{name:re.name,type:re.type,perSqm:re.perSqm,quantity:re.quantity,calculatedQuantity:ee,description:re.description||""}}));let O=[];N&&N.length>0&&(O=N.map(re=>{var D;const ee=(D=a==null?void 0:a.amenities)==null?void 0:D.find(q=>String(q._id||q.id)===String(re.id));return ee?{id:String(ee._id||ee.id),name:ee.name,type:ee.type,rate:ee.rate,quantity:re.quantity||1,description:ee.description||""}:null}).filter(Boolean));const X={...u,...C,...I,basicAmenities:R,extraAmenities:O};console.log("Submitting booking with values:",X),console.log("Basic amenities:",R),console.log("Extra amenities:",O),l(X)}).catch(C=>{console.error("Form validation failed:",C),je.error("Please complete all required fields")})},j=["Stall Details","Amenities","Review"],A=[{title:"Stall Details",icon:n.jsx(Px,{}),content:n.jsx(oh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a})},{title:"Amenities",icon:n.jsx(ms,{}),content:n.jsx(ch,{form:d,stallDetails:t,selectedStallIds:d.getFieldValue("selectedStalls")||[],exhibition:a,formValues:u})},{title:"Review",icon:n.jsx(vt,{}),content:n.jsx(hh,{form:d,formValues:u,loading:i,exhibition:a,selectedStalls:d.getFieldValue("selectedStalls")||[],selectedStallIds:d.getFieldValue("selectedStalls")||[],stallDetails:t})}];_.useEffect(()=>{const C=d.getFieldValue("selectedStalls");console.log(`Step ${c} - Form has selectedStalls:`,C)},[c,d]);const E=C=>{const I=d.getFieldValue("selectedStalls")||[],F={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...u,...F};switch(console.log(`Rendering step ${C} with:`,{selectedStalls:I,exhibitorInfo:F}),C){case 0:return n.jsx(oh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a});case 1:return n.jsx(ch,{form:d,stallDetails:t,selectedStallIds:I,exhibition:a,formValues:N});case 2:return n.jsx(hh,{form:d,formValues:N,loading:i,exhibition:a,selectedStalls:I,selectedStallIds:I,stallDetails:t,onPrev:k,onFinish:b});default:return null}};return n.jsx(Ky,{title:`Book Exhibition Stall - ${j[c]}`,open:e,onCancel:y,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[c>0&&n.jsx(kl,{onClick:k,disabled:m||i,size:"large",children:"Back"}),n.jsx("div",{children:c<x-1?n.jsx(kl,{type:"primary",onClick:w,loading:m,disabled:i,size:"large",children:"Next"}):n.jsx(kl,{type:"primary",onClick:b,loading:i,disabled:m,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:n.jsxs(Jr,{spinning:i||m,tip:i?"Processing your booking...":"Validating...",children:[n.jsx(Xy,{children:A.map((C,I)=>n.jsxs("div",{className:`step-item ${c===I?"active":""} ${c>I?"completed":""}`,onClick:()=>c>I?h(I):null,style:{cursor:c>I?"pointer":"default"},children:[n.jsx("span",{className:"step-icon",children:c>I?n.jsx(gc,{}):I+1}),C.title]},I))}),n.jsx(H,{form:d,layout:"vertical",preserve:!0,onFieldsChange:T,children:E(c)},`form-step-${c}`)]})})},{Step:Al}=Yi,{Text:sv}=Le,iv=({loginModalVisible:e,registerModalVisible:t,setRegisterModalVisible:r,setExhibitorCredentials:s,onForgotPassword:i})=>{const a=it(),o=$e(ee=>ee.exhibitorAuth),[l,d]=_.useState(!1),[c,h]=_.useState(null),[x]=H.useForm(),[u]=H.useForm(),[p]=H.useForm(),[g,f]=_.useState(0),[m,v]=_.useState(""),[S,T]=_.useState(!1),[y,w]=_.useState(!1),[k,b]=_.useState(0),[j,A]=_.useState({companyName:"",contactPerson:""}),E=_.useRef(null),C=async ee=>{var D,q,B,P,Z,se,ie,de,G;try{h(null),d(!0);const V=await ar.login(ee),{exhibitor:ae,token:ge}=V.data;if(!ae||!ge)throw new Error("Invalid response from server");s({exhibitor:ae,token:ge}),a(da()),x.resetFields(),je.success("Login successful!")}catch(V){if(((D=V.response)==null?void 0:D.status)===403){const ae=(B=(q=V.response)==null?void 0:q.data)==null?void 0:B.status;if(ae==="pending")h("Your account is pending approval. You will be able to log in after admin approval.");else if(ae==="rejected"){const ge=(Z=(P=V.response)==null?void 0:P.data)==null?void 0:Z.rejectionReason;h(ge?`Your registration has been rejected. Reason: ${ge}`:"Your registration has been rejected. Please contact the administrator for more details.")}else h(((ie=(se=V.response)==null?void 0:se.data)==null?void 0:ie.message)||"Access denied. Please contact administrator.")}else h(((G=(de=V.response)==null?void 0:de.data)==null?void 0:G.message)||"Login failed. Please try again.")}finally{d(!1)}},I=async()=>{var ee,D;try{const q=await u.validateFields(["email","companyName","contactPerson"]);d(!0),h(null),v(q.email),A({companyName:q.companyName,contactPerson:q.contactPerson}),await ar.sendRegistrationOTP(q.email),T(!0),je.success("OTP sent to your email address"),b(60),F(),f(1)}catch(q){if(q.name==="ValidationError")return;const B=((D=(ee=q.response)==null?void 0:ee.data)==null?void 0:D.message)||"Failed to send OTP. Please try again.";h(B),je.error(B)}finally{d(!1)}},F=()=>{E.current&&clearInterval(E.current),E.current=setInterval(()=>{b(ee=>ee<=1?(E.current&&clearInterval(E.current),0):ee-1)},1e3)},N=async()=>{var ee,D;try{d(!0),h(null),await ar.sendRegistrationOTP(m),je.success("New OTP sent to your email address"),b(60),F()}catch(q){const B=((D=(ee=q.response)==null?void 0:ee.data)==null?void 0:D.message)||"Failed to resend OTP. Please try again.";h(B),je.error(B)}finally{d(!1)}},z=async ee=>{var D,q;try{d(!0),h(null);const B={email:m,otp:ee.otp};await ar.verifyOTP(B),w(!0),je.success("Email verified successfully"),E.current&&clearInterval(E.current),f(2)}catch(B){const P=((q=(D=B.response)==null?void 0:D.data)==null?void 0:q.message)||"Invalid OTP. Please try again.";h(P),je.error(P)}finally{d(!1)}},U=()=>{T(!1),w(!1),v(""),b(0),f(0),A({companyName:"",contactPerson:""}),E.current&&clearInterval(E.current),p.resetFields()},R=async ee=>{var D,q,B;try{if(h(null),d(!0),!y){h("Email verification required");return}const{confirmPassword:P,...Z}=ee,se={...Z,email:m,companyName:j.companyName,contactPerson:j.contactPerson};console.log("Sending registration data:",se);const ie=await ar.register(se);je.success("Registration successful! You can log in and book a stall only after admin approval."),r(!1),u.resetFields(),U(),setTimeout(()=>{a(cs(void 0))},500)}catch(P){console.error("Registration error:",P),console.error("Response data:",(D=P.response)==null?void 0:D.data);const Z=((B=(q=P.response)==null?void 0:q.data)==null?void 0:B.message)||"Registration failed. Please try again.";h(Z),je.error(Z)}finally{d(!1)}};xt.useEffect(()=>()=>{E.current&&clearInterval(E.current)},[]);const O=()=>{r(!1),h(null),u.resetFields(),U()},X=()=>{a(da()),r(!0),x.resetFields()},re=()=>{r(!1),a(cs(void 0)),u.resetFields()};return n.jsxs(n.Fragment,{children:[n.jsxs(Ve,{title:"Exhibitor Login",open:e,onCancel:()=>{a(da()),h(null),x.resetFields()},footer:null,width:400,children:[o.loginContext==="stall-booking"&&n.jsx(kt,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),c&&n.jsx(kt,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:x,name:"exhibitor_login_modal",onFinish:C,layout:"vertical",children:[n.jsx(H.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(fe,{prefix:n.jsx(fn,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(H.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsxs(H.Item,{children:[n.jsx("div",{style:{textAlign:"right",marginBottom:10},children:n.jsx(ne,{type:"link",onClick:()=>{a(da()),i()},style:{padding:0},children:"Forgot password?"})}),n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Login"})]})]}),n.jsx(nt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),n.jsx(ne,{type:"default",block:!0,onClick:X,children:"Register as Exhibitor"})]}),n.jsxs(Ve,{title:"Exhibitor Registration",open:t,onCancel:O,footer:null,width:500,children:[n.jsxs(Yi,{current:g,style:{marginBottom:24},children:[n.jsx(Al,{title:"Basic Info"}),n.jsx(Al,{title:"Verify Email"}),n.jsx(Al,{title:"Complete"})]}),c&&n.jsx(kt,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),g===0&&n.jsxs(n.Fragment,{children:[n.jsx(kt,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:u,name:"exhibitor_register_step1",layout:"vertical",children:[n.jsx(H.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:n.jsx(fe,{prefix:n.jsx(bc,{}),placeholder:"Company Name",size:"large",disabled:l})}),n.jsx(H.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:n.jsx(fe,{prefix:n.jsx(at,{}),placeholder:"Contact Person",size:"large",disabled:l})}),n.jsx(H.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(fe,{prefix:n.jsx(fn,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",onClick:I,block:!0,size:"large",loading:l,children:"Continue & Verify Email"})})]}),n.jsx(nt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),n.jsx(ne,{type:"default",block:!0,onClick:re,children:"Login"})]}),g===1&&n.jsxs(n.Fragment,{children:[n.jsx(kt,{message:"Email Verification",description:`We've sent a verification code to ${m}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:p,name:"verify_otp",onFinish:z,layout:"vertical",children:[n.jsx(H.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:n.jsx(fe,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:l})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Verify & Continue"})})]}),n.jsxs(Ae,{justify:"space-between",align:"middle",style:{marginTop:16},children:[n.jsx(Q,{children:n.jsx(ne,{type:"link",disabled:k>0||l,onClick:N,children:"Resend Code"})}),n.jsx(Q,{children:k>0&&n.jsxs(sv,{type:"secondary",children:["Resend in ",k,"s"]})})]}),n.jsx(nt,{}),n.jsx(ne,{type:"default",block:!0,onClick:()=>f(0),children:"Back"})]}),g===2&&n.jsxs(n.Fragment,{children:[n.jsx(kt,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:u,name:"exhibitor_register_step2",onFinish:R,layout:"vertical",children:[n.jsx(H.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:n.jsx(fe,{prefix:n.jsx(wc,{}),placeholder:"Phone Number",size:"large",disabled:l})}),n.jsx(H.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:n.jsx(fe.TextArea,{placeholder:"Address",rows:3,disabled:l})}),n.jsx(H.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsx(H.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:ee})=>({validator(D,q){return!q||ee("password")===q?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm Password",size:"large",disabled:l})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Complete Registration"})})]})]})]})]})},{Step:t4}=Yi,{Text:r4}=Le,av=({visible:e})=>{const t=it(),[r,s]=_.useState(!1),[i,a]=_.useState(null),[o,l]=_.useState(0),[d,c]=_.useState(""),[h,x]=_.useState(!1),[u,p]=_.useState(0),g=H.useForm()[0],f=H.useForm()[0],m=H.useForm()[0],v=_.useRef(null),S=async E=>{var C,I;try{s(!0),a(null);const F=await ar.requestPasswordReset(E);c(E.email),x(!0),l(1),je.success("Password reset code sent to your email"),p(60),T()}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Failed to send password reset code. Please try again.";a(N)}finally{s(!1)}},T=()=>{v.current&&clearInterval(v.current),v.current=setInterval(()=>{p(E=>E<=1?(v.current&&clearInterval(v.current),0):E-1)},1e3)},y=async()=>{var E,C;try{s(!0),a(null),await ar.requestPasswordReset({email:d}),je.success("New password reset code sent to your email"),p(60),T()}catch(I){const F=((C=(E=I.response)==null?void 0:E.data)==null?void 0:C.message)||"Failed to resend password reset code. Please try again.";a(F)}finally{s(!1)}},w=async E=>{var C,I;try{s(!0),a(null),l(2),v.current&&clearInterval(v.current)}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Invalid code. Please try again.";a(N)}finally{s(!1)}},k=async E=>{var C,I;try{s(!0),a(null);const F=f.getFieldValue("otp"),N={email:d,otp:F,newPassword:E.newPassword};await ar.resetPassword(N),je.success("Password reset successful. You can now log in with your new password."),b(),t(ll()),t(cs())}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Failed to reset password. Please try again.";a(N)}finally{s(!1)}},b=()=>{l(0),c(""),x(!1),p(0),v.current&&clearInterval(v.current),g.resetFields(),f.resetFields(),m.resetFields()},j=()=>{b(),t(ll())},A=()=>{b(),t(ll()),t(cs())};return xt.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),n.jsxs(Ve,{title:"Forgot Password",open:e,onCancel:j,footer:null,width:400,children:[i&&n.jsx(kt,{message:i,type:"error",style:{marginBottom:16}}),n.jsx(Yi,{current:o,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),o===0&&n.jsxs(H,{form:g,onFinish:S,layout:"vertical",children:[n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{prefix:n.jsx(fn,{}),placeholder:"Email"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Send Reset Code"})}),n.jsx(nt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),n.jsx(ne,{type:"link",onClick:A,block:!0,children:"Back to Login"})]}),o===1&&n.jsxs(H,{form:f,onFinish:w,layout:"vertical",children:[n.jsxs("p",{children:["We've sent a verification code to ",n.jsx("strong",{children:d}),". Please check your email and enter the code below."]}),n.jsx(H.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:n.jsx(fe,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Verify Code"})}),n.jsx("div",{style:{textAlign:"center",marginTop:8},children:u>0?n.jsxs(Le.Text,{type:"secondary",children:["Resend code in ",u,"s"]}):n.jsx(ne,{type:"link",onClick:y,disabled:r,children:"Resend Code"})}),n.jsx(nt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),n.jsx(ne,{type:"link",onClick:()=>{l(0),v.current&&(clearInterval(v.current),p(0))},block:!0,children:"Change Email"})]}),o===2&&n.jsxs(H,{form:m,onFinish:k,layout:"vertical",children:[n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:E})=>({validator(C,I){return!I||E("newPassword")===I?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(fe.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm Password"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Reset Password"})})]})]})},{Header:ov}=Ct,lv=we(ov)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,cv=we.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,dv=we.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,hv=we.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,uv=we.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,uh=we(Mr)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,fh=we(lr)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,fv=we(lr)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,xv=we(ne)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,pv=we.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,mv=we(Cr)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,ja=we(ne)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,gv=we.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,yv=we.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,Gr=()=>{var j;const e=Je(),t=it(),[r,s]=_.useState(!1),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState("/logo.png"),[h,x]=_.useState("Exhibition Manager"),u=$e(A=>A.exhibitorAuth),{exhibitor:p,isAuthenticated:g,showLoginModal:f,showForgotPasswordModal:m}=u;_.useEffect(()=>{const A=localStorage.getItem("cachedLogoUrl"),E=localStorage.getItem("logoTimestamp"),C=new Date().getTime();if(A&&E&&C-parseInt(E)<36e5)c(A);else{const I=`${_e.defaults.baseURL}/public/logo`;c(I),localStorage.setItem("cachedLogoUrl",I),localStorage.setItem("logoTimestamp",C.toString());const F=new Image;F.src=I}fetch(`${_e.defaults.baseURL}/public/site-info`).then(I=>I.json()).then(I=>{I.siteName&&x(I.siteName)}).catch(I=>{console.error("Error fetching site info:",I)})},[]),_.useEffect(()=>(je.config({top:84,duration:3,maxCount:1}),()=>{je.destroy()}),[]);const v=()=>{t(Gu()),je.success("Successfully logged out"),e("/"),s(!1),a(!1)},S=()=>{t(cs(void 0)),s(!1),a(!1)},T=()=>{l(!0),s(!1),a(!1)},y=()=>{t(Wm())},w=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],k=n.jsx(fh,{items:[{key:"exhibitor-login",icon:n.jsx(fd,{}),label:n.jsx("a",{onClick:S,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:n.jsx(Ni,{}),label:n.jsx("a",{onClick:T,children:"Register as Exhibitor"})}]}),b=n.jsx(fh,{items:[{key:"exhibitor-dashboard",icon:n.jsx(co,{}),label:n.jsx(Cr,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:n.jsx(at,{}),label:n.jsx(Cr,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:n.jsx(yr,{}),label:n.jsx(Cr,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:n.jsx(lo,{}),label:n.jsx("a",{onClick:v,children:"Logout"})}]});return n.jsxs(n.Fragment,{children:[n.jsx(lv,{children:n.jsxs(cv,{children:[n.jsx(dv,{children:n.jsx(Cr,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:n.jsx(hv,{children:n.jsx(uv,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})})}),n.jsx(fv,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:w.map(A=>({key:A.key,label:n.jsx(Cr,{to:A.path,children:A.label})}))}),n.jsx(gv,{children:n.jsx(Vn,{overlay:u.isAuthenticated?b:k,trigger:["click"],placement:"bottomRight",open:r,onOpenChange:s,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:u.isAuthenticated?n.jsxs(xe,{style:{cursor:"pointer"},children:[n.jsx(yv,{children:((j=u.exhibitor)==null?void 0:j.companyName)||"Exhibitor"}),n.jsx(uh,{icon:n.jsx(at,{}),size:"large"})]}):n.jsx(uh,{icon:n.jsx(at,{}),size:"large"})})}),n.jsx(xv,{icon:n.jsx(Dx,{}),onClick:()=>a(!0)})]})}),n.jsx(pv,{children:n.jsxs(Lx,{title:"Exhibition Management System",placement:"right",onClose:()=>a(!1),open:i,width:280,closeIcon:n.jsx("span",{style:{fontSize:"16px"},children:""}),children:[n.jsx("div",{style:{marginBottom:24},children:w.map(A=>n.jsx(mv,{to:A.path,onClick:()=>a(!1),children:A.label},A.key))}),n.jsx("div",{style:{marginTop:40},children:u.isAuthenticated?n.jsxs(n.Fragment,{children:[n.jsx(ja,{type:"primary",icon:n.jsx(co,{}),onClick:()=>{e("/exhibitor/dashboard"),a(!1)},children:"Dashboard"}),n.jsx(ja,{type:"default",icon:n.jsx(lo,{}),onClick:v,children:"Logout"})]}):n.jsxs(n.Fragment,{children:[n.jsx(ja,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:n.jsx(fd,{}),onClick:()=>{S(),a(!1)},children:"Exhibitor Login"}),n.jsx(ja,{type:"default",icon:n.jsx(Ni,{}),onClick:()=>{T(),a(!1)},children:"Register as Exhibitor"})]})})]})}),n.jsx(iv,{loginModalVisible:f,registerModalVisible:o,setRegisterModalVisible:l,setExhibitorCredentials:A=>t(oc(A)),onForgotPassword:y}),n.jsx(av,{visible:m})]})},{Content:Sa}=Ct,{Title:n4}=Le,vv=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/"))return`${_e.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${_e.defaults.baseURL}/${s}?token=${r}`:`${_e.defaults.baseURL}/${s}`},bv=()=>{var O,X,re,ee;const{id:e}=Fr(),t=Je(),r=it(),[s,i]=_.useState(null),[a,o]=_.useState(null),[l,d]=_.useState(null),[c,h]=_.useState([]),[x,u]=_.useState(!1),[p,g]=_.useState(!0),[f,m]=_.useState(null),[v,S]=_.useState(!1),[T,y]=_.useState(null),w=_.useRef(null),[k,b]=_.useState({width:800,height:600}),[j,A]=_.useState(!1),[E]=H.useForm(),{isAuthenticated:C}=$e(D=>D.exhibitorAuth);_.useEffect(()=>{const D=()=>{A(window.innerWidth<768)};return D(),window.addEventListener("resize",D),()=>{window.removeEventListener("resize",D)}},[]);const I=_.useCallback(D=>D.status==="booked"||D.status==="reserved",[]),F=_.useCallback(()=>{if(w.current){const{clientWidth:D,clientHeight:q}=w.current,B=j?320:800,P=j?480:600,Z=Math.max(D||B,B),se=Math.max(q||P,P);(Math.abs(Z-k.width)>5||Math.abs(se-k.height)>5)&&b({width:Z,height:se})}},[k.width,k.height,j]);_.useEffect(()=>{let D=null;const q=()=>{D===null&&(D=window.setTimeout(()=>{D=null,F()},j?100:50))};F();const B=new ResizeObserver(q);return w.current&&B.observe(w.current),window.addEventListener("resize",q),()=>{D!==null&&window.clearTimeout(D),B.disconnect(),window.removeEventListener("resize",q)}},[F,j]),_.useEffect(()=>{(async()=>{try{if(!e){m("Exhibition ID is missing"),g(!1);return}g(!0),m(null);const q=await Ar.getLayout(e);i(q.data)}catch(q){m(q.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",q)}finally{g(!1)}})()},[e]),_.useEffect(()=>{s&&F()},[s]),_.useEffect(()=>{C&&s&&(d(null),h([]),F(),je.info("You can now select stalls to book.",3))},[C]);const N=_.useCallback(async D=>{if(I(D)){je.info(`This stall (${D.stallNumber}) is already booked.`);return}if(!C){r(cs("stall-booking"));return}const B=D._id||D.id;h(P=>P.includes(B)?(je.info(`Stall ${D.stallNumber} removed from selection`),P.filter(Z=>Z!==B)):(je.success(`Stall ${D.stallNumber} added to selection`),[...P,B]))},[I,C,r]),z=async D=>{try{S(!0);const q={...D,exhibitionId:s==null?void 0:s.exhibition._id,stallIds:D.selectedStalls};if(C){const B=await Ar.exhibitorBookStalls(q);je.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const B=await Ar.bookMultipleStalls(e,q);je.success("Your booking request has been submitted successfully!")}if(u(!1),h([]),e)try{const B=await Ar.getLayout(e);i(B.data)}catch(B){console.error("Error refreshing layout data:",B)}}catch(q){console.error("Error booking stall",q),je.error("Failed to book stall. Please try again.")}finally{S(!1)}},U=async()=>{var D;try{if(!s)return;S(!0);let q=null;if(l){const P=s.layout.find(Z=>Z.stalls.some(se=>se.id===l));P?q=P.stalls.find(Z=>Z.id===l)||null:console.error("Selected stall not found in any hall")}const B=s.layout.flatMap(P=>P.stalls.map(Z=>({...Z,hallId:P.id,hallName:P.name}))).filter(P=>P.status==="available");if(c.length===0&&l===null&&B.length===0){je.error("No stalls are available for booking");return}if(!s.exhibition.basicAmenities)try{const P=await Ar.getExhibition(e||"");(D=P==null?void 0:P.data)!=null&&D.basicAmenities&&i({...s,exhibition:{...s.exhibition,basicAmenities:P.data.basicAmenities}})}catch(P){console.error("Error fetching exhibition details with amenities:",P)}y(B),u(!0)}catch(q){console.error("Error opening booking modal:",q),je.error("Failed to open booking form")}finally{S(!1)}};_.useCallback(D=>{D.cancelBubble=!0},[]);const R=_.useMemo(()=>{var D;return s?{halls:s.layout.map(q=>n.jsx(xf,{hall:{...q,exhibitionId:e||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},q.id)),stalls:s.layout.flatMap(q=>q.stalls.map(B=>{var P,Z,se,ie,de,G,V,ae;return n.jsx(Bc,{stall:{...B,hallId:q.id,hallName:q.name,isSelected:c.includes(B.id),stallTypeId:"default",number:B.stallNumber,typeName:B.type||"Standard",ratePerSqm:B.price||0,rotation:0,dimensions:{x:((P=B.position)==null?void 0:P.x)||0,y:((Z=B.position)==null?void 0:Z.y)||0,width:((se=B.dimensions)==null?void 0:se.width)||0,height:((ie=B.dimensions)==null?void 0:ie.height)||0},status:B.status==="maintenance"?"booked":B.status},isSelected:l===B.id||c.includes(B.id),onSelect:B.status==="available"?()=>N(B):void 0,hallWidth:((de=q.dimensions)==null?void 0:de.width)||0,hallHeight:((G=q.dimensions)==null?void 0:G.height)||0,hallX:((V=q.dimensions)==null?void 0:V.x)||0,hallY:((ae=q.dimensions)==null?void 0:ae.y)||0},B.id)})),fixtures:(D=s.fixtures)==null?void 0:D.map(q=>{var B,P;return n.jsx(pf,{fixture:{...q,id:q.id||q._id,_id:q._id||q.id,exhibitionId:e||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((B=s.exhibition.dimensions)==null?void 0:B.width)||0,exhibitionHeight:((P=s.exhibition.dimensions)==null?void 0:P.height)||0},q.id||q._id)})}:null},[s,e,l,c,N]);return p?n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Jr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):f||!s?n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"error",title:"Failed to load exhibition layout",subTitle:f||"The exhibition layout couldn't be loaded.",extra:[n.jsx(ne,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((O=s.exhibition.dimensions)!=null&&O.width)||!((X=s.exhibition.dimensions)!=null&&X.height)?n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsx(ue,{children:n.jsx(Di,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsxs(Sa,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[j&&n.jsx("div",{style:{height:"16px",width:"100%"}}),n.jsxs(ue,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:j?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:j?"5px":"24px"},children:[n.jsxs(Ae,{gutter:[24,24],style:{marginBottom:j?16:32},children:[n.jsx(Q,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:j?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:j?"column":"row",alignItems:j?"flex-start":"center",gap:j?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:j?"center":"flex-start",width:j?"100%":"auto"},children:s.exhibition.headerLogo?n.jsx(vu,{src:vv(s.exhibition.headerLogo),alt:`${s.exhibition.name} logo`,style:{maxHeight:j?70:90,maxWidth:j?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:j?200:250,height:j?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:n.jsx(Jr,{size:"small"})})}):n.jsx("div",{style:{width:j?70:90,height:j?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:n.jsx(Vr,{style:{fontSize:j?24:32,color:"#aaa"}})})}),!j&&n.jsx(nt,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),n.jsxs("div",{style:{flex:1,width:j?"100%":"auto"},children:[n.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:j?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.exhibition.name}),n.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:j?"13px":"14px"},children:[n.jsx(Vr,{style:{fontSize:j?"14px":"16px",color:"#1890ff"}}),n.jsxs("span",{children:[new Date(s.exhibition.startDate).toLocaleDateString()," -",new Date(s.exhibition.endDate).toLocaleDateString()]})]}),n.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:j?"13px":"14px"},children:[n.jsx(Zr,{style:{fontSize:j?"14px":"16px",color:"#1890ff"}}),n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:j?"nowrap":"normal",maxWidth:j?"260px":"none"},children:s.exhibition.venue})]})]})]})}),n.jsx(Q,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:j?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{marginBottom:"16px",fontSize:j?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),n.jsxs("div",{style:{display:"flex",flexDirection:j?"column":"row",justifyContent:"center",alignItems:"center",gap:j?"10px":"16px",width:"100%"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"success"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"processing",color:"#1890ff"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"warning"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),n.jsxs("div",{ref:w,style:{width:"100%",height:j?"70vh":"80vh",minHeight:j?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[n.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Base canvas optimization */
                .konvajs-content {
                  will-change: transform;
                  transform: translateZ(0);
                  backface-visibility: hidden;
                  transition: filter 0.2s ease-out;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Canvas optimization for all canvases */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                  transition: filter 0.15s linear;
                }
                
                /* Dragging state - apply blur effect with better control */
                .public-canvas-container .konvajs-content.dragging {
                  filter: blur(1px);
                }
                
                /* Mobile-specific blur - slightly stronger */
                @media (max-width: 768px) {
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(1.5px);
                  }
                }
                
                /* Performance optimizations for dragging */
                .public-canvas-container .konvajs-content:active canvas {
                  image-rendering: optimizeSpeed;
                }
                
                /* Touch device optimizations */
                @media (pointer: coarse) {
                  .public-canvas-container .konvajs-content:active {
                    touch-action: none;
                  }
                  
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(2px); /* Stronger blur for touch devices */
                  }
                }
                
                /* Animation smoothing to reduce flickering */
                .public-canvas-container .konvajs-content canvas {
                  will-change: filter;
                  transform: translateZ(0);
                }
                
                /* Low-end device optimizations */
                @media (max-width: 480px), 
                       (resolution: 150dpi),
                       (any-pointer: coarse) {
                  .public-canvas-container .konvajs-content:active canvas {
                    image-rendering: optimizeSpeed;
                  }
                }
              `}),n.jsxs(Qi,{width:k.width,height:k.height,exhibitionWidth:((re=s==null?void 0:s.exhibition.dimensions)==null?void 0:re.width)||0,exhibitionHeight:((ee=s==null?void 0:s.exhibition.dimensions)==null?void 0:ee.height)||0,halls:(s==null?void 0:s.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[R==null?void 0:R.halls,R==null?void 0:R.stalls,R==null?void 0:R.fixtures]})]})]})]}),c.length>0&&n.jsx(Ox,{offsetBottom:20,children:n.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:n.jsxs(ne,{type:"primary",size:"large",icon:n.jsx(ho,{}),onClick:U,loading:v,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",c.length,")"]})})}),n.jsx(nv,{visible:x,stallDetails:T,selectedStallId:l,selectedStallIds:c,loading:v,exhibition:s==null?void 0:s.exhibition,onCancel:()=>{u(!1)},onSubmit:z})]})},wv=xt.memo(bv),{Content:Il}=Ct,{Title:Nl,Text:es,Paragraph:xh}=Le,Fl=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/")||t.includes("sponsors/"))return`${_e.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${_e.defaults.baseURL}/${s}?token=${r}`:`${_e.defaults.baseURL}/${s}`},jv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},Ea=e=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Sv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);if(r<s){const a=s.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} until start`,count:o,isPast:!1}}else if(r>i){const a=r.getTime()-i.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} since end`,count:o,isPast:!0}}else{const a=i.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} remaining`,count:o,isPast:!1}}},Ev=()=>{const{id:e}=Fr(),t=Je(),[r,s]=_.useState(null),[i,a]=_.useState(!0),[o,l]=_.useState(null),[d,c]=_.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(_.useEffect(()=>{(async()=>{try{if(!e){l("Exhibition ID is missing");return}a(!0),l(null);const g=await Ar.getExhibition(e);if(s(g.data),g.data.headerBackground){const f=Fl(g.data.headerBackground);c(f);const m=new window.Image;m.src=f}else if(g.data.headerLogo){const f=Fl(g.data.headerLogo),m=new window.Image;m.src=f}}catch(g){console.error("Error fetching exhibition:",g),l(g.message||"Error fetching exhibition")}finally{a(!1)}})()},[e]),i)return n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Il,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Jr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(o||!r)return n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Il,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"404",title:"Exhibition not found",subTitle:o||"The exhibition you're looking for doesn't exist or has been removed.",extra:n.jsx(ne,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:h,color:x}=jv(r.startDate,r.endDate),u=Sv(r.startDate,r.endDate);return n.jsxs(Ct,{className:"exhibition-details-layout",children:[n.jsx(Gr,{}),n.jsxs(Il,{className:"exhibition-content",children:[n.jsx("div",{className:"breadcrumb-container",children:n.jsx(Bx,{items:[{title:n.jsx(Cr,{to:"/",children:n.jsx(bc,{})})},{title:n.jsx(Cr,{to:"/exhibitions",children:"Exhibitions"})},{title:r.name}]})}),n.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${d}')`},children:n.jsx("div",{className:"hero-overlay",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("div",{className:"hero-main",children:[n.jsx(Nl,{level:1,className:"exhibition-title",children:r.name}),n.jsxs(xe,{size:24,className:"exhibition-meta",children:[n.jsxs("div",{className:"meta-item",children:[n.jsx(Vr,{}),n.jsxs(es,{children:[Ea(r.startDate)," - ",Ea(r.endDate)]})]}),r.venue&&n.jsxs("div",{className:"meta-item",children:[n.jsx(os,{}),n.jsx(es,{children:r.venue})]}),n.jsxs("div",{className:"meta-item",children:[n.jsx(Yt,{}),n.jsxs(es,{children:[u.text,": ",n.jsx("strong",{children:u.count})]})]})]})]}),n.jsxs("div",{className:"hero-actions",children:[n.jsx(ne,{type:"primary",size:"large",icon:n.jsx(ps,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),n.jsx(ne,{size:"large",icon:n.jsx(yr,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button book-button",children:"Book a Stall"}),u.isPast?null:n.jsx(ne,{size:"large",icon:n.jsx(yc,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),n.jsx("div",{className:"stats-container",children:n.jsxs(Ae,{gutter:[16,16],className:"stats-row",children:[n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon duration-icon",children:n.jsx(Vr,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:Math.ceil((new Date(r.endDate).getTime()-new Date(r.startDate).getTime())/(1e3*60*60*24))}),n.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon countdown-icon",children:n.jsx(Yt,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:u.count}),n.jsx("div",{className:"stat-label",children:u.text})]})]})}),n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:x+"20",color:x},children:n.jsx(Zr,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value status-value",style:{color:x},children:h}),n.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),r.sponsorLogos&&r.sponsorLogos.length>0&&n.jsxs("div",{className:"sponsors-section",children:[n.jsx("div",{className:"sponsors-header",children:n.jsx(es,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),n.jsx("div",{className:"sponsors-container",children:r.sponsorLogos.map((p,g)=>n.jsx("div",{className:"sponsor-logo-wrapper",children:n.jsx("div",{className:"sponsor-logo",children:n.jsx("img",{src:Fl(p),alt:`Sponsor ${g+1}`,className:"sponsor-logo-img",onError:f=>{f.target.src="/placeholder-logo.png"}})})},g))})]}),n.jsx("div",{className:"exhibition-details-container",children:n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,lg:16,children:n.jsxs(ue,{className:"details-card about-card",bordered:!1,children:[n.jsx(Nl,{level:3,className:"section-title",children:"About This Exhibition"}),n.jsx(xh,{className:"main-description",children:r.description}),r.headerDescription&&n.jsx(xh,{className:"extended-description",children:r.headerDescription}),r.headerSubtitle&&n.jsxs("div",{className:"subtitle-section",children:[n.jsx(Nl,{level:4,children:r.headerSubtitle}),n.jsx(nt,{})]})]})}),n.jsx(Q,{xs:24,lg:8,children:n.jsx(xe,{direction:"vertical",style:{width:"100%"},size:24,children:n.jsx(ue,{title:"Key Information",className:"details-card info-card",bordered:!1,children:n.jsxs("div",{className:"info-grid",children:[n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon start-icon",children:n.jsx(Vr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"Start Date"}),n.jsx("div",{className:"info-value",children:Ea(r.startDate)})]})]}),n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon end-icon",children:n.jsx(Vr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"End Date"}),n.jsx("div",{className:"info-value",children:Ea(r.endDate)})]})]}),r.venue&&n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon venue-icon",children:n.jsx(os,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"Venue"}),n.jsx("div",{className:"info-value",children:r.venue})]})]})]})})})})]})})]}),n.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:Tv}=Ct,{Title:_v,Paragraph:kv,Text:Cv}=Le,Av=we(Tv)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Iv=we.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Ta=we(_v)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Nv=we.div`
  margin-bottom: 20px;
`,Fv=we.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,en=we(Cr)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,Rl=we.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,Pl=we.div`
  margin-right: 10px;
  color: #4158D0;
`,_a=we.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Rv=we(fe)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,Pv=we(ne)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Dv=we(Cv)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Lv=we(nt)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,mf=()=>{const[e,t]=_.useState("/logo.png"),[r,s]=_.useState("Exhibition Manager"),i=new Date().getFullYear();return _.useEffect(()=>{const a=`${_e.defaults.baseURL}/public/logo`;t(a),fetch(`${_e.defaults.baseURL}/public/site-info`).then(o=>o.json()).then(o=>{o.siteName&&s(o.siteName)}).catch(o=>{console.error("Error fetching site info:",o)})},[]),n.jsx(Av,{children:n.jsxs(Iv,{children:[n.jsxs(Ae,{gutter:[48,40],children:[n.jsxs(Q,{xs:24,sm:24,md:8,lg:7,children:[n.jsx(Nv,{children:n.jsx(Cr,{to:"/",children:n.jsx(Fv,{src:e,alt:r,onError:()=>t("/logo.png")})})}),n.jsx(kv,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),n.jsxs(xe,{children:[n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Mx,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx($x,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Ux,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(zx,{})})]})]}),n.jsxs(Q,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(Ta,{level:4,children:"Quick Links"}),n.jsx(en,{to:"/exhibitions",children:"Exhibitions"}),n.jsx(en,{to:"/about",children:"About Us"}),n.jsx(en,{to:"/contact",children:"Contact Us"}),n.jsx(en,{to:"/privacy-policy",children:"Privacy Policy"}),n.jsx(en,{to:"/terms",children:"Terms & Conditions"})]}),n.jsxs(Q,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(Ta,{level:4,children:"For Exhibitors"}),n.jsx(en,{to:"/exhibitor/login",children:"Login"}),n.jsx(en,{to:"/exhibitor/register",children:"Register"}),n.jsx(en,{to:"/exhibitor/dashboard",children:"Dashboard"}),n.jsx(en,{to:"/exhibitor/bookings",children:"My Bookings"}),n.jsx(en,{to:"/faq",children:"FAQ"})]}),n.jsxs(Q,{xs:24,sm:24,md:6,lg:7,children:[n.jsx(Ta,{level:4,children:"Contact Us"}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(os,{})}),n.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(wc,{})}),n.jsx("div",{children:"+91 98765 43210"})]}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(fn,{})}),n.jsx("div",{children:"info@exhibitionmanager.com"})]}),n.jsxs("div",{style:{marginTop:24},children:[n.jsx(Ta,{level:4,children:"Newsletter"}),n.jsx(H,{children:n.jsxs(xe.Compact,{style:{width:"100%"},children:[n.jsx(Rv,{placeholder:"Your email address"}),n.jsx(Pv,{type:"primary",icon:n.jsx(qx,{}),children:"Subscribe"})]})})]})]})]}),n.jsx(Lv,{}),n.jsxs(Dv,{children:[" ",i," ",r,". All rights reserved."]})]})})},{Title:ph,Text:Dl,Paragraph:mh}=Le,{Content:Ll}=Ct,Ov=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},gh=e=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Bv=e=>{const t=new Date,s=new Date(e).getTime()-t.getTime();return Math.ceil(s/(1e3*60*60*24))},yh=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e,r=t.includes("logos/")?t:`logos/${t}`;return`${_e.defaults.baseURL}/public/images/${r}`},Mv=()=>{const e=Je(),[t,r]=_.useState([]),[s,i]=_.useState(!0),[a,o]=_.useState(null),[l,d]=_.useState({});return _.useEffect(()=>{(async()=>{try{i(!0),o(null);const h=await Ar.getExhibitions();r(h.data);const x={};h.data.forEach(u=>{if(u.headerLogo){const p=yh(u.headerLogo),g=new window.Image;g.onload=()=>{x[u._id]=!0,d(f=>({...f,[u._id]:!0}))},g.onerror=()=>{console.warn(`Failed to preload image: ${p}`),x[u._id]=!1,d(f=>({...f,[u._id]:!1}))},g.src=p}})}catch(h){o(h.message||"Failed to fetch exhibitions")}finally{i(!1)}})()},[]),s?n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Ll,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Jr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):a?n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Ll,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"error",title:"Failed to load exhibitions",subTitle:a,extra:[n.jsx(ne,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsx(Ll,{style:{paddingTop:"64px",background:"#f5f5f5"},children:n.jsxs("div",{style:{padding:"80px 16px"},children:[n.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[n.jsx(ph,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),n.jsx(mh,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?n.jsx(Ae,{gutter:[24,24],children:t.map(c=>{const{status:h,color:x}=Ov(c.startDate,c.endDate),u=Bv(c.startDate),p=c.headerLogo?yh(c.headerLogo):void 0;return n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(ue,{hoverable:!0,onClick:()=>e(qo(c)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[n.jsx(xr.Ribbon,{text:h,color:x,style:{right:"-1px",top:"10px",zIndex:2}}),n.jsxs("div",{className:"exhibition-card-container",children:[n.jsx("div",{className:"exhibition-card-logo-container",children:p&&n.jsx("div",{className:"exhibition-logo",children:n.jsx(vu,{src:p,alt:`${c.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:n.jsx(Jr,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsxs("div",{className:"exhibition-card-content",children:[n.jsx("div",{className:"exhibition-title",children:n.jsx(ph,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:c.name})}),n.jsx(mh,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:c.description}),n.jsxs("div",{className:"exhibition-card-details",children:[n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Vr,{style:{color:"#722ED1"}}),n.jsx(ct,{title:"Exhibition Date Range",children:n.jsxs(Dl,{style:{fontSize:14},children:[gh(c.startDate)," - ",gh(c.endDate)]})})]}),c.venue&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(os,{style:{color:"#F5222D"}}),n.jsx(ct,{title:"Venue",children:n.jsx(Dl,{style:{fontSize:14},ellipsis:!0,children:c.venue})})]}),h==="Upcoming"&&u>0&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Yt,{style:{color:"#1890FF"}}),n.jsx(ct,{title:"Time Remaining",children:n.jsxs(Dl,{style:{fontSize:14},children:["Starts in ",u," day",u!==1?"s":""]})})]})]}),n.jsx("div",{className:"exhibition-card-footer",children:n.jsxs(ne,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",n.jsx(Jl,{})]})})]})]})]})},c._id)})}):n.jsx(mt,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:mt.PRESENTED_IMAGE_SIMPLE})]})}),n.jsx(mf,{}),n.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},$v=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=$e(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Uv=()=>{var z,U,R;const{message:e}=Xt.useApp(),{id:t}=Fr(),r=Fn(),s=Je(),i=it(),[a,o]=op(),l=((z=r.state)==null?void 0:z.exhibitionId)||t,{currentExhibition:d,halls:c,stalls:h,loading:x}=$e(O=>O.exhibition),u=_.useRef(null),[p,g]=_.useState(!1),[f,m]=_.useState(null),[v,S]=_.useState(null),[T,y]=_.useState({width:0,height:0}),[w,k]=_.useState(!1);_.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibitions");return}},[l,s,e]),_.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibition");return}(async()=>{try{await i(Br(l)).unwrap(),await i(un(l)).unwrap(),k(!0)}catch{e.error("Failed to load data")}})()},[l,i,s]),_.useEffect(()=>{var O,X;!w||!d||(!((O=d.dimensions)!=null&&O.width)||!((X=d.dimensions)!=null&&X.height))&&(e.info("Please set up exhibition space first"),s(Lt(d,"space"),{state:{exhibitionId:l}}))},[d,l,s,w]),_.useEffect(()=>{!w||x||c.length===0&&(e.info("Please create halls first"),s(Lt(d,"halls"),{state:{exhibitionId:l}}))},[c,l,s,x,w]),_.useEffect(()=>{w&&d&&c.length>0&&(async()=>{try{const X=c.map(re=>i(dn({exhibitionId:l,hallId:re.id})).unwrap());await Promise.all(X)}catch(X){console.error("Error fetching stalls:",X),e.error("Failed to load stalls")}})()},[d,l,c,i,w]);const b=h.filter(O=>O.hallId===((f==null?void 0:f.id)||(f==null?void 0:f._id)));_.useEffect(()=>{if(!w||c.length===0)return;const O=a.get("hallId");if(O){const X=c.find(re=>re.id===O||re._id===O);if(X)m(X);else if(c.length>0){m(c[0]);const re=c[0].id||c[0]._id;re&&o({hallId:re.toString()})}}else if(c.length>0){m(c[0]);const X=c[0].id||c[0]._id;X&&o({hallId:X.toString()})}},[c,a,w,o]),_.useEffect(()=>{const O=()=>{if(u.current){const{clientWidth:re,clientHeight:ee}=u.current;y({width:Math.max(re||400,400),height:Math.max(ee||400,400)})}};O();const X=new ResizeObserver(O);return u.current&&X.observe(u.current),window.addEventListener("resize",O),()=>{X.disconnect(),window.removeEventListener("resize",O)}},[]);const j=()=>{if(!f){e.warning("Please select a hall first");return}S(null),g(!0)},A=O=>{if(m(O),S(null),O){const X=O.id||O._id;o(X?{hallId:X.toString()}:{})}else o({})},E=O=>{var re;const X=O?{...O,id:O.id||O._id,_id:O._id||O.id,stallTypeId:typeof O.stallTypeId=="string"?O.stallTypeId:((re=O.stallTypeId)==null?void 0:re._id)||O.stallTypeId,stallType:O.stallType}:null;console.log("Selected stall data:",X),S(X),g(!!X)},C=async O=>{var X,re;try{if(!(f!=null&&f.id)&&!(f!=null&&f._id)){e.error("No hall selected");return}const ee=f.id,D=f._id||f.id;if(O.hallId&&O.hallId!==D){e.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",O),O.id||O._id){const q={...O,id:O.id,_id:O._id,hallId:D,stallTypeId:O.stallTypeId};console.log("Update data:",q);const B=O.id||O._id;if(!B)throw new Error("Stall ID is missing");await gt.updateStall(l,B,q),e.success("Stall updated successfully")}else{const{id:q,_id:B,...P}=O,Z={...P,hallId:D,stallTypeId:O.stallTypeId};console.log("Creating new stall with data:",Z),await gt.createStall(l,Z),e.success("Stall created successfully")}g(!1),i(dn({exhibitionId:l,hallId:ee}))}catch(ee){console.error("Error saving stall:",ee),e.error(((re=(X=ee.response)==null?void 0:X.data)==null?void 0:re.message)||"Failed to save stall")}},I=async O=>{var X,re;try{if(!l){e.error("Exhibition ID not found");return}const ee=f;if(!ee){e.error("No hall selected");return}const D=ee.id||ee._id;if(!D){e.error("Invalid hall ID");return}await gt.deleteStall(l,O),g(!1),S(null),await i(dn({exhibitionId:l,hallId:D})).unwrap(),e.success("Stall deleted successfully")}catch(ee){console.error("Error deleting stall:",ee),e.error(((re=(X=ee.response)==null?void 0:X.data)==null?void 0:re.message)||"Failed to delete stall")}},F=async O=>{var D,q;if(!l){e.error("Exhibition ID not found");return}const X=O.id||O._id;if(!X){console.error("Stall data:",O),e.error("Stall ID not found");return}if(!(f!=null&&f.id)&&!(f!=null&&f._id)){e.error("No hall selected");return}const re=f.id,ee=f._id||f.id;try{await gt.updateStall(l,X,{...O,id:X,hallId:ee}),i(dn({exhibitionId:l,hallId:re}))}catch(B){console.error("Stall update error:",B),e.error(((q=(D=B.response)==null?void 0:D.data)==null?void 0:q.message)||"Failed to update stall position")}},N=()=>{g(!1),S(null)};return n.jsx(Xi,{children:n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[n.jsx("div",{style:{padding:"24px 24px 0"},children:n.jsx($v,{exhibitionId:l})}),n.jsx(ue,{title:"Stall Manager",extra:n.jsxs(xe,{children:[n.jsx(ne,{icon:n.jsx(yu,{}),onClick:()=>s(`/exhibition/${l}`,{state:{exhibitionId:l}}),children:"Back to Exhibition"}),n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),onClick:j,disabled:!f,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:n.jsx("div",{ref:u,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:d&&n.jsx(Qi,{width:T.width,height:T.height,exhibitionWidth:((U=d.dimensions)==null?void 0:U.width)||100,exhibitionHeight:((R=d.dimensions)==null?void 0:R.height)||100,halls:c,selectedHall:f,onSelectHall:A,isStallMode:!0,children:f&&b.map(O=>n.jsx(Bc,{stall:O,isSelected:(v==null?void 0:v.id)===O.id||(v==null?void 0:v._id)===O._id,onSelect:()=>E(O),onChange:F,hallWidth:f.dimensions.width,hallHeight:f.dimensions.height,hallX:f.dimensions.x,hallY:f.dimensions.y},O.id||O._id))})})}),d&&n.jsx(Oy,{visible:p,stall:v,hall:f,exhibition:d,onCancel:N,onSubmit:C,onDelete:v?()=>I(v.id||v._id):void 0})]})})},zv=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=$e(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},qv=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],Wv=()=>{var C,I,F;const{message:e}=Xt.useApp(),{id:t}=Fr(),r=Fn(),s=Je(),i=it(),a=((C=r.state)==null?void 0:C.exhibitionId)||t,{currentExhibition:o,fixtures:l,halls:d,stalls:c,loading:h}=$e(N=>N.exhibition),x=_.useRef(null),[u,p]=_.useState(!1),[g,f]=_.useState(null),[m,v]=_.useState({width:0,height:0}),[S,T]=_.useState("all"),[y,w]=_.useState([]);_.useEffect(()=>{if(!a){e.error("Exhibition ID not found"),s("/exhibitions");return}},[a,s,e]),_.useEffect(()=>{(async()=>{try{await i(Br(a)).unwrap(),await i(Si({exhibitionId:a})).unwrap(),await i(un(a)).unwrap(),await i(dn({exhibitionId:a})).unwrap()}catch{e.error("Failed to load data")}})()},[a,i,e]),_.useEffect(()=>{w(S==="all"?l:l.filter(N=>N.type===S))},[l,S]),_.useEffect(()=>{const N=()=>{if(x.current){const{clientWidth:U,clientHeight:R}=x.current;v({width:Math.max(U||400,400),height:Math.max(R||400,400)})}};N();const z=new ResizeObserver(N);return x.current&&z.observe(x.current),window.addEventListener("resize",N),()=>{z.disconnect(),window.removeEventListener("resize",N)}},[]);const k=()=>{f(null),p(!0)},b=N=>{f(N),p(!!N)},j=async N=>{try{N.id||N._id?(await i(ro({exhibitionId:a,id:N.id||N._id||"",data:N})).unwrap(),e.success("Fixture updated successfully")):(await i(to({exhibitionId:a,data:N})).unwrap(),e.success("Fixture created successfully")),await i(Si({exhibitionId:a})).unwrap(),p(!1)}catch(z){console.error("Failed to save fixture:",z),e.error(z.message||"Failed to save fixture")}},A=async N=>{try{const z=N.id||N._id;if(!z)throw new Error("Fixture ID is required");await i(no({exhibitionId:a,id:z})).unwrap(),e.success("Fixture deleted successfully"),p(!1),f(null)}catch(z){console.error("Failed to delete fixture:",z),e.error(z.message||"Failed to delete fixture")}},E=N=>{T(N)};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(zv,{exhibitionId:a}),n.jsxs(ue,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(xe,{children:n.jsx("span",{children:"Fixture Management"})}),n.jsxs(xe,{children:[n.jsx(Pe,{style:{width:180},value:S,onChange:E,options:qv}),n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),onClick:k,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[n.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),n.jsx("div",{ref:x,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Xi,{children:m.width>0&&m.height>0&&(o==null?void 0:o.dimensions)&&n.jsx(Qi,{width:m.width,height:m.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:d,stalls:c,fixtures:y,selectedFixture:g,onSelectFixture:b,onFixtureChange:j,onAddFixture:k,isFixtureMode:!0})})})]}),n.jsx(zy,{visible:u,fixture:g,onCancel:()=>p(!1),onSubmit:j,onDelete:A,exhibitionWidth:((I=o==null?void 0:o.dimensions)==null?void 0:I.width)||100,exhibitionHeight:((F=o==null?void 0:o.dimensions)==null?void 0:F.height)||100})]})},{Title:Hv,Text:Vv}=Le,{Option:Cs}=Pe,Gv=()=>{const e=Je(),t=it(),{stalls:r,loading:s}=$e(U=>U.exhibition),[i,a]=_.useState([]),[o,l]=_.useState([]),[d,c]=_.useState(null),[h,x]=_.useState(null),[u,p]=_.useState(!1),g=xt.useMemo(()=>Math.max(...r.map(U=>U.ratePerSqm*U.dimensions.width*U.dimensions.height),1e6),[r]),f=xt.useMemo(()=>{const U=Math.pow(10,Math.floor(Math.log10(g)));return Math.ceil(g/U)*U},[g]),[m,v]=_.useState(""),[S,T]=_.useState(null),[y,w]=_.useState([0,f]),[k,b]=_.useState("number"),[j,A]=_.useState("ascend"),E=U=>{c(U),x(null),t({type:"exhibition/clearStalls"})},C=U=>{x(U),t(d&&U?dn({exhibitionId:d,hallId:U}):{type:"exhibition/clearStalls"})};_.useEffect(()=>{(async()=>{try{p(!0),console.log("Fetching exhibitions...");const R=await gt.getActiveExhibitions();console.log("Exhibitions response:",R.data),a(R.data)}catch(R){console.error("Failed to fetch exhibitions:",R)}finally{p(!1)}})()},[]),_.useEffect(()=>{d?(async()=>{try{p(!0),console.log("Fetching halls for exhibition:",d);const R=await gt.getHalls(d);console.log("Halls response:",R.data),l(R.data)}catch(R){console.error("Failed to fetch halls:",R)}finally{p(!1)}})():l([])},[d]);const I=xt.useMemo(()=>{console.log("Filtering stalls from Redux:",r);const U=r.filter(R=>{const O=!m||R.number.toLowerCase().includes(m.toLowerCase()),X=!S||R.status===S,re=!h||R.hallId===h,ee=R.ratePerSqm*R.dimensions.width*R.dimensions.height,D=ee>=y[0]&&ee<=y[1];return O&&X&&re&&D}).sort((R,O)=>k==="number"?j==="ascend"?R.number.localeCompare(O.number):O.number.localeCompare(R.number):0);return console.log("Filtered stalls:",U),U},[r,m,S,h,y,k,j]),F=U=>{switch(U){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},z=(U=>{const R=U.reduce((O,X)=>{var re,ee;return(re=X==null?void 0:X.dimensions)!=null&&re.width&&((ee=X==null?void 0:X.dimensions)!=null&&ee.height)?O+X.dimensions.width*X.dimensions.height:O},0);return{totalStalls:U.length,totalSize:R}})(I);return n.jsx("div",{className:"dashboard-container",children:n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{span:24,children:n.jsxs(xe,{direction:"vertical",size:4,style:{width:"100%"},children:[n.jsx(Hv,{level:4,style:{margin:0},children:"Stalls"}),n.jsx(Vv,{type:"secondary",children:"Manage your exhibition stalls"})]})}),n.jsx(Q,{span:24,children:n.jsxs(Ae,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(Pe,{style:{width:"100%"},placeholder:"Select Exhibition",value:d,onChange:E,allowClear:!0,children:i.map(U=>n.jsx(Cs,{value:U._id||U.id,children:U.name},U._id||U.id))})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(Pe,{style:{width:"100%"},placeholder:"Select Hall",value:h,onChange:C,disabled:!d||o.length===0,allowClear:!0,children:o.map(U=>n.jsx(Cs,{value:U._id||U.id,children:U.name},U._id||U.id))})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(fe,{placeholder:"Search by stall number",prefix:n.jsx(An,{}),value:m,onChange:U=>v(U.target.value),allowClear:!0})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(Pe,{style:{width:"100%"},placeholder:"Filter by status",value:S,onChange:T,allowClear:!0,children:[n.jsx(Cs,{value:"available",children:"Available"}),n.jsx(Cs,{value:"booked",children:"Booked"}),n.jsx(Cs,{value:"reserved",children:"Reserved"}),n.jsx(Cs,{value:"sold",children:"Sold"})]})})]})}),n.jsx(Q,{span:24,children:n.jsx(ue,{size:"small",children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{xs:12,sm:12,md:6,children:n.jsx(Xe,{title:"Total Stalls",value:z.totalStalls,prefix:n.jsx(Wx,{})})}),n.jsx(Q,{xs:12,sm:12,md:6,children:n.jsx(Xe,{title:"Total Area",value:z.totalSize,suffix:"sqm",prefix:n.jsx(ps,{}),precision:2})})]})})}),n.jsx(Q,{span:24,children:n.jsx(ue,{size:"small",title:"Price Range Filter",children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:24,style:{marginBottom:16},children:n.jsxs(xe,{children:[n.jsx(ne,{size:"small",onClick:()=>w([0,5e5]),children:"Under 5L"}),n.jsx(ne,{size:"small",onClick:()=>w([5e5,1e6]),children:"5L - 10L"}),n.jsx(ne,{size:"small",onClick:()=>w([1e6,2e6]),children:"10L - 20L"}),n.jsx(ne,{size:"small",onClick:()=>w([2e6,f]),children:"Above 20L"}),n.jsx(ne,{size:"small",onClick:()=>w([0,f]),children:"All"})]})}),n.jsx(Q,{span:16,children:n.jsx(gu,{range:!0,min:0,max:f,value:y,onChange:U=>w(U),step:Math.max(1e3,Math.floor(f/1e3)),tooltip:{formatter:U=>`${(U||0).toLocaleString()}`}})}),n.jsx(Q,{span:4,children:n.jsx(yt,{style:{width:"100%"},min:0,max:y[1],value:y[0],onChange:U=>w([U||0,y[1]]),formatter:U=>` ${U}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:U=>U?Number(U.replace(/[^\d.-]/g,"")):0,step:1e3})}),n.jsx(Q,{span:4,children:n.jsx(yt,{style:{width:"100%"},min:y[0],max:f,value:y[1],onChange:U=>w([y[0],U||f]),formatter:U=>` ${U}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:U=>U?Number(U.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),n.jsx(Q,{span:24,children:n.jsx(tt,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(U,R)=>U.number.localeCompare(R.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(U,R)=>{var O;return((O=R.stallType)==null?void 0:O.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:U=>U?`${U.toLocaleString()}`:"N/A",sorter:(U,R)=>(U.ratePerSqm||0)-(R.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(U,R)=>{var O,X;return(O=R==null?void 0:R.dimensions)!=null&&O.width&&((X=R==null?void 0:R.dimensions)!=null&&X.height)?`${R.dimensions.width*R.dimensions.height} sqm`:"N/A"},sorter:(U,R)=>{var re,ee,D,q;const O=(((re=U.dimensions)==null?void 0:re.width)||0)*(((ee=U.dimensions)==null?void 0:ee.height)||0),X=(((D=R.dimensions)==null?void 0:D.width)||0)*(((q=R.dimensions)==null?void 0:q.height)||0);return O-X}},{title:"Dimensions",key:"dimensions",render:(U,R)=>{var O,X;return(O=R==null?void 0:R.dimensions)!=null&&O.width&&((X=R==null?void 0:R.dimensions)!=null&&X.height)?`${R.dimensions.width}m  ${R.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(U,R)=>{var O,X;return(O=R==null?void 0:R.dimensions)!=null&&O.width&&((X=R==null?void 0:R.dimensions)!=null&&X.height)&&R.ratePerSqm?`${(R.ratePerSqm*R.dimensions.width*R.dimensions.height).toLocaleString()}`:"N/A"},sorter:(U,R)=>{var re,ee,D,q;const O=(U.ratePerSqm||0)*(((re=U.dimensions)==null?void 0:re.width)||0)*(((ee=U.dimensions)==null?void 0:ee.height)||0),X=(R.ratePerSqm||0)*(((D=R.dimensions)==null?void 0:D.width)||0)*(((q=R.dimensions)==null?void 0:q.height)||0);return O-X}},{title:"Status",dataIndex:"status",key:"status",render:U=>n.jsx(Te,{color:F(U),style:{textTransform:"capitalize"},children:U||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(U,R)=>R.status===U},{title:"Actions",key:"actions",render:(U,R)=>n.jsxs(xe,{children:[n.jsx("a",{onClick:()=>e(`/stall/edit/${R._id||R.id}`),children:"Edit"}),n.jsx("a",{onClick:()=>e(`/stall/view/${R._id||R.id}`),children:"View"})]})}],dataSource:I,rowKey:U=>U._id||U.id,loading:u||s,pagination:{total:I.length,pageSize:10,showSizeChanger:!0,showTotal:U=>`Total ${U} stalls`},onChange:(U,R,O)=>{O.field&&(b(O.field),A(O.order))}})})]})})})},{Title:Yv,Text:Kv}=Le,{TextArea:Xv}=fe,{Search:Qv}=fe,{Option:vh}=Pe,Jv=()=>{Je();const{message:e}=Xt.useApp(),[t,r]=_.useState(!1),[s]=H.useForm(),[i,a]=_.useState(!1),[o,l]=_.useState([]),[d,c]=_.useState(!1),[h,x]=_.useState(null);_.useEffect(()=>{u()},[]),_.useEffect(()=>{var S;if(console.log("Modal visibility changed:",t),console.log("Editing stall type:",h),t&&h){const T=((S=h.features)==null?void 0:S.map(y=>y.feature).join(", "))||"";console.log("Setting form values:",{name:h.name,description:h.description,features:T,status:h.status}),setTimeout(()=>{s.setFieldsValue({name:h.name,description:h.description,features:T,status:h.status})},0)}else t&&(s.resetFields(),s.setFieldsValue({status:"active"}))},[h,s,t]);const u=async()=>{try{c(!0);const S=await Ms.getStallTypes();l(S.data)}catch(S){e.error("Failed to fetch stall types: "+S.message)}finally{c(!1)}},p=async S=>{try{a(!0),console.log("Form values:",S);const T={name:S.name,description:S.description,status:S.status,features:S.features?S.features.split(",").map(y=>({feature:y.trim()})):[]};console.log("Submitting data:",T),h?(await Ms.updateStallType(h._id,T),e.success("Stall type updated successfully")):(await Ms.createStallType(T),e.success("Stall type created successfully")),r(!1),x(null),s.resetFields(),u()}catch(T){e.error(`Failed to ${h?"update":"create"} stall type: `+T.message)}finally{a(!1)}},g=S=>{console.log("Editing stall type:",S),x(S),r(!0)},f=async S=>{try{await Ms.deleteStallType(S._id),e.success("Stall type deleted successfully"),u()}catch(T){e.error("Failed to delete stall type: "+T.message)}},m=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(S,T)=>S.name.localeCompare(T.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:S=>n.jsx(xe,{wrap:!0,children:S==null?void 0:S.map(({feature:T})=>n.jsx(Te,{children:T},T))})},{title:"Status",dataIndex:"status",key:"status",render:S=>n.jsx(Te,{color:S==="active"?"success":"default",children:S.toUpperCase()})},{title:"Actions",key:"actions",render:(S,T)=>n.jsxs(xe,{children:[n.jsx(ne,{type:"link",onClick:()=>g(T),children:"Edit"}),n.jsx(ne,{type:"link",danger:!0,onClick:()=>f(T),children:"Delete"})]})}],v=()=>{r(!1),x(null),s.resetFields()};return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ae,{justify:"space-between",align:"middle",children:[n.jsx(Q,{children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(Yv,{level:4,style:{margin:0},children:"Stall Types"}),n.jsx(Kv,{type:"secondary",children:"Manage your stall types and configurations"})]})}),n.jsx(Q,{children:n.jsxs(xe,{children:[n.jsx(Qv,{placeholder:"Search stall types",style:{width:200},onSearch:S=>console.log(S)}),n.jsx(ne,{type:"primary",icon:n.jsx(fr,{}),onClick:()=>r(!0),children:"Add Stall Type"})]})})]})}),n.jsx(ue,{className:"info-card",children:n.jsx(tt,{columns:m,dataSource:o,rowKey:S=>S._id,loading:d})}),n.jsx(Ve,{title:h?"Edit Stall Type":"Add Stall Type",open:t,onCancel:v,footer:null,destroyOnClose:!1,children:n.jsxs(H,{form:s,layout:"vertical",onFinish:p,initialValues:{status:"active"},preserve:!0,children:[n.jsx(H.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:n.jsx(fe,{placeholder:"e.g., 1 Side Open"})}),n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(Xv,{rows:4,placeholder:"Enter description"})}),n.jsx(H.Item,{name:"features",label:"Features",children:n.jsx(fe,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{children:[n.jsx(vh,{value:"active",children:"Active"}),n.jsx(vh,{value:"inactive",children:"Inactive"})]})}),n.jsx(H.Item,{children:n.jsxs(ne,{type:"primary",htmlType:"submit",loading:i,block:!0,children:[h?"Update":"Create"," Stall Type"]})})]})})]})},Zv={bookings:[],currentBooking:null,loading:!1,error:null},Mn=Qe("booking/fetchBookings",async(e,{rejectWithValue:t})=>{var r,s,i;try{const a=await _e.get("/bookings");return((r=a.data)==null?void 0:r.data)||a.data}catch(a){return t(((i=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch bookings")}}),Ol=Qe("booking/fetchBooking",async e=>(await _e.get(`/bookings/${e}`)).data),so=Qe("booking/createBooking",async e=>(await _e.post("/bookings",e)).data),io=Qe("booking/updateStatus",async({id:e,status:t,rejectionReason:r})=>(await _e.patch(`/bookings/${e}`,{status:t,...r&&{rejectionReason:r}})).data),Bl=Qe("booking/updatePaymentStatus",async({id:e,paymentStatus:t,paymentDetails:r})=>(await _e.patch(`/bookings/${e}/payment`,{paymentStatus:t,paymentDetails:r})).data),ao=Qe("booking/deleteBooking",async e=>(await _e.delete(`/bookings/${e}`),e)),gf=gr({name:"booking",initialState:Zv,reducers:{clearCurrentBooking:e=>{e.currentBooking=null},clearBookingError:e=>{e.error=null}},extraReducers:e=>{e.addCase(Mn.pending,t=>{t.loading=!0,t.error=null}).addCase(Mn.fulfilled,(t,r)=>{t.loading=!1,t.bookings=r.payload}).addCase(Mn.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch bookings"}).addCase(Ol.pending,t=>{t.loading=!0,t.error=null}).addCase(Ol.fulfilled,(t,r)=>{t.loading=!1,t.currentBooking=r.payload}).addCase(Ol.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch booking"}).addCase(so.pending,t=>{t.loading=!0,t.error=null}).addCase(so.fulfilled,(t,r)=>{t.loading=!1,t.bookings.unshift(r.payload),t.currentBooking=r.payload}).addCase(so.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to create booking"}).addCase(io.pending,t=>{t.loading=!0,t.error=null}).addCase(io.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(io.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update booking status"}).addCase(Bl.pending,t=>{t.loading=!0,t.error=null}).addCase(Bl.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(Bl.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update payment status"}).addCase(ao.pending,t=>{t.loading=!0,t.error=null}).addCase(ao.fulfilled,(t,r)=>{var s;t.loading=!1,t.bookings=t.bookings.filter(i=>i._id!==r.payload),((s=t.currentBooking)==null?void 0:s._id)===r.payload&&(t.currentBooking=null)}).addCase(ao.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:s4,clearBookingError:i4}=gf.actions,eb=gf.reducer,tb="/api",oo=Oc({reducerPath:"invoiceApi",baseQuery:Rc({baseUrl:tb,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["Invoice"],endpoints:e=>({getInvoices:e.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:e.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,r,s)=>[{type:"Invoice",id:s}]}),downloadInvoice:e.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:r})})})}),{useGetInvoicesQuery:yf,useGetInvoiceQuery:rb,useShareViaEmailMutation:nb}=oo,sb=({bookings:e})=>{const r={total:e.length,pending:e.filter(i=>i.status==="pending").length,approved:e.filter(i=>i.status==="approved").length,rejected:e.filter(i=>i.status==="rejected").length,confirmed:e.filter(i=>i.status==="confirmed").length,cancelled:e.filter(i=>i.status==="cancelled").length,totalRevenue:e.filter(i=>i.status==="confirmed"||i.status==="approved").reduce((i,a)=>i+a.amount,0),totalActiveBookings:e.filter(i=>i.status==="confirmed"||i.status==="approved").length,totalDeclinedBookings:e.filter(i=>i.status==="cancelled"||i.status==="rejected").length};return n.jsxs(n.Fragment,{children:[n.jsxs(Ae,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Total Bookings",value:r.total,prefix:n.jsx(Gi,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Pending Bookings",value:r.pending,prefix:n.jsx(Yt,{style:{color:"#faad14"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Approved Bookings",value:r.approved,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Confirmed Bookings",value:r.confirmed,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})})]}),n.jsxs(Ae,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Rejected Bookings",value:r.rejected,prefix:n.jsx(Qr,{style:{color:"#f5222d"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Cancelled Bookings",value:r.cancelled,prefix:n.jsx(Qr,{style:{color:"#f5222d"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Total Revenue",value:r.totalRevenue,prefix:"",precision:2})})}),n.jsx(Q,{xs:24,sm:12,md:6})]})]})},{RangePicker:ib}=xs,ab=({filters:e,exhibitions:t,onFilterChange:r,onRefresh:s})=>n.jsx(ue,{style:{marginBottom:"24px"},children:n.jsxs(xe,{wrap:!0,children:[n.jsx(fe,{placeholder:"Search by company name",prefix:n.jsx(An,{}),value:e.search,onChange:i=>r({...e,search:i.target.value}),style:{width:200},allowClear:!0}),n.jsx(Pe,{placeholder:"Filter by exhibition",value:e.exhibition,onChange:i=>r({...e,exhibition:i}),style:{minWidth:200},allowClear:!0,options:t.map(i=>({label:i.name,value:i._id}))}),n.jsx(Pe,{mode:"multiple",placeholder:"Filter by status",value:e.status,onChange:i=>r({...e,status:i}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),n.jsx(ib,{onChange:i=>{var a,o;return r({...e,dateRange:i?[((a=i[0])==null?void 0:a.toISOString())||"",((o=i[1])==null?void 0:o.toISOString())||""]:null})}}),n.jsx(ne,{icon:n.jsx(Xs,{}),onClick:s,children:"Refresh"})]})}),{Title:ob,Text:Tt}=Le,{RangePicker:a4}=xs,lb=()=>{const e=it(),{bookings:t,loading:r}=$e(R=>R.booking),{exhibitions:s}=$e(R=>R.exhibition),[i,a]=_.useState(null),[o,l]=_.useState(!1),[d,c]=_.useState({search:"",status:[],dateRange:null,exhibition:null}),h=Je(),{data:x,isLoading:u,error:p,refetch:g}=yf({page:1,limit:100}),[f,m]=_.useState(!1),[v,S]=_.useState("pending"),[T,y]=_.useState(""),[w,k]=_.useState(!1),{hasPermission:b}=zo();_.useEffect(()=>{e(Mn())},[e]),_.useEffect(()=>{e(Or())},[e]),_.useEffect(()=>{t.length>0&&[...new Set(t.map(O=>O.exhibitionId._id))].forEach(O=>{e(Br(O))})},[t,e]);const j=async(R,O,X)=>{try{k(!0),await e(io({id:R,status:O,...X&&{rejectionReason:X}})).unwrap(),je.success(`Booking ${O} successfully`),e(Mn()),O==="approved"&&setTimeout(async()=>{await g()},1e3),l(!1),m(!1),a(null)}catch{je.error("Failed to update booking status")}finally{k(!1)}},A=async R=>{try{await e(ao(R)).unwrap(),je.success("Booking deleted successfully"),e(Mn())}catch(O){je.error((O==null?void 0:O.message)||"Failed to delete booking")}},E=R=>{c(R)},C=Array.isArray(t)?t:[],I=C.filter(R=>{var O;if(d.search&&!((O=R.companyName)!=null&&O.toLowerCase().includes(d.search.toLowerCase()))||d.status.length>0&&!d.status.includes(R.status)||d.exhibition&&R.exhibitionId._id!==d.exhibition)return!1;if(d.dateRange){const[X,re]=d.dateRange,ee=new Date(R.createdAt);if(ee<new Date(X)||ee>new Date(re))return!1}return!0}),F=(R,O)=>{const X=new Date(O).getFullYear(),re=C.find(Z=>Z._id===R);if(!re)return`--/${X}/--`;const q=(C.filter(Z=>Z.exhibitionId._id===re.exhibitionId._id).sort((Z,se)=>new Date(Z.createdAt).getTime()-new Date(se.createdAt).getTime()).findIndex(Z=>Z._id===R)+1).toString().padStart(2,"0"),B=s.find(Z=>Z._id===re.exhibitionId._id);return`${(B==null?void 0:B.invoicePrefix)||re.exhibitionId.invoicePrefix||"BK"}/${X}/${q}`},N=R=>{if(u)return console.log("Loading invoices..."),null;if(p)return console.error("Error loading invoices:",p),null;if(!x)return console.log("No invoices available"),null;const O=x.data||[];console.log("Looking for invoice with booking ID:",R);const X=O.find(re=>re.bookingId&&typeof re.bookingId=="object"&&re.bookingId._id===R);return console.log("Found invoice:",X),X==null?void 0:X._id},z=async R=>{if(u){je.loading("Loading invoice data...");return}let O=N(R._id);if(O)h(`/invoice/${O}`);else{const X="invoice-loading";if(je.loading({content:"Checking for invoice...",key:X}),await g(),O=N(R._id),O){je.success({content:"Invoice found!",key:X,duration:1}),h(`/invoice/${O}`);return}const re=new Date(R.createdAt),ee=new Date(Date.now()-30*60*1e3);if(re>ee||R.status==="approved"){je.info({content:"Invoice is still being generated. Checking again in a moment...",key:X});let q=0;const B=5,P=[2e3,3e3,5e3,8e3,1e4],Z=async()=>{q++,await g();const se=N(R._id);if(se)je.success({content:"Invoice is ready!",key:X,duration:1}),h(`/invoice/${se}`);else if(q<B){const ie=P[q]||5e3,de=ie/1e3;je.info({content:`Attempt ${q}/${B}: Invoice not ready yet. Trying again in ${de} seconds...`,key:X}),setTimeout(Z,ie)}else je.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:X})};setTimeout(Z,P[0])}else je.error({content:"No invoice found for this booking. Please contact support if this persists.",key:X})}},U=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(R,O)=>n.jsx(ne,{type:"link",onClick:()=>{a(C.find(X=>X._id===R)||null),l(!0)},children:F(R,O.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(R,O)=>O.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:R=>R||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(R,O)=>O.stallIds.map(X=>X.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:R=>`${R.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(R,O)=>{const X=O.calculations.totalDiscountAmount;if(!X||X===0)return"-";const re=O.calculations.stalls.filter(D=>D.discount).map(D=>D.discount);if(re.length===0)return"-";const ee=re[0];return n.jsx(ct,{title:n.jsx("div",{children:re.map((D,q)=>n.jsxs("div",{children:[D==null?void 0:D.name,": ",(D==null?void 0:D.type)==="percentage"?`${D==null?void 0:D.value}%`:`${D==null?void 0:D.value}`,n.jsx("br",{}),"Amount: ",D==null?void 0:D.amount.toLocaleString()]},q))}),children:n.jsxs(Te,{color:"red",children:["-",X.toLocaleString(),(ee==null?void 0:ee.type)==="percentage"&&` (${ee.value}%)`,re.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:R=>`${R.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:R=>n.jsx(Te,{color:R==="confirmed"?"success":R==="approved"?"blue":R==="pending"?"warning":R==="rejected"?"error":"default",children:R.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:R=>et(R).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(R,O)=>n.jsxs(xe,{children:[n.jsx(ct,{title:"View Details",children:n.jsx(ne,{icon:n.jsx(hn,{}),onClick:()=>{a(O),l(!0)}})}),n.jsx(Vn,{overlay:n.jsxs(lr,{children:[O.status!=="cancelled"&&b("view_bookings")&&n.jsx(lr.Item,{icon:n.jsx(Cn,{}),disabled:u,onClick:()=>z(O),children:"View Invoice"},"invoice"),n.jsx(lr.Item,{icon:n.jsx(vt,{}),onClick:()=>{a(O),S(O.status),y(O.rejectionReason||""),m(!0)},children:"Update Status"},"updateStatus"),b("bookings_delete")&&n.jsx(lr.Item,{icon:n.jsx(or,{}),danger:!0,onClick:()=>{Ve.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>A(O._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(ne,{icon:n.jsx(jc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ae,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(ob,{level:4,style:{margin:0},children:"Stall Bookings"}),n.jsx(Tt,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),n.jsx(Q,{children:n.jsx(ne,{type:"primary",size:"large",icon:n.jsx(fr,{}),onClick:()=>h("/bookings/create"),children:"Create Booking"})})]})}),n.jsx(sb,{bookings:t}),n.jsx(ab,{filters:d,exhibitions:s,onFilterChange:E,onRefresh:()=>e(Mn())}),n.jsx(ue,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:n.jsx(tt,{columns:U,dataSource:I,loading:r,rowKey:"_id",scroll:{x:1500},pagination:{total:I.length,pageSize:10,showSizeChanger:!0,showTotal:R=>`Total ${R} items`,position:["bottomRight"]}})}),n.jsx(Ve,{title:"Booking Details",open:o,onCancel:()=>{l(!1),a(null)},footer:[n.jsx(ne,{type:"primary",disabled:!i,onClick:()=>{i&&(S(i.status),y(i.rejectionReason||""),m(!0))},children:"Update Status"},"updateStatus"),n.jsx(ne,{onClick:()=>{l(!1),a(null)},children:"Close"},"close")],width:800,children:i&&n.jsxs(xe,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(We,{bordered:!0,column:2,children:[n.jsxs(We.Item,{label:"Booking Number",span:2,children:[F(i._id,i.createdAt),n.jsxs(Tt,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",i._id,")"]})]}),n.jsx(We.Item,{label:"Exhibition",span:2,children:i.exhibitionId.name}),n.jsxs(We.Item,{label:"Status",span:2,children:[n.jsx(Te,{color:i.status==="confirmed"?"success":i.status==="approved"?"blue":i.status==="pending"?"warning":i.status==="rejected"?"error":"default",children:i.status.toUpperCase()}),i.rejectionReason&&n.jsxs("div",{style:{marginTop:8},children:[n.jsx(Tt,{type:"secondary",children:"Rejection Reason:"}),n.jsx("br",{}),n.jsx(Tt,{children:i.rejectionReason})]})]}),n.jsx(We.Item,{label:"Customer Name",children:i.customerName}),n.jsx(We.Item,{label:"Customer Email",children:i.customerEmail}),n.jsx(We.Item,{label:"Customer Phone",children:i.customerPhone}),n.jsx(We.Item,{label:"Company Name",children:i.companyName})]}),n.jsx(ue,{title:"Stall Details",size:"small",children:n.jsx(tt,{dataSource:i.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:R=>n.jsxs(Te,{color:"blue",children:[R.dimensions.width,"x",R.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:R=>`${R.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:R=>{const O=i.calculations.stalls.find(X=>X.stallId===R._id);return O?`${O.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:R=>{const O=i.calculations.stalls.find(X=>X.stallId===R._id);return O!=null&&O.discount?n.jsxs(Te,{color:"red",children:["-",O.discount.amount.toLocaleString(),O.discount.type==="percentage"&&` (${O.discount.value}%)`]}):"-"}}]})}),n.jsx(ue,{title:"Financial Summary",size:"small",children:n.jsxs(xe,{direction:"vertical",style:{width:"100%"},size:"small",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Tt,{children:"Total Base Amount:"}),n.jsxs(Tt,{children:["",i.calculations.totalBaseAmount.toLocaleString()]})]}),i.calculations.totalDiscountAmount>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Tt,{children:"Total Discount:"}),n.jsxs(Tt,{type:"danger",children:["-",i.calculations.totalDiscountAmount.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Tt,{children:"Amount after Discount:"}),n.jsxs(Tt,{children:["",i.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),n.jsx(nt,{style:{margin:"8px 0"}}),i.calculations.taxes.map(R=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Tt,{children:[R.name," (",R.rate,"%):"]}),n.jsxs(Tt,{children:["",R.amount.toLocaleString()]})]},R.name)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(Tt,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(Tt,{strong:!0,children:["",i.amount.toLocaleString()]})]})]})})]})}),n.jsx(Ve,{title:"Update Booking Status",open:f,onCancel:()=>{m(!1),y("")},footer:null,width:600,children:i&&n.jsxs("div",{children:[n.jsx(ue,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Cn,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},variant:"borderless",size:"small",children:n.jsxs(Ae,{gutter:[16,8],children:[n.jsx(Q,{span:8,children:n.jsx(Tt,{strong:!0,children:"Booking Number:"})}),n.jsx(Q,{span:16,children:n.jsx(Tt,{children:F(i._id,i.createdAt)})}),n.jsx(Q,{span:8,children:n.jsx(Tt,{strong:!0,children:"Company:"})}),n.jsx(Q,{span:16,children:n.jsx(Tt,{children:i.companyName})}),n.jsx(Q,{span:8,children:n.jsx(Tt,{strong:!0,children:"Exhibition:"})}),n.jsx(Q,{span:16,children:n.jsx(Tt,{children:i.exhibitionId.name})}),n.jsx(Q,{span:8,children:n.jsx(Tt,{strong:!0,children:"Current Status:"})}),n.jsx(Q,{span:16,children:n.jsx(Te,{color:i.status==="confirmed"?"success":i.status==="approved"?"blue":i.status==="pending"?"warning":i.status==="rejected"?"error":"default",children:i.status.toUpperCase()})})]})}),n.jsxs(ue,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Qs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),variant:"borderless",size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Tt,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(mr.Group,{value:v,onChange:R=>S(R.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[n.jsx(mr.Button,{value:"pending",style:{flex:"0 0 auto"},children:n.jsxs(xe,{children:[n.jsx(Yt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(mr.Button,{value:"approved",style:{flex:"0 0 auto"},children:n.jsxs(xe,{children:[n.jsx(vt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(mr.Button,{value:"rejected",style:{flex:"0 0 auto"},children:n.jsxs(xe,{children:[n.jsx(Qr,{style:{color:"#f5222d"}}),"Rejected"]})}),n.jsx(mr.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:n.jsxs(xe,{children:[n.jsx(vt,{style:{color:"#1890ff"}}),"Confirmed"]})}),n.jsx(mr.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:n.jsxs(xe,{children:[n.jsx(Qr,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),v==="rejected"&&n.jsx("div",{children:n.jsx(H.Item,{label:n.jsx(Tt,{strong:!0,children:"Rejection Reason:"}),required:v==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:n.jsx(fe.TextArea,{rows:4,value:T,onChange:R=>y(R.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),v==="approved"&&n.jsx(kt,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),v==="confirmed"&&n.jsx(kt,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),v==="cancelled"&&n.jsx(kt,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),v==="pending"&&n.jsx(kt,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(ne,{onClick:()=>{m(!1),y("")},children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:()=>{if(v==="rejected"&&!T.trim()){je.error("Rejection reason is required when rejecting a booking");return}j(i._id,v,v==="rejected"?T:void 0)},loading:w,disabled:v==="rejected"&&!T.trim(),children:"Update Status"})]})]})]})})]})},cb={exhibitors:[],loading:!1,error:null},cn=Qe("exhibitors/fetchAll",async(e,{rejectWithValue:t})=>{var r,s;try{return(await ar.getExhibitors()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch exhibitors")}}),db=gr({name:"exhibitor",initialState:cb,reducers:{},extraReducers:e=>{e.addCase(cn.pending,t=>{t.loading=!0,t.error=null}).addCase(cn.fulfilled,(t,r)=>{t.exhibitors=r.payload,t.loading=!1}).addCase(cn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),hb=db.reducer,{Title:ub,Text:tn}=Le,fb=()=>{var se,ie,de;const[e]=H.useForm(),[t]=H.useForm(),[r,s]=_.useState(!1),[i,a]=_.useState([]),[o,l]=_.useState(!1),[d,c]=_.useState([]),[h,x]=_.useState(null),[u,p]=_.useState(),[g,f]=_.useState([]),[m,v]=_.useState({}),[S,T]=_.useState([]),[y,w]=_.useState(0),k=Je(),b=it(),{loading:j}=$e(G=>G.booking),{exhibitions:A=[],loading:E}=$e(G=>G.exhibition),{exhibitors:C=[],loading:I}=$e(G=>G.exhibitor),{isAuthenticated:F}=$e(G=>G.auth);_.useEffect(()=>{if(!F){je.error("Please login to create a booking"),k("/login");return}b(Or()),b(cn())},[b,F,k]);const N=async G=>{try{l(!0),e.setFieldValue("stallIds",[]),e.setFieldValue("discountId",void 0),e.setFieldValue("extraAmenities",[]),c([]),f([]),T([]),w(0);const V=await gt.getExhibition(G);x(V.data);const ge=(await gt.getStalls(G)).data.filter(te=>te.status==="available");a(ge)}catch(V){console.error("Failed to fetch exhibition data:",V),je.error("Failed to fetch exhibition data")}finally{l(!1)}},z=G=>Math.round(G.ratePerSqm*G.dimensions.width*G.dimensions.height*100)/100,U=G=>{var ge;const V=i.filter(te=>{const be=te._id||te.id;return be&&G.includes(be)});c(V);const ae=V.reduce((te,be)=>te+be.dimensions.width*be.dimensions.height,0);if(w(ae),(ge=h==null?void 0:h.basicAmenities)!=null&&ge.length){const te=h.basicAmenities.map(be=>{const Ie=Math.floor(ae/be.perSqm)*be.quantity;return{...be,calculatedQuantity:Ie>0?Ie:0,key:be._id||be.id}});T(te)}},R=(G,V,ae)=>{if(!(ae!=null&&ae.isActive))return 0;let ge=0;if(ae.type==="percentage")ge=G*(Math.max(0,Math.min(100,ae.value))/100);else{const te=G/V*ae.value;ge=Math.min(te,G)}return Math.round(ge*100)/100},O=async G=>{var V,ae;try{const ge=C.find(Be=>Be._id===G.exhibitorId);if(!ge)throw new Error("Selected exhibitor not found");const[te,be,Ie]=G.discountId?G.discountId.split("-"):[],ye=(V=h==null?void 0:h.discountConfig)==null?void 0:V.find(Be=>`${Be.name}-${Be.value}-${Be.type}`===G.discountId),Me=d.map(Be=>{const ut=Be._id||Be.id;if(!ut)throw new Error(`Invalid stall ID for stall number ${Be.number}`);return{stall:Be,stallId:ut,baseAmount:z(Be)}}),Ue=Me.reduce((Be,{baseAmount:ut})=>Be+ut,0),wt=Me.map(({stall:Be,stallId:ut,baseAmount:At})=>{const jr=ye?R(At,Ue,ye):0;return{stallId:ut,number:Be.number,baseAmount:At,discount:ye?{name:ye.name,type:ye.type,value:ye.value,amount:jr}:void 0,amountAfterDiscount:Math.round((At-jr)*100)/100}}),qt=wt.reduce((Be,ut)=>{var At;return Be+(((At=ut.discount)==null?void 0:At.amount)||0)},0),Wt=Math.round((Ue-qt)*100)/100,Rr=((ae=h==null?void 0:h.taxConfig)==null?void 0:ae.filter(Be=>Be.isActive).map(Be=>({name:Be.name,rate:Be.rate,amount:Math.round(Wt*Be.rate/100*100)/100})))||[],Fe=Rr.reduce((Be,ut)=>Be+ut.amount,0),ze=Math.round((Wt+Fe)*100)/100,Ke={exhibitionId:G.exhibitionId,exhibitorId:G.exhibitorId,stallIds:wt.map(Be=>Be.stallId),customerName:ge.contactPerson,customerEmail:ge.email,customerPhone:ge.phone,customerAddress:ge.address||"N/A",customerGSTIN:ge.gstNumber||"N/A",customerPAN:ge.panNumber||"N/A",companyName:ge.companyName,discount:ye?{name:ye.name,type:ye.type,value:ye.value}:void 0,amount:ze,calculations:{stalls:wt,totalBaseAmount:Ue,totalDiscountAmount:qt,totalAmountAfterDiscount:Wt,taxes:Rr,totalTaxAmount:Fe,totalAmount:ze}};S.length&&(Ke.basicAmenities=S.filter(Be=>Be.calculatedQuantity>0).map(Be=>({name:Be.name,type:Be.type,perSqm:Be.perSqm,quantity:Be.quantity,calculatedQuantity:Be.calculatedQuantity,description:Be.description}))),g.length&&(Ke.extraAmenities=B());const Oe=await b(so(Ke)).unwrap();Oe&&Oe.invoiceId?(je.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{k(`/invoice/${Oe.invoiceId}`)},2e3)):(je.success("Booking created successfully"),k("/bookings")),Oe&&Oe.warning&&je.warning(Oe.warning)}catch(ge){console.error("Error creating booking:",ge),je.error("Failed to create booking")}},X=async G=>{try{const V=await ar.createExhibitor(G);je.success("Exhibitor added successfully"),b(cn()),e.setFieldsValue({exhibitorId:V.data._id}),s(!1),t.resetFields()}catch(V){const ae=(V==null?void 0:V.message)||"Failed to add exhibitor";je.error(ae),ae==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},re=A.map(G=>({label:G.name,value:G._id||G.id})),ee=C.map(G=>({label:G.companyName,value:G._id}));i.map(G=>({label:`Stall ${G.number} (${G.dimensions.width}m  ${G.dimensions.height}m = ${(G.dimensions.width*G.dimensions.height).toFixed(2)} sqm) - ${G.ratePerSqm.toLocaleString()}/sq.m`,value:G._id||G.id}));const D=G=>{p(G),e.setFieldValue("discountId",G)},q=()=>{var ye,Me;const G=d.reduce((Ue,wt)=>Ue+z(wt),0),V=(ye=h==null?void 0:h.discountConfig)==null?void 0:ye.find(Ue=>`${Ue.name}-${Ue.value}-${Ue.type}`===u&&Ue.isActive),ae=V?V.type==="percentage"?Math.round(G*V.value/100*100)/100:Math.min(V.value,G):0,ge=Math.round((G-ae)*100)/100,te=((Me=h==null?void 0:h.taxConfig)==null?void 0:Me.filter(Ue=>Ue.isActive).map(Ue=>({name:Ue.name,rate:Ue.rate,amount:Math.round(ge*Ue.rate/100*100)/100})))||[],be=te.reduce((Ue,wt)=>Ue+wt.amount,0),Ie=Math.round((ge+be)*100)/100;return{baseAmount:G,selectedDiscount:V,discountAmount:ae,amountAfterDiscount:ge,taxes:te,totalTaxAmount:be,totalAmount:Ie}},B=()=>{var G;return(G=h==null?void 0:h.amenities)!=null&&G.length?h.amenities.filter(V=>{const ae=V._id||V.id;return ae&&g.includes(ae.toString())}).map(V=>{const ae=(V._id||V.id).toString();return{id:ae,name:V.name,type:V.type,rate:V.rate,description:V.description,quantity:m[ae]||1}}):[]},P=G=>{const V={...m};G.forEach(ae=>{g.includes(ae)||(V[ae]=1)}),Object.keys(V).forEach(ae=>{G.includes(ae)||delete V[ae]}),v(V),f(G)},Z=(G,V)=>{v(ae=>({...ae,[G]:V}))};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{span:24,children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(ub,{level:2,style:{margin:0},children:"Create Booking"}),n.jsx(Le.Text,{type:"secondary",children:"Create a new stall booking"})]})}),n.jsx(Q,{span:24,children:n.jsx(ue,{children:n.jsx(H,{form:e,layout:"vertical",onFinish:O,style:{maxWidth:800},children:n.jsxs(Ae,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:n.jsx(Pe,{placeholder:"Select exhibition",loading:E,options:re,onChange:N})})}),n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"exhibitorId",label:n.jsxs(xe,{children:[n.jsx("span",{children:"Exhibitor"}),n.jsx(ne,{type:"link",icon:n.jsx(fr,{}),onClick:()=>s(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:n.jsx(Pe,{showSearch:!0,placeholder:"Select exhibitor",loading:I,options:ee,filterOption:(G,V)=>{var ae;return(((ae=V==null?void 0:V.label)==null?void 0:ae.toString())??"").toLowerCase().includes(G.toLowerCase())}})})}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:n.jsx(Pe,{mode:"multiple",placeholder:o?"Loading stalls...":"Select stalls",loading:o,onChange:U,options:i.map(G=>({label:`Stall ${G.number} (${G.dimensions.width}m  ${G.dimensions.height}m = ${(G.dimensions.width*G.dimensions.height).toFixed(2)} sqm) - ${G.ratePerSqm.toLocaleString()}/sq.m`,value:G._id||G.id}))})})}),d.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Q,{span:24,children:n.jsx(ue,{title:"Selected Stalls Summary",size:"small",children:n.jsx(tt,{dataSource:d.map(G=>({...G,key:G._id||G.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(G,V)=>{var ae,ge;return((ae=V.stallType)==null?void 0:ae.name)||(typeof V.stallTypeId=="object"?(ge=V.stallTypeId)==null?void 0:ge.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(G,V)=>`${V.dimensions.width}m  ${V.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(G,V)=>(V.dimensions.width*V.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:G=>`${G.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(G,V)=>`${z(V).toLocaleString()}`}],summary:()=>{const G=d.reduce((V,ae)=>V+z(ae),0);return n.jsxs(tt.Summary.Row,{children:[n.jsx(tt.Summary.Cell,{index:0,colSpan:5,children:n.jsx("strong",{children:"Total Base Amount"})}),n.jsx(tt.Summary.Cell,{index:1,children:n.jsxs("strong",{children:["",G.toLocaleString()]})})]},"summary")}})})}),n.jsx(Q,{span:24,children:n.jsx(ue,{title:"Stall Amenities",size:"small",children:n.jsxs(Ae,{gutter:[16,24],children:[n.jsxs(Q,{span:24,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Le.Title,{level:5,style:{margin:0},children:n.jsxs(xe,{children:[n.jsx("span",{children:"Included Basic Amenities"}),n.jsx(Te,{color:"green",children:"Based on stall area"})]})}),n.jsxs(Le.Text,{type:"secondary",children:["The following amenities are included based on your total stall area of ",y.toFixed(2)," sqm."]})]}),(se=h==null?void 0:h.basicAmenities)!=null&&se.length?n.jsx(tt,{dataSource:S.filter(G=>G.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(G,V)=>n.jsxs(xe,{children:[n.jsx(Le.Text,{strong:!0,children:G}),n.jsx(Te,{color:"blue",children:V.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:G=>n.jsxs(Te,{color:"green",children:[G," ",G===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(G,V)=>n.jsx(ct,{title:V.description,children:n.jsxs(Le.Text,{type:"secondary",children:[n.jsx(Zr,{style:{marginRight:5}}),"1 ",V.quantity>1?`set of ${V.quantity}`:"unit"," per ",G," sqm"]})})},{title:"Status",key:"status",width:100,align:"right",render:()=>n.jsx(Le.Text,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:n.jsx(Le.Text,{children:"No basic amenities qualify based on the selected stall area."})}}):n.jsx(Le.Text,{type:"secondary",children:"No basic amenities have been configured for this exhibition."})]}),n.jsxs(Q,{span:24,children:[n.jsx(nt,{style:{margin:"12px 0 24px"}}),n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Le.Title,{level:5,style:{margin:0},children:n.jsxs(xe,{children:[n.jsx("span",{children:"Additional Amenities"}),n.jsx(Te,{color:"blue",children:"Optional"})]})}),n.jsx(Le.Text,{type:"secondary",children:"Select any additional amenities for the booking."})]}),(ie=h==null?void 0:h.amenities)!=null&&ie.length?n.jsxs(n.Fragment,{children:[n.jsx(H.Item,{name:"extraAmenities",label:"Select Additional Amenities",children:n.jsx(Pe,{mode:"multiple",placeholder:"Select amenities",style:{width:"100%"},onChange:P,optionLabelProp:"label",options:h.amenities.map(G=>({label:`${G.name} (${G.rate?`${G.rate.toLocaleString()}`:"N/A"})`,value:G._id||G.id,key:G._id||G.id}))})}),g.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Le.Text,{strong:!0,children:"Selected Amenities:"}),n.jsx(tt,{dataSource:B(),columns:[{title:"Name",dataIndex:"name",key:"name",render:(G,V)=>n.jsxs(xe,{align:"center",children:[n.jsx(Le.Text,{strong:!0,children:G}),n.jsx(Te,{color:"blue",children:V.type}),n.jsx(Le.Text,{type:"secondary",style:{fontSize:"13px"},children:V.description||""})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:G=>n.jsxs(Le.Text,{strong:!0,style:{color:"#1890ff"},children:["",G.toLocaleString("en-IN")]})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(G,V)=>n.jsx(yt,{min:1,value:m[V.id]||1,onChange:ae=>Z(V.id,ae||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,align:"right",render:(G,V)=>{const ae=m[V.id]||1,ge=V.rate*ae;return n.jsxs(Le.Text,{strong:!0,style:{color:"#1890ff"},children:["",ge.toLocaleString("en-IN")]})}}],pagination:!1,size:"small"})]})]}):n.jsx(Le.Text,{type:"secondary",children:"No additional amenities have been configured for this exhibition."})]})]})})}),n.jsx(Q,{span:24,children:n.jsxs(ue,{title:"Price Calculations",size:"small",children:[n.jsx(Ae,{gutter:[16,16],children:n.jsx(Q,{span:12,children:n.jsx(H.Item,{name:"discountId",label:"Available Discounts",children:n.jsx(Pe,{placeholder:"Select discount",allowClear:!0,onChange:D,options:(de=h==null?void 0:h.discountConfig)==null?void 0:de.map(G=>({label:`${G.name} (${G.type==="percentage"?G.value+"%":""+G.value})${G.isActive?"":" - Inactive"}`,value:`${G.name}-${G.value}-${G.type}`,disabled:!G.isActive}))})})})}),n.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:n.jsx(xe,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:G,selectedDiscount:V,discountAmount:ae,amountAfterDiscount:ge,taxes:te,totalAmount:be}=q();return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(tn,{children:"Total Base Amount:"}),n.jsxs(tn,{children:["",G.toLocaleString()]})]}),V&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(tn,{children:["Discount (",V.type==="percentage"?`${V.value}%`:`${V.value.toLocaleString()}`,"):"]}),n.jsxs(tn,{type:"danger",children:["-",ae.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(tn,{children:"Amount after Discount:"}),n.jsxs(tn,{children:["",ge.toLocaleString()]})]}),n.jsx(nt,{style:{margin:"8px 0"}}),te.map(Ie=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(tn,{children:[Ie.name," (",Ie.rate,"%):"]}),n.jsxs(tn,{children:["",Ie.amount.toLocaleString()]})]},`tax-${Ie.name}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(tn,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(tn,{strong:!0,children:["",be.toLocaleString()]})]})]})})()})})]})})]}),n.jsx(Q,{span:24,children:n.jsx(H.Item,{children:n.jsxs(xe,{children:[n.jsx(ne,{type:"primary",htmlType:"submit",loading:j,children:"Create Booking"}),n.jsx(ne,{onClick:()=>k("/bookings"),children:"Cancel"})]})})})]})})})})]}),n.jsx(Ve,{title:n.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:r,onCancel:()=>{s(!1),t.resetFields()},width:800,footer:n.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[n.jsx(ne,{onClick:()=>{s(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:n.jsx(H,{form:t,layout:"vertical",onFinish:X,requiredMark:!1,children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(fe.TextArea,{rows:3})}),n.jsx(H.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"status",label:"Status",initialValue:"active",children:n.jsxs(Pe,{children:[n.jsx(Pe.Option,{value:"active",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),n.jsx(Pe.Option,{value:"inactive",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(fe,{placeholder:"ABCDE1234F"})}),n.jsx(H.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(fe,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})},xb=()=>{const{id:e}=Fr(),t=Je(),{data:r,isLoading:s}=rb(e||""),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d]=H.useForm(),[c,h]=_.useState(0),[x,u]=_.useState(!1),p=async()=>{if(e)try{u(!0),h(0),je.loading({content:"Preparing invoice...",key:"download"});const m=await ku(`/invoices/${e}/download?force=false`,!1,T=>{const y=T.total,w=T.loaded;if(y){const k=Math.round(w*100/y);h(k),k%25===0&&je.loading({content:`Downloading: ${k}% complete`,key:"download"})}}),v=window.URL.createObjectURL(new Blob([m.data])),S=document.createElement("a");S.href=v,S.setAttribute("download",`invoice-${e}.pdf`),document.body.appendChild(S),S.click(),S.remove(),window.URL.revokeObjectURL(v),je.success({content:"Invoice downloaded successfully",key:"download"})}catch(m){console.error("Download error:",m),je.error({content:"Failed to download invoice",key:"download"})}finally{u(!1),h(0)}},g=async m=>{try{await _e.post(`/invoices/${e}/share/email`,m),je.success("Invoice shared via email successfully"),a(!1),d.resetFields()}catch(v){console.error("Email sharing error:",v),je.error("Failed to share invoice via email")}},f=async m=>{try{await _e.post(`/invoices/${e}/share/whatsapp`,m),je.success("Invoice shared via WhatsApp successfully"),l(!1),d.resetFields()}catch(v){console.error("WhatsApp sharing error:",v),je.error("Failed to share invoice via WhatsApp")}};return s||!r?n.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",r),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(ue,{title:"Invoice Details",extra:n.jsxs(xe,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(xe,{children:[n.jsx(ne,{icon:n.jsx(Gn,{}),onClick:()=>t(-1),disabled:x,children:"Back"}),n.jsx(ne,{type:"primary",icon:n.jsx(Po,{}),onClick:p,loading:x&&c<100,disabled:x&&c>=100,children:"Download"}),n.jsx(ne,{icon:n.jsx(fn,{}),onClick:()=>a(!0),disabled:x,children:"Share via Email"}),n.jsx(ne,{icon:n.jsx(mu,{}),onClick:()=>l(!0),disabled:x,children:"Share via WhatsApp"})]}),x&&n.jsx(Kr,{percent:c,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:n.jsx(cf,{booking:{...r.bookingId,customerGSTIN:r.bookingId.customerGSTIN||"",invoiceNumber:r.invoiceNumber,exhibitionId:{...r.bookingId.exhibitionId,companyName:r.bookingId.exhibitionId.companyName||"Company Name",bankName:r.bookingId.exhibitionId.bankName||"",bankAccount:r.bookingId.exhibitionId.bankAccount||"",bankAccountName:r.bookingId.exhibitionId.bankAccountName||"",bankBranch:r.bookingId.exhibitionId.bankBranch||"",bankIFSC:r.bookingId.exhibitionId.bankIFSC||"",companyCIN:r.bookingId.exhibitionId.companyCIN||"",companyPAN:r.bookingId.exhibitionId.companyPAN||"",companySAC:r.bookingId.exhibitionId.companySAC||"",companyGST:r.bookingId.exhibitionId.companyGST||"",companyEmail:r.bookingId.exhibitionId.companyEmail||"",companyWebsite:r.bookingId.exhibitionId.companyWebsite||"",companyAddress:r.bookingId.exhibitionId.companyAddress||"",headerLogo:r.bookingId.exhibitionId.headerLogo||void 0},calculations:{...r.bookingId.calculations,stalls:r.bookingId.calculations.stalls.map(m=>({discount:m.discount?{...m.discount,type:m.discount.type||"percentage",value:m.discount.value}:void 0}))}}})}),n.jsx(Ve,{title:"Share Invoice via Email",open:i,onCancel:()=>a(!1),footer:null,children:n.jsxs(H,{form:d,onFinish:g,layout:"vertical",children:[n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(fe,{placeholder:"Enter email address"})}),n.jsx(H.Item,{name:"message",label:"Message (Optional)",children:n.jsx(fe.TextArea,{placeholder:"Enter optional message"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ve,{title:"Share Invoice via WhatsApp",open:o,onCancel:()=>l(!1),footer:null,children:n.jsxs(H,{form:d,onFinish:f,layout:"vertical",children:[n.jsx(H.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:n.jsx(fe,{placeholder:"Enter phone number with country code"})}),n.jsx(H.Item,{children:n.jsx(ne,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:pb,Text:As}=Le,{Option:ka}=Pe,{RangePicker:mb}=xs,gb=()=>{var G;const e=Je(),t=it(),[r,s]=_.useState(1),[i,a]=_.useState(10),[o,l]=_.useState(""),[d,c]=_.useState(null),[h,x]=_.useState(null),[u,p]=_.useState(null),[g,f]=_.useState(!1),[m,v]=_.useState(null),[S,T]=_.useState(""),[y,w]=_.useState(""),[k,b]=_.useState("createdAt"),[j,A]=_.useState("descend"),[E,C]=je.useMessage(),[I,F]=_.useState(null),[N,z]=_.useState(0),{exhibitions:U,loading:R}=$e(V=>V.exhibition);_.useEffect(()=>{t(Or())},[t]);const{data:O,isLoading:X,refetch:re}=yf({page:r,limit:i}),[ee,{isLoading:D}]=nb(),q=xt.useMemo(()=>O!=null&&O.data?O.data.filter(V=>{const ae=o.toLowerCase(),ge=o===""||V.invoiceNumber&&V.invoiceNumber.toLowerCase().includes(ae)||V._id.toLowerCase().includes(ae)||V.bookingId.customerName&&V.bookingId.customerName.toLowerCase().includes(ae)||V.bookingId.companyName&&V.bookingId.companyName.toLowerCase().includes(ae),te=!d||V.status===d,be=!h||V.bookingId.exhibitionId&&V.bookingId.exhibitionId._id===h;let Ie=!0;if(u&&u[0]&&u[1]){const ye=et(V.createdAt);Ie=ye.isAfter(u[0])&&ye.isBefore(u[1])}return ge&&te&&be&&Ie}):[],[O,o,d,h,u]),B=async V=>{try{F(V),z(0),E.loading({content:"Preparing invoice...",key:V});const ae=await ku(`/invoices/${V}/download?force=false`,!1,be=>{const Ie=be.total,ye=be.loaded;if(Ie){const Me=Math.round(ye*100/Ie);z(Me),Me%25===0&&E.loading({content:`Downloading: ${Me}% complete`,key:V})}}),ge=window.URL.createObjectURL(new Blob([ae.data])),te=document.createElement("a");te.href=ge,te.setAttribute("download",`invoice-${V}.pdf`),document.body.appendChild(te),te.click(),te.remove(),window.URL.revokeObjectURL(ge),E.success({content:"Invoice downloaded successfully",key:V})}catch(ae){console.error("Download error:",ae),E.error({content:"Failed to download invoice",key:V})}finally{F(null),z(0)}},P=async()=>{if(!(!m||!S))try{E.loading({content:"Sending email...",key:"email"}),await ee({id:m,email:S,message:y||void 0}).unwrap(),E.success({content:"Invoice sent via email successfully",key:"email"}),f(!1),T(""),w(""),v(null)}catch(V){console.error("Email error:",V),E.error({content:"Failed to send invoice via email",key:"email"})}},Z=V=>{v(V),f(!0)},se=()=>{l(""),c(null),x(null),p(null)},ie=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:k==="invoiceNumber"?j:null,render:(V,ae)=>n.jsx("a",{onClick:()=>e(`/invoice/${ae._id}`),children:V||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:k==="companyName"?j:null,render:V=>V||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:k==="exhibitionName"?j:null,render:(V,ae)=>n.jsx("a",{onClick:()=>e(`/exhibition/${ae.bookingId.exhibitionId._id}`),children:V})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:k==="amount"?j:null,render:V=>`${V.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:k==="status"?j:null,render:V=>n.jsx(Te,{color:V==="paid"?"green":V==="pending"?"gold":V==="cancelled"?"red":"blue",children:V.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:k==="dueDate"?j:null,render:V=>V?et(V).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:k==="createdAt"?j:null,render:V=>et(V).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(V,ae)=>n.jsxs(xe,{direction:"vertical",size:"small",style:{width:"100%"},children:[n.jsxs(xe,{children:[n.jsx(ct,{title:"View Invoice",children:n.jsx(ne,{type:"text",icon:n.jsx(hn,{}),onClick:()=>e(`/invoice/${ae._id}`)})}),n.jsx(ct,{title:"Download",children:n.jsx(ne,{type:"text",icon:n.jsx(Po,{}),onClick:()=>B(ae._id),loading:I===ae._id&&N<100,disabled:I!==null&&I!==ae._id})}),n.jsx(ct,{title:"Email",children:n.jsx(ne,{type:"text",icon:n.jsx(fn,{}),onClick:()=>Z(ae._id),disabled:I!==null})})]}),I===ae._id&&n.jsx(Kr,{percent:N,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],de=(V,ae,ge)=>{ge&&ge.field&&(b(ge.field),A(ge.order||"descend"))};return n.jsxs(Xt,{children:[C,n.jsxs("div",{className:"invoice-list-container",children:[n.jsx(ue,{children:n.jsxs(xe,{direction:"vertical",style:{width:"100%"},size:"large",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(pb,{level:2,style:{margin:0},children:"Invoices"}),n.jsx(xe,{children:n.jsx(ct,{title:"Refresh",children:n.jsx(ne,{icon:n.jsx(Xs,{}),onClick:()=>re(),loading:X})})})]}),n.jsx(ue,{size:"small",title:n.jsxs(xe,{children:[n.jsx(Gi,{})," Filters"]}),children:n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[n.jsxs("div",{style:{minWidth:"200px",flex:1},children:[n.jsx(As,{strong:!0,children:"Search"}),n.jsx(fe,{placeholder:"Search by invoice #, company...",value:o,onChange:V=>l(V.target.value),prefix:n.jsx(An,{}),allowClear:!0})]}),n.jsxs("div",{style:{minWidth:"150px"},children:[n.jsx(As,{strong:!0,children:"Status"}),n.jsxs(Pe,{style:{width:"100%"},placeholder:"Filter by status",value:d,onChange:c,allowClear:!0,children:[n.jsx(ka,{value:"pending",children:"Pending"}),n.jsx(ka,{value:"paid",children:"Paid"}),n.jsx(ka,{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{style:{minWidth:"200px"},children:[n.jsx(As,{strong:!0,children:"Exhibition"}),n.jsx(Pe,{style:{width:"100%"},placeholder:"Filter by exhibition",value:h,onChange:x,loading:R,allowClear:!0,children:U.map(V=>n.jsx(ka,{value:V._id||V.id,children:V.name},V._id||V.id))})]}),n.jsxs("div",{style:{minWidth:"300px"},children:[n.jsx(As,{strong:!0,children:"Date Range"}),n.jsx(mb,{style:{width:"100%"},value:u,onChange:p})]}),n.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:n.jsx(ne,{icon:n.jsx(Hx,{}),onClick:se,children:"Clear Filters"})})]})}),n.jsx(tt,{columns:ie,dataSource:q,rowKey:"_id",loading:X,pagination:{current:r,pageSize:i,total:((G=O==null?void 0:O.pagination)==null?void 0:G.total)||0,onChange:(V,ae)=>{s(V),ae&&a(ae)},showSizeChanger:!0,showTotal:V=>`Total ${V} invoices`},onChange:de})]})}),n.jsxs(Ve,{title:"Send Invoice via Email",open:g,onCancel:()=>f(!1),onOk:P,okText:"Send",confirmLoading:D,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(As,{strong:!0,children:"Email Address"}),n.jsx(fe,{placeholder:"Enter recipient email",value:S,onChange:V=>T(V.target.value),style:{width:"100%"}})]}),n.jsxs("div",{children:[n.jsx(As,{strong:!0,children:"Message (Optional)"}),n.jsx(fe.TextArea,{placeholder:"Enter optional message",value:y,onChange:V=>w(V.target.value),rows:4})]})]})]})]})},{Title:Ut,Paragraph:$t,Text:Ca}=Le,{Content:yb}=Ct,vb=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;return t.includes("logos/")||t.includes("sponsors/")?`${_e.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},bb=we(yb)`
  padding-top: 64px;
`,wb=we.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,jb=we.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Sb=we.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Is=we(ue)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Eb=we(ue)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,xi=we(Ut)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Ns=we.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,Aa=we.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,bh=we.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,Tb=we(Te)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,wh=we(ne)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,pi=we.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;we.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const _b=()=>{const e=Je(),t=it(),[r,s]=_.useState([]),[i,a]=_.useState(!0);_.useEffect(()=>{(async()=>{try{a(!0);const h=await Ar.getExhibitions();s(h.data.slice(0,4))}catch(h){console.error("Failed to fetch exhibitions:",h)}finally{a(!1)}})()},[]);const o=c=>{const h={year:"numeric",month:"short",day:"numeric"};return new Date(c).toLocaleDateString(void 0,h)},l=(c,h)=>{const x=new Date,u=new Date(c),p=new Date(h);return x<u?{status:"Upcoming",color:"#722ED1"}:x>p?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},d=()=>{t(cs(void 0))};return n.jsxs(Ct,{children:[n.jsx(Gr,{}),n.jsxs(bb,{children:[n.jsxs(wb,{children:[n.jsx(jb,{}),n.jsx(Sb,{children:n.jsxs(Ae,{gutter:[48,48],align:"middle",children:[n.jsxs(Q,{xs:24,lg:14,children:[n.jsx(Ut,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),n.jsx($t,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),n.jsx(xe,{size:16,wrap:!0,children:n.jsx(wh,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Jl,{}),children:"Explore Exhibitions"})})]}),n.jsx(Q,{xs:24,lg:10,children:n.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:c=>{const h=c.target;h.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",h.onerror=()=>{h.style.height="300px",h.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",h.onerror=null;const x=h.parentElement;if(x){const u=document.createElement("div");u.style.position="absolute",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)",u.style.color="white",u.style.fontSize="18px",u.style.fontWeight="bold",u.style.textAlign="center",u.textContent="Exhibition Venue",x.appendChild(u)}}}})})]})})]}),n.jsx(pi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"Featured Exhibitions"}),i?n.jsx(Ae,{gutter:[24,24],children:[1,2,3,4].map(c=>n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsx(ue,{style:{borderRadius:"12px"},children:n.jsx(ln,{active:!0,avatar:!0,paragraph:{rows:3}})})},c))}):r.length>0?n.jsx(Ae,{gutter:[24,24],children:r.map((c,h)=>{const{status:x,color:u}=l(c.startDate,c.endDate);return n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsxs(Eb,{onClick:()=>e(qo(c)),cover:n.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[n.jsx("img",{alt:c.name,src:c.headerLogo?vb(c.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0.95)"}}),n.jsx(Te,{color:u,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:x}),h===0&&n.jsx(Tb,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[n.jsx(Ut,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:c.name}),n.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[n.jsx(Vr,{style:{color:"#4158D0"}}),n.jsxs(Ca,{type:"secondary",style:{fontSize:13},children:[o(c.startDate)," - ",o(c.endDate)]})]}),c.venue&&n.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(os,{style:{color:"#C850C0"}}),n.jsx(Ca,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:c.venue})]}),n.jsx(ne,{type:"link",style:{padding:0,height:"auto"},icon:n.jsx(Jl,{}),children:"View Details"})]})},c._id)})}):n.jsx("div",{style:{textAlign:"center",padding:40},children:n.jsx($t,{children:"No exhibitions available at the moment. Check back soon!"})}),n.jsx("div",{style:{textAlign:"center",marginTop:40},children:n.jsx(ne,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Vx,{}),children:"View All Exhibitions"})})]})}),n.jsx(pi,{className:"how-it-works",children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"How to Book Stall"}),n.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:n.jsx($t,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),n.jsxs("div",{className:"booking-steps",children:[n.jsx("div",{className:"step-indicator",children:n.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(c=>n.jsxs("div",{className:"step-dot-container",children:[n.jsx("div",{className:"step-dot",children:c}),n.jsx("div",{className:"step-label",children:`Step ${c}`})]},c)),n.jsx("div",{className:"step-progress-line"})]})}),n.jsxs(Ae,{gutter:[24,24],style:{marginTop:40},children:[n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx(at,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Register"}),n.jsx($t,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Approval"}),n.jsx($t,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx(yr,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Login & Book Stall"}),n.jsx($t,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"4"}),n.jsx("div",{className:"step-icon",children:n.jsx(Yt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Goes to Reserved"}),n.jsx($t,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"5"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Final Approval"}),n.jsx($t,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"6"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Becomes Booked"}),n.jsx($t,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"7"}),n.jsx("div",{className:"step-icon",children:n.jsx(xd,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Make Payment in 3 Days"}),n.jsx($t,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),n.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),n.jsx("div",{style:{textAlign:"center",marginTop:60},children:n.jsx(wh,{type:"primary",size:"large",onClick:d,icon:n.jsx(at,{}),children:"Register as Exhibitor"})})]})}),n.jsx(pi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"Why Choose Us"}),n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:n.jsx(ps,{})}),n.jsx(Ut,{level:4,children:"Interactive Layouts"}),n.jsx($t,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:n.jsx(yr,{})}),n.jsx(Ut,{level:4,children:"Real-time Availability"}),n.jsx($t,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:n.jsx(xd,{})}),n.jsx(Ut,{level:4,children:"Secure Payments"}),n.jsx($t,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:n.jsx(yc,{})}),n.jsx(Ut,{level:4,children:"Exhibitor Dashboard"}),n.jsx($t,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:n.jsx(Vr,{})}),n.jsx(Ut,{level:4,children:"Schedule Management"}),n.jsx($t,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:n.jsx(vt,{})}),n.jsx(Ut,{level:4,children:"Support & Assistance"}),n.jsx($t,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),n.jsx(pi,{className:"gray-bg",children:n.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:n.jsxs(Ae,{gutter:[48,48],children:[n.jsxs(Q,{xs:24,lg:12,children:[n.jsx(xi,{level:2,children:"Our Impact"}),n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),n.jsxs(Q,{xs:24,lg:12,children:[n.jsx(xi,{level:2,children:"What Exhibitors Say"}),n.jsxs(Gx,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[n.jsx("div",{children:n.jsxs(bh,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Mr,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#4158D0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Sarah Johnson"}),n.jsx(Ca,{type:"secondary",children:"Tech Innovations Inc."})]})]}),n.jsx($t,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),n.jsx("div",{children:n.jsxs(bh,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Mr,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#C850C0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Michael Chen"}),n.jsx(Ca,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),n.jsx($t,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),n.jsx(pi,{style:{padding:"60px 0"},children:n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[n.jsx(Ut,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),n.jsx($t,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),n.jsxs(xe,{size:16,wrap:!0,style:{justifyContent:"center"},children:[n.jsx(ne,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>e("/exhibitions"),icon:n.jsx(yr,{}),children:"Browse Exhibitions"}),n.jsx(ne,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:d,icon:n.jsx(at,{}),children:"Register as Exhibitor"})]})]})})]}),n.jsx(mf,{})]})},{Title:kb,Text:Ze,Paragraph:Cb}=Le,{Option:Ia}=Pe,{TextArea:jh,Search:Ab}=fe,{RangePicker:Ib}=xs,Nb=()=>{const e=it(),{exhibitors:t,loading:r}=$e(P=>P.exhibitor),[s,i]=_.useState(null),[a,o]=_.useState(!1),[l,d]=_.useState(!1),[c,h]=_.useState(!1),[x,u]=_.useState("approved"),[p,g]=_.useState(""),[f,m]=_.useState(!1),[v,S]=_.useState(!1),[T,y]=_.useState(!1),[w,k]=_.useState(""),[b,j]=_.useState([]),[A]=H.useForm(),[E,C]=_.useState([]);E.length>0;const[I,F]=_.useState({total:0,pending:0,approved:0,rejected:0});_.useEffect(()=>{e(cn())},[e]),_.useEffect(()=>{if(t!=null&&t.length){j(t);const P={total:t.length,pending:t.filter(Z=>Z.status==="pending").length,approved:t.filter(Z=>Z.status==="approved").length,rejected:t.filter(Z=>Z.status==="rejected").length};F(P)}},[t]),_.useEffect(()=>{s&&l&&A.setFieldsValue({companyName:s.companyName,contactPerson:s.contactPerson,email:s.email,phone:s.phone,address:s.address||"",website:s.website||"",description:s.description||"",isActive:s.isActive})},[s,l,A]);const N=P=>{switch(P){case"approved":return n.jsx(Te,{color:"success",children:"Approved"});case"pending":return n.jsx(Te,{color:"warning",children:"Pending"});case"rejected":return n.jsx(Te,{color:"error",children:"Rejected"});default:return n.jsx(Te,{children:"Unknown"})}},z=async()=>{var P,Z;if(s)try{m(!0),await ar.updateStatus(s._id,x,x==="rejected"?p:void 0),je.success(`Exhibitor status updated to ${x}`),o(!1),e(cn())}catch(se){je.error(((Z=(P=se.response)==null?void 0:P.data)==null?void 0:Z.message)||"Failed to update exhibitor status")}finally{m(!1)}},U=async P=>{var Z,se;if(s)try{S(!0),await ar.updateExhibitor(s._id,P),je.success("Exhibitor details updated successfully"),d(!1),e(cn())}catch(ie){je.error(((se=(Z=ie.response)==null?void 0:Z.data)==null?void 0:se.message)||"Failed to update exhibitor details")}finally{S(!1)}},R=async P=>{var Z,se;try{y(!0),await ar.deleteExhibitor(P),je.success("Exhibitor deleted successfully"),e(cn())}catch(ie){je.error(((se=(Z=ie.response)==null?void 0:Z.data)==null?void 0:se.message)||"Failed to delete exhibitor")}finally{y(!1)}},O=P=>{if(k(P),!P){j(t);return}const Z=P.toLowerCase(),se=t.filter(ie=>ie.companyName.toLowerCase().includes(Z)||ie.contactPerson.toLowerCase().includes(Z)||ie.email.toLowerCase().includes(Z)||ie.phone.toLowerCase().includes(Z));j(se)},X=P=>{if(P==="all"){j(t);return}const Z=t.filter(se=>se.status===P);j(Z)},re=P=>{if(!P||P.length!==2){j(t);return}const Z=P[0].startOf("day").toISOString(),se=P[1].endOf("day").toISOString(),ie=t.filter(de=>{const G=new Date(de.createdAt).toISOString();return G>=Z&&G<=se});j(ie)},ee=()=>{const P=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],Z=b.map(V=>[V.companyName,V.contactPerson,V.email,V.phone,V.status,V.isActive?"Yes":"No",new Date(V.createdAt).toLocaleDateString(),V.address||"",V.website||""]);Z.unshift(P);const se=Z.map(V=>V.map(ae=>typeof ae=="string"&&(ae.includes(",")||ae.includes('"')||ae.includes(`
`))?`"${ae.replace(/"/g,'""')}"`:ae).join(",")).join(`
`),ie=new Blob([se],{type:"text/csv;charset=utf-8;"}),de=URL.createObjectURL(ie),G=document.createElement("a");G.setAttribute("href",de),G.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),G.style.visibility="hidden",document.body.appendChild(G),G.click(),document.body.removeChild(G),je.success("Exhibitor data exported successfully")},D=()=>{Ve.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${E.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{y(!0);const P=E.map(Z=>ar.deleteExhibitor(Z.toString()));await Promise.all(P),je.success(`${E.length} exhibitors deleted successfully`),C([]),e(cn())}catch{je.error("Failed to delete some exhibitors")}finally{y(!1)}}})},q={selectedRowKeys:E,onChange:P=>{C(P)}},B=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(P,Z)=>P.companyName.localeCompare(Z.companyName),filterDropdown:({setSelectedKeys:P,selectedKeys:Z,confirm:se,clearFilters:ie})=>n.jsxs("div",{style:{padding:8},children:[n.jsx(fe,{placeholder:"Search company or contact",value:Z[0],onChange:de=>P(de.target.value?[de.target.value]:[]),onPressEnter:()=>se(),style:{width:188,marginBottom:8,display:"block"}}),n.jsxs(xe,{children:[n.jsx(ne,{type:"primary",onClick:()=>se(),icon:n.jsx(An,{}),size:"small",style:{width:90},children:"Filter"}),n.jsx(ne,{onClick:()=>{ie&&ie(),se()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:P=>n.jsx(An,{style:{color:P?"#1890ff":void 0}}),onFilter:(P,Z)=>{const se=String(P).toLowerCase();return Z.companyName.toLowerCase().includes(se)||Z.contactPerson.toLowerCase().includes(se)},render:(P,Z)=>n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:"bold"},children:P}),n.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",Z.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(P,Z)=>n.jsxs("div",{children:[n.jsx("div",{children:P}),n.jsx("div",{style:{fontSize:"12px"},children:Z.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(P,Z)=>Z.status===P,render:P=>N(P)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(P,Z)=>Z.isActive===P,render:P=>n.jsx(Te,{color:P?"green":"red",children:P?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(P,Z)=>new Date(P.createdAt).getTime()-new Date(Z.createdAt).getTime(),render:P=>n.jsx(ct,{title:new Date(P).toLocaleString(),children:new Date(P).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:P=>P?n.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",children:P.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(P,Z)=>n.jsxs(xe,{children:[n.jsx(ct,{title:"View Details",children:n.jsx(ne,{icon:n.jsx(hn,{}),onClick:()=>{i(Z),h(!0)}})}),n.jsx(ne,{type:"primary",onClick:()=>{i(Z),u(Z.status),g(Z.rejectionReason||""),o(!0)},children:"Update Status"}),n.jsx(Vn,{overlay:n.jsxs(lr,{children:[n.jsx(lr.Item,{icon:n.jsx(as,{}),onClick:()=>{i(Z),d(!0)},children:"Edit"},"edit"),n.jsx(lr.Item,{icon:n.jsx(or,{}),danger:!0,onClick:se=>{se.domEvent.stopPropagation(),Ve.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>R(Z._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(ne,{icon:n.jsx(jc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ae,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(xe,{direction:"vertical",size:4,children:[n.jsx(kb,{level:4,style:{margin:0},children:"Exhibitors"}),n.jsx(Ze,{type:"secondary",children:"Manage exhibitors and their information"})]})}),n.jsx(Q,{children:n.jsx(ne,{type:"primary",icon:n.jsx(Ni,{}),onClick:()=>d(!0),size:"large",children:"Add Exhibitor"})})]})}),n.jsxs(Ae,{gutter:[16,24],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Total Exhibitors",value:I.total,prefix:n.jsx(at,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Pending",value:I.pending,prefix:n.jsx(Yt,{style:{color:"#faad14"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Approved",value:I.approved,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(ue,{children:n.jsx(Xe,{title:"Rejected",value:I.rejected,prefix:n.jsx(Qr,{style:{color:"#ff4d4f"}})})})})]}),n.jsx(ue,{className:"info-card",style:{marginBottom:"24px"},children:n.jsxs(xe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ae,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{xs:24,sm:8,md:6,lg:4,children:n.jsx(Ab,{placeholder:"Search exhibitors",allowClear:!0,onSearch:O,style:{width:"100%"}})}),n.jsx(Q,{xs:24,sm:8,md:6,lg:4,children:n.jsxs(Pe,{placeholder:"Filter by status",style:{width:"100%"},onChange:X,allowClear:!0,children:[n.jsx(Ia,{value:"all",children:"All Status"}),n.jsx(Ia,{value:"pending",children:"Pending"}),n.jsx(Ia,{value:"approved",children:"Approved"}),n.jsx(Ia,{value:"rejected",children:"Rejected"})]})}),n.jsx(Q,{xs:24,sm:8,md:6,lg:6,children:n.jsx(Ib,{style:{width:"100%"},onChange:re})})]}),E.length>0&&n.jsx(Ae,{children:n.jsxs(xe,{children:[n.jsxs(Ze,{children:["Selected ",E.length," items"]}),n.jsx(ne,{danger:!0,onClick:D,children:"Delete Selected"}),n.jsx(ne,{type:"primary",onClick:ee,children:"Export Selected"})]})})]})}),n.jsx(ue,{className:"info-card",children:n.jsx(tt,{rowSelection:q,dataSource:b,columns:B,rowKey:"_id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(P,Z)=>`${Z[0]}-${Z[1]} of ${P} items`},scroll:{x:1500}})}),n.jsx(Ve,{title:"Exhibitor Details",open:c,onCancel:()=>h(!1),footer:[n.jsx(ne,{onClick:()=>h(!1),children:"Close"},"close")],width:600,children:s&&n.jsx("div",{children:n.jsxs(Ae,{gutter:[16,16],children:[n.jsx(Q,{span:24,children:n.jsx(ue,{title:"Company Information",children:n.jsxs(Ae,{gutter:[16,8],children:[n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Company Name:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.companyName})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Contact Person:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.contactPerson})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Email:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.email})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Phone:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.phone})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Status:"})}),n.jsx(Q,{span:12,children:N(s.status)}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Active:"})}),n.jsx(Q,{span:12,children:n.jsx(xr,{status:s.isActive?"success":"error",text:s.isActive?"Yes":"No"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Registration Date:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:new Date(s.createdAt).toLocaleString()})})]})})}),n.jsx(Q,{span:24,children:n.jsxs(ue,{title:"Additional Information",children:[n.jsxs(Ae,{gutter:[16,8],children:[n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Website:"})}),n.jsx(Q,{span:12,children:s.website?n.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",children:s.website}):"Not provided"}),s.status==="rejected"&&n.jsxs(n.Fragment,{children:[n.jsx(Q,{span:12,children:n.jsx(Ze,{strong:!0,children:"Rejection Reason:"})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{type:"danger",children:s.rejectionReason||"No reason provided"})})]})]}),s.description&&n.jsxs(n.Fragment,{children:[n.jsx(nt,{}),n.jsx(Ze,{strong:!0,children:"Description:"}),n.jsx(Cb,{style:{marginTop:8},children:s.description})]})]})})]})})}),n.jsx(Ve,{title:"Update Exhibitor Status",open:a,onCancel:()=>o(!1),footer:null,width:600,children:s&&n.jsxs("div",{children:[n.jsx(ue,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(at,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:n.jsxs(Ae,{gutter:[16,8],children:[n.jsx(Q,{span:8,children:n.jsx(Ze,{strong:!0,children:"Company:"})}),n.jsx(Q,{span:16,children:n.jsx(Ze,{children:s.companyName})}),n.jsx(Q,{span:8,children:n.jsx(Ze,{strong:!0,children:"Contact Person:"})}),n.jsx(Q,{span:16,children:n.jsx(Ze,{children:s.contactPerson})}),n.jsx(Q,{span:8,children:n.jsx(Ze,{strong:!0,children:"Email:"})}),n.jsx(Q,{span:16,children:n.jsx(Ze,{children:s.email})}),n.jsx(Q,{span:8,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:16,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(Q,{span:8,children:n.jsx(Ze,{strong:!0,children:"Current Status:"})}),n.jsx(Q,{span:16,children:N(s.status)})]})}),n.jsxs(ue,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Qs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Ze,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(mr.Group,{value:x,onChange:P=>u(P.target.value),buttonStyle:"solid",children:[n.jsx(mr.Button,{value:"pending",children:n.jsxs(xe,{children:[n.jsx(Yt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(mr.Button,{value:"approved",children:n.jsxs(xe,{children:[n.jsx(vt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(mr.Button,{value:"rejected",children:n.jsxs(xe,{children:[n.jsx(Qr,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),x==="rejected"&&n.jsx("div",{children:n.jsx(H.Item,{label:n.jsx(Ze,{strong:!0,children:"Rejection Reason:"}),required:x==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:n.jsx(jh,{rows:4,value:p,onChange:P=>g(P.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),x==="approved"&&n.jsx(kt,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),x==="pending"&&n.jsx(kt,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(ne,{onClick:()=>o(!1),children:"Cancel"}),n.jsx(ne,{type:"primary",onClick:z,loading:f,disabled:x==="rejected"&&!p.trim(),children:"Update Status"})]})]})]})}),n.jsx(Ve,{title:"Edit Exhibitor Details",open:l,onCancel:()=>d(!1),footer:null,width:600,children:n.jsxs(H,{form:A,layout:"vertical",onFinish:U,children:[n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"address",label:"Address",children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"website",label:"Website",children:n.jsx(fe,{})}),n.jsx(H.Item,{name:"description",label:"Description",children:n.jsx(jh,{rows:4})}),n.jsx(H.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(H.Item,{children:n.jsxs(xe,{children:[n.jsx(ne,{type:"primary",htmlType:"submit",loading:v,children:"Save Changes"}),n.jsx(ne,{onClick:()=>d(!1),children:"Cancel"})]})})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vo={};vo.version="0.18.5";var vf=1252,Fb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bf=function(e){Fb.indexOf(e)!=-1&&(vf=e)};function Rb(){bf(1252)}var $i=function(e){bf(e)};function Pb(){$i(1200),Rb()}var Na=function(t){return String.fromCharCode(t)},Sh=function(t){return String.fromCharCode(t)},Eh,$n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ui(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,i=e.charCodeAt(c++),l=(s&15)<<2|i>>6,d=i&63,isNaN(s)?l=d=64:isNaN(i)&&(d=64),t+=$n.charAt(a)+$n.charAt(o)+$n.charAt(l)+$n.charAt(d);return t}function In(e){var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=$n.indexOf(e.charAt(c++)),o=$n.indexOf(e.charAt(c++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=$n.indexOf(e.charAt(c++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),d=$n.indexOf(e.charAt(c++)),i=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Rn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ds(e){return st?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Th(e){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return st?Rn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wo(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Ji(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Db(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Zt=st?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Rn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Lb(e){for(var t=[],r=0,s=e.length+250,i=ds(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>s&&(t.push(i.slice(0,r)),r=0,i=ds(65535),s=65530)}return t.push(i.slice(0,r)),Zt(t)}var Ti=/\u0000/g,Fa=/[\u0001-\u0006]/g;function Ws(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yr(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}function Mc(e,t){var r=""+e;return r.length>=t?r:Nt(" ",t-r.length)+r}function bo(e,t){var r=""+e;return r.length>=t?r:r+Nt(" ",t-r.length)}function Ob(e,t){var r=""+Math.round(e);return r.length>=t?r:Nt("0",t-r.length)+r}function Bb(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}var _h=Math.pow(2,32);function Fs(e,t){if(e>_h||e<-_h)return Ob(e,t);var r=Math.round(e);return Bb(r,t)}function wo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var kh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ml=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Mb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ch={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$b={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jo(e,t,r){for(var s=e<0?-1:1,i=e*s,a=0,o=1,l=0,d=1,c=0,h=0,x=Math.floor(i);c<t&&(x=Math.floor(i),l=x*o+a,h=x*c+d,!(i-x<5e-8));)i=1/(i-x),a=o,o=l,d=c,c=h;if(h>t&&(c>t?(h=d,l=a):(h=c,l=o)),!r)return[0,s*l,h];var u=Math.floor(s*l/h);return[u,s*l-u*h,h]}function Ra(e,t,r){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),a=0,o=[],l={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],a=d.getDay(),s<60&&(a=(a+6)%7),r&&(a=Gb(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var wf=new Date(1899,11,31,0,0,0),Ub=wf.getTime(),zb=new Date(1900,2,1,0,0,0);function jf(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=zb&&(r+=24*60*60*1e3),(r-(Ub+(e.getTimezoneOffset()-wf.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $c(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Wb(e){var t=e<0?12:11,r=$c(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Hb(e){var t=$c(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Vb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Wb(e):t===10?r=e.toFixed(10).substr(0,12):r=Hb(e),$c(qb(r.toUpperCase()))}function uc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qn(14,jf(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Gb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Yb(e,t,r,s){var i="",a=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return Ml[r.m-1][1];case 5:return Ml[r.m-1][0];default:return Ml[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return kh[r.q][0];default:return kh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yr(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=Yr(a,2+s),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var h=c>0?Yr(d,c):"";return h}function Un(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Sf=/%/g;function Kb(e,t,r){var s=t.replace(Sf,""),i=t.length-s.length;return Tn(e,s,r*Math.pow(10,2*i))+Nt("%",i)}function Xb(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Ef(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ef(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Tf=/# (\?+)( ?)\/( ?)(\d+)/;function Qb(e,t,r){var s=parseInt(e[4],10),i=Math.round(t*s),a=Math.floor(i/s),o=i-a*s,l=s;return r+(a===0?"":""+a)+" "+(o===0?Nt(" ",e[1].length+1+e[4].length):Mc(o,e[1].length)+e[2]+"/"+e[3]+Yr(l,e[4].length))}function Jb(e,t,r){return r+(t===0?"":""+t)+Nt(" ",e[1].length+2+e[4].length)}var _f=/^#*0*\.([0#]+)/,kf=/\).*[0#]/,Cf=/\(###\) ###\\?-####/;function hr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ah(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ih(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function Zb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ew(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Pr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kf)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pr("n",s,r):"("+Pr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Xb(e,t,r);if(t.indexOf("%")!==-1)return Kb(e,t,r);if(t.indexOf("E")!==-1)return Ef(t,r);if(t.charCodeAt(0)===36)return"$"+Pr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Fs(d,t.length);if(t.match(/^[#?]+$/))return i=Fs(r,0),i==="0"&&(i=""),i.length>t.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(Tf))return Qb(a,d,c);if(t.match(/^#+0+$/))return c+Fs(d,t.length-t.indexOf("0"));if(a=t.match(_f))return i=Ah(r,a[1].length).replace(/^([^\.]+)$/,"$1."+hr(a[1])).replace(/\.$/,"."+hr(a[1])).replace(/\.(\d*)$/,function(g,f){return"."+f+Nt("0",hr(a[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Ah(d,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(Fs(d,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pr(e,t,-r):Un(""+(Math.floor(r)+Zb(r,a[1].length)))+"."+Yr(Ih(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Pr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ws(Pr(e,t.replace(/[\\-]/g,""),r)),o=0,Ws(Ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Cf))return i=Pr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=jo(d,Math.pow(10,o)-1,!1),i=""+c,h=Tn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=bo(l[2],o),h.length<a[4].length&&(h=hr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=jo(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Mc(l[1],o)+a[2]+"/"+a[3]+bo(l[2],o):Nt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Fs(r,0),t.length<=i.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,u=t.length-i.length-x;return hr(t.substr(0,x)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Ih(r,a[1].length),r<0?"-"+Pr(e,t,-r):Un(ew(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Yr(0,3-g.length):"")+g})+"."+Yr(o,a[1].length);switch(t){case"###,##0.00":return Pr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Un(Fs(d,0));return p!=="0"?c+p:"";case"###,###.00":return Pr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Pr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tw(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function rw(e,t,r){var s=t.replace(Sf,""),i=t.length-s.length;return Tn(e,s,r*Math.pow(10,2*i))+Nt("%",i)}function Af(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Af(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kf)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",s,r):"("+nn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tw(e,t,r);if(t.indexOf("%")!==-1)return rw(e,t,r);if(t.indexOf("E")!==-1)return Af(t,r);if(t.charCodeAt(0)===36)return"$"+nn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Yr(d,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(Tf))return Jb(a,d,c);if(t.match(/^#+0+$/))return c+Yr(d,t.length-t.indexOf("0"));if(a=t.match(_f))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hr(a[1])).replace(/\.$/,"."+hr(a[1])),i=i.replace(/\.(\d*)$/,function(g,f){return"."+f+Nt("0",hr(a[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(""+d);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):Un(""+r)+"."+Nt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ws(nn(e,t.replace(/[\\-]/g,""),r)),o=0,Ws(Ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Cf))return i=nn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=jo(d,Math.pow(10,o)-1,!1),i=""+c,h=Tn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=bo(l[2],o),h.length<a[4].length&&(h=hr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=jo(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Mc(l[1],o)+a[2]+"/"+a[3]+bo(l[2],o):Nt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,u=t.length-i.length-x;return hr(t.substr(0,x)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):Un(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Yr(0,3-g.length):"")+g})+"."+Yr(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Un(""+d);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return nn(e,t.slice(0,t.lastIndexOf(".")),r)+hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Tn(e,t,r){return(r|0)===r?nn(e,t,r):Pr(e,t,r)}function nw(e){for(var t=[],r=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(i,s-i),i=s+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var If=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Nf(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":wo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(If))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function sw(e,t,r,s){for(var i=[],a="",o=0,l="",d="t",c,h,x,u="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!wo(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(x=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(x);i[i.length]={t:"t",v:a},++o;break;case"\\":var p=e.charAt(++o),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Ra(t,r,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ra(t,r),c==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),i[i.length]={t:l,v:a},d=l;break;case"A":case"a":case"":var f={t:l,v:l};if(c==null&&(c=Ra(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(f.v=c.H>=12?"P":"A"),f.t="T",u="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(f.v=c.H>=12?"PM":"AM"),f.t="T",o+=5,u="h"):e.substr(o,5).toUpperCase()==="/"?(c!=null&&(f.v=c.H>=12?"":""),f.t="T",o+=5,u="h"):(f.t="t",++o),c==null&&f.t==="T")return"";i[i.length]=f,d=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(If)){if(c==null&&(c=Ra(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},d=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Nf(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var m=0,v=0,S;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=u,d="h",m<1&&(m=1);break;case"s":(S=i[o].v.match(/\.0+$/))&&(v=Math.max(v,S[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[o].v.match(/[Hh]/)&&(m=1),m<2&&i[o].v.match(/[Mm]/)&&(m=2),m<3&&i[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",y;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Yb(i[o].t.charCodeAt(0),i[o].v,c,v),i[o].t="t";break;case"n":case"?":for(y=o+1;i[y]!=null&&((l=i[y].t)==="?"||l==="D"||(l===" "||l==="t")&&i[y+1]!=null&&(i[y+1].t==="?"||i[y+1].t==="t"&&i[y+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[y].v==="/"||i[y].v===" "&&i[y+1]!=null&&i[y+1].t=="?"));)i[o].v+=i[y].v,i[y]={v:"",t:";"},++y;T+=i[o].v,o=y-1;break;case"G":i[o].t="t",i[o].v=uc(t,r);break}var w="",k,b;if(T.length>0){T.charCodeAt(0)==40?(k=t<0&&T.charCodeAt(0)===45?-t:t,b=Tn("n",T,k)):(k=t<0&&s>1?-t:t,b=Tn("n",T,k),k<0&&i[0]&&i[0].t=="t"&&(b=b.substr(1),i[0].v="-"+i[0].v)),y=b.length-1;var j=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){j=o;break}var A=i.length;if(j===i.length&&b.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(y>=i[o].v.length-1?(y-=i[o].v.length,i[o].v=b.substr(y+1,i[o].v.length)):y<0?i[o].v="":(i[o].v=b.substr(0,y+1),y=-1),i[o].t="t",A=o);y>=0&&A<i.length&&(i[A].v=b.substr(0,y+1)+i[A].v)}else if(j!==i.length&&b.indexOf("E")===-1){for(y=b.indexOf(".")-1,o=j;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")-1:i[o].v.length-1,w=i[o].v.substr(h+1);h>=0;--h)y>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(w=b.charAt(y--)+w);i[o].v=w,i[o].t="t",A=o}for(y>=0&&A<i.length&&(i[A].v=b.substr(0,y+1)+i[A].v),y=b.indexOf(".")+1,o=j;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==j)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")+1:0,w=i[o].v.substr(0,h);h<i[o].v.length;++h)y<b.length&&(w+=b.charAt(y++));i[o].v=w,i[o].t="t",A=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(k=s>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Tn(i[o].t,i[o].v,k),i[o].t="t");var E="";for(o=0;o!==i.length;++o)i[o]!=null&&(E+=i[o].v);return E}var Nh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function iw(e,t){var r=nw(e),s=r.length,i=r[s-1].indexOf("@");if(s<4&&i>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Nh),l=r[1].match(Nh);return Fh(t,o)?[s,r[0]]:Fh(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,a]}function qn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Ft)[e],s==null&&(s=r.table&&r.table[Ch[e]]||Ft[Ch[e]]),s==null&&(s=$b[e]||"General");break}if(wo(s,0))return uc(t,r);t instanceof Date&&(t=jf(t,r.date1904));var i=iw(s,t);if(wo(i[1]))return uc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return sw(i[1],t,r,i[0])}function Ff(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ft[r]==null){t<0&&(t=r);continue}if(Ft[r]==e){t=r;break}}t<0&&(t=391)}return Ft[t]=e,t}function Ho(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ff(e[t],t)}function Vo(){Ft=Mb()}var Rf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aw(e){var t=typeof e=="number"?Ft[e]:e;return t=t.replace(Rf,"(\\d+)"),new RegExp("^"+t+"$")}function ow(e,t,r){var s=-1,i=-1,a=-1,o=-1,l=-1,d=-1;(t.match(Rf)||[]).forEach(function(x,u){var p=parseInt(r[u+1],10);switch(x.toLowerCase().charAt(0)){case"y":s=p;break;case"d":a=p;break;case"h":o=p;break;case"s":d=p;break;case"m":o>=0?l=p:i=p;break}}),d>=0&&l==-1&&i>=0&&(l=i,i=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:s==-1&&i==-1&&a==-1?h:c+"T"+h}var lw=function(){var e={};e.version="1.2.0";function t(){for(var b=0,j=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,j[A]=b;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function s(b){var j=0,A=0,E=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)C[E]=b[E];for(E=0;E!=256;++E)for(A=b[E],j=256+E;j<4096;j+=256)A=C[j]=A>>>8^b[A&255];var I=[];for(E=1;E!=16;++E)I[E-1]=typeof Int32Array<"u"?C.subarray(E*256,E*256+256):C.slice(E*256,E*256+256);return I}var i=s(r),a=i[0],o=i[1],l=i[2],d=i[3],c=i[4],h=i[5],x=i[6],u=i[7],p=i[8],g=i[9],f=i[10],m=i[11],v=i[12],S=i[13],T=i[14];function y(b,j){for(var A=j^-1,E=0,C=b.length;E<C;)A=A>>>8^r[(A^b.charCodeAt(E++))&255];return~A}function w(b,j){for(var A=j^-1,E=b.length-15,C=0;C<E;)A=T[b[C++]^A&255]^S[b[C++]^A>>8&255]^v[b[C++]^A>>16&255]^m[b[C++]^A>>>24]^f[b[C++]]^g[b[C++]]^p[b[C++]]^u[b[C++]]^x[b[C++]]^h[b[C++]]^c[b[C++]]^d[b[C++]]^l[b[C++]]^o[b[C++]]^a[b[C++]]^r[b[C++]];for(E+=15;C<E;)A=A>>>8^r[(A^b[C++])&255];return~A}function k(b,j){for(var A=j^-1,E=0,C=b.length,I=0,F=0;E<C;)I=b.charCodeAt(E++),I<128?A=A>>>8^r[(A^I)&255]:I<2048?(A=A>>>8^r[(A^(192|I>>6&31))&255],A=A>>>8^r[(A^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,F=b.charCodeAt(E++)&1023,A=A>>>8^r[(A^(240|I>>8&7))&255],A=A>>>8^r[(A^(128|I>>2&63))&255],A=A>>>8^r[(A^(128|F>>6&15|(I&3)<<4))&255],A=A>>>8^r[(A^(128|F&63))&255]):(A=A>>>8^r[(A^(224|I>>12&15))&255],A=A>>>8^r[(A^(128|I>>6&63))&255],A=A>>>8^r[(A^(128|I&63))&255]);return~A}return e.table=r,e.bstr=y,e.buf=w,e.str=k,e}(),ft=function(){var t={};t.version="1.2.1";function r(L,Y){for(var M=L.split("/"),W=Y.split("/"),K=0,J=0,le=Math.min(M.length,W.length);K<le;++K){if(J=M[K].length-W[K].length)return J;if(M[K]!=W[K])return M[K]<W[K]?-1:1}return M.length-W.length}function s(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:s(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(0,Y+1)}function i(L){if(L.charAt(L.length-1)=="/")return i(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(Y+1)}function a(L,Y){typeof Y=="string"&&(Y=new Date(Y));var M=Y.getHours();M=M<<6|Y.getMinutes(),M=M<<5|Y.getSeconds()>>>1,L.write_shift(2,M);var W=Y.getFullYear()-1980;W=W<<4|Y.getMonth()+1,W=W<<5|Y.getDate(),L.write_shift(2,W)}function o(L){var Y=L.read_shift(2)&65535,M=L.read_shift(2)&65535,W=new Date,K=M&31;M>>>=5;var J=M&15;M>>>=4,W.setMilliseconds(0),W.setFullYear(M+1980),W.setMonth(J-1),W.setDate(K);var le=Y&31;Y>>>=5;var me=Y&63;return Y>>>=6,W.setHours(Y),W.setMinutes(me),W.setSeconds(le<<1),W}function l(L){Er(L,0);for(var Y={},M=0;L.l<=L.length-4;){var W=L.read_shift(2),K=L.read_shift(2),J=L.l+K,le={};switch(W){case 21589:M=L.read_shift(1),M&1&&(le.mtime=L.read_shift(4)),K>5&&(M&2&&(le.atime=L.read_shift(4)),M&4&&(le.ctime=L.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}L.l=J,Y[W]=le}return Y}var d;function c(){return d||(d={})}function h(L,Y){if(L[0]==80&&L[1]==75)return ld(L,Y);if((L[0]|32)==109&&(L[1]|32)==105)return ox(L,Y);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var M=3,W=512,K=0,J=0,le=0,me=0,oe=0,ce=[],he=L.slice(0,512);Er(he,0);var Se=x(he);switch(M=Se[0],M){case 3:W=512;break;case 4:W=4096;break;case 0:if(Se[1]==0)return ld(L,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}W!==512&&(he=L.slice(0,W),Er(he,28));var Ne=L.slice(0,W);u(he,M);var De=he.read_shift(4,"i");if(M===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);he.l+=4,le=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),me=he.read_shift(4,"i"),K=he.read_shift(4,"i"),oe=he.read_shift(4,"i"),J=he.read_shift(4,"i");for(var Ee=-1,Re=0;Re<109&&(Ee=he.read_shift(4,"i"),!(Ee<0));++Re)ce[Re]=Ee;var qe=p(L,W);m(oe,J,qe,W,ce);var jt=S(qe,le,ce,W);jt[le].name="!Directory",K>0&&me!==F&&(jt[me].name="!MiniFAT"),jt[ce[0]].name="!FAT",jt.fat_addrs=ce,jt.ssz=W;var St={},nr=[],si=[],ii=[];T(le,jt,qe,nr,K,St,si,me),g(si,ii,nr),nr.shift();var ai={FileIndex:si,FullPaths:ii};return Y&&Y.raw&&(ai.raw={header:Ne,sectors:qe}),ai}function x(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(N,"Header Signature: "),L.l+=16;var Y=L.read_shift(2,"u");return[L.read_shift(2,"u"),Y]}function u(L,Y){var M=9;switch(L.l+=2,M=L.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function p(L,Y){for(var M=Math.ceil(L.length/Y)-1,W=[],K=1;K<M;++K)W[K-1]=L.slice(K*Y,(K+1)*Y);return W[M-1]=L.slice(M*Y),W}function g(L,Y,M){for(var W=0,K=0,J=0,le=0,me=0,oe=M.length,ce=[],he=[];W<oe;++W)ce[W]=he[W]=W,Y[W]=M[W];for(;me<he.length;++me)W=he[me],K=L[W].L,J=L[W].R,le=L[W].C,ce[W]===W&&(K!==-1&&ce[K]!==K&&(ce[W]=ce[K]),J!==-1&&ce[J]!==J&&(ce[W]=ce[J])),le!==-1&&(ce[le]=W),K!==-1&&W!=ce[W]&&(ce[K]=ce[W],he.lastIndexOf(K)<me&&he.push(K)),J!==-1&&W!=ce[W]&&(ce[J]=ce[W],he.lastIndexOf(J)<me&&he.push(J));for(W=1;W<oe;++W)ce[W]===W&&(J!==-1&&ce[J]!==J?ce[W]=ce[J]:K!==-1&&ce[K]!==K&&(ce[W]=ce[K]));for(W=1;W<oe;++W)if(L[W].type!==0){if(me=W,me!=ce[me])do me=ce[me],Y[W]=Y[me]+"/"+Y[W];while(me!==0&&ce[me]!==-1&&me!=ce[me]);ce[W]=-1}for(Y[0]+="/",W=1;W<oe;++W)L[W].type!==2&&(Y[W]+="/")}function f(L,Y,M){for(var W=L.start,K=L.size,J=[],le=W;M&&K>0&&le>=0;)J.push(Y.slice(le*I,le*I+I)),K-=I,le=rs(M,le*4);return J.length===0?pe(0):Zt(J).slice(0,L.size)}function m(L,Y,M,W,K){var J=F;if(L===F){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var le=M[L],me=(W>>>2)-1;if(!le)return;for(var oe=0;oe<me&&(J=rs(le,oe*4))!==F;++oe)K.push(J);m(rs(le,W-4),Y-1,M,W,K)}}function v(L,Y,M,W,K){var J=[],le=[];K||(K=[]);var me=W-1,oe=0,ce=0;for(oe=Y;oe>=0;){K[oe]=!0,J[J.length]=oe,le.push(L[oe]);var he=M[Math.floor(oe*4/W)];if(ce=oe*4&me,W<4+ce)throw new Error("FAT boundary crossed: "+oe+" 4 "+W);if(!L[he])break;oe=rs(L[he],ce)}return{nodes:J,data:$h([le])}}function S(L,Y,M,W){var K=L.length,J=[],le=[],me=[],oe=[],ce=W-1,he=0,Se=0,Ne=0,De=0;for(he=0;he<K;++he)if(me=[],Ne=he+Y,Ne>=K&&(Ne-=K),!le[Ne]){oe=[];var Ee=[];for(Se=Ne;Se>=0;){Ee[Se]=!0,le[Se]=!0,me[me.length]=Se,oe.push(L[Se]);var Re=M[Math.floor(Se*4/W)];if(De=Se*4&ce,W<4+De)throw new Error("FAT boundary crossed: "+Se+" 4 "+W);if(!L[Re]||(Se=rs(L[Re],De),Ee[Se]))break}J[Ne]={nodes:me,data:$h([oe])}}return J}function T(L,Y,M,W,K,J,le,me){for(var oe=0,ce=W.length?2:0,he=Y[L].data,Se=0,Ne=0,De;Se<he.length;Se+=128){var Ee=he.slice(Se,Se+128);Er(Ee,64),Ne=Ee.read_shift(2),De=Hc(Ee,0,Ne-ce),W.push(De);var Re={name:De,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},qe=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);qe!==0&&(Re.ct=y(Ee,Ee.l-8));var jt=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);jt!==0&&(Re.mt=y(Ee,Ee.l-8)),Re.start=Ee.read_shift(4,"i"),Re.size=Ee.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=F,Re.name=""),Re.type===5?(oe=Re.start,K>0&&oe!==F&&(Y[oe].name="!StreamData")):Re.size>=4096?(Re.storage="fat",Y[Re.start]===void 0&&(Y[Re.start]=v(M,Re.start,Y.fat_addrs,Y.ssz)),Y[Re.start].name=Re.name,Re.content=Y[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:oe!==F&&Re.start!==F&&Y[oe]&&(Re.content=f(Re,Y[oe].data,(Y[me]||{}).data))),Re.content&&Er(Re.content,0),J[De]=Re,le.push(Re)}}function y(L,Y){return new Date((kr(L,Y+4)/1e7*Math.pow(2,32)+kr(L,Y)/1e7-11644473600)*1e3)}function w(L,Y){return c(),h(d.readFileSync(L),Y)}function k(L,Y){var M=Y&&Y.type;switch(M||st&&Buffer.isBuffer(L)&&(M="buffer"),M||"base64"){case"file":return w(L,Y);case"base64":return h(Hr(In(L)),Y);case"binary":return h(Hr(L),Y)}return h(L,Y)}function b(L,Y){var M=Y||{},W=M.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=W+"/",L.FileIndex[0]={name:W,type:5}),M.CLSID&&(L.FileIndex[0].clsid=M.CLSID),j(L)}function j(L){var Y="Sh33tJ5";if(!ft.find(L,"/"+Y)){var M=pe(4);M[0]=55,M[1]=M[3]=50,M[2]=54,L.FileIndex.push({name:Y,type:2,content:M,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+Y),A(L)}}function A(L,Y){b(L);for(var M=!1,W=!1,K=L.FullPaths.length-1;K>=0;--K){var J=L.FileIndex[K];switch(J.type){case 0:W?M=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(J.R*J.L*J.C)&&(M=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!Y)){var le=new Date(1987,1,19),me=0,oe=Object.create?Object.create(null):{},ce=[];for(K=0;K<L.FullPaths.length;++K)oe[L.FullPaths[K]]=!0,L.FileIndex[K].type!==0&&ce.push([L.FullPaths[K],L.FileIndex[K]]);for(K=0;K<ce.length;++K){var he=s(ce[K][0]);W=oe[he],W||(ce.push([he,{name:i(he).replace("/",""),type:1,clsid:U,ct:le,mt:le,content:null}]),oe[he]=!0)}for(ce.sort(function(De,Ee){return r(De[0],Ee[0])}),L.FullPaths=[],L.FileIndex=[],K=0;K<ce.length;++K)L.FullPaths[K]=ce[K][0],L.FileIndex[K]=ce[K][1];for(K=0;K<ce.length;++K){var Se=L.FileIndex[K],Ne=L.FullPaths[K];if(Se.name=i(Ne).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||U,K===0)Se.C=ce.length>1?1:-1,Se.size=0,Se.type=5;else if(Ne.slice(-1)=="/"){for(me=K+1;me<ce.length&&s(L.FullPaths[me])!=Ne;++me);for(Se.C=me>=ce.length?-1:me,me=K+1;me<ce.length&&s(L.FullPaths[me])!=s(Ne);++me);Se.R=me>=ce.length?-1:me,Se.type=1}else s(L.FullPaths[K+1]||"")==s(Ne)&&(Se.R=K+1),Se.type=2}}}function E(L,Y){var M=Y||{};if(M.fileType=="mad")return lx(L,M);switch(A(L),M.fileType){case"zip":return tx(L,M)}var W=function(De){for(var Ee=0,Re=0,qe=0;qe<De.FileIndex.length;++qe){var jt=De.FileIndex[qe];if(jt.content){var St=jt.content.length;St>0&&(St<4096?Ee+=St+63>>6:Re+=St+511>>9)}}for(var nr=De.FullPaths.length+3>>2,si=Ee+7>>3,ii=Ee+127>>7,ai=si+Re+nr+ii,Xn=ai+127>>7,tl=Xn<=109?0:Math.ceil((Xn-109)/127);ai+Xn+tl+127>>7>Xn;)tl=++Xn<=109?0:Math.ceil((Xn-109)/127);var mn=[1,tl,Xn,ii,nr,Re,Ee,0];return De.FileIndex[0].size=Ee<<6,mn[7]=(De.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(L),K=pe(W[7]<<9),J=0,le=0;{for(J=0;J<8;++J)K.write_shift(1,z[J]);for(J=0;J<8;++J)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),J=0;J<3;++J)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,W[2]),K.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:F),K.write_shift(4,W[3]),K.write_shift(-4,W[1]?W[0]-1:F),K.write_shift(4,W[1]),J=0;J<109;++J)K.write_shift(-4,J<W[2]?W[1]+J:-1)}if(W[1])for(le=0;le<W[1];++le){for(;J<236+le*127;++J)K.write_shift(-4,J<W[2]?W[1]+J:-1);K.write_shift(-4,le===W[1]-1?F:le+1)}var me=function(De){for(le+=De;J<le-1;++J)K.write_shift(-4,J+1);De&&(++J,K.write_shift(-4,F))};for(le=J=0,le+=W[1];J<le;++J)K.write_shift(-4,R.DIFSECT);for(le+=W[2];J<le;++J)K.write_shift(-4,R.FATSECT);me(W[3]),me(W[4]);for(var oe=0,ce=0,he=L.FileIndex[0];oe<L.FileIndex.length;++oe)he=L.FileIndex[oe],he.content&&(ce=he.content.length,!(ce<4096)&&(he.start=le,me(ce+511>>9)));for(me(W[6]+7>>3);K.l&511;)K.write_shift(-4,R.ENDOFCHAIN);for(le=J=0,oe=0;oe<L.FileIndex.length;++oe)he=L.FileIndex[oe],he.content&&(ce=he.content.length,!(!ce||ce>=4096)&&(he.start=le,me(ce+63>>6)));for(;K.l&511;)K.write_shift(-4,R.ENDOFCHAIN);for(J=0;J<W[4]<<2;++J){var Se=L.FullPaths[J];if(!Se||Se.length===0){for(oe=0;oe<17;++oe)K.write_shift(4,0);for(oe=0;oe<3;++oe)K.write_shift(4,-1);for(oe=0;oe<12;++oe)K.write_shift(4,0);continue}he=L.FileIndex[J],J===0&&(he.start=he.size?he.start-1:F);var Ne=J===0&&M.root||he.name;if(ce=2*(Ne.length+1),K.write_shift(64,Ne,"utf16le"),K.write_shift(2,ce),K.write_shift(1,he.type),K.write_shift(1,he.color),K.write_shift(-4,he.L),K.write_shift(-4,he.R),K.write_shift(-4,he.C),he.clsid)K.write_shift(16,he.clsid,"hex");else for(oe=0;oe<4;++oe)K.write_shift(4,0);K.write_shift(4,he.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,he.start),K.write_shift(4,he.size),K.write_shift(4,0)}for(J=1;J<L.FileIndex.length;++J)if(he=L.FileIndex[J],he.size>=4096)if(K.l=he.start+1<<9,st&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+511&-512;else{for(oe=0;oe<he.size;++oe)K.write_shift(1,he.content[oe]);for(;oe&511;++oe)K.write_shift(1,0)}for(J=1;J<L.FileIndex.length;++J)if(he=L.FileIndex[J],he.size>0&&he.size<4096)if(st&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+63&-64;else{for(oe=0;oe<he.size;++oe)K.write_shift(1,he.content[oe]);for(;oe&63;++oe)K.write_shift(1,0)}if(st)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function C(L,Y){var M=L.FullPaths.map(function(oe){return oe.toUpperCase()}),W=M.map(function(oe){var ce=oe.split("/");return ce[ce.length-(oe.slice(-1)=="/"?2:1)]}),K=!1;Y.charCodeAt(0)===47?(K=!0,Y=M[0].slice(0,-1)+Y):K=Y.indexOf("/")!==-1;var J=Y.toUpperCase(),le=K===!0?M.indexOf(J):W.indexOf(J);if(le!==-1)return L.FileIndex[le];var me=!J.match(Fa);for(J=J.replace(Ti,""),me&&(J=J.replace(Fa,"!")),le=0;le<M.length;++le)if((me?M[le].replace(Fa,"!"):M[le]).replace(Ti,"")==J||(me?W[le].replace(Fa,"!"):W[le]).replace(Ti,"")==J)return L.FileIndex[le];return null}var I=64,F=-2,N="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",R={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:N,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function O(L,Y,M){c();var W=E(L,M);d.writeFileSync(Y,W)}function X(L){for(var Y=new Array(L.length),M=0;M<L.length;++M)Y[M]=String.fromCharCode(L[M]);return Y.join("")}function re(L,Y){var M=E(L,Y);switch(Y&&Y.type||"buffer"){case"file":return c(),d.writeFileSync(Y.filename,M),M;case"binary":return typeof M=="string"?M:X(M);case"base64":return Ui(typeof M=="string"?M:X(M));case"buffer":if(st)return Buffer.isBuffer(M)?M:Rn(M);case"array":return typeof M=="string"?Hr(M):M}return M}var ee;function D(L){try{var Y=L.InflateRaw,M=new Y;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)ee=L;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function q(L,Y){if(!ee)return ad(L,Y);var M=ee.InflateRaw,W=new M,K=W._processChunk(L.slice(L.l),W._finishFlushFlag);return L.l+=W.bytesRead,K}function B(L){return ee?ee.deflateRawSync(L):At(L)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(L){var Y=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var de=typeof Uint8Array<"u",G=de?new Uint8Array(256):[],V=0;V<256;++V)G[V]=ie(V);function ae(L,Y){var M=G[L&255];return Y<=8?M>>>8-Y:(M=M<<8|G[L>>8&255],Y<=16?M>>>16-Y:(M=M<<8|G[L>>16&255],M>>>24-Y))}function ge(L,Y){var M=Y&7,W=Y>>>3;return(L[W]|(M<=6?0:L[W+1]<<8))>>>M&3}function te(L,Y){var M=Y&7,W=Y>>>3;return(L[W]|(M<=5?0:L[W+1]<<8))>>>M&7}function be(L,Y){var M=Y&7,W=Y>>>3;return(L[W]|(M<=4?0:L[W+1]<<8))>>>M&15}function Ie(L,Y){var M=Y&7,W=Y>>>3;return(L[W]|(M<=3?0:L[W+1]<<8))>>>M&31}function ye(L,Y){var M=Y&7,W=Y>>>3;return(L[W]|(M<=1?0:L[W+1]<<8))>>>M&127}function Me(L,Y,M){var W=Y&7,K=Y>>>3,J=(1<<M)-1,le=L[K]>>>W;return M<8-W||(le|=L[K+1]<<8-W,M<16-W)||(le|=L[K+2]<<16-W,M<24-W)||(le|=L[K+3]<<24-W),le&J}function Ue(L,Y,M){var W=Y&7,K=Y>>>3;return W<=5?L[K]|=(M&7)<<W:(L[K]|=M<<W&255,L[K+1]=(M&7)>>8-W),Y+3}function wt(L,Y,M){var W=Y&7,K=Y>>>3;return M=(M&1)<<W,L[K]|=M,Y+1}function qt(L,Y,M){var W=Y&7,K=Y>>>3;return M<<=W,L[K]|=M&255,M>>>=8,L[K+1]=M,Y+8}function Wt(L,Y,M){var W=Y&7,K=Y>>>3;return M<<=W,L[K]|=M&255,M>>>=8,L[K+1]=M&255,L[K+2]=M>>>8,Y+16}function Rr(L,Y){var M=L.length,W=2*M>Y?2*M:Y+5,K=0;if(M>=Y)return L;if(st){var J=Th(W);if(L.copy)L.copy(J);else for(;K<L.length;++K)J[K]=L[K];return J}else if(de){var le=new Uint8Array(W);if(le.set)le.set(L);else for(;K<M;++K)le[K]=L[K];return le}return L.length=W,L}function Fe(L){for(var Y=new Array(L),M=0;M<L;++M)Y[M]=0;return Y}function ze(L,Y,M){var W=1,K=0,J=0,le=0,me=0,oe=L.length,ce=de?new Uint16Array(32):Fe(32);for(J=0;J<32;++J)ce[J]=0;for(J=oe;J<M;++J)L[J]=0;oe=L.length;var he=de?new Uint16Array(oe):Fe(oe);for(J=0;J<oe;++J)ce[K=L[J]]++,W<K&&(W=K),he[J]=0;for(ce[0]=0,J=1;J<=W;++J)ce[J+16]=me=me+ce[J-1]<<1;for(J=0;J<oe;++J)me=L[J],me!=0&&(he[J]=ce[me+16]++);var Se=0;for(J=0;J<oe;++J)if(Se=L[J],Se!=0)for(me=ae(he[J],W)>>W-Se,le=(1<<W+4-Se)-1;le>=0;--le)Y[me|le<<Se]=Se&15|J<<4;return W}var Ke=de?new Uint16Array(512):Fe(512),Oe=de?new Uint16Array(32):Fe(32);if(!de){for(var Be=0;Be<512;++Be)Ke[Be]=0;for(Be=0;Be<32;++Be)Oe[Be]=0}(function(){for(var L=[],Y=0;Y<32;Y++)L.push(5);ze(L,Oe,32);var M=[];for(Y=0;Y<=143;Y++)M.push(8);for(;Y<=255;Y++)M.push(9);for(;Y<=279;Y++)M.push(7);for(;Y<=287;Y++)M.push(8);ze(M,Ke,288)})();var ut=function(){for(var Y=de?new Uint8Array(32768):[],M=0,W=0;M<se.length-1;++M)for(;W<se[M+1];++W)Y[W]=M;for(;W<32768;++W)Y[W]=29;var K=de?new Uint8Array(259):[];for(M=0,W=0;M<Z.length-1;++M)for(;W<Z[M+1];++W)K[W]=M;function J(me,oe){for(var ce=0;ce<me.length;){var he=Math.min(65535,me.length-ce),Se=ce+he==me.length;for(oe.write_shift(1,+Se),oe.write_shift(2,he),oe.write_shift(2,~he&65535);he-- >0;)oe[oe.l++]=me[ce++]}return oe.l}function le(me,oe){for(var ce=0,he=0,Se=de?new Uint16Array(32768):[];he<me.length;){var Ne=Math.min(65535,me.length-he);if(Ne<10){for(ce=Ue(oe,ce,+(he+Ne==me.length)),ce&7&&(ce+=8-(ce&7)),oe.l=ce/8|0,oe.write_shift(2,Ne),oe.write_shift(2,~Ne&65535);Ne-- >0;)oe[oe.l++]=me[he++];ce=oe.l*8;continue}ce=Ue(oe,ce,+(he+Ne==me.length)+2);for(var De=0;Ne-- >0;){var Ee=me[he];De=(De<<5^Ee)&32767;var Re=-1,qe=0;if((Re=Se[De])&&(Re|=he&-32768,Re>he&&(Re-=32768),Re<he))for(;me[Re+qe]==me[he+qe]&&qe<250;)++qe;if(qe>2){Ee=K[qe],Ee<=22?ce=qt(oe,ce,G[Ee+1]>>1)-1:(qt(oe,ce,3),ce+=5,qt(oe,ce,G[Ee-23]>>5),ce+=3);var jt=Ee<8?0:Ee-4>>2;jt>0&&(Wt(oe,ce,qe-Z[Ee]),ce+=jt),Ee=Y[he-Re],ce=qt(oe,ce,G[Ee]>>3),ce-=3;var St=Ee<4?0:Ee-2>>1;St>0&&(Wt(oe,ce,he-Re-se[Ee]),ce+=St);for(var nr=0;nr<qe;++nr)Se[De]=he&32767,De=(De<<5^me[he])&32767,++he;Ne-=qe-1}else Ee<=143?Ee=Ee+48:ce=wt(oe,ce,1),ce=qt(oe,ce,G[Ee]),Se[De]=he&32767,++he}ce=qt(oe,ce,0)-1}return oe.l=(ce+7)/8|0,oe.l}return function(oe,ce){return oe.length<8?J(oe,ce):le(oe,ce)}}();function At(L){var Y=pe(50+Math.floor(L.length*1.1)),M=ut(L,Y);return Y.slice(0,M)}var jr=de?new Uint16Array(32768):Fe(32768),Pn=de?new Uint16Array(32768):Fe(32768),sa=de?new Uint16Array(128):Fe(128),ia=1,aa=1;function Jo(L,Y){var M=Ie(L,Y)+257;Y+=5;var W=Ie(L,Y)+1;Y+=5;var K=be(L,Y)+4;Y+=4;for(var J=0,le=de?new Uint8Array(19):Fe(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ce=de?new Uint8Array(8):Fe(8),he=de?new Uint8Array(8):Fe(8),Se=le.length,Ne=0;Ne<K;++Ne)le[P[Ne]]=J=te(L,Y),oe<J&&(oe=J),ce[J]++,Y+=3;var De=0;for(ce[0]=0,Ne=1;Ne<=oe;++Ne)he[Ne]=De=De+ce[Ne-1]<<1;for(Ne=0;Ne<Se;++Ne)(De=le[Ne])!=0&&(me[Ne]=he[De]++);var Ee=0;for(Ne=0;Ne<Se;++Ne)if(Ee=le[Ne],Ee!=0){De=G[me[Ne]]>>8-Ee;for(var Re=(1<<7-Ee)-1;Re>=0;--Re)sa[De|Re<<Ee]=Ee&7|Ne<<3}var qe=[];for(oe=1;qe.length<M+W;)switch(De=sa[ye(L,Y)],Y+=De&7,De>>>=3){case 16:for(J=3+ge(L,Y),Y+=2,De=qe[qe.length-1];J-- >0;)qe.push(De);break;case 17:for(J=3+te(L,Y),Y+=3;J-- >0;)qe.push(0);break;case 18:for(J=11+ye(L,Y),Y+=7;J-- >0;)qe.push(0);break;default:qe.push(De),oe<De&&(oe=De);break}var jt=qe.slice(0,M),St=qe.slice(M);for(Ne=M;Ne<286;++Ne)jt[Ne]=0;for(Ne=W;Ne<30;++Ne)St[Ne]=0;return ia=ze(jt,jr,286),aa=ze(St,Pn,30),Y}function Zo(L,Y){if(L[0]==3&&!(L[1]&3))return[ds(Y),2];for(var M=0,W=0,K=Th(Y||1<<18),J=0,le=K.length>>>0,me=0,oe=0;!(W&1);){if(W=te(L,M),M+=3,W>>>1)W>>1==1?(me=9,oe=5):(M=Jo(L,M),me=ia,oe=aa);else{M&7&&(M+=8-(M&7));var ce=L[M>>>3]|L[(M>>>3)+1]<<8;if(M+=32,ce>0)for(!Y&&le<J+ce&&(K=Rr(K,J+ce),le=K.length);ce-- >0;)K[J++]=L[M>>>3],M+=8;continue}for(;;){!Y&&le<J+32767&&(K=Rr(K,J+32767),le=K.length);var he=Me(L,M,me),Se=W>>>1==1?Ke[he]:jr[he];if(M+=Se&15,Se>>>=4,!(Se>>>8&255))K[J++]=Se;else{if(Se==256)break;Se-=257;var Ne=Se<8?0:Se-4>>2;Ne>5&&(Ne=0);var De=J+Z[Se];Ne>0&&(De+=Me(L,M,Ne),M+=Ne),he=Me(L,M,oe),Se=W>>>1==1?Oe[he]:Pn[he],M+=Se&15,Se>>>=4;var Ee=Se<4?0:Se-2>>1,Re=se[Se];for(Ee>0&&(Re+=Me(L,M,Ee),M+=Ee),!Y&&le<De&&(K=Rr(K,De+100),le=K.length);J<De;)K[J]=K[J-Re],++J}}}return Y?[K,M+7>>>3]:[K.slice(0,J),M+7>>>3]}function ad(L,Y){var M=L.slice(L.l||0),W=Zo(M,Y);return L.l+=W[1],W[0]}function od(L,Y){if(L)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function ld(L,Y){var M=L;Er(M,0);var W=[],K=[],J={FileIndex:W,FullPaths:K};b(J,{root:Y.root});for(var le=M.length-4;(M[le]!=80||M[le+1]!=75||M[le+2]!=5||M[le+3]!=6)&&le>=0;)--le;M.l=le+4,M.l+=4;var me=M.read_shift(2);M.l+=6;var oe=M.read_shift(4);for(M.l=oe,le=0;le<me;++le){M.l+=20;var ce=M.read_shift(4),he=M.read_shift(4),Se=M.read_shift(2),Ne=M.read_shift(2),De=M.read_shift(2);M.l+=8;var Ee=M.read_shift(4),Re=l(M.slice(M.l+Se,M.l+Se+Ne));M.l+=Se+Ne+De;var qe=M.l;M.l=Ee+4,ex(M,ce,he,J,Re),M.l=qe}return J}function ex(L,Y,M,W,K){L.l+=2;var J=L.read_shift(2),le=L.read_shift(2),me=o(L);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var oe=L.read_shift(4),ce=L.read_shift(4),he=L.read_shift(4),Se=L.read_shift(2),Ne=L.read_shift(2),De="",Ee=0;Ee<Se;++Ee)De+=String.fromCharCode(L[L.l++]);if(Ne){var Re=l(L.slice(L.l,L.l+Ne));(Re[21589]||{}).mt&&(me=Re[21589].mt),((K||{})[21589]||{}).mt&&(me=K[21589].mt)}L.l+=Ne;var qe=L.slice(L.l,L.l+ce);switch(le){case 8:qe=q(L,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var jt=!1;J&8&&(oe=L.read_shift(4),oe==134695760&&(oe=L.read_shift(4),jt=!0),ce=L.read_shift(4),he=L.read_shift(4)),ce!=Y&&od(jt,"Bad compressed size: "+Y+" != "+ce),he!=M&&od(jt,"Bad uncompressed size: "+M+" != "+he),el(W,De,qe,{unsafe:!0,mt:me})}function tx(L,Y){var M=Y||{},W=[],K=[],J=pe(1),le=M.compression?8:0,me=0,oe=0,ce=0,he=0,Se=0,Ne=L.FullPaths[0],De=Ne,Ee=L.FileIndex[0],Re=[],qe=0;for(oe=1;oe<L.FullPaths.length;++oe)if(De=L.FullPaths[oe].slice(Ne.length),Ee=L.FileIndex[oe],!(!Ee.size||!Ee.content||De=="Sh33tJ5")){var jt=he,St=pe(De.length);for(ce=0;ce<De.length;++ce)St.write_shift(1,De.charCodeAt(ce)&127);St=St.slice(0,St.l),Re[Se]=lw.buf(Ee.content,0);var nr=Ee.content;le==8&&(nr=B(nr)),J=pe(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,me),J.write_shift(2,le),Ee.mt?a(J,Ee.mt):J.write_shift(4,0),J.write_shift(-4,Re[Se]),J.write_shift(4,nr.length),J.write_shift(4,Ee.content.length),J.write_shift(2,St.length),J.write_shift(2,0),he+=J.length,W.push(J),he+=St.length,W.push(St),he+=nr.length,W.push(nr),J=pe(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,me),J.write_shift(2,le),J.write_shift(4,0),J.write_shift(-4,Re[Se]),J.write_shift(4,nr.length),J.write_shift(4,Ee.content.length),J.write_shift(2,St.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,jt),qe+=J.l,K.push(J),qe+=St.length,K.push(St),++Se}return J=pe(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Se),J.write_shift(2,Se),J.write_shift(4,qe),J.write_shift(4,he),J.write_shift(2,0),Zt([Zt(W),Zt(K),J])}var oa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rx(L,Y){if(L.ctype)return L.ctype;var M=L.name||"",W=M.match(/\.([^\.]+)$/);return W&&oa[W[1]]||Y&&(W=(M=Y).match(/[\.\\]([^\.\\])+$/),W&&oa[W[1]])?oa[W[1]]:"application/octet-stream"}function nx(L){for(var Y=Ui(L),M=[],W=0;W<Y.length;W+=76)M.push(Y.slice(W,W+76));return M.join(`\r
`)+`\r
`}function sx(L){var Y=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var he=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],W=Y.split(`\r
`),K=0;K<W.length;++K){var J=W[K];if(J.length==0){M.push("");continue}for(var le=0;le<J.length;){var me=76,oe=J.slice(le,le+me);oe.charAt(me-1)=="="?me--:oe.charAt(me-2)=="="?me-=2:oe.charAt(me-3)=="="&&(me-=3),oe=J.slice(le,le+me),le+=me,le<J.length&&(oe+="="),M.push(oe)}}return M.join(`\r
`)}function ix(L){for(var Y=[],M=0;M<L.length;++M){for(var W=L[M];M<=L.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+L[++M];Y.push(W)}for(var K=0;K<Y.length;++K)Y[K]=Y[K].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Hr(Y.join(`\r
`))}function ax(L,Y,M){for(var W="",K="",J="",le,me=0;me<10;++me){var oe=Y[me];if(!oe||oe.match(/^\s*$/))break;var ce=oe.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":W=ce[2].trim();break;case"content-type":J=ce[2].trim();break;case"content-transfer-encoding":K=ce[2].trim();break}}switch(++me,K.toLowerCase()){case"base64":le=Hr(In(Y.slice(me).join("")));break;case"quoted-printable":le=ix(Y.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var he=el(L,W.slice(M.length),le,{unsafe:!0});J&&(he.ctype=J)}function ox(L,Y){if(X(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=Y&&Y.root||"",W=(st&&Buffer.isBuffer(L)?L.toString("binary"):X(L)).split(`\r
`),K=0,J="";for(K=0;K<W.length;++K)if(J=W[K],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),M||(M=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),J.slice(0,M.length)!=M););var le=(W[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var me="--"+(le[1]||""),oe=[],ce=[],he={FileIndex:oe,FullPaths:ce};b(he);var Se,Ne=0;for(K=0;K<W.length;++K){var De=W[K];De!==me&&De!==me+"--"||(Ne++&&ax(he,W.slice(Se,K),M),Se=K)}return he}function lx(L,Y){var M=Y||{},W=M.boundary||"SheetJS";W="------="+W;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],J=L.FullPaths[0],le=J,me=L.FileIndex[0],oe=1;oe<L.FullPaths.length;++oe)if(le=L.FullPaths[oe].slice(J.length),me=L.FileIndex[oe],!(!me.size||!me.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ce=me.content,he=st&&Buffer.isBuffer(ce)?ce.toString("binary"):X(ce),Se=0,Ne=Math.min(1024,he.length),De=0,Ee=0;Ee<=Ne;++Ee)(De=he.charCodeAt(Ee))>=32&&De<128&&++Se;var Re=Se>=Ne*4/5;K.push(W),K.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+le),K.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),K.push("Content-Type: "+rx(me,le)),K.push(""),K.push(Re?sx(he):nx(he))}return K.push(W+`--\r
`),K.join(`\r
`)}function cx(L){var Y={};return b(Y,L),Y}function el(L,Y,M,W){var K=W&&W.unsafe;K||b(L);var J=!K&&ft.find(L,Y);if(!J){var le=L.FullPaths[0];Y.slice(0,le.length)==le?le=Y:(le.slice(-1)!="/"&&(le+="/"),le=(le+Y).replace("//","/")),J={name:i(Y),type:2},L.FileIndex.push(J),L.FullPaths.push(le),K||ft.utils.cfb_gc(L)}return J.content=M,J.size=M?M.length:0,W&&(W.CLSID&&(J.clsid=W.CLSID),W.mt&&(J.mt=W.mt),W.ct&&(J.ct=W.ct)),J}function dx(L,Y){b(L);var M=ft.find(L,Y);if(M){for(var W=0;W<L.FileIndex.length;++W)if(L.FileIndex[W]==M)return L.FileIndex.splice(W,1),L.FullPaths.splice(W,1),!0}return!1}function hx(L,Y,M){b(L);var W=ft.find(L,Y);if(W){for(var K=0;K<L.FileIndex.length;++K)if(L.FileIndex[K]==W)return L.FileIndex[K].name=i(M),L.FullPaths[K]=M,!0}return!1}function ux(L){A(L,!0)}return t.find=C,t.read=k,t.parse=h,t.write=re,t.writeFile=O,t.utils={cfb_new:cx,cfb_add:el,cfb_del:dx,cfb_mov:hx,cfb_gc:ux,ReadShift:ki,CheckField:Qf,prep_blob:Er,bconcat:Zt,use_zlib:D,_deflateRaw:At,_inflateRaw:ad,consts:R},t}();function cw(e){return typeof e=="string"?Wo(e):Array.isArray(e)?Db(e):e}function Zi(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?qi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([cw(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Ji(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function rr(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Rh(e,t){for(var r=[],s=rr(e),i=0;i!==s.length;++i)r[e[s[i]][t]]==null&&(r[e[s[i]][t]]=s[i]);return r}function Uc(e){for(var t=[],r=rr(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Go(e){for(var t=[],r=rr(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function dw(e){for(var t=[],r=rr(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var So=new Date(1899,11,30,0,0,0);function br(e,t){var r=e.getTime(),s=So.getTime()+(e.getTimezoneOffset()-So.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var Pf=new Date,hw=So.getTime()+(Pf.getTimezoneOffset()-So.getTimezoneOffset())*6e4,Ph=Pf.getTimezoneOffset();function Df(e){var t=new Date;return t.setTime(e*24*60*60*1e3+hw),t.getTimezoneOffset()!==Ph&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ph)*6e4),t}var Dh=new Date("2017-02-19T19:06:09.000Z"),Lf=isNaN(Dh.getFullYear())?new Date("2/19/17"):Dh,uw=Lf.getFullYear()==2017;function pr(e,t){var r=new Date(e);if(uw)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Lf.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Yo(e,t){if(st&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function wr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=wr(e[r]));return t}function Nt(e,t){for(var r="";r.length<t;)r+=e;return r}function _n(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var fw=["january","february","march","april","may","june","july","august","september","october","november","december"];function zi(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&fw.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(i>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function He(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return st?s=Rn(r):s=Lb(r),ft.utils.cfb_add(e,t,s)}ft.utils.cfb_add(e,t,r)}else e.file(t,r)}function zc(){return ft.utils.cfb_new()}var Bt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qc=Uc(xw),Wc=/[&<>'"]/g,pw=/[\u0000-\u0008\u000b-\u001f]/g;function dt(e){var t=e+"";return t.replace(Wc,function(r){return qc[r]}).replace(pw,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Lh(e){return dt(e).replace(/ /g,"_x0020_")}var Of=/[\u0000-\u001f]/g;function mw(e){var t=e+"";return t.replace(Wc,function(r){return qc[r]}).replace(/\n/g,"<br/>").replace(Of,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gw(e){var t=e+"";return t.replace(Wc,function(r){return qc[r]}).replace(Of,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function yw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vw(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $l(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Oh(e){var t=ds(2*e.length),r,s,i=1,a=0,o=0,l;for(s=0;s<e.length;s+=i)i=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Bh(e){return Rn(e,"binary").toString("utf8")}var Pa="foo bar baz",_i=st&&(Bh(Pa)==$l(Pa)&&Bh||Oh(Pa)==$l(Pa)&&Oh)||$l,qi=st?function(e){return Rn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,i=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},bw=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),Bf=/(^\s|\s$|\n)/;function er(e,t){return"<"+e+(t.match(Bf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Wi(e){return rr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ke(e,t,r){return"<"+e+(r!=null?Wi(r):"")+(t!=null?(t.match(Bf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ww(e,t){switch(typeof e){case"string":var r=ke("vt:lpwstr",dt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ke((e|0)==e?"vt:i4":"vt:r8",dt(String(e)));case"boolean":return ke("vt:bool",e?"true":"false")}if(e instanceof Date)return ke("vt:filetime",fc(e));throw new Error("Unable to serialize "+e)}var Ht={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_r={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jw(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return s==2047?i==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),r*Math.pow(2,s-52)*i)}function Sw(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=s?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|s}var Mh=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,a=e[0][s].length;i<a;i+=r)t.push.apply(t,e[0][s].slice(i,i+r));return t},$h=st?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Rn(t)})):Mh(e)}:Mh,Uh=function(e,t,r){for(var s=[],i=t;i<r;i+=2)s.push(String.fromCharCode(yi(e,i)));return s.join("").replace(Ti,"")},Hc=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ti,""):Uh(e,t,r)}:Uh,zh=function(e,t,r){for(var s=[],i=t;i<t+r;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},Mf=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):zh(e,t,r)}:zh,qh=function(e,t,r){for(var s=[],i=t;i<r;i++)s.push(String.fromCharCode(Bs(e,i)));return s.join("")},ea=st?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):qh(t,r,s)}:qh,$f=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},Uf=$f,zf=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},qf=zf,Wf=function(e,t){var r=2*kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},Hf=Wf,Vf=function(t,r){var s=kr(t,r);return s>0?Hc(t,r+4,r+4+s):""},Gf=Vf,Yf=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r):""},Kf=Yf,Xf=function(e,t){return jw(e,t)},Eo=Xf,Vc=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};st&&(Uf=function(t,r){if(!Buffer.isBuffer(t))return $f(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},qf=function(t,r){if(!Buffer.isBuffer(t))return zf(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Hf=function(t,r){if(!Buffer.isBuffer(t))return Wf(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},Gf=function(t,r){if(!Buffer.isBuffer(t))return Vf(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},Kf=function(t,r){if(!Buffer.isBuffer(t))return Yf(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Eo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Xf(t,r)},Vc=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bs=function(e,t){return e[t]},yi=function(e,t){return e[t+1]*256+e[t]},Ew=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},rs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Tw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ki(e,t){var r="",s,i,a=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,st&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(yi(this,c)),c+=2;e*=2;break;case"utf8":r=ea(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Hc(this,this.l,this.l+e);break;case"wstr":return ki.call(this,e,"dbcs");case"lpstr-ansi":r=Uf(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":r=qf(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":r=Hf(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),r=Gf(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),r=Kf(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Bs(this,this.l+e++))!==0;)a.push(Na(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=yi(this,this.l+e))!==0;)a.push(Na(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Bs(this,c),this.l=c+1,l=ki.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Na(yi(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Bs(this,c),this.l=c+1,l=ki.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Na(Bs(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return s=Bs(this,this.l),this.l++,s;case 2:return s=(t==="i"?Ew:yi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?rs:Tw)(this,this.l),this.l+=4,s):(i=kr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Eo(this,this.l):i=Eo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Mf(this,this.l,e);break}}return this.l+=e,r}var _w=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},kw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Cw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Aw(e,t,r){var s=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Cw(this,t.charCodeAt(i),this.l+2*i);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;s=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,_w(this,t,this.l);break;case 8:if(s=8,r==="f"){Sw(this,t,this.l);break}case 16:break;case-4:s=4,kw(this,t,this.l);break}return this.l+=s,this}function Qf(e,t){var r=Mf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Er(e,t){e.l=t,e.read_shift=ki,e.chk=Qf,e.write_shift=Aw}function pn(e,t){e.l+=t}function pe(e){var t=ds(e);return Er(t,0),t}function vr(){var e=[],t=st?256:2048,r=function(c){var h=pe(c);return Er(h,0),h},s=r(t),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(c){return s&&c<s.length-s.l?s:(i(),s=r(Math.max(c+1,t)))},o=function(){return i(),Zt(e)},l=function(c){i(),s=c,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ve(e,t,r,s){var i=+t,a;if(!isNaN(i)){s||(s=j_[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var o=e.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Vc(r)&&e.push(r)}}function Ci(e,t,r){var s=wr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Wh(e,t,r){var s=wr(e);return s.s=Ci(s.s,t.s,r),s.e=Ci(s.e,t.s,r),s}function Ai(e,t){if(e.cRel&&e.c<0)for(e=wr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=wr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=Fw(r)),!e.rRel&&e.rRel!=null&&(r=Iw(r)),r}function Ul(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+cr(e.s.c)+":"+(e.e.cRel?"":"$")+cr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+tr(e.s.r)+":"+(e.e.rRel?"":"$")+tr(e.e.r):Ai(e.s,t.biff)+":"+Ai(e.e,t.biff)}function Gc(e){return parseInt(Nw(e),10)-1}function tr(e){return""+(e+1)}function Iw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Nw(e){return e.replace(/\$(\d+)$/,"$1")}function Yc(e){for(var t=Rw(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function cr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Fw(e){return e.replace(/^([A-Z])/,"$$$1")}function Rw(e){return e.replace(/^\$([A-Z])/,"$1")}function Pw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vt(e){for(var t=0,r=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Nr(e){var t=e.indexOf(":");return t==-1?{s:Vt(e),e:Vt(e)}:{s:Vt(e.slice(0,t)),e:Vt(e.slice(t+1))}}function Ot(e,t){return typeof t>"u"||typeof t=="number"?Ot(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,i=0,a=e.length;for(r=0;s<a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.s.c=--r,r=0;s<a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;if(t.s.r=--r,s===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.e.c=--r,r=0;s!=a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;return t.e.r=--r,t}function Hh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qn(e.z,r?br(t):t)}catch{}try{return e.w=qn((e.XF||{}).numFmtId||(r?14:0),r?br(t):t)}catch{return""+t}}function Nn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ta[e.v]||e.v:t==null?Hh(e,e.v):Hh(e,t))}function gs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function Jf(e,t,r){var s=r||{},i=e?Array.isArray(e):s.dense,a=e||(i?[]:{}),o=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Vt(s.origin):s.origin;o=d.r,l=d.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=bt(a["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),o==-1&&(c.e.r=o=h.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[x].length;++u)if(!(typeof t[x][u]>"u")){var p={v:t[x][u]},g=o+x,f=l+u;if(c.s.r>g&&(c.s.r=g),c.s.c>f&&(c.s.c=f),c.e.r<g&&(c.e.r=g),c.e.c<f&&(c.e.c=f),t[x][u]&&typeof t[x][u]=="object"&&!Array.isArray(t[x][u])&&!(t[x][u]instanceof Date))p=t[x][u];else if(Array.isArray(p.v)&&(p.f=t[x][u][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(s.nullError)p.t="e",p.v=0;else if(s.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=s.dateNF||Ft[14],s.cellDates?(p.t="d",p.w=qn(p.z,br(p.v))):(p.t="n",p.v=br(p.v),p.w=qn(p.z,p.v))):p.t="s";if(i)a[g]||(a[g]=[]),a[g][f]&&a[g][f].z&&(p.z=a[g][f].z),a[g][f]=p;else{var m=ht({c:f,r:g});a[m]&&a[m].z&&(p.z=a[m].z),a[m]=p}}}return c.s.c<1e7&&(a["!ref"]=Ot(c)),a}function ti(e,t){return Jf(null,e,t)}function Dw(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=pe(4)),t.write_shift(4,e),t}function dr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Gt(e,t){var r=!1;return t==null&&(r=!0,t=pe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Lw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ow(e,t){return t||(t=pe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Kc(e,t){var r=e.l,s=e.read_shift(1),i=dr(e),a=[],o={t:i,h:i};if(s&1){for(var l=e.read_shift(4),d=0;d!=l;++d)a.push(Lw(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Bw(e,t){var r=!1;return t==null&&(r=!0,t=pe(15+4*e.t.length)),t.write_shift(1,0),Gt(e.t,t),r?t.slice(0,t.l):t}var Mw=Kc;function $w(e,t){var r=!1;return t==null&&(r=!0,t=pe(23+4*e.t.length)),t.write_shift(1,1),Gt(e.t,t),t.write_shift(4,1),Ow({},t),r?t.slice(0,t.l):t}function $r(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ys(e,t){return t==null&&(t=pe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bs(e,t){return t==null&&(t=pe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Uw=dr,Zf=Gt;function Xc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function To(e,t){var r=!1;return t==null&&(r=!0,t=pe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zw=dr,xc=Xc,Qc=To;function e0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var i=s===0?Eo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):rs(t,0)>>2;return r?i/100:i}function t0(e,t){t==null&&(t=pe(4));var r=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function r0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function qw(e,t){return t||(t=pe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ws=r0,ri=qw;function ni(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hs(e,t){return(t||pe(8)).write_shift(8,e,"f")}function Ww(e){var t={},r=e.read_shift(1),s=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=i;var c=Zw[i];c&&(t.rgb=ru(c));break;case 2:t.rgb=ru([o,l,d]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function _o(e,t){if(t||(t=pe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function Hw(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Vw(e,t){t||(t=pe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var n0=2,Sr=3,Da=11,ko=19,La=64,Gw=65,Yw=71,Kw=4108,Xw=4126,Jt=80,Vh={1:{n:"CodePage",t:n0},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:Sr},5:{n:"LineCount",t:Sr},6:{n:"ParagraphCount",t:Sr},7:{n:"SlideCount",t:Sr},8:{n:"NoteCount",t:Sr},9:{n:"HiddenCount",t:Sr},10:{n:"MultimediaClipCount",t:Sr},11:{n:"ScaleCrop",t:Da},12:{n:"HeadingPairs",t:Kw},13:{n:"TitlesOfParts",t:Xw},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:Da},17:{n:"CharacterCount",t:Sr},19:{n:"SharedDoc",t:Da},22:{n:"HyperlinksChanged",t:Da},23:{n:"AppVersion",t:Sr,p:"version"},24:{n:"DigSig",t:Gw},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:ko},2147483651:{n:"Behavior",t:ko},1919054434:{}},Gh={1:{n:"CodePage",t:n0},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:La},11:{n:"LastPrinted",t:La},12:{n:"CreatedDate",t:La},13:{n:"ModifiedDate",t:La},14:{n:"PageCount",t:Sr},15:{n:"WordCount",t:Sr},16:{n:"CharCount",t:Sr},17:{n:"Thumbnail",t:Yw},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:Sr},255:{},2147483648:{n:"Locale",t:ko},2147483651:{n:"Behavior",t:ko},1919054434:{}};function Qw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Jw=Qw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zw=wr(Jw),ta={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Oa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function s0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i0(e,t){var r=dw(e2),s=[],i;s[s.length]=Bt,s[s.length]=ke("Types",null,{xmlns:Ht.CT,"xmlns:xsd":Ht.xsd,"xmlns:xsi":Ht.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return ke("Default",null,{Extension:d[0],ContentType:d[1]})}));var a=function(d){e[d]&&e[d].length>0&&(i=e[d][0],s[s.length]=ke("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Oa[d][t.bookType]||Oa[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){s[s.length]=ke("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Oa[d][t.bookType]||Oa[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){s[s.length]=ke("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function a0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Hs(e){var t=[Bt,ke("Relationships",null,{xmlns:Ht.RELS})];return rr(e["!id"]).forEach(function(r){t[t.length]=ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function lt(e,t,r,s,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=s,i.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function t2(e){var t=[Bt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Yh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function r2(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function n2(e){var t=[Bt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Yh(e[r][0],e[r][1])),t.push(r2("",e[r][0]));return t.push(Yh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function o0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vo.version+"</meta:generator></office:meta></office:document-meta>"}var is=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function zl(e,t,r,s,i){i[e]!=null||t==null||t===""||(i[e]=t,t=dt(t),s[s.length]=r?ke(e,t,r):er(e,t))}function l0(e,t){var r=t||{},s=[Bt,ke("cp:coreProperties",null,{"xmlns:cp":Ht.CORE_PROPS,"xmlns:dc":Ht.dc,"xmlns:dcterms":Ht.dcterms,"xmlns:dcmitype":Ht.dcmitype,"xmlns:xsi":Ht.xsi})],i={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&zl("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fc(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&zl("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fc(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var a=0;a!=is.length;++a){var o=is[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&zl(o[0],l,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Vs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],c0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function d0(e){var t=[],r=ke;return e||(e={}),e.Application="SheetJS",t[t.length]=Bt,t[t.length]=ke("Properties",null,{xmlns:Ht.EXT_PROPS,"xmlns:vt":Ht.vt}),Vs.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=dt(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(s[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+dt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function h0(e){var t=[Bt,ke("Properties",null,{xmlns:Ht.CUST_PROPS,"xmlns:vt":Ht.vt})];if(!e)return t.join("");var r=1;return rr(e).forEach(function(i){++r,t[t.length]=ke("property",ww(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Kh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function s2(e,t){var r=[];return rr(Kh).map(function(s){for(var i=0;i<is.length;++i)if(is[i][1]==s)return is[i];for(i=0;i<Vs.length;++i)if(Vs[i][1]==s)return Vs[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(er(Kh[s[1]]||s[1],i))}}),ke("DocumentProperties",r.join(""),{xmlns:_r.o})}function i2(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&rr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<is.length;++o)if(a==is[o][1])return;for(o=0;o<Vs.length;++o)if(a==Vs[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),i.push(ke(Lh(a),l,{"dt:dt":d}))}}),t&&rr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ke(Lh(a),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+_r.o+'">'+i.join("")+"</"+s+">"}function a2(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),i=(r-s)/Math.pow(2,32);s*=1e7,i*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),i+=a);var o=pe(8);return o.write_shift(4,s),o.write_shift(4,i),o}function Xh(e,t){var r=pe(4),s=pe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=pe(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=a2(t);break;case 31:case 80:for(s=pe(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Zt([r,s])}var u0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function o2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Qh(e,t,r){var s=pe(8),i=[],a=[],o=8,l=0,d=pe(8),c=pe(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),a.push(d),i.push(c),o+=8+d.length,!t){c=pe(8),c.write_shift(4,0),i.unshift(c);var h=[pe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var x=e[l][0];for(d=pe(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);h.push(d)}d=Zt(h),a.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(u0.indexOf(e[l][0])>-1||c0.indexOf(e[l][0])>-1)&&e[l][1]!=null){var u=e[l][1],p=0;if(t){p=+t[e[l][0]];var g=r[p];if(g.p=="version"&&typeof u=="string"){var f=u.split(".");u=(+f[0]<<16)+(+f[1]||0)}d=Xh(g.t,u)}else{var m=o2(u);m==-1&&(m=31,u=String(u)),d=Xh(m,u)}a.push(d),c=pe(8),c.write_shift(4,t?p:2+l),i.push(c),o+=8+d.length}var v=8*(a.length+1);for(l=0;l<a.length;++l)i[l].write_shift(4,v),v+=a[l].length;return s.write_shift(4,o),s.write_shift(4,a.length),Zt([s].concat(i).concat(a))}function Jh(e,t,r,s,i,a){var o=pe(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ft.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var d=Qh(e,r,s);if(l.push(d),i){var c=Qh(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+d.length),l.push(c)}return Zt(l)}function l2(e,t){t||(t=pe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function c2(e,t){return e.read_shift(t)===1}function ur(e,t){return t||(t=pe(2)),t.write_shift(2,+!!e),t}function f0(e){return e.read_shift(2,"u")}function Dr(e,t){return t||(t=pe(2)),t.write_shift(2,e),t}function x0(e,t,r){return r||(r=pe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function p0(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=s?e.read_shift(s,i):"";return o}function d2(e){var t=e.t||"",r=pe(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=pe(2*t.length);s.write_shift(2*t.length,t,"utf16le");var i=[r,s];return Zt(i)}function h2(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function u2(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):h2(e,s,r)}function f2(e,t,r){if(r.biff>5)return u2(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function m0(e,t,r){return r||(r=pe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Zh(e,t){t||(t=pe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function x2(e){var t=pe(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),a=i>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)s=s.slice(1),Zh(s,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?s.slice(0,i):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&Zh(i>-1?s.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function us(e,t,r,s){return s||(s=pe(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function p2(e,t,r){var s=r.biff>8?4:2,i=e.read_shift(s),a=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[i,a,o]}function m2(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:t},e:{c:i,r}}}function g0(e,t){return t||(t=pe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Jc(e,t,r){var s=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=pe(i);return a.write_shift(2,s),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function g2(e,t){var r=!t||t.biff==8,s=pe(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function y2(e,t){var r=!t||t.biff>=8?2:1,s=pe(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function v2(e,t){var r=pe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=d2(e[i]);var a=Zt([r].concat(s));return a.parts=[r.length].concat(s.map(function(o){return o.length})),a}function b2(){var e=pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function w2(e){var t=pe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function j2(e,t){var r=e.name||"Arial",s=t&&t.biff==5,i=s?15+r.length:16+2*r.length,a=pe(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function S2(e,t,r,s){var i=pe(10);return us(e,t,s,i),i.write_shift(4,r),i}function E2(e,t,r,s,i){var a=!i||i.biff==8,o=pe(8+ +a+(1+a)*r.length);return us(e,t,s,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function T2(e,t,r,s){var i=r&&r.biff==5;s||(s=pe(i?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(i?1:2,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}function _2(e,t){var r=t.biff==8||!t.biff?4:2,s=pe(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function eu(e,t,r,s){var i=r&&r.biff==5;s||(s=pe(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function k2(e){var t=pe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function C2(e,t,r,s,i,a){var o=pe(8);return us(e,t,s,o),x0(r,a,o),o}function A2(e,t,r,s){var i=pe(14);return us(e,t,s,i),hs(r,i),i}function I2(e,t,r){if(r.biff<8)return N2(e,t,r);for(var s=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(p2(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function N2(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=p0(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function F2(e){var t=pe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)g0(e[r],t);return t}function R2(e){var t=pe(24),r=Vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(s[i],16));return Zt([t,x2(e[1])])}function P2(e){var t=e[1].Tooltip,r=pe(10+2*(t.length+1));r.write_shift(2,2048);var s=Vt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function D2(e){return e||(e=pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function L2(e,t,r){if(!r.cellStyles)return pn(e,t);var s=r&&r.biff>=12?4:2,i=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var c={s:i,e:a,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function O2(e,t){var r=pe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function B2(e){for(var t=pe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function M2(e,t,r){var s=pe(15);return na(s,e,t),s.write_shift(8,r,"f"),s}function $2(e,t,r){var s=pe(9);return na(s,e,t),s.write_shift(2,r),s}var U2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Uc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],h=ds(1);switch(d.type){case"base64":h=Hr(In(l));break;case"binary":h=Hr(l);break;case"buffer":case"array":h=l;break}Er(h,0);var x=h.read_shift(1),u=!!(x&136),p=!1,g=!1;switch(x){case 2:break;case 3:break;case 48:p=!0,u=!0;break;case 49:p=!0,u=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var f=0,m=521;x==2&&(f=h.read_shift(2)),h.l+=3,x!=2&&(f=h.read_shift(4)),f>1048576&&(f=1e6),x!=2&&(m=h.read_shift(2));var v=h.read_shift(2),S=d.codepage||1252;x!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var T=[],y={},w=Math.min(h.length,x==2?521:m-10-(p?264:0)),k=g?32:11;h.l<w&&h[h.l]!=13;)switch(y={},y.name=Eh.utils.decode(S,h.slice(h.l,h.l+k)).replace(/[\u0000\r\n].*$/g,""),h.l+=k,y.type=String.fromCharCode(h.read_shift(1)),x!=2&&!g&&(y.offset=h.read_shift(4)),y.len=h.read_shift(1),x==2&&(y.offset=h.read_shift(2)),y.dec=h.read_shift(1),y.name.length&&T.push(y),x!=2&&(h.l+=g?13:14),y.type){case"B":(!p||y.len!=8)&&d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(h[h.l]!==13&&(h.l=m-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=m;var b=0,j=0;for(c[0]=[],j=0;j!=T.length;++j)c[0][j]=T[j].name;for(;f-- >0;){if(h[h.l]===42){h.l+=v;continue}for(++h.l,c[++b]=[],j=0,j=0;j!=T.length;++j){var A=h.slice(h.l,h.l+T[j].len);h.l+=T[j].len,Er(A,0);var E=Eh.utils.decode(S,A);switch(T[j].type){case"C":E.trim().length&&(c[b][j]=E.replace(/\s+$/,""));break;case"D":E.length===8?c[b][j]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):c[b][j]=E;break;case"F":c[b][j]=parseFloat(E.trim());break;case"+":case"I":c[b][j]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":c[b][j]=!0;break;case"N":case"F":c[b][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));c[b][j]="##MEMO##"+(g?parseInt(E.trim(),10):A.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(c[b][j]=+E||0);break;case"@":c[b][j]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[b][j]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[b][j]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][j]=-A.read_shift(-8,"f");break;case"B":if(p&&T[j].len==8){c[b][j]=A.read_shift(8,"f");break}case"G":case"P":A.l+=T[j].len;break;case"0":if(T[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[j].type)}}}if(x!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=T,c}function s(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var h=ti(r(l,c),c);return h["!cols"]=c.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete c.DBF,h}function i(l,d){try{return gs(s(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&$i(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=vr(),x=Fo(l,{header:1,raw:!0,cellDates:!0}),u=x[0],p=x.slice(1),g=l["!cols"]||[],f=0,m=0,v=0,S=1;for(f=0;f<u.length;++f){if(((g[f]||{}).DBF||{}).name){u[f]=g[f].DBF.name,++v;continue}if(u[f]!=null){if(++v,typeof u[f]=="number"&&(u[f]=u[f].toString(10)),typeof u[f]!="string")throw new Error("DBF Invalid column name "+u[f]+" |"+typeof u[f]+"|");if(u.indexOf(u[f])!==f){for(m=0;m<1024;++m)if(u.indexOf(u[f]+"_"+m)==-1){u[f]+="_"+m;break}}}}var T=bt(l["!ref"]),y=[],w=[],k=[];for(f=0;f<=T.e.c-T.s.c;++f){var b="",j="",A=0,E=[];for(m=0;m<p.length;++m)p[m][f]!=null&&E.push(p[m][f]);if(E.length==0||u[f]==null){y[f]="?";continue}for(m=0;m<E.length;++m){switch(typeof E[m]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=E[m]instanceof Date?"D":"C";break;default:j="C"}A=Math.max(A,String(E[m]).length),b=b&&b!=j?"C":j}A>250&&(A=250),j=((g[f]||{}).DBF||{}).type,j=="C"&&g[f].DBF.len>A&&(A=g[f].DBF.len),b=="B"&&j=="N"&&(b="N",k[f]=g[f].DBF.dec,A=g[f].DBF.len),w[f]=b=="C"||j=="N"?A:a[b]||0,S+=w[f],y[f]=b}var C=h.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*v),C.write_shift(2,S),f=0;f<4;++f)C.write_shift(4,0);for(C.write_shift(4,0|(+t[vf]||3)<<8),f=0,m=0;f<u.length;++f)if(u[f]!=null){var I=h.next(32),F=(u[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,F,"sbcs"),I.write_shift(1,y[f]=="?"?"C":y[f],"sbcs"),I.write_shift(4,m),I.write_shift(1,w[f]||a[y[f]]||0),I.write_shift(1,k[f]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),m+=w[f]||a[y[f]]||0}var N=h.next(264);for(N.write_shift(4,13),f=0;f<65;++f)N.write_shift(4,0);for(f=0;f<p.length;++f){var z=h.next(S);for(z.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(y[m]){case"L":z.write_shift(1,p[f][m]==null?63:p[f][m]?84:70);break;case"B":z.write_shift(8,p[f][m]||0,"f");break;case"N":var U="0";for(typeof p[f][m]=="number"&&(U=p[f][m].toFixed(k[m]||0)),v=0;v<w[m]-U.length;++v)z.write_shift(1,32);z.write_shift(1,U,"sbcs");break;case"D":p[f][m]?(z.write_shift(4,("0000"+p[f][m].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(p[f][m].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+p[f][m].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var R=String(p[f][m]!=null?p[f][m]:"").slice(0,w[m]);for(z.write_shift(1,R,"sbcs"),v=0;v<w[m]-R.length;++v)z.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:s,from_sheet:o}}(),z2=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+rr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,p){var g=e[p];return typeof g=="number"?Sh(g):g},s=function(u,p,g){var f=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return f==59?u:Sh(f)};e["|"]=254;function i(u,p){switch(p.type){case"base64":return a(In(u),p);case"binary":return a(u,p);case"buffer":return a(st&&Buffer.isBuffer(u)?u.toString("binary"):Ji(u),p);case"array":return a(Yo(u),p)}throw new Error("Unrecognized type "+p.type)}function a(u,p){var g=u.split(/[\n\r]+/),f=-1,m=-1,v=0,S=0,T=[],y=[],w=null,k={},b=[],j=[],A=[],E=0,C;for(+p.codepage>=0&&$i(+p.codepage);v!==g.length;++v){E=0;var I=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),F=I.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),N=F[0],z;if(I.length>0)switch(N){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&y.push(I.slice(3).replace(/;;/g,";"));break;case"C":var U=!1,R=!1,O=!1,X=!1,re=-1,ee=-1;for(S=1;S<F.length;++S)switch(F[S].charAt(0)){case"A":break;case"X":m=parseInt(F[S].slice(1))-1,R=!0;break;case"Y":for(f=parseInt(F[S].slice(1))-1,R||(m=0),C=T.length;C<=f;++C)T[C]=[];break;case"K":z=F[S].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(_n(z))?isNaN(zi(z).getDate())||(z=pr(z)):(z=_n(z),w!==null&&Nf(w)&&(z=Df(z))),U=!0;break;case"E":X=!0;var D=$j(F[S].slice(1),{r:f,c:m});T[f][m]=[T[f][m],D];break;case"S":O=!0,T[f][m]=[T[f][m],"S5S"];break;case"G":break;case"R":re=parseInt(F[S].slice(1))-1;break;case"C":ee=parseInt(F[S].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(U&&(T[f][m]&&T[f][m].length==2?T[f][m][0]=z:T[f][m]=z,w=null),O){if(X)throw new Error("SYLK shared formula cannot have own formula");var q=re>-1&&T[re][ee];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");T[f][m][1]=Uj(q[1],{r:f-re,c:m-ee})}break;case"F":var B=0;for(S=1;S<F.length;++S)switch(F[S].charAt(0)){case"X":m=parseInt(F[S].slice(1))-1,++B;break;case"Y":for(f=parseInt(F[S].slice(1))-1,C=T.length;C<=f;++C)T[C]=[];break;case"M":E=parseInt(F[S].slice(1))/20;break;case"F":break;case"G":break;case"P":w=y[parseInt(F[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=F[S].slice(1).split(" "),C=parseInt(A[0],10);C<=parseInt(A[1],10);++C)E=parseInt(A[2],10),j[C-1]=E===0?{hidden:!0}:{wch:E},Zc(j[C-1]);break;case"C":m=parseInt(F[S].slice(1))-1,j[m]||(j[m]={});break;case"R":f=parseInt(F[S].slice(1))-1,b[f]||(b[f]={}),E>0?(b[f].hpt=E,b[f].hpx=j0(E)):E===0&&(b[f].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}B<1&&(w=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return b.length>0&&(k["!rows"]=b),j.length>0&&(k["!cols"]=j),p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),[T,k]}function o(u,p){var g=i(u,p),f=g[0],m=g[1],v=ti(f,p);return rr(m).forEach(function(S){v[S]=m[S]}),v}function l(u,p){return gs(o(u,p),p)}function d(u,p,g,f){var m="C;Y"+(g+1)+";X"+(f+1)+";K";switch(u.t){case"n":m+=u.v||0,u.f&&!u.F&&(m+=";E"+td(u.f,{r:g,c:f}));break;case"b":m+=u.v?"TRUE":"FALSE";break;case"e":m+=u.w||u.v;break;case"d":m+='"'+(u.w||u.v)+'"';break;case"s":m+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(u,p){p.forEach(function(g,f){var m="F;W"+(f+1)+" "+(f+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Co(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ao(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function h(u,p){p.forEach(function(g,f){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*Io(g.hpx)+";"),m.length>2&&u.push(m+"R"+(f+1))})}function x(u,p){var g=["ID;PWXL;N;E"],f=[],m=bt(u["!ref"]),v,S=Array.isArray(u),T=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),u["!cols"]&&c(g,u["!cols"]),u["!rows"]&&h(g,u["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var y=m.s.r;y<=m.e.r;++y)for(var w=m.s.c;w<=m.e.c;++w){var k=ht({r:y,c:w});v=S?(u[y]||[])[w]:u[k],!(!v||v.v==null&&(!v.f||v.F))&&f.push(d(v,u,y,w))}return g.join(T)+T+f.join(T)+T+"E"+T}return{to_workbook:l,to_sheet:o,from_sheet:x}}(),q2=function(){function e(a,o){switch(o.type){case"base64":return t(In(a),o);case"binary":return t(a,o);case"buffer":return t(st&&Buffer.isBuffer(a)?a.toString("binary"):Ji(a),o);case"array":return t(Yo(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),d=-1,c=-1,h=0,x=[];h!==l.length;++h){if(l[h].trim()==="BOT"){x[++d]=[],c=0;continue}if(!(d<0)){var u=l[h].trim().split(","),p=u[0],g=u[1];++h;for(var f=l[h]||"";(f.match(/["]/g)||[]).length&1&&h<l.length-1;)f+=`
`+l[++h];switch(f=f.trim(),+p){case-1:if(f==="BOT"){x[++d]=[],c=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:f==="TRUE"?x[d][c]=!0:f==="FALSE"?x[d][c]=!1:isNaN(_n(g))?isNaN(zi(g).getDate())?x[d][c]=g:x[d][c]=pr(g):x[d][c]=_n(g),++c;break;case 1:f=f.slice(1,f.length-1),f=f.replace(/""/g,'"'),f&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),x[d][c++]=f!==""?f:null;break}if(f==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(a,o){return ti(e(a,o),o)}function s(a,o){return gs(r(a,o),o)}var i=function(){var a=function(d,c,h,x,u){d.push(c),d.push(h+","+x),d.push('"'+u.replace(/"/g,'""')+'"')},o=function(d,c,h,x){d.push(c+","+h),d.push(c==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var c=[],h=bt(d["!ref"]),x,u=Array.isArray(d);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,h.e.r-h.s.r+1,""),a(c,"TUPLES",0,h.e.c-h.s.c+1,""),a(c,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){o(c,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var f=ht({r:p,c:g});if(x=u?(d[p]||[])[g]:d[f],!x){o(c,1,0,"");continue}switch(x.t){case"n":var m=x.w;!m&&x.v!=null&&(m=x.v),m==null?x.f&&!x.F?o(c,1,0,"="+x.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=qn(x.z||Ft[14],br(pr(x.v)))),o(c,0,x.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,S=c.join(v);return S}}();return{to_workbook:s,to_sheet:r,from_sheet:i}}(),y0=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,u){for(var p=x.split(`
`),g=-1,f=-1,m=0,v=[];m!==p.length;++m){var S=p[m].trim().split(":");if(S[0]==="cell"){var T=Vt(S[1]);if(v.length<=T.r)for(g=v.length;g<=T.r;++g)v[g]||(v[g]=[]);switch(g=T.r,f=T.c,S[2]){case"t":v[g][f]=e(S[3]);break;case"v":v[g][f]=+S[3];break;case"vtf":var y=S[S.length-1];case"vtc":switch(S[3]){case"nl":v[g][f]=!!+S[4];break;default:v[g][f]=+S[4];break}S[2]=="vtf"&&(v[g][f]=[v[g][f],y])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function s(x,u){return ti(r(x,u),u)}function i(x,u){return gs(s(x,u),u)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(x){if(!x||!x["!ref"])return"";for(var u=[],p=[],g,f="",m=Nr(x["!ref"]),v=Array.isArray(x),S=m.s.r;S<=m.e.r;++S)for(var T=m.s.c;T<=m.e.c;++T)if(f=ht({r:S,c:T}),g=v?(x[S]||[])[T]:x[f],!(!g||g.v==null||g.t==="z")){switch(p=["cell",f,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var y=br(pr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+y,p[5]=g.w||qn(g.z||Ft[14],y);break;case"e":continue}u.push(p.join(":"))}return u.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(x){return[a,o,l,o,c(x),d].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:h}}(),W2=function(){function e(h,x,u,p,g){g.raw?x[u][p]=h:h===""||(h==="TRUE"?x[u][p]=!0:h==="FALSE"?x[u][p]=!1:isNaN(_n(h))?isNaN(zi(h).getDate())?x[u][p]=h:x[u][p]=pr(h):x[u][p]=_n(h))}function t(h,x){var u=x||{},p=[];if(!h||h.length===0)return p;for(var g=h.split(/[\r\n]/),f=g.length-1;f>=0&&g[f].length===0;)--f;for(var m=10,v=0,S=0;S<=f;++S)v=g[S].indexOf(" "),v==-1?v=g[S].length:v++,m=Math.max(m,v);for(S=0;S<=f;++S){p[S]=[];var T=0;for(e(g[S].slice(0,m).trim(),p,S,T,u),T=1;T<=(g[S].length-m)/10+1;++T)e(g[S].slice(m+(T-1)*10,m+T*10).trim(),p,S,T,u)}return u.sheetRows&&(p=p.slice(0,u.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(h){for(var x={},u=!1,p=0,g=0;p<h.length;++p)(g=h.charCodeAt(p))==34?u=!u:!u&&g in r&&(x[g]=(x[g]||0)+1);g=[];for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&g.push([x[p],p]);if(!g.length){x=s;for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&g.push([x[p],p])}return g.sort(function(f,m){return f[0]-m[0]||s[f[1]]-s[m[1]]}),r[g.pop()[1]]||44}function a(h,x){var u=x||{},p="",g=u.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):u&&u.FS?p=u.FS:p=i(h.slice(0,1024));var m=0,v=0,S=0,T=0,y=0,w=p.charCodeAt(0),k=!1,b=0,j=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var A=u.dateNF!=null?aw(u.dateNF):null;function E(){var C=h.slice(T,y),I={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)I.t="z";else if(u.raw)I.t="s",I.v=C;else if(C.trim().length===0)I.t="s",I.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(I.t="s",I.v=C.slice(2,-1).replace(/""/g,'"')):zj(C)?(I.t="n",I.f=C.slice(1)):(I.t="s",I.v=C);else if(C=="TRUE")I.t="b",I.v=!0;else if(C=="FALSE")I.t="b",I.v=!1;else if(!isNaN(S=_n(C)))I.t="n",u.cellText!==!1&&(I.w=C),I.v=S;else if(!isNaN(zi(C).getDate())||A&&C.match(A)){I.z=u.dateNF||Ft[14];var F=0;A&&C.match(A)&&(C=ow(C,u.dateNF,C.match(A)||[]),F=1),u.cellDates?(I.t="d",I.v=pr(C,F)):(I.t="n",I.v=br(pr(C,F))),u.cellText!==!1&&(I.w=qn(I.z,I.v instanceof Date?br(I.v):I.v)),u.cellNF||delete I.z}else I.t="s",I.v=C;if(I.t=="z"||(u.dense?(g[m]||(g[m]=[]),g[m][v]=I):g[ht({c:v,r:m})]=I),T=y+1,j=h.charCodeAt(T),f.e.c<v&&(f.e.c=v),f.e.r<m&&(f.e.r=m),b==w)++v;else if(v=0,++m,u.sheetRows&&u.sheetRows<=m)return!0}e:for(;y<h.length;++y)switch(b=h.charCodeAt(y)){case 34:j===34&&(k=!k);break;case w:case 10:case 13:if(!k&&E())break e;break}return y-T>0&&E(),g["!ref"]=Ot(f),g}function o(h,x){return!(x&&x.PRN)||x.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,x):ti(t(h,x),x)}function l(h,x){var u="",p=x.type=="string"?[0,0,0,0]:rk(h,x);switch(x.type){case"base64":u=In(h);break;case"binary":u=h;break;case"buffer":x.codepage==65001?u=h.toString("utf8"):(x.codepage,u=st&&Buffer.isBuffer(h)?h.toString("binary"):Ji(h));break;case"array":u=Yo(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+x.type)}return p[0]==239&&p[1]==187&&p[2]==191?u=_i(u.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?u=_i(u):x.type=="binary",u.slice(0,19)=="socialcalc:version:"?y0.to_sheet(x.type=="string"?u:_i(u),x):o(u,x)}function d(h,x){return gs(l(h,x),x)}function c(h){for(var x=[],u=bt(h["!ref"]),p,g=Array.isArray(h),f=u.s.r;f<=u.e.r;++f){for(var m=[],v=u.s.c;v<=u.e.c;++v){var S=ht({r:f,c:v});if(p=g?(h[f]||[])[v]:h[S],!p||p.v==null){m.push("          ");continue}for(var T=(p.w||(Nn(p),p.w)||"").slice(0,10);T.length<10;)T+=" ";m.push(T+(v===0?" ":""))}x.push(m.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}}(),tu=function(){function e(D,q,B){if(D){Er(D,D.l||0);for(var P=B.Enum||re;D.l<D.length;){var Z=D.read_shift(2),se=P[Z]||P[65535],ie=D.read_shift(2),de=D.l+ie,G=se.f&&se.f(D,ie,B);if(D.l=de,q(G,se,Z))return}}}function t(D,q){switch(q.type){case"base64":return r(Hr(In(D)),q);case"binary":return r(Hr(D),q);case"buffer":case"array":return r(D,q)}throw"Unsupported type "+q.type}function r(D,q){if(!D)return D;var B=q||{},P=B.dense?[]:{},Z="Sheet1",se="",ie=0,de={},G=[],V=[],ae={s:{r:0,c:0},e:{r:0,c:0}},ge=B.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)B.Enum=re,e(D,function(ye,Me,Ue){switch(Ue){case 0:B.vers=ye,ye>=4096&&(B.qpro=!0);break;case 6:ae=ye;break;case 204:ye&&(se=ye);break;case 222:se=ye;break;case 15:case 51:B.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:Ue==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=B.dateNF||Ft[14],B.cellDates&&(ye[1].t="d",ye[1].v=Df(ye[1].v))),B.qpro&&ye[3]>ie&&(P["!ref"]=Ot(ae),de[Z]=P,G.push(Z),P=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},ie=ye[3],Z=se||"Sheet"+(ie+1),se="");var wt=B.dense?(P[ye[0].r]||[])[ye[0].c]:P[ht(ye[0])];if(wt){wt.t=ye[1].t,wt.v=ye[1].v,ye[1].z!=null&&(wt.z=ye[1].z),ye[1].f!=null&&(wt.f=ye[1].f);break}B.dense?(P[ye[0].r]||(P[ye[0].r]=[]),P[ye[0].r][ye[0].c]=ye[1]):P[ht(ye[0])]=ye[1];break}},B);else if(D[2]==26||D[2]==14)B.Enum=ee,D[2]==14&&(B.qpro=!0,D.l=0),e(D,function(ye,Me,Ue){switch(Ue){case 204:Z=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>ie&&(P["!ref"]=Ot(ae),de[Z]=P,G.push(Z),P=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},ie=ye[3],Z="Sheet"+(ie+1)),ge>0&&ye[0].r>=ge)break;B.dense?(P[ye[0].r]||(P[ye[0].r]=[]),P[ye[0].r][ye[0].c]=ye[1]):P[ht(ye[0])]=ye[1],ae.e.c<ye[0].c&&(ae.e.c=ye[0].c),ae.e.r<ye[0].r&&(ae.e.r=ye[0].r);break;case 27:ye[14e3]&&(V[ye[14e3][0]]=ye[14e3][1]);break;case 1537:V[ye[0]]=ye[1],ye[0]==ie&&(Z=ye[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(P["!ref"]=Ot(ae),de[se||Z]=P,G.push(se||Z),!V.length)return{SheetNames:G,Sheets:de};for(var te={},be=[],Ie=0;Ie<V.length;++Ie)de[G[Ie]]?(be.push(V[Ie]||G[Ie]),te[V[Ie]]=de[V[Ie]]||de[G[Ie]]):(be.push(V[Ie]),te[V[Ie]]={"!ref":"A1"});return{SheetNames:be,Sheets:te}}function s(D,q){var B=q||{};if(+B.codepage>=0&&$i(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var P=vr(),Z=bt(D["!ref"]),se=Array.isArray(D),ie=[];Ce(P,0,a(1030)),Ce(P,6,d(Z));for(var de=Math.min(Z.e.r,8191),G=Z.s.r;G<=de;++G)for(var V=tr(G),ae=Z.s.c;ae<=Z.e.c;++ae){G===Z.s.r&&(ie[ae]=cr(ae));var ge=ie[ae]+V,te=se?(D[G]||[])[ae]:D[ge];if(!(!te||te.t=="z"))if(te.t=="n")(te.v|0)==te.v&&te.v>=-32768&&te.v<=32767?Ce(P,13,p(G,ae,te.v)):Ce(P,14,f(G,ae,te.v));else{var be=Nn(te);Ce(P,15,x(G,ae,be.slice(0,239)))}}return Ce(P,1),P.end()}function i(D,q){var B=q||{};if(+B.codepage>=0&&$i(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var P=vr();Ce(P,0,o(D));for(var Z=0,se=0;Z<D.SheetNames.length;++Z)(D.Sheets[D.SheetNames[Z]]||{})["!ref"]&&Ce(P,27,X(D.SheetNames[Z],se++));var ie=0;for(Z=0;Z<D.SheetNames.length;++Z){var de=D.Sheets[D.SheetNames[Z]];if(!(!de||!de["!ref"])){for(var G=bt(de["!ref"]),V=Array.isArray(de),ae=[],ge=Math.min(G.e.r,8191),te=G.s.r;te<=ge;++te)for(var be=tr(te),Ie=G.s.c;Ie<=G.e.c;++Ie){te===G.s.r&&(ae[Ie]=cr(Ie));var ye=ae[Ie]+be,Me=V?(de[te]||[])[Ie]:de[ye];if(!(!Me||Me.t=="z"))if(Me.t=="n")Ce(P,23,E(te,Ie,ie,Me.v));else{var Ue=Nn(Me);Ce(P,22,b(te,Ie,ie,Ue.slice(0,239)))}}++ie}}return Ce(P,1),P.end()}function a(D){var q=pe(2);return q.write_shift(2,D),q}function o(D){var q=pe(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var B=0,P=0,Z=0,se=0;se<D.SheetNames.length;++se){var ie=D.SheetNames[se],de=D.Sheets[ie];if(!(!de||!de["!ref"])){++Z;var G=Nr(de["!ref"]);B<G.e.r&&(B=G.e.r),P<G.e.c&&(P=G.e.c)}}return B>8191&&(B=8191),q.write_shift(2,B),q.write_shift(1,Z),q.write_shift(1,P),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function l(D,q,B){var P={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&B.qpro?(P.s.c=D.read_shift(1),D.l++,P.s.r=D.read_shift(2),P.e.c=D.read_shift(1),D.l++,P.e.r=D.read_shift(2),P):(P.s.c=D.read_shift(2),P.s.r=D.read_shift(2),q==12&&B.qpro&&(D.l+=2),P.e.c=D.read_shift(2),P.e.r=D.read_shift(2),q==12&&B.qpro&&(D.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function d(D){var q=pe(8);return q.write_shift(2,D.s.c),q.write_shift(2,D.s.r),q.write_shift(2,D.e.c),q.write_shift(2,D.e.r),q}function c(D,q,B){var P=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(P[0].c=D.read_shift(1),P[3]=D.read_shift(1),P[0].r=D.read_shift(2),D.l+=2):(P[2]=D.read_shift(1),P[0].c=D.read_shift(2),P[0].r=D.read_shift(2)),P}function h(D,q,B){var P=D.l+q,Z=c(D,q,B);if(Z[1].t="s",B.vers==20768){D.l++;var se=D.read_shift(1);return Z[1].v=D.read_shift(se,"utf8"),Z}return B.qpro&&D.l++,Z[1].v=D.read_shift(P-D.l,"cstr"),Z}function x(D,q,B){var P=pe(7+B.length);P.write_shift(1,255),P.write_shift(2,q),P.write_shift(2,D),P.write_shift(1,39);for(var Z=0;Z<P.length;++Z){var se=B.charCodeAt(Z);P.write_shift(1,se>=128?95:se)}return P.write_shift(1,0),P}function u(D,q,B){var P=c(D,q,B);return P[1].v=D.read_shift(2,"i"),P}function p(D,q,B){var P=pe(7);return P.write_shift(1,255),P.write_shift(2,q),P.write_shift(2,D),P.write_shift(2,B,"i"),P}function g(D,q,B){var P=c(D,q,B);return P[1].v=D.read_shift(8,"f"),P}function f(D,q,B){var P=pe(13);return P.write_shift(1,255),P.write_shift(2,q),P.write_shift(2,D),P.write_shift(8,B,"f"),P}function m(D,q,B){var P=D.l+q,Z=c(D,q,B);if(Z[1].v=D.read_shift(8,"f"),B.qpro)D.l=P;else{var se=D.read_shift(2);y(D.slice(D.l,D.l+se),Z),D.l+=se}return Z}function v(D,q,B){var P=q&32768;return q&=-32769,q=(P?D:0)+(q>=8192?q-16384:q),(P?"":"$")+(B?cr(q):tr(q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(D,q){Er(D,0);for(var B=[],P=0,Z="",se="",ie="",de="";D.l<D.length;){var G=D[D.l++];switch(G){case 0:B.push(D.read_shift(8,"f"));break;case 1:se=v(q[0].c,D.read_shift(2),!0),Z=v(q[0].r,D.read_shift(2),!1),B.push(se+Z);break;case 2:{var V=v(q[0].c,D.read_shift(2),!0),ae=v(q[0].r,D.read_shift(2),!1);se=v(q[0].c,D.read_shift(2),!0),Z=v(q[0].r,D.read_shift(2),!1),B.push(V+ae+":"+se+Z)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(D.read_shift(2));break;case 6:{for(var ge="";G=D[D.l++];)ge+=String.fromCharCode(G);B.push('"'+ge.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:de=B.pop(),ie=B.pop(),B.push(["AND","OR"][G-20]+"("+ie+","+de+")");break;default:if(G<32&&T[G])de=B.pop(),ie=B.pop(),B.push(ie+T[G]+de);else if(S[G]){if(P=S[G][1],P==69&&(P=D[D.l++]),P>B.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+B.join("|")+"|");return}var te=B.slice(-P);B.length-=P,B.push(S[G][0]+"("+te.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}B.length==1?q[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function w(D){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=D.read_shift(2),q[3]=D[D.l++],q[0].c=D[D.l++],q}function k(D,q){var B=w(D);return B[1].t="s",B[1].v=D.read_shift(q-4,"cstr"),B}function b(D,q,B,P){var Z=pe(6+P.length);Z.write_shift(2,D),Z.write_shift(1,B),Z.write_shift(1,q),Z.write_shift(1,39);for(var se=0;se<P.length;++se){var ie=P.charCodeAt(se);Z.write_shift(1,ie>=128?95:ie)}return Z.write_shift(1,0),Z}function j(D,q){var B=w(D);B[1].v=D.read_shift(2);var P=B[1].v>>1;if(B[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return B[1].v=P,B}function A(D,q){var B=w(D),P=D.read_shift(4),Z=D.read_shift(4),se=D.read_shift(2);if(se==65535)return P===0&&Z===3221225472?(B[1].t="e",B[1].v=15):P===0&&Z===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var ie=se&32768;return se=(se&32767)-16446,B[1].v=(1-ie*2)*(Z*Math.pow(2,se+32)+P*Math.pow(2,se)),B}function E(D,q,B,P){var Z=pe(14);if(Z.write_shift(2,D),Z.write_shift(1,B),Z.write_shift(1,q),P==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var se=0,ie=0,de=0,G=0;return P<0&&(se=1,P=-P),ie=Math.log2(P)|0,P/=Math.pow(2,ie-31),G=P>>>0,G&2147483648||(P/=2,++ie,G=P>>>0),P-=G,G|=2147483648,G>>>=0,P*=Math.pow(2,32),de=P>>>0,Z.write_shift(4,de),Z.write_shift(4,G),ie+=16383+(se?32768:0),Z.write_shift(2,ie),Z}function C(D,q){var B=A(D);return D.l+=q-14,B}function I(D,q){var B=w(D),P=D.read_shift(4);return B[1].v=P>>6,B}function F(D,q){var B=w(D),P=D.read_shift(8,"f");return B[1].v=P,B}function N(D,q){var B=F(D);return D.l+=q-10,B}function z(D,q){return D[D.l+q-1]==0?D.read_shift(q,"cstr"):""}function U(D,q){var B=D[D.l++];B>q-1&&(B=q-1);for(var P="";P.length<B;)P+=String.fromCharCode(D[D.l++]);return P}function R(D,q,B){if(!(!B.qpro||q<21)){var P=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var Z=D.read_shift(q-21,"cstr");return[P,Z]}}function O(D,q){for(var B={},P=D.l+q;D.l<P;){var Z=D.read_shift(2);if(Z==14e3){for(B[Z]=[0,""],B[Z][0]=D.read_shift(2);D[D.l];)B[Z][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return B}function X(D,q){var B=pe(5+D.length);B.write_shift(2,14e3),B.write_shift(2,q);for(var P=0;P<D.length;++P){var Z=D.charCodeAt(P);B[B.l++]=Z>127?95:Z}return B[B.l++]=0,B}var re={0:{n:"BOF",f:f0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:U},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:O},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:N},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:R},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:t}}(),H2=/^\s|\s$|[\t\n\r]/;function v0(e,t){if(!t.bookSST)return"";var r=[Bt];r[r.length]=ke("sst",null,{xmlns:ei[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(H2)&&(a+=' xml:space="preserve"'),a+=">"+dt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function V2(e){return[e.read_shift(4),e.read_shift(4)]}function G2(e,t){return t||(t=pe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Y2=Bw;function K2(e){var t=vr();ve(t,159,G2(e));for(var r=0;r<e.length;++r)ve(t,19,Y2(e[r]));return ve(t,160),t.end()}function X2(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function b0(e){var t=0,r,s=X2(e),i=s.length+1,a,o,l,d,c;for(r=ds(i),r[0]=s.length,a=1;a!=i;++a)r[a]=s[a-1];for(a=i-1;a>=0;--a)o=r[a],l=t&16384?1:0,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var Q2=function(){function e(i,a){switch(a.type){case"base64":return t(In(i),a);case"binary":return t(i,a);case"buffer":return t(st&&Buffer.isBuffer(i)?i.toString("binary"):Ji(i),a);case"array":return t(Yo(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},l=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(h,x){Array.isArray(l)&&(l[x]=[]);for(var u=/\\\w+\b/g,p=0,g,f=-1;g=u.exec(h);){switch(g[0]){case"\\cell":var m=h.slice(p,u.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++f,m.length){var v={v:m,t:"s"};Array.isArray(l)?l[x][f]=v:l[ht({r:x,c:f})]=v}break}p=u.lastIndex}f>c.e.c&&(c.e.c=f)}),l["!ref"]=Ot(c),l}function r(i,a){return gs(e(i,a),a)}function s(i){for(var a=["{\\rtf1\\ansi"],o=bt(i["!ref"]),l,d=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){a.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var x=ht({r:c,c:h});l=d?(i[c]||[])[h]:i[x],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Nn(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function ru(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var J2=6,kn=J2;function Co(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function Ao(e){return Math.floor((e-5)/kn*100+.5)/100}function pc(e){return Math.round((e*kn+5)/kn*256)/256}function Zc(e){e.width?(e.wpx=Co(e.width),e.wch=Ao(e.wpx),e.MDW=kn):e.wpx?(e.wch=Ao(e.wpx),e.width=pc(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=pc(e.wch),e.wpx=Co(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var Z2=96,w0=Z2;function Io(e){return e*96/w0}function j0(e){return e*w0/96}function ej(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=ke("numFmt",null,{numFmtId:s,formatCode:dt(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function tj(e){var t=[];return t[t.length]=ke("cellXfs",null),e.forEach(function(r){t[t.length]=ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function S0(e,t){var r=[Bt,ke("styleSheet",null,{xmlns:ei[0],"xmlns:vt":Ht.vt})],s;return e.SSF&&(s=ej(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=tj(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function rj(e,t){var r=e.read_shift(2),s=dr(e);return[r,s]}function nj(e,t,r){r||(r=pe(6+4*t.length)),r.write_shift(2,e),Gt(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function sj(e,t,r){var s={};s.sz=e.read_shift(2)/20;var i=Hw(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=Ww(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=dr(e),s}function ij(e,t){t||(t=pe(25+4*32)),t.write_shift(2,e.sz*20),Vw(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_o(e.color,t);var s=0;return s=2,t.write_shift(1,s),Gt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var aj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ql,oj=pn;function nu(e,t){t||(t=pe(4*3+8*7+16*1)),ql||(ql=Uc(aj));var r=ql[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(_o({auto:1},t),_o({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function lj(e,t){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:i}}function E0(e,t,r){r||(r=pe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function mi(e,t){return t||(t=pe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var cj=pn;function dj(e,t){return t||(t=pe(51)),t.write_shift(1,0),mi(null,t),mi(null,t),mi(null,t),mi(null,t),mi(null,t),t.length>t.l?t.slice(0,t.l):t}function hj(e,t){return t||(t=pe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),To(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function uj(e,t,r){var s=pe(2052);return s.write_shift(4,e),To(t,s),To(r,s),s.length>s.l?s.slice(0,s.l):s}function fj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&++r}),r!=0&&(ve(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&ve(e,44,nj(i,t[i]))}),ve(e,616))}}function xj(e){var t=1;ve(e,611,Xr(t)),ve(e,43,ij({sz:12,color:{theme:1},name:"Calibri",family:2})),ve(e,612)}function pj(e){var t=2;ve(e,603,Xr(t)),ve(e,45,nu({patternType:"none"})),ve(e,45,nu({patternType:"gray125"})),ve(e,604)}function mj(e){var t=1;ve(e,613,Xr(t)),ve(e,46,dj()),ve(e,614)}function gj(e){var t=1;ve(e,626,Xr(t)),ve(e,47,E0({numFmtId:0},65535)),ve(e,627)}function yj(e,t){ve(e,617,Xr(t.length)),t.forEach(function(r){ve(e,47,E0(r,0))}),ve(e,618)}function vj(e){var t=1;ve(e,619,Xr(t)),ve(e,48,hj({xfId:0,name:"Normal"})),ve(e,620)}function bj(e){var t=0;ve(e,505,Xr(t)),ve(e,506)}function wj(e){var t=0;ve(e,508,uj(t,"TableStyleMedium9","PivotStyleMedium4")),ve(e,509)}function jj(e,t){var r=vr();return ve(r,278),fj(r,e.SSF),xj(r),pj(r),mj(r),gj(r),yj(r,t.cellXfs),vj(r),bj(r),wj(r),ve(r,279),r.end()}function T0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Sj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:dr(e)}}function Ej(e){var t=pe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Gt(e.name,t),t.slice(0,t.l)}function Tj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function _j(e){var t=pe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function kj(e,t){var r=pe(8+2*t.length);return r.write_shift(4,e),Gt(t,r),r.slice(0,r.l)}function Cj(e){return e.l+=4,e.read_shift(4)!=0}function Aj(e,t){var r=pe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Ij(){var e=vr();return ve(e,332),ve(e,334,Xr(1)),ve(e,335,Ej({name:"XLDAPR",version:12e4,flags:3496657072})),ve(e,336),ve(e,339,kj(1,"XLDAPR")),ve(e,52),ve(e,35,Xr(514)),ve(e,4096,Xr(0)),ve(e,4097,Dr(1)),ve(e,36),ve(e,53),ve(e,340),ve(e,337,Aj(1)),ve(e,51,_j([[1,0]])),ve(e,338),ve(e,333),e.end()}function _0(){var e=[Bt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Nj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var $s=1024;function k0(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ke("xml",null,{"xmlns:v":_r.v,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:mv":_r.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];$s<e*1e3;)$s+=1e3;return t.forEach(function(a){var o=Vt(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ke("v:fill",d,l),h={on:"t",obscured:"t"};++$s,i=i.concat(["<v:shape"+Wi({id:"_x0000_s"+$s,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ke("v:shadow",null,h),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",er("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),er("x:AutoFill","False"),er("x:Row",String(o.r)),er("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function C0(e){var t=[Bt,ke("comments",null,{xmlns:ei[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var a=dt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var i=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(i=r.indexOf(dt(d.a))),a.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(er("t",dt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(er("t",dt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Fj(e,t,r){var s=[Bt,ke("ThreadedComments",null,{xmlns:Ht.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=d.id:d.parentId=a,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(ke("threadedComment",er("text",o.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function Rj(e){var t=[Bt,ke("personList",null,{xmlns:Ht.TCMNT,"xmlns:x":ei[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Pj(e){var t={};t.iauthor=e.read_shift(4);var r=ws(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function Dj(e,t){return t==null&&(t=pe(36)),t.write_shift(4,e[1].iauthor),ri(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Lj=dr;function Oj(e){return Gt(e.slice(0,54))}function Bj(e){var t=vr(),r=[];return ve(t,628),ve(t,630),e.forEach(function(s){s[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ve(t,632,Oj(i.a)))})}),ve(t,631),ve(t,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Vt(s[0]),e:Vt(s[0])};ve(t,635,Dj([a,i])),i.t&&i.t.length>0&&ve(t,637,$w(i)),ve(t,636),delete i.iauthor})}),ve(t,634),ve(t,629),t.end()}function Mj(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ft.utils.cfb_add(e,i,t.FileIndex[s].content)}})}var A0=["xlsb","xlsm","xlam","biff8","xla"],$j=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,i,a,o){var l=!1,d=!1;a.length==0?d=!0:a.charAt(0)=="["&&(d=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,d?c+=t.r:--c,i+(l?"":"$")+cr(h)+(d?"":"$")+tr(c)}return function(i,a){return t=a,i.replace(e,r)}}(),ed=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,td=function(){return function(t,r){return t.replace(ed,function(s,i,a,o,l,d){var c=Yc(o)-(a?0:r.c),h=Gc(d)-(l?0:r.r),x=h==0?"":l?h+1:"["+h+"]",u=c==0?"":a?c+1:"["+c+"]";return i+"R"+x+"C"+u})}}();function Uj(e,t){return e.replace(ed,function(r,s,i,a,o,l){return s+(i=="$"?i+a:cr(Yc(a)+t.c))+(o=="$"?o+l:tr(Gc(l)+t.r))})}function zj(e){return e.length!=1}function Rt(e){e.l+=1}function Wn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function I0(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return N0(e);r.biff==12&&(s=4)}var i=e.read_shift(s),a=e.read_shift(s),o=Wn(e),l=Wn(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function N0(e){var t=Wn(e),r=Wn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function qj(e,t,r){if(r.biff<8)return N0(e);var s=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Wn(e),o=Wn(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function F0(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Wj(e);var s=e.read_shift(r&&r.biff==12?4:2),i=Wn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function Wj(e){var t=Wn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Hj(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Vj(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Gj(e);var i=e.read_shift(s>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function Gj(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:s}}function Yj(e,t,r){var s=(e[e.l++]&96)>>5,i=I0(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,i]}function Kj(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=I0(e,a,r);return[s,i,o]}function Xj(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Qj(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,i]}function Jj(e,t,r){var s=(e[e.l++]&96)>>5,i=qj(e,t-1,r);return[s,i]}function Zj(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function su(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eS(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=s;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function tS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function rS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function nS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function sS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function R0(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function iS(e){return e.read_shift(2),R0(e)}function aS(e){return e.read_shift(2),R0(e)}function oS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=F0(e,0,r);return[s,i]}function lS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=Vj(e,0,r);return[s,i]}function cS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=F0(e,0,r);return[s,i,a]}function dS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[dE[i],L0[i],s]}function hS(e,t,r){var s=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:uS(e);return[i,(a[0]===0?L0:cE)[a[1]]]}function uS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fS(e,t,r){e.l+=r&&r.biff==2?3:4}function xS(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function pS(e){return e.l++,ta[e.read_shift(1)]}function mS(e){return e.l++,e.read_shift(2)}function gS(e){return e.l++,e.read_shift(1)!==0}function yS(e){return e.l++,ni(e)}function vS(e,t,r){return e.l++,p0(e,t-1,r)}function bS(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=c2(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ta[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ni(e);break;case 2:r[1]=f2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wS(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=s;++a)i.push((r.biff==12?ws:m2)(e));return i}function jS(e,t,r){var s=0,i=0;r.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--i==0&&(i=256));for(var a=0,o=[];a!=s&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=bS(e,r.biff);return o}function SS(e,t,r){var s=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function ES(e,t,r){if(r.biff==5)return TS(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[s,i,a]}function TS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function _S(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function kS(e,t,r){var s=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function CS(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function AS(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,i]}var IS=pn,NS=pn,FS=pn;function ra(e,t,r){return e.l+=2,[Hj(e)]}function rd(e){return e.l+=6,[]}var RS=ra,PS=rd,DS=rd,LS=ra;function P0(e){return e.l+=2,[f0(e),e.read_shift(2)&1]}var OS=ra,BS=P0,MS=rd,$S=ra,US=ra,zS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qS(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=zS[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:i,C:a}}function WS(e){return e.l+=2,[e.read_shift(4)]}function HS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function VS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KS(e){return e.l+=4,[0,0]}var iu={1:{n:"PtgExp",f:xS},2:{n:"PtgTbl",f:FS},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:vS},26:{n:"PtgSheet",f:HS},27:{n:"PtgEndSheet",f:VS},28:{n:"PtgErr",f:pS},29:{n:"PtgBool",f:gS},30:{n:"PtgInt",f:mS},31:{n:"PtgNum",f:yS},32:{n:"PtgArray",f:Zj},33:{n:"PtgFunc",f:dS},34:{n:"PtgFuncVar",f:hS},35:{n:"PtgName",f:SS},36:{n:"PtgRef",f:oS},37:{n:"PtgArea",f:Yj},38:{n:"PtgMemArea",f:_S},39:{n:"PtgMemErr",f:IS},40:{n:"PtgMemNoMem",f:NS},41:{n:"PtgMemFunc",f:kS},42:{n:"PtgRefErr",f:CS},43:{n:"PtgAreaErr",f:Xj},44:{n:"PtgRefN",f:lS},45:{n:"PtgAreaN",f:Jj},46:{n:"PtgMemAreaN",f:GS},47:{n:"PtgMemNoMemN",f:YS},57:{n:"PtgNameX",f:ES},58:{n:"PtgRef3d",f:cS},59:{n:"PtgArea3d",f:Kj},60:{n:"PtgRefErr3d",f:AS},61:{n:"PtgAreaErr3d",f:Qj},255:{}},XS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},QS={1:{n:"PtgElfLel",f:P0},2:{n:"PtgElfRw",f:$S},3:{n:"PtgElfCol",f:RS},6:{n:"PtgElfRwV",f:US},7:{n:"PtgElfColV",f:LS},10:{n:"PtgElfRadical",f:OS},11:{n:"PtgElfRadicalS",f:MS},13:{n:"PtgElfColS",f:PS},15:{n:"PtgElfColSV",f:DS},16:{n:"PtgElfRadicalLel",f:BS},25:{n:"PtgList",f:qS},29:{n:"PtgSxName",f:WS},255:{}},JS={0:{n:"PtgAttrNoop",f:KS},1:{n:"PtgAttrSemi",f:sS},2:{n:"PtgAttrIf",f:rS},4:{n:"PtgAttrChoose",f:eS},8:{n:"PtgAttrGoto",f:tS},16:{n:"PtgAttrSum",f:fS},32:{n:"PtgAttrBaxcel",f:su},33:{n:"PtgAttrBaxcel",f:su},64:{n:"PtgAttrSpace",f:iS},65:{n:"PtgAttrSpaceSemi",f:aS},128:{n:"PtgAttrIfError",f:nS},255:{}};function ZS(e,t,r,s){if(s.biff<8)return pn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jS(e,0,s),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=wS(e,r[o][1],s),a.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(pn(e,t)),a}function eE(e,t,r){for(var s=e.l+t,i,a,o=[];s!=e.l;)t=s-e.l,a=e[e.l],i=iu[a]||iu[XS[a]],(a===24||a===25)&&(i=(a===24?QS:JS)[e[e.l+1]]),!i||!i.f?pn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function tE(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],i=[],a=0;a<s.length;++a){var o=s[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var rE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nE(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function D0(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function au(e,t,r){var s=D0(e,t,r);return s=="#REF"?s:nE(s,r)}function Ks(e,t,r,s,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},l=[],d,c,h,x=0,u=0,p,g="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,S=e[0].length;v<S;++v){var T=e[0][v];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=Nt(" ",e[0][f][1][1]);break;case 1:m=Nt("\r",e[0][f][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}c=c+m,f=-1}l.push(c+rE[T[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Ci(T[1][1],o,i),l.push(Ai(h,a));break;case"PtgRefN":h=r?Ci(T[1][1],r,i):T[1][1],l.push(Ai(h,a));break;case"PtgRef3d":x=T[1][1],h=Ci(T[1][2],o,i),g=au(s,x,i),l.push(g+"!"+Ai(h,a));break;case"PtgFunc":case"PtgFuncVar":var y=T[1][0],w=T[1][1];y||(y=0),y&=127;var k=y==0?[]:l.slice(-y);l.length-=y,w==="User"&&(w=k.shift()),l.push(w+"("+k.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":p=Wh(T[1][1],r?{s:r}:o,i),l.push(Ul(p,i));break;case"PtgArea":p=Wh(T[1][1],o,i),l.push(Ul(p,i));break;case"PtgArea3d":x=T[1][1],p=T[1][2],g=au(s,x,i),l.push(g+"!"+Ul(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=T[1][2];var b=(s.names||[])[u-1]||(s[0]||[])[u],j=b?b.Name:"SH33TJSNAME"+String(u);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),l.push(j);break;case"PtgNameX":var A=T[1][1];u=T[1][2];var E;if(i.biff<=5)A<0&&(A=-A),s[A]&&(E=s[A][u]);else{var C="";if(((s[A]||[])[0]||[])[0]==14849||(((s[A]||[])[0]||[])[0]==1025?s[A][u]&&s[A][u].itab>0&&(C=s.SheetNames[s[A][u].itab-1]+"!"):C=s.SheetNames[u-1]+"!"),s[A]&&s[A][u])C+=s[A][u].Name;else if(s[0]&&s[0][u])C+=s[0][u].Name;else{var I=(D0(s,A,i)||"").split(";;");I[u-1]?C=I[u-1]:C+="SH33TJSERRX"}l.push(C);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var F="(",N=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:F=Nt(" ",e[0][f][1][1])+F;break;case 3:F=Nt("\r",e[0][f][1][1])+F;break;case 4:N=Nt(" ",e[0][f][1][1])+N;break;case 5:N=Nt("\r",e[0][f][1][1])+N;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}l.push(F+l.pop()+N);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var z={c:r.c,r:r.r};if(s.sharedf[ht(h)]){var U=s.sharedf[ht(h)];l.push(Ks(U,o,z,s,i))}else{var R=!1;for(d=0;d!=s.arrayf.length;++d)if(c=s.arrayf[d],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){l.push(Ks(c[1],o,z,s,i)),R=!0;break}R||l.push(T[1])}break;case"PtgArray":l.push("{"+tE(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var O=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&f>=0&&O.indexOf(e[0][v][0])==-1){T=e[0][f];var X=!0;switch(T[1][0]){case 4:X=!1;case 0:m=Nt(" ",T[1][1]);break;case 5:X=!1;case 1:m=Nt("\r",T[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((X?m:"")+l.pop()+(X?"":m)),f=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function sE(e){if(e==null){var t=pe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return hs(e);return hs(0)}function iE(e,t,r,s,i){var a=us(t,r,i),o=sE(e.v),l=pe(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=pe(e.bf.length),h=0;h<e.bf.length;++h)c[h]=e.bf[h];var x=Zt([a,o,l,c]);return x}function Ko(e,t,r){var s=e.read_shift(4),i=eE(e,s,r),a=e.read_shift(4),o=a>0?ZS(e,a,i,r):null;return[i,o]}var aE=Ko,Xo=Ko,oE=Ko,lE=Ko,cE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hE(e){var t="of:="+e.replace(ed,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function uE(e){return e.replace(/\./,"!")}var Ii=typeof Map<"u";function nd(e,t,r){var s=0,i=e.length;if(r){if(Ii?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ii?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<i;++s)if(e[s].t===t)return e.Count++,s;return e[i]={t},e.Count++,e.Unique++,r&&(Ii?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Qo(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(kn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Ao(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=pc(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function O0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Kn(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(s==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ff(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=s=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===s)return i;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function fE(e,t,r){if(e&&e["!ref"]){var s=bt(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function xE(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ot(e[r])+'"/>';return t+"</mergeCells>"}function pE(e,t,r,s,i){var a=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}a=!0,o.codeName=qi(dt(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+ke("outlinePr",null,c)}!a&&!l||(i[i.length]=ke("sheetPr",l,o))}var mE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yE(e){var t={sheet:1};return mE.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gE.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=b0(e.password).toString(16).toUpperCase()),ke("sheetProtection",null,t)}function vE(e){return O0(e),ke("pageMargins",null,e)}function bE(e,t){for(var r=["<cols>"],s,i=0;i!=t.length;++i)(s=t[i])&&(r[r.length]=ke("col",null,Qo(i,s)));return r[r.length]="</cols>",r.join("")}function wE(e,t,r,s){var i=typeof e.ref=="string"?e.ref:Ot(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Nr(i);o.s.r==o.e.r&&(o.e.r=Nr(t["!ref"]).e.r,i=Ot(o));for(var l=0;l<a.length;++l){var d=a[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),ke("autoFilter",null,{ref:i})}function jE(e,t,r,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,i),{})}function SE(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ta[e.v];break;case"d":s&&s.cellDates?i=pr(e.v,-1).toISOString():(e=wr(e),e.t="n",i=""+(e.v=br(pr(e.v)))),typeof e.z>"u"&&(e.z=Ft[14]);break;default:i=e.v;break}var l=er("v",dt(i)),d={r:t},c=Kn(s.cellXfs,e,s);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=er("v",""+nd(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ke("f",dt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),ke("c",l,d)}function EE(e,t,r,s){var i=[],a=[],o=bt(e["!ref"]),l="",d,c="",h=[],x=0,u=0,p=e["!rows"],g=Array.isArray(e),f={r:c},m,v=-1;for(u=o.s.c;u<=o.e.c;++u)h[u]=cr(u);for(x=o.s.r;x<=o.e.r;++x){for(a=[],c=tr(x),u=o.s.c;u<=o.e.c;++u){d=h[u]+c;var S=g?(e[x]||[])[u]:e[d];S!==void 0&&(l=SE(S,d,e,t))!=null&&a.push(l)}(a.length>0||p&&p[x])&&(f={r:c},p&&p[x]&&(m=p[x],m.hidden&&(f.hidden=1),v=-1,m.hpx?v=Io(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(f.ht=v,f.customHeight=1),m.level&&(f.outlineLevel=m.level)),i[i.length]=ke("row",a.join(""),f))}if(p)for(;x<p.length;++x)p&&p[x]&&(f={r:x+1},m=p[x],m.hidden&&(f.hidden=1),v=-1,m.hpx?v=Io(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(f.ht=v,f.customHeight=1),m.level&&(f.outlineLevel=m.level),i[i.length]=ke("row","",f));return i.join("")}function B0(e,t,r,s){var i=[Bt,ke("worksheet",null,{xmlns:ei[0],"xmlns:r":Ht.r})],a=r.SheetNames[e],o=0,l="",d=r.Sheets[a];d==null&&(d={});var c=d["!ref"]||"A1",h=bt(c);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=Ot(h)}s||(s={}),d["!comments"]=[];var x=[];pE(d,r,e,t,i),i[i.length]=ke("dimension",null,{ref:c}),i[i.length]=jE(d,t,e,r),t.sheetFormat&&(i[i.length]=ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=bE(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=EE(d,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=yE(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=wE(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=xE(d["!merges"]));var u=-1,p,g=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(f){f[1].Target&&(p={ref:f[0]},f[1].Target.charAt(0)!="#"&&(g=lt(s,-1,dt(f[1].Target).replace(/#.*$/,""),rt.HLINK),p["r:id"]="rId"+g),(u=f[1].Target.indexOf("#"))>-1&&(p.location=dt(f[1].Target.slice(u+1))),f[1].Tooltip&&(p.tooltip=dt(f[1].Tooltip)),i[i.length]=ke("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=vE(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=er("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:c}))),x.length>0&&(g=lt(s,-1,"../drawings/drawing"+(e+1)+".xml",rt.DRAW),i[i.length]=ke("drawing",null,{"r:id":"rId"+g}),d["!drawing"]=x),d["!comments"].length>0&&(g=lt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rt.VML),i[i.length]=ke("legacyDrawing",null,{"r:id":"rId"+g}),d["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function TE(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function _E(e,t,r){var s=pe(145),i=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;i.hpx?a=Io(i.hpx)*20:i.hpt&&(a=i.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,d=s.l;s.l+=4;for(var c={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var x=-1,u=-1,p=h<<10;p<h+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ht(c)];g&&(x<0&&(x=p),u=p)}x<0||(++l,s.write_shift(4,x),s.write_shift(4,u))}var f=s.l;return s.l=d,s.write_shift(4,l),s.l=f,s.length>s.l?s.slice(0,s.l):s}function kE(e,t,r,s){var i=_E(s,r,t);(i.length>17||(t["!rows"]||[])[s])&&ve(e,0,i)}var CE=ws,AE=ri;function IE(){}function NE(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=Uw(e),r}function FE(e,t,r){r==null&&(r=pe(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var i=1;i<3;++i)r.write_shift(1,0);return _o({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Zf(e,r),r.slice(0,r.l)}function RE(e){var t=$r(e);return[t]}function PE(e,t,r){return r==null&&(r=pe(8)),ys(t,r)}function DE(e){var t=vs(e);return[t]}function LE(e,t,r){return r==null&&(r=pe(4)),bs(t,r)}function OE(e){var t=$r(e),r=e.read_shift(1);return[t,r,"b"]}function BE(e,t,r){return r==null&&(r=pe(9)),ys(t,r),r.write_shift(1,e.v?1:0),r}function ME(e){var t=vs(e),r=e.read_shift(1);return[t,r,"b"]}function $E(e,t,r){return r==null&&(r=pe(5)),bs(t,r),r.write_shift(1,e.v?1:0),r}function UE(e){var t=$r(e),r=e.read_shift(1);return[t,r,"e"]}function zE(e,t,r){return r==null&&(r=pe(9)),ys(t,r),r.write_shift(1,e.v),r}function qE(e){var t=vs(e),r=e.read_shift(1);return[t,r,"e"]}function WE(e,t,r){return r==null&&(r=pe(8)),bs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function HE(e){var t=$r(e),r=e.read_shift(4);return[t,r,"s"]}function VE(e,t,r){return r==null&&(r=pe(12)),ys(t,r),r.write_shift(4,t.v),r}function GE(e){var t=vs(e),r=e.read_shift(4);return[t,r,"s"]}function YE(e,t,r){return r==null&&(r=pe(8)),bs(t,r),r.write_shift(4,t.v),r}function KE(e){var t=$r(e),r=ni(e);return[t,r,"n"]}function XE(e,t,r){return r==null&&(r=pe(16)),ys(t,r),hs(e.v,r),r}function QE(e){var t=vs(e),r=ni(e);return[t,r,"n"]}function JE(e,t,r){return r==null&&(r=pe(12)),bs(t,r),hs(e.v,r),r}function ZE(e){var t=$r(e),r=e0(e);return[t,r,"n"]}function eT(e,t,r){return r==null&&(r=pe(12)),ys(t,r),t0(e.v,r),r}function tT(e){var t=vs(e),r=e0(e);return[t,r,"n"]}function rT(e,t,r){return r==null&&(r=pe(8)),bs(t,r),t0(e.v,r),r}function nT(e){var t=$r(e),r=Kc(e);return[t,r,"is"]}function sT(e){var t=$r(e),r=dr(e);return[t,r,"str"]}function iT(e,t,r){return r==null&&(r=pe(12+4*e.v.length)),ys(t,r),Gt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aT(e){var t=vs(e),r=dr(e);return[t,r,"str"]}function oT(e,t,r){return r==null&&(r=pe(8+4*e.v.length)),bs(t,r),Gt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lT(e,t,r){var s=e.l+t,i=$r(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function cT(e,t,r){var s=e.l+t,i=$r(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function dT(e,t,r){var s=e.l+t,i=$r(e);i.r=r["!row"];var a=ni(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function hT(e,t,r){var s=e.l+t,i=$r(e);i.r=r["!row"];var a=dr(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}var uT=ws,fT=ri;function xT(e,t){return t==null&&(t=pe(4)),t.write_shift(4,e),t}function pT(e,t){var r=e.l+t,s=ws(e),i=Xc(e),a=dr(e),o=dr(e),l=dr(e);e.l=r;var d={rfx:s,relId:i,loc:a,display:l};return o&&(d.Tooltip=o),d}function mT(e,t){var r=pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ri({s:Vt(e[0]),e:Vt(e[0])},r),Qc("rId"+t,r);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return Gt(i||"",r),Gt(e[1].Tooltip||"",r),Gt("",r),r.slice(0,r.l)}function gT(){}function yT(e,t,r){var s=e.l+t,i=r0(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var l=aE(e,s-e.l,r);o[1]=l}else e.l=s;return o}function vT(e,t,r){var s=e.l+t,i=ws(e),a=[i];if(r.cellFormula){var o=lE(e,s-e.l,r);a[1]=o,e.l=s}else e.l=s;return a}function bT(e,t,r){r==null&&(r=pe(18));var s=Qo(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var M0=["left","right","top","bottom","header","footer"];function wT(e){var t={};return M0.forEach(function(r){t[r]=ni(e)}),t}function jT(e,t){return t==null&&(t=pe(6*8)),O0(e),M0.forEach(function(r){hs(e[r],t)}),t}function ST(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ET(e,t,r){r==null&&(r=pe(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function TT(e){var t=pe(24);return t.write_shift(4,4),t.write_shift(4,1),ri(e,t),t}function _T(e,t){return t==null&&(t=pe(16*4+2)),t.write_shift(2,e.password?b0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function kT(){}function CT(){}function AT(e,t,r,s,i,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=wr(t),t.z=t.z||Ft[14],t.v=br(pr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:s};switch(d.s=Kn(i.cellXfs,t,i),t.l&&a["!links"].push([ht(d),t.l]),t.c&&a["!comments"].push([ht(d),t.c]),t.t){case"s":case"str":return i.bookSST?(l=nd(i.Strings,t.v,i.revStrings),d.t="s",d.v=l,o?ve(e,18,YE(t,d)):ve(e,7,VE(t,d))):(d.t="str",o?ve(e,17,oT(t,d)):ve(e,6,iT(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ve(e,13,rT(t,d)):ve(e,2,eT(t,d)):o?ve(e,16,JE(t,d)):ve(e,5,XE(t,d)),!0;case"b":return d.t="b",o?ve(e,15,$E(t,d)):ve(e,4,BE(t,d)),!0;case"e":return d.t="e",o?ve(e,14,WE(t,d)):ve(e,3,zE(t,d)),!0}return o?ve(e,12,LE(t,d)):ve(e,1,PE(t,d)),!0}function IT(e,t,r,s){var i=bt(t["!ref"]||"A1"),a,o="",l=[];ve(e,145);var d=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=c;++h){o=tr(h),kE(e,t,i,h);var x=!1;if(h<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){h===i.s.r&&(l[u]=cr(u)),a=l[u]+o;var p=d?(t[h]||[])[u]:t[a];if(!p){x=!1;continue}x=AT(e,p,h,u,s,t,x)}}ve(e,146)}function NT(e,t){!t||!t["!merges"]||(ve(e,177,xT(t["!merges"].length)),t["!merges"].forEach(function(r){ve(e,176,fT(r))}),ve(e,178))}function FT(e,t){!t||!t["!cols"]||(ve(e,390),t["!cols"].forEach(function(r,s){r&&ve(e,60,bT(s,r))}),ve(e,391))}function RT(e,t){!t||!t["!ref"]||(ve(e,648),ve(e,649,TT(bt(t["!ref"]))),ve(e,650))}function PT(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var i=lt(r,-1,s[1].Target.replace(/#.*$/,""),rt.HLINK);ve(e,494,mT(s,i))}}),delete t["!links"]}function DT(e,t,r,s){if(t["!comments"].length>0){var i=lt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);ve(e,551,Qc("rId"+i)),t["!legacy"]=i}}function LT(e,t,r,s){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:Ot(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Nr(a);l.s.r==l.e.r&&(l.e.r=Nr(t["!ref"]).e.r,a=Ot(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+a;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),ve(e,161,ri(bt(a))),ve(e,162)}}function OT(e,t,r){ve(e,133),ve(e,137,ET(t,r)),ve(e,138),ve(e,134)}function BT(e,t){t["!protect"]&&ve(e,535,_T(t["!protect"]))}function MT(e,t,r,s){var i=vr(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=bt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ve(i,129),(r.vbaraw||o["!outline"])&&ve(i,147,FE(l,o["!outline"])),ve(i,148,AE(d)),OT(i,o,r.Workbook),FT(i,o),IT(i,o,e,t),BT(i,o),LT(i,o,r,e),NT(i,o),PT(i,o,s),o["!margins"]&&ve(i,476,jT(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&RT(i,o),DT(i,o,e,s),ve(i,130),i.end()}function $T(e,t){e.l+=10;var r=dr(e);return{name:r}}var UT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function zT(e){return!e.Workbook||!e.Workbook.WBProps?"false":vw(e.Workbook.WBProps.date1904)?"true":"false"}var qT="][*?/\\".split("");function $0(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qT.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function WT(e,t,r){e.forEach(function(s,i){$0(s);for(var a=0;a<i;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[i]&&t[i].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function HT(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];WT(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)fE(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function U0(e){var t=[Bt];t[t.length]=ke("workbook",null,{xmlns:ei[0],"xmlns:r":Ht.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(UT.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=ke("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:dt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ke("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=ke("definedName",dt(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function VT(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=xc(e),r.name=dr(e),r}function GT(e,t){return t||(t=pe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Qc(e.strRelID,t),Gt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function YT(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?dr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function KT(e,t){t||(t=pe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Zf(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function XT(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=zw(e),o=oE(e,0,r),l=Xc(e);e.l=s;var d={Name:a,Ptg:o};return i<268435455&&(d.Sheet=i),l&&(d.Comment=l),d}function QT(e,t){ve(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ve(e,156,GT(i))}ve(e,144)}function JT(e,t){t||(t=pe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Gt("SheetJS",t),Gt(vo.version,t),Gt(vo.version,t),Gt("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZT(e,t){t||(t=pe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function e_(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,i=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&i==-1?i=s:r[s].Hidden==1&&a==-1&&(a=s);a>i||(ve(e,135),ve(e,158,ZT(i)),ve(e,136))}}function t_(e,t){var r=vr();return ve(r,131),ve(r,128,JT()),ve(r,153,KT(e.Workbook&&e.Workbook.WBProps||null)),e_(r,e),QT(r,e),ve(r,132),r.end()}function r_(e,t,r){return(t.slice(-4)===".bin"?t_:U0)(e)}function n_(e,t,r,s,i){return(t.slice(-4)===".bin"?MT:B0)(e,r,s,i)}function s_(e,t,r){return(t.slice(-4)===".bin"?jj:S0)(e,r)}function i_(e,t,r){return(t.slice(-4)===".bin"?K2:v0)(e,r)}function a_(e,t,r){return(t.slice(-4)===".bin"?Bj:C0)(e)}function o_(e){return(e.slice(-4)===".bin"?Ij:_0)()}function l_(e,t){var r=[];return e.Props&&r.push(s2(e.Props,t)),e.Custprops&&r.push(i2(e.Props,e.Custprops)),r.join("")}function c_(){return""}function d_(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,i){var a=[];a.push(ke("NumberFormat",null,{"ss:Format":dt(Ft[s.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(ke("Style",a.join(""),o))}),ke("Styles",r.join(""))}function z0(e){return ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+td(e.Ref,{r:0,c:0})})}function h_(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var i=t[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(z0(i)))}return ke("Names",r.join(""))}function u_(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,a=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(z0(l)))}return a.join("")}function f_(e,t,r,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ke("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)i.push(ke("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(er("ProtectContents","True")),e["!protect"].objects&&i.push(er("ProtectObjects","True")),e["!protect"].scenarios&&i.push(er("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(er("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(er("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ke("WorksheetOptions",i.join(""),{xmlns:_r.x})}function x_(e){return e.map(function(t){var r=yw(t.t||""),s=ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",s,{"ss:Author":t.a})}).join("")}function p_(e,t,r,s,i,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+dt(td(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Vt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=dt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=dt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],h=0;h!=c.length;++h)c[h].s.c!=o.c||c[h].s.r!=o.r||(c[h].e.c>c[h].s.c&&(l["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(l["ss:MergeDown"]=c[h].e.r-c[h].s.r));var x="",u="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":x="Number",u=String(e.v);break;case"b":x="Boolean",u=e.v?"1":"0";break;case"e":x="Error",u=ta[e.v];break;case"d":x="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ft[14]);break;case"s":x="String",u=gw(e.v||"");break}var p=Kn(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var g=e.v!=null?u:"",f=e.t=="z"?"":'<Data ss:Type="'+x+'">'+g+"</Data>";return(e.c||[]).length>0&&(f+=x_(e.c)),ke("Cell",f,l)}function m_(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=j0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function g_(e,t,r,s){if(!e["!ref"])return"";var i=bt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(m,v){Zc(m);var S=!!m.width,T=Qo(v,m),y={"ss:Index":v+1};S&&(y["ss:Width"]=Co(T.width)),m.hidden&&(y["ss:Hidden"]="1"),l.push(ke("Column",null,y))});for(var d=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var h=[m_(c,(e["!rows"]||[])[c])],x=i.s.c;x<=i.e.c;++x){var u=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>x)&&!(a[o].s.r>c)&&!(a[o].e.c<x)&&!(a[o].e.r<c)){(a[o].s.c!=x||a[o].s.r!=c)&&(u=!0);break}if(!u){var p={r:c,c:x},g=ht(p),f=d?(e[c]||[])[x]:e[g];h.push(p_(f,g,e,t,r,s,p))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function y_(e,t,r){var s=[],i=r.SheetNames[e],a=r.Sheets[i],o=a?u_(a,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=a?g_(a,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(f_(a,t,e,r)),s.join("")}function v_(e,t){t||(t={}),e.SSF||(e.SSF=wr(Ft)),e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(l_(e,t)),r.push(c_()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(ke("Worksheet",y_(s,t,e),{"ss:Name":dt(e.SheetNames[s])}));return r[2]=d_(e,t),r[3]=h_(e),Bt+ke("Workbook",r.join(""),{xmlns:_r.ss,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:ss":_r.ss,"xmlns:dt":_r.dt,"xmlns:html":_r.html})}var Wl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function b_(e,t){var r=[],s=[],i=[],a=0,o,l=Rh(Vh,"n"),d=Rh(Gh,"n");if(e.Props)for(o=rr(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=rr(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Custprops[o[a]]]);var c=[];for(a=0;a<i.length;++a)u0.indexOf(i[a][0])>-1||c0.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);s.length&&ft.utils.cfb_add(t,"/SummaryInformation",Jh(s,Wl.SI,d,Gh)),(r.length||c.length)&&ft.utils.cfb_add(t,"/DocumentSummaryInformation",Jh(r,Wl.DSI,l,Vh,c.length?c:null,Wl.UDI))}function w_(e,t){var r=t||{},s=ft.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ft.utils.cfb_add(s,i,q0(e,r)),r.biff==8&&(e.Props||e.Custprops)&&b_(e,s),r.biff==8&&e.vbaraw&&Mj(s,ft.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var j_={0:{f:TE},1:{f:RE},2:{f:ZE},3:{f:UE},4:{f:OE},5:{f:KE},6:{f:sT},7:{f:HE},8:{f:hT},9:{f:dT},10:{f:lT},11:{f:cT},12:{f:DE},13:{f:tT},14:{f:qE},15:{f:ME},16:{f:QE},17:{f:aT},18:{f:GE},19:{f:Kc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:XT},40:{},42:{},43:{f:sj},44:{f:rj},45:{f:oj},46:{f:cj},47:{f:lj},48:{},49:{f:Dw},50:{},51:{f:Tj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L2},62:{f:nT},63:{f:Nj},64:{f:kT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ST},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:NE},148:{f:CE,p:16},151:{f:gT},152:{},153:{f:YT},154:{},155:{},156:{f:VT},157:{},158:{},159:{T:1,f:V2},160:{T:-1},161:{T:1,f:ws},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Sj},336:{T:-1},337:{f:Cj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:I2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yT},427:{f:vT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Lj},633:{T:1},634:{T:-1},635:{T:1,f:Pj},636:{T:-1},637:{f:Mw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$T},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:CT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ce(e,t,r,s){var i=t;if(!isNaN(i)){var a=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Vc(r)&&e.push(r)}}function S_(e,t,r,s){var i=(r||[]).length||0;if(i<=8224)return Ce(e,t,r,i);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,a),h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<i;){for(h=e.next(4),h.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function na(e,t,r){return e||(e=pe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function E_(e,t,r,s){var i=pe(9);return na(i,e,t),x0(r,s||"b",i),i}function T_(e,t,r){var s=pe(8+2*r.length);return na(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function __(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?br(pr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ce(e,2,$2(r,s,i)):Ce(e,3,M2(r,s,i));return;case"b":case"e":Ce(e,5,E_(r,s,t.v,t.t));return;case"s":case"str":Ce(e,4,T_(r,s,(t.v||"").slice(0,255)));return}Ce(e,1,na(null,r,s))}function k_(e,t,r,s){var i=Array.isArray(t),a=bt(t["!ref"]||"A1"),o,l="",d=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Ot(a)}for(var c=a.s.r;c<=a.e.r;++c){l=tr(c);for(var h=a.s.c;h<=a.e.c;++h){c===a.s.r&&(d[h]=cr(h)),o=d[h]+l;var x=i?(t[c]||[])[h]:t[o];x&&__(e,x,c,h)}}}function C_(e,t){for(var r=t||{},s=vr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ce(s,r.biff==4?1033:r.biff==3?521:9,Jc(e,16,r)),k_(s,e.Sheets[e.SheetNames[i]],i,r),Ce(s,10),s.end()}function A_(e,t,r){Ce(e,49,j2({sz:12,name:"Arial"},r))}function I_(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&Ce(e,1054,T2(i,t[i],r))})}function N_(e,t){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ce(e,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),g0(bt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ce(e,2152,r)}function F_(e,t){for(var r=0;r<16;++r)Ce(e,224,eu({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){Ce(e,224,eu(s,0,t))})}function R_(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];Ce(e,440,R2(s)),s[1].Tooltip&&Ce(e,2048,P2(s))}delete t["!links"]}function P_(e,t){if(t){var r=0;t.forEach(function(s,i){++r<=256&&s&&Ce(e,125,O2(Qo(i,s),i))})}}function D_(e,t,r,s,i){var a=16+Kn(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ce(e,513,us(r,s,a));return}if(t.bf)Ce(e,6,iE(t,r,s,i,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?br(pr(t.v)):t.v;Ce(e,515,A2(r,s,o,a));break;case"b":case"e":Ce(e,517,C2(r,s,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var l=nd(i.Strings,t.v,i.revStrings);Ce(e,253,S2(r,s,l,a))}else Ce(e,516,E2(r,s,(t.v||"").slice(0,255),a,i));break;default:Ce(e,513,us(r,s,a))}}function L_(e,t,r){var s=vr(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(a),c=t.biff==8,h,x="",u=[],p=bt(a["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}Ce(s,2057,Jc(r,16,t)),Ce(s,13,Dr(1)),Ce(s,12,Dr(100)),Ce(s,15,ur(!0)),Ce(s,17,ur(!1)),Ce(s,16,hs(.001)),Ce(s,95,ur(!0)),Ce(s,42,ur(!1)),Ce(s,43,ur(!1)),Ce(s,130,Dr(1)),Ce(s,128,k2()),Ce(s,131,ur(!1)),Ce(s,132,ur(!1)),c&&P_(s,a["!cols"]),Ce(s,512,_2(p,t)),c&&(a["!links"]=[]);for(var f=p.s.r;f<=p.e.r;++f){x=tr(f);for(var m=p.s.c;m<=p.e.c;++m){f===p.s.r&&(u[m]=cr(m)),h=u[m]+x;var v=d?(a[f]||[])[m]:a[h];v&&(D_(s,v,f,m,t),c&&v.l&&a["!links"].push([h,v.l]))}}var S=l.CodeName||l.name||i;return c&&Ce(s,574,w2((o.Views||[])[0])),c&&(a["!merges"]||[]).length&&Ce(s,229,F2(a["!merges"])),c&&R_(s,a),Ce(s,442,m0(S)),c&&N_(s,a),Ce(s,10),s.end()}function O_(e,t,r){var s=vr(),i=(e||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,d=r.biff==5;if(Ce(s,2057,Jc(e,5,r)),r.bookType=="xla"&&Ce(s,135),Ce(s,225,l?Dr(1200):null),Ce(s,193,l2(2)),d&&Ce(s,191),d&&Ce(s,192),Ce(s,226),Ce(s,92,g2("SheetJS",r)),Ce(s,66,Dr(l?1200:1252)),l&&Ce(s,353,Dr(0)),l&&Ce(s,448),Ce(s,317,B2(e.SheetNames.length)),l&&e.vbaraw&&Ce(s,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";Ce(s,442,m0(c))}Ce(s,156,Dr(17)),Ce(s,25,ur(!1)),Ce(s,18,ur(!1)),Ce(s,19,Dr(0)),l&&Ce(s,431,ur(!1)),l&&Ce(s,444,Dr(0)),Ce(s,61,b2()),Ce(s,64,ur(!1)),Ce(s,141,Dr(0)),Ce(s,34,ur(zT(e)=="true")),Ce(s,14,ur(!0)),l&&Ce(s,439,ur(!1)),Ce(s,218,Dr(0)),A_(s,e,r),I_(s,e.SSF,r),F_(s,r),l&&Ce(s,352,ur(!1));var h=s.end(),x=vr();l&&Ce(x,140,D2()),l&&r.Strings&&S_(x,252,v2(r.Strings)),Ce(x,10);var u=x.end(),p=vr(),g=0,f=0;for(f=0;f<e.SheetNames.length;++f)g+=(l?12:11)+(l?2:1)*e.SheetNames[f].length;var m=h.length+g+u.length;for(f=0;f<e.SheetNames.length;++f){var v=a[f]||{};Ce(p,133,y2({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[f]},r)),m+=t[f].length}var S=p.end();if(g!=S.length)throw new Error("BS8 "+g+" != "+S.length);var T=[];return h.length&&T.push(h),S.length&&T.push(S),u.length&&T.push(u),Zt(T)}function B_(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=wr(Ft)),e&&e.SSF&&(Vo(),Ho(e.SSF),r.revssf=Go(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,sd(r),r.cellXfs=[],Kn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=L_(i,r,e);return s.unshift(O_(e,s,r)),Zt(s)}function q0(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var i=Nr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return B_(e,t);case 4:case 3:case 2:return C_(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function M_(e,t,r,s){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){l=-1;break}l=i[c].e.r-i[c].s.r+1,d=i[c].e.c-i[c].s.c+1;break}if(!(l<0)){var h=ht({r,c:o}),x=s.dense?(e[r]||[])[o]:e[h],u=x&&x.v!=null&&(x.h||mw(x.w||(Nn(x),x.w)||""))||"",p={};l>1&&(p.rowspan=l),d>1&&(p.colspan=d),s.editable?u='<span contenteditable="true">'+u+"</span>":x&&(p["data-t"]=x&&x.t||"z",x.v!=null&&(p["data-v"]=x.v),x.z!=null&&(p["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+x.l.Target+'">'+u+"</a>")),p.id=(s.id||"sjs")+"-"+h,a.push(ke("td",u,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var $_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U_="</body></html>";function z_(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function W0(e,t){var r=t||{},s=r.header!=null?r.header:$_,i=r.footer!=null?r.footer:U_,a=[s],o=Nr(e["!ref"]);r.dense=Array.isArray(e),a.push(z_(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(M_(e,o,l,r));return a.push("</table>"+i),a.join("")}function H0(e,t,r){var s=r||{},i=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var o=typeof s.origin=="string"?Vt(s.origin):s.origin;i=o.r,a=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var h=Nr(e["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var x=[],u=0,p=e["!rows"]||(e["!rows"]=[]),g=0,f=0,m=0,v=0,S=0,T=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&f<d;++g){var y=l[g];if(ou(y)){if(s.display)continue;p[f]={hidden:!0}}var w=y.children;for(m=v=0;m<w.length;++m){var k=w[m];if(!(s.display&&ou(k))){var b=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):bw(k.innerHTML),j=k.getAttribute("data-z")||k.getAttribute("z");for(u=0;u<x.length;++u){var A=x[u];A.s.c==v+a&&A.s.r<f+i&&f+i<=A.e.r&&(v=A.e.c+1-a,u=-1)}T=+k.getAttribute("colspan")||1,((S=+k.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:f+i,c:v+a},e:{r:f+i+(S||1)-1,c:v+a+(T||1)-1}});var E={t:"s",v:b},C=k.getAttribute("data-t")||k.getAttribute("t")||"";b!=null&&(b.length==0?E.t=C||"z":s.raw||b.trim().length==0||C=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(_n(b))?isNaN(zi(b).getDate())||(E={t:"d",v:pr(b)},s.cellDates||(E={t:"n",v:br(E.v)}),E.z=s.dateNF||Ft[14]):E={t:"n",v:_n(b)})),E.z===void 0&&j!=null&&(E.z=j);var I="",F=k.getElementsByTagName("A");if(F&&F.length)for(var N=0;N<F.length&&!(F[N].hasAttribute("href")&&(I=F[N].getAttribute("href"),I.charAt(0)!="#"));++N);I&&I.charAt(0)!="#"&&(E.l={Target:I}),s.dense?(e[f+i]||(e[f+i]=[]),e[f+i][v+a]=E):e[ht({c:v+a,r:f+i})]=E,c.e.c<v+a&&(c.e.c=v+a),v+=T}}++f}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),c.e.r=Math.max(c.e.r,f-1+i),e["!ref"]=Ot(c),f>=d&&(e["!fullref"]=Ot((c.e.r=l.length-g+f-1+i,c))),e}function V0(e,t){var r=t||{},s=r.dense?[]:{};return H0(s,e,t)}function q_(e,t){return gs(V0(e,t),t)}function ou(e){var t="",r=W_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function W_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var H_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+t}}(),lu=function(){var e=function(a){return dt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,o,l){var d=[];d.push('      <table:table table:name="'+dt(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,h=0,x=Nr(a["!ref"]||"A1"),u=a["!merges"]||[],p=0,g=Array.isArray(a);if(a["!cols"])for(h=0;h<=x.e.c;++h)d.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var f="",m=a["!rows"]||[];for(c=0;c<x.s.r;++c)f=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+f+`></table:table-row>
`);for(;c<=x.e.r;++c){for(f=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+f+`>
`),h=0;h<x.s.c;++h)d.push(t);for(;h<=x.e.c;++h){var v=!1,S={},T="";for(p=0;p!=u.length;++p)if(!(u[p].s.c>h)&&!(u[p].s.r>c)&&!(u[p].e.c<h)&&!(u[p].e.r<c)){(u[p].s.c!=h||u[p].s.r!=c)&&(v=!0),S["table:number-columns-spanned"]=u[p].e.c-u[p].s.c+1,S["table:number-rows-spanned"]=u[p].e.r-u[p].s.r+1;break}if(v){d.push(r);continue}var y=ht({r:c,c:h}),w=g?(a[c]||[])[h]:a[y];if(w&&w.f&&(S["table:formula"]=dt(hE(w.f)),w.F&&w.F.slice(0,y.length)==y)){var k=Nr(w.F);S["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,S["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!w){d.push(t);continue}switch(w.t){case"b":T=w.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=w.v?"true":"false";break;case"n":T=w.w||String(w.v||0),S["office:value-type"]="float",S["office:value"]=w.v||0;break;case"s":case"str":T=w.v==null?"":w.v,S["office:value-type"]="string";break;case"d":T=w.w||pr(w.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=pr(w.v).toISOString(),S["table:style-name"]="ce1";break;default:d.push(t);continue}var b=e(T);if(w.l&&w.l.Target){var j=w.l.Target;j=j.charAt(0)=="#"?"#"+uE(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),b=ke("text:a",b,{"xlink:href":j.replace(/&/g,"&amp;")})}d.push("          "+ke("table:table-cell",ke("text:p",b,{}),S)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var x=c["!cols"][h];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Zc(x),x.ods=l;var u=c["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),a.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=d;var x=c["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),a.push(`  </style:style>
`),++d}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var d=[Bt],c=Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Wi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+h+`>
`),d.push(o0().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)d.push(s(o.Sheets[o.SheetNames[x]],o,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function G0(e,t){if(t.bookType=="fods")return lu(e,t);var r=zc(),s="",i=[],a=[];return s="mimetype",He(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",He(r,s,lu(e,t)),i.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",He(r,s,H_(e,t)),i.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",He(r,s,Bt+o0()),i.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",He(r,s,n2(a)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",He(r,s,t2(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function No(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function V_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(qi(e))}function G_(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Hn(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(i){r.set(i,s),s+=i.length}),r}function Y_(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function Hi(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],i=Hi(e,r),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Hi(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(s))}var c={data:l,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Qt(e){var t=[];return e.forEach(function(r,s){r.forEach(function(i){i.data&&(t.push(ot(s*8+i.type)),i.type==2&&t.push(ot(i.data.length)),t.push(i.data))})}),Hn(t)}function Ur(e){for(var t,r=[],s=[0];s[0]<e.length;){var i=Hi(e,s),a=zt(e.slice(s[0],s[0]+i));s[0]+=i;var o={id:Gs(a[1][0].data),messages:[]};a[2].forEach(function(l){var d=zt(l.data),c=Gs(d[3][0].data);o.messages.push({meta:d,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=a[3])!=null&&t[0]&&(o.merge=Gs(a[3][0].data)>>>0>0),r.push(o)}return r}function Rs(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:ot(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:ot(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:ot(o.data.length)}],s[2].push({data:Qt(o.meta),type:2})});var a=Qt(s);t.push(ot(a.length)),t.push(a),i.forEach(function(o){return t.push(o)})}),Hn(t)}function K_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Hi(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Hn(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(i.push(i[0].slice(-d)),c-=d;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-d,-d+c))}}var h=Hn(i);if(h.length!=s)throw new Error("Unexpected length: ".concat(h.length," != ").concat(s));return h}function zr(e){for(var t=[],r=0;r<e.length;){var s=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(K_(s,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Hn(t)}function Ps(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=ot(s),o=a.length;t.push(a),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=s}return Hn(t)}function Hl(e,t){var r=new Uint8Array(32),s=No(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Y_(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,s.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,i)}function Vl(e,t){var r=new Uint8Array(32),s=No(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,s.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,i)}function On(e){var t=zt(e);return Hi(t[1][0].data)}function X_(e,t,r){var s,i,a,o;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Gs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=No(e[7][0].data),h=0,x=[],u=No(e[4][0].data),p=0,g=[],f=0;f<t.length;++f){if(t[f]==null){c.setUint16(f*2,65535,!0),u.setUint16(f*2,65535);continue}c.setUint16(f*2,h,!0),u.setUint16(f*2,p,!0);var m,v;switch(typeof t[f]){case"string":m=Hl({t:"s",v:t[f]},r),v=Vl({t:"s",v:t[f]},r);break;case"number":m=Hl({t:"n",v:t[f]},r),v=Vl({t:"n",v:t[f]},r);break;case"boolean":m=Hl({t:"b",v:t[f]},r),v=Vl({t:"b",v:t[f]},r);break;default:throw new Error("Unsupported value "+t[f])}x.push(m),h+=m.length,g.push(v),p+=v.length,++d}for(e[2][0].data=ot(d);f<e[7][0].data.length/2;++f)c.setUint16(f*2,65535,!0),u.setUint16(f*2,65535,!0);return e[6][0].data=Hn(x),e[3][0].data=Hn(g),d}function Q_(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Nr(r["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ot(s)));var a=Fo(r,{range:s,header:1}),o=["~Sh33tJ5~"];a.forEach(function(q){return q.forEach(function(B){typeof B=="string"&&o.push(B)})});var l={},d=[],c=ft.read(t.numbers,{type:"base64"});c.FileIndex.map(function(q,B){return[q,c.FullPaths[B]]}).forEach(function(q){var B=q[0],P=q[1];if(B.type==2&&B.name.match(/\.iwa/)){var Z=B.content,se=zr(Z),ie=Ur(se);ie.forEach(function(de){d.push(de.id),l[de.id]={deps:[],location:P,type:Gs(de.messages[0].meta[1][0].data)}})}}),d.sort(function(q,B){return q-B});var h=d.filter(function(q){return q>1}).map(function(q){return[q,ot(q)]});c.FileIndex.map(function(q,B){return[q,c.FullPaths[B]]}).forEach(function(q){var B=q[0];if(q[1],!!B.name.match(/\.iwa/)){var P=Ur(zr(B.content));P.forEach(function(Z){Z.messages.forEach(function(se){h.forEach(function(ie){Z.messages.some(function(de){return Gs(de.meta[1][0].data)!=11006&&G_(de.data,ie[1])})&&l[ie[0]].deps.push(Z.id)})})})}});for(var x=ft.find(c,l[1].location),u=Ur(zr(x.content)),p,g=0;g<u.length;++g){var f=u[g];f.id==1&&(p=f)}var m=On(zt(p.messages[0].data)[1][0].data);for(x=ft.find(c,l[m].location),u=Ur(zr(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);for(m=On(zt(p.messages[0].data)[2][0].data),x=ft.find(c,l[m].location),u=Ur(zr(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);for(m=On(zt(p.messages[0].data)[2][0].data),x=ft.find(c,l[m].location),u=Ur(zr(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);var v=zt(p.messages[0].data);{v[6][0].data=ot(s.e.r+1),v[7][0].data=ot(s.e.c+1);var S=On(v[46][0].data),T=ft.find(c,l[S].location),y=Ur(zr(T.content));{for(var w=0;w<y.length&&y[w].id!=S;++w);if(y[w].id!=S)throw"Bad ColumnRowUIDMapArchive";var k=zt(y[w].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var b=0;b<=s.e.c;++b){var j=[];j[1]=j[2]=[{type:0,data:ot(b+420690)}],k[1].push({type:2,data:Qt(j)}),k[2].push({type:0,data:ot(b)}),k[3].push({type:0,data:ot(b)})}k[4]=[],k[5]=[],k[6]=[];for(var A=0;A<=s.e.r;++A)j=[],j[1]=j[2]=[{type:0,data:ot(A+726270)}],k[4].push({type:2,data:Qt(j)}),k[5].push({type:0,data:ot(A)}),k[6].push({type:0,data:ot(A)});y[w].messages[0].data=Qt(k)}T.content=Ps(Rs(y)),T.size=T.content.length,delete v[46];var E=zt(v[4][0].data);{E[7][0].data=ot(s.e.r+1);var C=zt(E[1][0].data),I=On(C[2][0].data);T=ft.find(c,l[I].location),y=Ur(zr(T.content));{if(y[0].id!=I)throw"Bad HeaderStorageBucket";var F=zt(y[0].messages[0].data);for(A=0;A<a.length;++A){var N=zt(F[2][0].data);N[1][0].data=ot(A),N[4][0].data=ot(a[A].length),F[2][A]={type:F[2][0].type,data:Qt(N)}}y[0].messages[0].data=Qt(F)}T.content=Ps(Rs(y)),T.size=T.content.length;var z=On(E[2][0].data);T=ft.find(c,l[z].location),y=Ur(zr(T.content));{if(y[0].id!=z)throw"Bad HeaderStorageBucket";for(F=zt(y[0].messages[0].data),b=0;b<=s.e.c;++b)N=zt(F[2][0].data),N[1][0].data=ot(b),N[4][0].data=ot(s.e.r+1),F[2][b]={type:F[2][0].type,data:Qt(N)};y[0].messages[0].data=Qt(F)}T.content=Ps(Rs(y)),T.size=T.content.length;var U=On(E[4][0].data);(function(){for(var q=ft.find(c,l[U].location),B=Ur(zr(q.content)),P,Z=0;Z<B.length;++Z){var se=B[Z];se.id==U&&(P=se)}var ie=zt(P.messages[0].data);{ie[3]=[];var de=[];o.forEach(function(ae,ge){de[1]=[{type:0,data:ot(ge)}],de[2]=[{type:0,data:ot(1)}],de[3]=[{type:2,data:V_(ae)}],ie[3].push({type:2,data:Qt(de)})})}P.messages[0].data=Qt(ie);var G=Rs(B),V=Ps(G);q.content=V,q.size=q.content.length})();var R=zt(E[3][0].data);{var O=R[1][0];delete R[2];var X=zt(O.data);{var re=On(X[2][0].data);(function(){for(var q=ft.find(c,l[re].location),B=Ur(zr(q.content)),P,Z=0;Z<B.length;++Z){var se=B[Z];se.id==re&&(P=se)}var ie=zt(P.messages[0].data);{delete ie[6],delete R[7];var de=new Uint8Array(ie[5][0].data);ie[5]=[];for(var G=0,V=0;V<=s.e.r;++V){var ae=zt(de);G+=X_(ae,a[V],o),ae[1][0].data=ot(V),ie[5].push({data:Qt(ae),type:2})}ie[1]=[{type:0,data:ot(s.e.c+1)}],ie[2]=[{type:0,data:ot(s.e.r+1)}],ie[3]=[{type:0,data:ot(G)}],ie[4]=[{type:0,data:ot(s.e.r+1)}]}P.messages[0].data=Qt(ie);var ge=Rs(B),te=Ps(ge);q.content=te,q.size=q.content.length})()}O.data=Qt(X)}E[3][0].data=Qt(R)}v[4][0].data=Qt(E)}p.messages[0].data=Qt(v);var ee=Rs(u),D=Ps(ee);return x.content=D,x.size=x.content.length,c}function J_(e){return function(r){for(var s=0;s!=e.length;++s){var i=e[s];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function sd(e){J_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Z_(e,t){return t.bookType=="ods"?G0(e,t):t.bookType=="numbers"?Q_(e,t):t.bookType=="xlsb"?ek(e,t):tk(e,t)}function ek(e,t){$s=1024,e&&!e.SSF&&(e.SSF=wr(Ft)),e&&e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ii?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=A0.indexOf(t.bookType)>-1,i=s0();sd(t=t||{});var a=zc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",He(a,o,l0(e.Props,t)),i.coreprops.push(o),lt(t.rels,2,o,rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,He(a,o,d0(e.Props)),i.extprops.push(o),lt(t.rels,3,o,rt.EXT_PROPS),e.Custprops!==e.Props&&rr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",He(a,o,h0(e.Custprops)),i.custprops.push(o),lt(t.rels,4,o,rt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],u=(x||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,He(a,o,n_(l-1,o,t,e,h)),i.sheets.push(o),lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(x){var p=x["!comments"],g=!1,f="";p&&p.length>0&&(f="xl/comments"+l+"."+r,He(a,f,a_(p,f)),i.comments.push(f),lt(h,-1,"../comments"+l+"."+r,rt.CMNT),g=!0),x["!legacy"]&&g&&He(a,"xl/drawings/vmlDrawing"+l+".vml",k0(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}h["!id"].rId1&&He(a,a0(o),Hs(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,He(a,o,i_(t.Strings,o,t)),i.strs.push(o),lt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),o="xl/workbook."+r,He(a,o,r_(e,o)),i.workbooks.push(o),lt(t.rels,1,o,rt.WB),o="xl/theme/theme1.xml",He(a,o,T0(e.Themes,t)),i.themes.push(o),lt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),o="xl/styles."+r,He(a,o,s_(e,o,t)),i.styles.push(o),lt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",He(a,o,e.vbaraw),i.vba.push(o),lt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),o="xl/metadata."+r,He(a,o,o_(o)),i.metadata.push(o),lt(t.wbrels,-1,"metadata."+r,rt.XLMETA),He(a,"[Content_Types].xml",i0(i,t)),He(a,"_rels/.rels",Hs(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Hs(t.wbrels)),delete t.revssf,delete t.ssf,a}function tk(e,t){$s=1024,e&&!e.SSF&&(e.SSF=wr(Ft)),e&&e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ii?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=A0.indexOf(t.bookType)>-1,i=s0();sd(t=t||{});var a=zc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",He(a,o,l0(e.Props,t)),i.coreprops.push(o),lt(t.rels,2,o,rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,He(a,o,d0(e.Props)),i.extprops.push(o),lt(t.rels,3,o,rt.EXT_PROPS),e.Custprops!==e.Props&&rr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",He(a,o,h0(e.Custprops)),i.custprops.push(o),lt(t.rels,4,o,rt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var x={"!id":{}},u=e.Sheets[e.SheetNames[l-1]],p=(u||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,He(a,o,B0(l-1,t,e,x)),i.sheets.push(o),lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(u){var g=u["!comments"],f=!1,m="";if(g&&g.length>0){var v=!1;g.forEach(function(S){S[1].forEach(function(T){T.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+l+"."+r,He(a,m,Fj(g,h,t)),i.threadedcomments.push(m),lt(x,-1,"../threadedComments/threadedComment"+l+"."+r,rt.TCMNT)),m="xl/comments"+l+"."+r,He(a,m,C0(g)),i.comments.push(m),lt(x,-1,"../comments"+l+"."+r,rt.CMNT),f=!0}u["!legacy"]&&f&&He(a,"xl/drawings/vmlDrawing"+l+".vml",k0(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}x["!id"].rId1&&He(a,a0(o),Hs(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,He(a,o,v0(t.Strings,t)),i.strs.push(o),lt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),o="xl/workbook."+r,He(a,o,U0(e)),i.workbooks.push(o),lt(t.rels,1,o,rt.WB),o="xl/theme/theme1.xml",He(a,o,T0(e.Themes,t)),i.themes.push(o),lt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),o="xl/styles."+r,He(a,o,S0(e,t)),i.styles.push(o),lt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",He(a,o,e.vbaraw),i.vba.push(o),lt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),o="xl/metadata."+r,He(a,o,_0()),i.metadata.push(o),lt(t.wbrels,-1,"metadata."+r,rt.XLMETA),h.length>1&&(o="xl/persons/person.xml",He(a,o,Rj(h)),i.people.push(o),lt(t.wbrels,-1,"persons/person.xml",rt.PEOPLE)),He(a,"[Content_Types].xml",i0(i,t)),He(a,"_rels/.rels",Hs(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Hs(t.wbrels)),delete t.revssf,delete t.ssf,a}function rk(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=In(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Y0(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Zi(t.file,ft.write(e,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ft.write(e,t)}function nk(e,t){var r=wr(t||{}),s=Z_(e,r);return sk(s,r)}function sk(e,t){var r={},s=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ft.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Wo(i))}return t.password&&typeof encrypt_agile<"u"?Y0(encrypt_agile(i,t.password),t):t.type==="file"?Zi(t.file,i):t.type=="string"?_i(i):i}function ik(e,t){var r=t||{},s=w_(e,r);return Y0(s,r)}function sn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Ui(qi(s));case"binary":return qi(s);case"string":return e;case"file":return Zi(t.file,s,"utf8");case"buffer":return st?Rn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):sn(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ak(e,t){switch(t.type){case"base64":return Ui(e);case"binary":return e;case"string":return e;case"file":return Zi(t.file,e,"binary");case"buffer":return st?Rn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ba(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Ui(r):t.type=="string"?_i(r):r;case"file":return Zi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function K0(e,t){Pb(),HT(e);var r=wr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=K0(e,r);return r.type="array",Wo(s)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sn(v_(e,r),r);case"slk":case"sylk":return sn(z2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return sn(W0(e.Sheets[e.SheetNames[i]],r),r);case"txt":return ak(X0(e.Sheets[e.SheetNames[i]],r),r);case"csv":return sn(id(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return sn(q2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Ba(U2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return sn(W2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return sn(Q2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return sn(y0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return sn(G0(e,r),r);case"wk1":return Ba(tu.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Ba(tu.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ba(q0(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ik(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nk(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ok(e,t,r,s,i,a,o,l){var d=tr(r),c=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),x=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[r][p]:e[s[p]+d];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[p]!=null&&(u[a[p]]=c);continue}var f=g.v;switch(g.t){case"z":if(f==null)break;continue;case"e":f=f==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(f==null)if(g.t=="e"&&f===null)u[a[p]]=null;else if(c!==void 0)u[a[p]]=c;else if(h&&f===null)u[a[p]]=null;else continue;else u[a[p]]=h&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?f:Nn(g,f,l);f!=null&&(x=!1)}}return{row:u,isempty:x}}function Fo(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,i=1,a=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},h=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof h){case"string":d=bt(h);break;case"number":d=bt(e["!ref"]),d.s.r=h;break;default:d=h}s>0&&(i=0);var x=tr(d.s.r),u=[],p=[],g=0,f=0,m=Array.isArray(e),v=d.s.r,S=0,T={};m&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(S=d.s.c;S<=d.e.c;++S)if(!(y[S]||{}).hidden)switch(u[S]=cr(S),r=m?e[v][S]:e[u[S]+x],s){case 1:a[S]=S-d.s.c;break;case 2:a[S]=u[S];break;case 3:a[S]=c.header[S-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Nn(r,null,c),f=T[o]||0,!f)T[o]=1;else{do l=o+"_"+f++;while(T[l]);T[o]=f,T[l]=1}a[S]=l}for(v=d.s.r+i;v<=d.e.r;++v)if(!(w[v]||{}).hidden){var k=ok(e,d,v,u,s,a,m,c);(k.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var cu=/"/g;function lk(e,t,r,s,i,a,o,l){for(var d=!0,c=[],h="",x=tr(r),u=t.s.c;u<=t.e.c;++u)if(s[u]){var p=l.dense?(e[r]||[])[u]:e[s[u]+x];if(p==null)h="";else if(p.v!=null){d=!1,h=""+(l.rawNumbers&&p.t=="n"?p.v:Nn(p,null,l));for(var g=0,f=0;g!==h.length;++g)if((f=h.charCodeAt(g))===i||f===a||f===34||l.forceQuotes){h='"'+h.replace(cu,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(d=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(cu,'""')+'"')):h="";c.push(h)}return l.blankrows===!1&&d?null:c.join(o)}function id(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var i=bt(e["!ref"]),a=s.FS!==void 0?s.FS:",",o=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,d=l.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),h="",x=[];s.dense=Array.isArray(e);for(var u=s.skipHidden&&e["!cols"]||[],p=s.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(u[g]||{}).hidden||(x[g]=cr(g));for(var f=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||(h=lk(e,i,m,x,o,d,a,s),h!=null&&(s.strip&&(h=h.replace(c,"")),(h||s.blankrows!==!1)&&r.push((f++?l:"")+h)));return delete s.dense,r.join("")}function X0(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=id(e,t);return r}function ck(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var i=bt(e["!ref"]),a="",o=[],l,d=[],c=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=cr(l);for(var h=i.s.r;h<=i.e.r;++h)for(a=tr(h),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+a,r=c?(e[h]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function Q0(e,t,r){var s=r||{},i=+!s.skipHeader,a=e||{},o=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Vt(s.origin):s.origin;o=d.r,l=d.c}var c,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(a["!ref"]){var x=bt(a["!ref"]);h.e.c=Math.max(h.e.c,x.e.c),h.e.r=Math.max(h.e.r,x.e.r),o==-1&&(o=x.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var u=s.header||[],p=0;t.forEach(function(f,m){rr(f).forEach(function(v){(p=u.indexOf(v))==-1&&(u[p=u.length]=v);var S=f[v],T="z",y="",w=ht({c:l+p,r:o+m+i});c=Vi(a,w),S&&typeof S=="object"&&!(S instanceof Date)?a[w]=S:(typeof S=="number"?T="n":typeof S=="boolean"?T="b":typeof S=="string"?T="s":S instanceof Date?(T="d",s.cellDates||(T="n",S=br(S)),y=s.dateNF||Ft[14]):S===null&&s.nullError&&(T="e",S=0),c?(c.t=T,c.v=S,delete c.w,delete c.R,y&&(c.z=y)):a[w]=c={t:T,v:S},y&&(c.z=y))})}),h.e.c=Math.max(h.e.c,l+u.length-1);var g=tr(o);if(i)for(p=0;p<u.length;++p)a[cr(p+l)+g]={t:"s",v:u[p]};return a["!ref"]=Ot(h),a}function dk(e,t){return Q0(null,e,t)}function Vi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Vt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Vi(e,ht(t)):Vi(e,ht({r:t,c:r||0}))}function hk(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function uk(){return{SheetNames:[],Sheets:{}}}function fk(e,t,r,s){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if($0(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function xk(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=hk(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function pk(e,t){return e.z=t,e}function J0(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mk(e,t,r){return J0(e,"#"+t,r)}function gk(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yk(e,t,r,s){for(var i=typeof t!="string"?t:bt(t),a=typeof t=="string"?t:Ot(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var d=Vi(e,o,l);d.t="n",d.F=a,delete d.v,o==i.s.r&&l==i.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Gl={encode_col:cr,encode_row:tr,encode_cell:ht,encode_range:Ot,decode_col:Yc,decode_row:Gc,split_cell:Pw,decode_cell:Vt,decode_range:Nr,format_cell:Nn,sheet_add_aoa:Jf,sheet_add_json:Q0,sheet_add_dom:H0,aoa_to_sheet:ti,json_to_sheet:dk,table_to_sheet:V0,table_to_book:q_,sheet_to_csv:id,sheet_to_txt:X0,sheet_to_json:Fo,sheet_to_html:W0,sheet_to_formulae:ck,sheet_to_row_object_array:Fo,sheet_get_cell:Vi,book_new:uk,book_append_sheet:fk,book_set_sheet_visibility:xk,cell_set_number_format:pk,cell_set_hyperlink:J0,cell_set_internal_link:mk,cell_add_comment:gk,sheet_set_array_formula:yk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Z0={exports:{}};(function(e,t){(function(r,s){s()})(Os,function(){function r(c,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function s(c,h,x){var u=new XMLHttpRequest;u.open("GET",c),u.responseType="blob",u.onload=function(){d(u.response,h,x)},u.onerror=function(){console.error("could not download file")},u.send()}function i(c){var h=new XMLHttpRequest;h.open("HEAD",c,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Os=="object"&&Os.global===Os?Os:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,h,x){var u=o.URL||o.webkitURL,p=document.createElement("a");h=h||c.name||"download",p.download=h,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?a(p):i(p.href)?s(c,h,x):a(p,p.target="_blank")):(p.href=u.createObjectURL(c),setTimeout(function(){u.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,h,x){if(h=h||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,x),h);else if(i(c))s(c,h,x);else{var u=document.createElement("a");u.href=c,u.target="_blank",setTimeout(function(){a(u)})}}:function(c,h,x,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof c=="string")return s(c,h,x);var p=c.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||p&&g||l)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var T=m.result;T=f?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=T:location=T,u=null},m.readAsDataURL(c)}else{var v=o.URL||o.webkitURL,S=v.createObjectURL(c);u?u.location=S:location.href=S,u=null,setTimeout(function(){v.revokeObjectURL(S)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})})(Z0);var vk=Z0.exports;const{Title:bk,Text:Ds}=Le,{Option:rn}=Pe,{RangePicker:wk}=xs,jk=({exhibitionId:e,exhibitions:t,exhibitionsLoading:r,onExhibitionChange:s,typeFilter:i,setTypeFilter:a,bookingStatusFilter:o,setBookingStatusFilter:l,searchQuery:d,setSearchQuery:c,dateRange:h,setDateRange:x,resetFilters:u})=>{var f,m;const p=v=>{c(v.target.value)},g=v=>{x(v)};return n.jsxs(ue,{className:"amenities-filters",children:[n.jsx(bk,{level:5,className:"filter-heading",children:"Filters"}),n.jsxs(Ae,{gutter:[16,16],children:[n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Exhibition"}),n.jsx(Pe,{placeholder:"Select an exhibition",style:{width:"100%"},loading:r,onChange:s,value:e,children:t.map(v=>n.jsx(rn,{value:v._id,children:v.name},v._id))})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Amenity Type"}),n.jsxs(Pe,{mode:"multiple",placeholder:"Select types",style:{width:"100%"},value:i,onChange:a,maxTagCount:2,children:[n.jsx(rn,{value:"facility",children:"Facility"}),n.jsx(rn,{value:"service",children:"Service"}),n.jsx(rn,{value:"equipment",children:"Equipment"}),n.jsx(rn,{value:"other",children:"Other"})]})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Booking Status"}),n.jsxs(Pe,{mode:"multiple",placeholder:"Select statuses",style:{width:"100%"},value:o,onChange:l,maxTagCount:2,children:[n.jsx(rn,{value:"confirmed",children:"Confirmed"}),n.jsx(rn,{value:"approved",children:"Approved"}),n.jsx(rn,{value:"pending",children:"Pending"}),n.jsx(rn,{value:"rejected",children:"Rejected"}),n.jsx(rn,{value:"cancelled",children:"Cancelled"})]})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Search"}),n.jsx(fe,{placeholder:"Search amenities",prefix:n.jsx(An,{}),value:d,onChange:p,allowClear:!0})]})}),n.jsx(Q,{xs:24,md:16,lg:12,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Booking Date Range"}),n.jsx(wk,{style:{width:"100%"},onChange:g,value:h})]})}),n.jsx(Q,{xs:24,md:8,lg:12,children:n.jsx("div",{className:"filter-group",style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%"},children:n.jsxs(xe,{children:[n.jsx(ne,{icon:n.jsx(Xs,{}),onClick:u,children:"Reset"}),n.jsx(ne,{type:"primary",icon:n.jsx(Gi,{}),children:"Apply Filters"})]})})})]}),(i.length>0||o.length>0||d||h)&&n.jsxs(n.Fragment,{children:[n.jsx(nt,{className:"filter-divider"}),n.jsxs("div",{children:[n.jsx(Ds,{className:"filter-label",children:"Active Filters:"}),n.jsxs("div",{style:{marginTop:8},children:[i.map(v=>n.jsxs(Te,{closable:!0,onClose:()=>a(i.filter(S=>S!==v)),className:`amenity-tag amenity-tag-${v}`,children:["Type: ",v]},`type-${v}`)),o.map(v=>n.jsxs(Te,{closable:!0,onClose:()=>l(o.filter(S=>S!==v)),color:"blue",children:["Status: ",v]},`status-${v}`)),d&&n.jsxs(Te,{closable:!0,onClose:()=>c(""),color:"purple",children:["Search: ",d]}),h&&n.jsxs(Te,{closable:!0,onClose:()=>x(null),color:"green",children:["Date Range: ",(f=h[0])==null?void 0:f.format("MMM DD, YYYY")," - ",(m=h[1])==null?void 0:m.format("MMM DD, YYYY")]})]})]})]})]})},{Text:o4}=Le,Sk=({basicAmenities:e,extraAmenities:t,bookedStalls:r,calculatedAmenities:s})=>n.jsxs(Ae,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(ue,{className:"stats-card stats-primary",bordered:!1,children:[n.jsx(Ro,{style:{fontSize:24,color:"#1890ff"}}),n.jsx("div",{className:"stats-value",children:e.length}),n.jsx("div",{className:"stats-label",children:"Basic Amenities"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(ue,{className:"stats-card stats-secondary",bordered:!1,children:[n.jsx(ms,{style:{fontSize:24,color:"#52c41a"}}),n.jsx("div",{className:"stats-value",children:t.length}),n.jsx("div",{className:"stats-label",children:"Extra Amenities"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(ue,{className:"stats-card stats-tertiary",bordered:!1,children:[n.jsx(ho,{style:{fontSize:24,color:"#fa8c16"}}),n.jsx("div",{className:"stats-value",children:r}),n.jsx("div",{className:"stats-label",children:"Booked Stalls"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(ue,{className:"stats-card stats-quaternary",bordered:!1,children:[n.jsx(Yx,{style:{fontSize:24,color:"#722ed1"}}),n.jsx("div",{className:"stats-value",children:s}),n.jsx("div",{className:"stats-label",children:"Calculated Amenities"})]})})]}),{Text:Sn,Title:du}=Le,hu=e=>{switch(e){case"facility":return{color:"#e6f7ff",borderColor:"#91d5ff",textColor:"#1890ff"};case"service":return{color:"#f6ffed",borderColor:"#b7eb8f",textColor:"#52c41a"};case"equipment":return{color:"#fff7e6",borderColor:"#ffd591",textColor:"#fa8c16"};default:return{color:"#f9f0ff",borderColor:"#d3adf7",textColor:"#722ed1"}}},Yl=({title:e,amenities:t,loading:r,onExport:s,isDynamicColumns:i=!1,isCalculated:a=!1,exhibitionId:o,amenityViewType:l="all"})=>{const[d,c]=_.useState([]),[h,x]=_.useState([]),[u,p]=_.useState(!1),g=_.useMemo(()=>!a||l==="all"?t:l==="basic"?t.filter(w=>w.hasOwnProperty("calculatedQuantity")||w.hasOwnProperty("perSqm")):l==="extra"?t.filter(w=>w.hasOwnProperty("rate")&&!w.hasOwnProperty("perSqm")):t,[t,a,l]);_.useEffect(()=>{if(!o){x([]),p(!1);return}p(!0),setTimeout(()=>{p(!1)},500)},[o]);const f=()=>{const w=new Map;return g.forEach(b=>{var j,A;if(b.stallId&&b.stallNumber){w.has(b.stallId)||w.set(b.stallId,{key:b.stallId,companyName:b.exhibitorName||"Unknown",stallNumber:b.stallNumber,dimension:b.dimensions?`${b.dimensions.width}x${b.dimensions.height}m`:"-",stallType:b.stallType||"-",area:b.area||((j=b.dimensions)!=null&&j.width&&((A=b.dimensions)!=null&&A.height)?b.dimensions.width*b.dimensions.height:"-"),bookingDate:b.bookingDate?new Date(b.bookingDate).toISOString().slice(0,10):"-",status:b.bookingStatus||"-",amenities:{}});const E=w.get(b.stallId);if(b.hasOwnProperty("calculatedQuantity"))E.amenities[b.name]=b.calculatedQuantity;else if(b.hasOwnProperty("perSqm")){const C=typeof E.area=="number"?E.area:0,I=Math.floor(C/b.perSqm)*b.quantity;E.amenities[b.name]=I>0?I:b.quantity}else if(b.hasOwnProperty("booked")&&b.booked){let C=1;typeof b.quantity=="number"?C=b.quantity:typeof b.quantity=="string"&&(C=parseInt(b.quantity,10),isNaN(C)&&(C=1)),E.amenities[b.name]=C}else b.hasOwnProperty("rate")&&(E.amenities[b.name]=0)}}),Array.from(w.values()).filter(b=>Object.keys(b.amenities).length>0)},m=()=>{const w=new Set;return g.forEach(k=>{const b=j=>a?!0:e.toLowerCase().includes("basic")?j.hasOwnProperty("perSqm"):e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra")?j.hasOwnProperty("rate"):!0;k.name&&b(k)&&w.add(k.name)}),Array.from(w)},v=()=>{const w=[{title:"Company Name",dataIndex:"companyName",key:"companyName",fixed:"left",width:180,render:A=>n.jsx(Sn,{strong:!0,children:A}),sorter:(A,E)=>A.companyName.localeCompare(E.companyName)},{title:"Stall No.",dataIndex:"stallNumber",key:"stallNumber",width:100,render:A=>n.jsx(xr,{status:"success",text:A}),sorter:(A,E)=>A.stallNumber.localeCompare(E.stallNumber)},{title:"Dimension",dataIndex:"dimension",key:"dimension",width:120},{title:"Stall Type",dataIndex:"stallType",key:"stallType",width:120},{title:"Area (SQM)",dataIndex:"area",key:"area",width:100,render:A=>typeof A=="number"?A.toFixed(2):A,sorter:(A,E)=>{const C=typeof A.area=="number"?A.area:0,I=typeof E.area=="number"?E.area:0;return C-I}}],b=m().map(A=>({title:A,dataIndex:["amenities",A],key:A,width:100,render:E=>E==null?"-":E===0?n.jsx(Sn,{type:"secondary",children:"0"}):E===""?n.jsx(xr,{status:"success"}):n.jsx(Sn,{strong:!0,children:E}),sorter:(E,C)=>{const I=E.amenities[A]||0,F=C.amenities[A]||0;return I-F}})),j={title:"Actions",key:"actions",width:80,fixed:"right",render:(A,E)=>n.jsx(Vn,{overlay:n.jsxs(lr,{children:[n.jsx(lr.Item,{icon:n.jsx(hn,{}),children:"View Details"},"view"),n.jsx(lr.Item,{icon:n.jsx(as,{}),children:"Edit"},"edit"),n.jsx(lr.Item,{icon:n.jsx(Fi,{}),children:"Settings"},"settings")]}),trigger:["click"],children:n.jsx(ne,{type:"text",icon:n.jsx(Kx,{})})})};return[...w,...b,j]},S=w=>{c(w)},T=f(),y=w=>n.jsxs("div",{style:{padding:"20px"},children:[n.jsx(du,{level:5,children:"Stall Details"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:[Object.entries(w).map(([k,b])=>["key","amenities"].includes(k)?null:n.jsxs("div",{style:{marginBottom:"8px"},children:[n.jsxs(Sn,{type:"secondary",style:{fontSize:"12px"},children:[k.charAt(0).toUpperCase()+k.slice(1).replace(/([A-Z])/g," $1"),":"]}),n.jsx("div",{children:n.jsx(Sn,{strong:!0,children:b==null?"-":typeof b=="object"?JSON.stringify(b):String(b)})})]},k)),n.jsxs("div",{style:{marginBottom:"8px",gridColumn:"1 / -1"},children:[n.jsx(Sn,{type:"secondary",style:{fontSize:"12px"},children:"Amenities:"}),n.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},children:Object.entries(w.amenities||{}).map(([k,b])=>n.jsxs(Te,{color:"blue",children:[k,": ",b===""?"Available":b]},k))})]})]})]});return n.jsx(ue,{className:"amenities-card",title:n.jsxs(xe,{children:[n.jsx(du,{level:5,style:{margin:0},children:e}),a&&n.jsxs(n.Fragment,{children:[n.jsx(Te,{color:"green",children:"Calculated"}),l==="basic"&&n.jsx(Te,{color:"blue",children:"Basic Amenities"}),l==="extra"&&n.jsx(Te,{color:"purple",children:"Extra Amenities"}),l==="all"&&n.jsx(Te,{color:"orange",children:"All Amenities"})]})]}),extra:n.jsx(xe,{children:n.jsx(ne,{type:"primary",icon:n.jsx(Po,{}),onClick:s,disabled:g.length===0,children:"Export"})}),children:g.length===0?n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"No amenities data available"}):e.toLowerCase().includes("basic")&&!a?n.jsx(tt,{dataSource:g.map((w,k)=>({key:w._id||w.id||`basic-${k}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,k)=>n.jsxs(xe,{children:[n.jsx(Sn,{strong:!0,children:w}),n.jsx(Te,{color:hu(k.type).textColor,children:k.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Per SQM",dataIndex:"perSqm",key:"perSqm",render:w=>w?`1 per ${w} sqm`:"-"},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:w=>n.jsx(Te,{color:"blue",children:w})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):(e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra"))&&!a?n.jsx(tt,{dataSource:g.map((w,k)=>({key:w._id||w.id||`extra-${k}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,k)=>n.jsxs(xe,{children:[n.jsx(Sn,{strong:!0,children:w}),n.jsx(Te,{color:hu(k.type).textColor,children:k.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Rate",dataIndex:"rate",key:"rate",render:w=>n.jsxs(Sn,{style:{color:"#1890ff"},children:["",w.toLocaleString()]})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):T.length===0?n.jsx(kt,{message:"No stall data available",description:"Amenities exist but could not be linked to stalls. Make sure stalls are booked and have amenities assigned.",type:"info",showIcon:!0}):n.jsx(tt,{dataSource:T,columns:v(),loading:r||u,pagination:{pageSize:10},className:"amenities-table",scroll:{x:"max-content"},expandable:{expandedRowKeys:d,onExpandedRowsChange:S,expandedRowRender:y}})})},{Title:Ek,Text:uu}=Le,{TabPane:l4}=Kt,Kl=(e,t)=>{const r=Gl.json_to_sheet(e),s=Gl.book_new();Gl.book_append_sheet(s,r,"Amenities");const i=K0(s,{bookType:"xlsx",type:"array"}),a=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});vk.saveAs(a,`${t}.xlsx`)},Tk=()=>{const e=it(),{message:t}=Xt.useApp(),{exhibitions:r,loading:s}=$e(ie=>ie.exhibition),{bookings:i,loading:a}=$e(ie=>ie.booking),[o,l]=_.useState(null),[d,c]=_.useState([]),[h,x]=_.useState([]),[u,p]=_.useState([]),[g,f]=_.useState([]),[m,v]=_.useState(!1),[S,T]=_.useState({current:1,pageSize:10,total:0}),[y,w]=_.useState([]),[k,b]=_.useState([]),[j,A]=_.useState(""),[E,C]=_.useState(null),[I,F]=_.useState(0),[N,z]=_.useState(0),[U,R]=_.useState("basic"),[O,X]=_.useState("basic");_.useEffect(()=>{e(Or()),e(Mn())},[e]);const re=async(ie,de=1,G=10)=>{try{v(!0);const V=await _e.get("/bookings",{params:{exhibitionId:ie,includeDetails:!0,page:de,limit:G}});if(V&&V.data){const ae=V.data.data.filter(ge=>ge.exhibitionId._id===ie&&["confirmed","approved"].includes(ge.status));f(ae),T({current:V.data.pagination.page,pageSize:V.data.pagination.limit,total:V.data.pagination.total})}else f([]),T({current:1,pageSize:10,total:0})}catch(V){console.error("Error fetching complete booking data:",V),f([]),T({current:1,pageSize:10,total:0})}finally{v(!1)}};_.useEffect(()=>{if(o&&r.length>0){const ie=r.find(de=>de._id===o);ie&&(c(ie.basicAmenities||[]),x(ie.amenities||[]),re(o,S.current,S.pageSize))}else c([]),x([]),p([]),F(0),z(0),f([])},[o,r]),_.useEffect(()=>{if(o&&r.length>0&&g.length>0){const ie=r.find(de=>de._id===o);if(ie){const de=g.flatMap(ge=>ge.stallIds.map(te=>({stallId:te._id,stallNumber:te.number,bookingId:ge._id,exhibitorName:ge.companyName,bookingDate:ge.createdAt,dimensions:te.dimensions,area:te.dimensions.width*te.dimensions.height,status:ge.status}))),G=g.flatMap(ge=>!ge.basicAmenities||ge.basicAmenities.length===0?ge.stallIds.flatMap(te=>{const be=te.dimensions.width*te.dimensions.height;return(ie.basicAmenities||[]).map(Ie=>{const ye=Math.floor(be/Ie.perSqm)*Ie.quantity;return{...Ie,calculatedQuantity:ye>0?ye:Ie.quantity,stallId:te._id,stallNumber:te.number,bookingId:ge._id,exhibitorId:ge.exhibitorId||"",exhibitorName:ge.companyName,bookingDate:ge.createdAt,dimensions:te.dimensions,area:be,bookingStatus:ge.status}})}):ge.basicAmenities.flatMap(te=>ge.stallIds.map(be=>({...te,stallId:be._id,stallNumber:be.number,bookingId:ge._id,exhibitorId:ge.exhibitorId||"",exhibitorName:ge.companyName,bookingDate:ge.createdAt,dimensions:be.dimensions,area:be.dimensions.width*be.dimensions.height,bookingStatus:ge.status})))),V=g.flatMap(ge=>!ge.extraAmenities||ge.extraAmenities.length===0?[]:ge.extraAmenities.flatMap(te=>ge.stallIds.map(be=>({...te,booked:!0,stallId:be._id,stallNumber:be.number,bookingId:ge._id,exhibitorId:ge.exhibitorId||"",exhibitorName:ge.companyName,bookingDate:ge.createdAt,dimensions:be.dimensions,area:be.dimensions.width*be.dimensions.height,bookingStatus:ge.status,isExtraAmenity:!0,quantity:te.quantity||1}))));let ae=V;V.length===0&&ie.amenities&&ie.amenities.length>0&&(ae=g.flatMap(te=>te.stallIds).flatMap((te,be)=>(ie.amenities||[]).map((Ie,ye)=>{var Wt;const Me=g.find(Rr=>Rr.stallIds.some(Fe=>Fe._id===te._id)),Ue=(Wt=Me==null?void 0:Me.extraAmenities)==null?void 0:Wt.find(Rr=>Rr.name===Ie.name),wt=!!Ue,qt=`sim-${be}-${ye}-${Date.now()}`;return{...Ie,id:qt,booked:wt,stallId:te._id,stallNumber:te.number,bookingId:(Me==null?void 0:Me._id)||"",exhibitorId:(Me==null?void 0:Me.exhibitorId)||"",exhibitorName:(Me==null?void 0:Me.companyName)||"Unknown",bookingDate:(Me==null?void 0:Me.createdAt)||new Date().toISOString(),dimensions:te.dimensions,area:te.dimensions.width*te.dimensions.height,bookingStatus:(Me==null?void 0:Me.status)||"approved",isExtraAmenity:!0,quantity:wt?(Ue==null?void 0:Ue.quantity)||1:0}}))),p([...G,...ae]),F(de.length),z(G.length+ae.length)}}else o&&r.length>0&&(p([]),F(0),z(0))},[o,r,g]);const ee=_.useMemo(()=>{let ie=d;if(y.length>0&&(ie=ie.filter(de=>y.includes(de.type))),j){const de=j.toLowerCase();ie=ie.filter(G=>G.name.toLowerCase().includes(de)||G.type.toLowerCase().includes(de)||G.description&&G.description.toLowerCase().includes(de))}return ie},[d,y,j]),D=_.useMemo(()=>{let ie=h;if(y.length>0&&(ie=ie.filter(de=>y.includes(de.type))),j){const de=j.toLowerCase();ie=ie.filter(G=>G.name.toLowerCase().includes(de)||G.type.toLowerCase().includes(de)||G.description&&G.description.toLowerCase().includes(de))}return ie},[h,y,j]),q=_.useMemo(()=>{let ie=u;if(y.length>0&&(ie=ie.filter(de=>y.includes(de.type))),k.length>0&&(ie=ie.filter(de=>k.includes(de.bookingStatus))),j){const de=j.toLowerCase();ie=ie.filter(G=>G.name.toLowerCase().includes(de)||G.type.toLowerCase().includes(de)||G.description&&G.description.toLowerCase().includes(de)||G.stallNumber&&G.stallNumber.toLowerCase().includes(de)||G.exhibitorName&&G.exhibitorName.toLowerCase().includes(de))}if(E&&E[0]&&E[1]){const de=E[0].startOf("day"),G=E[1].endOf("day");ie=ie.filter(V=>{if(!V.bookingDate)return!1;const ae=et(V.bookingDate);return ae.isAfter(de)&&ae.isBefore(G)})}return ie},[u,y,k,j,E]),B=()=>{w([]),b([]),A(""),C(null)},P=()=>{if(ee.length===0){t.warning("No basic amenities to export");return}const ie=ee.map(V=>({Name:V.name,Type:V.type,Description:V.description||"","Per Sq. Meter":V.perSqm,"Quantity Per Unit":V.quantity,ID:V._id||V.id})),de=r.find(V=>V._id===o),G=`${(de==null?void 0:de.name)||"Exhibition"}_Basic_Amenities`;Kl(ie,G),t.success("Basic amenities exported successfully")},Z=()=>{if(D.length===0){t.warning("No extra amenities to export");return}const ie=D.map(V=>({Name:V.name,Type:V.type,Description:V.description||"",Rate:V.rate,ID:V._id||V.id})),de=r.find(V=>V._id===o),G=`${(de==null?void 0:de.name)||"Exhibition"}_Extra_Amenities`;Kl(ie,G),t.success("Extra amenities exported successfully")},se=()=>{if(q.length===0){t.warning("No calculated amenities to export");return}const ie=q.map(V=>{const ae={Name:V.name,Type:V.type,Description:V.description||"","Stall Number":V.stallNumber,Exhibitor:V.exhibitorName,"Booking Status":V.bookingStatus,"Booking Date":V.bookingDate?new Date(V.bookingDate).toLocaleDateString():""};return V.hasOwnProperty("calculatedQuantity")&&(ae["Calculated Quantity"]=V.calculatedQuantity,ae["Per Sq. Meter"]=V.perSqm,ae["Base Quantity"]=V.quantity),V.hasOwnProperty("rate")&&(ae.Rate=V.rate,ae.Booked=V.booked?"Yes":"No"),ae}),de=r.find(V=>V._id===o),G=`${(de==null?void 0:de.name)||"Exhibition"}_Calculated_Amenities`;Kl(ie,G),t.success("Calculated amenities exported successfully")};return n.jsxs("div",{className:"amenities-container",children:[n.jsxs("div",{className:"amenities-header",children:[n.jsx(Ek,{level:4,className:"amenities-title",children:"Amenities Management"}),n.jsx(uu,{type:"secondary",children:"View, filter, and export amenities data. See calculated amenities for booked stalls."})]}),n.jsx(jk,{exhibitionId:o,exhibitions:r,exhibitionsLoading:s,onExhibitionChange:l,typeFilter:y,setTypeFilter:w,bookingStatusFilter:k,setBookingStatusFilter:b,searchQuery:j,setSearchQuery:A,dateRange:E,setDateRange:C,resetFilters:B}),o&&n.jsx("div",{style:{marginBottom:24},children:n.jsx(Sk,{basicAmenities:d,extraAmenities:h,bookedStalls:I,calculatedAmenities:N})}),o?n.jsx(Kt,{activeKey:U,onChange:R,className:"amenities-tabs",items:[{key:"basic",label:n.jsxs("span",{children:[n.jsx(Xx,{}),"Basic Amenities"]}),children:n.jsx(Yl,{title:"Basic Amenities",amenities:ee,loading:s,onExport:P,exhibitionId:o})},{key:"extra",label:n.jsxs("span",{children:[n.jsx(ms,{}),"Extra Amenities"]}),children:n.jsx(Yl,{title:"Additional Amenities",amenities:D,loading:s,onExport:Z,exhibitionId:o})},{key:"calculated",label:n.jsxs("span",{children:[n.jsx(Qx,{}),"Calculated Amenities"]}),children:n.jsxs(n.Fragment,{children:[n.jsx(Ae,{gutter:[0,16],children:n.jsx(Q,{span:24,children:n.jsx(ue,{className:"filter-card",children:n.jsxs(xe,{children:[n.jsx(uu,{strong:!0,children:"View: "}),n.jsxs(mr.Group,{value:O,onChange:ie=>X(ie.target.value),optionType:"button",buttonStyle:"solid",children:[n.jsx(mr.Button,{value:"basic",children:"Basic Amenities"}),n.jsx(mr.Button,{value:"extra",children:"Extra Amenities"}),n.jsx(mr.Button,{value:"all",children:"All Amenities"})]})]})})})}),n.jsx(Yl,{title:"Calculated Amenities",amenities:q,loading:s,onExport:se,isDynamicColumns:!0,isCalculated:!0,exhibitionId:o,amenityViewType:O})]})}]}):n.jsx("div",{style:{marginTop:24,textAlign:"center",padding:48,background:"#fff",borderRadius:8},children:n.jsx(mt,{description:"Please select an exhibition to view amenities",image:mt.PRESENTED_IMAGE_SIMPLE})})]})},_t=({children:e})=>$e(r=>r.auth.isAuthenticated)?e:n.jsx(Do,{to:"/login"}),Ls=({children:e})=>$e(r=>r.exhibitorAuth.isAuthenticated)?e:n.jsx(Do,{to:"/"});function _k(){return n.jsx(Xt,{children:n.jsx(Xi,{children:n.jsx(lp,{children:n.jsxs(cp,{children:[n.jsx(Ge,{path:"/",element:n.jsx(_b,{})}),n.jsx(Ge,{path:"/login",element:n.jsx(Ng,{})}),n.jsx(Ge,{path:"/exhibitions",element:n.jsx(Mv,{})}),n.jsx(Ge,{path:"/exhibitions/:id",element:n.jsx(Ev,{})}),n.jsx(Ge,{path:"/exhibitions/:id/layout",element:n.jsx(wv,{})}),n.jsx(Ge,{path:"/exhibitor/dashboard",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(Lg,{})})})}),n.jsx(Ge,{path:"/exhibitor/profile",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(zg,{})})})}),n.jsx(Ge,{path:"/exhibitor/bookings",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx($g,{})})})}),n.jsx(Ge,{path:"/exhibitor/bookings/:id",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(Ug,{})})})}),n.jsx(Ge,{path:"/exhibitor/support",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx("div",{children:"Help & Support"})})})}),n.jsx(Ge,{path:"/exhibitor/invoice/:id",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(L1,{})})})}),n.jsx(Ge,{path:"/dashboard",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Pg,{})})})}),n.jsx(Ge,{path:"/account",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(O1,{})})})}),n.jsx(Ge,{path:"/exhibition",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(jy,{})})})}),n.jsx(Ge,{path:"/exhibition/create",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Cy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Ay,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/space",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Wy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/layout",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Vy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/halls",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Yy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/stalls",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Uv,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/fixtures",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Wv,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/edit",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Iy,{})})})}),n.jsx(Ge,{path:"/stall/list",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Gv,{})})})}),n.jsx(Ge,{path:"/stall-types",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Jv,{})})})}),n.jsx(Ge,{path:"/bookings",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(lb,{})})})}),n.jsx(Ge,{path:"/bookings/create",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(fb,{})})})}),n.jsx(Ge,{path:"/amenities",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Tk,{})})})}),n.jsx(Ge,{path:"/invoices",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(gb,{})})})}),n.jsx(Ge,{path:"/invoice/:id",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(xb,{})})})}),n.jsx(Ge,{path:"/index",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(fy,{})})})}),n.jsx(Ge,{path:"/settings",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx($1,{})})})}),n.jsx(Ge,{path:"/roles",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Q1,{})})})}),n.jsx(Ge,{path:"/notifications",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(gy,{})})})}),n.jsx(Ge,{path:"/exhibitors",element:n.jsx(_t,{children:n.jsx(Et,{children:n.jsx(Nb,{})})})}),n.jsx(Ge,{path:"*",element:n.jsx(Do,{to:"/",replace:!0})})]})})})})}const Xl=Oc({reducerPath:"bookingApi",baseQuery:Rc({baseUrl:"/api"}),endpoints:e=>({getBookings:e.query({query:()=>"/bookings"}),getBooking:e.query({query:t=>`/bookings/${t}`}),createBooking:e.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:e.mutation({query:({id:t,status:r})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:r}})})})}),kk=dp({reducer:{auth:Sp,exhibitorAuth:Hm,exhibition:vy,booking:eb,exhibitor:hb,settings:Pm,role:G1,user:sy,[Xl.reducerPath]:Xl.reducer,[oo.reducerPath]:oo.reducer,[Va.reducerPath]:Va.reducer},middleware:e=>e().concat(Xl.middleware).concat(oo.middleware).concat(Va.middleware)}),Ck={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};Zl.createRoot(document.getElementById("root")).render(n.jsx(xt.StrictMode,{children:n.jsx(hp,{store:kk,children:n.jsx(Jx,{theme:Ck,children:n.jsx(Xt,{children:n.jsx(_k,{})})})})}));
