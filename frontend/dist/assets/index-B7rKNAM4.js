var mx=Object.defineProperty;var gx=(e,t,r)=>t in e?mx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var xd=(e,t,r)=>gx(e,typeof t!="symbol"?t+"":t,r);import{j as n,_ as yu}from"./vendor-pdf-BATZImji.js";import{b as yx,c as Ls,g as vx,d as nt,T as Me,L as on,e as Ke,S as ue,f as _e,B as gr,A as Ur,h as re,i as sr,j as yc,k as ht,l as bx,m as Qt,n as Fi,r as _,o as Ks,p as vc,q as Ri,s as Zr,t as Jt,u as Vt,E as bt,D as it,v as Vn,w as Nt,M as hr,x as vu,y as bu,z as uo,C as fo,F as Lo,G as wr,H as St,I as wx,J as Cn,K as bc,N as jx,O as Sx,P as he,Q as W,U as Zl,V as wc,W as It,X as En,Y as Qr,Z as Gt,$ as Se,a0 as xo,a1 as po,a2 as Ex,a3 as Ne,a4 as Q,a5 as de,a as xt,a6 as Ze,a7 as ln,a8 as wu,a9 as Le,aa as st,ab as Yr,ac as hn,ad as Ye,ae as Xs,af as Gn,ag as Ve,ah as jc,ai as fn,aj as Sc,ak as fs,al as Yi,am as ju,an as Zt,ao as Rr,ap as Pi,aq as Tx,ar as Di,as as mr,at as as,au as _x,av as An,aw as kx,ax as gn,ay as Ki,az as Li,aA as Qs,aB as pd,aC as Cx,aD as Ec,aE as xs,aF as jt,aG as rs,aH as os,aI as ps,aJ as Ax,aK as Ix,aL as Nx,aM as Su,aN as Fx,aO as md,aP as Rx,aQ as Px,aR as Dx,aS as Eu,aT as Xi,aU as Lx,aV as gd,aW as Ox,aX as Bx,aY as Mx,aZ as yd,a_ as Tu,a$ as $x,b0 as Ux,b1 as zx,b2 as qx,b3 as Wx,b4 as Hx,b5 as Vx,b6 as ec,b7 as Gx,b8 as vr,b9 as Yx,ba as Kx,bb as Xx,bc as vd,bd as Qx,be as Jx,bf as Zx,bg as ep,bh as tp,bi as rp}from"./vendor-antd-B4_vH6e3.js";import{c as et,a as br,u as tt,b as qe,d as lt,e as Fn,L as Nr,f as Dr,w as bd,n as _u,g as ku,i as Oi,h as np,j as Js,k as Cu,p as Tc,l as oi,m as mo,o as _c,q as ls,r as wd,s as sp,S as Au,t as il,v as kc,x as Iu,y as ip,z as Nu,A as ap,B as jd,C as op,D as lp,E as cp,F as dp,G as vi,N as Oo,H as hp,I as up,R as fp,J as Qe,K as xp,P as pp}from"./vendor-react-HZpJcaWA.js";import{a as Cr}from"./vendor-utils-DaaYa_1B.js";import{n as Ee,k as Yn}from"./vendor-ui-DJd7KJgU.js";import{E as mp}from"./vendor-editor-qG8kq7cB.js";import{L as go,G as Gs,R as Bo,T as Bi,u as gp,a as yp,I as vp,C as bp,b as wp,c as jp,K as al,S as Sp,F as Ep,d as Tp}from"./vendor-canvas-CGQrVgU6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var tc={},Sd=yx;tc.createRoot=Sd.createRoot,tc.hydrateRoot=Sd.hydrateRoot;const Mo="/api",ke=Cr.create({baseURL:Mo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Bn=Cr.create({baseURL:Mo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Cc=Cr.create({baseURL:Mo,headers:{"Content-Type":"application/json",Accept:"application/json"}});ke.interceptors.request.use(e=>{var a,o,l,d,c,h,f,u,p;const t=localStorage.getItem("token"),r=localStorage.getItem("exhibitor_token"),s=((a=e.url)==null?void 0:a.startsWith("/bookings/"))&&e.method==="patch"||((o=e.url)==null?void 0:o.includes("/exhibition/"))||((l=e.url)==null?void 0:l.includes("/stalls/"))||((d=e.url)==null?void 0:d.includes("/halls/"))||((c=e.url)==null?void 0:c.includes("/users/"))||((h=e.url)==null?void 0:h.includes("/roles/")),i=((f=e.url)==null?void 0:f.includes("/test-booking"))||((u=e.url)==null?void 0:u.includes("/exhibitor-bookings"))||((p=e.url)==null?void 0:p.startsWith("/exhibitors/"));return s?t?e.headers.Authorization=`Bearer ${t}`:console.warn("Admin token required but not found for:",e.url):i&&r?e.headers.Authorization=`Bearer ${r}`:t?e.headers.Authorization=`Bearer ${t}`:r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));Cc.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));ke.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});Cc.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("exhibitor_token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});const Ac=async(e,t=!1,r)=>{const s=t?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return Cr.get(`${Mo}${e}`,{responseType:"blob",headers:{Authorization:`Bearer ${s}`},onDownloadProgress:r})},_p=Object.freeze(Object.defineProperty({__proto__:null,default:ke,downloadFile:Ac,exhibitorApi:Cc,publicApi:Bn},Symbol.toStringTag,{value:"Module"})),yo={login:async e=>await ke.post("/auth/login",e),getProfile:async()=>await ke.get("/auth/me"),changePassword:async e=>await ke.post("/auth/change-password",e)},Ed=localStorage.getItem("token"),ol=localStorage.getItem("user");let Fu=null;try{Fu=ol&&ol!=="undefined"?JSON.parse(ol):null}catch(e){console.error("Failed to parse user data from localStorage",e),localStorage.removeItem("user")}const kp={isAuthenticated:!!Ed,user:Fu,token:Ed,loading:!1,error:null},Ua=et("auth/refreshUser",async(e,{rejectWithValue:t})=>{var r,s;try{return(await yo.getProfile()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to refresh user data")}}),Ru=br({name:"auth",initialState:kp,reducers:{setCredentials:(e,t)=>{e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:e=>{e.addCase(Ua.pending,t=>{t.loading=!0,t.error=null}).addCase(Ua.fulfilled,(t,r)=>{t.loading=!1,t.user=r.payload,localStorage.setItem("user",JSON.stringify(r.payload))}).addCase(Ua.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{setCredentials:Pu,logout:Td}=Ru.actions,Cp=Ru.reducer,xn=Object.create(null);xn.open="0";xn.close="1";xn.ping="2";xn.pong="3";xn.message="4";xn.upgrade="5";xn.noop="6";const za=Object.create(null);Object.keys(xn).forEach(e=>{za[xn[e]]=e});const rc={type:"error",data:"parser error"},Du=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Lu=typeof ArrayBuffer=="function",Ou=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Ic=({type:e,data:t},r,s)=>Du&&t instanceof Blob?r?s(t):_d(t,s):Lu&&(t instanceof ArrayBuffer||Ou(t))?r?s(t):_d(new Blob([t]),s):s(xn[e]+(t||"")),_d=(e,t)=>{const r=new FileReader;return r.onload=function(){const s=r.result.split(",")[1];t("b"+(s||""))},r.readAsDataURL(e)};function kd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ll;function Ap(e,t){if(Du&&e.data instanceof Blob)return e.data.arrayBuffer().then(kd).then(t);if(Lu&&(e.data instanceof ArrayBuffer||Ou(e.data)))return t(kd(e.data));Ic(e,!1,r=>{ll||(ll=new TextEncoder),t(ll.encode(r))})}const Cd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gi=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Cd.length;e++)gi[Cd.charCodeAt(e)]=e;const Ip=e=>{let t=e.length*.75,r=e.length,s,i=0,a,o,l,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const c=new ArrayBuffer(t),h=new Uint8Array(c);for(s=0;s<r;s+=4)a=gi[e.charCodeAt(s)],o=gi[e.charCodeAt(s+1)],l=gi[e.charCodeAt(s+2)],d=gi[e.charCodeAt(s+3)],h[i++]=a<<2|o>>4,h[i++]=(o&15)<<4|l>>2,h[i++]=(l&3)<<6|d&63;return c},Np=typeof ArrayBuffer=="function",Nc=(e,t)=>{if(typeof e!="string")return{type:"message",data:Bu(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:Fp(e.substring(1),t)}:za[r]?e.length>1?{type:za[r],data:e.substring(1)}:{type:za[r]}:rc},Fp=(e,t)=>{if(Np){const r=Ip(e);return Bu(r,t)}else return{base64:!0,data:e}},Bu=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Mu="",Rp=(e,t)=>{const r=e.length,s=new Array(r);let i=0;e.forEach((a,o)=>{Ic(a,!1,l=>{s[o]=l,++i===r&&t(s.join(Mu))})})},Pp=(e,t)=>{const r=e.split(Mu),s=[];for(let i=0;i<r.length;i++){const a=Nc(r[i],t);if(s.push(a),a.type==="error")break}return s};function Dp(){return new TransformStream({transform(e,t){Ap(e,r=>{const s=r.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,s)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(s))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(r)})}})}let cl;function da(e){return e.reduce((t,r)=>t+r.length,0)}function ha(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let s=0;for(let i=0;i<t;i++)r[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function Lp(e,t){cl||(cl=new TextDecoder);const r=[];let s=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(s===0){if(da(r)<1)break;const d=ha(r,1);a=(d[0]&128)===128,i=d[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(da(r)<2)break;const d=ha(r,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),s=3}else if(s===2){if(da(r)<8)break;const d=ha(r,8),c=new DataView(d.buffer,d.byteOffset,d.length),h=c.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(rc);break}i=h*Math.pow(2,32)+c.getUint32(4),s=3}else{if(da(r)<i)break;const d=ha(r,i);l.enqueue(Nc(a?d:cl.decode(d),t)),s=0}if(i===0||i>e){l.enqueue(rc);break}}}})}const $u=4;function Ot(e){if(e)return Op(e)}function Op(e){for(var t in Ot.prototype)e[t]=Ot.prototype[t];return e}Ot.prototype.on=Ot.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ot.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Ot.prototype.off=Ot.prototype.removeListener=Ot.prototype.removeAllListeners=Ot.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var s,i=0;i<r.length;i++)if(s=r[i],s===t||s.fn===t){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Ot.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,i=r.length;s<i;++s)r[s].apply(this,t)}return this};Ot.prototype.emitReserved=Ot.prototype.emit;Ot.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ot.prototype.hasListeners=function(e){return!!this.listeners(e).length};const $o=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Br=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Bp="arraybuffer";function Uu(e,...t){return t.reduce((r,s)=>(e.hasOwnProperty(s)&&(r[s]=e[s]),r),{})}const Mp=Br.setTimeout,$p=Br.clearTimeout;function Uo(e,t){t.useNativeTimers?(e.setTimeoutFn=Mp.bind(Br),e.clearTimeoutFn=$p.bind(Br)):(e.setTimeoutFn=Br.setTimeout.bind(Br),e.clearTimeoutFn=Br.clearTimeout.bind(Br))}const Up=1.33;function zp(e){return typeof e=="string"?qp(e):Math.ceil((e.byteLength||e.size)*Up)}function qp(e){let t=0,r=0;for(let s=0,i=e.length;s<i;s++)t=e.charCodeAt(s),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}function zu(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Wp(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function Hp(e){let t={},r=e.split("&");for(let s=0,i=r.length;s<i;s++){let a=r[s].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class Vp extends Error{constructor(t,r,s){super(t),this.description=r,this.context=s,this.type="TransportError"}}class Fc extends Ot{constructor(t){super(),this.writable=!1,Uo(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,s){return super.emitReserved("error",new Vp(t,r,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Nc(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=Wp(t);return r.length?"?"+r:""}}class Gp extends Fc{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||r()})),this.writable||(s++,this.once("drain",function(){--s||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Pp(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Rp(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=zu()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let qu=!1;try{qu=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Yp=qu;function Kp(){}class Xp extends Gp{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let s=location.port;s||(s=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,r){const s=this.request({method:"POST",data:t});s.on("success",r),s.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,s)=>{this.onError("xhr poll error",r,s)}),this.pollXhr=t}}let Ms=class qa extends Ot{constructor(t,r,s){super(),this.createRequest=t,Uo(this,s),this._opts=s,this._method=s.method||"GET",this._uri=r,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const r=Uu(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(r);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=qa.requestsCount++,qa.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Kp,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete qa.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Ms.requestsCount=0;Ms.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ad);else if(typeof addEventListener=="function"){const e="onpagehide"in Br?"pagehide":"unload";addEventListener(e,Ad,!1)}}function Ad(){for(let e in Ms.requests)Ms.requests.hasOwnProperty(e)&&Ms.requests[e].abort()}const Qp=function(){const e=Wu({xdomain:!1});return e&&e.responseType!==null}();class Jp extends Xp{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=Qp&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Ms(Wu,this.uri(),t)}}function Wu(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Yp))return new XMLHttpRequest}catch{}if(!t)try{return new Br[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Hu=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Zp extends Fc{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,s=Hu?{}:Uu(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;Ic(s,this.supportsBinary,a=>{try{this.doWrite(s,a)}catch{}i&&$o(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=zu()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const dl=Br.WebSocket||Br.MozWebSocket;class em extends Zp{createSocket(t,r,s){return Hu?new dl(t,r,s):r?new dl(t,r):new dl(t)}doWrite(t,r){this.ws.send(r)}}class tm extends Fc{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=Lp(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(r).getReader(),i=Dp();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{s.read().then(({done:l,value:d})=>{l||(this.onPacket(d),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;this._writer.write(s).then(()=>{i&&$o(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const rm={websocket:em,webtransport:tm,polling:Jp},nm=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,sm=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function nc(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),s=e.indexOf("]");r!=-1&&s!=-1&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));let i=nm.exec(e||""),a={},o=14;for(;o--;)a[sm[o]]=i[o]||"";return r!=-1&&s!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=im(a,a.path),a.queryKey=am(a,a.query),a}function im(e,t){const r=/\/{2,9}/g,s=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function am(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,a){i&&(r[i]=a)}),r}const sc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Wa=[];sc&&addEventListener("offline",()=>{Wa.forEach(e=>e())},!1);class zn extends Ot{constructor(t,r){if(super(),this.binaryType=Bp,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const s=nc(t);r.hostname=s.host,r.secure=s.protocol==="https"||s.protocol==="wss",r.port=s.port,s.query&&(r.query=s.query)}else r.host&&(r.hostname=nc(r.host).host);Uo(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(s=>{const i=s.prototype.name;this.transports.push(i),this._transportsByName[i]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Hp(this.opts.query)),sc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Wa.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=$u,r.transport=t,this.id&&(r.sid=this.id);const s=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&zn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",zn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(r+=zp(i)),s>0&&r>this._maxPayload)return this.writeBuffer.slice(0,s);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,$o(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,s){return this._sendPacket("message",t,r,s),this}send(t,r,s){return this._sendPacket("message",t,r,s),this}_sendPacket(t,r,s,i){if(typeof r=="function"&&(i=r,r=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const a={type:t,data:r,options:s};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},s=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(zn.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),sc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Wa.indexOf(this._offlineEventListener);s!==-1&&Wa.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}zn.protocol=$u;class om extends zn{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),s=!1;zn.priorWebsocketSuccess=!1;const i=()=>{s||(r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!s)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;zn.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function a(){s||(s=!0,h(),r.close(),r=null)}const o=f=>{const u=new Error("probe error: "+f);u.transport=r.name,a(),this.emitReserved("upgradeError",u)};function l(){o("transport closed")}function d(){o("socket closed")}function c(f){r&&f.name!==r.name&&a()}const h=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",l),this.off("close",d),this.off("upgrading",c)};r.once("open",i),r.once("error",o),r.once("close",l),this.once("close",d),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&r.push(t[s]);return r}}let lm=class extends om{constructor(t,r={}){const s=typeof t=="object"?t:r;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(i=>rm[i]).filter(i=>!!i)),super(t,s)}};function cm(e,t="",r){let s=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),s=nc(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const a=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+a+":"+s.port+t,s.href=s.protocol+"://"+a+(r&&r.port===s.port?"":":"+s.port),s}const dm=typeof ArrayBuffer=="function",hm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Vu=Object.prototype.toString,um=typeof Blob=="function"||typeof Blob<"u"&&Vu.call(Blob)==="[object BlobConstructor]",fm=typeof File=="function"||typeof File<"u"&&Vu.call(File)==="[object FileConstructor]";function Rc(e){return dm&&(e instanceof ArrayBuffer||hm(e))||um&&e instanceof Blob||fm&&e instanceof File}function Ha(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,s=e.length;r<s;r++)if(Ha(e[r]))return!0;return!1}if(Rc(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Ha(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Ha(e[r]))return!0;return!1}function xm(e){const t=[],r=e.data,s=e;return s.data=ic(r,t),s.attachments=t.length,{packet:s,buffers:t}}function ic(e,t){if(!e)return e;if(Rc(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=ic(e[s],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=ic(e[s],t));return r}return e}function pm(e,t){return e.data=ac(e.data,t),delete e.attachments,e}function ac(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=ac(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=ac(e[r],t));return e}const mm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],gm=5;var Je;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Je||(Je={}));class ym{constructor(t){this.replacer=t}encode(t){return(t.type===Je.EVENT||t.type===Je.ACK)&&Ha(t)?this.encodeAsBinary({type:t.type===Je.EVENT?Je.BINARY_EVENT:Je.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===Je.BINARY_EVENT||t.type===Je.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=xm(t),s=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(s),i}}function Id(e){return Object.prototype.toString.call(e)==="[object Object]"}class Pc extends Ot{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const s=r.type===Je.BINARY_EVENT;s||r.type===Je.BINARY_ACK?(r.type=s?Je.EVENT:Je.ACK,this.reconstructor=new vm(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Rc(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const s={type:Number(t.charAt(0))};if(Je[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Je.BINARY_EVENT||s.type===Je.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(a,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););s.nsp=t.substring(a,r)}else s.nsp="/";const i=t.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}s.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Pc.isPayloadValid(s.type,a))s.data=a;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case Je.CONNECT:return Id(r);case Je.DISCONNECT:return r===void 0;case Je.CONNECT_ERROR:return typeof r=="string"||Id(r);case Je.EVENT:case Je.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&mm.indexOf(r[0])===-1);case Je.ACK:case Je.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vm{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=pm(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const bm=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Pc,Encoder:ym,get PacketType(){return Je},protocol:gm},Symbol.toStringTag,{value:"Module"}));function Vr(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const wm=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Gu extends Ot{constructor(t,r,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Vr(t,"open",this.onopen.bind(this)),Vr(t,"packet",this.onpacket.bind(this)),Vr(t,"error",this.onerror.bind(this)),Vr(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var s,i,a;if(wm.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Je.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,f=r.pop();this._registerAckCallback(h,f),o.id=h}const l=(i=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(d?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((s,i)=>{const a=(o,l)=>o?i(o):s(l);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Je.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Je.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Je.EVENT:case Je.BINARY_EVENT:this.onevent(t);break;case Je.ACK:case Je.BINARY_ACK:this.onack(t);break;case Je.DISCONNECT:this.ondisconnect();break;case Je.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const s of r)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let s=!1;return function(...i){s||(s=!0,r.packet({type:Je.ACK,id:t,data:i}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Je.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const s of r)s.apply(this,t.data)}}}function Zs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Zs.prototype.reset=function(){this.attempts=0};Zs.prototype.setMin=function(e){this.ms=e};Zs.prototype.setMax=function(e){this.max=e};Zs.prototype.setJitter=function(e){this.jitter=e};class oc extends Ot{constructor(t,r){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Uo(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((s=r.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Zs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const i=r.parser||bm;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new lm(this.uri,this.opts);const r=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=Vr(r,"open",function(){s.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Vr(r,"error",a);if(this._timeout!==!1){const l=this._timeout,d=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Vr(t,"ping",this.onping.bind(this)),Vr(t,"data",this.ondata.bind(this)),Vr(t,"error",this.onerror.bind(this)),Vr(t,"close",this.onclose.bind(this)),Vr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){$o(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new Gu(this,t,r),this.nsps[t]=s),s}_destroy(t){const r=Object.keys(this.nsps);for(const s of r)if(this.nsps[s].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let s=0;s<r.length;s++)this.engine.write(r[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},r);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const li={};function Va(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=cm(e,t.path||"/socket.io"),s=r.source,i=r.id,a=r.path,o=li[i]&&a in li[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let d;return l?d=new oc(s,t):(li[i]||(li[i]=new oc(s,t)),d=li[i]),r.query&&!t.query&&(t.query=r.queryKey),d.socket(r.path,t)}Object.assign(Va,{Manager:oc,Socket:Gu,io:Va,connect:Va});const jm=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",an=jm?"https://aakardata.in/api":"http://localhost:5000/api",Sm="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class Em{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(t);r?this.init(r,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(r=>{this.triggerEvent("notification",r)})}}init(t,r=!1){var s;if(!((s=this.socket)!=null&&s.connected&&this.lastToken===t&&this.isExhibitor===r)){this.isExhibitor=r,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const i=an.replace("/api",""),a=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Va(i,{auth:{token:a,type:r?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(i){console.error("Error initializing notification socket:",i),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r)}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(s=>s!==r))}triggerEvent(t,r){this.listeners[t]&&this.listeners[t].forEach(s=>{try{s(r)}catch(i){console.error(`Error in notification ${t} listener:`,i)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",r={limit:1,page:1,unreadOnly:!0},s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const a=await Cr.get(t,{baseURL:an,params:r,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success?(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,r=10,s=!1){try{const i=this.isExhibitor?"notifications/exhibitor":"notifications/admin",a={page:t,limit:r,unreadOnly:s},o=this.isExhibitor?"exhibitor_token":"token",l=localStorage.getItem(o);if(!l)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await Cr.get(i,{baseURL:an,params:a,headers:{Authorization:`Bearer ${l}`}})).data}catch(i){return console.error("Error fetching notifications:",i),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const r=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const a=await Cr.put(r,{},{baseURL:an,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success&&(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),a.data}catch(r){throw console.error("Error marking notification as read:",r),r}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",r=this.isExhibitor?"exhibitor_token":"token",s=localStorage.getItem(r);if(!s)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const i=await Cr.put(t,{},{baseURL:an,headers:{Authorization:`Bearer ${s}`}});return i.data&&i.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),i.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const r=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,s=await Cr.delete(r,{baseURL:an,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(s.data.success)return s.data.data.unreadCount!==void 0&&(this.unreadCount=s.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),s.data;throw new Error("Failed to delete notification")}catch(r){throw console.error("Error deleting notification:",r),r}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",r=await Cr.delete(t,{baseURL:an,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(r.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),r.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const vt=new Em;var Lt=(e=>(e.NEW_LEAD="New Lead",e.FOLLOWUP_DUE="Follow-up Due",e.STATUS_CHANGE="Status Changed",e.ASSIGNMENT="Lead Assigned",e.NEW_BOOKING="NEW_BOOKING",e.BOOKING_CONFIRMED="BOOKING_CONFIRMED",e.BOOKING_CANCELLED="BOOKING_CANCELLED",e.PAYMENT_RECEIVED="PAYMENT_RECEIVED",e.INVOICE_GENERATED="INVOICE_GENERATED",e.EXHIBITION_UPDATE="EXHIBITION_UPDATE",e.SYSTEM_MESSAGE="SYSTEM_MESSAGE",e.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",e.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",e))(Lt||{}),Mn=(e=>(e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW",e))(Mn||{}),lc=(e=>(e.READ="Read",e.UNREAD="Unread",e))(lc||{}),Yu={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(Ls,function(){return function(r,s,i){r=r||{};var a=s.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(c,h,f,u){return a.fromToBase(c,h,f,u)}i.en.relativeTime=o,a.fromToBase=function(c,h,f,u,p){for(var g,x,m,v=f.$locale().relativeTime||o,S=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],T=S.length,y=0;y<T;y+=1){var w=S[y];w.d&&(g=u?i(c).diff(f,w.d,!0):f.diff(c,w.d,!0));var k=(r.rounding||Math.round)(Math.abs(g));if(m=g>0,k<=w.r||!w.r){k<=1&&y>0&&(w=S[y-1]);var b=v[w.l];p&&(k=p(""+k)),x=typeof b=="string"?b.replace("%d",k):b(k,h,w.l,m);break}}if(h)return x;var j=m?v.future:v.past;return typeof j=="function"?j(x):j.replace("%s",x)},a.to=function(c,h){return l(c,h,this,!0)},a.from=function(c,h){return l(c,h,this)};var d=function(c){return c.$u?i.utc():i()};a.toNow=function(c){return this.to(d(this),c)},a.fromNow=function(c){return this.from(d(this),c)}}})})(Yu);var Tm=Yu.exports;const _m=vx(Tm);nt.extend(_m);const Nd=e=>{switch(e){case Mn.HIGH:return"#f5222d";case Mn.MEDIUM:return"#faad14";case Mn.LOW:return"#52c41a";default:return"#1677ff"}},km=e=>nt(e).fromNow(),Cm=e=>nt(e).format("YYYY-MM-DD HH:mm"),Am=e=>e.filter(t=>t.isRead===!1).length,Im=e=>{if(!e.entityId||!e.entityType)return"/notifications";switch(e.entityType){case"lead":return`/leads/${e.entityId}`;case"followup":return`/followups/${e.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${e.entityId}`;case"Exhibition":return`/exhibition/${e.entityId}`;case"Exhibitor":return`/exhibitors?id=${e.entityId}`;default:return"/notifications"}},{Text:Fd,Paragraph:Nm}=Me,Ku=({notification:e,onView:t,onMarkAsRead:r,onDelete:s})=>{const i=()=>{switch(e.type){case Lt.NEW_LEAD:return n.jsx(Fi,{style:{color:"#1677ff"}});case Lt.FOLLOWUP_DUE:return n.jsx(Qt,{style:{color:"#faad14"}});case Lt.STATUS_CHANGE:return n.jsx(bx,{style:{color:"#722ed1"}});case Lt.ASSIGNMENT:return n.jsx(ht,{style:{color:"#52c41a"}});default:return n.jsx(yc,{style:{color:"#1677ff"}})}},a=()=>{e.isRead||r(e),t(e)},o=l=>{l.stopPropagation(),s(e)};return n.jsx(on.Item,{onClick:a,className:e.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:e.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[n.jsx(Ke,{title:"Delete notification",children:n.jsx(re,{type:"text",danger:!0,icon:n.jsx(sr,{}),onClick:o,"aria-label":"Delete notification"})})],children:n.jsx(on.Item.Meta,{avatar:n.jsx(gr,{dot:!e.isRead,color:Nd(e.priority),children:n.jsx(Ur,{icon:i(),size:"large",style:{backgroundColor:"white",border:`1px solid ${Nd(e.priority)}`}})}),title:n.jsxs(ue,{children:[n.jsx(Fd,{strong:!0,children:e.title}),!e.isRead&&n.jsx(_e,{color:"blue",children:"New"})]}),description:n.jsxs("div",{children:[n.jsx(Nm,{ellipsis:{rows:2},style:{marginBottom:4},children:e.message}),n.jsx(Ke,{title:Cm(e.createdAt),children:n.jsx(Fd,{type:"secondary",style:{fontSize:12},children:km(e.createdAt)})})]})})})},{Title:Fm,Text:K4}=Me,Rm=e=>{switch(e){case"NEW_BOOKING":return Lt.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return Lt.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return Lt.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return Lt.NEW_LEAD;default:return Lt.STATUS_CHANGE}},Pm=e=>{switch(e){case"HIGH":return Mn.HIGH;case"MEDIUM":return Mn.MEDIUM;case"LOW":return Mn.LOW;default:return Mn.MEDIUM}},Dm=({isExhibitor:e=!1})=>{const t=tt(),[r,s]=_.useState([]),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState(0),[h,f]=_.useState(!1),[u,p]=_.useState("all"),g=_.useRef(null),{isAuthenticated:x,user:m}=qe(L=>L.auth),{isAuthenticated:v}=qe(L=>L.exhibitorAuth||{isAuthenticated:!1}),S=e?v:x,[T,y]=_.useState(!1);_.useEffect(()=>{if(S){const L=e?"exhibitor_token":"token",z=localStorage.getItem(L);if(z){vt.init(z,e),vt.subscribeToNotifications();const J=H=>{c(H),H>0&&!o&&(f(!0),setTimeout(()=>{f(!1)},2e3))},ne=H=>{s(B=>[H,...B])},te=()=>{y(!0),w()},P=()=>{y(!1)};return vt.addEventListener("unreadCount",J),vt.addEventListener("notification",ne),vt.addEventListener("connected",te),vt.addEventListener("disconnected",P),w(),()=>{vt.removeEventListener("unreadCount",J),vt.removeEventListener("notification",ne),vt.removeEventListener("connected",te),vt.removeEventListener("disconnected",P),vt.unsubscribeFromNotifications()}}else console.error(`No ${e?"exhibitor":"admin"} token found in localStorage`)}},[S,e]);const w=async()=>{if(S){a(!0);try{const L=await vt.getNotifications(1,10);L.success&&(s(L.data.notifications),c(L.data.unreadCount))}catch(L){console.error("Error fetching notifications:",L)}finally{a(!1)}}},k=L=>{l(L),L&&(g.current&&g.current.classList.remove("bell-animate"),w())},b=async L=>{if(L.isRead||await j(L),l(!1),L.entityId&&L.entityType){let z="";switch(L.entityType){case"Booking":z=e?`/exhibitor/bookings/${L.entityId}`:"/bookings";break;case"Invoice":z=e?`/exhibitor/invoice/${L.entityId}`:`/invoice/${L.entityId}`;break;case"Exhibition":z=`/exhibition/${L.entityId}`;break;case"Exhibitor":z=`/exhibitors?id=${L.entityId}`;break;default:z=""}t(z||"/notifications")}else t("/notifications")},j=async L=>{try{await vt.markAsRead(L._id),s(r.map(z=>z._id===L._id?{...z,isRead:!0}:z))}catch(z){console.error("Error marking notification as read:",z)}},A=async L=>{try{await vt.deleteNotification(L._id),s(r.filter(z=>z._id!==L._id)),L.isRead||c(z=>Math.max(0,z-1))}catch(z){console.error("Error deleting notification:",z)}},E=()=>{l(!1),t("/notifications")},C=async()=>{try{await vt.markAllAsRead(),s(r.map(L=>({...L,isRead:!0}))),c(0)}catch(L){console.error("Error marking all notifications as read:",L)}},I=async()=>{try{await vt.deleteAllNotifications(),s([]),c(0)}catch(L){console.error("Error deleting all notifications:",L)}},F=()=>u==="unread"?r.filter(L=>!L.isRead):r.slice(0,10),N=L=>{p(L)},U=L=>{var z;return{_id:L._id,recipient:L.recipient,recipientType:L.recipientType||"admin",title:L.title,message:L.message,type:Rm(L.type),priority:Pm(L.priority),isRead:L.isRead,readAt:L.readAt,entityId:L.entityId,entityType:L.entityType,data:L.data,createdAt:L.createdAt,updatedAt:L.updatedAt||L.createdAt,id:L._id,userId:L.recipient,source:(z=L.data)==null?void 0:z.source,status:L.isRead?lc.READ:lc.UNREAD}},M=n.jsxs("div",{className:"notification-dropdown",children:[n.jsxs("div",{className:"notification-header",children:[n.jsx(Fm,{level:5,style:{margin:0},children:"Notifications"}),n.jsxs(ue,{children:[n.jsx(re,{type:"text",size:"small",icon:n.jsx(Ks,{}),onClick:w,loading:i,className:"header-btn",title:"Refresh notifications"}),n.jsx(re,{type:"text",size:"small",icon:n.jsx(vc,{}),onClick:C,disabled:d===0,className:"header-btn",title:"Mark all as read"}),n.jsx(re,{type:"text",size:"small",danger:!0,icon:n.jsx(sr,{}),onClick:I,disabled:r.length===0,className:"header-btn",title:"Clear all notifications"}),n.jsx(re,{type:"text",size:"small",icon:n.jsx(Ri,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),n.jsx(re,{type:"text",size:"small",icon:n.jsx(Zr,{}),onClick:()=>l(!1),className:"header-btn",title:"Close"})]})]}),n.jsx(Jt,{activeKey:u,onChange:N,size:"small",className:"notification-tabs",items:[{key:"all",label:n.jsx("span",{children:"All"})},{key:"unread",label:n.jsxs("span",{className:"tab-label",children:["Unread",n.jsx(gr,{count:d,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),n.jsx("div",{className:"notification-list",children:n.jsx(Vt,{spinning:i,children:F().length===0?n.jsx(bt,{image:bt.PRESENTED_IMAGE_SIMPLE,description:u==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):n.jsx(on,{dataSource:F(),renderItem:L=>n.jsx(Ku,{notification:U(L),onView:()=>b(L),onMarkAsRead:()=>j(L),onDelete:A})})})}),n.jsx(it,{style:{margin:"0"}}),n.jsx("div",{className:"notification-footer",children:n.jsx(re,{type:"link",onClick:E,children:"View All Notifications"})})]});return n.jsx("div",{ref:g,className:`bell-container ${h?"bell-animate":""}`,children:n.jsx(Vn,{overlay:M,trigger:["click"],open:o,onOpenChange:k,placement:"bottomRight",getPopupContainer:L=>L.parentNode,overlayClassName:"notification-dropdown-overlay",children:n.jsx("div",{className:"bell-trigger",children:n.jsx(gr,{count:d,className:"notification-badge",size:"default",overflowCount:99,children:n.jsx(yc,{className:"notification-bell-icon"})})})})})};class Lm{async getSettings(){return(await ke.get("/settings")).data}async updateSettings(t){return(await ke.put("/settings",t)).data}async uploadLogo(t){const r=new FormData;return r.append("file",t),(await ke.post("/settings/upload/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Dc=new Lm,Om={settings:null,loading:!1,error:null},bi=et("settings/fetchSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Dc.getSettings()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch settings")}}),wi=et("settings/updateSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Dc.updateSettings(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to update settings")}}),Ga=et("settings/uploadLogo",async(e,{dispatch:t,rejectWithValue:r})=>{var s,i;try{const a=await Dc.uploadLogo(e);return a.path&&await t(wi({logo:a.path})),a}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to upload logo")}}),Bm=br({name:"settings",initialState:Om,reducers:{},extraReducers:e=>{e.addCase(bi.pending,t=>{t.loading=!0,t.error=null}).addCase(bi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(bi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(wi.pending,t=>{t.loading=!0,t.error=null}).addCase(wi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(wi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ga.pending,t=>{t.loading=!0,t.error=null}).addCase(Ga.fulfilled,t=>{t.loading=!1}).addCase(Ga.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),Mm=Bm.reducer,$m=()=>{const{user:e}=qe(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access")||s.includes("manage_all"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,`${a}`,`${o}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Header:Um,Sider:zm,Content:qm}=Nt,Wm=Ee.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,Hm=Ee.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,Vm=Ee.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;Ee.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const Ct=({children:e})=>{const[t,r]=_.useState(!1),s=tt(),i=lt(),a=Fn(),o=qe(w=>w.auth.user),{settings:l}=qe(w=>w.settings),[d,c]=_.useState("/logo.png"),[h,f]=_.useState(!1),{hasPermission:u}=$m(),p=_.useCallback(async()=>{try{f(!0),await i(Ua()).unwrap()}catch{}finally{f(!1)}},[i]);_.useEffect(()=>{const w=setInterval(()=>{p()},3e5);return()=>clearInterval(w)},[p]),_.useEffect(()=>{p()},[a.pathname,p]),_.useEffect(()=>{},[o,u]),_.useEffect(()=>{i(bi())},[i]);const g=[{key:"dashboard",icon:n.jsx(fo,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>s("/dashboard")},{key:"exhibition",icon:n.jsx(Lo,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>s("/exhibition")},{key:"stalls",icon:n.jsx(wr,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>s("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>s("/stall-types")}]},{key:"bookings",icon:n.jsx(St,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>s("/bookings")},{key:"amenities",icon:n.jsx(wx,{}),label:"Amenities",requiredPermission:"view_amenities",onClick:()=>s("/amenities")},{key:"invoices",icon:n.jsx(Cn,{}),label:"Invoices",requiredPermission:"view_invoices",onClick:()=>s("/invoices")},{key:"exhibitors",icon:n.jsx(bc,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>s("/exhibitors")},{key:"index",icon:n.jsx(ht,{}),label:"Users",requiredPermission:"users_view",onClick:()=>s("/index")},{key:"roles",icon:n.jsx(jx,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>s("/roles")},{key:"settings",icon:n.jsx(Ri,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>s("/settings")}],x=w=>w.filter(k=>{if(k.requiredPermission&&!u(k.requiredPermission))return!1;if(k.children){const b=x(k.children);if(b.length===0)return!1;k.children=b}return!0}),m=x(g),v=w=>w.map(k=>{const{requiredPermission:b,...j}=k;return j.children&&(j.children=v(j.children)),j}),S=v(m);_.useEffect(()=>{const w={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",amenities:"view_amenities",invoices:"view_invoices",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},k=a.pathname.substring(1)||"dashboard",b=w[k];if(b&&!u(b)){const j=m.length>0?m[0]:null;j?s(`/${j.key}`):(i(Td()),s("/login"))}},[a.pathname,u,m,s,i]),_.useEffect(()=>{const w=localStorage.getItem("cachedLogoUrl"),k=localStorage.getItem("logoTimestamp"),b=new Date().getTime();if(w&&k&&b-parseInt(k)<36e5)c(w);else if(l!=null&&l.logo){const j=`${ke.defaults.baseURL}/public/logo`;c(j),localStorage.setItem("cachedLogoUrl",j),localStorage.setItem("logoTimestamp",b.toString());const A=new Image;A.src=j}},[l]);const T=[{key:"profile",label:"Profile",icon:n.jsx(ht,{}),onClick:()=>s("/account")},{key:"settings",label:"Settings",icon:n.jsx(Ri,{}),onClick:()=>s("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(uo,{}),onClick:()=>{i(Td()),s("/login")}}],y=()=>{const w=a.pathname.substring(1);return w.charAt(0).toUpperCase()+w.slice(1)};return n.jsxs(Nt,{style:{minHeight:"100vh"},children:[n.jsxs(zm,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsx(Wm,{children:n.jsx(Hm,{children:n.jsx(Vm,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})}),n.jsx(hr,{mode:"inline",selectedKeys:[a.pathname.substring(1)||"dashboard"],items:S,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Nt,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Um,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(re,{type:"text",icon:t?n.jsx(vu,{}):n.jsx(bu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:y()})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("div",{style:{marginRight:20},children:n.jsx(Dm,{isExhibitor:!1})}),n.jsx(Vn,{menu:{items:T},placement:"bottomRight",children:n.jsxs(ue,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Ur,{size:"small",icon:n.jsx(ht,{}),style:{backgroundColor:"#5046e5"}}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.username)||"User"})]})})]})]}),n.jsx(qm,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},Rd=localStorage.getItem("exhibitor_token"),Gm=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,Ym={isAuthenticated:!!Rd,exhibitor:Gm,token:Rd,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},Xu=br({name:"exhibitorAuth",initialState:Ym,reducers:{setExhibitorCredentials:(e,t)=>{e.exhibitor=t.payload.exhibitor,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:e=>{e.exhibitor=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(e,t)=>{e.showLoginModal=!0,e.showForgotPasswordModal=!1,e.loginContext=t.payload||null},hideLoginModal:e=>{e.showLoginModal=!1,e.loginContext=null},showForgotPasswordModal:e=>{e.showForgotPasswordModal=!0,e.showLoginModal=!1},hideForgotPasswordModal:e=>{e.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:cc,exhibitorLogout:Qu,showLoginModal:cs,hideLoginModal:ua,showForgotPasswordModal:Km,hideForgotPasswordModal:hl}=Xu.actions,Xm=Xu.reducer,{Header:Qm,Sider:Jm,Content:Zm}=Nt,ws=({children:e})=>{var f;const[t,r]=_.useState(!1),s=tt(),i=lt(),a=Fn(),o=qe(u=>u.exhibitorAuth.exhibitor),l=()=>{const u=a.pathname;return u.includes("/exhibitor/dashboard")?"dashboard":u.includes("/exhibitor/bookings")?"bookings":u.includes("/exhibitor/profile")?"profile":u.includes("/exhibitions")?"exhibitions":u.includes("/exhibitor/support")?"help":"dashboard"},d=[{key:"dashboard",icon:n.jsx(fo,{}),label:"Dashboard",onClick:()=>s("/exhibitor/dashboard")},{key:"bookings",icon:n.jsx(wr,{}),label:"My Bookings",onClick:()=>s("/exhibitor/bookings")},{key:"profile",icon:n.jsx(ht,{}),label:"My Profile",onClick:()=>s("/exhibitor/profile")},{key:"exhibitions",icon:n.jsx(Cn,{}),label:"Exhibitions",onClick:()=>s("/exhibitions")},{key:"help",icon:n.jsx(Sx,{}),label:"Help & Support",onClick:()=>s("/exhibitor/support")}],c=[{key:"profile",label:"My Profile",icon:n.jsx(ht,{}),onClick:()=>s("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:n.jsx(wr,{}),onClick:()=>s("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(uo,{}),onClick:()=>{i(Qu()),s("/")}}],h=()=>{const u=a.pathname.replace("/exhibitor/","");return u==="dashboard"?"Dashboard":u.startsWith("bookings")?u.includes("/")?"Booking Details":"My Bookings":u==="profile"?"My Profile":u==="support"?"Help & Support":u.charAt(0).toUpperCase()+u.slice(1)};return n.jsxs(Nt,{style:{minHeight:"100vh"},children:[n.jsxs(Jm,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[n.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&n.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),n.jsx(hr,{mode:"inline",selectedKeys:[l()],items:d,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Nt,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Qm,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(re,{type:"text",icon:t?n.jsx(vu,{}):n.jsx(bu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:h()})]}),n.jsx(Vn,{menu:{items:c},placement:"bottomRight",children:n.jsxs(ue,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Ur,{size:"small",style:{backgroundColor:"#5046e5"},children:((f=o==null?void 0:o.companyName)==null?void 0:f.charAt(0).toUpperCase())||"E"}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.companyName)||"Exhibitor"})]})})]}),n.jsx(Zm,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},{Title:Ju,Text:ci,Paragraph:eg}=Me,Qi=Yn`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,tg=Yn`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,rg=Yn`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Lc=Yn`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,Zu=Yn`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,ng=Yn`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,sg=Yn`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,ig=Yn`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,ag=Ee.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,og=Ee.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${tg} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,lg=Ee.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${e=>.1+e.index%3*.05}), transparent);
  left: ${e=>20+e.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${e=>e.isHovered?ng:sg} ${e=>1.5+e.index*.2}s ease-out;
  animation-delay: ${e=>e.index*.1}s;
  animation-fill-mode: forwards;
`,cg=Ee.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${rg} 0.8s ease-out forwards;
`,dg=Ee.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,hg=Ee.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${ig} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Lc} 2s ease-in-out infinite;
  }
`,ug=Ee.span`
  margin-left: 10px;
  animation: ${Qi} 0.5s ease-out;
`,fg=Ee.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,xg=Ee.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,pg=Ee.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${Qi} 0.8s ease-out forwards;
`,mg=Ee.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,gg=Ee.img`
  width: 140px;
  height: auto;
  animation: ${Zu} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;Ee.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const yg=Ee.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${Qi} 0.8s ease-out forwards;
`,vg=Ee.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,bg=Ee(Ju)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,wg=Ee(eg)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,jg=Ee.div`
  width: 100%;
  max-width: 400px;
  animation: ${Qi} 0.6s ease-out;
`,Sg=Ee(he)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Eg=Ee(he.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Tg=Ee(re)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Lc} 0.5s ease-in-out;
  }
`,_g=Ee.div`
  margin-bottom: 2rem;
  text-align: center;
`,fa=Ee(W.Item)`
  margin-bottom: 24px;
`,kg=Ee.div`
  margin-top: 8px;
`,Cg=Ee.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,Ag=Ee(Zl)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,Ig=Ee.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${Qi} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Lc} 0.5s ease-in-out;
  }
`,Pd=()=>n.jsxs(dg,{children:[n.jsxs(hg,{viewBox:"0 0 50 50",children:[n.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),n.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),n.jsx(ug,{children:"Signing in..."})]}),Ng=Ee.div`
  position: absolute;
  width: ${e=>e.size}px;
  height: ${e=>e.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${Zu} ${e=>e.duration}s ease-in-out infinite;
  animation-delay: ${e=>e.delay}s;
  top: ${e=>e.top}%;
  left: ${e=>e.left}%;
  z-index: 1;
`,Fg=e=>{if(!e)return 0;const t=e.length>=8,r=/[A-Z]/.test(e),s=/[a-z]/.test(e),i=/\d/.test(e),a=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e),o=[t,r,s,i,a];return o.filter(d=>d).length/o.length*100},Rg=e=>e<30?"#ff4d4f":e<60?"#faad14":e<80?"#1890ff":"#52c41a",Pg=e=>e<30?"Weak":e<60?"Fair":e<80?"Good":"Strong",Dg=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],Lg=()=>{const e=tt(),t=lt(),[r,s]=_.useState(null),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState(""),[h,f]=_.useState(!1),u=qe(L=>L.auth.isAuthenticated),p=_.useRef(null),[g,x]=_.useState({x:0,y:0}),[m,v]=_.useState(!1),[S,T]=_.useState(!1),[y]=W.useForm(),[w,k]=_.useState("/logo.png"),[b,j]=_.useState("EXHIBITION MANAGER");_.useEffect(()=>{const L=localStorage.getItem("cachedLogoUrl"),z=localStorage.getItem("logoTimestamp"),J=new Date().getTime();if(L&&z&&J-parseInt(z)<36e5)k(L);else{const ne=`${ke.defaults.baseURL}/public/logo`;k(ne),localStorage.setItem("cachedLogoUrl",ne),localStorage.setItem("logoTimestamp",J.toString());const te=new Image;te.src=ne}fetch(`${ke.defaults.baseURL}/public/site-info`).then(ne=>ne.json()).then(ne=>{ne.siteName&&j(ne.siteName)}).catch(ne=>{console.error("Error fetching site info:",ne)})},[]),_.useEffect(()=>{const L=localStorage.getItem("rememberedUser");if(L)try{const z=JSON.parse(L);y.setFieldsValue({username:z.username,password:z.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[y]),_.useEffect(()=>{const L=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(L)},[]),_.useEffect(()=>{u&&e("/dashboard")},[u,e]),_.useEffect(()=>{const L=z=>{if(p.current){const J=p.current.getBoundingClientRect(),ne=z.clientX-J.left,te=z.clientY-J.top;ne>=0&&ne<=J.width&&te>=0&&te<=J.height&&x({x:ne,y:te})}};return window.addEventListener("mousemove",L),()=>{window.removeEventListener("mousemove",L)}},[]);const A=async L=>{var z;try{s(null),a(!0);const J=await yo.login({username:L.username,password:L.password}),{user:ne,token:te}=J.data;if(!ne||!te)throw new Error("Invalid response from server");L.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:L.username,password:L.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),l(!0),setTimeout(()=>{t(Pu({user:ne,token:te})),Se.success("Login successful!"),e("/dashboard")},1200)}catch(J){console.error("Login Error:",J),console.error("Response Data:",(z=J.response)==null?void 0:z.data);let ne="Authentication Error",te="Invalid username or password.";if(J.response&&typeof J.response=="object"){const{status:P,data:H}=J.response;P===401?(ne="Invalid Credentials",te="The username or password you entered is incorrect."):P===403?(ne="Access Denied",te="You do not have permission to access this resource."):P===400?(ne="Invalid Request",te="Please check your input and try again."):P===500&&(ne="Server Error",te="A server error occurred. Please try again later."),H&&typeof H=="object"&&H.message&&(te=H.message)}else J.request?(ne="Connection Error",te="Unable to connect to the server. Please check your internet connection."):J.message&&(te=J.message);s({title:ne,message:te})}finally{a(!1)}},E=Fg(d),C=Rg(E),I=Pg(E),F=localStorage.getItem("rememberUser")==="true";if(u)return n.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[n.jsx(Pd,{}),n.jsx(ci,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const N=L=>{const z=[];for(let J=0;J<L;J++){const ne=Math.random()*20+8,te=Math.random()*3,P=Math.random()*10+6,H=Math.random()*100,B=Math.random()*100;z.push(n.jsx(Ng,{size:ne,delay:te,duration:P,top:H,left:B,style:{transform:`translate(${g.x/50*(J%5-2)}px, ${g.y/50*(J%5-2)}px)`,opacity:S?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},J))}return z},U=L=>{const z=[];for(let J=0;J<L;J++)z.push(n.jsx(lg,{index:J,isHovered:S},J));return z},M=L=>{T(L)};return n.jsxs(ag,{style:{opacity:m?1:0,transition:"opacity 0.3s ease-out"},children:[o&&n.jsx(Ig,{children:n.jsx(wc,{})}),n.jsxs(og,{onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),children:[n.jsx(pg,{children:n.jsx(mg,{children:n.jsx(gg,{src:w,alt:"Exhibition Manager Logo",onError:()=>k("/logo.png")})})}),n.jsxs(fg,{ref:p,children:[N(12),U(8)]}),n.jsxs(xg,{children:[n.jsx(yg,{children:n.jsx(vg,{children:b})}),n.jsx(bg,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),n.jsx(wg,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),n.jsx(cg,{children:n.jsxs(jg,{children:[n.jsxs(_g,{children:[n.jsx(Ju,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),n.jsx(ci,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),r&&n.jsx(It,{message:r.title,description:r.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:n.jsx(re,{size:"small",type:"text",onClick:()=>s(null),children:"Dismiss"})}),n.jsxs(W,{form:y,name:"login",initialValues:{remember:F},onFinish:A,layout:"vertical",children:[n.jsx(fa,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:n.jsx(Sg,{prefix:n.jsx(ht,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:i,autoComplete:"username"})}),n.jsx(fa,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:h&&n.jsxs(kg,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[n.jsx(ci,{type:"secondary",children:"Password Strength:"}),n.jsx(ci,{strong:!0,style:{color:C},children:I})]}),n.jsx(Qr,{percent:E,showInfo:!1,strokeColor:C,size:"small"}),n.jsx("div",{style:{marginTop:"8px"},children:n.jsx(Ke,{title:n.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Dg.map((L,z)=>n.jsx("li",{children:L},z))}),children:n.jsxs(ci,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx(Gt,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:n.jsx(Eg,{prefix:n.jsx(En,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:i,autoComplete:"current-password",onChange:L=>c(L.target.value),onFocus:()=>f(!0),onBlur:()=>f(!1)})}),n.jsx(Cg,{children:n.jsx(fa,{name:"remember",valuePropName:"checked",noStyle:!0,children:n.jsx(Ag,{children:"Remember me"})})}),n.jsx(fa,{children:i?n.jsx(Pd,{}):n.jsx(Tg,{type:"primary",htmlType:"submit",block:!0,className:o?"success":"",children:"Sign in"})})]})]})})]})},ef={getDashboardStats:async()=>{var e;try{const r=(await ke.get("/users")).data||[],s=await ke.get("/bookings"),i=((e=s.data)==null?void 0:e.data)||s.data||[],o=(await ke.get("/exhibitions")).data||[],l=i.filter(h=>h.status==="confirmed"||h.status==="approved").reduce((h,f)=>h+(f.amount||0),0),d=[...i].sort((h,f)=>new Date(f.createdAt).getTime()-new Date(h.createdAt).getTime()).slice(0,5),c=[...r].sort((h,f)=>new Date(f.createdAt||0).getTime()-new Date(h.createdAt||0).getTime()).slice(0,5);return{userCount:r.length,bookingCount:i.length,totalRevenue:l,exhibitionCount:o.length,recentBookings:d,recentUsers:c}}catch(t){return console.error("Error fetching dashboard stats:",t),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:e,recentUsers:t}=await ef.getDashboardStats();return[...e.map(s=>({id:s._id,type:"booking",title:`New booking ${s._id.substring(0,8)}`,timestamp:s.createdAt,data:s})),...t.map(s=>({id:s._id,type:"user",title:`User ${s.username||"unknown"}`,timestamp:s.createdAt,data:s}))].sort((s,i)=>new Date(i.timestamp).getTime()-new Date(s.timestamp).getTime())}catch(e){return console.error("Error fetching recent activities:",e),[]}}},{Title:Og,Text:cr}=Me,Bg=({title:e,value:t,icon:r,color:s,gradient:i,loading:a})=>n.jsxs(de,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:i,border:"none",overflow:"hidden",position:"relative"},children:[n.jsx("div",{className:"stat-card-background"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[n.jsx(cr,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:e}),n.jsx(cr,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:a?n.jsx(Vt,{size:"small"}):t})]}),n.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:r})]})]}),Mg=()=>{const[e,t]=_.useState(!0),[r,s]=_.useState(0),[i,a]=_.useState(0),[o,l]=_.useState(0),[d,c]=_.useState(0),[h,f]=_.useState([]),[u,p]=_.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});_.useEffect(()=>{(async()=>{t(!0);try{const m=await ef.getDashboardStats();s(m.userCount),a(m.bookingCount),l(m.totalRevenue),c(m.exhibitionCount);const v=[];m.recentBookings.slice(0,3).forEach(S=>{v.push({id:S._id,icon:n.jsx(xo,{}),color:"#2563EB",text:n.jsxs(cr,{children:["New booking ",n.jsxs(cr,{strong:!0,children:["#",S._id.substring(0,8)]})," received"]}),timestamp:new Date(S.createdAt).toLocaleString()})}),m.recentUsers.slice(0,2).forEach(S=>{v.push({id:S._id,icon:n.jsx(ht,{}),color:"#7C3AED",text:n.jsxs(cr,{children:["User ",n.jsxs(cr,{strong:!0,children:["'",S.username,"'"]})," ",S.createdAt?"registered":"active"]}),timestamp:S.createdAt?new Date(S.createdAt).toLocaleString():"Recently"})}),v.sort((S,T)=>new Date(T.timestamp).getTime()-new Date(S.timestamp).getTime()),f(v)}catch(m){console.error("Error fetching dashboard data:",m)}finally{t(!1)}})()},[]);const g=[{title:"Total Users",value:r,icon:n.jsx(ht,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:i,icon:n.jsx(xo,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`${o.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:n.jsx(po,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:d,icon:n.jsx(Ex,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx(Og,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),n.jsx(Ne,{gutter:[24,24],children:g.map((x,m)=>n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsx(Bg,{...x,loading:e})},m))}),n.jsxs(Ne,{gutter:[24,24],style:{marginTop:"24px"},children:[n.jsx(Q,{xs:24,lg:12,children:n.jsx(de,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:e,children:h.length>0?n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:h.map(x=>n.jsxs("div",{className:"activity-item",children:[xt.cloneElement(x.icon,{style:{color:x.color}}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[x.text,n.jsx(cr,{type:"secondary",style:{fontSize:"12px"},children:x.timestamp})]})]},x.id))}):n.jsx(cr,{type:"secondary",children:"No recent activity found"})})}),n.jsx(Q,{xs:24,lg:12,children:n.jsx(de,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator online"}),n.jsxs(cr,{children:["Server Status: ",n.jsx(cr,{strong:!0,type:"success",children:u.server})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator connected"}),n.jsxs(cr,{children:["Database Status: ",n.jsx(cr,{strong:!0,type:"success",children:u.database})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator backup"}),n.jsxs(cr,{children:["Last Backup: ",n.jsx(cr,{strong:!0,children:u.lastBackup})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator normal"}),n.jsxs(cr,{children:["System Load: ",n.jsx(cr,{strong:!0,children:u.systemLoad})]})]})]})})})]})]})},Fr={getExhibitions:()=>Bn.get("/public/exhibitions"),getExhibition:e=>Bn.get(`/public/exhibitions/${e}`),getLayout:e=>Bn.get(`/public/exhibitions/${e}/layout`),getStallDetails:(e,t)=>Bn.get(`/public/exhibitions/${e}/stalls/${t}`),bookStall:(e,t,r)=>Bn.post(`/public/exhibitions/${e}/stalls/${t}/book`,r),bookMultipleStalls:(e,t)=>Bn.post(`/public/exhibitions/${e}/stalls/book-multiple`,t),searchExhibitors:e=>Bn.get("/public/exhibitors/search",{params:{query:e}}),exhibitorBookStalls:e=>ke.post(`/exhibitor-bookings/${e.exhibitionId}`,e),getExhibitorBookings:()=>ke.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:e=>ke.get(`/exhibitor-bookings/${e}`),cancelExhibitorBooking:e=>ke.patch(`/exhibitor-bookings/${e}/cancel`),getExhibitorBookingInvoice:e=>ke.get(`/exhibitor-bookings/${e}/invoice`)},{Title:$g,Text:yn,Paragraph:X4}=Me,Ug=()=>{const[e,t]=_.useState([]),[r,s]=_.useState(!0),[i,a]=_.useState(null),[o,l]=_.useState([]),[d,c]=_.useState(!0),h=qe(y=>y.exhibitorAuth.exhibitor),f=tt();_.useEffect(()=>{u(),p()},[]);const u=async()=>{try{s(!0),a(null);const y=await Fr.getExhibitorBookings();t(y.data||[])}catch(y){console.error("Failed to fetch bookings:",y),a("Unable to load your bookings at this time. Please try again later.")}finally{s(!1)}},p=async()=>{try{c(!0);const y=await Fr.getExhibitions(),w=nt(),k=(y.data||[]).filter(b=>b.isActive&&nt(b.endDate).isAfter(w)).slice(0,3);l(k)}catch(y){console.error("Failed to fetch upcoming exhibitions:",y)}finally{c(!1)}},g=e.filter(y=>y.status==="approved").length,x=e.filter(y=>y.status==="pending").length;e.filter(y=>y.status==="rejected").length;const m=e.filter(y=>y.status==="confirmed").length,v=y=>{switch(y){case"approved":return n.jsxs(_e,{color:"success",children:[n.jsx(St,{})," Approved"]});case"pending":return n.jsxs(_e,{color:"warning",children:[n.jsx(Qt,{})," Pending"]});case"rejected":return n.jsxs(_e,{color:"error",children:[n.jsx(Zr,{})," Rejected"]});case"confirmed":return n.jsxs(_e,{color:"blue",children:[n.jsx(St,{})," Confirmed"]});case"cancelled":return n.jsxs(_e,{color:"default",children:[n.jsx(Zr,{})," Cancelled"]});default:return n.jsx(_e,{children:"Unknown"})}},S=y=>{f(`/exhibitor/invoice/${y}`)},T=(y,w)=>y.status===w;return n.jsxs("div",{children:[n.jsxs($g,{level:2,children:["Welcome, ",(h==null?void 0:h.companyName)||"Exhibitor"]}),n.jsx(yn,{type:"secondary",children:"Here's an overview of your exhibition activities"}),i&&n.jsx(It,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),x>0&&n.jsx(It,{message:"Pending Approvals",description:`You have ${x} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(re,{size:"small",type:"primary",onClick:()=>f("/exhibitor/bookings"),children:"View Bookings"})}),n.jsxs(Ne,{gutter:[24,24],style:{marginTop:24},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Total Bookings",value:r?"-":e.length,prefix:n.jsx(wr,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Confirmed",value:r?"-":m,valueStyle:{color:"#1890ff"},prefix:n.jsx(St,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Approved",value:r?"-":g,valueStyle:{color:"#3f8600"},prefix:n.jsx(St,{}),loading:r})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Pending",value:r?"-":x,valueStyle:{color:"#faad14"},prefix:n.jsx(Qt,{}),loading:r})})})]}),n.jsx(de,{title:"Recent Bookings",extra:n.jsx(Nr,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:r,children:r?n.jsx(ln,{active:!0,paragraph:{rows:3}}):e.length>0?n.jsx(on,{dataSource:e.slice(0,5),renderItem:y=>{var w,k,b,j,A;return n.jsxs(on.Item,{actions:[n.jsx(re,{type:"link",onClick:()=>f(`/exhibitor/bookings/${y._id}`),children:"View Details"},"view"),T(y,"approved")||T(y,"confirmed")?n.jsx(re,{type:"link",icon:n.jsx(wu,{}),onClick:()=>S(y._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[n.jsx(on.Item.Meta,{title:n.jsxs("div",{children:[n.jsx(yn,{strong:!0,children:((w=y.exhibitionId)==null?void 0:w.name)||"Exhibition"}),n.jsxs(yn,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((k=y.stallIds)==null?void 0:k.map(E=>E.number).join(", "))||"N/A"]})]}),description:n.jsxs(ue,{direction:"vertical",size:1,children:[n.jsxs("div",{children:[n.jsxs(yn,{children:["Booked on: ",nt(y.createdAt).format("MMM D, YYYY")]}),n.jsx(it,{type:"vertical"}),n.jsxs(yn,{children:["Amount: ",((b=y.amount)==null?void 0:b.toLocaleString())||"N/A"]})]}),n.jsx("div",{children:n.jsxs(yn,{children:["Exhibition date: ",nt((j=y.exhibitionId)==null?void 0:j.startDate).format("MMM D")," - ",nt((A=y.exhibitionId)==null?void 0:A.endDate).format("MMM D, YYYY")]})})]})}),v(y.status)]})}}):n.jsx(bt,{description:"No bookings found",image:bt.PRESENTED_IMAGE_SIMPLE})}),n.jsx(de,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:d,extra:n.jsx(Nr,{to:"/exhibitions",children:"View All"}),children:d?n.jsx(ln,{active:!0,paragraph:{rows:3}}):o.length>0?n.jsx(on,{dataSource:o,renderItem:y=>n.jsx(on.Item,{actions:[n.jsx(re,{type:"primary",onClick:()=>f(`/exhibitions/${y._id}/layout`),children:"Book Stall"},"book")],children:n.jsx(on.Item.Meta,{title:y.name,description:n.jsxs(ue,{direction:"vertical",size:1,children:[n.jsx(yn,{children:y.venue}),n.jsxs(yn,{type:"secondary",children:[nt(y.startDate).format("MMM D")," - ",nt(y.endDate).format("MMM D, YYYY")]})]})})})}):n.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[n.jsx(Cn,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),n.jsxs("div",{children:[n.jsx(yn,{children:"No upcoming exhibitions at the moment"}),n.jsx("div",{style:{marginTop:16},children:n.jsx(Nr,{to:"/exhibitions",children:n.jsx(re,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),n.jsx(Ne,{gutter:[24,24],style:{marginTop:24},children:n.jsx(Q,{span:24,children:n.jsx(de,{title:"Quick Actions",children:n.jsxs(Ne,{gutter:[16,16],children:[n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(re,{type:"primary",icon:n.jsx(wr,{}),block:!0,onClick:()=>f("/exhibitions"),children:"Book New Stall"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(re,{icon:n.jsx(Cn,{}),block:!0,onClick:()=>f("/exhibitor/bookings"),children:"View All Bookings"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(re,{icon:n.jsx(po,{}),block:!0,onClick:()=>f("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),n.jsx(Q,{xs:24,sm:12,md:8,lg:6,children:n.jsx(re,{icon:n.jsx(ht,{}),block:!0,onClick:()=>f("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},{Title:zg,Text:Dn}=Me,{Option:Q4}=Le,{TabPane:js}=Jt,{confirm:qg}=Ye,{Search:Wg}=he,Hg=()=>{const[e,t]=_.useState([]),[r,s]=_.useState(!0),[i,a]=_.useState(null),[o,l]=_.useState(""),[d,c]=_.useState("all"),h=tt(),f=Fn();_.useEffect(()=>{u()},[]),_.useEffect(()=>{const C=new URLSearchParams(f.search).get("status");C&&c(C)},[f]);const u=async()=>{try{s(!0),a(null);const E=await Fr.getExhibitorBookings();t(E.data||[])}catch(E){console.error("Error fetching bookings:",E),a("Failed to load bookings. Please try again.")}finally{s(!1)}},p=E=>{qg({title:"Are you sure you want to cancel this booking?",icon:n.jsx(Xs,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await Fr.cancelExhibitorBooking(E),Se.success("Booking cancelled successfully"),u()}catch(C){console.error("Error cancelling booking:",C),Se.error("Failed to cancel booking")}}})},g=E=>{switch(E){case"approved":return n.jsxs(_e,{color:"success",children:[n.jsx(St,{})," Approved"]});case"pending":return n.jsxs(_e,{color:"warning",children:[n.jsx(Qt,{})," Pending"]});case"rejected":return n.jsxs(_e,{color:"error",children:[n.jsx(Zr,{})," Rejected"]});case"confirmed":return n.jsxs(_e,{color:"blue",children:[n.jsx(St,{})," Confirmed"]});case"cancelled":return n.jsxs(_e,{color:"default",children:[n.jsx(Zr,{})," Cancelled"]});default:return n.jsx(_e,{children:"Unknown"})}},x=E=>{switch(E){case"paid":return n.jsxs(_e,{color:"success",children:[n.jsx(po,{})," Paid"]});case"pending":return n.jsxs(_e,{color:"warning",children:[n.jsx(Qt,{})," Pending"]});case"refunded":return n.jsxs(_e,{color:"default",children:[n.jsx(po,{})," Refunded"]});default:return n.jsx(_e,{children:"Unknown"})}},m=async E=>{try{h(`/exhibitor/invoice/${E}`)}catch(C){console.error("Error navigating to invoice:",C),Se.error("Failed to access invoice. Please try again.")}},v=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(E,C)=>{var I,F;return n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx(Dn,{strong:!0,children:((I=C.exhibitionId)==null?void 0:I.name)||"N/A"}),n.jsx(Dn,{type:"secondary",style:{fontSize:"12px"},children:((F=C.exhibitionId)==null?void 0:F.venue)||"N/A"})]})},sorter:(E,C)=>{var I,F;return(((I=E.exhibitionId)==null?void 0:I.name)||"").localeCompare(((F=C.exhibitionId)==null?void 0:F.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:E=>n.jsx(ue,{direction:"vertical",size:4,children:(E==null?void 0:E.map(C=>n.jsx(_e,{children:C.number},C._id)))||"N/A"})},{title:"Type",key:"stallType",render:(E,C)=>{var I;return n.jsx(ue,{direction:"vertical",size:4,children:((I=C.stallIds)==null?void 0:I.map(F=>{var N;return(N=F.stallTypeId)!=null&&N.name?n.jsx(_e,{color:"blue",children:F.stallTypeId.name},F._id):n.jsx(Dn,{type:"secondary",children:"N/A"},F._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(E,C)=>{var I;return n.jsx(ue,{direction:"vertical",size:4,children:((I=C.stallIds)==null?void 0:I.map(F=>n.jsxs(Dn,{children:[F.dimensions.width,"m x ",F.dimensions.height,"m"]},F._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(E,C)=>{var I,F;return n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsxs(Dn,{children:[n.jsx(Yr,{style:{marginRight:4}}),nt((I=C.exhibitionId)==null?void 0:I.startDate).format("MMM D")," - ",nt((F=C.exhibitionId)==null?void 0:F.endDate).format("MMM D, YYYY")]}),n.jsxs(Dn,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",nt(C.createdAt).format("MMM D, YYYY")]})]})},sorter:(E,C)=>nt(E.createdAt).unix()-nt(C.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:E=>n.jsxs(Dn,{strong:!0,children:["",E.toLocaleString()]}),sorter:(E,C)=>E.amount-C.amount},{title:"Status",key:"status",dataIndex:"status",render:(E,C)=>E==="rejected"&&C.rejectionReason?n.jsxs(Ke,{title:C.rejectionReason,children:[g(E),n.jsx(Gt,{style:{marginLeft:4,color:"#ff4d4f"}})]}):g(E),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(E,C)=>C.status===E},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:E=>x(E),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(E,C)=>C.paymentStatus===E},{title:"Actions",key:"actions",render:(E,C)=>n.jsxs(ue,{children:[n.jsx(re,{type:"link",icon:n.jsx(hn,{}),onClick:()=>h(`/exhibitor/bookings/${C._id}`),children:"Details"}),(C.status==="approved"||C.status==="confirmed")&&n.jsx(re,{type:"link",icon:n.jsx(wu,{}),onClick:()=>m(C._id),children:"Invoice"}),C.status==="pending"&&n.jsx(re,{type:"link",danger:!0,onClick:()=>p(C._id),children:"Cancel"})]})}],S=E=>{l(E)},T=e.filter(E=>{var F,N;const C=(((F=E.exhibitionId)==null?void 0:F.name)||"").toLowerCase().includes(o.toLowerCase())||E.stallIds.some(U=>U.number.toLowerCase().includes(o.toLowerCase()))||(((N=E.exhibitionId)==null?void 0:N.venue)||"").toLowerCase().includes(o.toLowerCase())||(E.customerName||"").toLowerCase().includes(o.toLowerCase()),I=d==="all"||E.status===d;return C&&I}),y=()=>e.length,w=()=>e.filter(E=>E.status==="pending").length,k=()=>e.filter(E=>E.status==="approved").length,b=()=>e.filter(E=>E.status==="confirmed").length,j=()=>e.filter(E=>E.status==="rejected").length,A=()=>e.filter(E=>E.status==="cancelled").length;return n.jsxs("div",{children:[n.jsx(zg,{level:2,children:"My Bookings"}),n.jsx(Dn,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),i&&n.jsx(It,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(re,{type:"primary",onClick:u,children:"Retry"})}),n.jsxs(de,{style:{marginTop:24},children:[n.jsxs(Ne,{gutter:[16,16],style:{marginBottom:16},children:[n.jsx(Q,{flex:"auto",children:n.jsx(Wg,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:S,onChange:E=>l(E.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),n.jsx(Q,{children:n.jsx(re,{icon:n.jsx(Ks,{}),onClick:u,children:"Refresh"})})]}),n.jsxs(Jt,{defaultActiveKey:d,onChange:E=>c(E),children:[n.jsx(js,{tab:`All Bookings (${y()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):T.length>0?n.jsx(st,{columns:v,dataSource:T,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):n.jsx(bt,{description:o?"No bookings match your search criteria":"No bookings found",image:bt.PRESENTED_IMAGE_SIMPLE})},"all"),n.jsx(js,{tab:`Pending (${w()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(st,{columns:v,dataSource:e.filter(E=>E.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(bt,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),n.jsx(js,{tab:`Approved (${k()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(st,{columns:v,dataSource:e.filter(E=>E.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(bt,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),n.jsx(js,{tab:`Confirmed (${b()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(st,{columns:v,dataSource:e.filter(E=>E.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(bt,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),n.jsx(js,{tab:`Rejected (${j()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(st,{columns:v,dataSource:e.filter(E=>E.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(bt,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),n.jsx(js,{tab:`Cancelled (${A()})`,children:r?n.jsx(ln,{active:!0,paragraph:{rows:5}}):n.jsx(st,{columns:v,dataSource:e.filter(E=>E.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(bt,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:Dd,Text:ul}=Me,Vg=()=>{var f,u,p,g,x,m,v,S,T,y,w,k,b;const{id:e}=Dr(),t=tt(),[r,s]=_.useState(null),[i,a]=_.useState(!0);_.useEffect(()=>{o()},[e]);const o=async()=>{try{a(!0);const j=await Fr.getExhibitorBooking(e||"");s(j.data)}catch(j){console.error("Error fetching booking details:",j),Se.error("Failed to load booking details")}finally{a(!1)}},l=async()=>{try{t(`/exhibitor/invoice/${e}`)}catch(j){console.error("Error fetching invoice:",j),Se.error("Failed to retrieve invoice")}},d=j=>{switch(j){case"approved":return n.jsxs(_e,{color:"success",children:[n.jsx(St,{})," Approved"]});case"pending":return n.jsxs(_e,{color:"warning",children:[n.jsx(Qt,{})," Pending"]});case"rejected":return n.jsx(_e,{color:"error",children:"Rejected"});case"confirmed":return n.jsxs(_e,{color:"blue",children:[n.jsx(St,{})," Confirmed"]});case"cancelled":return n.jsx(_e,{color:"default",children:"Cancelled"});default:return n.jsx(_e,{children:"Unknown"})}},c=j=>{switch(j){case"paid":return n.jsx(_e,{color:"success",children:"Paid"});case"pending":return n.jsx(_e,{color:"warning",children:"Pending"});case"refunded":return n.jsx(_e,{color:"default",children:"Refunded"});default:return n.jsx(_e,{children:"Unknown"})}},h=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:j=>`${j.dimensions.width}m  ${j.dimensions.height}m`},{title:"Size",key:"size",render:j=>`${j.dimensions.width*j.dimensions.height} m`},{title:"Rate per m",dataIndex:"ratePerSqm",key:"ratePerSqm",render:j=>`${j.toLocaleString()}`},{title:"Amount",key:"amount",render:(j,A,E)=>{var I;const C=(I=r.calculations)==null?void 0:I.stalls[E];return C?`${C.baseAmount.toLocaleString()}`:"N/A"}}];return i?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:n.jsx(Vt,{size:"large"})}):r?n.jsxs("div",{style:{padding:"20px"},children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(r.status)&&n.jsx(re,{type:"primary",icon:n.jsx(Cn,{}),onClick:l,children:"View Invoice"})]}),n.jsxs(de,{title:"Booking Details",style:{marginBottom:20},children:[n.jsxs(Ve,{bordered:!0,column:{xs:1,sm:2,md:3},children:[n.jsx(Ve.Item,{label:"Booking ID",children:r._id}),n.jsx(Ve.Item,{label:"Exhibition",children:((f=r.exhibitionId)==null?void 0:f.name)||"N/A"}),n.jsx(Ve.Item,{label:"Venue",children:((u=r.exhibitionId)==null?void 0:u.venue)||"N/A"}),n.jsx(Ve.Item,{label:"Booking Date",children:nt(r.createdAt).format("MMM D, YYYY")}),n.jsxs(Ve.Item,{label:"Exhibition Dates",children:[nt((p=r.exhibitionId)==null?void 0:p.startDate).format("MMM D, YYYY")," -",nt((g=r.exhibitionId)==null?void 0:g.endDate).format("MMM D, YYYY")]}),n.jsx(Ve.Item,{label:"Status",children:d(r.status)}),n.jsx(Ve.Item,{label:"Payment Status",children:c(r.paymentStatus||"pending")}),n.jsxs(Ve.Item,{label:"Total Amount",children:["",((x=r.amount)==null?void 0:x.toLocaleString())||"N/A"]})]}),r.rejectionReason&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Dd,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),n.jsx(ul,{children:r.rejectionReason})]})]}),n.jsx(de,{title:"Stall Details",style:{marginBottom:20},children:n.jsx(st,{dataSource:r.stallIds||[],columns:h,rowKey:"_id",pagination:!1})}),n.jsx(de,{title:"Calculation Summary",children:n.jsx(Ne,{gutter:[16,16],children:n.jsx(Q,{span:24,children:n.jsxs(Ve,{bordered:!0,column:1,children:[n.jsxs(Ve.Item,{label:"Base Amount",children:["",((m=r.calculations)==null?void 0:m.totalBaseAmount.toLocaleString())||"N/A"]}),((v=r.calculations)==null?void 0:v.totalDiscountAmount)>0&&n.jsxs(Ve.Item,{label:"Discount",children:["- ",((S=r.calculations)==null?void 0:S.totalDiscountAmount.toLocaleString())||"N/A"]}),((T=r.calculations)==null?void 0:T.totalDiscountAmount)>0&&n.jsxs(Ve.Item,{label:"Amount After Discount",children:["",((y=r.calculations)==null?void 0:y.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(k=(w=r.calculations)==null?void 0:w.taxes)==null?void 0:k.map(j=>n.jsxs(Ve.Item,{label:`${j.name} (${j.rate}%)`,children:["+ ",j.amount.toLocaleString()||"N/A"]},j.name)),n.jsx(Ve.Item,{label:"Total Amount",children:n.jsxs(ul,{strong:!0,style:{fontSize:"16px"},children:["",((b=r.amount)==null?void 0:b.toLocaleString())||"N/A"]})})]})})})}),n.jsx(de,{title:"Customer Information",style:{marginTop:20},children:n.jsxs(Ve,{bordered:!0,column:{xs:1,sm:2},children:[n.jsx(Ve.Item,{label:"Company Name",children:r.companyName}),n.jsx(Ve.Item,{label:"Contact Person",children:r.customerName}),n.jsx(Ve.Item,{label:"Email",children:r.customerEmail}),n.jsx(Ve.Item,{label:"Phone",children:r.customerPhone})]})})]}):n.jsx(de,{children:n.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[n.jsx(Dd,{level:3,children:"Booking Not Found"}),n.jsx(ul,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),n.jsx("div",{style:{marginTop:20},children:n.jsx(re,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},dc=Cr.create({baseURL:an}),Ss=Cr.create({baseURL:an});dc.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const es=Cr.create({baseURL:an});es.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const dr={sendRegistrationOTP:async e=>await Ss.post("/exhibitors/send-otp",{email:e}),verifyOTP:async e=>await Ss.post("/exhibitors/verify-otp",e),register:async e=>await Ss.post("/exhibitors/register",e),login:async e=>await Ss.post("/exhibitors/login",e),requestPasswordReset:async e=>await Ss.post("/exhibitors/forgot-password",e),resetPassword:async e=>await Ss.post("/exhibitors/reset-password",e),getProfile:async()=>await dc.get("/exhibitors/profile"),updateProfile:async e=>await dc.put("/exhibitors/profile",e),getExhibitors:async()=>await es.get("/exhibitors/admin/exhibitors"),getExhibitor:async e=>await es.get(`/exhibitors/admin/exhibitors/${e}`),createExhibitor:async e=>await es.post("/exhibitors/admin/exhibitors",e),updateStatus:async(e,t,r)=>await es.put(`/exhibitors/admin/exhibitors/${e}/status`,{status:t,rejectionReason:r}),updateExhibitor:async(e,t)=>await es.put(`/exhibitors/admin/exhibitors/${e}`,t),deleteExhibitor:async e=>await es.delete(`/exhibitors/admin/exhibitors/${e}`)},{Title:Ld,Text:Od}=Me,{TabPane:Bd}=Jt,Gg=()=>{var d;const[e]=W.useForm(),[t,r]=_.useState(!1),[s,i]=_.useState(!1),a=lt(),o=qe(c=>c.exhibitorAuth.exhibitor);_.useEffect(()=>{(async()=>{try{i(!0);const h=await dr.getProfile();h.data&&a(cc({exhibitor:h.data,token:(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||""}))}catch{Se.error("Failed to fetch exhibitor profile")}finally{i(!1)}})()},[a]),_.useEffect(()=>{o&&e.setFieldsValue({companyName:o.companyName||"",contactPerson:o.contactPerson||"",email:o.email||"",phone:o.phone||"",address:o.address||"",website:o.website||"",description:o.description||"",panNumber:o.panNumber||"",gstNumber:o.gstNumber||"",city:o.city||"",state:o.state||"",pinCode:o.pinCode||""})},[o,e]);const l=async c=>{try{r(!0);const h=await dr.updateProfile(c),f=(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||"";a(cc({exhibitor:{...o,...c},token:f})),Se.success("Profile updated successfully")}catch{Se.error("Failed to update profile")}finally{r(!1)}};return n.jsxs("div",{children:[n.jsx(Ld,{level:2,children:"My Profile"}),n.jsx(Od,{type:"secondary",children:"Manage your exhibitor profile information"}),n.jsx(de,{style:{marginTop:24},loading:s,children:n.jsxs(Jt,{defaultActiveKey:"profile",children:[n.jsx(Bd,{tab:"Profile Information",children:n.jsxs(Ne,{gutter:32,children:[n.jsx(Q,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Ur,{size:100,icon:n.jsx(ht,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((d=o==null?void 0:o.companyName)==null?void 0:d.charAt(0).toUpperCase())||"E"}),n.jsx(Ld,{level:4,children:o==null?void 0:o.companyName}),n.jsx(Od,{type:"secondary",children:o==null?void 0:o.email})]})}),n.jsx(Q,{span:18,children:n.jsxs(W,{form:e,layout:"vertical",onFinish:l,initialValues:{companyName:(o==null?void 0:o.companyName)||"",contactPerson:(o==null?void 0:o.contactPerson)||"",email:(o==null?void 0:o.email)||"",phone:(o==null?void 0:o.phone)||"",address:(o==null?void 0:o.address)||"",website:(o==null?void 0:o.website)||"",description:(o==null?void 0:o.description)||"",panNumber:(o==null?void 0:o.panNumber)||"",gstNumber:(o==null?void 0:o.gstNumber)||"",city:(o==null?void 0:o.city)||"",state:(o==null?void 0:o.state)||"",pinCode:(o==null?void 0:o.pinCode)||""},children:[n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:n.jsx(he,{prefix:n.jsx(jc,{}),placeholder:"Company Name"})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:n.jsx(he,{prefix:n.jsx(ht,{}),placeholder:"Contact Person"})})})]}),n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(fn,{}),placeholder:"Email",disabled:!0})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:n.jsx(he,{prefix:n.jsx(Sc,{}),placeholder:"Phone Number"})})})]}),n.jsx(W.Item,{name:"address",label:"Address",children:n.jsx(he.TextArea,{rows:2,placeholder:"Company Address"})}),n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:8,children:n.jsx(W.Item,{name:"city",label:"City",children:n.jsx(he,{placeholder:"City"})})}),n.jsx(Q,{span:8,children:n.jsx(W.Item,{name:"state",label:"State",children:n.jsx(he,{placeholder:"State"})})}),n.jsx(Q,{span:8,children:n.jsx(W.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(he,{placeholder:"PIN Code",maxLength:6})})})]}),n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(he,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(he,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),n.jsx(W.Item,{name:"website",label:"Website",children:n.jsx(he,{placeholder:"https://www.yourcompany.com"})}),n.jsx(W.Item,{name:"description",label:"Company Description",children:n.jsx(he.TextArea,{rows:4,placeholder:"Brief description of your company"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",loading:t,icon:n.jsx(fs,{}),children:"Save Changes"})})]})})]})},"profile"),n.jsx(Bd,{tab:"Change Password",children:n.jsxs(W,{layout:"vertical",onFinish:c=>{Se.success("Password updated successfully")},children:[n.jsx(W.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(he.Password,{placeholder:"Current Password"})}),n.jsx(W.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"New Password"})}),n.jsx(W.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:c})=>({validator(h,f){return!f||c("newPassword")===f?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{placeholder:"Confirm New Password"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var Yg=class extends Error{constructor(t){super(t[0].message);xd(this,"issues");this.name="SchemaError",this.issues=t}},tf=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(tf||{});function Md(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var $d=Oi;function rf(e,t){if(e===t||!($d(e)&&$d(t)||Array.isArray(e)&&Array.isArray(t)))return t;const r=Object.keys(t),s=Object.keys(e);let i=r.length===s.length;const a=Array.isArray(t)?[]:{};for(const o of r)a[o]=rf(e[o],t[o]),i&&(i=e[o]===a[o]);return i?e:a}function $s(e){let t=0;for(const r in e)t++;return t}var Ud=e=>[].concat(...e);function Kg(e){return new RegExp("(^|:)//").test(e)}function Xg(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function vo(e){return e!=null}function Qg(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var Jg=e=>e.replace(/\/$/,""),Zg=e=>e.replace(/^\//,"");function e1(e,t){if(!e)return t;if(!t)return e;if(Kg(t))return t;const r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=Jg(e),t=Zg(t),`${e}${r}${t}`}function t1(e,t,r){return e.has(t)?e.get(t):e.set(t,r).get(t)}var zd=(...e)=>fetch(...e),r1=e=>e.status>=200&&e.status<=299,n1=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function qd(e){if(!Oi(e))return e;const t={...e};for(const[r,s]of Object.entries(t))s===void 0&&delete t[r];return t}function Oc({baseUrl:e,prepareHeaders:t=f=>f,fetchFn:r=zd,paramsSerializer:s,isJsonContentType:i=n1,jsonContentType:a="application/json",jsonReplacer:o,timeout:l,responseHandler:d,validateStatus:c,...h}={}){return typeof fetch>"u"&&r===zd&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(u,p,g)=>{const{getState:x,extra:m,endpoint:v,forced:S,type:T}=p;let y,{url:w,headers:k=new Headers(h.headers),params:b=void 0,responseHandler:j=d??"json",validateStatus:A=c??r1,timeout:E=l,...C}=typeof u=="string"?{url:u}:u,I,F=p.signal;E&&(I=new AbortController,p.signal.addEventListener("abort",I.abort),F=I.signal);let N={...h,signal:F,...C};k=new Headers(qd(k)),N.headers=await t(k,{getState:x,arg:u,extra:m,endpoint:v,forced:S,type:T,extraOptions:g})||k;const U=B=>typeof B=="object"&&(Oi(B)||Array.isArray(B)||typeof B.toJSON=="function");if(!N.headers.has("content-type")&&U(N.body)&&N.headers.set("content-type",a),U(N.body)&&i(N.headers)&&(N.body=JSON.stringify(N.body,o)),b){const B=~w.indexOf("?")?"&":"?",R=s?s(b):new URLSearchParams(qd(b));w+=B+R}w=e1(e,w);const M=new Request(w,N);y={request:new Request(w,N)};let z,J=!1,ne=I&&setTimeout(()=>{J=!0,I.abort()},E);try{z=await r(M)}catch(B){return{error:{status:J?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(B)},meta:y}}finally{ne&&clearTimeout(ne),I==null||I.signal.removeEventListener("abort",I.abort)}const te=z.clone();y.response=te;let P,H="";try{let B;if(await Promise.all([f(z,j).then(R=>P=R,R=>B=R),te.text().then(R=>H=R,()=>{})]),B)throw B}catch(B){return{error:{status:"PARSING_ERROR",originalStatus:z.status,data:H,error:String(B)},meta:y}}return A(z,P)?{data:P,meta:y}:{error:{status:z.status,data:P},meta:y}};async function f(u,p){if(typeof p=="function")return p(u);if(p==="content-type"&&(p=i(u.headers)?"json":"text"),p==="json"){const g=await u.text();return g.length?JSON.parse(g):null}return u.text()}}var Wd=class{constructor(e,t=void 0){this.value=e,this.meta=t}},Bc=Js("__rtkq/focused"),nf=Js("__rtkq/unfocused"),Mc=Js("__rtkq/online"),sf=Js("__rtkq/offline");function zo(e){return e.type==="query"}function s1(e){return e.type==="mutation"}function qo(e){return e.type==="infinitequery"}function bo(e){return zo(e)||qo(e)}function $c(e,t,r,s,i,a){return i1(e)?e(t,r,s,i).filter(vo).map(hc).map(a):Array.isArray(e)?e.map(hc).map(a):[]}function i1(e){return typeof e=="function"}function hc(e){return typeof e=="string"?{type:e}:e}function a1(e,t){return e.catch(t)}var Mi=Symbol("forceQueryFn"),uc=e=>typeof e[Mi]=="function";function o1({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:r,mutationThunk:s,api:i,context:a}){const o=new Map,l=new Map,{unsubscribeQueryResult:d,removeMutationResult:c,updateSubscriptionOptions:h}=i.internalActions;return{buildInitiateQuery:m,buildInitiateInfiniteQuery:v,buildInitiateMutation:S,getRunningQueryThunk:f,getRunningMutationThunk:u,getRunningQueriesThunk:p,getRunningMutationsThunk:g};function f(T,y){return w=>{var j;const k=a.endpointDefinitions[T],b=e({queryArgs:y,endpointDefinition:k,endpointName:T});return(j=o.get(w))==null?void 0:j[b]}}function u(T,y){return w=>{var k;return(k=l.get(w))==null?void 0:k[y]}}function p(){return T=>Object.values(o.get(T)||{}).filter(vo)}function g(){return T=>Object.values(l.get(T)||{}).filter(vo)}function x(T,y){const w=(k,{subscribe:b=!0,forceRefetch:j,subscriptionOptions:A,[Mi]:E,...C}={})=>(I,F)=>{var K;const N=e({queryArgs:k,endpointDefinition:y,endpointName:T});let U;const M={...C,type:"query",subscribe:b,forceRefetch:j,subscriptionOptions:A,endpointName:T,originalArgs:k,queryCacheKey:N,[Mi]:E};if(zo(y))U=t(M);else{const{direction:se,initialPageParam:we}=C;U=r({...M,direction:se,initialPageParam:we})}const L=i.endpoints[T].select(k),z=I(U),J=L(F()),{requestId:ne,abort:te}=z,P=J.requestId!==ne,H=(K=o.get(I))==null?void 0:K[N],B=()=>L(F()),R=Object.assign(E?z.then(B):P&&!H?Promise.resolve(J):Promise.all([H,z]).then(B),{arg:k,requestId:ne,subscriptionOptions:A,queryCacheKey:N,abort:te,async unwrap(){const se=await R;if(se.isError)throw se.error;return se.data},refetch:()=>I(w(k,{subscribe:!1,forceRefetch:!0})),unsubscribe(){b&&I(d({queryCacheKey:N,requestId:ne}))},updateSubscriptionOptions(se){R.subscriptionOptions=se,I(h({endpointName:T,requestId:ne,queryCacheKey:N,options:se}))}});if(!H&&!P&&!E){const se=t1(o,I,{});se[N]=R,R.then(()=>{delete se[N],$s(se)||o.delete(I)})}return R};return w}function m(T,y){return x(T,y)}function v(T,y){return x(T,y)}function S(T){return(y,{track:w=!0,fixedCacheKey:k}={})=>(b,j)=>{const A=s({type:"mutation",endpointName:T,originalArgs:y,track:w,fixedCacheKey:k}),E=b(A),{requestId:C,abort:I,unwrap:F}=E,N=a1(E.unwrap().then(z=>({data:z})),z=>({error:z})),U=()=>{b(c({requestId:C,fixedCacheKey:k}))},M=Object.assign(N,{arg:E.arg,requestId:C,abort:I,unwrap:F,reset:U}),L=l.get(b)||{};return l.set(b,L),L[C]=M,M.then(()=>{delete L[C],$s(L)||l.delete(b)}),k&&(L[k]=M,M.then(()=>{L[k]===M&&(delete L[k],$s(L)||l.delete(b))})),M}}}var af=class extends Yg{constructor(e,t,r,s){super(e),this.value=t,this.schemaName=r,this._bqMeta=s}};async function Qn(e,t,r,s){const i=await e["~standard"].validate(t);if(i.issues)throw new af(i.issues,t,r,s);return i.value}function l1(e){return e}var di=(e={})=>({...e,[Au]:!0});function c1({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:s,api:i,assertTagType:a,selectors:o,onSchemaFailure:l,catchSchemaFailure:d,skipSchemaValidation:c}){const h=(C,I,F,N)=>(U,M)=>{const L=r[C],z=s({queryArgs:I,endpointDefinition:L,endpointName:C});if(U(i.internalActions.queryResultPatched({queryCacheKey:z,patches:F})),!N)return;const J=i.endpoints[C].select(I)(M()),ne=$c(L.providesTags,J.data,void 0,I,{},a);U(i.internalActions.updateProvidedBy([{queryCacheKey:z,providedTags:ne}]))};function f(C,I,F=0){const N=[I,...C];return F&&N.length>F?N.slice(0,-1):N}function u(C,I,F=0){const N=[...C,I];return F&&N.length>F?N.slice(1):N}const p=(C,I,F,N=!0)=>(U,M)=>{const z=i.endpoints[C].select(I)(M()),J={patches:[],inversePatches:[],undo:()=>U(i.util.patchQueryData(C,I,J.inversePatches,N))};if(z.status==="uninitialized")return J;let ne;if("data"in z)if(ip(z.data)){const[te,P,H]=Nu(z.data,F);J.patches.push(...P),J.inversePatches.push(...H),ne=te}else ne=F(z.data),J.patches.push({op:"replace",path:[],value:ne}),J.inversePatches.push({op:"replace",path:[],value:z.data});return J.patches.length===0||U(i.util.patchQueryData(C,I,J.patches,N)),J},g=(C,I,F)=>N=>N(i.endpoints[C].initiate(I,{subscribe:!1,forceRefetch:!0,[Mi]:()=>({data:F})})),x=(C,I)=>C.query&&C[I]?C[I]:l1,m=async(C,{signal:I,abort:F,rejectWithValue:N,fulfillWithValue:U,dispatch:M,getState:L,extra:z})=>{var P,H;const J=r[C.endpointName],{metaSchema:ne,skipSchemaValidation:te=c}=J;try{let B=x(J,"transformResponse");const R={signal:I,abort:F,dispatch:M,getState:L,extra:z,endpoint:C.endpointName,type:C.type,forced:C.type==="query"?v(C,L()):void 0,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0},K=C.type==="query"?C[Mi]:void 0;let se;const we=async(X,ee,ce,xe)=>{if(ee==null&&X.pages.length)return Promise.resolve({data:X});const Z={queryArg:C.originalArgs,pageParam:ee},ge=await ye(Z),be=xe?f:u;return{data:{pages:be(X.pages,ge.data,ce),pageParams:be(X.pageParams,ee,ce)},meta:ge.meta}};async function ye(X){let ee;const{extraOptions:ce,argSchema:xe,rawResponseSchema:Z,responseSchema:ge}=J;if(xe&&!te&&(X=await Qn(xe,X,"argSchema",{})),K?ee=K():J.query?ee=await t(J.query(X),R,ce):ee=await J.queryFn(X,R,ce,Fe=>t(Fe,R,ce)),typeof process<"u",ee.error)throw new Wd(ee.error,ee.meta);let{data:be}=ee;Z&&!te&&(be=await Qn(Z,ee.data,"rawResponseSchema",ee.meta));let ve=await B(be,ee.meta,X);return ge&&!te&&(ve=await Qn(ge,ve,"responseSchema",ee.meta)),{...ee,data:ve}}if(C.type==="query"&&"infiniteQueryOptions"in J){const{infiniteQueryOptions:X}=J,{maxPages:ee=1/0}=X;let ce;const xe={pages:[],pageParams:[]},Z=(P=o.selectQueryEntry(L(),C.queryCacheKey))==null?void 0:P.data,be=v(C,L())&&!C.direction||!Z?xe:Z;if("direction"in C&&C.direction&&be.pages.length){const ve=C.direction==="backward",pe=(ve?of:fc)(X,be);ce=await we(be,pe,ee,ve)}else{const{initialPageParam:ve=X.initialPageParam}=C,Fe=(Z==null?void 0:Z.pageParams)??[],pe=Fe[0]??ve,Ue=Fe.length;ce=await we(be,pe,ee),K&&(ce={data:ce.data.pages[0]});for(let We=1;We<Ue;We++){const gt=fc(X,ce.data);ce=await we(ce.data,gt,ee)}}se=ce}else se=await ye(C.originalArgs);return ne&&!te&&se.meta&&(se.meta=await Qn(ne,se.meta,"metaSchema",se.meta)),U(se.data,di({fulfilledTimeStamp:Date.now(),baseQueryMeta:se.meta}))}catch(B){let R=B;if(R instanceof Wd){let K=x(J,"transformErrorResponse");const{rawErrorResponseSchema:se,errorResponseSchema:we}=J;let{value:ye,meta:X}=R;try{se&&!te&&(ye=await Qn(se,ye,"rawErrorResponseSchema",X)),ne&&!te&&(X=await Qn(ne,X,"metaSchema",X));let ee=await K(ye,X,C.originalArgs);return we&&!te&&(ee=await Qn(we,ee,"errorResponseSchema",X)),N(ee,di({baseQueryMeta:X}))}catch(ee){R=ee}}try{if(R instanceof af){const K={endpoint:C.endpointName,arg:C.originalArgs,type:C.type,queryCacheKey:C.type==="query"?C.queryCacheKey:void 0};(H=J.onSchemaFailure)==null||H.call(J,R,K),l==null||l(R,K);const{catchSchemaFailure:se=d}=J;if(se)return N(se(R,K),di({baseQueryMeta:R._bqMeta}))}}catch(K){R=K}throw console.error(R),R}};function v(C,I){const F=o.selectQueryEntry(I,C.queryCacheKey),N=o.selectConfig(I).refetchOnMountOrArgChange,U=F==null?void 0:F.fulfilledTimeStamp,M=C.forceRefetch??(C.subscribe&&N);return M?M===!0||(Number(new Date)-Number(U))/1e3>=M:!1}const S=()=>et(`${e}/executeQuery`,m,{getPendingMeta({arg:I}){const F=r[I.endpointName];return di({startedTimeStamp:Date.now(),...qo(F)?{direction:I.direction}:{}})},condition(I,{getState:F}){var te;const N=F(),U=o.selectQueryEntry(N,I.queryCacheKey),M=U==null?void 0:U.fulfilledTimeStamp,L=I.originalArgs,z=U==null?void 0:U.originalArgs,J=r[I.endpointName],ne=I.direction;return uc(I)?!0:(U==null?void 0:U.status)==="pending"?!1:v(I,N)||zo(J)&&((te=J==null?void 0:J.forceRefetch)!=null&&te.call(J,{currentArg:L,previousArg:z,endpointState:U,state:N}))?!0:!(M&&!ne)},dispatchConditionRejection:!0}),T=S(),y=S(),w=et(`${e}/executeMutation`,m,{getPendingMeta(){return di({startedTimeStamp:Date.now()})}}),k=C=>"force"in C,b=C=>"ifOlderThan"in C,j=(C,I,F)=>(N,U)=>{const M=k(F)&&F.force,L=b(F)&&F.ifOlderThan,z=(ne=!0)=>{const te={forceRefetch:ne,isPrefetch:!0};return i.endpoints[C].initiate(I,te)},J=i.endpoints[C].select(I)(U());if(M)N(z());else if(L){const ne=J==null?void 0:J.fulfilledTimeStamp;if(!ne){N(z());return}(Number(new Date)-Number(new Date(ne)))/1e3>=L&&N(z())}else N(z(!1))};function A(C){return I=>{var F,N;return((N=(F=I==null?void 0:I.meta)==null?void 0:F.arg)==null?void 0:N.endpointName)===C}}function E(C,I){return{matchPending:il(Iu(C),A(I)),matchFulfilled:il(ls(C),A(I)),matchRejected:il(kc(C),A(I))}}return{queryThunk:T,mutationThunk:w,infiniteQueryThunk:y,prefetch:j,updateQueryData:p,upsertQueryData:g,patchQueryData:h,buildMatchThunkActions:E}}function fc(e,{pages:t,pageParams:r}){const s=t.length-1;return e.getNextPageParam(t[s],t,r[s],r)}function of(e,{pages:t,pageParams:r}){var s;return(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r)}function lf(e,t,r,s){return $c(r[e.meta.arg.endpointName][t],ls(e)?e.payload:void 0,_c(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,s)}function xa(e,t,r){const s=e[t];s&&r(s)}function $i(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function Hd(e,t,r){const s=e[$i(t)];s&&r(s)}var pa={};function d1({reducerPath:e,queryThunk:t,mutationThunk:r,serializeQueryArgs:s,context:{endpointDefinitions:i,apiUid:a,extractRehydrationInfo:o,hasRehydrationInfo:l},assertTagType:d,config:c}){const h=Js(`${e}/resetApiState`);function f(A,E,C,I){var F;A[F=E.queryCacheKey]??(A[F]={status:"uninitialized",endpointName:E.endpointName}),xa(A,E.queryCacheKey,N=>{N.status="pending",N.requestId=C&&N.requestId?N.requestId:I.requestId,E.originalArgs!==void 0&&(N.originalArgs=E.originalArgs),N.startedTimeStamp=I.startedTimeStamp;const U=i[I.arg.endpointName];qo(U)&&"direction"in E&&(N.direction=E.direction)})}function u(A,E,C,I){xa(A,E.arg.queryCacheKey,F=>{if(F.requestId!==E.requestId&&!I)return;const{merge:N}=i[E.arg.endpointName];if(F.status="fulfilled",N)if(F.data!==void 0){const{fulfilledTimeStamp:U,arg:M,baseQueryMeta:L,requestId:z}=E;let J=Tc(F.data,ne=>N(ne,C,{arg:M.originalArgs,baseQueryMeta:L,fulfilledTimeStamp:U,requestId:z}));F.data=J}else F.data=C;else F.data=i[E.arg.endpointName].structuralSharing??!0?rf(op(F.data)?lp(F.data):F.data,C):C;delete F.error,F.fulfilledTimeStamp=E.fulfilledTimeStamp})}const p=br({name:`${e}/queries`,initialState:pa,reducers:{removeQueryResult:{reducer(A,{payload:{queryCacheKey:E}}){delete A[E]},prepare:oi()},cacheEntriesUpserted:{reducer(A,E){for(const C of E.payload){const{queryDescription:I,value:F}=C;f(A,I,!0,{arg:I,requestId:E.meta.requestId,startedTimeStamp:E.meta.timestamp}),u(A,{arg:I,requestId:E.meta.requestId,fulfilledTimeStamp:E.meta.timestamp,baseQueryMeta:{}},F,!0)}},prepare:A=>({payload:A.map(I=>{const{endpointName:F,arg:N,value:U}=I,M=i[F];return{queryDescription:{type:"query",endpointName:F,originalArgs:I.arg,queryCacheKey:s({queryArgs:N,endpointDefinition:M,endpointName:F})},value:U}}),meta:{[Au]:!0,requestId:_u(),timestamp:Date.now()}})},queryResultPatched:{reducer(A,{payload:{queryCacheKey:E,patches:C}}){xa(A,E,I=>{I.data=wd(I.data,C.concat())})},prepare:oi()}},extraReducers(A){A.addCase(t.pending,(E,{meta:C,meta:{arg:I}})=>{const F=uc(I);f(E,I,F,C)}).addCase(t.fulfilled,(E,{meta:C,payload:I})=>{const F=uc(C.arg);u(E,C,I,F)}).addCase(t.rejected,(E,{meta:{condition:C,arg:I,requestId:F},error:N,payload:U})=>{xa(E,I.queryCacheKey,M=>{if(!C){if(M.requestId!==F)return;M.status="rejected",M.error=U??N}})}).addMatcher(l,(E,C)=>{const{queries:I}=o(C);for(const[F,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&(E[F]=N)})}}),g=br({name:`${e}/mutations`,initialState:pa,reducers:{removeMutationResult:{reducer(A,{payload:E}){const C=$i(E);C in A&&delete A[C]},prepare:oi()}},extraReducers(A){A.addCase(r.pending,(E,{meta:C,meta:{requestId:I,arg:F,startedTimeStamp:N}})=>{F.track&&(E[$i(C)]={requestId:I,status:"pending",endpointName:F.endpointName,startedTimeStamp:N})}).addCase(r.fulfilled,(E,{payload:C,meta:I})=>{I.arg.track&&Hd(E,I,F=>{F.requestId===I.requestId&&(F.status="fulfilled",F.data=C,F.fulfilledTimeStamp=I.fulfilledTimeStamp)})}).addCase(r.rejected,(E,{payload:C,error:I,meta:F})=>{F.arg.track&&Hd(E,F,N=>{N.requestId===F.requestId&&(N.status="rejected",N.error=C??I)})}).addMatcher(l,(E,C)=>{const{mutations:I}=o(C);for(const[F,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&F!==(N==null?void 0:N.requestId)&&(E[F]=N)})}}),x={tags:{},keys:{}},m=br({name:`${e}/invalidation`,initialState:x,reducers:{updateProvidedBy:{reducer(A,E){var C,I,F;for(const{queryCacheKey:N,providedTags:U}of E.payload){v(A,N);for(const{type:M,id:L}of U){const z=(I=(C=A.tags)[M]??(C[M]={}))[F=L||"__internal_without_id"]??(I[F]=[]);z.includes(N)||z.push(N)}A.keys[N]=U}},prepare:oi()}},extraReducers(A){A.addCase(p.actions.removeQueryResult,(E,{payload:{queryCacheKey:C}})=>{v(E,C)}).addMatcher(l,(E,C)=>{var F,N,U;const{provided:I}=o(C);for(const[M,L]of Object.entries(I))for(const[z,J]of Object.entries(L)){const ne=(N=(F=E.tags)[M]??(F[M]={}))[U=z||"__internal_without_id"]??(N[U]=[]);for(const te of J)ne.includes(te)||ne.push(te)}}).addMatcher(mo(ls(t),_c(t)),(E,C)=>{S(E,[C])}).addMatcher(p.actions.cacheEntriesUpserted.match,(E,C)=>{const I=C.payload.map(({queryDescription:F,value:N})=>({type:"UNKNOWN",payload:N,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:F}}));S(E,I)})}});function v(A,E){var I;const C=A.keys[E]??[];for(const F of C){const N=F.type,U=F.id??"__internal_without_id",M=(I=A.tags[N])==null?void 0:I[U];M&&(A.tags[N][U]=M.filter(L=>L!==E))}delete A.keys[E]}function S(A,E){const C=E.map(I=>{const F=lf(I,"providesTags",i,d),{queryCacheKey:N}=I.meta.arg;return{queryCacheKey:N,providedTags:F}});m.caseReducers.updateProvidedBy(A,m.actions.updateProvidedBy(C))}const T=br({name:`${e}/subscriptions`,initialState:pa,reducers:{updateSubscriptionOptions(A,E){},unsubscribeQueryResult(A,E){},internal_getRTKQSubscriptions(){}}}),y=br({name:`${e}/internalSubscriptions`,initialState:pa,reducers:{subscriptionsUpdated:{reducer(A,E){return wd(A,E.payload)},prepare:oi()}}}),w=br({name:`${e}/config`,initialState:{online:Qg(),focused:Xg(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(A,{payload:E}){A.middlewareRegistered=A.middlewareRegistered==="conflict"||a!==E?"conflict":!0}},extraReducers:A=>{A.addCase(Mc,E=>{E.online=!0}).addCase(sf,E=>{E.online=!1}).addCase(Bc,E=>{E.focused=!0}).addCase(nf,E=>{E.focused=!1}).addMatcher(l,E=>({...E}))}}),k=sp({queries:p.reducer,mutations:g.reducer,provided:m.reducer,subscriptions:y.reducer,config:w.reducer}),b=(A,E)=>k(h.match(E)?void 0:A,E),j={...w.actions,...p.actions,...T.actions,...y.actions,...g.actions,...m.actions,resetApiState:h};return{reducer:b,actions:j}}var Hr=Symbol.for("RTKQ/skipToken"),cf={status:"uninitialized"},Vd=Tc(cf,()=>{}),Gd=Tc(cf,()=>{});function h1({serializeQueryArgs:e,reducerPath:t,createSelector:r}){const s=T=>Vd,i=T=>Gd;return{buildQuerySelector:u,buildInfiniteQuerySelector:p,buildMutationSelector:g,selectInvalidatedBy:x,selectCachedArgsForQuery:m,selectApiState:o,selectQueries:l,selectMutations:c,selectQueryEntry:d,selectConfig:h};function a(T){return{...T,...Md(T.status)}}function o(T){return T[t]}function l(T){var y;return(y=o(T))==null?void 0:y.queries}function d(T,y){var w;return(w=l(T))==null?void 0:w[y]}function c(T){var y;return(y=o(T))==null?void 0:y.mutations}function h(T){var y;return(y=o(T))==null?void 0:y.config}function f(T,y,w){return k=>{if(k===Hr)return r(s,w);const b=e({queryArgs:k,endpointDefinition:y,endpointName:T});return r(A=>d(A,b)??Vd,w)}}function u(T,y){return f(T,y,a)}function p(T,y){const{infiniteQueryOptions:w}=y;function k(b){const j={...b,...Md(b.status)},{isLoading:A,isError:E,direction:C}=j,I=C==="forward",F=C==="backward";return{...j,hasNextPage:v(w,j.data),hasPreviousPage:S(w,j.data),isFetchingNextPage:A&&I,isFetchingPreviousPage:A&&F,isFetchNextPageError:E&&I,isFetchPreviousPageError:E&&F}}return f(T,y,k)}function g(){return T=>{let y;return typeof T=="object"?y=$i(T)??Hr:y=T,r(y===Hr?i:b=>{var j,A;return((A=(j=o(b))==null?void 0:j.mutations)==null?void 0:A[y])??Gd},a)}}function x(T,y){const w=T[t],k=new Set;for(const b of y.filter(vo).map(hc)){const j=w.provided.tags[b.type];if(!j)continue;let A=(b.id!==void 0?j[b.id]:Ud(Object.values(j)))??[];for(const E of A)k.add(E)}return Ud(Array.from(k.values()).map(b=>{const j=w.queries[b];return j?[{queryCacheKey:b,endpointName:j.endpointName,originalArgs:j.originalArgs}]:[]}))}function m(T,y){return Object.values(l(T)).filter(w=>(w==null?void 0:w.endpointName)===y&&w.status!=="uninitialized").map(w=>w.originalArgs)}function v(T,y){return y?fc(T,y)!=null:!1}function S(T,y){return!y||!T.getPreviousPageParam?!1:of(T,y)!=null}}var Es=WeakMap?new WeakMap:void 0,wo=({endpointName:e,queryArgs:t})=>{let r="";const s=Es==null?void 0:Es.get(t);if(typeof s=="string")r=s;else{const i=JSON.stringify(t,(a,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=Oi(o)?Object.keys(o).sort().reduce((l,d)=>(l[d]=o[d],l),{}):o,o));Oi(t)&&(Es==null||Es.set(t,i)),r=i}return`${e}(${r})`};function df(...e){return function(r){const s=bd(c=>{var h;return(h=r.extractRehydrationInfo)==null?void 0:h.call(r,c,{reducerPath:r.reducerPath??"api"})}),i={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:s,serializeQueryArgs(c){let h=wo;if("serializeQueryArgs"in c.endpointDefinition){const f=c.endpointDefinition.serializeQueryArgs;h=u=>{const p=f(u);return typeof p=="string"?p:wo({...u,queryArgs:p})}}else r.serializeQueryArgs&&(h=r.serializeQueryArgs);return h(c)},tagTypes:[...r.tagTypes||[]]},a={endpointDefinitions:{},batch(c){c()},apiUid:_u(),extractRehydrationInfo:s,hasRehydrationInfo:bd(c=>s(c)!=null)},o={injectEndpoints:d,enhanceEndpoints({addTagTypes:c,endpoints:h}){if(c)for(const f of c)i.tagTypes.includes(f)||i.tagTypes.push(f);if(h)for(const[f,u]of Object.entries(h))typeof u=="function"?u(a.endpointDefinitions[f]):Object.assign(a.endpointDefinitions[f]||{},u);return o}},l=e.map(c=>c.init(o,i,a));function d(c){const h=c.endpoints({query:f=>({...f,type:"query"}),mutation:f=>({...f,type:"mutation"}),infiniteQuery:f=>({...f,type:"infinitequery"})});for(const[f,u]of Object.entries(h)){if(c.overrideExisting!==!0&&f in a.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(ku(39));continue}a.endpointDefinitions[f]=u;for(const p of l)p.injectEndpoint(f,u)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function vn(e,...t){return Object.assign(e,...t)}var u1=({api:e,queryThunk:t,internalState:r})=>{const s=`${e.reducerPath}/subscriptions`;let i=null,a=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:l}=e.internalActions,d=(p,g)=>{var m,v,S;if(o.match(g)){const{queryCacheKey:T,requestId:y,options:w}=g.payload;return(m=p==null?void 0:p[T])!=null&&m[y]&&(p[T][y]=w),!0}if(l.match(g)){const{queryCacheKey:T,requestId:y}=g.payload;return p[T]&&delete p[T][y],!0}if(e.internalActions.removeQueryResult.match(g))return delete p[g.payload.queryCacheKey],!0;if(t.pending.match(g)){const{meta:{arg:T,requestId:y}}=g,w=p[v=T.queryCacheKey]??(p[v]={});return w[`${y}_running`]={},T.subscribe&&(w[y]=T.subscriptionOptions??w[y]??{}),!0}let x=!1;if(t.fulfilled.match(g)||t.rejected.match(g)){const T=p[g.meta.arg.queryCacheKey]||{},y=`${g.meta.requestId}_running`;x||(x=!!T[y]),delete T[y]}if(t.rejected.match(g)){const{meta:{condition:T,arg:y,requestId:w}}=g;if(T&&y.subscribe){const k=p[S=y.queryCacheKey]??(p[S]={});k[w]=y.subscriptionOptions??k[w]??{},x=!0}}return x},c=()=>r.currentSubscriptions,u={getSubscriptions:c,getSubscriptionCount:p=>{const x=c()[p]??{};return $s(x)},isRequestSubscribed:(p,g)=>{var m;const x=c();return!!((m=x==null?void 0:x[p])!=null&&m[g])}};return(p,g)=>{if(i||(i=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(p))return i=r.currentSubscriptions={},a=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(p))return[!1,u];const x=d(r.currentSubscriptions,p);let m=!0;if(x){a||(a=setTimeout(()=>{const T=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,y]=Nu(i,()=>T);g.next(e.internalActions.subscriptionsUpdated(y)),i=T,a=null},500));const v=typeof p.type=="string"&&!!p.type.startsWith(s),S=t.rejected.match(p)&&p.meta.condition&&!!p.meta.arg.subscribe;m=!v&&!S}return[m,!1]}};function f1(e){for(const t in e)return!1;return!0}var x1=2147483647/1e3-1,p1=({reducerPath:e,api:t,queryThunk:r,context:s,internalState:i,selectors:{selectQueryEntry:a,selectConfig:o}})=>{const{removeQueryResult:l,unsubscribeQueryResult:d,cacheEntriesUpserted:c}=t.internalActions,h=mo(d.match,r.fulfilled,r.rejected,c.match);function f(m){const v=i.currentSubscriptions[m];return!!v&&!f1(v)}const u={},p=(m,v,S)=>{const T=v.getState(),y=o(T);if(h(m)){let w;if(c.match(m))w=m.payload.map(k=>k.queryDescription.queryCacheKey);else{const{queryCacheKey:k}=d.match(m)?m.payload:m.meta.arg;w=[k]}g(w,v,y)}if(t.util.resetApiState.match(m))for(const[w,k]of Object.entries(u))k&&clearTimeout(k),delete u[w];if(s.hasRehydrationInfo(m)){const{queries:w}=s.extractRehydrationInfo(m);g(Object.keys(w),v,y)}};function g(m,v,S){const T=v.getState();for(const y of m){const w=a(T,y);x(y,w==null?void 0:w.endpointName,v,S)}}function x(m,v,S,T){const y=s.endpointDefinitions[v],w=(y==null?void 0:y.keepUnusedDataFor)??T.keepUnusedDataFor;if(w===1/0)return;const k=Math.max(0,Math.min(w,x1));if(!f(m)){const b=u[m];b&&clearTimeout(b),u[m]=setTimeout(()=>{f(m)||S.dispatch(l({queryCacheKey:m})),delete u[m]},k*1e3)}}return p},Yd=new Error("Promise never resolved before cacheEntryRemoved."),m1=({api:e,reducerPath:t,context:r,queryThunk:s,mutationThunk:i,internalState:a,selectors:{selectQueryEntry:o,selectApiState:l}})=>{const d=jd(s),c=jd(i),h=ls(s,i),f={};function u(v,S,T){const y=f[v];y!=null&&y.valueResolved&&(y.valueResolved({data:S,meta:T}),delete y.valueResolved)}function p(v){const S=f[v];S&&(delete f[v],S.cacheEntryRemoved())}const g=(v,S,T)=>{const y=x(v);function w(k,b,j,A){const E=o(T,b),C=o(S.getState(),b);!E&&C&&m(k,A,b,S,j)}if(s.pending.match(v))w(v.meta.arg.endpointName,y,v.meta.requestId,v.meta.arg.originalArgs);else if(e.internalActions.cacheEntriesUpserted.match(v))for(const{queryDescription:k,value:b}of v.payload){const{endpointName:j,originalArgs:A,queryCacheKey:E}=k;w(j,E,v.meta.requestId,A),u(E,b,{})}else if(i.pending.match(v))S.getState()[t].mutations[y]&&m(v.meta.arg.endpointName,v.meta.arg.originalArgs,y,S,v.meta.requestId);else if(h(v))u(y,v.payload,v.meta.baseQueryMeta);else if(e.internalActions.removeQueryResult.match(v)||e.internalActions.removeMutationResult.match(v))p(y);else if(e.util.resetApiState.match(v))for(const k of Object.keys(f))p(k)};function x(v){return d(v)?v.meta.arg.queryCacheKey:c(v)?v.meta.arg.fixedCacheKey??v.meta.requestId:e.internalActions.removeQueryResult.match(v)?v.payload.queryCacheKey:e.internalActions.removeMutationResult.match(v)?$i(v.payload):""}function m(v,S,T,y,w){const k=r.endpointDefinitions[v],b=k==null?void 0:k.onCacheEntryAdded;if(!b)return;const j={},A=new Promise(U=>{j.cacheEntryRemoved=U}),E=Promise.race([new Promise(U=>{j.valueResolved=U}),A.then(()=>{throw Yd})]);E.catch(()=>{}),f[T]=j;const C=e.endpoints[v].select(bo(k)?S:T),I=y.dispatch((U,M,L)=>L),F={...y,getCacheEntry:()=>C(y.getState()),requestId:w,extra:I,updateCachedData:bo(k)?U=>y.dispatch(e.util.updateQueryData(v,S,U)):void 0,cacheDataLoaded:E,cacheEntryRemoved:A},N=b(S,F);Promise.resolve(N).catch(U=>{if(U!==Yd)throw U})}return g},g1=({api:e,context:{apiUid:t},reducerPath:r})=>(s,i)=>{e.util.resetApiState.match(s)&&i.dispatch(e.internalActions.middlewareRegistered(t))},y1=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:s,queryThunk:i,api:a,assertTagType:o,refetchQuery:l,internalState:d})=>{const{removeQueryResult:c}=a.internalActions,h=mo(ls(s),_c(s)),f=mo(ls(s,i),kc(s,i));let u=[];const p=(m,v)=>{h(m)?x(lf(m,"invalidatesTags",r,o),v):f(m)?x([],v):a.util.invalidateTags.match(m)&&x($c(m.payload,void 0,void 0,void 0,void 0,o),v)};function g(m){var T;const{queries:v,mutations:S}=m;for(const y of[v,S])for(const w in y)if(((T=y[w])==null?void 0:T.status)==="pending")return!0;return!1}function x(m,v){const S=v.getState(),T=S[e];if(u.push(...m),T.config.invalidationBehavior==="delayed"&&g(T))return;const y=u;if(u=[],y.length===0)return;const w=a.util.selectInvalidatedBy(S,y);t.batch(()=>{const k=Array.from(w.values());for(const{queryCacheKey:b}of k){const j=T.queries[b],A=d.currentSubscriptions[b]??{};j&&($s(A)===0?v.dispatch(c({queryCacheKey:b})):j.status!=="uninitialized"&&v.dispatch(l(j)))}})}return p},v1=({reducerPath:e,queryThunk:t,api:r,refetchQuery:s,internalState:i})=>{const a={},o=(u,p)=>{(r.internalActions.updateSubscriptionOptions.match(u)||r.internalActions.unsubscribeQueryResult.match(u))&&d(u.payload,p),(t.pending.match(u)||t.rejected.match(u)&&u.meta.condition)&&d(u.meta.arg,p),(t.fulfilled.match(u)||t.rejected.match(u)&&!u.meta.condition)&&l(u.meta.arg,p),r.util.resetApiState.match(u)&&h()};function l({queryCacheKey:u},p){const g=p.getState()[e],x=g.queries[u],m=i.currentSubscriptions[u];if(!x||x.status==="uninitialized")return;const{lowestPollingInterval:v,skipPollingIfUnfocused:S}=f(m);if(!Number.isFinite(v))return;const T=a[u];T!=null&&T.timeout&&(clearTimeout(T.timeout),T.timeout=void 0);const y=Date.now()+v;a[u]={nextPollTimestamp:y,pollingInterval:v,timeout:setTimeout(()=>{(g.config.focused||!S)&&p.dispatch(s(x)),l({queryCacheKey:u},p)},v)}}function d({queryCacheKey:u},p){const x=p.getState()[e].queries[u],m=i.currentSubscriptions[u];if(!x||x.status==="uninitialized")return;const{lowestPollingInterval:v}=f(m);if(!Number.isFinite(v)){c(u);return}const S=a[u],T=Date.now()+v;(!S||T<S.nextPollTimestamp)&&l({queryCacheKey:u},p)}function c(u){const p=a[u];p!=null&&p.timeout&&clearTimeout(p.timeout),delete a[u]}function h(){for(const u of Object.keys(a))c(u)}function f(u={}){let p=!1,g=Number.POSITIVE_INFINITY;for(let x in u)u[x].pollingInterval&&(g=Math.min(u[x].pollingInterval,g),p=u[x].skipPollingIfUnfocused||p);return{lowestPollingInterval:g,skipPollingIfUnfocused:p}}return o},b1=({api:e,context:t,queryThunk:r,mutationThunk:s})=>{const i=Iu(r,s),a=kc(r,s),o=ls(r,s),l={};return(c,h)=>{var f,u;if(i(c)){const{requestId:p,arg:{endpointName:g,originalArgs:x}}=c.meta,m=t.endpointDefinitions[g],v=m==null?void 0:m.onQueryStarted;if(v){const S={},T=new Promise((b,j)=>{S.resolve=b,S.reject=j});T.catch(()=>{}),l[p]=S;const y=e.endpoints[g].select(bo(m)?x:p),w=h.dispatch((b,j,A)=>A),k={...h,getCacheEntry:()=>y(h.getState()),requestId:p,extra:w,updateCachedData:bo(m)?b=>h.dispatch(e.util.updateQueryData(g,x,b)):void 0,queryFulfilled:T};v(x,k)}}else if(o(c)){const{requestId:p,baseQueryMeta:g}=c.meta;(f=l[p])==null||f.resolve({data:c.payload,meta:g}),delete l[p]}else if(a(c)){const{requestId:p,rejectedWithValue:g,baseQueryMeta:x}=c.meta;(u=l[p])==null||u.reject({error:c.payload??c.error,isUnhandledError:!g,meta:x}),delete l[p]}}},w1=({reducerPath:e,context:t,api:r,refetchQuery:s,internalState:i})=>{const{removeQueryResult:a}=r.internalActions,o=(d,c)=>{Bc.match(d)&&l(c,"refetchOnFocus"),Mc.match(d)&&l(c,"refetchOnReconnect")};function l(d,c){const h=d.getState()[e],f=h.queries,u=i.currentSubscriptions;t.batch(()=>{for(const p of Object.keys(u)){const g=f[p],x=u[p];if(!x||!g)continue;(Object.values(x).some(v=>v[c]===!0)||Object.values(x).every(v=>v[c]===void 0)&&h.config[c])&&($s(x)===0?d.dispatch(a({queryCacheKey:p})):g.status!=="uninitialized"&&d.dispatch(s(g)))}})}return o};function j1(e){const{reducerPath:t,queryThunk:r,api:s,context:i}=e,{apiUid:a}=i,o={invalidateTags:Js(`${t}/invalidateTags`)},l=f=>f.type.startsWith(`${t}/`),d=[g1,p1,y1,v1,m1,b1];return{middleware:f=>{let u=!1;const g={...e,internalState:{currentSubscriptions:{}},refetchQuery:h,isThisApiSliceAction:l},x=d.map(S=>S(g)),m=u1(g),v=w1(g);return S=>T=>{if(!ap(T))return S(T);u||(u=!0,f.dispatch(s.internalActions.middlewareRegistered(a)));const y={...f,next:S},w=f.getState(),[k,b]=m(T,y,w);let j;if(k?j=S(T):j=b,f.getState()[t]&&(v(T,y,w),l(T)||i.hasRehydrationInfo(T)))for(const A of x)A(T,y,w);return j}},actions:o};function h(f){return e.api.endpoints[f.endpointName].initiate(f.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Kd=Symbol(),hf=({createSelector:e=Cu}={})=>({name:Kd,init(t,{baseQuery:r,tagTypes:s,reducerPath:i,serializeQueryArgs:a,keepUnusedDataFor:o,refetchOnMountOrArgChange:l,refetchOnFocus:d,refetchOnReconnect:c,invalidationBehavior:h,onSchemaFailure:f,catchSchemaFailure:u,skipSchemaValidation:p},g){np();const x=R=>R;Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Mc,onOffline:sf,onFocus:Bc,onFocusLost:nf},util:{}});const m=h1({serializeQueryArgs:a,reducerPath:i,createSelector:e}),{selectInvalidatedBy:v,selectCachedArgsForQuery:S,buildQuerySelector:T,buildInfiniteQuerySelector:y,buildMutationSelector:w}=m;vn(t.util,{selectInvalidatedBy:v,selectCachedArgsForQuery:S});const{queryThunk:k,infiniteQueryThunk:b,mutationThunk:j,patchQueryData:A,updateQueryData:E,upsertQueryData:C,prefetch:I,buildMatchThunkActions:F}=c1({baseQuery:r,reducerPath:i,context:g,api:t,serializeQueryArgs:a,assertTagType:x,selectors:m,onSchemaFailure:f,catchSchemaFailure:u,skipSchemaValidation:p}),{reducer:N,actions:U}=d1({context:g,queryThunk:k,mutationThunk:j,serializeQueryArgs:a,reducerPath:i,assertTagType:x,config:{refetchOnFocus:d,refetchOnReconnect:c,refetchOnMountOrArgChange:l,keepUnusedDataFor:o,reducerPath:i,invalidationBehavior:h}});vn(t.util,{patchQueryData:A,updateQueryData:E,upsertQueryData:C,prefetch:I,resetApiState:U.resetApiState,upsertQueryEntries:U.cacheEntriesUpserted}),vn(t.internalActions,U);const{middleware:M,actions:L}=j1({reducerPath:i,context:g,queryThunk:k,mutationThunk:j,infiniteQueryThunk:b,api:t,assertTagType:x,selectors:m});vn(t.util,L),vn(t,{reducer:N,middleware:M});const{buildInitiateQuery:z,buildInitiateInfiniteQuery:J,buildInitiateMutation:ne,getRunningMutationThunk:te,getRunningMutationsThunk:P,getRunningQueriesThunk:H,getRunningQueryThunk:B}=o1({queryThunk:k,mutationThunk:j,infiniteQueryThunk:b,api:t,serializeQueryArgs:a,context:g});return vn(t.util,{getRunningMutationThunk:te,getRunningMutationsThunk:P,getRunningQueryThunk:B,getRunningQueriesThunk:H}),{name:Kd,injectEndpoint(R,K){var ye;const we=(ye=t.endpoints)[R]??(ye[R]={});zo(K)&&vn(we,{name:R,select:T(R,K),initiate:z(R,K)},F(k,R)),s1(K)&&vn(we,{name:R,select:w(),initiate:ne(R)},F(j,R)),qo(K)&&vn(we,{name:R,select:y(R,K),initiate:J(R,K)},F(k,R))}}}});hf();function ma(e){return e.replace(e[0],e[0].toUpperCase())}function S1(e){return e.type==="query"}function E1(e){return e.type==="mutation"}function uf(e){return e.type==="infinitequery"}function hi(e,...t){return Object.assign(e,...t)}var fl=Symbol();function xl(e,t,r,s){const i=_.useMemo(()=>({queryArgs:e,serialized:typeof e=="object"?t({queryArgs:e,endpointDefinition:r,endpointName:s}):e}),[e,t,r,s]),a=_.useRef(i);return _.useEffect(()=>{a.current.serialized!==i.serialized&&(a.current=i)},[i]),a.current.serialized===i.serialized?a.current.queryArgs:e}function ga(e){const t=_.useRef(e);return _.useEffect(()=>{vi(t.current,e)||(t.current=e)},[e]),vi(t.current,e)?t.current:e}var T1=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_1=T1(),k1=()=>typeof navigator<"u"&&navigator.product==="ReactNative",C1=k1(),A1=()=>_1||C1?_.useLayoutEffect:_.useEffect,I1=A1(),Xd=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:tf.pending}:e;function pl(e,...t){const r={};return t.forEach(s=>{r[s]=e[s]}),r}var ml=["data","status","isLoading","isSuccess","isError","error"];function N1({api:e,moduleOptions:{batch:t,hooks:{useDispatch:r,useSelector:s,useStore:i},unstable__sideEffectsInRender:a,createSelector:o},serializeQueryArgs:l,context:d}){const c=a?y=>y():_.useEffect;return{buildQueryHooks:v,buildInfiniteQueryHooks:S,buildMutationHook:T,usePrefetch:u};function h(y,w,k){if(w!=null&&w.endpointName&&y.isUninitialized){const{endpointName:I}=w,F=d.endpointDefinitions[I];k!==Hr&&l({queryArgs:w.originalArgs,endpointDefinition:F,endpointName:I})===l({queryArgs:k,endpointDefinition:F,endpointName:I})&&(w=void 0)}let b=y.isSuccess?y.data:w==null?void 0:w.data;b===void 0&&(b=y.data);const j=b!==void 0,A=y.isLoading,E=(!w||w.isLoading||w.isUninitialized)&&!j&&A,C=y.isSuccess||j&&(A&&!(w!=null&&w.isError)||y.isUninitialized);return{...y,data:b,currentData:y.data,isFetching:A,isLoading:E,isSuccess:C}}function f(y,w,k){if(w!=null&&w.endpointName&&y.isUninitialized){const{endpointName:I}=w,F=d.endpointDefinitions[I];k!==Hr&&l({queryArgs:w.originalArgs,endpointDefinition:F,endpointName:I})===l({queryArgs:k,endpointDefinition:F,endpointName:I})&&(w=void 0)}let b=y.isSuccess?y.data:w==null?void 0:w.data;b===void 0&&(b=y.data);const j=b!==void 0,A=y.isLoading,E=(!w||w.isLoading||w.isUninitialized)&&!j&&A,C=y.isSuccess||A&&j;return{...y,data:b,currentData:y.data,isFetching:A,isLoading:E,isSuccess:C}}function u(y,w){const k=r(),b=ga(w);return _.useCallback((j,A)=>k(e.util.prefetch(y,j,{...b,...A})),[y,k,b])}function p(y,w,{refetchOnReconnect:k,refetchOnFocus:b,refetchOnMountOrArgChange:j,skip:A=!1,pollingInterval:E=0,skipPollingIfUnfocused:C=!1,...I}={}){const{initiate:F}=e.endpoints[y],N=r(),U=_.useRef(void 0);if(!U.current){const R=N(e.internalActions.internal_getRTKQSubscriptions());U.current=R}const M=xl(A?Hr:w,wo,d.endpointDefinitions[y],y),L=ga({refetchOnReconnect:k,refetchOnFocus:b,pollingInterval:E,skipPollingIfUnfocused:C}),z=I.initialPageParam,J=ga(z),ne=_.useRef(void 0);let{queryCacheKey:te,requestId:P}=ne.current||{},H=!1;te&&P&&(H=U.current.isRequestSubscribed(te,P));const B=!H&&ne.current!==void 0;return c(()=>{B&&(ne.current=void 0)},[B]),c(()=>{var se;const R=ne.current;if(M===Hr){R==null||R.unsubscribe(),ne.current=void 0;return}const K=(se=ne.current)==null?void 0:se.subscriptionOptions;if(!R||R.arg!==M){R==null||R.unsubscribe();const we=N(F(M,{subscriptionOptions:L,forceRefetch:j,...uf(d.endpointDefinitions[y])?{initialPageParam:J}:{}}));ne.current=we}else L!==K&&R.updateSubscriptionOptions(L)},[N,F,j,M,L,B,J,y]),[ne,N,F,L]}function g(y,w){return(b,{skip:j=!1,selectFromResult:A}={})=>{const{select:E}=e.endpoints[y],C=xl(j?Hr:b,l,d.endpointDefinitions[y],y),I=_.useRef(void 0),F=_.useMemo(()=>o([E(C),(z,J)=>J,z=>C],w,{memoizeOptions:{resultEqualityCheck:vi}}),[E,C]),N=_.useMemo(()=>A?o([F],A,{devModeChecks:{identityFunctionCheck:"never"}}):F,[F,A]),U=s(z=>N(z,I.current),vi),M=i(),L=F(M.getState(),I.current);return I1(()=>{I.current=L},[L]),U}}function x(y){_.useEffect(()=>()=>{var w,k;(k=(w=y.current)==null?void 0:w.unsubscribe)==null||k.call(w),y.current=void 0},[y])}function m(y){if(!y.current)throw new Error(ku(38));return y.current.refetch()}function v(y){const w=(j,A={})=>{const[E]=p(y,j,A);return x(E),_.useMemo(()=>({refetch:()=>m(E)}),[E])},k=({refetchOnReconnect:j,refetchOnFocus:A,pollingInterval:E=0,skipPollingIfUnfocused:C=!1}={})=>{const{initiate:I}=e.endpoints[y],F=r(),[N,U]=_.useState(fl),M=_.useRef(void 0),L=ga({refetchOnReconnect:j,refetchOnFocus:A,pollingInterval:E,skipPollingIfUnfocused:C});c(()=>{var P,H;const te=(P=M.current)==null?void 0:P.subscriptionOptions;L!==te&&((H=M.current)==null||H.updateSubscriptionOptions(L))},[L]);const z=_.useRef(L);c(()=>{z.current=L},[L]);const J=_.useCallback(function(te,P=!1){let H;return t(()=>{var B;(B=M.current)==null||B.unsubscribe(),M.current=H=F(I(te,{subscriptionOptions:z.current,forceRefetch:!P})),U(te)}),H},[F,I]),ne=_.useCallback(()=>{var te,P;(te=M.current)!=null&&te.queryCacheKey&&F(e.internalActions.removeQueryResult({queryCacheKey:(P=M.current)==null?void 0:P.queryCacheKey}))},[F]);return _.useEffect(()=>()=>{var te;(te=M==null?void 0:M.current)==null||te.unsubscribe()},[]),_.useEffect(()=>{N!==fl&&!M.current&&J(N,!0)},[N,J]),_.useMemo(()=>[J,N,{reset:ne}],[J,N,ne])},b=g(y,h);return{useQueryState:b,useQuerySubscription:w,useLazyQuerySubscription:k,useLazyQuery(j){const[A,E,{reset:C}]=k(j),I=b(E,{...j,skip:E===fl}),F=_.useMemo(()=>({lastArg:E}),[E]);return _.useMemo(()=>[A,{...I,reset:C},F],[A,I,C,F])},useQuery(j,A){const E=w(j,A),C=b(j,{selectFromResult:j===Hr||A!=null&&A.skip?void 0:Xd,...A}),I=pl(C,...ml);return _.useDebugValue(I),_.useMemo(()=>({...C,...E}),[C,E])}}}function S(y){const w=(b,j={})=>{const[A,E,C,I]=p(y,b,j),F=_.useRef(I);c(()=>{F.current=I},[I]);const N=_.useCallback(function(L,z){let J;return t(()=>{var ne;(ne=A.current)==null||ne.unsubscribe(),A.current=J=E(C(L,{subscriptionOptions:F.current,direction:z}))}),J},[A,E,C]);x(A);const U=xl(j.skip?Hr:b,wo,d.endpointDefinitions[y],y),M=_.useCallback(()=>m(A),[A]);return _.useMemo(()=>({trigger:N,refetch:M,fetchNextPage:()=>N(U,"forward"),fetchPreviousPage:()=>N(U,"backward")}),[M,N,U])},k=g(y,f);return{useInfiniteQueryState:k,useInfiniteQuerySubscription:w,useInfiniteQuery(b,j){const{refetch:A,fetchNextPage:E,fetchPreviousPage:C}=w(b,j),I=k(b,{selectFromResult:b===Hr||j!=null&&j.skip?void 0:Xd,...j}),F=pl(I,...ml,"hasNextPage","hasPreviousPage");return _.useDebugValue(F),_.useMemo(()=>({...I,fetchNextPage:E,fetchPreviousPage:C,refetch:A}),[I,E,C,A])}}}function T(y){return({selectFromResult:w,fixedCacheKey:k}={})=>{const{select:b,initiate:j}=e.endpoints[y],A=r(),[E,C]=_.useState();_.useEffect(()=>()=>{E!=null&&E.arg.fixedCacheKey||E==null||E.reset()},[E]);const I=_.useCallback(function(te){const P=A(j(te,{fixedCacheKey:k}));return C(P),P},[A,j,k]),{requestId:F}=E||{},N=_.useMemo(()=>b({fixedCacheKey:k,requestId:E==null?void 0:E.requestId}),[k,E,b]),U=_.useMemo(()=>w?o([N],w):N,[w,N]),M=s(U,vi),L=k==null?E==null?void 0:E.arg.originalArgs:void 0,z=_.useCallback(()=>{t(()=>{E&&C(void 0),k&&A(e.internalActions.removeMutationResult({requestId:F,fixedCacheKey:k}))})},[A,k,E,F]),J=pl(M,...ml,"endpointName");_.useDebugValue(J);const ne=_.useMemo(()=>({...M,originalArgs:L,reset:z}),[M,L,z]);return _.useMemo(()=>[I,ne],[I,ne])}}}var F1=Symbol(),R1=({batch:e=cp,hooks:t={useDispatch:lt,useSelector:qe,useStore:dp},createSelector:r=Cu,unstable__sideEffectsInRender:s=!1,...i}={})=>({name:F1,init(a,{serializeQueryArgs:o},l){const d=a,{buildQueryHooks:c,buildInfiniteQueryHooks:h,buildMutationHook:f,usePrefetch:u}=N1({api:a,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:s,createSelector:r},serializeQueryArgs:o,context:l});return hi(d,{usePrefetch:u}),hi(l,{batch:e}),{injectEndpoint(p,g){if(S1(g)){const{useQuery:x,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:S,useQuerySubscription:T}=c(p);hi(d.endpoints[p],{useQuery:x,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:S,useQuerySubscription:T}),a[`use${ma(p)}Query`]=x,a[`useLazy${ma(p)}Query`]=m}if(E1(g)){const x=f(p);hi(d.endpoints[p],{useMutation:x}),a[`use${ma(p)}Mutation`]=x}else if(uf(g)){const{useInfiniteQuery:x,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}=h(p);hi(d.endpoints[p],{useInfiniteQuery:x,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}),a[`use${ma(p)}InfiniteQuery`]=x}}}}}),Uc=df(hf(),R1());const P1="/api",Ya=Uc({reducerPath:"exhibitorInvoiceApi",baseQuery:Oc({baseUrl:P1,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("exhibitor_token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["ExhibitorInvoice"],endpoints:e=>({getExhibitorInvoice:e.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,r,s)=>[{type:"ExhibitorInvoice",id:s}]}),downloadExhibitorInvoice:e.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:r})})})}),{useGetExhibitorInvoiceQuery:D1,useDownloadExhibitorInvoiceMutation:L1,useShareViaEmailMutation:O1,useShareViaWhatsAppMutation:B1}=Ya,ff=({booking:e})=>{var E,C,I;const[t,r]=_.useState(null),[s,i]=_.useState(!0),a=qe(F=>F.settings.settings);_.useEffect(()=>{(async()=>{i(!0);try{if(e.exhibitionId.headerLogo){const N=e.exhibitionId.headerLogo;r(`${ke.defaults.baseURL}/public/uploads/${N}`),console.log("Using exhibition header logo:",N)}else if(a!=null&&a.logo){const N=a.logo;r(`${ke.defaults.baseURL}/public/uploads/${N}`),console.log("Using global settings logo:",N)}else{const N=`${ke.defaults.baseURL}/public/logo`;r(N),console.log("Using public logo endpoint:",N)}}catch(N){console.error("Error loading logo:",N),r(null)}finally{i(!1)}})()},[e.exhibitionId.headerLogo,a==null?void 0:a.logo]);const o=()=>{const F=new Date(e.exhibitionId.startDate||""),N=new Date(e.exhibitionId.endDate||""),U={};let M=new Date(F);for(;M<=N;){const z=M.toLocaleString("default",{month:"short",year:"numeric"});U[z]||(U[z]=[]),U[z].push(M.getDate().toString().padStart(2,"0")),M=new Date(M),M.setDate(M.getDate()+1)}const L=Object.entries(U).map(([z,J])=>`${J.join(", ")} ${z}`);return`${e.exhibitionId.name||"ABSE"} (${L.join(" & ")})`},l=F=>{const N=new Date(F);return{date:N.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:N.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},d=e.stallIds.map((F,N)=>{var z;const U=F,M=F.dimensions.width*F.dimensions.height,L=M*F.ratePerSqm;return{key:F._id,sn:N+1,stallNo:F.number,stallType:((z=U.stallTypeId)==null?void 0:z.name)||"Standard",dimensions:`${F.dimensions.width}x${F.dimensions.height}m`,area:M.toFixed(0),rate:F.ratePerSqm.toFixed(0),amount:L}}),c=d.reduce((F,N)=>F+N.amount,0),h=e.calculations,f=((E=h.stalls[0])==null?void 0:E.discount)!==void 0&&((C=h.stalls[0])==null?void 0:C.discount)!==null,u=f?(I=h.stalls[0])==null?void 0:I.discount:null,p=(u==null?void 0:u.type)||"percentage",g=(u==null?void 0:u.value)||0;let x=0;f&&g>0&&(p==="percentage"?x=Math.round(c*g/100*100)/100:p==="fixed"&&(x=Math.min(g,c)));const m=c-x,v=h.taxes.find(F=>F.name.includes("GST")),S=v?v.rate:18,T=Math.round(m*S/100*100)/100,y=m+T,w=c,k=x,b=m,j=T,A=y;return n.jsx("div",{className:"invoice-container",children:n.jsxs("div",{className:"proforma-invoice",children:[n.jsxs("div",{className:"header-section",children:[n.jsx("div",{className:"logo-cell",children:s?n.jsx("div",{className:"logo-loading",children:"Loading..."}):t?n.jsx("img",{src:t,alt:e.exhibitionId.companyName,className:"logo-image",onError:()=>r(null)}):e.exhibitionId.companyName}),n.jsxs("div",{className:"title-company",children:[n.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),n.jsx("div",{className:"company-cell",children:e.exhibitionId.companyName})]})]}),n.jsxs("div",{className:"bill-to-section",children:[n.jsx("div",{className:"bill-to-cell",children:"Bill To"}),n.jsxs("div",{className:"bill-to-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Company Name"}),n.jsx("div",{className:"value-cell",children:e.companyName}),n.jsx("div",{className:"date-label-cell",children:"Date"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).date})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Phone No."}),n.jsx("div",{className:"value-cell",children:e.customerPhone}),n.jsx("div",{className:"date-label-cell",children:"Time"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).time})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"GST No."}),n.jsx("div",{className:"value-cell",children:e.customerGSTIN}),n.jsx("div",{className:"date-label-cell",children:"Invoice No"}),n.jsx("div",{className:"date-value-cell",children:e.invoiceNumber})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Address"}),n.jsx("div",{className:"value-cell",children:e.customerAddress})]})]})]}),n.jsxs("div",{className:"expo-venue-section",children:[n.jsxs("div",{className:"expo-column",children:[n.jsx("div",{className:"heading",children:"Expo Name"}),n.jsx("div",{className:"content",children:o()})]}),n.jsxs("div",{className:"venue-column",children:[n.jsx("div",{className:"heading",children:"Venue"}),n.jsx("div",{className:"content",children:e.exhibitionId.venue})]})]}),n.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),n.jsxs("div",{className:"stall-table",children:[n.jsxs("div",{className:"stall-header",children:[n.jsx("div",{className:"stall-header-cell",children:"S/N"}),n.jsx("div",{className:"stall-header-cell",children:"Stall No."}),n.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),n.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),n.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),d.map(F=>n.jsxs("div",{className:"stall-row",children:[n.jsx("div",{className:"stall-cell",children:F.sn}),n.jsx("div",{className:"stall-cell",children:F.stallNo}),n.jsx("div",{className:"stall-cell",children:F.stallType}),n.jsx("div",{className:"stall-cell",children:F.dimensions}),n.jsx("div",{className:"stall-cell",children:F.area}),n.jsx("div",{className:"stall-cell",children:Number(F.rate).toLocaleString("en-IN")}),n.jsx("div",{className:"stall-cell",children:F.amount.toLocaleString("en-IN")})]},F.key))]}),n.jsx("div",{className:"section-header",children:"Calculation Summary"}),n.jsxs("div",{className:"calc-table",children:[n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),n.jsxs("div",{className:"calc-value",children:["",w.toLocaleString("en-IN")]})]}),f&&k>0&&n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:p==="percentage"?`Discount (${g}%)`:`Discount (Fixed ${g.toLocaleString("en-IN")})`}),n.jsxs("div",{className:"calc-value",children:["-",k.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:f&&k>0?"Amount after Discount":"Net Amount"}),n.jsxs("div",{className:"calc-value",children:["",b.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsxs("div",{className:"calc-label",children:["GST (",S,"%)"]}),n.jsxs("div",{className:"calc-value",children:["",j.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row total-row",children:[n.jsx("div",{className:"calc-label",children:"Total Amount"}),n.jsxs("div",{className:"calc-value",children:["",A.toLocaleString("en-IN")]})]})]}),n.jsxs("div",{className:"details-section",children:[n.jsxs("div",{className:"bank-details",children:[n.jsx("div",{className:"details-header",children:"Bank Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Bank Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Account No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccount})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccountName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Branch"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankBranch})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"IFSC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankIFSC})]})]}),n.jsxs("div",{className:"company-details",children:[n.jsx("div",{className:"details-header",children:"Company Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"CIN No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyCIN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Pan No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyPAN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"SAC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companySAC})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"GST No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyGST})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Email"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyEmail})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Website"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyWebsite})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Address"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyAddress})]})]})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"PI Instruction"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),n.jsx("div",{className:"signature-section",children:n.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},{Title:M1,Text:$1}=Me,U1=()=>{var k,b,j,A,E,C,I,F,N,U,M,L,z,J,ne,te,P,H,B;const{id:e}=Dr(),{data:t,isLoading:r,error:s}=D1(e||""),[i]=L1(),[a]=O1(),[o]=B1(),[l,d]=_.useState(!1),[c,h]=_.useState(!1),[f]=W.useForm(),[u]=W.useForm(),[p,g]=_.useState(0),[x,m]=_.useState(!1),v=async()=>{if(e)try{m(!0),g(0),Se.loading({content:"Preparing invoice...",key:"download"});const K=(()=>{let se=0;const we=setInterval(()=>{se+=5,se<=90?(g(se),se%25===0&&Se.loading({content:`Downloading: ${se}% complete`,key:"download"})):clearInterval(we)},200);return we})();try{const se=await i(e).unwrap();clearInterval(K),g(100),Se.loading({content:"Finalizing download...",key:"download"});const we=URL.createObjectURL(se),ye=document.createElement("a");ye.href=we,ye.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||e||"download"}.pdf`,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(we),Se.success({content:"Invoice downloaded successfully",key:"download"})}catch(se){throw clearInterval(K),se}}catch(R){console.error("Error downloading PDF:",R),Se.error({content:"Failed to download invoice",key:"download"})}finally{m(!1),setTimeout(()=>g(0),500)}},S=()=>{d(!0)},T=()=>{h(!0)},y=async R=>{try{await a({bookingId:e||"",email:R.email,message:R.message}).unwrap(),Se.success(`Invoice sent to ${R.email}`),d(!1),f.resetFields()}catch(K){console.error("Error sending email:",K),Se.error("Failed to send email")}},w=async R=>{try{await o({bookingId:e||"",phoneNumber:R.phoneNumber}).unwrap();const K=R.phoneNumber.replace(/\D/g,""),se=encodeURIComponent(R.message);window.open(`https://wa.me/${K}?text=${se}`,"_blank"),h(!1),u.resetFields()}catch(K){console.error("Error opening WhatsApp:",K),Se.error("Failed to open WhatsApp")}};return r?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:n.jsx(Vt,{size:"large"})}):s||!t?n.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[n.jsx(M1,{level:3,children:"Invoice Not Found"}),n.jsx($1,{children:"The requested invoice could not be loaded. Please try again later."})]}):n.jsxs(n.Fragment,{children:[n.jsxs(de,{title:"Invoice Details",style:{margin:"20px"},children:[n.jsx(Ne,{gutter:[16,24],children:n.jsx(Q,{span:24,children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(re,{icon:n.jsx(Yi,{}),onClick:v,loading:x&&p<100,disabled:x&&p>=100,children:"Download PDF"}),n.jsx(re,{icon:n.jsx(fn,{}),onClick:S,disabled:x,children:"Share via Email"}),n.jsx(re,{icon:n.jsx(ju,{}),onClick:T,disabled:x,children:"Share via WhatsApp"})]}),x&&n.jsx(Qr,{percent:p,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),n.jsx(it,{}),n.jsx(ff,{booking:{...t.bookingId,customerGSTIN:(k=t.bookingId)!=null&&k.customerGSTIN||((b=t.bookingId)==null?void 0:b.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(j=t.bookingId)!=null&&j.customerAddress||((A=t.bookingId)==null?void 0:A.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((E=t.bookingId.exhibitionId)==null?void 0:E.companyName)||"",bankName:((C=t.bookingId.exhibitionId)==null?void 0:C.bankName)||"",bankAccount:((I=t.bookingId.exhibitionId)==null?void 0:I.bankAccount)||"",bankAccountName:((F=t.bookingId.exhibitionId)==null?void 0:F.bankAccountName)||"",bankBranch:((N=t.bookingId.exhibitionId)==null?void 0:N.bankBranch)||"",bankIFSC:((U=t.bookingId.exhibitionId)==null?void 0:U.bankIFSC)||"",companyCIN:((M=t.bookingId.exhibitionId)==null?void 0:M.companyCIN)||"",companyPAN:((L=t.bookingId.exhibitionId)==null?void 0:L.companyPAN)||"",companySAC:((z=t.bookingId.exhibitionId)==null?void 0:z.companySAC)||"",companyGST:((J=t.bookingId.exhibitionId)==null?void 0:J.companyGST)||"",companyEmail:((ne=t.bookingId.exhibitionId)==null?void 0:ne.companyEmail)||"",companyWebsite:((te=t.bookingId.exhibitionId)==null?void 0:te.companyWebsite)||"",companyAddress:((P=t.bookingId.exhibitionId)==null?void 0:P.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((B=(H=t.bookingId.calculations)==null?void 0:H.stalls)==null?void 0:B.map(R=>({...R,discount:R.discount?{...R.discount,type:R.discount.type||"percentage",value:R.discount.value}:void 0})))||[]}}})]}),n.jsx(Ye,{title:"Share Invoice via Email",visible:l,onCancel:()=>d(!1),footer:null,children:n.jsxs(W,{form:f,layout:"vertical",onFinish:y,children:[n.jsx(W.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(he,{placeholder:"example@example.com"})}),n.jsx(W.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(he.TextArea,{rows:4})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ye,{title:"Share Invoice via WhatsApp",visible:c,onCancel:()=>h(!1),footer:null,children:n.jsxs(W,{form:u,layout:"vertical",onFinish:w,children:[n.jsx(W.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:n.jsx(he,{placeholder:"+1234567890"})}),n.jsx(W.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(he.TextArea,{rows:4})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Qd,Text:Jd}=Me,{TabPane:Zd}=Jt,z1=()=>{var x;const{notification:e}=Zt.useApp(),[t]=W.useForm(),[r]=W.useForm(),[s,i]=_.useState(!1),[a,o]=_.useState(!1),[l,d]=_.useState(!1),[c,h]=_.useState(null),f=lt(),u=qe(m=>m.auth.user);_.useEffect(()=>{(async()=>{try{d(!0);const v=await yo.getProfile();v.data&&f(Pu({user:v.data,token:localStorage.getItem("token")||""}))}catch{Se.error("Failed to fetch profile")}finally{d(!1)}})()},[f]);const p=async m=>{var v,S;try{h(null),o(!0),await yo.changePassword({currentPassword:m.currentPassword,newPassword:m.newPassword}),e.success({message:"Success",description:"Password has been changed successfully"}),r.resetFields()}catch(T){h(((S=(v=T.response)==null?void 0:v.data)==null?void 0:S.message)||"Failed to change password. Please try again.")}finally{o(!1)}},g=()=>u!=null&&u.role?typeof u.role=="string"?u.role:typeof u.role=="object"&&"name"in u.role?u.role.name:"User":"User";return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ne,{gutter:[24,24],align:"middle",children:n.jsxs(Q,{flex:"auto",children:[n.jsx(Qd,{level:4,children:"My Account"}),n.jsx(Jd,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),n.jsx(de,{loading:l,children:n.jsxs(Jt,{defaultActiveKey:"account",children:[n.jsx(Zd,{tab:"Account Information",children:n.jsxs(Ne,{gutter:32,children:[n.jsx(Q,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Ur,{size:100,icon:n.jsx(ht,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((x=u==null?void 0:u.username)==null?void 0:x.charAt(0).toUpperCase())||"U"}),n.jsx(Qd,{level:4,children:u==null?void 0:u.username}),n.jsx(Jd,{type:"secondary",children:g()})]})}),n.jsx(Q,{span:18,children:n.jsx(W,{layout:"vertical",initialValues:{username:u==null?void 0:u.username,email:u==null?void 0:u.email},disabled:!0,children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:n.jsx(he,{prefix:n.jsx(ht,{}),placeholder:"Username"})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(fn,{}),placeholder:"Email Address"})})})]})})})]})},"account"),n.jsxs(Zd,{tab:"Change Password",children:[c&&n.jsx(It,{message:"Error",description:c,type:"error",showIcon:!0,style:{marginBottom:24}}),n.jsxs(W,{form:r,layout:"vertical",onFinish:p,children:[n.jsx(W.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Current Password"})}),n.jsx(W.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"New Password"})}),n.jsx(W.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:m})=>({validator(v,S){return!S||m("newPassword")===S?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm New Password"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",loading:a,icon:n.jsx(fs,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:Ts}=Le,{Title:q1,Text:W1}=Me,H1=()=>{const e=lt(),{message:t}=Zt.useApp(),[r]=W.useForm(),{settings:s,loading:i}=qe(u=>u.settings),[a,o]=_.useState([]),[l,d]=_.useState(0);_.useEffect(()=>{e(bi())},[e]),_.useEffect(()=>{if(s&&(r.setFieldsValue({siteName:s.siteName,adminEmail:s.adminEmail,language:s.language,timezone:s.timezone,emailNotifications:s.emailNotifications,footerText:s.footerText}),s.logo)){const u=x=>{const m=localStorage.getItem("token");return{url:`${ke.defaults.baseURL}/uploads/${x}`,token:m}},{url:p,token:g}=u(s.logo);fetch(p,{headers:{authorization:`Bearer ${g}`}}).then(x=>x.blob()).then(x=>{var v;const m=URL.createObjectURL(x);o([{uid:"-1",name:((v=s.logo)==null?void 0:v.split("/").pop())||"logo",status:"done",url:m,thumbUrl:m,type:x.type,response:{path:s.logo}}])}).catch(()=>{o([])})}},[s,r]);const c=u=>{e(wi(u)).unwrap().then(()=>t.success("Settings updated successfully")).catch(p=>t.error(`Failed to update settings: ${p}`))},h={name:"file",action:`${ke.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:a,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(u){const{status:p,name:g,response:x,uid:m}=u.file;if(p==="uploading"){o([...u.fileList]);return}if(p==="done"&&x){d(0);const v=localStorage.getItem("token"),S=`${ke.defaults.baseURL}/uploads/${x.path}`;fetch(S,{headers:{authorization:`Bearer ${v}`}}).then(T=>T.blob()).then(T=>{const y=URL.createObjectURL(T);o([{uid:u.file.uid,name:g,status:"done",url:y,thumbUrl:y,type:T.type,response:x}]),t.success(`${g} uploaded successfully`),r.setFieldValue("logo",x.path)}).catch(()=>{t.error(`${g} preview failed to load`),o([])})}else p==="error"?(t.error(`${g} upload failed.`),o([]),d(0)):p==="removed"&&(o([]),r.setFieldValue("logo",null),d(0))},onRemove(){return o([]),r.setFieldValue("logo",null),d(0),!0},customRequest:async({file:u,onSuccess:p,onError:g,onProgress:x})=>{try{e(Ga(u)).unwrap().then(m=>{p&&p(m)}).catch(m=>{g&&g(new Error(m))})}catch(m){g&&g(m)}}},f=n.jsx("div",{children:l>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Qr,{type:"circle",percent:l,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Di,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ne,{gutter:[24,24],align:"middle",children:n.jsx(Q,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(q1,{level:4,style:{margin:0},children:"Settings"}),n.jsx(W1,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),n.jsx(de,{className:"info-card",children:n.jsxs(W,{form:r,layout:"vertical",onFinish:c,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[n.jsxs(Ne,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(W.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:n.jsx(he,{})}),n.jsx(W.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:n.jsx(he,{})}),n.jsx(W.Item,{label:"Language",name:"language",children:n.jsxs(Le,{children:[n.jsx(Ts,{value:"en",children:"English"}),n.jsx(Ts,{value:"es",children:"Spanish"}),n.jsx(Ts,{value:"fr",children:"French"})]})}),n.jsx(W.Item,{label:"Timezone",name:"timezone",children:n.jsxs(Le,{children:[n.jsx(Ts,{value:"UTC",children:"UTC"}),n.jsx(Ts,{value:"EST",children:"EST"}),n.jsx(Ts,{value:"PST",children:"PST"})]})}),n.jsx(W.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:n.jsx(Rr,{})})]}),n.jsxs(Q,{span:12,children:[n.jsxs(W.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Pi,{...h,children:a.length<1&&f}),a.length>0&&l>0&&n.jsx(Qr,{percent:l,status:"active",style:{marginTop:8}})]}),n.jsx(W.Item,{label:"Footer Text",name:"footerText",children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),n.jsx(W.Item,{children:n.jsxs(ue,{children:[n.jsx(re,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:i,children:"Save Settings"}),n.jsx(re,{onClick:()=>r.resetFields(),icon:n.jsx(Tx,{}),children:"Reset"})]})})]})})]})},V1=async()=>{try{return(await ke.get("/roles")).data}catch(e){throw console.error("Error fetching roles:",e),e}},G1=async e=>{try{return(await ke.get(`/roles/${e}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},Y1=async e=>{try{return(await ke.post("/roles",e)).data}catch(t){throw console.error("Error creating role:",t),t}},K1=async(e,t)=>{try{return(await ke.put(`/roles/${e}`,t)).data}catch(r){throw console.error("Error updating role:",r),r}},X1=async e=>{try{await ke.delete(`/roles/${e}`)}catch(t){throw console.error("Error deleting role:",t),t}},Q1={roles:[],role:null,loading:!1,error:null},Us=et("roles/fetchRoles",async(e,{rejectWithValue:t})=>{var r,s;try{return await V1()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch roles")}}),gl=et("roles/fetchRoleById",async(e,{rejectWithValue:t})=>{var r,s;try{return await G1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch role")}}),Ka=et("roles/addRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await Y1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create role")}}),Xa=et("roles/modifyRole",async({id:e,roleData:t},{rejectWithValue:r})=>{var s,i;try{return await K1(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update role")}}),Qa=et("roles/removeRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await X1(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete role")}}),xf=br({name:"roles",initialState:Q1,reducers:{clearRoleError:e=>{e.error=null},setSelectedRole:(e,t)=>{e.role=t.payload}},extraReducers:e=>{e.addCase(Us.pending,t=>{t.loading=!0,t.error=null}).addCase(Us.fulfilled,(t,r)=>{t.loading=!1,t.roles=r.payload}).addCase(Us.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(gl.pending,t=>{t.loading=!0,t.error=null}).addCase(gl.fulfilled,(t,r)=>{t.loading=!1,t.role=r.payload}).addCase(gl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ka.pending,t=>{t.loading=!0,t.error=null}).addCase(Ka.fulfilled,(t,r)=>{t.loading=!1,t.roles.push(r.payload)}).addCase(Ka.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Xa.pending,t=>{t.loading=!0,t.error=null}).addCase(Xa.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.roles.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.roles[s]=r.payload),((i=t.role)==null?void 0:i._id)===r.payload._id&&(t.role=r.payload)}).addCase(Xa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Qa.pending,t=>{t.loading=!0,t.error=null}).addCase(Qa.fulfilled,(t,r)=>{var s;t.loading=!1,t.roles=t.roles.filter(i=>i._id!==r.payload),((s=t.role)==null?void 0:s._id)===r.payload&&(t.role=null)}).addCase(Qa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearRoleError:J4,setSelectedRole:Z4}=xf.actions,J1=xf.reducer,{Text:eh}=Me,Z1=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],yl=Z1.reduce((e,t)=>(e[t.group]||(e[t.group]=[]),e[t.group].push({key:t.key,label:t.label}),e),{}),ey=({visible:e,onCancel:t,onSave:r,role:s,loading:i})=>{const[a]=W.useForm(),o=!!s,[l,d]=_.useState([]);_.useEffect(()=>{if(e)if(s){const g=s.permissions||[];a.setFieldsValue({name:s.name,description:s.description,permissions:g}),d(g)}else a.resetFields(),d([])},[e,s,a]);const c=()=>{a.setFieldsValue({permissions:l}),a.validateFields().then(g=>{r(g)})},h=g=>{const x=yl[g].map(m=>m.key);return x.length>0&&x.every(m=>l.includes(m))},f=(g,x)=>{let m;x?m=[...l,g]:m=l.filter(v=>v!==g),d(m)},u=(g,x)=>{const m=yl[g].map(S=>S.key);let v;if(x){const S=m.filter(T=>!l.includes(T));v=[...l,...S]}else v=l.filter(S=>!m.includes(S));d(v)},p=g=>l.includes(g);return n.jsx(Ye,{title:o?"Edit Role":"Add New Role",open:e,onCancel:t,width:700,footer:[n.jsx(re,{onClick:t,children:"Cancel"},"cancel"),n.jsx(re,{type:"primary",loading:i,onClick:c,children:o?"Update":"Create"},"submit")],children:n.jsxs(W,{form:a,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[n.jsx(W.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:n.jsx(he,{placeholder:"e.g., Administrator, Editor, Viewer"})}),n.jsx(W.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:n.jsx(he.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),n.jsx(it,{plain:!0,children:"Permissions"}),n.jsx(W.Item,{name:"permissions",hidden:!0,children:n.jsx(he,{})}),n.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(yl).map(([g,x])=>n.jsx(de,{size:"small",title:n.jsxs(ue,{children:[n.jsx(eh,{strong:!0,children:g}),n.jsx(Zl,{checked:h(g),onChange:m=>u(g,m.target.checked),children:"Select All"})]}),style:{marginBottom:16},children:n.jsx(Ne,{gutter:[16,12],children:x.map(m=>n.jsx(Q,{span:12,children:n.jsx(Zl,{checked:p(m.key),onChange:v=>f(m.key,v.target.checked),children:n.jsx(eh,{children:m.label})})},m.key))})},g))})]})})},Wo=()=>{const{user:e}=qe(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Title:ya,Paragraph:th,Text:_s}=Me,{confirm:ty}=Ye;function vl({allowed:e}){return e?n.jsx(wc,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):n.jsx(_x,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function ry(){const{message:e,notification:t}=Zt.useApp(),r=lt(),{roles:s,loading:i,error:a}=qe(b=>b.role),[o,l]=_.useState(""),[d,c]=_.useState(!1),[h,f]=_.useState(null),{hasPermission:u}=Wo();_.useEffect(()=>{r(Us())},[r]),_.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]);const p=()=>{f(null),c(!0)},g=b=>{f(b),c(!0)},x=b=>{h?r(Xa({id:h._id,roleData:b})).unwrap().then(()=>{c(!1),e.success("Role updated successfully")}).catch(j=>{e.error(`Failed to update role: ${j.message}`)}):r(Ka(b)).unwrap().then(()=>{c(!1),e.success("Role created successfully")}).catch(j=>{e.error(`Failed to create role: ${j.message}`)})},m=b=>{ty({title:"Are you sure you want to delete this role?",icon:n.jsx(Xs,{}),content:`This will permanently delete the ${b.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){r(Qa(b._id)).unwrap().then(()=>{e.success(`${b.name} role deleted successfully`)}).catch(j=>{e.error(`Failed to delete role: ${j.message}`)})}})},v=[{title:"Role",dataIndex:"name",key:"name",render:(b,j)=>n.jsxs(ue,{children:[n.jsx(Ur,{style:{backgroundColor:w(j.name)},children:b.charAt(0).toUpperCase()}),n.jsx(_s,{strong:!0,children:b})]})},{title:"Description",dataIndex:"description",key:"description",render:b=>n.jsx(_s,{type:"secondary",children:b})},{title:"Read",key:"read",align:"center",render:(b,j)=>n.jsx(vl,{allowed:S(j)})},{title:"Write",key:"write",align:"center",render:(b,j)=>n.jsx(vl,{allowed:T(j)})},{title:"Delete",key:"delete",align:"center",render:(b,j)=>n.jsx(vl,{allowed:y(j)})},{title:"Actions",key:"actions",align:"right",render:(b,j)=>n.jsxs(ue,{children:[u("roles_edit")&&n.jsx(Ke,{title:j.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:n.jsx(re,{type:"primary",shape:"circle",icon:n.jsx(as,{}),size:"small",onClick:()=>g(j),disabled:j.name==="Administrator"})}),u("roles_delete")&&n.jsx(Ke,{title:"Delete role",children:n.jsx(re,{danger:!0,shape:"circle",icon:n.jsx(sr,{}),size:"small",onClick:()=>m(j),disabled:j.name==="Administrator"})})]})}],S=b=>b.permissions.some(j=>j.endsWith("_view")),T=b=>b.permissions.some(j=>j.endsWith("_create")||j.endsWith("_edit")),y=b=>b.permissions.some(j=>j.endsWith("_delete")),w=b=>{const j=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let A=0;for(let E=0;E<b.length;E++)A=b.charCodeAt(E)+((A<<5)-A);return j[Math.abs(A)%j.length]},k=s.filter(b=>b.name.toLowerCase().includes(o.toLowerCase())||b.description.toLowerCase().includes(o.toLowerCase()));return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(ya,{level:2,children:"Roles & Permissions"}),n.jsx(th,{children:"Manage role-based access control and permissions for your users."})]}),n.jsxs(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:i&&s.length===0,children:[n.jsxs(Ne,{gutter:16,style:{marginBottom:16},children:[n.jsx(Q,{span:16,children:n.jsx(he,{placeholder:"Search roles...",allowClear:!0,value:o,onChange:b=>l(b.target.value),prefix:n.jsx(_s,{type:"secondary",style:{fontSize:16},children:""})})}),n.jsx(Q,{span:8,style:{textAlign:"right"},children:u("roles_create")&&n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),style:{borderRadius:6},onClick:p,children:"Add Role"})})]}),n.jsx(st,{columns:v,dataSource:k,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(b,j)=>`Showing ${j[0]}-${j[1]} of ${b} roles`},style:{marginTop:8},loading:i&&s.length>0})]}),n.jsx(de,{title:n.jsx(ya,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[n.jsxs(ue,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ya,{level:5,children:"Best Practices"}),n.jsxs("ul",{style:{paddingLeft:20},children:[n.jsx("li",{children:n.jsx(_s,{children:"Follow the principle of least privilege"})}),n.jsx("li",{children:n.jsx(_s,{children:"Regularly audit user roles"})}),n.jsx("li",{children:n.jsx(_s,{children:"Document role responsibilities"})})]})]}),n.jsxs(ue,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ya,{level:5,children:"Role Inheritance"}),n.jsx(th,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),n.jsx(ey,{visible:d,onCancel:()=>c(!1),onSave:x,role:h,loading:i})]})}const ny=async()=>{try{return(await ke.get("/users")).data}catch(e){throw console.error("Error fetching users:",e),e}},sy=async e=>{try{return(await ke.get(`/users/${e}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},iy=async e=>{try{return(await ke.post("/users",e)).data}catch(t){throw console.error("Error creating user:",t),t}},ay=async(e,t)=>{try{return(await ke.put(`/users/${e}`,t)).data}catch(r){throw console.error("Error updating user:",r),r}},oy=async e=>{try{await ke.delete(`/users/${e}`)}catch(t){throw console.error("Error deleting user:",t),t}},ly={users:[],selectedUser:null,loading:!1,error:null},ns=et("users/fetchUsers",async(e,{rejectWithValue:t})=>{var r,s;try{return await ny()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch users")}}),bl=et("users/fetchUserById",async(e,{rejectWithValue:t})=>{var r,s;try{return await sy(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch user")}}),Ja=et("users/addUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await iy(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create user")}}),Za=et("users/modifyUser",async({id:e,userData:t},{rejectWithValue:r})=>{var s,i;try{return await ay(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update user")}}),eo=et("users/removeUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await oy(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete user")}}),pf=br({name:"users",initialState:ly,reducers:{clearUserError:e=>{e.error=null},setSelectedUser:(e,t)=>{e.selectedUser=t.payload}},extraReducers:e=>{e.addCase(ns.pending,t=>{t.loading=!0,t.error=null}).addCase(ns.fulfilled,(t,r)=>{t.loading=!1,t.users=r.payload}).addCase(ns.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(bl.pending,t=>{t.loading=!0,t.error=null}).addCase(bl.fulfilled,(t,r)=>{t.loading=!1,t.selectedUser=r.payload}).addCase(bl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ja.pending,t=>{t.loading=!0,t.error=null}).addCase(Ja.fulfilled,(t,r)=>{t.loading=!1,t.users.push(r.payload)}).addCase(Ja.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Za.pending,t=>{t.loading=!0,t.error=null}).addCase(Za.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.users.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.users[s]=r.payload),((i=t.selectedUser)==null?void 0:i._id)===r.payload._id&&(t.selectedUser=r.payload)}).addCase(Za.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(eo.pending,t=>{t.loading=!0,t.error=null}).addCase(eo.fulfilled,(t,r)=>{var s;t.loading=!1,t.users=t.users.filter(i=>i._id!==r.payload),((s=t.selectedUser)==null?void 0:s._id)===r.payload&&(t.selectedUser=null)}).addCase(eo.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearUserError:ek,setSelectedUser:va}=pf.actions,cy=pf.reducer,{Text:dy}=Me,hy=({visible:e,user:t,onClose:r})=>{if(!t)return null;const s=i=>typeof i=="string"?i:i&&typeof i=="object"&&i.name?i.name:"Unknown";return n.jsxs(Ye,{title:"User Details",open:e,onCancel:r,footer:null,width:600,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[n.jsx(Ur,{size:64,icon:n.jsx(ht,{}),style:{backgroundColor:"#1677ff"}}),n.jsxs("div",{style:{marginLeft:20},children:[n.jsx(dy,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),n.jsxs("div",{children:[n.jsx(_e,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),n.jsx(_e,{color:"blue",children:s(t.role)})]})]})]}),n.jsx(it,{}),n.jsxs(Ve,{bordered:!0,column:1,children:[n.jsx(Ve.Item,{label:"Username",children:t.username}),n.jsx(Ve.Item,{label:"Email",children:t.email}),n.jsx(Ve.Item,{label:"Role",children:s(t.role)}),n.jsx(Ve.Item,{label:"Status",children:n.jsx(_e,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),n.jsx(Ve.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),n.jsx(Ve.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:ba}=Le,{Text:uy}=Me,fy=({visible:e,user:t,onClose:r,onSuccess:s})=>{const{message:i}=Zt.useApp(),[a]=W.useForm(),o=lt(),{roles:l,loading:d}=qe(f=>f.role),{loading:c}=qe(f=>f.user);_.useEffect(()=>{e&&t&&a.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:typeof t.role=="object"?t.role._id:t.role,isActive:t.isActive})},[e,t,a]),_.useEffect(()=>{e&&o(Us())},[e,o]);const h=async()=>{if(t)try{const f=await a.validateFields(),u={username:f.username,name:f.name,email:f.email,role:f.role,isActive:f.isActive};f.password&&f.password.trim()!==""&&(u.password=f.password),o(Za({id:t._id,userData:u})).unwrap().then(()=>{i.success("User updated successfully"),s(),r()}).catch(p=>{i.error(`Failed to update user: ${p}`)})}catch(f){console.error("Validation error:",f)}};return t?n.jsx(Ye,{title:"Edit User",open:e,onCancel:r,width:600,footer:[n.jsx(re,{onClick:r,children:"Cancel"},"cancel"),n.jsx(re,{type:"primary",loading:c,onClick:h,children:"Update User"},"submit")],children:n.jsxs(W,{form:a,layout:"vertical",children:[n.jsx(W.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(he,{placeholder:"Username"})}),n.jsx(W.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:n.jsx(he,{placeholder:"Full name"})}),n.jsx(W.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Email address"})}),n.jsx(it,{children:n.jsx(uy,{type:"secondary",children:"Change Password (Optional)"})}),n.jsx(W.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"New password (optional)"})}),n.jsx(it,{}),n.jsx(W.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Le,{loading:d,children:l.length>0?l.map(f=>n.jsx(ba,{value:f._id,children:f.name},f._id)):n.jsxs(n.Fragment,{children:[n.jsx(ba,{value:"admin",children:"Admin"}),n.jsx(ba,{value:"manager",children:"Manager"}),n.jsx(ba,{value:"agent",children:"Agent"})]})})}),n.jsx(W.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:wa}=Le,{Text:tk}=Me,xy=({visible:e,onClose:t,onSuccess:r})=>{const{message:s}=Zt.useApp(),[i]=W.useForm(),a=lt(),{roles:o,loading:l}=qe(h=>h.role),{loading:d}=qe(h=>h.user);_.useEffect(()=>{e&&a(Us())},[e,a]),_.useEffect(()=>{e&&i.resetFields()},[e,i]);const c=async()=>{try{const h=await i.validateFields(),f={username:h.username,name:h.name,email:h.email,password:h.password,role:h.role,isActive:h.status};a(Ja(f)).unwrap().then(u=>{s.success("User created successfully"),i.resetFields(),r(),t()}).catch(u=>{s.error(`Failed to create user: ${u}`)})}catch(h){console.error("Validation error:",h)}};return n.jsx(Ye,{title:"Create New User",open:e,onCancel:t,width:600,footer:[n.jsx(re,{onClick:t,children:"Cancel"},"cancel"),n.jsx(re,{type:"primary",loading:d,onClick:c,children:"Create User"},"submit")],children:n.jsxs(W,{form:i,layout:"vertical",requiredMark:!1,children:[n.jsx(W.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(he,{placeholder:"Username"})}),n.jsx(W.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:n.jsx(he,{placeholder:"Full name"})}),n.jsx(W.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Email address"})}),n.jsx(W.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"Enter password"})}),n.jsx(it,{}),n.jsx(W.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Le,{placeholder:"Select role",loading:l,children:o.length>0?o.map(h=>n.jsx(wa,{value:h._id,children:h.name},h._id)):n.jsxs(n.Fragment,{children:[n.jsx(wa,{value:"admin",children:"Admin"}),n.jsx(wa,{value:"manager",children:"Manager"}),n.jsx(wa,{value:"agent",children:"Agent"})]})})}),n.jsx(W.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:py,Paragraph:my,Text:ui}=Me,{TabPane:wl}=Jt,{confirm:gy}=Ye;function yy(){const{message:e,notification:t}=Zt.useApp(),r=lt(),{users:s,loading:i,error:a,selectedUser:o}=qe(I=>I.user),[l,d]=_.useState(""),[c,h]=_.useState("all"),[f,u]=_.useState(!1),[p,g]=_.useState(!1),[x,m]=_.useState(!1),{hasPermission:v}=Wo();_.useEffect(()=>{r(ns())},[r]),_.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]),_.useEffect(()=>{o||(u(!1),g(!1))},[o]);const S=(I,F)=>{gy({title:"Are you sure you want to delete this user?",icon:n.jsx(Xs,{}),content:`This will permanently delete ${F}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{r(eo(I)).unwrap().then(()=>{e.success(`${F} has been deleted successfully.`)}).catch(N=>{e.error(`Failed to delete user: ${N}`)})}})},T=I=>{r(va(I)),u(!0)},y=I=>{r(va(I)),g(!0)},w=()=>{m(!0)},k=[{title:"User",key:"user",render:(I,F)=>n.jsxs(ue,{children:[n.jsx(Ur,{icon:n.jsx(ht,{}),size:"large"}),n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx(ui,{strong:!0,children:F.name||F.username}),n.jsx(ui,{type:"secondary",style:{fontSize:"12px"},children:F.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:I=>{const F=A(I);let N=F.toLowerCase()==="admin"||F.toLowerCase()==="administrator"?"#1677ff":F.toLowerCase()==="manager"?"#52c41a":"#faad14";return n.jsx(_e,{color:N,style:{fontWeight:500,borderRadius:"4px"},children:F.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(I,F)=>A(F.role).toLowerCase().indexOf(I.toLowerCase())===0},{title:"Status",key:"status",render:(I,F)=>n.jsx(ue,{children:F.isActive?n.jsx(gr,{status:"success",text:n.jsx(ui,{style:{color:"#52c41a"},children:"Active"})}):n.jsx(gr,{status:"default",text:n.jsx(ui,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(I,F)=>F.isActive===I},{title:"Last Active",key:"lastLogin",render:(I,F)=>n.jsxs(ue,{children:[n.jsx(Qt,{style:{color:"#8c8c8c"}}),n.jsx(ui,{type:"secondary",children:F.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(I,F)=>n.jsxs(ue,{size:"small",children:[v("users_view")&&n.jsx(Ke,{title:"View details",children:n.jsx(re,{type:"text",icon:n.jsx(hn,{}),size:"small",onClick:()=>T(F)})}),v("users_edit")&&n.jsx(Ke,{title:"Edit user",children:n.jsx(re,{type:"text",icon:n.jsx(as,{}),size:"small",onClick:()=>y(F)})}),v("users_delete")&&n.jsx(Ke,{title:"Delete user",children:n.jsx(re,{type:"text",danger:!0,icon:n.jsx(sr,{}),size:"small",onClick:()=>S(F._id,F.name||F.username)})})]})}],b=I=>I.isActive?"active":"inactive",j=s.filter(I=>(c==="all"||c==="active"&&b(I)==="active"||c==="inactive"&&b(I)==="inactive")&&Object.values(I).some(F=>typeof F=="string"&&F.toLowerCase().includes(l.toLowerCase()))),A=I=>typeof I=="string"?I:I&&typeof I=="object"&&I.name?I.name:"Unknown",E={admin:s.filter(I=>{const F=A(I.role).toLowerCase();return F==="admin"||F==="administrator"}).length,manager:s.filter(I=>A(I.role).toLowerCase()==="manager").length,agent:s.filter(I=>A(I.role).toLowerCase()==="agent").length},C={active:s.filter(I=>I.isActive).length,inactive:s.filter(I=>!I.isActive).length};return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(py,{level:2,children:"User Management"}),n.jsx(my,{children:"Manage user accounts, permissions, and access control."})]}),n.jsxs(Ne,{gutter:[16,16],style:{marginBottom:24},children:[n.jsx(Q,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Ze,{title:"Total Users",value:s.length,prefix:n.jsx(ht,{}),valueStyle:{color:"#1677ff"},loading:i})})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Ze,{title:"Active Users",value:C.active,prefix:n.jsx(wc,{}),valueStyle:{color:"#52c41a"},loading:i})})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Ze,{title:"Admin Users",value:E.admin,prefix:n.jsx(ht,{}),valueStyle:{color:"#faad14"},loading:i})})})]}),n.jsx(de,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs(Ne,{gutter:[16,16],justify:"space-between",align:"middle",children:[n.jsx(Q,{xs:24,md:12,children:n.jsx(he,{placeholder:"Search users...",prefix:n.jsx(An,{style:{color:"rgba(0,0,0,.45)"}}),onChange:I=>d(I.target.value),allowClear:!0,size:"middle"})}),n.jsx(Q,{xs:24,md:12,style:{textAlign:"right"},children:n.jsxs(ue,{wrap:!0,children:[n.jsx(Ke,{title:"Refresh data",children:n.jsx(re,{icon:i?n.jsx(kx,{}):n.jsx(An,{}),onClick:()=>r(ns()),disabled:i,children:"Refresh"})}),n.jsx(re,{type:"primary",icon:n.jsx(Fi,{}),onClick:w,children:"Add User"})]})})]})}),n.jsxs(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[n.jsxs(Jt,{defaultActiveKey:"all",onChange:h,tabBarStyle:{marginBottom:24},children:[n.jsx(wl,{tab:`All Users (${s.length})`},"all"),n.jsx(wl,{tab:`Active (${C.active})`},"active"),n.jsx(wl,{tab:`Inactive (${C.inactive})`},"inactive")]}),n.jsx(st,{columns:k,dataSource:j,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(I,F)=>`${F[0]}-${F[1]} of ${I} users`},loading:i})]}),n.jsx(hy,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:f,onClose:()=>r(va(null))}),n.jsx(fy,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:p,onClose:()=>r(va(null)),onSuccess:()=>r(ns())}),n.jsx(xy,{visible:x,onClose:()=>m(!1),onSuccess:()=>r(ns())})]})}const{Title:rk,Text:ja,Paragraph:fi}=Me,vy=({settings:e,onSave:t,loading:r})=>{const[s]=W.useForm();xt.useEffect(()=>{s.setFieldsValue(e)},[e,s]);const i=a=>{t(a)};return n.jsxs(de,{title:n.jsxs(ue,{children:[n.jsx(fn,{}),n.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[n.jsx(fi,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),n.jsx(It,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),n.jsxs(W,{form:s,layout:"vertical",initialValues:e,onFinish:i,children:[n.jsxs(Ne,{gutter:[24,16],children:[n.jsxs(Q,{span:24,children:[n.jsx(W.Item,{name:"newLeads",valuePropName:"checked",label:n.jsx(ja,{strong:!0,children:"New Lead Notifications"}),children:n.jsx(Rr,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),n.jsxs(Q,{span:24,children:[n.jsx(W.Item,{name:"followUpReminders",valuePropName:"checked",label:n.jsx(ja,{strong:!0,children:"Follow-up Reminders"}),children:n.jsx(Rr,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),n.jsxs(Q,{span:24,children:[n.jsx(W.Item,{name:"statusChanges",valuePropName:"checked",label:n.jsx(ja,{strong:!0,children:"Status Change Notifications"}),children:n.jsx(Rr,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),n.jsxs(Q,{span:24,children:[n.jsx(W.Item,{name:"leadAssignments",valuePropName:"checked",label:n.jsx(ja,{strong:!0,children:"Lead Assignment Notifications"}),children:n.jsx(Rr,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),n.jsx(it,{}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:r,children:"Save Email Preferences"})})]})]})},jl=e=>{switch(e){case"NEW_BOOKING":return Lt.NEW_BOOKING;case"BOOKING_CONFIRMED":return Lt.BOOKING_CONFIRMED;case"BOOKING_CANCELLED":return Lt.BOOKING_CANCELLED;case"PAYMENT_RECEIVED":return Lt.PAYMENT_RECEIVED;case"INVOICE_GENERATED":return Lt.INVOICE_GENERATED;case"EXHIBITION_UPDATE":return Lt.EXHIBITION_UPDATE;case"SYSTEM_MESSAGE":return Lt.SYSTEM_MESSAGE;case"EXHIBITOR_MESSAGE":return Lt.EXHIBITOR_MESSAGE;case"EXHIBITOR_REGISTERED":return Lt.EXHIBITOR_REGISTERED;default:return Lt.SYSTEM_MESSAGE}},{Title:by,Text:nk,Paragraph:rh}=Me,{Search:wy}=he,{TabPane:nh}=Jt,jy=()=>{const e=tt();Dr();const[t,r]=_.useState([]),[s,i]=_.useState([]),[a,o]=_.useState(!1),[l,d]=_.useState(""),[c,h]=_.useState("ALL"),[f,u]=_.useState("ALL"),[p,g]=_.useState({newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0}),[x,m]=_.useState(!1),[v,S]=_.useState("all");_.useEffect(()=>{const U=localStorage.getItem("token");U&&vt.init(U,!1),T(),vt.subscribeToNotifications();const M=z=>{const J={...z,type:jl(z.type)};r(ne=>ne.some(te=>te._id===z._id)?ne:[J,...ne])},L=z=>{if(z.newNotifications&&z.newNotifications.length>0){const J=z.newNotifications.map(ne=>({...ne,type:jl(ne.type)}));r(ne=>[...J.filter(P=>!ne.some(H=>H._id===P._id)),...ne])}};return vt.addEventListener("notification",M),vt.addEventListener("notification_update",L),()=>{vt.removeEventListener("notification",M),vt.removeEventListener("notification_update",L)}},[]),_.useEffect(()=>{y()},[t,l,c,f,v]),_.useEffect(()=>{T();const N=()=>{t.length===0&&T()};return window.addEventListener("focus",N),()=>{window.removeEventListener("focus",N)}},[t.length]);const T=async()=>{o(!0);try{const N=await vt.getNotifications(1,50);if(N.success){const U=N.data.notifications.map(M=>({...M,type:jl(M.type)}));r(U)}}catch{gn.error({message:"Failed to fetch notifications",description:"There was an error loading your notifications. Please try again later."})}finally{o(!1)}},y=()=>{let N=t;if(v==="unread"&&(N=N.filter(U=>U.isRead===!1)),l){const U=l.toLowerCase();N=N.filter(M=>M.title.toLowerCase().includes(U)||M.message.toLowerCase().includes(U))}c!=="ALL"&&(N=N.filter(U=>U.type===c)),f!=="ALL"&&(N=N.filter(U=>U.source===f)),i(N)},w=N=>{S(N)},k=N=>{d(N)},b=()=>{d(""),h("ALL"),u("ALL"),S("all")},j=N=>{const U=Im(N);e(U)},A=async N=>{try{await vt.markAsRead(N._id);const U=t.map(M=>M._id===N._id?{...M,isRead:!0,readAt:new Date().toISOString()}:M);r(U)}catch{gn.error({message:"Failed to mark notification as read",description:"There was an error updating the notification status. Please try again later."})}},E=async N=>{try{await vt.deleteNotification(N._id);const U=t.filter(M=>M._id!==N._id);r(U),gn.success({message:"Notification deleted",description:"The notification has been deleted successfully."})}catch{gn.error({message:"Failed to delete notification",description:"There was an error deleting the notification. Please try again later."})}},C=async()=>{try{await vt.markAllAsRead();const N=t.map(U=>({...U,isRead:!0,readAt:new Date().toISOString()}));r(N),gn.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})}catch{gn.error({message:"Failed to mark all notifications as read",description:"There was an error updating the notification status. Please try again later."})}},I=async()=>{try{await vt.deleteAllNotifications(),r([]),gn.success({message:"All notifications cleared",description:"All notifications have been deleted successfully."})}catch{gn.error({message:"Failed to clear notifications",description:"There was an error deleting the notifications. Please try again later."})}},F=N=>{m(!0),setTimeout(()=>{g(N),m(!1),gn.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return n.jsx("div",{className:"notifications-page",children:n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,children:n.jsx(de,{children:n.jsxs(Ne,{justify:"space-between",align:"middle",children:[n.jsxs(Q,{children:[n.jsx(by,{level:4,children:n.jsxs(ue,{children:[n.jsx(yc,{}),"Notifications ",t.length>0?`(${t.length})`:""]})}),n.jsx(rh,{children:"Stay updated with all your lead activities and follow-ups"})]}),n.jsx(Q,{children:n.jsxs(ue,{children:[n.jsx(Ke,{title:"Refresh notifications",children:n.jsx(re,{icon:n.jsx(Ks,{}),onClick:T,loading:a,children:"Refresh"})}),n.jsx(re,{type:"primary",icon:n.jsx(vc,{}),onClick:C,disabled:t.filter(N=>!N.isRead).length===0,children:"Mark All as Read"}),n.jsx(re,{type:"primary",danger:!0,icon:n.jsx(sr,{}),onClick:I,disabled:t.length===0,children:"Clear All"})]})})]})})}),n.jsx(Q,{xs:24,lg:16,children:n.jsxs(de,{className:"notifications-list-card",style:{marginBottom:24},children:[n.jsxs(Jt,{activeKey:v,onChange:w,tabBarExtraContent:n.jsx(ue,{children:n.jsx(gr,{count:Am(t),offset:[-5,0],children:n.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[n.jsx(nh,{tab:"All Notifications"},"all"),n.jsx(nh,{tab:"Unread"},"unread")]}),n.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[n.jsx(wy,{placeholder:"Search notifications...",onSearch:k,style:{width:300},allowClear:!0}),n.jsx(ue,{children:n.jsx(re,{icon:n.jsx(Ki,{}),onClick:b,disabled:l===""&&c==="ALL"&&f==="ALL",children:"Reset Filters"})})]}),n.jsx(on,{dataSource:s,renderItem:N=>n.jsx(Ku,{notification:N,onView:j,onMarkAsRead:A,onDelete:E}),pagination:{pageSize:10,showTotal:(N,U)=>`${U[0]}-${U[1]} of ${N} notifications`},rowKey:"_id",loading:a,locale:{emptyText:n.jsx(bt,{description:n.jsx("span",{children:"No notifications found"})})}})]})}),n.jsxs(Q,{xs:24,lg:8,children:[n.jsx(vy,{settings:p,onSave:F,loading:x}),n.jsx(de,{title:n.jsxs(ue,{children:[n.jsx(Ri,{}),n.jsx("span",{children:"Notification Tips"})]}),children:n.jsx(rh,{children:n.jsxs("ul",{children:[n.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),n.jsx("li",{children:"Use email notifications for critical updates when you're away"}),n.jsx("li",{children:"Click on a notification to see more details or take action"}),n.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class Ji extends xt.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t;return this.state.hasError?n.jsx(Li,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[n.jsx(re,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),n.jsx(re,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Ut=e=>{var r,s;const t=((s=(r=e.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred";throw new Error(t)},wt={getExhibitions:async()=>{try{return await ke.get("/exhibitions")}catch(e){return Ut(e)}},getActiveExhibitions:async()=>{try{return await ke.get("/exhibitions/active")}catch(e){return Ut(e)}},getExhibition:async e=>{try{return await ke.get(`/exhibitions/${e}`)}catch(t){return Ut(t)}},createExhibition:async e=>{try{return await ke.post("/exhibitions",e)}catch(t){return Ut(t)}},updateExhibition:async(e,t)=>{try{return await ke.put(`/exhibitions/${e}`,t)}catch(r){return Ut(r)}},deleteExhibition:async e=>{try{return await ke.delete(`/exhibitions/${e}`)}catch(t){return Ut(t)}},getHalls:async e=>{try{return await ke.get(`/exhibitions/${e}/halls`)}catch(t){return Ut(t)}},createHall:async(e,t)=>{try{const{_id:r,id:s,createdAt:i,updatedAt:a,...o}=t;return console.log("Creating hall with data:",{exhibitionId:e,data:o}),(await ke.post(`/exhibitions/${e}/halls`,o)).data}catch(r){throw console.error("Error creating hall:",r),r}},updateHall:async(e,t,r)=>{try{const{_id:s,id:i,createdAt:a,updatedAt:o,...l}=r;console.log("Updating hall with data:",{exhibitionId:e,hallId:t,data:l});const d=await ke.put(`/exhibitions/${e}/halls/${t}`,l);return console.log("Hall updated:",d.data),d}catch(s){return console.error("Error updating hall:",s),Ut(s)}},deleteHall:async(e,t)=>{var r,s,i;try{if(!e||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:e,hallId:t});const a=await ke.delete(`/exhibitions/${e}/halls/${t}`);if(!a.data)throw new Error("No response received from server");return a}catch(a){throw console.error("Error deleting hall:",a),((r=a.response)==null?void 0:r.status)===401?new Error("Unauthorized. Please log in again."):((s=a.response)==null?void 0:s.status)===403?new Error("You do not have permission to delete halls."):((i=a.response)==null?void 0:i.status)===404?new Error("Hall not found."):a}},saveLayout:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(r){return Ut(r)}},getLayout:async e=>{try{if(!e)throw new Error("Exhibition ID is required");return await ke.get(`/exhibitions/${e}/layout`)}catch(t){return Ut(t)}},getStalls:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await ke.get(`/exhibitions/${e}/stalls`,{params:{hallId:t}})}catch(r){return Ut(r)}},createStall:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await ke.post(`/exhibitions/${e}/stalls`,t)}catch(r){return Ut(r)}},updateStall:async(e,t,r)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:e,stallId:t,data:r});const s=await ke.put(`/exhibitions/${e}/stalls/${t}`,r);return console.log("Stall update response:",s),s}catch(s){return console.error("Error updating stall:",s),Ut(s)}},deleteStall:async(e,t)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");return await ke.delete(`/exhibitions/${e}/stalls/${t}`)}catch(r){return Ut(r)}},getFixtures:async(e,t)=>{try{const r=`/exhibitions/${e}/fixtures`,s=t?{type:t}:void 0;return await ke.get(r,{params:s})}catch(r){return Ut(r)}},getFixture:async(e,t)=>{try{return await ke.get(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Ut(r)}},createFixture:async(e,t)=>{try{return await ke.post(`/exhibitions/${e}/fixtures`,t)}catch(r){return Ut(r)}},updateFixture:async(e,t,r)=>{try{return await ke.put(`/exhibitions/${e}/fixtures/${t}`,r)}catch(s){return Ut(s)}},deleteFixture:async(e,t)=>{try{return await ke.delete(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Ut(r)}}},Sy={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},Mr=et("exhibition/fetchExhibitions",async(e,{rejectWithValue:t})=>{try{return(await wt.getExhibitions()).data.map(i=>({...i,id:i._id||i.id})).filter(i=>i.id)}catch(r){return t(r.message)}}),$r=et("exhibition/fetchExhibition",async(e,{rejectWithValue:t})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await wt.getExhibition(e)).data}catch(r){return t(r.message)}}),to=et("exhibition/createExhibition",async(e,{rejectWithValue:t})=>{try{return(await wt.createExhibition(e)).data}catch(r){return t(r.message)}}),ro=et("exhibition/updateExhibition",async({id:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await wt.updateExhibition(e,t)).data}catch(s){return r(s.message)}}),un=et("exhibition/fetchHalls",async(e,{rejectWithValue:t})=>{var r;try{if(!e)throw new Error("Exhibition ID is required");return(await wt.getHalls(e)).data}catch(s){return((r=s.response)==null?void 0:r.status)===404?[]:t(s.message)}}),dn=et("exhibition/fetchStalls",async({exhibitionId:e,hallId:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await wt.getStalls(e,t)).data}catch(s){return r(s.message)}}),ji=et("exhibition/deleteExhibition",async(e,{rejectWithValue:t})=>{try{return await wt.deleteExhibition(e),e}catch(r){return t(r.message)}}),Si=et("exhibition/fetchFixtures",async({exhibitionId:e,type:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await wt.getFixtures(e,t)).data}catch(s){return r(s.message)}}),no=et("exhibition/createFixture",async({exhibitionId:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await wt.createFixture(e,t)).data}catch(s){return r(s.message)}}),so=et("exhibition/updateFixture",async({exhibitionId:e,id:t,data:r},{rejectWithValue:s})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await wt.updateFixture(e,t,r)).data}catch(i){return s(i.message)}}),io=et("exhibition/deleteFixture",async({exhibitionId:e,id:t},{rejectWithValue:r})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return await wt.deleteFixture(e,t),t}catch(s){return r(s.message)}}),mf=br({name:"exhibition",initialState:Sy,reducers:{clearCurrentExhibition:e=>{e.currentExhibition=null,e.halls=[],e.stalls=[],e.fixtures=[],e.error=null},clearError:e=>{e.error=null},clearStalls:e=>{e.stalls=[]},clearFixtures:e=>{e.fixtures=[]}},extraReducers:e=>{e.addCase(Mr.pending,t=>{t.loading=!0,t.error=null}).addCase(Mr.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=r.payload}).addCase(Mr.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase($r.pending,t=>{t.loading=!0,t.error=null}).addCase($r.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload}).addCase($r.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(to.pending,t=>{t.loading=!0,t.error=null}).addCase(to.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions.push(r.payload)}).addCase(to.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ro.pending,t=>{t.loading=!0,t.error=null}).addCase(ro.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload;const s=t.exhibitions.findIndex(i=>i.id===r.payload.id);s!==-1&&(t.exhibitions[s]=r.payload)}).addCase(ro.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(un.pending,t=>{t.loading=!0,t.error=null}).addCase(un.fulfilled,(t,r)=>{t.loading=!1,t.halls=r.payload}).addCase(un.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(dn.pending,t=>{t.loading=!0,t.error=null}).addCase(dn.fulfilled,(t,r)=>{t.loading=!1;const s=r.payload.map(i=>{var a;return{...i,id:i._id||i.id,_id:i._id||i.id,stallTypeId:typeof i.stallTypeId=="string"?i.stallTypeId:(a=i.stallTypeId)==null?void 0:a._id,stallType:i.stallType||{name:"N/A",description:null}}});r.meta.arg.hallId,t.stalls=s}).addCase(dn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ji.pending,t=>{t.loading=!0,t.error=null}).addCase(ji.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(s=>(s._id||s.id)!==r.payload)}).addCase(ji.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Si.pending,t=>{t.loading=!0,t.error=null}).addCase(Si.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=r.payload.map(s=>({...s,id:s._id||s.id,_id:s._id||s.id}))}).addCase(Si.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(no.pending,t=>{t.loading=!0,t.error=null}).addCase(no.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id};t.fixtures.push(s)}).addCase(no.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(so.pending,t=>{t.loading=!0,t.error=null}).addCase(so.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id},i=t.fixtures.findIndex(a=>a.id===s.id||a._id===s._id);i!==-1&&(t.fixtures[i]=s)}).addCase(so.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(io.pending,t=>{t.loading=!0,t.error=null}).addCase(io.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=t.fixtures.filter(s=>s.id!==r.payload&&s._id!==r.payload)}).addCase(io.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearCurrentExhibition:sk,clearError:ik,clearStalls:ak,clearFixtures:ok}=mf.actions,Ey=mf.reducer,Bt=(e,t)=>{if(!e)return"";let s=`/exhibition/${e.slug||e._id||e.id}`;return t&&(s+=`/${t}`),s},Ho=(e,t)=>e?`/exhibitions/${e.slug||e._id||e.id}`:"",{Title:Ty,Text:Jn}=Me,{RangePicker:_y}=Qs,ky=()=>{const{message:e,modal:t}=Zt.useApp(),r=tt(),s=lt(),{exhibitions:i,loading:a}=qe(N=>N.exhibition),[o,l]=_.useState([]),[d,c]=_.useState(!1),[h,f]=_.useState(!1),[u,p]=_.useState({status:[],dateRange:null,search:"",activeStatus:null}),[g,x]=_.useState("all"),{hasPermission:m}=Wo();_.useEffect(()=>{s(Mr())},[s]);const v=_.useMemo(()=>{const N=i.length,U=i.filter(J=>J.status==="published").length,M=i.filter(J=>new Date(J.startDate)>new Date).length,L=i.filter(J=>J.status==="completed").length,z=i.filter(J=>J.isActive).length;return{total:N,active:U,upcoming:M,completed:L,activeCount:z}},[i]),S=async N=>{const U=N._id||N.id;try{c(!0),await s(ji(U)).unwrap(),e.success("Exhibition deleted successfully")}catch(M){e.error(M.message||"Failed to delete exhibition")}finally{c(!1)}},T=async()=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(sr,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsxs("strong",{children:[o.length," selected exhibitions"]}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(re,{onClick:()=>Ye.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(re,{danger:!0,type:"primary",onClick:async()=>{try{c(!0),await Promise.all(o.map(N=>s(ji(N._id||N.id)).unwrap())),e.success(`Successfully deleted ${o.length} exhibitions`),l([])}catch(N){e.error(N.message||"Failed to delete some exhibitions")}finally{c(!1),Ye.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},y=async(N,U)=>{try{f(!0);const M=N._id||N.id;await wt.updateExhibition(M,{status:U});const L=i.map(z=>(z._id||z.id)===M?{...z,status:U}:z);s(Mr.fulfilled(L,"",void 0)),e.success("Status updated successfully")}catch{e.error("Failed to update status"),s(Mr())}finally{f(!1)}},w=async(N,U)=>{try{f(!0);const M=N._id||N.id;await wt.updateExhibition(M,{isActive:U});const L=i.map(z=>(z._id||z.id)===M?{...z,isActive:U}:z);s(Mr.fulfilled(L,"",void 0)),e.success(`Exhibition ${U?"activated":"deactivated"} successfully`)}catch{e.error("Failed to update active status"),s(Mr())}finally{f(!1)}},k=(N,U)=>{const M=N._id||N.id;U==="/layout"?r(Bt(N,"layout"),{state:{exhibitionId:M}}):r(Bt(N)+U,{state:{exhibitionId:M}})},b=N=>{switch(N.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},j=(N,U)=>{const M=b(N);return n.jsxs(ue,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[n.jsx(_e,{color:M,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:N}),!U&&n.jsx(_e,{color:"red",style:{margin:0},children:"Inactive"})]})},A=N=>{const U=new Date,M=new Date(N.startDate),L=new Date(N.endDate);if(U<M)return 0;if(U>L)return 100;const z=L.getTime()-M.getTime(),J=U.getTime()-M.getTime();return Math.round(J/z*100)},E=N=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(sr,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsx("strong",{children:N.name}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(re,{onClick:()=>Ye.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(re,{danger:!0,type:"primary",onClick:()=>{S(N),Ye.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},C=N=>[{key:"view",label:"View Details",icon:n.jsx(hn,{}),onClick:()=>k(N,"")},{key:"edit",label:"Edit Exhibition",icon:n.jsx(as,{}),onClick:()=>k(N,"/edit")},{key:"layout",label:"Manage Layout",icon:n.jsx(xs,{}),onClick:()=>k(N,"/layout")},{type:"divider"},...N.status==="published"?[{key:"public-view",label:"Public View",icon:n.jsx(hn,{}),onClick:()=>window.open(Ho(N),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:n.jsx(Ki,{}),children:[{key:"draft",label:n.jsxs(ue,{children:[n.jsx(_e,{color:"#faad14",style:{margin:0},children:"Draft"}),n.jsx("span",{children:"Set as Draft"})]}),icon:n.jsx(Cn,{}),onClick:()=>y(N,"draft"),disabled:N.status==="draft"||h},{key:"published",label:n.jsxs(ue,{children:[n.jsx(_e,{color:"#52c41a",style:{margin:0},children:"Published"}),n.jsx("span",{children:"Publish"})]}),icon:n.jsx(St,{}),onClick:()=>y(N,"published"),disabled:N.status==="published"||h},{key:"completed",label:n.jsxs(ue,{children:[n.jsx(_e,{color:"#1890ff",style:{margin:0},children:"Completed"}),n.jsx("span",{children:"Mark as Completed"})]}),icon:n.jsx(Qt,{}),onClick:()=>y(N,"completed"),disabled:N.status==="completed"||h}]},{key:"active-status",label:n.jsxs(ue,{children:[N.isActive?n.jsx(_e,{color:"red",style:{margin:0},children:"Deactivate"}):n.jsx(_e,{color:"#52c41a",style:{margin:0},children:"Activate"}),n.jsx("span",{children:N.isActive?"Deactivate":"Activate"})]}),icon:n.jsx(pd,{}),onClick:()=>w(N,!N.isActive),disabled:h},{type:"divider"},{key:"delete",label:"Delete",icon:n.jsx(sr,{}),danger:!0,onClick:()=>E(N)}],I=_.useMemo(()=>i.filter(N=>{if(u.search&&!N.name.toLowerCase().includes(u.search.toLowerCase())||u.status.length>0&&!u.status.includes(N.status)||u.activeStatus!==null&&N.isActive!==u.activeStatus)return!1;if(u.dateRange){const[U,M]=u.dateRange,L=new Date(N.startDate),z=new Date(N.endDate);if(L<new Date(U)||z>new Date(M))return!1}switch(g){case"active":return N.status==="published";case"upcoming":return new Date(N.startDate)>new Date;case"completed":return N.status==="completed";default:return!0}}),[i,u,g]),F=[{title:"Exhibition Details",key:"details",render:(N,U)=>n.jsx(Jn,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>k(U,""),children:U.name})},{title:"Status",key:"status",width:180,align:"center",render:(N,U)=>j(U.status,U.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(N,U)=>U.status===N},{title:"Start Date",key:"startDate",width:130,render:(N,U)=>n.jsx(Jn,{children:nt(U.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(N,U)=>n.jsx(Jn,{children:nt(U.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(N,U)=>n.jsx(Jn,{children:nt(U.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(N,U)=>n.jsx(Qr,{percent:A(U),size:"small",status:U.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(N,U)=>n.jsxs(ue,{size:"middle",children:[m("exhibitions_view")&&n.jsx(Ke,{title:"View Details",children:n.jsx(re,{type:"text",icon:n.jsx(hn,{}),onClick:()=>k(U,"")})}),m("exhibitions_edit")&&n.jsx(Ke,{title:"Edit Exhibition",children:n.jsx(re,{type:"text",icon:n.jsx(as,{}),onClick:()=>k(U,"/edit")})}),m("exhibitions_delete")&&n.jsx(Vn,{menu:{items:C(U)},trigger:["click"],placement:"bottomRight",children:n.jsx(re,{type:"text",icon:n.jsx(Ec,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ne,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(Ty,{level:4,style:{margin:0},children:"Exhibitions"}),n.jsx(Jn,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),n.jsx(Q,{children:n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),onClick:()=>r("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),n.jsxs(Ne,{gutter:[24,24],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,lg:4,children:n.jsx(de,{children:n.jsx(Ze,{title:"Total Exhibitions",value:v.total,prefix:n.jsx(Cn,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Ze,{title:"Published Exhibitions",value:v.active,prefix:n.jsx(St,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Ze,{title:"Upcoming Exhibitions",value:v.upcoming,prefix:n.jsx(Qt,{style:{color:"#1890ff"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Ze,{title:"Completed Exhibitions",value:v.completed,prefix:n.jsx(St,{style:{color:"#8c8c8c"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Ze,{title:"Active Status",value:v.activeCount,prefix:n.jsx(pd,{style:{color:"#52c41a"}})})})})]}),n.jsx(de,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:n.jsxs(ue,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ne,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(ue,{size:"middle",wrap:!0,children:[n.jsx(he,{placeholder:"Search exhibitions",prefix:n.jsx(An,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:u.search,onChange:N=>p(U=>({...U,search:N.target.value})),allowClear:!0}),n.jsx(Le,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:u.status,onChange:N=>p(U=>({...U,status:N})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),n.jsxs(Le,{placeholder:"Active Status",style:{width:"150px"},value:u.activeStatus,onChange:N=>p(U=>({...U,activeStatus:N})),allowClear:!0,children:[n.jsx(Le.Option,{value:!0,children:"Active"}),n.jsx(Le.Option,{value:!1,children:"Inactive"})]}),n.jsx(_y,{onChange:N=>p(U=>{var M,L;return{...U,dateRange:N?[((M=N[0])==null?void 0:M.toISOString())||"",((L=N[1])==null?void 0:L.toISOString())||""]:null}})})]})}),n.jsx(Q,{children:n.jsx(Cx,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:g,onChange:N=>x(N)})})]}),o.length>0&&n.jsx(Ne,{children:n.jsxs(ue,{children:[n.jsxs(Jn,{children:["Selected ",o.length," items"]}),n.jsx(re,{danger:!0,onClick:T,children:"Delete Selected"})]})})]})}),n.jsx(de,{className:"info-card",styles:{body:{padding:0}},children:n.jsx(st,{columns:F,dataSource:I.map(N=>({...N,key:N._id||N.id})),rowKey:N=>N._id||N.id,loading:a||d||h,rowSelection:{selectedRowKeys:o.map(N=>N._id||N.id),onChange:(N,U)=>l(U),selections:[st.SELECTION_ALL,st.SELECTION_NONE]},footer:()=>o.length>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[n.jsxs(Jn,{children:["Selected ",n.jsx("strong",{children:o.length})," ",o.length===1?"exhibition":"exhibitions"]}),n.jsx(re,{danger:!0,onClick:T,icon:n.jsx(sr,{}),loading:d,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:N=>`Total ${N} items`,style:{marginTop:"16px"}}})})]})},ss={getStallTypes:async()=>ke.get("/stall-types"),createStallType:async e=>ke.post("/stall-types",e),updateStallType:async(e,t)=>ke.put(`/stall-types/${e}`,t),deleteStallType:async e=>ke.delete(`/stall-types/${e}`)},Cy=Object.freeze(Object.defineProperty({__proto__:null,default:ss},Symbol.toStringTag,{value:"Module"})),{RangePicker:Ay}=Qs,{Title:bn,Text:wn}=Me,sh=({value:e="",onChange:t})=>{const r=xt.useRef(null),[s]=xt.useState(e);return n.jsx(mp,{apiKey:Sm,onInit:(i,a)=>{r.current=a},value:e,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:i=>{i.on("init",()=>{i.undoManager.clear(),i.undoManager.add()}),i.on("change",()=>{i.undoManager.add()})}},onEditorChange:i=>{t==null||t(i)}})},Iy=({form:e})=>{const[t,r]=_.useState([]),[s,i]=_.useState(!1);return _.useEffect(()=>{(async()=>{try{i(!0);const o=await ss.getStallTypes();r(o.data.filter(l=>l.status==="active"))}catch(o){console.error("Failed to fetch stall types:",o)}finally{i(!1)}})()},[]),n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(de,{className:"settings-card",children:[n.jsx(bn,{level:4,children:"Basic Information"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),n.jsxs(Ne,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:n.jsx(he,{placeholder:"Enter exhibition name"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:n.jsx(he.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:n.jsx(he,{placeholder:"Enter invoice prefix (default: INV)"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:n.jsx(Ay,{style:{width:"100%"}})})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Company Details"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),n.jsxs(Ne,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(W.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{placeholder:"Enter company name"})}),n.jsx(W.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:n.jsx(he,{placeholder:"Enter contact number"})}),n.jsx(W.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Enter email address"})}),n.jsx(W.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter company address"})}),n.jsx(W.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:n.jsx(sh,{})})]}),n.jsxs(Q,{span:12,children:[n.jsx(W.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:n.jsx(he,{placeholder:"Enter PAN number"})}),n.jsx(W.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:n.jsx(he,{placeholder:"Enter GST number"})}),n.jsx(W.Item,{name:"companySAC",label:"SAC Code No.",children:n.jsx(he,{placeholder:"Enter SAC code number"})}),n.jsx(W.Item,{name:"companyCIN",label:"CIN No.",children:n.jsx(he,{placeholder:"Enter CIN number"})}),n.jsx(W.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:n.jsx(he,{placeholder:"Enter website URL"})}),n.jsx(W.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:n.jsx(sh,{})})]})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Bank Details"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),n.jsxs(Ne,{gutter:24,children:[n.jsxs(Q,{span:12,children:[n.jsx(W.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:n.jsx(he,{placeholder:"Enter bank name"})}),n.jsx(W.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:n.jsx(he,{placeholder:"Enter branch name"})}),n.jsx(W.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:n.jsx(he,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),n.jsxs(Q,{span:12,children:[n.jsx(W.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:n.jsx(he,{placeholder:"Enter account name"})}),n.jsx(W.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:n.jsx(he,{placeholder:"Enter account number"})})]})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Stall Rates & Pricing"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(bn,{level:5,children:"Stall Type Rates"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),n.jsx(W.List,{name:"stallRates",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(W.Item,{...h,name:[c,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Le,{loading:s,placeholder:"Select stall type",style:{width:200},children:t.map(f=>n.jsx(Le.Option,{value:f._id,children:f.name},f._id))})}),n.jsx(W.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:n.jsx(jt,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"",formatter:f=>`${f}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:f=>{const u=f?Number(f.replace(/\\s?|(,*)/g,"")):0;return isNaN(u)?0:u}})}),n.jsx(rs,{onClick:()=>l(c)})]},d)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(mr,{}),children:"Add Stall Type Rate"})})]})})]}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(bn,{level:5,children:"Tax Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),n.jsx(W.List,{name:"taxConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(W.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:n.jsx(he,{placeholder:"Tax name",style:{width:150}})}),n.jsx(W.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:n.jsx(jt,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:f=>`${f}%`,parser:f=>{const u=f?Number(f.replace("%","")):0;return isNaN(u)?0:Math.min(u,100)}})}),n.jsx(W.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(rs,{onClick:()=>l(c)})]},d)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(mr,{}),children:"Add Tax"})})]})})]}),n.jsxs("div",{children:[n.jsx(bn,{level:5,children:"Admin Discount Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),n.jsx(W.List,{name:"discountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(W.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(he,{placeholder:"Discount",style:{width:150}})}),n.jsx(W.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Le,{style:{width:150},children:[n.jsx(Le.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Le.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),n.jsx(W.Item,{noStyle:!0,shouldUpdate:(f,u)=>{var p,g,x,m;return((g=(p=f==null?void 0:f.discountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(x=u==null?void 0:u.discountConfig)==null?void 0:x[c])==null?void 0:m.type)},children:({getFieldValue:f})=>{const u=f(["discountConfig",c,"type"]);return n.jsx(W.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(jt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(W.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(rs,{onClick:()=>l(c)})]},d)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(mr,{}),children:"Add Admin Discount"})})]})})]}),n.jsxs("div",{style:{marginTop:"24px"},children:[n.jsx(bn,{level:5,children:"Public Discount Configuration"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),n.jsx(W.List,{name:"publicDiscountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(W.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(he,{placeholder:"Discount",style:{width:150}})}),n.jsx(W.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Le,{style:{width:150},children:[n.jsx(Le.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Le.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),n.jsx(W.Item,{noStyle:!0,shouldUpdate:(f,u)=>{var p,g,x,m;return((g=(p=f==null?void 0:f.publicDiscountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(x=u==null?void 0:u.publicDiscountConfig)==null?void 0:x[c])==null?void 0:m.type)},children:({getFieldValue:f})=>{const u=f(["publicDiscountConfig",c,"type"]);return n.jsx(W.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(jt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(W.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(rs,{onClick:()=>l(c)})]},d)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(mr,{}),children:"Add Public Discount"})})]})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(bn,{level:4,children:"Status Settings"}),n.jsx(wn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),n.jsxs(Ne,{gutter:24,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Le,{children:[n.jsx(Le.Option,{value:"draft",children:"Draft"}),n.jsx(Le.Option,{value:"published",children:"Published"}),n.jsx(Le.Option,{value:"completed",children:"Completed"})]})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:ih,Text:Sl}=Me,Ny=({form:e})=>{const{message:t}=Zt.useApp(),[r,s]=_.useState([]),[i,a]=_.useState([]),[o,l]=_.useState(0),[d,c]=_.useState({}),h=x=>{const m=localStorage.getItem("token");return{url:`${ke.defaults.baseURL}/uploads/${x}`,token:m}};_.useEffect(()=>{const x=e.getFieldValue("headerLogo");if(x){const{url:m,token:v}=h(x);fetch(m,{headers:{authorization:`Bearer ${v}`}}).then(S=>S.blob()).then(S=>{const T=URL.createObjectURL(S);s([{uid:"-1",name:x.split("/").pop()||"logo",status:"done",url:T,thumbUrl:T,type:S.type,response:{path:x}}])}).catch(()=>{s([])})}},[e]),_.useEffect(()=>{const x=e.getFieldValue("sponsorLogos")||[];x.length>0&&Promise.all(x.map(async(m,v)=>{const{url:S,token:T}=h(m);try{const w=await(await fetch(S,{headers:{authorization:`Bearer ${T}`}})).blob(),k=URL.createObjectURL(w);return{uid:`-${v+1}`,name:m.split("/").pop()||`sponsor-${v+1}`,status:"done",url:k,thumbUrl:k,type:w.type,response:{path:m}}}catch{return null}})).then(m=>{a(m.filter(Boolean))})},[e]);const f={name:"file",action:`${ke.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(x){const{status:m,name:v,response:S,uid:T}=x.file;if(m==="uploading"){s([...x.fileList]);return}if(m==="done"&&S){const{url:y,token:w}=h(S.path);l(0),fetch(y,{headers:{authorization:`Bearer ${w}`}}).then(k=>k.blob()).then(k=>{const b=URL.createObjectURL(k);s([{uid:x.file.uid,name:v,status:"done",url:b,thumbUrl:b,type:k.type,response:S}]),t.success(`${v} uploaded successfully`),e.setFieldValue("headerLogo",S.path),S.thumbnail&&e.setFieldValue("headerLogoThumbnail",S.thumbnail)}).catch(()=>{t.error(`${v} preview failed to load`),s([])})}else m==="error"?(t.error(`${v} upload failed.`),s([]),l(0)):m==="removed"&&(s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0))},customRequest:async x=>{const{onProgress:m,onSuccess:v,onError:S,file:T,action:y,headers:w}=x;try{const k=new FormData;k.append("file",T);const b=new XMLHttpRequest;b.open("POST",y||"",!0),w&&Object.keys(w).forEach(j=>{b.setRequestHeader(j,w[j])}),b.upload.onprogress=j=>{j.lengthComputable&&m&&(m({percent:j.loaded/j.total*100}),l(Math.round(j.loaded/j.total*100)))},b.onload=()=>{if(b.status>=200&&b.status<300)try{const j=JSON.parse(b.response);v==null||v(j,T),l(0)}catch(j){S==null||S(j)}else S==null||S(new Error("Upload failed"))},b.onerror=()=>{l(0),S==null||S(new Error("Upload request failed"))},b.send(k)}catch(k){l(0),S==null||S(k)}},onRemove(){return s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0),!0},onPreview:async x=>{if(!x.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${x.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},u={name:"file",action:`${ke.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:i,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(x){const{status:m,name:v,response:S,uid:T}=x.file;if(m==="uploading"){a([...x.fileList]);return}if(m==="done"&&S&&S.paths&&S.paths.length>0){c(b=>{const j={...b};return delete j[T],j});const y=S.paths[0],{url:w,token:k}=h(y);fetch(w,{headers:{authorization:`Bearer ${k}`}}).then(b=>b.blob()).then(b=>{const j=URL.createObjectURL(b),A=[...i],E=A.findIndex(F=>F.uid===x.file.uid),C={uid:x.file.uid,name:v,status:"done",url:j,thumbUrl:j,type:b.type,response:{path:y}};E>-1?A[E]=C:A.push(C),a(A),t.success(`${v} uploaded successfully`);const I=A.filter(F=>{var N;return F.status==="done"&&((N=F.response)==null?void 0:N.path)}).map(F=>F.response.path);if(e.setFieldValue("sponsorLogos",I),S.thumbnails&&S.thumbnails.length>0){const F=e.getFieldValue("sponsorLogoThumbnails")||[];e.setFieldValue("sponsorLogoThumbnails",[...F,...S.thumbnails])}}).catch(()=>{t.error(`${v} preview failed to load`),a(b=>b.filter(j=>j.uid!==x.file.uid))})}else m==="error"?(t.error(`${v} upload failed.`),a(y=>y.filter(w=>w.uid!==x.file.uid)),c(y=>{const w={...y};return delete w[T],w})):m==="removed"&&c(y=>{const w={...y};return delete w[T],w})},customRequest:async x=>{const{onProgress:m,onSuccess:v,onError:S,file:T,action:y,headers:w}=x,k=typeof T=="object"&&"uid"in T?T.uid:String(Date.now());try{const b=new FormData;b.append("file",T);const j=new XMLHttpRequest;j.open("POST",y||"",!0),w&&Object.keys(w).forEach(A=>{j.setRequestHeader(A,w[A])}),j.upload.onprogress=A=>{if(A.lengthComputable&&m){const E=A.loaded/A.total*100;m({percent:E}),c(C=>({...C,[k]:Math.round(E)}))}},j.onload=()=>{if(j.status>=200&&j.status<300)try{const A=JSON.parse(j.response);v==null||v(A,T),c(E=>{const C={...E};return delete C[k],C})}catch(A){S==null||S(A)}else S==null||S(new Error("Upload failed"))},j.onerror=()=>{c(A=>{const E={...A};return delete E[k],E}),S==null||S(new Error("Upload request failed"))},j.send(b)}catch(b){c(j=>{const A={...j};return delete A[k],A}),S==null||S(b)}},onRemove(x){var T;const m=i.filter(y=>y.uid!==x.uid);a(m);const v=m.filter(y=>{var w;return y.status==="done"&&((w=y.response)==null?void 0:w.path)}).map(y=>y.response.path);e.setFieldValue("sponsorLogos",v);const S=e.getFieldValue("sponsorLogoThumbnails")||[];if(S.length>0&&(T=x.response)!=null&&T.path){const y=x.response.path.split("/"),w=y[y.length-1],k=S.filter(b=>!b.includes(w));e.setFieldValue("sponsorLogoThumbnails",k)}return c(y=>{const w={...y};return delete w[x.uid],w}),!0},onPreview:async x=>{if(!x.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${x.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},p=n.jsx("div",{children:o>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Qr,{type:"circle",percent:o,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Di,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),g=n.jsxs("div",{children:[n.jsx(Di,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return n.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:n.jsxs(de,{className:"settings-card",children:[n.jsx(ih,{level:4,children:"Header Settings"}),n.jsx(Sl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),n.jsxs(Ne,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsxs(W.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Pi,{...f,children:r.length<1&&p}),r.length>0&&o>0&&n.jsx(Qr,{percent:o,status:"active",style:{marginTop:8}})]})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:n.jsx(he,{placeholder:"Enter a title for your exhibition header"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:n.jsx(he,{placeholder:"Enter a subtitle (optional)"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:n.jsx(he.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),n.jsxs(Q,{span:24,children:[n.jsx(it,{}),n.jsx(ih,{level:5,children:"Sponsor Logos"}),n.jsx(Sl,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),n.jsxs(W.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[n.jsx(Pi,{...u,children:g}),Object.entries(d).map(([x,m])=>{var v;return n.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[n.jsxs(Sl,{style:{marginRight:10,width:150},ellipsis:!0,children:[((v=i.find(S=>S.uid===x))==null?void 0:v.name)||"File",":"]}),n.jsx(Qr,{percent:m,status:"active",style:{flex:1}})]},x)})]})]})]})]})})},{Title:ah,Text:oh}=Me,Fy=({form:e})=>{const{message:t}=Zt.useApp(),[r,s]=_.useState([]),i=o=>{const l=localStorage.getItem("token");return{url:`${ke.defaults.baseURL}/uploads/${o}`,token:l}};_.useEffect(()=>{const o=e.getFieldValue("footerLogo");if(o){const{url:l,token:d}=i(o);fetch(l,{headers:{authorization:`Bearer ${d}`}}).then(c=>c.blob()).then(c=>{const h=URL.createObjectURL(c);s([{uid:"-1",name:o.split("/").pop()||"logo",status:"done",url:h,thumbUrl:h,type:c.type,response:{path:o}}])}).catch(()=>{s([])})}},[e]);const a={name:"file",action:`${ke.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(o){const{status:l,name:d,response:c}=o.file;if(l==="uploading"){s([...o.fileList]);return}if(l==="done"&&c){const{url:h,token:f}=i(c.path);fetch(h,{headers:{authorization:`Bearer ${f}`}}).then(u=>u.blob()).then(u=>{const p=URL.createObjectURL(u);s([{uid:o.file.uid,name:d,status:"done",url:p,thumbUrl:p,type:u.type,response:c}]),t.success(`${d} uploaded successfully`),e.setFieldValue("footerLogo",c.path)}).catch(()=>{t.error(`${d} preview failed to load`),s([])})}else l==="error"?(t.error(`${d} upload failed.`),s([])):l==="removed"&&(s([]),e.setFieldValue("footerLogo",null))},onRemove(){return s([]),e.setFieldValue("footerLogo",null),!0},onPreview:async o=>{if(!o.url)return;const l=window.open("");l&&(l.document.write(`
          <img src="${o.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),l.document.head.innerHTML="<title>Image Preview</title>")}};return n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(de,{className:"settings-card",children:[n.jsx(ah,{level:4,children:"Footer Content"}),n.jsx(oh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),n.jsxs(Ne,{gutter:24,children:[n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:n.jsx(Pi,{...a,children:r.length<1&&n.jsxs("div",{children:[n.jsx(Di,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter contact email"})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:n.jsx(he,{placeholder:"Enter contact phone number"})})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(ah,{level:4,children:"Footer Links"}),n.jsx(oh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),n.jsx(W.List,{name:"footerLinks",children:(o,{add:l,remove:d})=>n.jsxs(n.Fragment,{children:[o.map(({key:c,name:h,...f})=>n.jsxs(Ne,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:11,children:n.jsx(W.Item,{...f,name:[h,"label"],rules:[{required:!0,message:"Please enter link label"}],children:n.jsx(he,{placeholder:"Link Label"})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{...f,name:[h,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:n.jsx(he,{placeholder:"URL (e.g., https://example.com)"})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(rs,{onClick:()=>d(h)})})]},c)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>l(),block:!0,icon:n.jsx(mr,{}),children:"Add Footer Link"})})]})})]})]})},{Title:El,Text:Tl}=Me,{TabPane:lh}=Jt,Ry=({form:e})=>n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(Jt,{defaultActiveKey:"basic",type:"card",children:[n.jsx(lh,{tab:"Basic Amenities",children:n.jsxs(de,{className:"settings-card",children:[n.jsx(El,{level:4,children:"Basic Amenities"}),n.jsx(Tl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),n.jsx(W.List,{name:"basicAmenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ne,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:5,children:n.jsx(W.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Le,{placeholder:"Select type",children:[n.jsx(Le.Option,{value:"facility",children:"Facility"}),n.jsx(Le.Option,{value:"service",children:"Service"}),n.jsx(Le.Option,{value:"equipment",children:"Equipment"}),n.jsx(Le.Option,{value:"other",children:"Other"})]})})}),n.jsx(Q,{span:6,children:n.jsx(W.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter name (e.g. Tables)"})})}),n.jsx(Q,{span:6,children:n.jsx(W.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(he.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(Q,{span:3,children:n.jsx(W.Item,{...o,name:[a,"perSqm"],label:n.jsxs(ue,{children:["Per sqm",n.jsx(Ke,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:n.jsx(Gt,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:n.jsx(jt,{style:{width:"100%"},placeholder:"9",min:1})})}),n.jsx(Q,{span:3,children:n.jsx(W.Item,{...o,name:[a,"quantity"],label:n.jsxs(ue,{children:["Quantity",n.jsx(Ke,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:n.jsx(Gt,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be  1"}],children:n.jsx(jt,{style:{width:"100%"},placeholder:"1",min:1})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:n.jsx(rs,{onClick:()=>s(a)})})]},i)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>r({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:n.jsx(mr,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),n.jsx(lh,{tab:"Extra Amenities",children:n.jsxs(de,{className:"settings-card",children:[n.jsx(El,{level:4,children:"Extra Amenities"}),n.jsx(Tl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),n.jsx(W.List,{name:"amenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ne,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(Q,{span:5,children:n.jsx(W.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Le,{placeholder:"Select type",children:[n.jsx(Le.Option,{value:"facility",children:"Facility"}),n.jsx(Le.Option,{value:"service",children:"Service"}),n.jsx(Le.Option,{value:"equipment",children:"Equipment"}),n.jsx(Le.Option,{value:"other",children:"Other"})]})})}),n.jsx(Q,{span:6,children:n.jsx(W.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter name (e.g. Power)"})})}),n.jsx(Q,{span:8,children:n.jsx(W.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(he.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(Q,{span:4,children:n.jsx(W.Item,{...o,name:[a,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:n.jsx(jt,{style:{width:"100%"},placeholder:"Enter rate",prefix:"",min:0,formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>{const d=l?Number(l.replace(/\\s?|(,*)/g,"")):0;return isNaN(d)?0:d}})})}),n.jsx(Q,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(rs,{onClick:()=>s(a)})})]},i)),n.jsx(W.Item,{children:n.jsx(re,{type:"dashed",onClick:()=>r({type:"service"}),block:!0,icon:n.jsx(mr,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(El,{level:4,children:"Special Requirements"}),n.jsx(Tl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),n.jsx(Ne,{gutter:24,children:n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),gf=({initialValues:e,onSubmit:t,submitText:r="Submit"})=>{const[s]=W.useForm(),i=o=>{t(o)},a=[{key:"general",label:"General",children:n.jsx(Iy,{form:s})},{key:"header",label:"Header",children:n.jsx(Ny,{form:s})},{key:"footer",label:"Footer",children:n.jsx(Fy,{form:s})},{key:"amenities",label:"Amenities",children:n.jsx(Ry,{form:s})}];return n.jsx(W,{form:s,layout:"vertical",initialValues:e,onFinish:i,style:{height:"100%"},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[n.jsx("div",{style:{flex:1,marginBottom:"24px"},children:n.jsx(Jt,{defaultActiveKey:"general",items:a,type:"card"})}),n.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:n.jsx(re,{type:"primary",htmlType:"submit",children:r})})]})})},Py=()=>{const e=tt(),t=lt(),r=async s=>{var i,a;try{const[o,l]=s.dateRange,d={name:s.name,description:s.description,venue:s.venue,startDate:o.toISOString(),endDate:l.toISOString(),status:s.status||"draft",isActive:s.isActive??!0,invoicePrefix:s.invoicePrefix,stallRates:s.stallRates||[],dimensions:{width:100,height:100},taxConfig:s.taxConfig||[],discountConfig:s.discountConfig||[],publicDiscountConfig:s.publicDiscountConfig||[],companyName:s.companyName,companyContactNo:s.companyContactNo,companyEmail:s.companyEmail,companyAddress:s.companyAddress,companyWebsite:s.companyWebsite,companyPAN:s.companyPAN,companyGST:s.companyGST,companySAC:s.companySAC,companyCIN:s.companyCIN,termsAndConditions:s.termsAndConditions,piInstructions:s.piInstructions,bankName:s.bankName,bankBranch:s.bankBranch,bankIFSC:s.bankIFSC,bankAccountName:s.bankAccountName,bankAccount:s.bankAccount,headerTitle:s.headerTitle,headerSubtitle:s.headerSubtitle,headerDescription:s.headerDescription,headerLogo:s.headerLogo,sponsorLogos:s.sponsorLogos||[],footerText:s.footerText,footerLogo:s.footerLogo,contactEmail:s.contactEmail,contactPhone:s.contactPhone,footerLinks:s.footerLinks||[],amenities:((i=s.amenities)==null?void 0:i.map(f=>({type:f.type,name:f.name,description:f.description,rate:f.rate})))||[],basicAmenities:((a=s.basicAmenities)==null?void 0:a.map(f=>({type:f.type,name:f.name,description:f.description,perSqm:f.perSqm,quantity:f.quantity})))||[],specialRequirements:s.specialRequirements},c=await t(to(d)).unwrap();Se.success("Exhibition created successfully");const h=c._id||c.id;h?e(Bt({_id:h,id:h,name:d.name}),{state:{exhibitionId:h}}):(Se.error("Exhibition ID not found in response"),e("/exhibition"))}catch(o){Se.error(o.message||"Failed to create exhibition"),console.error("Error creating exhibition:",o)}};return n.jsx(de,{title:"Create New Exhibition",children:n.jsx(gf,{onSubmit:r,submitText:"Create Exhibition"})})},{Title:ch,Text:lr,Paragraph:_l}=Me,kl=()=>{const e=tt();return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>e("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Dy=()=>{const{id:e}=Dr(),t=tt(),r=lt(),{currentExhibition:s,halls:i,stalls:a,loading:o}=qe(x=>x.exhibition),[l,d]=_.useState(0);_.useEffect(()=>{e&&(r($r(e)),r(un(e)),r(dn({exhibitionId:e})))},[e,r]),_.useEffect(()=>{s&&h()},[s]);const c=()=>{if(!s)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const x=i.length||0;let m=a.length||0,v=a.filter(S=>S.status==="booked"||S.status==="reserved").length;return m===0&&(s.stalls&&s.stalls.length>0?(m=s.stalls.length,v=s.stalls.filter(S=>S.status==="booked"||S.status==="reserved").length):(m=s.stallCount||0,v=s.bookedStallCount||0)),{hallCount:x,stallCount:m,bookedStallCount:v,availableStallCount:m-v}},h=()=>{if(!s)return 0;const x=new Date,m=new Date(s.startDate),v=new Date(s.endDate);if(x<m)return d(0);if(x>v)return d(100);const S=v.getTime()-m.getTime(),T=x.getTime()-m.getTime();d(Math.round(T/S*100))},f=x=>{switch(x.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},u=()=>{if(!s)return{text:"",count:0,isPast:!1};const x=new Date,m=new Date(s.startDate),v=new Date(s.endDate);return x>v?{text:"Ended",count:Math.ceil((x.getTime()-v.getTime())/864e5),isPast:!0}:x>=m&&x<=v?{text:"Days Remaining",count:Math.ceil((v.getTime()-x.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((m.getTime()-x.getTime())/(1e3*60*60*24)),isPast:!1}},p=x=>{t(Bt(s,x))};if(o)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(kl,{}),n.jsx(de,{children:n.jsx(ln,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!s)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(kl,{}),n.jsx(de,{children:n.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[n.jsx(Gt,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),n.jsx(ch,{level:4,children:"Exhibition not found"}),n.jsx(_l,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const g=u();return n.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[n.jsx(kl,{}),n.jsx(de,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:n.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:n.jsxs(Ne,{gutter:[24,24],align:"middle",children:[n.jsxs(Q,{xs:24,md:16,children:[n.jsx(ch,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:s.name}),n.jsx(_l,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:s.description}),n.jsxs(ue,{split:n.jsx(it,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[n.jsxs(ue,{children:[n.jsx(Yr,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsxs(lr,{style:{color:"rgba(255,255,255,0.8)"},children:[nt(s.startDate).format("MMM D, YYYY")," - ",nt(s.endDate).format("MMM D, YYYY")]})]}),s.venue&&n.jsxs(ue,{children:[n.jsx(os,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsx(lr,{style:{color:"rgba(255,255,255,0.8)"},children:s.venue})]})]})]}),n.jsx(Q,{xs:24,md:8,children:n.jsxs(de,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[n.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:f(s.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:s.status.toUpperCase()}),n.jsx(Ze,{title:g.text,value:g.count,suffix:"days",valueStyle:{color:g.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:n.jsx(Qt,{})}),n.jsx(it,{style:{margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"8px"},children:n.jsx(lr,{type:"secondary",children:"Exhibition Progress"})}),n.jsx(Qr,{percent:l,status:l===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),n.jsxs(Ne,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:8,children:n.jsx(re,{type:"primary",icon:n.jsx(xs,{}),onClick:()=>p(`${e}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(re,{icon:n.jsx(as,{}),onClick:()=>p(`${e}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),n.jsx(Q,{xs:24,sm:8,children:n.jsx(re,{icon:n.jsx(hn,{}),onClick:()=>window.open(Ho(s),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:s.status!=="published",children:"View Public Page"})})]}),n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,lg:16,children:n.jsxs(de,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[n.jsxs(Ne,{gutter:[24,24],children:[n.jsxs(Q,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),n.jsx(lr,{strong:!0,style:{fontSize:"16px"},children:nt(s.startDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),n.jsx(lr,{strong:!0,style:{fontSize:"16px"},children:nt(s.endDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),n.jsx(lr,{strong:!0,style:{fontSize:"16px"},children:nt(s.createdAt).format("MMMM D, YYYY")})]})]}),n.jsxs(Q,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),n.jsx(_e,{color:f(s.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.status.toUpperCase()})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),n.jsx(_e,{color:s.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.isActive?"ACTIVE":"INACTIVE"})]}),s.venue&&n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),n.jsx(lr,{strong:!0,style:{fontSize:"16px"},children:s.venue})]})]})]}),n.jsx(it,{}),n.jsxs("div",{children:[n.jsx(lr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),n.jsx(_l,{children:s.description||"No description provided."})]})]})}),n.jsxs(Q,{xs:24,lg:8,children:[n.jsx(de,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:n.jsxs(Ne,{gutter:[16,24],children:[n.jsx(Q,{span:12,children:n.jsx(Ze,{title:"Halls",value:c().hallCount,prefix:n.jsx(ps,{})})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{title:"Stalls",value:c().stallCount,prefix:n.jsx(wr,{})})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{title:"Booked Stalls",value:c().bookedStallCount,prefix:n.jsx(St,{})})}),n.jsx(Q,{span:12,children:n.jsx(Ze,{title:"Available Stalls",value:c().availableStallCount,prefix:n.jsx(Ax,{})})})]})}),n.jsx(de,{title:"Created By",style:{borderRadius:"12px"},children:s.createdBy?n.jsxs(ue,{children:[n.jsx(Ur,{icon:n.jsx(ht,{})}),n.jsx(lr,{children:s.createdByName||"Administrator"})]}):n.jsx(lr,{type:"secondary",children:"Information not available"})})]})]})]})},Ly=()=>{var p;const{message:e}=Zt.useApp(),{id:t}=Dr(),s=(p=Fn().state)==null?void 0:p.exhibitionId,i=tt(),a=lt(),{currentExhibition:o,loading:l,error:d}=qe(g=>g.exhibition),[c,h]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!s){e.error("Exhibition ID not found"),i("/exhibition");return}try{await a($r(s)).unwrap()}catch(x){e.error(x.message||"Failed to fetch exhibition"),i("/exhibition")}finally{h(!0)}})()},[s,a,e,i]),_.useEffect(()=>{d&&e.error(d)},[d,e]);const f=async g=>{var x,m;if(!(!s||!o))try{const[v,S]=g.dateRange,T={name:g.name,description:g.description,venue:g.venue,startDate:v.toISOString(),endDate:S.toISOString(),status:g.status,isActive:g.isActive,invoicePrefix:g.invoicePrefix,stallRates:g.stallRates||[],dimensions:o.dimensions,taxConfig:g.taxConfig||[],discountConfig:g.discountConfig||[],publicDiscountConfig:g.publicDiscountConfig||[],companyName:g.companyName,companyContactNo:g.companyContactNo,companyEmail:g.companyEmail,companyAddress:g.companyAddress,companyWebsite:g.companyWebsite,companyPAN:g.companyPAN,companyGST:g.companyGST,companySAC:g.companySAC,companyCIN:g.companyCIN,termsAndConditions:g.termsAndConditions,piInstructions:g.piInstructions,bankName:g.bankName,bankBranch:g.bankBranch,bankIFSC:g.bankIFSC,bankAccountName:g.bankAccountName,bankAccount:g.bankAccount,headerTitle:g.headerTitle,headerSubtitle:g.headerSubtitle,headerDescription:g.headerDescription,headerLogo:g.headerLogo,sponsorLogos:g.sponsorLogos||[],footerText:g.footerText,footerLogo:g.footerLogo,contactEmail:g.contactEmail,contactPhone:g.contactPhone,footerLinks:g.footerLinks||[],amenities:((x=g.amenities)==null?void 0:x.map(y=>({type:y.type,name:y.name,description:y.description,rate:y.rate})))||[],basicAmenities:((m=g.basicAmenities)==null?void 0:m.map(y=>({type:y.type,name:y.name,description:y.description,perSqm:y.perSqm,quantity:y.quantity})))||[],specialRequirements:g.specialRequirements};await a(ro({id:s,data:T})).unwrap(),e.success("Exhibition updated successfully"),i(Bt(o),{state:{exhibitionId:s}})}catch(v){e.error(v.message||"Failed to update exhibition")}};if(!c)return n.jsx(de,{loading:!0});if(!s)return n.jsx(Oo,{to:"/exhibition",replace:!0});if(l||!o)return n.jsx(de,{loading:!0});const u={name:o.name,description:o.description,venue:o.venue,dateRange:[nt(o.startDate),nt(o.endDate)],status:o.status,isActive:o.isActive,invoicePrefix:o.invoicePrefix,stallRates:o.stallRates||[],taxConfig:o.taxConfig||[],discountConfig:o.discountConfig||[],publicDiscountConfig:o.publicDiscountConfig||[],companyName:o.companyName,companyContactNo:o.companyContactNo,companyEmail:o.companyEmail,companyAddress:o.companyAddress,companyWebsite:o.companyWebsite,companyPAN:o.companyPAN,companyGST:o.companyGST,companySAC:o.companySAC,companyCIN:o.companyCIN,termsAndConditions:o.termsAndConditions,piInstructions:o.piInstructions,bankName:o.bankName,bankBranch:o.bankBranch,bankIFSC:o.bankIFSC,bankAccountName:o.bankAccountName,bankAccount:o.bankAccount,headerTitle:o.headerTitle,headerSubtitle:o.headerSubtitle,headerDescription:o.headerDescription,headerLogo:o.headerLogo,sponsorLogos:o.sponsorLogos||[],footerText:o.footerText,footerLogo:o.footerLogo,contactEmail:o.contactEmail,contactPhone:o.contactPhone,footerLinks:o.footerLinks||[],amenities:o.amenities||[],basicAmenities:o.basicAmenities||[],specialRequirements:o.specialRequirements};return n.jsx(de,{title:"Edit Exhibition",extra:n.jsx("a",{onClick:()=>i(Bt(o),{state:{exhibitionId:s}}),children:"Back to Details"}),children:n.jsx(gf,{initialValues:u,onSubmit:f,submitText:"Update Exhibition"})})},dh=({width:e,height:t,scale:r=1,position:s={x:0,y:0},isSelected:i=!1,onSelect:a=()=>{},onChange:o=()=>{},children:l,isEditable:d=!0})=>{const c=f=>{d&&(a(),f.cancelBubble=!0)},h=xt.useMemo(()=>{const f=[];for(let p=0;p<=e;p+=5)f.push(n.jsx(go,{points:[p,0,p,t],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`v${p}`));for(let p=0;p<=t;p+=5)f.push(n.jsx(go,{points:[0,p,e,p],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`h${p}`));return f},[e,t,r]);return n.jsxs(Gs,{x:s.x,y:s.y,width:e,height:t,onClick:c,children:[n.jsx(Bo,{width:e,height:t,fill:"#ffffff",stroke:i&&d?"#1890ff":"#d9d9d9",strokeWidth:i&&d?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/r,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/r}),n.jsx(Gs,{children:h}),n.jsx(Bi,{text:`${e}m  ${t}m`,fontSize:14/r,fill:"#666666",x:5,y:5}),l]})},Oy=({visible:e,width:t,height:r,onCancel:s,onSubmit:i})=>{const[a]=W.useForm();xt.useEffect(()=>{e&&a.setFieldsValue({width:t,height:r})},[e,t,r,a]);const o=()=>{a.validateFields().then(l=>{i(l),a.resetFields()})};return n.jsx(Ye,{title:"Edit Exhibition Space",open:e,onCancel:()=>{a.resetFields(),s()},onOk:o,destroyOnClose:!0,children:n.jsxs(W,{form:a,layout:"vertical",initialValues:{width:t,height:r},children:[n.jsx(W.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(jt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),n.jsx(W.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(jt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},yf=({hall:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isStallMode:d=!1})=>{const c=xt.useRef(null),h=xt.useRef(null),f=xt.useMemo(()=>{const v=[],{width:S,height:T}=e.dimensions,y=1;for(let w=0;w<=S;w+=y)v.push(n.jsx(go,{points:[w,0,w,T],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`v${w}`));for(let w=0;w<=T;w+=y)v.push(n.jsx(go,{points:[0,w,S,w],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`h${w}`));return v},[e.dimensions.width,e.dimensions.height,i]);xt.useEffect(()=>{var v;t&&h.current&&c.current&&(h.current.nodes([c.current]),(v=h.current.getLayer())==null||v.batchDraw())},[t]);const u=v=>{v.cancelBubble=!0;const S=v.target,T=S.x(),y=S.y(),w=Math.max(0,Math.min(T,o-e.dimensions.width)),k=Math.max(0,Math.min(y,l-e.dimensions.height));S.x(Math.round(w)),S.y(Math.round(k))},p=v=>{v.cancelBubble=!0;const S=v.target,T=Math.max(0,Math.min(S.x(),o-e.dimensions.width)),y=Math.max(0,Math.min(S.y(),l-e.dimensions.height));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{...e.dimensions,x:Math.round(T),y:Math.round(y)}})},g=v=>{v.cancelBubble=!0},x=v=>{if(!c.current)return;const S=c.current,T=S.scaleX(),y=S.scaleY();S.scaleX(1),S.scaleY(1);const w=Math.round(S.width()*T),k=Math.round(S.height()*y),b=S.x(),j=S.y(),A=Math.max(0,Math.min(b,o-w)),E=Math.max(0,Math.min(j,l-k));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{x:A,y:E,width:Math.max(5,Math.min(w,o-A)),height:Math.max(5,Math.min(k,l-E))}})},m=v=>{v.cancelBubble=!0,r==null||r(e)};return n.jsxs(Gs,{ref:c,x:e.dimensions.x,y:e.dimensions.y,width:e.dimensions.width,height:e.dimensions.height,draggable:!d&&!!s,onClick:m,onTap:m,onDragStart:g,onDragMove:u,onDragEnd:p,onTransformEnd:x,children:[n.jsx(Bo,{width:e.dimensions.width,height:e.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/i:1/i,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}),n.jsx(Gs,{children:f}),n.jsx(Bi,{text:e.name,fontSize:14/i,fill:"#000000",width:e.dimensions.width,align:"center",y:e.dimensions.height/2-7/i})]})},By=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},vf=({fixture:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isEditable:d=!0})=>{const c=xt.useRef(null),h=xt.useRef(null),[f,u]=_.useState("");_.useEffect(()=>{if(e.icon){const y=By(e.icon);u(y)}else u("")},[e.icon]);const[p]=gp(f);xt.useEffect(()=>{var y;t&&h.current&&c.current&&(h.current.nodes([c.current]),(y=h.current.getLayer())==null||y.batchDraw())},[t]);const g=y=>{y.cancelBubble=!0},x=y=>{y.cancelBubble=!0;const w=y.target,k=w.x(),b=w.y(),j=Math.max(0,Math.min(k,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height));w.x(Math.round(j)),w.y(Math.round(A))},m=y=>{y.cancelBubble=!0;const w=y.target,k=w.x(),b=w.y(),j=Math.max(0,Math.min(k,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height)),E=e._id||e.id;s==null||s({...e,_id:E,id:E,exhibitionId:e.exhibitionId,position:{x:Math.round(j),y:Math.round(A)}})},v=y=>{if(!c.current)return;const w=c.current,k=w.scaleX(),b=w.scaleY(),j=w.rotation();w.scaleX(1),w.scaleY(1);const A=Math.round(e.dimensions.width*k),E=Math.round(e.dimensions.height*b),C=w.x(),I=w.y(),F=Math.max(0,Math.min(C,o-A)),N=Math.max(0,Math.min(I,l-E)),U=e._id||e.id;s==null||s({...e,_id:U,id:U,exhibitionId:e.exhibitionId,position:{x:F,y:N},dimensions:{width:Math.max(.5,Math.min(A,o-F)),height:Math.max(.5,Math.min(E,l-N))},rotation:j})},S=y=>{y.cancelBubble=!0,r==null||r(e)},T=()=>{const y=e.borderColor||(t?"#1890ff":"#d9d9d9"),w=e.borderRadius!==void 0?e.borderRadius/i:3/i;return p?n.jsx(vp,{image:p,width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#ffffff",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}):n.jsx(Bo,{width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#f0f2f5",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5})};return n.jsxs(n.Fragment,{children:[n.jsxs(Gs,{ref:c,x:e.position.x,y:e.position.y,width:e.dimensions.width,height:e.dimensions.height,rotation:e.rotation||0,draggable:d&&!!s,onClick:S,onTap:S,onDragStart:g,onDragMove:x,onDragEnd:m,onTransformEnd:v,children:[T(),e.name&&e.showName!==!1&&n.jsx(Bi,{text:e.name,fontSize:12/i,fill:"#000000",width:e.dimensions.width,align:"center",y:-16/i})]}),t&&d&&n.jsx(yp,{ref:h,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(y,w)=>w.width<.5||w.height<.5?y:w})]})},My=({visible:e,x:t,y:r,onExhibitionClick:s,onHallClick:i,onStallClick:a,onFixtureClick:o,onClose:l})=>{if(!e)return null;const d=[{key:"exhibition",icon:n.jsx(xs,{}),label:"Exhibition Space",onClick:()=>{s(),l()}},{key:"hall",icon:n.jsx(ps,{}),label:"Add Hall",onClick:()=>{i(),l()}}];return a&&d.push({key:"stall",icon:n.jsx(wr,{}),label:"Add Stall",onClick:()=>{a(),l()}}),o&&d.push({key:"fixture",icon:n.jsx(Lo,{}),label:"Add Fixture",onClick:()=>{o(),l()}}),n.jsx("div",{style:{position:"fixed",top:r,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:n.jsx(hr,{items:d})})},$y=({stall:e,isSelected:t=!1,onSelect:r,onChange:s,hallWidth:i=0,hallHeight:a=0,hallX:o=0,hallY:l=0,scale:d=1,isDragging:c=!1})=>{const h=_.useRef(null),[f,u]=_.useState(!1),[p,g]=_.useState(!1),[x,m]=_.useState(!1);_.useEffect(()=>{m(window.innerWidth<768);const U=()=>{m(window.innerWidth<768)};return window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]),_.useEffect(()=>{if(f&&!c)g(!0);else if(c)g(!1);else{const U=setTimeout(()=>{g(!1)},100);return()=>clearTimeout(U)}},[f,c]),_.useEffect(()=>{if(f&&h.current&&!c){if(x&&!t)return;h.current.getStage()&&h.current.moveToTop()}},[f,t,x,c]);const v=t||e.isSelected,S=_.useCallback(U=>{switch(U){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),T=_.useCallback(U=>{switch(U){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),y=_.useCallback(U=>{U.cancelBubble=!0;const M=U.target,L=M.x()-o,z=M.y()-l,J=Math.max(0,Math.min(L,i-e.dimensions.width)),ne=Math.max(0,Math.min(z,a-e.dimensions.height));M.x(Math.round(J+o)),M.y(Math.round(ne+l))},[o,l,i,a,e.dimensions.width,e.dimensions.height]),w=_.useCallback(U=>{if(U.cancelBubble=!0,!s)return;const M=U.target,L=M.x()-o,z=M.y()-l,J=Math.max(0,Math.min(L,i-e.dimensions.width)),ne=Math.max(0,Math.min(z,a-e.dimensions.height));s({...e,id:e.id||e._id,_id:e._id||e.id,dimensions:{...e.dimensions,x:Math.round(J),y:Math.round(ne)}})},[s,o,l,i,a,e]),k=_.useCallback(U=>{U.cancelBubble=!0},[]),b=_.useCallback(U=>{U.cancelBubble=!0,r&&!c&&r()},[r,c]),j=_.useCallback(()=>{x&&!v||c||u(!0)},[x,v,c]),A=_.useCallback(()=>{u(!1)},[]),E={x:0,y:0,width:10,height:10},C=e.dimensions||E,I=e.typeName||"Standard";e.ratePerSqm*C.width*C.height;const F=0,N=_.useMemo(()=>e.status!=="available"&&e.companyName?`${I} - ${C.width}${C.height}m - ${e.companyName}`:`${I} - ${C.width}${C.height}m`,[I,C.width,C.height,e.status,e.companyName]);return n.jsxs(Gs,{ref:h,x:C.x+o,y:C.y+l,width:C.width,height:C.height,draggable:!!s,onClick:b,onTap:b,onDragStart:k,onDragMove:y,onDragEnd:w,opacity:e.status==="available"?1:.7,cursor:e.status==="available"?"pointer":"default",onMouseEnter:j,onMouseLeave:A,listening:c?!1:!x||e.status==="available",transformsEnabled:c||x?"position":"all",children:[n.jsx(Bo,{width:C.width,height:C.height,fill:v?"rgba(24, 144, 255, 0.1)":T(e.status),stroke:v?"#1890ff":S(e.status),strokeWidth:v?2/d:1/d,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:c?0:x?2:3,shadowOffset:{x:1,y:1},shadowOpacity:c?0:.3,rotation:F,perfectDrawEnabled:!c,transformsEnabled:c?"position":"all",cornerRadius:.05}),n.jsx(Bi,{text:e.number,fontSize:Math.min(C.width,C.height)*.25,fill:"#000000",width:C.width,height:C.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!c,fontStyle:"bold",listening:!1}),v&&!c&&n.jsx(bp,{x:C.width-2,y:2,radius:Math.min(.8,C.width*.05),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/d,transformsEnabled:"position",listening:!1}),p&&!c&&n.jsxs(wp,{x:C.width/2,y:0,opacity:1,listening:!1,children:[n.jsx(jp,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),n.jsx(Bi,{text:N,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(N.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},zc=_.memo($y),Zi=({width:e,height:t,exhibitionWidth:r=100,exhibitionHeight:s=100,halls:i=[],stalls:a=[],fixtures:o=[],selectedHall:l=null,selectedFixture:d=null,onSelectHall:c=()=>{},onSelectFixture:h=()=>{},onHallChange:f=()=>{},onFixtureChange:u=()=>{},onExhibitionChange:p=()=>{},onAddHall:g=()=>{},onAddStall:x=()=>{},onAddFixture:m=()=>{},children:v,isStallMode:S=!1,isFixtureMode:T=!1,isPublicView:y=!1})=>{const w=_.useRef(null),k=_.useRef(null),b=_.useRef(null),[j,A]=_.useState(1),[E,C]=_.useState({x:0,y:0}),[I,F]=_.useState(!1),[N,U]=_.useState(!1),[M,L]=_.useState({visible:!1,x:0,y:0}),[z,J]=_.useState(!1),[ne,te]=_.useState(!1),[P,H]=_.useState(!1),[B,R]=_.useState(void 0);_.useEffect(()=>{const Pe=()=>{H(window.innerWidth<768)};return Pe(),window.addEventListener("resize",Pe),()=>{window.removeEventListener("resize",Pe)}},[]);const K=_.useCallback(Pe=>{if(Pe.evt.preventDefault(),!w.current)return;const ze=w.current,Xe=j,$e=ze.getPointerPosition(),Be={x:($e.x-ze.x())/Xe,y:($e.y-ze.y())/Xe},at=1.15,Tt=Pe.evt.deltaY<0?Xe*at:Xe/at,Tr=Math.min(Math.max(.1,Tt),20),Pn={x:$e.x-Be.x*Tr,y:$e.y-Be.y*Tr};A(Tr),C(Pn)},[j]),se=_.useCallback(()=>{if(!w.current)return;const Pe=w.current,ze=Math.min(j*1.15,20),Xe=Pe.width()/2,$e=Pe.height()/2,Be={x:(Xe-E.x)/j,y:($e-E.y)/j},at={x:Xe-Be.x*ze,y:$e-Be.y*ze};A(ze),C(at)},[j,E]),we=_.useCallback(()=>{if(!w.current)return;const Pe=w.current,ze=Math.max(j/1.15,.1),Xe=Pe.width()/2,$e=Pe.height()/2,Be={x:(Xe-E.x)/j,y:($e-E.y)/j},at={x:Xe-Be.x*ze,y:$e-Be.y*ze};A(ze),C(at)},[j,E]),ye=_.useCallback(Pe=>{Pe?(R(al.pixelRatio),al.pixelRatio=P?.8:1):B&&(al.pixelRatio=B)},[B,P]),X=_.useCallback(Pe=>{if(Pe.target===w.current&&(L({...M,visible:!1}),U(!0),ye(!0),k.current)){if(y){const ze=P?{x:-10,y:-10,width:e+20,height:t+20}:void 0;k.current.cache(ze)}if(k.current.hitGraphEnabled(!1),y&&w.current){const ze=w.current.container();ze.style.cursor="grabbing",ze.classList.add("dragging"),w.current.batchDraw(),k.current.getChildren().forEach($e=>{if($e.shadowForStrokeEnabled&&($e._savedShadowForStroke=$e.shadowForStrokeEnabled(),$e.shadowForStrokeEnabled(!1)),$e.perfectDrawEnabled&&($e._savedPerfectDraw=$e.perfectDrawEnabled(),$e.perfectDrawEnabled(!1)),$e.cache&&!$e.isCached&&$e.width&&$e.height){$e._dragCached=!0;try{P?$e.cache({offset:10,pixelRatio:.8}):$e.cache()}catch{$e._dragCached=!1}}})}}},[M,y,ye,P,e,t]),ee=_.useCallback(Pe=>{if(y&&Pe.target===w.current){if(Pe.evt&&Pe.evt._dragSkipUpdate)return;if(Pe.evt&&(Pe.evt._dragSkipUpdate=!0),w.current&&k.current){const ze=P?.85:.7;Math.random()>ze&&w.current.batchDraw()}return}Pe.target===w.current&&P&&k.current&&(Pe.cancelBubble=!0)},[P,y]),ce=_.useCallback(Pe=>{if(Pe.target===w.current){if(C({x:Pe.target.x(),y:Pe.target.y()}),ye(!1),k.current&&(k.current.hitGraphEnabled(!0),y&&k.current.clearCache(),y&&w.current)){const ze=w.current.container();ze.style.cursor="",ze.classList.remove("dragging"),k.current.getChildren().forEach($e=>{$e._savedShadowForStroke!==void 0&&($e.shadowForStrokeEnabled($e._savedShadowForStroke),delete $e._savedShadowForStroke),$e._savedPerfectDraw!==void 0&&($e.perfectDrawEnabled($e._savedPerfectDraw),delete $e._savedPerfectDraw),$e._dragCached&&($e.clearCache(),delete $e._dragCached)})}setTimeout(()=>{w.current&&w.current.batchDraw()},50),U(!1)}},[y,ye]),xe=_.useCallback(()=>{F(!0),document.body.style.cursor=N?"grabbing":"grab"},[N]),Z=_.useCallback(()=>{F(!1),document.body.style.cursor="default"},[]),ge=Pe=>{var Xe,$e,Be;const ze=Pe.target.getClassName();if(ze==="Stage"||ze==="Layer"){L({...M,visible:!1});return}if(ze==="Group"||ze==="Rect"){c(null),h(null);const at=(Xe=w.current)==null?void 0:Xe.getPointerPosition();if(at&&be(at)){const{x:Tt,y:Tr}=at,{x:Pn,y:aa}=(($e=w.current)==null?void 0:$e.position())||{x:0,y:0},{x:oa,y:la}=((Be=w.current)==null?void 0:Be.scale())||{x:1,y:1},tl=(Tt-Pn)/oa,rl=(Tr-aa)/la;L({x:tl,y:rl,visible:!0})}else L({...M,visible:!1})}else L({...M,visible:!1})},be=Pe=>{if(!r||!s||!w.current)return!1;const{x:ze,y:Xe}=Pe,{x:$e,y:Be}=w.current.position(),{x:at}=w.current.scale(),Tt={x:(ze-$e)/at,y:(Xe-Be)/at};return Tt.x>=0&&Tt.x<=r&&Tt.y>=0&&Tt.y<=s},ve=_.useCallback(()=>{c(null),h(null),J(!0),te(!0),L({...M,visible:!1})},[c,h,M]),Fe=_.useCallback(Pe=>{p(Pe),te(!1)},[p]),pe=()=>{J(!0),te(!0),L({...M,visible:!1})},Ue=()=>{g(),L({...M,visible:!1})},We=()=>{x(),L({...M,visible:!1})};_.useEffect(()=>{if(e>0&&t>0&&r>0&&s>0){const Pe=S?20:40,ze=e-Pe*2,Xe=t-Pe*2,$e=ze/r,Be=Xe/s,Tt=Math.min($e,Be),Tr=(e-r*Tt)/2,Pn=(t-s*Tt)/2;A(Tt),C({x:Tr,y:Pn}),w.current&&w.current.batchDraw()}},[e,t,r,s,S]);const gt=xt.Children.map(v,Pe=>xt.isValidElement(Pe)?xt.cloneElement(Pe,{scale:j,position:E}):Pe),dt=n.jsx(dh,{width:r,height:s,scale:j,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return e<=0||t<=0||r<=0||s<=0?n.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:I?N?"grabbing":"grab":"default"},children:[n.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:n.jsxs(ue,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[n.jsx(re,{icon:n.jsx(Ix,{}),onClick:we,disabled:j<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),n.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(j*100),"%"]}),n.jsx(re,{icon:n.jsx(Nx,{}),onClick:se,disabled:j>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),n.jsxs(Sp,{ref:w,width:e,height:t,onClick:ge,draggable:!0,onDragStart:X,onDragMove:ee,onDragEnd:ce,onMouseEnter:xe,onMouseLeave:Z,onWheel:K,x:E.x,y:E.y,scaleX:j,scaleY:j,perfectDrawEnabled:!N&&!y,hitGraphEnabled:!N,pixelRatio:N?P?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:y?P?5:3:0,children:[y&&n.jsx(Ep,{ref:b,listening:!1,children:dt}),n.jsxs(Tp,{ref:k,imageSmoothingEnabled:!N||!y,children:[!y&&n.jsx(dh,{width:r,height:s,scale:j,position:{x:0,y:0},isSelected:z,onSelect:T?void 0:ve,onChange:S||T?void 0:p,isEditable:!S&&!T}),i.map(Pe=>n.jsx(yf,{hall:Pe,isSelected:(l==null?void 0:l.id)===Pe.id,onSelect:()=>c(Pe),onChange:S||T?void 0:f,scale:j,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isStallMode:S||T},Pe._id||Pe.id)),a.map(Pe=>{const ze=Pe._id||Pe.id,Xe=i.find($e=>$e.id===Pe.hallId||$e._id===Pe.hallId);return Xe?n.jsx(zc,{stall:{...Pe,_id:ze,id:ze},hallX:Xe.dimensions.x,hallY:Xe.dimensions.y,hallWidth:Xe.dimensions.width,hallHeight:Xe.dimensions.height,scale:j,isDragging:N&&y},ze):null}),o.map(Pe=>{const ze=Pe._id||Pe.id,$e=((d==null?void 0:d._id)||(d==null?void 0:d.id))===ze;return n.jsx(vf,{fixture:{...Pe,_id:ze,id:ze},isSelected:$e,onSelect:()=>h(Pe),onChange:T?u:void 0,scale:j,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isEditable:T},ze)}),gt]})]}),n.jsx(My,{visible:M.visible,x:M.x,y:M.y,onExhibitionClick:pe,onHallClick:Ue,onStallClick:We,onClose:()=>L({...M,visible:!1})}),n.jsx(Oy,{visible:ne,width:r,height:s,onCancel:()=>te(!1),onSubmit:Fe})]})},Uy=({visible:e,hall:t,exhibitionWidth:r,exhibitionHeight:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=W.useForm();xt.useEffect(()=>{e&&(t?l.setFieldsValue({name:t.name,width:t.dimensions.width,height:t.dimensions.height}):l.setFieldsValue({name:"",width:Math.min(10,r),height:Math.min(10,s)}))},[e,t,r,s,l]);const d=async()=>{var u,p;const h=await l.validateFields(),f=t?{...t,_id:t._id,id:t.id||t._id,name:h.name,dimensions:{x:((u=t.dimensions)==null?void 0:u.x)||0,y:((p=t.dimensions)==null?void 0:p.y)||0,width:h.width,height:h.height},exhibitionId:t.exhibitionId}:{name:h.name,dimensions:{x:0,y:0,width:h.width,height:h.height}};a(f),l.resetFields()},c=()=>{t&&o&&Ye.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${t.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>o(t)})};return n.jsx(Ye,{title:t?"Edit Hall":"Add New Hall",open:e,onCancel:()=>{l.resetFields(),i()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:n.jsxs(W,{form:l,layout:"vertical",style:{marginTop:"16px"},children:[n.jsx(W.Item,{name:"name",label:n.jsxs("span",{style:{color:"#000"},children:["Hall Name ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:n.jsx(he,{placeholder:"Enter hall name"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[n.jsx(W.Item,{name:"width",label:n.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:r,message:`Width cannot exceed ${r} meters`}],children:n.jsx(jt,{min:5,max:r,style:{width:"100%"},placeholder:"Enter width"})}),n.jsx(W.Item,{name:"height",label:n.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:s,message:`Height cannot exceed ${s} meters`}],children:n.jsx(jt,{min:5,max:s,style:{width:"100%"},placeholder:"Enter height"})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[n.jsx(ue,{children:t&&o&&n.jsx(re,{className:"delete-button",icon:n.jsx(sr,{}),onClick:c,children:"Delete Hall"})}),n.jsxs(ue,{children:[n.jsx(re,{onClick:()=>{l.resetFields(),i()},children:"Cancel"}),n.jsx(re,{type:"primary",onClick:d,className:"update-button",children:t?"Update Hall":"Create Hall"})]})]})]})})},{Title:zy}=Me,qy=({visible:e,stall:t,hall:r,exhibition:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=W.useForm(),[d,c]=_.useState([]),[h,f]=_.useState(!1),u=(v,S,T,y,w)=>{const b=[...T].sort((A,E)=>{const C=Math.floor(A.dimensions.y/5),I=Math.floor(E.dimensions.y/5);return C===I?A.dimensions.x-E.dimensions.x:A.dimensions.y-E.dimensions.y}),j=(A,E)=>A+v>y||E+S>w?!1:!b.some(C=>{const I=C.dimensions.x,F=C.dimensions.y,N=C.dimensions.width,U=C.dimensions.height,M=1;return!(A+v+M<=I||A>=I+N+M||E+S+M<=F||E>=F+U+M)});for(const A of b){const E=A.dimensions.x+A.dimensions.width+1,C=A.dimensions.y;if(j(E,C))return{x:E,y:C};const I=A.dimensions.x,F=A.dimensions.y+A.dimensions.height+1;if(j(I,F))return{x:I,y:F}}for(let A=0;A<w;A+=5)for(let E=0;E<y;E+=5)if(j(E,A))return{x:E,y:A};return{x:0,y:0}};_.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const v={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",v),l.setFieldsValue(v)}else r&&!l.getFieldValue("status")&&l.setFieldsValue({status:"available",width:Math.min(20,r.dimensions.width/4),height:Math.min(20,r.dimensions.height/4),ratePerSqm:0})},[t,r,l]),_.useEffect(()=>{e&&(async()=>{var S;try{f(!0);const T=await ss.getStallTypes();console.log("Fetched stall types:",T.data);const y=((S=s.stallRates)==null?void 0:S.map(k=>k.stallTypeId))||[];console.log("Configured stall type IDs:",y);const w=T.data.filter(k=>k.status==="active"&&k._id&&y.includes(k._id));console.log("Filtered stall types:",w),c(w)}catch(T){console.error("Failed to fetch stall types:",T)}finally{f(!1)}})()},[e,s.stallRates]);const p=v=>{var T;console.log("Stall type changed to:",v);const S=(T=s.stallRates)==null?void 0:T.find(y=>y.stallTypeId===v);console.log("Found stall rate:",S),S&&l.setFieldsValue({ratePerSqm:S.rate})},g=()=>{l.resetFields(),i()},x=()=>{if(console.log("Hall data:",r),!r||!r._id&&!r.id){Se.error("Invalid hall selected. Please try again.");return}l.validateFields().then(v=>{var w;const S=r._id||r.id;if(!S){Se.error("Hall ID is missing. Please select a hall again.");return}const T=t?{x:t.dimensions.x,y:t.dimensions.y}:u(v.width,v.height,((w=s.stalls)==null?void 0:w.filter(k=>k.hallId===S))||[],r.dimensions.width,r.dimensions.height),y={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:v.number,stallTypeId:v.stallTypeId,dimensions:{x:T.x,y:T.y,width:v.width,height:v.height},ratePerSqm:v.ratePerSqm,status:v.status,hallId:S};console.log("Submitting stall data:",y),a(y)})},m=v=>{switch(v){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return n.jsx(n.Fragment,{children:n.jsx(Ye,{title:n.jsxs(ue,{children:[n.jsx(wr,{style:{fontSize:"20px"}}),n.jsx(zy,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:e,onCancel:g,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[n.jsxs(ue,{size:"middle",children:[t&&o&&n.jsx(re,{danger:!0,icon:n.jsx(sr,{}),onClick:()=>o(t),children:"Delete"}),n.jsx(re,{onClick:g,children:"Cancel"}),n.jsx(re,{type:"primary",onClick:x,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:n.jsxs(W,{form:l,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[n.jsx(W.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:n.jsx(he,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),n.jsx(W.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Le,{loading:h,placeholder:"Select stall type",size:"large",onChange:p,children:d.map(v=>n.jsx(Le.Option,{value:v._id,children:v.name},v._id))})}),n.jsx(it,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),n.jsxs(ue,{style:{width:"100%",gap:"16px"},children:[n.jsx(W.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:n.jsx(jt,{min:1,max:(r==null?void 0:r.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),n.jsx(W.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:n.jsx(jt,{min:1,max:(r==null?void 0:r.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),n.jsx(it,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),n.jsx(W.Item,{name:"ratePerSqm",label:"Rate per sq.m ()",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:n.jsx(jt,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"",disabled:!0,formatter:v=>`${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>{const S=v?Number(v.replace(/\\s?|(,*)/g,"")):0;return isNaN(S)?0:S}})}),n.jsx(W.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Le,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[n.jsx(Le.Option,{value:"available",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("available")}}),"Available"]})}),n.jsx(Le.Option,{value:"booked",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("booked")}}),"Booked"]})}),n.jsx(Le.Option,{value:"reserved",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("reserved")}}),"Reserved"]})})]})})]})})})},hh=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},Wy=({name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIcons:o,borderColor:l=null,borderRadius:d=0})=>{_.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIconAvailable:!!o[t],borderColor:l,borderRadius:d})},[e,t,r,s,i,a,o,l,d]);const c=o[t]||"";return n.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[n.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${d||4}px`,backgroundColor:r||"#f0f0f0",transform:`rotate(${s}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:l?`1px solid ${l}`:"1px solid rgba(0,0,0,0.05)"},children:a?n.jsx("img",{src:a,alt:e,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):n.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:c})}),i&&n.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:e}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[n.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),n.jsx("span",{children:""}),n.jsx("span",{children:r}),s>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:[s,""]})]}),l&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:["Border: ",l]})]}),d>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsxs("span",{children:["Radius: ",d,"px"]})]})]})]})},{Text:Hy}=Me,Cl=({activeKey:e,form:t,fixture:r,exhibitionWidth:s,exhibitionHeight:i,selectedType:a,showName:o,iconFileList:l,fixtureTypes:d,fixtureIcons:c,defaultColors:h,defaultDimensions:f,colorPresets:u,uploadProps:p,iconPreviewVisible:g=!1,previewImage:x="",onTypeChange:m,onColorChange:v,onShowNameChange:S,onIconPreviewCancel:T=()=>{}})=>{switch(e){case"basic":return y();case"position":return w();case"appearance":return k();default:return y()}function y(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(W.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:n.jsx(he,{placeholder:"Enter fixture name",prefix:n.jsx(Gt,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(W.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:n.jsx(Rr,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:b=>{S(b),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),n.jsx(W.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:n.jsx(Le,{placeholder:"Select fixture type",onChange:m,options:d.map(b=>({...b,label:n.jsxs(ue,{children:[n.jsx("span",{style:{fontSize:16},children:c[b.value]}),n.jsx("span",{children:b.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function w(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(de,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:n.jsx(jt,{style:{width:"100%",borderRadius:"8px"},min:0,max:s,step:.1,precision:1,placeholder:"X position"})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:n.jsx(jt,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"Y position"})})})]})}),n.jsx(de,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:n.jsx(jt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:n.jsx(jt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),n.jsx(de,{size:"small",title:n.jsxs("span",{children:[n.jsx(Fx,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsx(W.Item,{name:"rotation",noStyle:!0,children:n.jsx(Su,{min:0,max:360,marks:{0:"0",90:"90",180:"180",270:"270",360:"360"},tooltip:{formatter:b=>`${b}`},style:{marginTop:10},keyboard:!1})})})]})}function k(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(W.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(b,j)=>{try{return j?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:n.jsx(md,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,onChange:v,style:{width:"100%"}})}),n.jsx(W.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:n.jsx(md,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,style:{width:"100%"}})}),n.jsx(W.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:n.jsx(jt,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),n.jsxs(de,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[n.jsx("div",{style:{marginBottom:0},children:n.jsx(Pi,{...p,children:l.length<1&&n.jsxs("div",{children:[n.jsx(Rx,{style:{fontSize:20}}),n.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),n.jsx(Hy,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),n.jsx(W.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:n.jsx(he,{placeholder:"https://example.com/icon.png",prefix:n.jsx(Px,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(Ye,{open:g,title:"Icon Preview",footer:null,onCancel:T,children:n.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:x})})]})}},Vy=e=>[{key:"basic",label:n.jsxs("span",{children:[n.jsx(ps,{}),"Basic Info"]}),children:n.jsx(Cl,{...e,activeKey:"basic"})},{key:"position",label:n.jsxs("span",{children:[n.jsx(os,{}),"Position"]}),children:n.jsx(Cl,{...e,activeKey:"position"})},{key:"appearance",label:n.jsxs("span",{children:[n.jsx(Di,{}),"Appearance"]}),children:n.jsx(Cl,{...e,activeKey:"appearance"})}],{Text:lk,Title:ck}=Me,{TabPane:dk}=Jt,Gy=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],Sa={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},Ln={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},Al={sofa:"",chair:"",table:"",desk:"",plant:"",entrance:"",exit:"",info:"",restroom:"",food:"",custom:""},Yy=({visible:e,fixture:t,onCancel:r,onSubmit:s,onDelete:i,exhibitionWidth:a,exhibitionHeight:o})=>{const[l]=W.useForm(),[d,c]=_.useState(!1),[h,f]=_.useState(""),[u,p]=_.useState("basic"),[g,x]=_.useState(""),[m,v]=_.useState([]),[S,T]=_.useState(!1),[y,w]=_.useState(""),{message:k}=Zt.useApp(),[b,j]=_.useState("#f0f0f0"),[A,E]=_.useState("New Fixture"),[C,I]=_.useState("chair"),[F,N]=_.useState(0),[U,M]=_.useState(!0),[L,z]=_.useState(null),[J,ne]=_.useState(0);_.useEffect(()=>{if(e)if(t){const Z=se(t.color),ge=Ln[t.type]||"#f0f0f0",be=Z||ge;console.log("Setting up fixture colors:",{original:t.color,normalized:Z,fallback:ge,final:be}),j(be),E(t.name),I(t.type),N(t.rotation||0),f(t.type),M(t.showName!==!1),z(t.borderColor||null),ne(t.borderRadius||0)}else{const Z="chair",ge=Ln[Z];j(ge),E("New Fixture"),I(Z),N(0),f(Z),M(!0),z(null),ne(0)}},[e,t]),_.useEffect(()=>{if(e&&l){if(t){const Z=se(t.color),ge=Ln[t.type]||"#f0f0f0",be=Z||ge;l.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:be,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const ve=t.icon?hh(t.icon):"";x(ve),t.icon?v([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:ve,thumbUrl:ve}]):v([])}else{const Z="chair",ge=Ln[Z];l.setFieldsValue({name:"New Fixture",type:Z,position:{x:Math.floor(a/2),y:Math.floor(o/2)},dimensions:Sa[Z],rotation:0,color:ge,icon:"",showName:!0,borderColor:null,borderRadius:0}),x(""),v([])}p("basic")}},[e,t,l,a,o]);const te=()=>{if(l&&e)try{const Z=l.getFieldsValue(!0);if(Z.name&&E(Z.name),Z.type&&I(Z.type),Z.rotation!==void 0&&N(Z.rotation),Z.color){const ge=se(Z.color);ge&&j(ge)}if(Z.showName!==void 0&&M(Z.showName),Z.borderColor!==void 0){const ge=Z.borderColor?se(Z.borderColor):null;z(ge)}Z.borderRadius!==void 0&&ne(Z.borderRadius)}catch(Z){console.log("Error updating preview",Z)}};_.useEffect(()=>{if(l&&e)return l.getFieldsValue,te(),()=>{}},[l,e]);const P=Z=>{if(f(Z),I(Z),!t){const ge=Ln[Z]||Ln.custom;l.setFieldsValue({dimensions:Sa[Z]||Sa.custom,color:ge}),j(ge)}},H=Z=>{const ge=se(Z);l.setFieldValue("color",ge),j(ge);const be=Object.entries(Ln).find(([ve,Fe])=>Fe.toLowerCase()===ge.toLowerCase());be&&!t&&(l.setFieldValue("type",be[0]),f(be[0]),I(be[0]))},B=()=>(console.log("Rendering fixture preview with:",{name:A,type:C,color:b,rotation:F,showName:U,iconUrl:g,borderColor:L,borderRadius:J}),n.jsx(Wy,{name:A,type:C,color:b,rotation:F,showName:U,iconUrl:g,defaultIcons:Al,borderColor:L,borderRadius:J})),R=({file:Z,fileList:ge})=>{var be;if(Z.status==="uploading"&&v(ge),Z.status==="done"){k.success(`${Z.name} uploaded successfully`);let Fe=(((be=Z.response)==null?void 0:be.url)||"").replace(/^\/api\/uploads\//,"");Fe&&!Fe.startsWith("fixtures/")&&(Fe=`fixtures/${Fe.replace(/^\//,"")}`),console.log("Icon path stored in form:",Fe),l.setFieldValue("icon",Fe);const pe=hh(Fe);console.log("Using direct backend URL:",pe),x(pe);const Ue=Z.name.toLowerCase().endsWith(".svg"),We=ge.map(gt=>gt.uid===Z.uid?{...gt,url:pe,thumbUrl:pe,type:Ue?"image/svg+xml":gt.type}:gt);v(We),console.log("Form values after icon upload:",l.getFieldsValue(!0))}Z.status==="error"&&(k.error(`${Z.name} upload failed.`),v(ge.filter(ve=>ve.uid!==Z.uid)))},K={name:"file",action:`${ke.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:m,onChange:R,onPreview:Z=>{w(Z.url||Z.thumbUrl||""),T(!0)},onRemove:()=>(x(""),v([]),l.setFieldValue("icon",""),console.log("Form values after icon removal:",l.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:n.jsx(sr,{style:{color:"#ff4d4f"}})}},se=Z=>{try{if(!Z)return"#f0f0f0";if(typeof Z=="object"&&Z!==null){if(typeof Z.toHexString=="function")return Z.toHexString();if(Z.rgb||Z.hex)return Z.hex||`rgb(${Z.rgb.r},${Z.rgb.g},${Z.rgb.b})`}if(typeof Z=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(Z))return Z;if(/^([0-9A-F]{3}){1,2}$/i.test(Z))return`#${Z}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(Z))return Z}return"#f0f0f0"}catch(ge){return console.error("Error normalizing color:",ge),"#f0f0f0"}},we=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],ye=xt.useCallback(()=>{t&&i&&i(t)},[t,i]),X=Z=>{p(Z),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},ee=Vy({form:l,fixture:t,exhibitionWidth:a,exhibitionHeight:o,selectedType:h,showName:U,iconFileList:m,fixtureTypes:Gy,fixtureIcons:Al,defaultColors:Ln,defaultDimensions:Sa,colorPresets:we,uploadProps:K,iconPreviewVisible:S,previewImage:y,onTypeChange:P,onColorChange:H,onShowNameChange:Z=>M(Z),onIconPreviewCancel:()=>T(!1),activeKey:u}),ce=async()=>{try{c(!0);const Z=await l.validateFields();E(Z.name),I(Z.type),N(Z.rotation||0),j(se(Z.color)),M(Z.showName),z(Z.borderColor?se(Z.borderColor):null),ne(Z.borderRadius||0);let ge="";Z.icon?ge=xe(Z.icon):t!=null&&t.icon&&(ge=t.icon),console.log("Form values being submitted:",{name:Z.name,type:Z.type,color:Z.color,icon:Z.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:ge,showName:Z.showName,borderColor:Z.borderColor,borderRadius:Z.borderRadius});const be=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",ve=Z.color?se(Z.color):(t==null?void 0:t.color)||"#f0f0f0",Fe=Z.borderColor?se(Z.borderColor):null,pe={...t,id:be,_id:be,name:Z.name,type:Z.type,position:Z.position,dimensions:Z.dimensions,rotation:Z.rotation,color:ve,icon:ge,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:Fe,borderRadius:Z.borderRadius||0};be&&(pe.showName=Z.showName),console.log("Submitting fixture with icon path:",ge),console.log("Color being submitted:",ve),await s(pe),r()}catch(Z){console.error("Fixture submission failed:",Z),k.error("Failed to save fixture. Please check the form and try again.")}finally{c(!1)}},xe=Z=>{if(!Z||typeof Z!="string")return"";if(Z.startsWith("fixtures/")&&!Z.includes("?")&&!Z.includes("http"))return Z;let ge=Z.replace(/^\/api\/uploads\//,"");if(ge=ge.replace(/^\//,""),ge.includes("?")||ge.includes("http")){const be=ge.split("?")[0].split("/").pop()||"";if(be)return`fixtures/${be}`}return ge&&!ge.startsWith("fixtures/")?`fixtures/${ge}`:ge};return n.jsxs(Ye,{title:n.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[n.jsx("span",{style:{fontSize:24,marginRight:8},children:t?Al[t.type]:""}),n.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:e,onCancel:r,confirmLoading:d,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx("div",{children:t&&i&&n.jsx(re,{danger:!0,icon:n.jsx(sr,{}),onClick:ye,style:{borderRadius:"6px"},children:"Delete"})}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx(re,{onClick:r,icon:n.jsx(Dx,{}),style:{borderRadius:"6px"},children:"Cancel"}),n.jsx(re,{type:"primary",onClick:ce,icon:n.jsx(fs,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),B(),n.jsx(W,{form:l,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:te,children:n.jsx(Jt,{activeKey:u,onChange:X,items:ee,tabBarStyle:{marginBottom:16},centered:!0})})]})},Ky=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=tt(),{currentExhibition:i}=qe(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>s(Bt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Xy=()=>{var g;const{id:e}=Dr(),t=Fn(),r=tt(),s=lt(),i=((g=t.state)==null?void 0:g.exhibitionId)||e,{currentExhibition:a}=qe(x=>x.exhibition),o=_.useRef(null),[l,d]=_.useState({width:100,height:100}),[c,h]=_.useState({width:0,height:0}),[f]=W.useForm();_.useEffect(()=>{if(!i){Se.error("Exhibition ID not found"),r("/exhibition");return}s($r(i))},[i,s,r]),_.useEffect(()=>{a!=null&&a.dimensions&&(d(a.dimensions),f.setFieldsValue(a.dimensions))},[a,f]),_.useEffect(()=>{const x=()=>{o.current&&h({width:o.current.clientWidth,height:o.current.clientHeight})};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const u=async()=>{try{const x=await f.validateFields();await wt.updateExhibition(i,{dimensions:x}),Se.success("Exhibition space saved successfully"),await s($r(i)).unwrap(),r(Bt(a,"layout"),{state:{exhibitionId:i}})}catch{Se.error("Failed to save exhibition space")}},p=x=>{d(m=>({...m,...x})),f.setFieldsValue(x)};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Ky,{exhibitionId:i}),n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("span",{children:"Exhibition Space Setup"}),n.jsx(re,{type:"primary",icon:n.jsx(fs,{}),onClick:u,children:"Save and Continue"})]}),children:n.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[n.jsx("div",{style:{flex:"0 0 300px"},children:n.jsxs(W,{form:f,layout:"vertical",initialValues:l,children:[n.jsx(W.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(jt,{min:10,max:1e3,style:{width:"100%"},onChange:x=>p({width:x||10})})}),n.jsx(W.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(jt,{min:10,max:1e3,style:{width:"100%"},onChange:x=>p({height:x||10})})})]})}),n.jsx("div",{ref:o,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:n.jsx(Ji,{children:n.jsx(Zi,{width:c.width,height:c.height,exhibitionWidth:l.width,exhibitionHeight:l.height,onExhibitionChange:p})})})]})})]})},Qy=({exhibitionId:e})=>{const t=tt(),{currentExhibition:r}=qe(s=>s.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>t(Bt(r),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Jy=()=>{var l,d,c,h,f;const{id:e}=Dr(),t=Fn(),r=tt(),s=lt(),i=((l=t.state)==null?void 0:l.exhibitionId)||e,{currentExhibition:a,halls:o}=qe(u=>u.exhibition);return _.useEffect(()=>{i&&(s($r(i)),s(un(i)))},[i,s]),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Qy,{exhibitionId:i}),n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(xs,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),n.jsx(re,{type:"primary",onClick:()=>r(Bt(a,"space"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(ps,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),n.jsx(re,{type:"primary",disabled:!((d=a==null?void 0:a.dimensions)!=null&&d.width)||!((c=a==null?void 0:a.dimensions)!=null&&c.height),onClick:()=>r(Bt(a,"halls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(wr,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),n.jsx(re,{type:"primary",disabled:!o.length,onClick:()=>r(Bt(a,"stalls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(Q,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(Lo,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),n.jsx(re,{type:"primary",disabled:!((h=a==null?void 0:a.dimensions)!=null&&h.width)||!((f=a==null?void 0:a.dimensions)!=null&&f.height),onClick:()=>r(Bt(a,"fixtures"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},Zy=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=tt(),{currentExhibition:i}=qe(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>s(Bt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ev=()=>{var w,k,b;const{id:e}=Dr(),t=Fn(),r=tt(),s=lt(),i=((w=t.state)==null?void 0:w.exhibitionId)||e,{currentExhibition:a,halls:o}=qe(j=>j.exhibition),l=_.useRef(null),[d,c]=Se.useMessage(),[h,f]=_.useState(!1),[u,p]=_.useState(null),[g,x]=_.useState({width:0,height:0});_.useEffect(()=>{const j=()=>{if(l.current){const{clientWidth:E,clientHeight:C}=l.current;x({width:Math.max(E||400,400),height:Math.max(C||400,400)})}};j();const A=new ResizeObserver(j);return l.current&&A.observe(l.current),window.addEventListener("resize",j),()=>{A.disconnect(),window.removeEventListener("resize",j)}},[]),_.useEffect(()=>{if(!i){d.error("Exhibition ID not found"),r("/exhibition");return}s($r(i))},[i,s,r,d]),_.useEffect(()=>{var j,A;if(a){if(!((j=a.dimensions)!=null&&j.width)||!((A=a.dimensions)!=null&&A.height)){d.info("Please set up exhibition space first"),r(Bt(a,"space"),{state:{exhibitionId:i}});return}s(un(i))}},[a,i,s,r,d]);const m=()=>{p(null),f(!0)},v=j=>{p(j),f(!!j)},S=async j=>{var A;try{j.id?(await wt.updateHall(i,j.id,j),d.success("Hall updated successfully"),f(!1)):(await wt.createHall(i,j),d.success("Hall created successfully"),f(!1)),s(un(i))}catch(E){console.error("Hall operation failed:",E),((A=E.response)==null?void 0:A.status)===409?d.warning({content:E.response.data.message,duration:6,style:{marginTop:"20vh"}}):(d.error(E.message||"Failed to save hall"),f(!1))}},T=async j=>{var A,E;try{const C=j._id||j.id;if(!C)throw new Error("Hall ID is required");await wt.deleteHall(i,C),d.success("Hall deleted successfully"),f(!1),p(null),s(un(i))}catch(C){console.error("Failed to delete hall:",C),d.error(((E=(A=C.response)==null?void 0:A.data)==null?void 0:E.message)||"Failed to delete hall")}},y=async()=>{try{await wt.saveLayout(i,o),d.success("Layout saved successfully")}catch{d.error("Failed to save layout")}};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(Zy,{exhibitionId:i}),c,n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(ue,{children:[n.jsx("span",{children:"Hall Management"}),n.jsx(re,{icon:n.jsx(Eu,{}),onClick:()=>r(Bt(a,"space"),{state:{exhibitionId:i}}),children:"Back to Space Setup"})]}),n.jsxs(ue,{children:[n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),onClick:m,children:"Add Hall"}),n.jsx(re,{type:"primary",icon:n.jsx(fs,{}),onClick:y,disabled:!o.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:n.jsx("div",{ref:l,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Ji,{children:g.width>0&&g.height>0&&(a==null?void 0:a.dimensions)&&n.jsx(Zi,{width:g.width,height:g.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:o,selectedHall:u,onSelectHall:v,onHallChange:S,onAddHall:m})})})}),n.jsx(Uy,{visible:h,hall:u,onCancel:()=>f(!1),onSubmit:S,onDelete:T,exhibitionWidth:((k=a==null?void 0:a.dimensions)==null?void 0:k.width)||100,exhibitionHeight:((b=a==null?void 0:a.dimensions)==null?void 0:b.height)||100})]})},tv=Ee(Ye)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,rv=Ee.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Ei=Ee.div`
  padding: 24px 32px 32px;
`,nv=Ee.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,sv=Ee.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;Ee.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;Ee.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;Ee.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;Ee.div`
  border: 1px solid ${e=>e.selected?"#4b47b9":"#e6e6f0"};
  background: ${e=>e.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${e=>e.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${e=>e.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${e=>e.selected?"#4b47b9":"white"};
    border: 2px solid ${e=>e.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const iv=Ee(de)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;Ee(re)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;Ee.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;Ee(de)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;Ee(he)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const Il=Ee(re)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;Ee(Ve)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;Ee.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;Ee(Xi)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;Ee.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;Ee.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;Ee.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;Ee.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;Ee.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px  3) + (16px  2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;Ee(de)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const uh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],exhibition:i})=>{const[a,o]=_.useState([]);_.useEffect(()=>{let p=[...(e.getFieldValue("selectedStalls")||[]).map(g=>String(g))];if(r){const g=String(r);p.some(x=>x===g)||p.push(g)}s.length>0&&s.forEach(g=>{const x=String(g);p.some(m=>m===x)||p.push(x)}),console.log("StallDetailsStep - Initial stalls after normalization:",p),e.setFieldsValue({selectedStalls:p}),o(p)},[e,r,s]),_.useEffect(()=>{if(a.length>0){const f=e.getFieldValue("selectedStalls")||[],u=new Set(f.map(x=>String(x))),p=new Set(a.map(x=>String(x)));let g=u.size!==p.size;if(!g){for(const x of p)if(!u.has(x)){g=!0;break}}if(g){console.log("Syncing form with selected stalls:",a);const x=a.map(m=>String(m));e.setFieldsValue({selectedStalls:x}),e.validateFields(["selectedStalls"]).catch(m=>{})}}},[a,e]);const l=_.useMemo(()=>!t||t.length===0?[]:t.filter(f=>a.includes(f.id)),[t,a]),d=_.useMemo(()=>{var y,w,k;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const f=t.filter(b=>a.includes(b.id)),u=f.reduce((b,j)=>b+(j.price||j.ratePerSqm*j.dimensions.width*j.dimensions.height),0),g=(((y=i==null?void 0:i.publicDiscountConfig)==null?void 0:y.filter(b=>b.isActive))||[]).map(b=>{const j=b.type==="percentage"?u*(Math.min(Math.max(0,b.value),100)/100):Math.min(b.value,u);return{name:b.name,type:b.type,value:b.value,amount:j}}),x=g.reduce((b,j)=>b+j.amount,0),m=u-x,v=((k=(w=i==null?void 0:i.taxConfig)==null?void 0:w.filter(b=>b.isActive))==null?void 0:k.map(b=>({name:b.name,rate:b.rate,amount:m*(b.rate/100)})))||[],S=v.reduce((b,j)=>b+j.amount,0),T=m+S;return{baseAmount:u,discounts:g,totalDiscountAmount:x,amountAfterDiscount:m,taxes:v,totalTaxAmount:S,total:T,selectedStallNumbers:f.map(b=>`${b.number||b.stallNumber||`Stall ${b.id}`} (${b.hallName||`Hall ${b.hallId||1}`})`).join(", ")}},[t,a,i==null?void 0:i.taxConfig,i==null?void 0:i.publicDiscountConfig]),c=f=>{const u=String(f);if(a.some(g=>String(g)===u)){const g=a.filter(x=>String(x)!==u);o(g),e.setFieldsValue({selectedStalls:g}),Se.info("Stall removed from selection")}},h=f=>`${f.toLocaleString("en-IN")}`;return n.jsxs(Ei,{children:[n.jsx(nv,{children:"Your Selected Stalls"}),n.jsx(sv,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),n.jsx(W.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:n.jsx(Le,{mode:"multiple"})}),l.length>0?n.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:n.jsx(st,{dataSource:l.map(f=>({...f,key:f.id,price:f.price||f.ratePerSqm*f.dimensions.width*f.dimensions.height,area:f.dimensions.width*f.dimensions.height,dimensions:`${f.dimensions.width}m  ${f.dimensions.height}m`,size:`${f.dimensions.width}m  ${f.dimensions.height}m`,stallType:f.stallType||{name:f.typeName||f.type||"Standard"},type:f.typeName||f.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(f,u)=>n.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",f||u.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(f,u)=>n.jsx(_e,{color:"blue",style:{borderRadius:"4px"},children:f||`Hall ${u.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(f,u)=>{var g;const p=((g=u.stallType)==null?void 0:g.name)||u.type||"Standard";return n.jsx(_e,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:p})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(f,u)=>n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx("span",{style:{fontWeight:500},children:f}),n.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[u.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(f,u)=>n.jsxs("span",{style:{color:"#555"},children:["",(u.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:f=>n.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:h(f)})},{title:"",key:"action",width:70,align:"center",render:(f,u)=>n.jsx(Ke,{title:"Remove from selection",children:n.jsx(re,{type:"text",danger:!0,icon:n.jsx(sr,{}),onClick:()=>c(u.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):n.jsx(bt,{description:"No stalls selected yet. Please select stalls from the layout.",image:bt.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),a.length>0&&n.jsxs(iv,{title:n.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Selected Stalls"}),n.jsxs("div",{className:"value",children:[a.length," stall(s) selected"]})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Stall Numbers"}),n.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:d.selectedStallNumbers})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Base Amount"}),n.jsx("div",{className:"value",children:h(d.baseAmount)})]}),d.discounts.map((f,u)=>n.jsxs("div",{className:"summary-row discount",children:[n.jsxs("div",{className:"label",children:[f.name,f.type==="percentage"?` (${f.value}%)`:""]}),n.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",h(f.amount)]})]},`discount-${u}`)),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Amount after Discount"}),n.jsx("div",{className:"value",style:{fontWeight:500},children:h(d.amountAfterDiscount)})]}),d.taxes.map((f,u)=>n.jsxs("div",{className:"summary-row",children:[n.jsxs("div",{className:"label",children:[f.name," (",f.rate,"%)"]}),n.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",h(f.amount)]})]},`tax-${u}`)),n.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[n.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),n.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:h(d.total)})]})]})]})},{Title:av,Paragraph:fh,Text:jn}=Me,{Panel:hk}=Lx,{Option:ov}=Le,xh=({form:e,formValues:t,selectedStallIds:r=[],exhibition:s,stallDetails:i=[]})=>{const a=e.getFieldValue("selectedStalls")||r||[],[o,l]=_.useState(e.getFieldValue("amenities")||[]),[d,c]=_.useState({}),h=_.useMemo(()=>i!=null&&i.length?i.filter(k=>a.includes(k.id)):[],[i,a]),f=_.useMemo(()=>h.reduce((k,b)=>k+b.dimensions.width*b.dimensions.height,0),[h]),u=(s==null?void 0:s.basicAmenities)&&s.basicAmenities.length>0,p=(s==null?void 0:s.amenities)&&s.amenities.length>0,g=_.useMemo(()=>!u||f===0?[]:((s==null?void 0:s.basicAmenities)||[]).map(k=>{const b=Math.floor(f/k.perSqm)*k.quantity;return{...k,calculatedQuantity:b>0?b:0,key:k._id||k.id}}),[s,u,f]),x=k=>{const b={...d};k.forEach(j=>{o.includes(j)||(b[j]=1)}),Object.keys(b).forEach(j=>{k.includes(j)||delete b[j]}),c(b),l(k)},m=k=>(k._id||k.id||"").toString(),v=(k,b)=>{c(j=>({...j,[k]:b}))};xt.useEffect(()=>{const k=o.map(b=>({id:b,quantity:d[b]||1}));e.setFieldsValue({amenities:k})},[o,d,e]);const S=k=>`${k.toLocaleString("en-IN")}`,T=_.useMemo(()=>p?((s==null?void 0:s.amenities)||[]).filter(k=>o.includes(m(k))).map(k=>({...k,key:m(k),quantity:d[m(k)]||1})):[],[s,p,o,d]),y=[{title:"Name",dataIndex:"name",key:"name",render:(k,b)=>n.jsxs(ue,{children:[n.jsx(jn,{strong:!0,children:k}),n.jsx(_e,{color:"blue",children:b.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:k=>n.jsxs(_e,{color:"green",children:[k," ",k===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(k,b)=>n.jsx(Ke,{title:b.description,children:n.jsxs(jn,{type:"secondary",children:[n.jsx(Gt,{style:{marginRight:5}}),"1 ",b.quantity>1?`set of ${b.quantity}`:"unit"," per ",k," sqm"]})})}],w=[{title:"Name",dataIndex:"name",key:"name",render:(k,b)=>n.jsxs(ue,{align:"center",children:[n.jsx(jn,{strong:!0,children:k}),n.jsx(_e,{color:"blue",children:b.type}),n.jsx(jn,{type:"secondary",style:{fontSize:"13px"},children:b.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:k=>n.jsx(jn,{strong:!0,style:{color:"#1890ff"},children:S(k)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(k,b)=>n.jsx(jt,{min:1,value:d[b.key]||1,onChange:j=>v(b.key,j||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,render:(k,b)=>{const j=d[b.key]||1,A=b.rate*j;return n.jsx(jn,{strong:!0,style:{color:"#1890ff"},children:S(A)})}}];return n.jsxs(Ei,{children:[n.jsx(av,{level:4,children:"Stall Amenities"}),n.jsx(fh,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),n.jsx(de,{title:`Selected Stalls: ${a.length}`,style:{marginBottom:24},children:a.length>0?n.jsxs(fh,{children:["You've selected ",a.length," stall(s) with a total area of ",f," sq. meters."]}):n.jsx(bt,{image:bt.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),n.jsx(de,{title:n.jsxs(ue,{children:[n.jsx(gr,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:a.length===0?n.jsx(It,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):u?n.jsx(st,{dataSource:g.filter(k=>k.calculatedQuantity>0),columns:y,pagination:!1,size:"small",locale:{emptyText:n.jsx(bt,{image:bt.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):n.jsx(bt,{image:n.jsx(gd,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),n.jsx(it,{}),n.jsx(de,{title:"Additional Amenities (Extra Charges)",children:p?n.jsxs("div",{children:[n.jsx(W.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:n.jsx(Le,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:o,onChange:x,optionLabelProp:"label",children:((s==null?void 0:s.amenities)||[]).map(k=>n.jsxs(ov,{value:m(k),label:`${k.name} (${S(k.rate)})`,children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(ue,{children:[n.jsx(jn,{strong:!0,children:k.name}),n.jsx(_e,{color:"blue",children:k.type})]}),n.jsx(jn,{style:{color:"#1890ff"},children:S(k.rate)})]}),n.jsx("div",{children:n.jsx(jn,{type:"secondary",children:k.description})})]},m(k)))})}),T.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(it,{orientation:"left",children:"Selected Amenities"}),n.jsx(st,{dataSource:T,columns:w,pagination:!1,size:"small"})]})]}):n.jsx(bt,{image:n.jsx(gd,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),n.jsx(W.Item,{name:"amenities",hidden:!0,children:n.jsx(he,{type:"hidden"})}),n.jsx(W.Item,{name:"selectedStalls",hidden:!0,children:n.jsx(he,{type:"hidden"})})]})},{Title:Nl,Paragraph:ph,Text:Ft}=Me,mh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],selectedStalls:i=[],exhibition:a,onPrev:o,onFinish:l,loading:d=!1,formValues:c={}})=>{const[h,f]=_.useState([]),u=_.useMemo(()=>{const w=(e.getFieldValue("selectedStalls")||[]).map(b=>String(b));if(console.log("ReviewStep - Form has selectedStalls:",w),console.log("ReviewStep - Props selectedStallIds:",s),console.log("ReviewStep - Props selectedStalls:",i),w.length>0)return w;const k=[];if(r){const b=String(r);k.push(b)}return s&&s.length&&s.forEach(b=>{const j=String(b);k.includes(j)||k.push(j)}),i&&i.length&&i.forEach(b=>{const j=String(b);k.includes(j)||k.push(j)}),console.log("ReviewStep - Final consolidated stall IDs:",k),k},[e,r,s,i]);_.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",u),console.log("ReviewStep - Available stall details:",t),t&&t.length&&u.length){const y=t.filter(k=>u.includes(String(k.id)));console.log("ReviewStep - Matched stalls:",y.length);const w=y.map(k=>({key:k.id,id:k.id,number:k.number||k.stallNumber||`Stall ${k.id}`,hallName:k.hallName||`Hall ${k.hallId}`,size:`${k.dimensions.width}m  ${k.dimensions.height}m`,area:k.dimensions.width*k.dimensions.height,rate:k.ratePerSqm,price:k.price||k.ratePerSqm*k.dimensions.width*k.dimensions.height,type:k.typeName||k.type||"Standard"}));f(w)}},[t,u]);const p=_.useMemo(()=>{var L,z,J,ne;const y=h.reduce((te,P)=>te+P.price,0),w=h.reduce((te,P)=>te+(P.area||0),0),k=((L=a==null?void 0:a.basicAmenities)==null?void 0:L.map(te=>{const P=Math.floor(w/te.perSqm)*te.quantity;return{...te,calculatedQuantity:P>0?P:0}}))||[],b=e.getFieldValue("amenities")||[];console.log("ReviewStep - Selected amenities with quantities:",b);let j=0;const A=b.map(te=>{var R;const P=te.id,H=te.quantity||1,B=(R=a==null?void 0:a.amenities)==null?void 0:R.find(K=>K.id===P||K._id===P);if(B){const K=(B.rate||0)*H;return j+=K,{name:B.name,rate:B.rate,type:B.type,description:B.description,quantity:H,total:K}}return null}).filter(Boolean);console.log("ReviewStep - Processed amenity items:",A);const C=(((z=a==null?void 0:a.publicDiscountConfig)==null?void 0:z.filter(te=>te.isActive))||[]).map(te=>{const P=te.type==="percentage"?y*(Math.min(Math.max(0,te.value),100)/100):Math.min(te.value,y);return{name:te.name,type:te.type,value:te.value,amount:P}}),I=C.reduce((te,P)=>te+P.amount,0),F=y-I,N=F,U=((ne=(J=a==null?void 0:a.taxConfig)==null?void 0:J.filter(te=>te.isActive))==null?void 0:ne.map(te=>({name:te.name,rate:te.rate,amount:N*(te.rate/100)})))||[],M=U.reduce((te,P)=>te+P.amount,0);return{baseAmount:y,basicAmenities:k,totalStallArea:w,amenities:A,amenitiesTotal:j,discounts:C,totalDiscountAmount:I,amountAfterDiscount:F,subtotal:N,taxes:U,totalTaxAmount:M,total:N+M,stallCount:h.length}},[h,e,a]);_.useEffect(()=>{var w;const y=((w=a==null?void 0:a.publicDiscountConfig)==null?void 0:w.filter(k=>k.isActive))||[];if(y.length>0){const k=y[0];console.log("Setting discountId in form to:",k),e.setFieldsValue({discountId:{name:k.name,type:k.type,value:k.value}})}},[a,e]);const g=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:(y,w)=>n.jsx(_e,{color:"purple",children:y},`stall-type-${w.key}`)},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:(y,w)=>n.jsxs("span",{children:[y," sqm"]},`stall-area-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",render:(y,w)=>n.jsxs("span",{children:["",y,"/sqm"]},`stall-rate-${w.key}`)},{title:"Price",dataIndex:"price",key:"price",render:(y,w)=>n.jsxs("span",{children:["",y.toLocaleString()]},`stall-price-${w.key}`)}],x=y=>`${y.toLocaleString("en-IN")}`,m=c.customerName||e.getFieldValue("customerName"),v=c.customerPhone||e.getFieldValue("customerPhone"),S=c.email||e.getFieldValue("email"),T=c.companyName||e.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:m,companyName:T,customerPhone:v,customerEmail:S,formValues:c,formFieldValues:{customerName:e.getFieldValue("customerName"),companyName:e.getFieldValue("companyName"),customerPhone:e.getFieldValue("customerPhone"),email:e.getFieldValue("email")}}),d?n.jsx(Ei,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:n.jsx(Vt,{size:"large",tip:"Processing your booking..."})}):u.length===0?n.jsxs(Ei,{children:[n.jsx(It,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),n.jsx("div",{style:{marginTop:24,textAlign:"right"},children:n.jsx(re,{onClick:o,children:"Back to Stall Selection"})})]}):n.jsxs(Ei,{children:[n.jsx(W.Item,{name:"discountId",hidden:!0,children:n.jsx(he,{})}),n.jsx(Nl,{level:4,children:"Booking Summary"}),n.jsx(ph,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),n.jsx(de,{title:"Exhibitor Information",style:{marginBottom:24},children:n.jsxs(Ve,{column:2,children:[n.jsx(Ve.Item,{label:"Name",children:m||"Not provided"}),n.jsx(Ve.Item,{label:"Company",children:T||"Not provided"}),n.jsx(Ve.Item,{label:"Phone",children:v||"Not provided"}),n.jsx(Ve.Item,{label:"Email",children:S||"Not provided"})]})}),n.jsxs(de,{title:"Selected Stalls",className:"review-card",size:"small",children:[n.jsx(st,{dataSource:h,columns:g,pagination:!1,size:"small",style:{marginBottom:16}}),n.jsxs(Ft,{strong:!0,children:["Total Base Amount: ",x(p.baseAmount)]})]}),p.basicAmenities&&p.basicAmenities.length>0&&n.jsxs(de,{title:n.jsxs(ue,{children:[n.jsx(gr,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[n.jsxs(ph,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",p.totalStallArea," sqm."]}),n.jsx(st,{dataSource:p.basicAmenities.filter(y=>y.calculatedQuantity>0).map((y,w)=>({...y,key:`basic-${w}`})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,w)=>n.jsxs(ue,{children:[n.jsx(Ft,{strong:!0,children:y}),n.jsx(_e,{color:"blue",children:w.type})]},`name-${w.key}`)},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:(y,w)=>n.jsxs(_e,{color:"green",children:[y," ",y===1?"unit":"units"]},`quantity-${w.key}`)},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(y,w)=>n.jsxs(Ft,{type:"secondary",children:[n.jsx(Gt,{style:{marginRight:5}}),"1 ",w.quantity>1?`set of ${w.quantity}`:"unit"," per ",y," sqm"]},`allocation-${w.key}`)},{title:"Status",key:"status",width:100,align:"right",render:(y,w)=>n.jsx(Ft,{type:"success",children:"Included"},`status-${w.key}`)}],pagination:!1,size:"small",locale:{emptyText:n.jsx(It,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),p.amenities&&p.amenities.length>0&&n.jsxs(de,{title:"Selected Amenities",style:{marginBottom:24},children:[n.jsx(st,{dataSource:p.amenities.map((y,w)=>({...y,key:w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,w)=>n.jsxs(ue,{children:[n.jsx(Ft,{strong:!0,children:y}),n.jsx(_e,{color:"blue",children:w.type})]},`amenity-name-${w.key}`)},{title:"Description",dataIndex:"description",key:"description",render:(y,w)=>n.jsx(Ft,{type:"secondary",style:{fontSize:"13px"},children:y||"No description provided"},`amenity-desc-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",width:110,align:"right",render:(y,w)=>n.jsx(Ft,{strong:!0,style:{color:"#1890ff"},children:x(y)},`amenity-rate-${w.key}`)},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:90,align:"center",render:(y,w)=>n.jsx(_e,{color:"green",children:y},`amenity-qty-${w.key}`)},{title:"Total",dataIndex:"total",key:"total",width:110,align:"right",render:(y,w)=>n.jsx(Ft,{strong:!0,style:{color:"#1890ff"},children:x(y)},`amenity-total-${w.key}`)}],pagination:!1,size:"small"}),n.jsx(it,{}),n.jsx("div",{style:{textAlign:"right"},children:n.jsxs(Ft,{strong:!0,children:["Amenities Total: ",x(p.amenitiesTotal)]})})]}),n.jsxs(de,{title:"Price Calculation",style:{marginBottom:24},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(Ft,{children:"Base Amount:"}),n.jsx(Ft,{children:x(p.baseAmount)})]}),p.discounts.length>0&&n.jsxs(n.Fragment,{children:[p.discounts.map((y,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(Ft,{children:[y.name," (",y.type==="percentage"?`${y.value}%`:x(y.value),"):"]}),n.jsxs(Ft,{type:"danger",children:["- ",x(y.amount)]})]},w)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(Ft,{children:"Amount after Discount:"}),n.jsx(Ft,{children:x(p.amountAfterDiscount)})]})]}),p.amenitiesTotal>0&&n.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[n.jsx(Ft,{type:"secondary",children:"Selected Amenities (for information only):"}),n.jsx(Ft,{type:"secondary",children:x(p.amenitiesTotal)})]}),n.jsx(Ft,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(Ft,{strong:!0,children:"Subtotal:"}),n.jsx(Ft,{strong:!0,children:x(p.subtotal)})]}),p.taxes.length>0&&n.jsx(n.Fragment,{children:p.taxes.map((y,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(Ft,{children:[y.name," (",y.rate,"%):"]}),n.jsx(Ft,{children:x(y.amount)})]},w))}),n.jsx(it,{}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Nl,{level:5,children:"Total:"}),n.jsx(Nl,{level:5,children:x(p.total)})]})]})]})},{confirm:lv}=Ye,cv=({visible:e,stallDetails:t,selectedStallId:r,selectedStallIds:s,loading:i,exhibition:a,onCancel:o,onSubmit:l})=>{const[d]=W.useForm(),[c,h]=_.useState(0),[f]=_.useState(3),[u,p]=_.useState({}),[g,x]=_.useState(!1),[m,v]=_.useState(!1),S=qe(C=>C.exhibitorAuth.exhibitor);_.useEffect(()=>{if(e){h(0),x(!1),p({}),d.resetFields();const C=s.map(N=>String(N));r&&C.push(String(r));const I=[...new Set(C)],F={selectedStalls:I,exhibitionId:a==null?void 0:a._id};S&&(F.customerName=S.contactPerson||"",F.companyName=S.companyName||"",F.email=S.email||"",F.customerPhone=S.phone||""),d.setFieldsValue(F),p(F),console.log("Booking form initialized with stalls:",I),console.log("Exhibitor profile data:",S)}},[e,d,r,s,a,S]);const T=()=>{x(!0)},y=()=>{g?lv({title:"Discard changes?",icon:n.jsx(Xs,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){o()}}):o()},w=()=>{v(!0),d.validateFields().then(C=>{const I={...u,...C},F={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...I,...F};p(N),console.log("Step completed, saving form values:",N),console.log("Selected stalls are:",N.selectedStalls||[]),console.log("Exhibitor info:",F),h(c+1),v(!1)}).catch(C=>{v(!1),console.error("Form validation failed:",C),Se.error("Please complete all required fields")})},k=()=>{h(c-1)},b=()=>{d.validateFields().then(C=>{const I={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},F=d.getFieldValue("selectedStalls")||[],N=d.getFieldValue("amenities")||[],M=t.filter(ne=>F.includes(String(ne.id))).reduce((ne,te)=>ne+te.dimensions.width*te.dimensions.height,0);let L=[];a!=null&&a.basicAmenities&&a.basicAmenities.length>0&&(L=a.basicAmenities.filter(ne=>Math.floor(M/ne.perSqm)*ne.quantity>0).map(ne=>{const te=Math.floor(M/ne.perSqm)*ne.quantity;return{name:ne.name,type:ne.type,perSqm:ne.perSqm,quantity:ne.quantity,calculatedQuantity:te,description:ne.description||""}}));let z=[];N&&N.length>0&&(z=N.map(ne=>{var P;const te=(P=a==null?void 0:a.amenities)==null?void 0:P.find(H=>String(H._id||H.id)===String(ne.id));return te?{id:String(te._id||te.id),name:te.name,type:te.type,rate:te.rate,quantity:ne.quantity||1,description:te.description||""}:null}).filter(Boolean));const J={...u,...C,...I,basicAmenities:L,extraAmenities:z};console.log("Submitting booking with values:",J),console.log("Basic amenities:",L),console.log("Extra amenities:",z),l(J)}).catch(C=>{console.error("Form validation failed:",C),Se.error("Please complete all required fields")})},j=["Stall Details","Amenities","Review"],A=[{title:"Stall Details",icon:n.jsx(Ox,{}),content:n.jsx(uh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a})},{title:"Amenities",icon:n.jsx(ps,{}),content:n.jsx(xh,{form:d,stallDetails:t,selectedStallIds:d.getFieldValue("selectedStalls")||[],exhibition:a,formValues:u})},{title:"Review",icon:n.jsx(St,{}),content:n.jsx(mh,{form:d,formValues:u,loading:i,exhibition:a,selectedStalls:d.getFieldValue("selectedStalls")||[],selectedStallIds:d.getFieldValue("selectedStalls")||[],stallDetails:t})}];_.useEffect(()=>{const C=d.getFieldValue("selectedStalls");console.log(`Step ${c} - Form has selectedStalls:`,C)},[c,d]);const E=C=>{const I=d.getFieldValue("selectedStalls")||[],F={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...u,...F};switch(console.log(`Rendering step ${C} with:`,{selectedStalls:I,exhibitorInfo:F}),C){case 0:return n.jsx(uh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a});case 1:return n.jsx(xh,{form:d,stallDetails:t,selectedStallIds:I,exhibition:a,formValues:N});case 2:return n.jsx(mh,{form:d,formValues:N,loading:i,exhibition:a,selectedStalls:I,selectedStallIds:I,stallDetails:t,onPrev:k,onFinish:b});default:return null}};return n.jsx(tv,{title:`Book Exhibition Stall - ${j[c]}`,open:e,onCancel:y,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[c>0&&n.jsx(Il,{onClick:k,disabled:m||i,size:"large",children:"Back"}),n.jsx("div",{children:c<f-1?n.jsx(Il,{type:"primary",onClick:w,loading:m,disabled:i,size:"large",children:"Next"}):n.jsx(Il,{type:"primary",onClick:b,loading:i,disabled:m,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:n.jsxs(Vt,{spinning:i||m,tip:i?"Processing your booking...":"Validating...",children:[n.jsx(rv,{children:A.map((C,I)=>n.jsxs("div",{className:`step-item ${c===I?"active":""} ${c>I?"completed":""}`,onClick:()=>c>I?h(I):null,style:{cursor:c>I?"pointer":"default"},children:[n.jsx("span",{className:"step-icon",children:c>I?n.jsx(vc,{}):I+1}),C.title]},I))}),n.jsx(W,{form:d,layout:"vertical",preserve:!0,onFieldsChange:T,children:E(c)},`form-step-${c}`)]})})},{Step:Fl}=Xi,{Text:dv}=Me,hv=({loginModalVisible:e,registerModalVisible:t,setRegisterModalVisible:r,setExhibitorCredentials:s,onForgotPassword:i})=>{const a=lt(),o=qe(te=>te.exhibitorAuth),[l,d]=_.useState(!1),[c,h]=_.useState(null),[f]=W.useForm(),[u]=W.useForm(),[p]=W.useForm(),[g,x]=_.useState(0),[m,v]=_.useState(""),[S,T]=_.useState(!1),[y,w]=_.useState(!1),[k,b]=_.useState(0),[j,A]=_.useState({companyName:"",contactPerson:""}),E=_.useRef(null),C=async te=>{var P,H,B,R,K,se,we,ye,X;try{h(null),d(!0);const ee=await dr.login(te),{exhibitor:ce,token:xe}=ee.data;if(!ce||!xe)throw new Error("Invalid response from server");s({exhibitor:ce,token:xe}),a(ua()),f.resetFields(),Se.success("Login successful!")}catch(ee){if(((P=ee.response)==null?void 0:P.status)===403){const ce=(B=(H=ee.response)==null?void 0:H.data)==null?void 0:B.status;if(ce==="pending")h("Your account is pending approval. You will be able to log in after admin approval.");else if(ce==="rejected"){const xe=(K=(R=ee.response)==null?void 0:R.data)==null?void 0:K.rejectionReason;h(xe?`Your registration has been rejected. Reason: ${xe}`:"Your registration has been rejected. Please contact the administrator for more details.")}else h(((we=(se=ee.response)==null?void 0:se.data)==null?void 0:we.message)||"Access denied. Please contact administrator.")}else h(((X=(ye=ee.response)==null?void 0:ye.data)==null?void 0:X.message)||"Login failed. Please try again.")}finally{d(!1)}},I=async()=>{var te,P;try{const H=await u.validateFields(["email","companyName","contactPerson"]);d(!0),h(null),v(H.email),A({companyName:H.companyName,contactPerson:H.contactPerson}),await dr.sendRegistrationOTP(H.email),T(!0),Se.success("OTP sent to your email address"),b(60),F(),x(1)}catch(H){if(H.name==="ValidationError")return;const B=((P=(te=H.response)==null?void 0:te.data)==null?void 0:P.message)||"Failed to send OTP. Please try again.";h(B),Se.error(B)}finally{d(!1)}},F=()=>{E.current&&clearInterval(E.current),E.current=setInterval(()=>{b(te=>te<=1?(E.current&&clearInterval(E.current),0):te-1)},1e3)},N=async()=>{var te,P;try{d(!0),h(null),await dr.sendRegistrationOTP(m),Se.success("New OTP sent to your email address"),b(60),F()}catch(H){const B=((P=(te=H.response)==null?void 0:te.data)==null?void 0:P.message)||"Failed to resend OTP. Please try again.";h(B),Se.error(B)}finally{d(!1)}},U=async te=>{var P,H;try{d(!0),h(null);const B={email:m,otp:te.otp};await dr.verifyOTP(B),w(!0),Se.success("Email verified successfully"),E.current&&clearInterval(E.current),x(2)}catch(B){const R=((H=(P=B.response)==null?void 0:P.data)==null?void 0:H.message)||"Invalid OTP. Please try again.";h(R),Se.error(R)}finally{d(!1)}},M=()=>{T(!1),w(!1),v(""),b(0),x(0),A({companyName:"",contactPerson:""}),E.current&&clearInterval(E.current),p.resetFields()},L=async te=>{var P,H,B;try{if(h(null),d(!0),!y){h("Email verification required");return}const{confirmPassword:R,...K}=te,se={...K,email:m,companyName:j.companyName,contactPerson:j.contactPerson};console.log("Sending registration data:",se);const we=await dr.register(se);Se.success("Registration successful! You can log in and book a stall only after admin approval."),r(!1),u.resetFields(),M(),setTimeout(()=>{a(cs(void 0))},500)}catch(R){console.error("Registration error:",R),console.error("Response data:",(P=R.response)==null?void 0:P.data);const K=((B=(H=R.response)==null?void 0:H.data)==null?void 0:B.message)||"Registration failed. Please try again.";h(K),Se.error(K)}finally{d(!1)}};xt.useEffect(()=>()=>{E.current&&clearInterval(E.current)},[]);const z=()=>{r(!1),h(null),u.resetFields(),M()},J=()=>{a(ua()),r(!0),f.resetFields()},ne=()=>{r(!1),a(cs(void 0)),u.resetFields()};return n.jsxs(n.Fragment,{children:[n.jsxs(Ye,{title:"Exhibitor Login",open:e,onCancel:()=>{a(ua()),h(null),f.resetFields()},footer:null,width:400,children:[o.loginContext==="stall-booking"&&n.jsx(It,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),c&&n.jsx(It,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),n.jsxs(W,{form:f,name:"exhibitor_login_modal",onFinish:C,layout:"vertical",children:[n.jsx(W.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(he,{prefix:n.jsx(fn,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(W.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsxs(W.Item,{children:[n.jsx("div",{style:{textAlign:"right",marginBottom:10},children:n.jsx(re,{type:"link",onClick:()=>{a(ua()),i()},style:{padding:0},children:"Forgot password?"})}),n.jsx(re,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Login"})]})]}),n.jsx(it,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),n.jsx(re,{type:"default",block:!0,onClick:J,children:"Register as Exhibitor"})]}),n.jsxs(Ye,{title:"Exhibitor Registration",open:t,onCancel:z,footer:null,width:500,children:[n.jsxs(Xi,{current:g,style:{marginBottom:24},children:[n.jsx(Fl,{title:"Basic Info"}),n.jsx(Fl,{title:"Verify Email"}),n.jsx(Fl,{title:"Complete"})]}),c&&n.jsx(It,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),g===0&&n.jsxs(n.Fragment,{children:[n.jsx(It,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(W,{form:u,name:"exhibitor_register_step1",layout:"vertical",children:[n.jsx(W.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:n.jsx(he,{prefix:n.jsx(jc,{}),placeholder:"Company Name",size:"large",disabled:l})}),n.jsx(W.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:n.jsx(he,{prefix:n.jsx(ht,{}),placeholder:"Contact Person",size:"large",disabled:l})}),n.jsx(W.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(he,{prefix:n.jsx(fn,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",onClick:I,block:!0,size:"large",loading:l,children:"Continue & Verify Email"})})]}),n.jsx(it,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),n.jsx(re,{type:"default",block:!0,onClick:ne,children:"Login"})]}),g===1&&n.jsxs(n.Fragment,{children:[n.jsx(It,{message:"Email Verification",description:`We've sent a verification code to ${m}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(W,{form:p,name:"verify_otp",onFinish:U,layout:"vertical",children:[n.jsx(W.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:n.jsx(he,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:l})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Verify & Continue"})})]}),n.jsxs(Ne,{justify:"space-between",align:"middle",style:{marginTop:16},children:[n.jsx(Q,{children:n.jsx(re,{type:"link",disabled:k>0||l,onClick:N,children:"Resend Code"})}),n.jsx(Q,{children:k>0&&n.jsxs(dv,{type:"secondary",children:["Resend in ",k,"s"]})})]}),n.jsx(it,{}),n.jsx(re,{type:"default",block:!0,onClick:()=>x(0),children:"Back"})]}),g===2&&n.jsxs(n.Fragment,{children:[n.jsx(It,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),n.jsxs(W,{form:u,name:"exhibitor_register_step2",onFinish:L,layout:"vertical",children:[n.jsx(W.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:n.jsx(he,{prefix:n.jsx(Sc,{}),placeholder:"Phone Number",size:"large",disabled:l})}),n.jsx(W.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:n.jsx(he.TextArea,{placeholder:"Address",rows:3,disabled:l})}),n.jsx(W.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsx(W.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:te})=>({validator(P,H){return!H||te("password")===H?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm Password",size:"large",disabled:l})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Complete Registration"})})]})]})]})]})},{Step:uk}=Xi,{Text:fk}=Me,uv=({visible:e})=>{const t=lt(),[r,s]=_.useState(!1),[i,a]=_.useState(null),[o,l]=_.useState(0),[d,c]=_.useState(""),[h,f]=_.useState(!1),[u,p]=_.useState(0),g=W.useForm()[0],x=W.useForm()[0],m=W.useForm()[0],v=_.useRef(null),S=async E=>{var C,I;try{s(!0),a(null);const F=await dr.requestPasswordReset(E);c(E.email),f(!0),l(1),Se.success("Password reset code sent to your email"),p(60),T()}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Failed to send password reset code. Please try again.";a(N)}finally{s(!1)}},T=()=>{v.current&&clearInterval(v.current),v.current=setInterval(()=>{p(E=>E<=1?(v.current&&clearInterval(v.current),0):E-1)},1e3)},y=async()=>{var E,C;try{s(!0),a(null),await dr.requestPasswordReset({email:d}),Se.success("New password reset code sent to your email"),p(60),T()}catch(I){const F=((C=(E=I.response)==null?void 0:E.data)==null?void 0:C.message)||"Failed to resend password reset code. Please try again.";a(F)}finally{s(!1)}},w=async E=>{var C,I;try{s(!0),a(null),l(2),v.current&&clearInterval(v.current)}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Invalid code. Please try again.";a(N)}finally{s(!1)}},k=async E=>{var C,I;try{s(!0),a(null);const F=x.getFieldValue("otp"),N={email:d,otp:F,newPassword:E.newPassword};await dr.resetPassword(N),Se.success("Password reset successful. You can now log in with your new password."),b(),t(hl()),t(cs())}catch(F){const N=((I=(C=F.response)==null?void 0:C.data)==null?void 0:I.message)||"Failed to reset password. Please try again.";a(N)}finally{s(!1)}},b=()=>{l(0),c(""),f(!1),p(0),v.current&&clearInterval(v.current),g.resetFields(),x.resetFields(),m.resetFields()},j=()=>{b(),t(hl())},A=()=>{b(),t(hl()),t(cs())};return xt.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),n.jsxs(Ye,{title:"Forgot Password",open:e,onCancel:j,footer:null,width:400,children:[i&&n.jsx(It,{message:i,type:"error",style:{marginBottom:16}}),n.jsx(Xi,{current:o,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),o===0&&n.jsxs(W,{form:g,onFinish:S,layout:"vertical",children:[n.jsx(W.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(fn,{}),placeholder:"Email"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Send Reset Code"})}),n.jsx(it,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),n.jsx(re,{type:"link",onClick:A,block:!0,children:"Back to Login"})]}),o===1&&n.jsxs(W,{form:x,onFinish:w,layout:"vertical",children:[n.jsxs("p",{children:["We've sent a verification code to ",n.jsx("strong",{children:d}),". Please check your email and enter the code below."]}),n.jsx(W.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:n.jsx(he,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Verify Code"})}),n.jsx("div",{style:{textAlign:"center",marginTop:8},children:u>0?n.jsxs(Me.Text,{type:"secondary",children:["Resend code in ",u,"s"]}):n.jsx(re,{type:"link",onClick:y,disabled:r,children:"Resend Code"})}),n.jsx(it,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),n.jsx(re,{type:"link",onClick:()=>{l(0),v.current&&(clearInterval(v.current),p(0))},block:!0,children:"Change Email"})]}),o===2&&n.jsxs(W,{form:m,onFinish:k,layout:"vertical",children:[n.jsx(W.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"New Password"})}),n.jsx(W.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:E})=>({validator(C,I){return!I||E("newPassword")===I?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{prefix:n.jsx(En,{}),placeholder:"Confirm Password"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Reset Password"})})]})]})},{Header:fv}=Nt,xv=Ee(fv)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,pv=Ee.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,mv=Ee.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,gv=Ee.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,yv=Ee.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,gh=Ee(Ur)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,yh=Ee(hr)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,vv=Ee(hr)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,bv=Ee(re)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,wv=Ee.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,jv=Ee(Nr)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,Ea=Ee(re)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,Sv=Ee.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,Ev=Ee.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,Kr=()=>{var j;const e=tt(),t=lt(),[r,s]=_.useState(!1),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d,c]=_.useState("/logo.png"),[h,f]=_.useState("Exhibition Manager"),u=qe(A=>A.exhibitorAuth),{exhibitor:p,isAuthenticated:g,showLoginModal:x,showForgotPasswordModal:m}=u;_.useEffect(()=>{const A=localStorage.getItem("cachedLogoUrl"),E=localStorage.getItem("logoTimestamp"),C=new Date().getTime();if(A&&E&&C-parseInt(E)<36e5)c(A);else{const I=`${ke.defaults.baseURL}/public/logo`;c(I),localStorage.setItem("cachedLogoUrl",I),localStorage.setItem("logoTimestamp",C.toString());const F=new Image;F.src=I}fetch(`${ke.defaults.baseURL}/public/site-info`).then(I=>I.json()).then(I=>{I.siteName&&f(I.siteName)}).catch(I=>{console.error("Error fetching site info:",I)})},[]),_.useEffect(()=>(Se.config({top:84,duration:3,maxCount:1}),()=>{Se.destroy()}),[]);const v=()=>{t(Qu()),Se.success("Successfully logged out"),e("/"),s(!1),a(!1)},S=()=>{t(cs(void 0)),s(!1),a(!1)},T=()=>{l(!0),s(!1),a(!1)},y=()=>{t(Km())},w=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],k=n.jsx(yh,{items:[{key:"exhibitor-login",icon:n.jsx(yd,{}),label:n.jsx("a",{onClick:S,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:n.jsx(Fi,{}),label:n.jsx("a",{onClick:T,children:"Register as Exhibitor"})}]}),b=n.jsx(yh,{items:[{key:"exhibitor-dashboard",icon:n.jsx(fo,{}),label:n.jsx(Nr,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:n.jsx(ht,{}),label:n.jsx(Nr,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:n.jsx(wr,{}),label:n.jsx(Nr,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:n.jsx(uo,{}),label:n.jsx("a",{onClick:v,children:"Logout"})}]});return n.jsxs(n.Fragment,{children:[n.jsx(xv,{children:n.jsxs(pv,{children:[n.jsx(mv,{children:n.jsx(Nr,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:n.jsx(gv,{children:n.jsx(yv,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})})}),n.jsx(vv,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:w.map(A=>({key:A.key,label:n.jsx(Nr,{to:A.path,children:A.label})}))}),n.jsx(Sv,{children:n.jsx(Vn,{overlay:u.isAuthenticated?b:k,trigger:["click"],placement:"bottomRight",open:r,onOpenChange:s,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:u.isAuthenticated?n.jsxs(ue,{style:{cursor:"pointer"},children:[n.jsx(Ev,{children:((j=u.exhibitor)==null?void 0:j.companyName)||"Exhibitor"}),n.jsx(gh,{icon:n.jsx(ht,{}),size:"large"})]}):n.jsx(gh,{icon:n.jsx(ht,{}),size:"large"})})}),n.jsx(bv,{icon:n.jsx(Bx,{}),onClick:()=>a(!0)})]})}),n.jsx(wv,{children:n.jsxs(Mx,{title:"Exhibition Management System",placement:"right",onClose:()=>a(!1),open:i,width:280,closeIcon:n.jsx("span",{style:{fontSize:"16px"},children:""}),children:[n.jsx("div",{style:{marginBottom:24},children:w.map(A=>n.jsx(jv,{to:A.path,onClick:()=>a(!1),children:A.label},A.key))}),n.jsx("div",{style:{marginTop:40},children:u.isAuthenticated?n.jsxs(n.Fragment,{children:[n.jsx(Ea,{type:"primary",icon:n.jsx(fo,{}),onClick:()=>{e("/exhibitor/dashboard"),a(!1)},children:"Dashboard"}),n.jsx(Ea,{type:"default",icon:n.jsx(uo,{}),onClick:v,children:"Logout"})]}):n.jsxs(n.Fragment,{children:[n.jsx(Ea,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:n.jsx(yd,{}),onClick:()=>{S(),a(!1)},children:"Exhibitor Login"}),n.jsx(Ea,{type:"default",icon:n.jsx(Fi,{}),onClick:()=>{T(),a(!1)},children:"Register as Exhibitor"})]})})]})}),n.jsx(hv,{loginModalVisible:x,registerModalVisible:o,setRegisterModalVisible:l,setExhibitorCredentials:A=>t(cc(A)),onForgotPassword:y}),n.jsx(uv,{visible:m})]})},{Content:Ta}=Nt,{Title:xk}=Me,Tv=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/"))return`${ke.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${ke.defaults.baseURL}/${s}?token=${r}`:`${ke.defaults.baseURL}/${s}`},_v=()=>{var z,J,ne,te;const{id:e}=Dr(),t=tt(),r=lt(),[s,i]=_.useState(null),[a,o]=_.useState(null),[l,d]=_.useState(null),[c,h]=_.useState([]),[f,u]=_.useState(!1),[p,g]=_.useState(!0),[x,m]=_.useState(null),[v,S]=_.useState(!1),[T,y]=_.useState(null),w=_.useRef(null),[k,b]=_.useState({width:800,height:600}),[j,A]=_.useState(!1),[E]=W.useForm(),{isAuthenticated:C}=qe(P=>P.exhibitorAuth);_.useEffect(()=>{const P=()=>{A(window.innerWidth<768)};return P(),window.addEventListener("resize",P),()=>{window.removeEventListener("resize",P)}},[]);const I=_.useCallback(P=>P.status==="booked"||P.status==="reserved",[]),F=_.useCallback(()=>{if(w.current){const{clientWidth:P,clientHeight:H}=w.current,B=j?320:800,R=j?480:600,K=Math.max(P||B,B),se=Math.max(H||R,R);(Math.abs(K-k.width)>5||Math.abs(se-k.height)>5)&&b({width:K,height:se})}},[k.width,k.height,j]);_.useEffect(()=>{let P=null;const H=()=>{P===null&&(P=window.setTimeout(()=>{P=null,F()},j?100:50))};F();const B=new ResizeObserver(H);return w.current&&B.observe(w.current),window.addEventListener("resize",H),()=>{P!==null&&window.clearTimeout(P),B.disconnect(),window.removeEventListener("resize",H)}},[F,j]),_.useEffect(()=>{(async()=>{try{if(!e){m("Exhibition ID is missing"),g(!1);return}g(!0),m(null);const H=await Fr.getLayout(e);i(H.data)}catch(H){m(H.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",H)}finally{g(!1)}})()},[e]),_.useEffect(()=>{s&&F()},[s]),_.useEffect(()=>{C&&s&&(d(null),h([]),F(),Se.info("You can now select stalls to book.",3))},[C]);const N=_.useCallback(async P=>{if(I(P)){Se.info(`This stall (${P.stallNumber}) is already booked.`);return}if(!C){r(cs("stall-booking"));return}const B=P._id||P.id;h(R=>R.includes(B)?(Se.info(`Stall ${P.stallNumber} removed from selection`),R.filter(K=>K!==B)):(Se.success(`Stall ${P.stallNumber} added to selection`),[...R,B]))},[I,C,r]),U=async P=>{try{S(!0);const H={...P,exhibitionId:s==null?void 0:s.exhibition._id,stallIds:P.selectedStalls};if(C){const B=await Fr.exhibitorBookStalls(H);Se.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const B=await Fr.bookMultipleStalls(e,H);Se.success("Your booking request has been submitted successfully!")}if(u(!1),h([]),e)try{const B=await Fr.getLayout(e);i(B.data)}catch(B){console.error("Error refreshing layout data:",B)}}catch(H){console.error("Error booking stall",H),Se.error("Failed to book stall. Please try again.")}finally{S(!1)}},M=async()=>{var P;try{if(!s)return;S(!0);let H=null;if(l){const R=s.layout.find(K=>K.stalls.some(se=>se.id===l));R?H=R.stalls.find(K=>K.id===l)||null:console.error("Selected stall not found in any hall")}const B=s.layout.flatMap(R=>R.stalls.map(K=>({...K,hallId:R.id,hallName:R.name}))).filter(R=>R.status==="available");if(c.length===0&&l===null&&B.length===0){Se.error("No stalls are available for booking");return}if(!s.exhibition.basicAmenities)try{const R=await Fr.getExhibition(e||"");(P=R==null?void 0:R.data)!=null&&P.basicAmenities&&i({...s,exhibition:{...s.exhibition,basicAmenities:R.data.basicAmenities}})}catch(R){console.error("Error fetching exhibition details with amenities:",R)}y(B),u(!0)}catch(H){console.error("Error opening booking modal:",H),Se.error("Failed to open booking form")}finally{S(!1)}};_.useCallback(P=>{P.cancelBubble=!0},[]);const L=_.useMemo(()=>{var P;return s?{halls:s.layout.map(H=>n.jsx(yf,{hall:{...H,exhibitionId:e||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},H.id)),stalls:s.layout.flatMap(H=>H.stalls.map(B=>{var R,K,se,we,ye,X,ee,ce;return n.jsx(zc,{stall:{...B,hallId:H.id,hallName:H.name,isSelected:c.includes(B.id),stallTypeId:"default",number:B.stallNumber,typeName:B.type||"Standard",ratePerSqm:B.price||0,rotation:0,dimensions:{x:((R=B.position)==null?void 0:R.x)||0,y:((K=B.position)==null?void 0:K.y)||0,width:((se=B.dimensions)==null?void 0:se.width)||0,height:((we=B.dimensions)==null?void 0:we.height)||0},status:B.status==="maintenance"?"booked":B.status},isSelected:l===B.id||c.includes(B.id),onSelect:B.status==="available"?()=>N(B):void 0,hallWidth:((ye=H.dimensions)==null?void 0:ye.width)||0,hallHeight:((X=H.dimensions)==null?void 0:X.height)||0,hallX:((ee=H.dimensions)==null?void 0:ee.x)||0,hallY:((ce=H.dimensions)==null?void 0:ce.y)||0},B.id)})),fixtures:(P=s.fixtures)==null?void 0:P.map(H=>{var B,R;return n.jsx(vf,{fixture:{...H,id:H.id||H._id,_id:H._id||H.id,exhibitionId:e||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((B=s.exhibition.dimensions)==null?void 0:B.width)||0,exhibitionHeight:((R=s.exhibition.dimensions)==null?void 0:R.height)||0},H.id||H._id)})}:null},[s,e,l,c,N]);return p?n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ta,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Vt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):x||!s?n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ta,{style:{paddingTop:"64px"},children:n.jsx(Li,{status:"error",title:"Failed to load exhibition layout",subTitle:x||"The exhibition layout couldn't be loaded.",extra:[n.jsx(re,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((z=s.exhibition.dimensions)!=null&&z.width)||!((J=s.exhibition.dimensions)!=null&&J.height)?n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ta,{style:{paddingTop:"64px"},children:n.jsx(de,{children:n.jsx(Li,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsxs(Ta,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[j&&n.jsx("div",{style:{height:"16px",width:"100%"}}),n.jsxs(de,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:j?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:j?"5px":"24px"},children:[n.jsxs(Ne,{gutter:[24,24],style:{marginBottom:j?16:32},children:[n.jsx(Q,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:j?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:j?"column":"row",alignItems:j?"flex-start":"center",gap:j?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:j?"center":"flex-start",width:j?"100%":"auto"},children:s.exhibition.headerLogo?n.jsx(Tu,{src:Tv(s.exhibition.headerLogo),alt:`${s.exhibition.name} logo`,style:{maxHeight:j?70:90,maxWidth:j?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:j?200:250,height:j?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:n.jsx(Vt,{size:"small"})})}):n.jsx("div",{style:{width:j?70:90,height:j?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:n.jsx(Yr,{style:{fontSize:j?24:32,color:"#aaa"}})})}),!j&&n.jsx(it,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),n.jsxs("div",{style:{flex:1,width:j?"100%":"auto"},children:[n.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:j?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.exhibition.name}),n.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:j?"13px":"14px"},children:[n.jsx(Yr,{style:{fontSize:j?"14px":"16px",color:"#1890ff"}}),n.jsxs("span",{children:[new Date(s.exhibition.startDate).toLocaleDateString()," -",new Date(s.exhibition.endDate).toLocaleDateString()]})]}),n.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:j?"13px":"14px"},children:[n.jsx(Gt,{style:{fontSize:j?"14px":"16px",color:"#1890ff"}}),n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:j?"nowrap":"normal",maxWidth:j?"260px":"none"},children:s.exhibition.venue})]})]})]})}),n.jsx(Q,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:j?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{marginBottom:"16px",fontSize:j?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),n.jsxs("div",{style:{display:"flex",flexDirection:j?"column":"row",justifyContent:"center",alignItems:"center",gap:j?"10px":"16px",width:"100%"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(gr,{status:"success"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(gr,{status:"processing",color:"#1890ff"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:j?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(gr,{status:"warning"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),n.jsxs("div",{ref:w,style:{width:"100%",height:j?"70vh":"80vh",minHeight:j?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[n.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Base canvas optimization */
                .konvajs-content {
                  will-change: transform;
                  transform: translateZ(0);
                  backface-visibility: hidden;
                  transition: filter 0.2s ease-out;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Canvas optimization for all canvases */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                  transition: filter 0.15s linear;
                }
                
                /* Dragging state - apply blur effect with better control */
                .public-canvas-container .konvajs-content.dragging {
                  filter: blur(1px);
                }
                
                /* Mobile-specific blur - slightly stronger */
                @media (max-width: 768px) {
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(1.5px);
                  }
                }
                
                /* Performance optimizations for dragging */
                .public-canvas-container .konvajs-content:active canvas {
                  image-rendering: optimizeSpeed;
                }
                
                /* Touch device optimizations */
                @media (pointer: coarse) {
                  .public-canvas-container .konvajs-content:active {
                    touch-action: none;
                  }
                  
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(2px); /* Stronger blur for touch devices */
                  }
                }
                
                /* Animation smoothing to reduce flickering */
                .public-canvas-container .konvajs-content canvas {
                  will-change: filter;
                  transform: translateZ(0);
                }
                
                /* Low-end device optimizations */
                @media (max-width: 480px), 
                       (resolution: 150dpi),
                       (any-pointer: coarse) {
                  .public-canvas-container .konvajs-content:active canvas {
                    image-rendering: optimizeSpeed;
                  }
                }
              `}),n.jsxs(Zi,{width:k.width,height:k.height,exhibitionWidth:((ne=s==null?void 0:s.exhibition.dimensions)==null?void 0:ne.width)||0,exhibitionHeight:((te=s==null?void 0:s.exhibition.dimensions)==null?void 0:te.height)||0,halls:(s==null?void 0:s.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[L==null?void 0:L.halls,L==null?void 0:L.stalls,L==null?void 0:L.fixtures]})]})]})]}),c.length>0&&n.jsx($x,{offsetBottom:20,children:n.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:n.jsxs(re,{type:"primary",size:"large",icon:n.jsx(xo,{}),onClick:M,loading:v,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",c.length,")"]})})}),n.jsx(cv,{visible:f,stallDetails:T,selectedStallId:l,selectedStallIds:c,loading:v,exhibition:s==null?void 0:s.exhibition,onCancel:()=>{u(!1)},onSubmit:U})]})},kv=xt.memo(_v),{Content:Rl}=Nt,{Title:Pl,Text:Zn,Paragraph:vh}=Me,Dl=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/")||t.includes("sponsors/"))return`${ke.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${ke.defaults.baseURL}/${s}?token=${r}`:`${ke.defaults.baseURL}/${s}`},Cv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},_a=e=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Av=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);if(r<s){const a=s.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} until start`,count:o,isPast:!1}}else if(r>i){const a=r.getTime()-i.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} since end`,count:o,isPast:!0}}else{const a=i.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} remaining`,count:o,isPast:!1}}},Iv=()=>{const{id:e}=Dr(),t=tt(),[r,s]=_.useState(null),[i,a]=_.useState(!0),[o,l]=_.useState(null),[d,c]=_.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(_.useEffect(()=>{(async()=>{try{if(!e){l("Exhibition ID is missing");return}a(!0),l(null);const g=await Fr.getExhibition(e);if(s(g.data),g.data.headerBackground){const x=Dl(g.data.headerBackground);c(x);const m=new window.Image;m.src=x}else if(g.data.headerLogo){const x=Dl(g.data.headerLogo),m=new window.Image;m.src=x}}catch(g){console.error("Error fetching exhibition:",g),l(g.message||"Error fetching exhibition")}finally{a(!1)}})()},[e]),i)return n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Rl,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Vt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(o||!r)return n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Rl,{style:{paddingTop:"64px"},children:n.jsx(Li,{status:"404",title:"Exhibition not found",subTitle:o||"The exhibition you're looking for doesn't exist or has been removed.",extra:n.jsx(re,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:h,color:f}=Cv(r.startDate,r.endDate),u=Av(r.startDate,r.endDate);return n.jsxs(Nt,{className:"exhibition-details-layout",children:[n.jsx(Kr,{}),n.jsxs(Rl,{className:"exhibition-content",children:[n.jsx("div",{className:"breadcrumb-container",children:n.jsx(Ux,{items:[{title:n.jsx(Nr,{to:"/",children:n.jsx(jc,{})})},{title:n.jsx(Nr,{to:"/exhibitions",children:"Exhibitions"})},{title:r.name}]})}),n.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${d}')`},children:n.jsx("div",{className:"hero-overlay",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("div",{className:"hero-main",children:[n.jsx(Pl,{level:1,className:"exhibition-title",children:r.name}),n.jsxs(ue,{size:24,className:"exhibition-meta",children:[n.jsxs("div",{className:"meta-item",children:[n.jsx(Yr,{}),n.jsxs(Zn,{children:[_a(r.startDate)," - ",_a(r.endDate)]})]}),r.venue&&n.jsxs("div",{className:"meta-item",children:[n.jsx(os,{}),n.jsx(Zn,{children:r.venue})]}),n.jsxs("div",{className:"meta-item",children:[n.jsx(Qt,{}),n.jsxs(Zn,{children:[u.text,": ",n.jsx("strong",{children:u.count})]})]})]})]}),n.jsxs("div",{className:"hero-actions",children:[n.jsx(re,{type:"primary",size:"large",icon:n.jsx(xs,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),n.jsx(re,{size:"large",icon:n.jsx(wr,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button book-button",children:"Book a Stall"}),u.isPast?null:n.jsx(re,{size:"large",icon:n.jsx(bc,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),n.jsx("div",{className:"stats-container",children:n.jsxs(Ne,{gutter:[16,16],className:"stats-row",children:[n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon duration-icon",children:n.jsx(Yr,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:Math.ceil((new Date(r.endDate).getTime()-new Date(r.startDate).getTime())/(1e3*60*60*24))}),n.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon countdown-icon",children:n.jsx(Qt,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:u.count}),n.jsx("div",{className:"stat-label",children:u.text})]})]})}),n.jsx(Q,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:f+"20",color:f},children:n.jsx(Gt,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value status-value",style:{color:f},children:h}),n.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),r.sponsorLogos&&r.sponsorLogos.length>0&&n.jsxs("div",{className:"sponsors-section",children:[n.jsx("div",{className:"sponsors-header",children:n.jsx(Zn,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),n.jsx("div",{className:"sponsors-container",children:r.sponsorLogos.map((p,g)=>n.jsx("div",{className:"sponsor-logo-wrapper",children:n.jsx("div",{className:"sponsor-logo",children:n.jsx("img",{src:Dl(p),alt:`Sponsor ${g+1}`,className:"sponsor-logo-img",onError:x=>{x.target.src="/placeholder-logo.png"}})})},g))})]}),n.jsx("div",{className:"exhibition-details-container",children:n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,lg:16,children:n.jsxs(de,{className:"details-card about-card",bordered:!1,children:[n.jsx(Pl,{level:3,className:"section-title",children:"About This Exhibition"}),n.jsx(vh,{className:"main-description",children:r.description}),r.headerDescription&&n.jsx(vh,{className:"extended-description",children:r.headerDescription}),r.headerSubtitle&&n.jsxs("div",{className:"subtitle-section",children:[n.jsx(Pl,{level:4,children:r.headerSubtitle}),n.jsx(it,{})]})]})}),n.jsx(Q,{xs:24,lg:8,children:n.jsx(ue,{direction:"vertical",style:{width:"100%"},size:24,children:n.jsx(de,{title:"Key Information",className:"details-card info-card",bordered:!1,children:n.jsxs("div",{className:"info-grid",children:[n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon start-icon",children:n.jsx(Yr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(Zn,{type:"secondary",className:"info-label",children:"Start Date"}),n.jsx("div",{className:"info-value",children:_a(r.startDate)})]})]}),n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon end-icon",children:n.jsx(Yr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(Zn,{type:"secondary",className:"info-label",children:"End Date"}),n.jsx("div",{className:"info-value",children:_a(r.endDate)})]})]}),r.venue&&n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon venue-icon",children:n.jsx(os,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(Zn,{type:"secondary",className:"info-label",children:"Venue"}),n.jsx("div",{className:"info-value",children:r.venue})]})]})]})})})})]})})]}),n.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:Nv}=Nt,{Title:Fv,Paragraph:Rv,Text:Pv}=Me,Dv=Ee(Nv)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Lv=Ee.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,ka=Ee(Fv)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Ov=Ee.div`
  margin-bottom: 20px;
`,Bv=Ee.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,en=Ee(Nr)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,Ll=Ee.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,Ol=Ee.div`
  margin-right: 10px;
  color: #4158D0;
`,Ca=Ee.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Mv=Ee(he)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,$v=Ee(re)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Uv=Ee(Pv)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,zv=Ee(it)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,bf=()=>{const[e,t]=_.useState("/logo.png"),[r,s]=_.useState("Exhibition Manager"),i=new Date().getFullYear();return _.useEffect(()=>{const a=`${ke.defaults.baseURL}/public/logo`;t(a),fetch(`${ke.defaults.baseURL}/public/site-info`).then(o=>o.json()).then(o=>{o.siteName&&s(o.siteName)}).catch(o=>{console.error("Error fetching site info:",o)})},[]),n.jsx(Dv,{children:n.jsxs(Lv,{children:[n.jsxs(Ne,{gutter:[48,40],children:[n.jsxs(Q,{xs:24,sm:24,md:8,lg:7,children:[n.jsx(Ov,{children:n.jsx(Nr,{to:"/",children:n.jsx(Bv,{src:e,alt:r,onError:()=>t("/logo.png")})})}),n.jsx(Rv,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),n.jsxs(ue,{children:[n.jsx(Ca,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(zx,{})}),n.jsx(Ca,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(qx,{})}),n.jsx(Ca,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Wx,{})}),n.jsx(Ca,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Hx,{})})]})]}),n.jsxs(Q,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(ka,{level:4,children:"Quick Links"}),n.jsx(en,{to:"/exhibitions",children:"Exhibitions"}),n.jsx(en,{to:"/about",children:"About Us"}),n.jsx(en,{to:"/contact",children:"Contact Us"}),n.jsx(en,{to:"/privacy-policy",children:"Privacy Policy"}),n.jsx(en,{to:"/terms",children:"Terms & Conditions"})]}),n.jsxs(Q,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(ka,{level:4,children:"For Exhibitors"}),n.jsx(en,{to:"/exhibitor/login",children:"Login"}),n.jsx(en,{to:"/exhibitor/register",children:"Register"}),n.jsx(en,{to:"/exhibitor/dashboard",children:"Dashboard"}),n.jsx(en,{to:"/exhibitor/bookings",children:"My Bookings"}),n.jsx(en,{to:"/faq",children:"FAQ"})]}),n.jsxs(Q,{xs:24,sm:24,md:6,lg:7,children:[n.jsx(ka,{level:4,children:"Contact Us"}),n.jsxs(Ll,{children:[n.jsx(Ol,{children:n.jsx(os,{})}),n.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),n.jsxs(Ll,{children:[n.jsx(Ol,{children:n.jsx(Sc,{})}),n.jsx("div",{children:"+91 98765 43210"})]}),n.jsxs(Ll,{children:[n.jsx(Ol,{children:n.jsx(fn,{})}),n.jsx("div",{children:"info@exhibitionmanager.com"})]}),n.jsxs("div",{style:{marginTop:24},children:[n.jsx(ka,{level:4,children:"Newsletter"}),n.jsx(W,{children:n.jsxs(ue.Compact,{style:{width:"100%"},children:[n.jsx(Mv,{placeholder:"Your email address"}),n.jsx($v,{type:"primary",icon:n.jsx(Vx,{}),children:"Subscribe"})]})})]})]})]}),n.jsx(zv,{}),n.jsxs(Uv,{children:[" ",i," ",r,". All rights reserved."]})]})})},{Title:bh,Text:Bl,Paragraph:wh}=Me,{Content:Ml}=Nt,qv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},jh=e=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Wv=e=>{const t=new Date,s=new Date(e).getTime()-t.getTime();return Math.ceil(s/(1e3*60*60*24))},Sh=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e,r=t.includes("logos/")?t:`logos/${t}`;return`${ke.defaults.baseURL}/public/images/${r}`},Hv=()=>{const e=tt(),[t,r]=_.useState([]),[s,i]=_.useState(!0),[a,o]=_.useState(null),[l,d]=_.useState({});return _.useEffect(()=>{(async()=>{try{i(!0),o(null);const h=await Fr.getExhibitions();r(h.data);const f={};h.data.forEach(u=>{if(u.headerLogo){const p=Sh(u.headerLogo),g=new window.Image;g.onload=()=>{f[u._id]=!0,d(x=>({...x,[u._id]:!0}))},g.onerror=()=>{console.warn(`Failed to preload image: ${p}`),f[u._id]=!1,d(x=>({...x,[u._id]:!1}))},g.src=p}})}catch(h){o(h.message||"Failed to fetch exhibitions")}finally{i(!1)}})()},[]),s?n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ml,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Vt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):a?n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ml,{style:{paddingTop:"64px"},children:n.jsx(Li,{status:"error",title:"Failed to load exhibitions",subTitle:a,extra:[n.jsx(re,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsx(Ml,{style:{paddingTop:"64px",background:"#f5f5f5"},children:n.jsxs("div",{style:{padding:"80px 16px"},children:[n.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[n.jsx(bh,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),n.jsx(wh,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?n.jsx(Ne,{gutter:[24,24],children:t.map(c=>{const{status:h,color:f}=qv(c.startDate,c.endDate),u=Wv(c.startDate),p=c.headerLogo?Sh(c.headerLogo):void 0;return n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(de,{hoverable:!0,onClick:()=>e(Ho(c)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[n.jsx(gr.Ribbon,{text:h,color:f,style:{right:"-1px",top:"10px",zIndex:2}}),n.jsxs("div",{className:"exhibition-card-container",children:[n.jsx("div",{className:"exhibition-card-logo-container",children:p&&n.jsx("div",{className:"exhibition-logo",children:n.jsx(Tu,{src:p,alt:`${c.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:n.jsx(Vt,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsxs("div",{className:"exhibition-card-content",children:[n.jsx("div",{className:"exhibition-title",children:n.jsx(bh,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:c.name})}),n.jsx(wh,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:c.description}),n.jsxs("div",{className:"exhibition-card-details",children:[n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Yr,{style:{color:"#722ED1"}}),n.jsx(Ke,{title:"Exhibition Date Range",children:n.jsxs(Bl,{style:{fontSize:14},children:[jh(c.startDate)," - ",jh(c.endDate)]})})]}),c.venue&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(os,{style:{color:"#F5222D"}}),n.jsx(Ke,{title:"Venue",children:n.jsx(Bl,{style:{fontSize:14},ellipsis:!0,children:c.venue})})]}),h==="Upcoming"&&u>0&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Qt,{style:{color:"#1890FF"}}),n.jsx(Ke,{title:"Time Remaining",children:n.jsxs(Bl,{style:{fontSize:14},children:["Starts in ",u," day",u!==1?"s":""]})})]})]}),n.jsx("div",{className:"exhibition-card-footer",children:n.jsxs(re,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",n.jsx(ec,{})]})})]})]})]})},c._id)})}):n.jsx(bt,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:bt.PRESENTED_IMAGE_SIMPLE})]})}),n.jsx(bf,{}),n.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},Vv=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=tt(),{currentExhibition:i}=qe(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>s(Bt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Gv=()=>{var U,M,L;const{message:e}=Zt.useApp(),{id:t}=Dr(),r=Fn(),s=tt(),i=lt(),[a,o]=hp(),l=((U=r.state)==null?void 0:U.exhibitionId)||t,{currentExhibition:d,halls:c,stalls:h,loading:f}=qe(z=>z.exhibition),u=_.useRef(null),[p,g]=_.useState(!1),[x,m]=_.useState(null),[v,S]=_.useState(null),[T,y]=_.useState({width:0,height:0}),[w,k]=_.useState(!1);_.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibitions");return}},[l,s,e]),_.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibition");return}(async()=>{try{await i($r(l)).unwrap(),await i(un(l)).unwrap(),k(!0)}catch{e.error("Failed to load data")}})()},[l,i,s]),_.useEffect(()=>{var z,J;!w||!d||(!((z=d.dimensions)!=null&&z.width)||!((J=d.dimensions)!=null&&J.height))&&(e.info("Please set up exhibition space first"),s(Bt(d,"space"),{state:{exhibitionId:l}}))},[d,l,s,w]),_.useEffect(()=>{!w||f||c.length===0&&(e.info("Please create halls first"),s(Bt(d,"halls"),{state:{exhibitionId:l}}))},[c,l,s,f,w]),_.useEffect(()=>{w&&d&&c.length>0&&(async()=>{try{const J=c.map(ne=>i(dn({exhibitionId:l,hallId:ne.id})).unwrap());await Promise.all(J)}catch(J){console.error("Error fetching stalls:",J),e.error("Failed to load stalls")}})()},[d,l,c,i,w]);const b=h.filter(z=>z.hallId===((x==null?void 0:x.id)||(x==null?void 0:x._id)));_.useEffect(()=>{if(!w||c.length===0)return;const z=a.get("hallId");if(z){const J=c.find(ne=>ne.id===z||ne._id===z);if(J)m(J);else if(c.length>0){m(c[0]);const ne=c[0].id||c[0]._id;ne&&o({hallId:ne.toString()})}}else if(c.length>0){m(c[0]);const J=c[0].id||c[0]._id;J&&o({hallId:J.toString()})}},[c,a,w,o]),_.useEffect(()=>{const z=()=>{if(u.current){const{clientWidth:ne,clientHeight:te}=u.current;y({width:Math.max(ne||400,400),height:Math.max(te||400,400)})}};z();const J=new ResizeObserver(z);return u.current&&J.observe(u.current),window.addEventListener("resize",z),()=>{J.disconnect(),window.removeEventListener("resize",z)}},[]);const j=()=>{if(!x){e.warning("Please select a hall first");return}S(null),g(!0)},A=z=>{if(m(z),S(null),z){const J=z.id||z._id;o(J?{hallId:J.toString()}:{})}else o({})},E=z=>{var ne;const J=z?{...z,id:z.id||z._id,_id:z._id||z.id,stallTypeId:typeof z.stallTypeId=="string"?z.stallTypeId:((ne=z.stallTypeId)==null?void 0:ne._id)||z.stallTypeId,stallType:z.stallType}:null;console.log("Selected stall data:",J),S(J),g(!!J)},C=async z=>{var J,ne;try{if(!(x!=null&&x.id)&&!(x!=null&&x._id)){e.error("No hall selected");return}const te=x.id,P=x._id||x.id;if(z.hallId&&z.hallId!==P){e.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",z),z.id||z._id){const H={...z,id:z.id,_id:z._id,hallId:P,stallTypeId:z.stallTypeId};console.log("Update data:",H);const B=z.id||z._id;if(!B)throw new Error("Stall ID is missing");await wt.updateStall(l,B,H),e.success("Stall updated successfully")}else{const{id:H,_id:B,...R}=z,K={...R,hallId:P,stallTypeId:z.stallTypeId};console.log("Creating new stall with data:",K),await wt.createStall(l,K),e.success("Stall created successfully")}g(!1),i(dn({exhibitionId:l,hallId:te}))}catch(te){console.error("Error saving stall:",te),e.error(((ne=(J=te.response)==null?void 0:J.data)==null?void 0:ne.message)||"Failed to save stall")}},I=async z=>{var J,ne;try{if(!l){e.error("Exhibition ID not found");return}const te=x;if(!te){e.error("No hall selected");return}const P=te.id||te._id;if(!P){e.error("Invalid hall ID");return}await wt.deleteStall(l,z),g(!1),S(null),await i(dn({exhibitionId:l,hallId:P})).unwrap(),e.success("Stall deleted successfully")}catch(te){console.error("Error deleting stall:",te),e.error(((ne=(J=te.response)==null?void 0:J.data)==null?void 0:ne.message)||"Failed to delete stall")}},F=async z=>{var P,H;if(!l){e.error("Exhibition ID not found");return}const J=z.id||z._id;if(!J){console.error("Stall data:",z),e.error("Stall ID not found");return}if(!(x!=null&&x.id)&&!(x!=null&&x._id)){e.error("No hall selected");return}const ne=x.id,te=x._id||x.id;try{await wt.updateStall(l,J,{...z,id:J,hallId:te}),i(dn({exhibitionId:l,hallId:ne}))}catch(B){console.error("Stall update error:",B),e.error(((H=(P=B.response)==null?void 0:P.data)==null?void 0:H.message)||"Failed to update stall position")}},N=()=>{g(!1),S(null)};return n.jsx(Ji,{children:n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[n.jsx("div",{style:{padding:"24px 24px 0"},children:n.jsx(Vv,{exhibitionId:l})}),n.jsx(de,{title:"Stall Manager",extra:n.jsxs(ue,{children:[n.jsx(re,{icon:n.jsx(Eu,{}),onClick:()=>s(`/exhibition/${l}`,{state:{exhibitionId:l}}),children:"Back to Exhibition"}),n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),onClick:j,disabled:!x,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:n.jsx("div",{ref:u,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:d&&n.jsx(Zi,{width:T.width,height:T.height,exhibitionWidth:((M=d.dimensions)==null?void 0:M.width)||100,exhibitionHeight:((L=d.dimensions)==null?void 0:L.height)||100,halls:c,selectedHall:x,onSelectHall:A,isStallMode:!0,children:x&&b.map(z=>n.jsx(zc,{stall:z,isSelected:(v==null?void 0:v.id)===z.id||(v==null?void 0:v._id)===z._id,onSelect:()=>E(z),onChange:F,hallWidth:x.dimensions.width,hallHeight:x.dimensions.height,hallX:x.dimensions.x,hallY:x.dimensions.y},z.id||z._id))})})}),d&&n.jsx(qy,{visible:p,stall:v,hall:x,exhibition:d,onCancel:N,onSubmit:C,onDelete:v?()=>I(v.id||v._id):void 0})]})})},Yv=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=tt(),{currentExhibition:i}=qe(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>s(Bt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Kv=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],Xv=()=>{var C,I,F;const{message:e}=Zt.useApp(),{id:t}=Dr(),r=Fn(),s=tt(),i=lt(),a=((C=r.state)==null?void 0:C.exhibitionId)||t,{currentExhibition:o,fixtures:l,halls:d,stalls:c,loading:h}=qe(N=>N.exhibition),f=_.useRef(null),[u,p]=_.useState(!1),[g,x]=_.useState(null),[m,v]=_.useState({width:0,height:0}),[S,T]=_.useState("all"),[y,w]=_.useState([]);_.useEffect(()=>{if(!a){e.error("Exhibition ID not found"),s("/exhibitions");return}},[a,s,e]),_.useEffect(()=>{(async()=>{try{await i($r(a)).unwrap(),await i(Si({exhibitionId:a})).unwrap(),await i(un(a)).unwrap(),await i(dn({exhibitionId:a})).unwrap()}catch{e.error("Failed to load data")}})()},[a,i,e]),_.useEffect(()=>{w(S==="all"?l:l.filter(N=>N.type===S))},[l,S]),_.useEffect(()=>{const N=()=>{if(f.current){const{clientWidth:M,clientHeight:L}=f.current;v({width:Math.max(M||400,400),height:Math.max(L||400,400)})}};N();const U=new ResizeObserver(N);return f.current&&U.observe(f.current),window.addEventListener("resize",N),()=>{U.disconnect(),window.removeEventListener("resize",N)}},[]);const k=()=>{x(null),p(!0)},b=N=>{x(N),p(!!N)},j=async N=>{try{N.id||N._id?(await i(so({exhibitionId:a,id:N.id||N._id||"",data:N})).unwrap(),e.success("Fixture updated successfully")):(await i(no({exhibitionId:a,data:N})).unwrap(),e.success("Fixture created successfully")),await i(Si({exhibitionId:a})).unwrap(),p(!1)}catch(U){console.error("Failed to save fixture:",U),e.error(U.message||"Failed to save fixture")}},A=async N=>{try{const U=N.id||N._id;if(!U)throw new Error("Fixture ID is required");await i(io({exhibitionId:a,id:U})).unwrap(),e.success("Fixture deleted successfully"),p(!1),x(null)}catch(U){console.error("Failed to delete fixture:",U),e.error(U.message||"Failed to delete fixture")}},E=N=>{T(N)};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(Yv,{exhibitionId:a}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(ue,{children:n.jsx("span",{children:"Fixture Management"})}),n.jsxs(ue,{children:[n.jsx(Le,{style:{width:180},value:S,onChange:E,options:Kv}),n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),onClick:k,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[n.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),n.jsx("div",{ref:f,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Ji,{children:m.width>0&&m.height>0&&(o==null?void 0:o.dimensions)&&n.jsx(Zi,{width:m.width,height:m.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:d,stalls:c,fixtures:y,selectedFixture:g,onSelectFixture:b,onFixtureChange:j,onAddFixture:k,isFixtureMode:!0})})})]}),n.jsx(Yy,{visible:u,fixture:g,onCancel:()=>p(!1),onSubmit:j,onDelete:A,exhibitionWidth:((I=o==null?void 0:o.dimensions)==null?void 0:I.width)||100,exhibitionHeight:((F=o==null?void 0:o.dimensions)==null?void 0:F.height)||100})]})},{Title:Qv,Text:Jv}=Me,{Option:ks}=Le,Zv=()=>{const e=tt(),t=lt(),{stalls:r,loading:s}=qe(M=>M.exhibition),[i,a]=_.useState([]),[o,l]=_.useState([]),[d,c]=_.useState(null),[h,f]=_.useState(null),[u,p]=_.useState(!1),g=xt.useMemo(()=>Math.max(...r.map(M=>M.ratePerSqm*M.dimensions.width*M.dimensions.height),1e6),[r]),x=xt.useMemo(()=>{const M=Math.pow(10,Math.floor(Math.log10(g)));return Math.ceil(g/M)*M},[g]),[m,v]=_.useState(""),[S,T]=_.useState(null),[y,w]=_.useState([0,x]),[k,b]=_.useState("number"),[j,A]=_.useState("ascend"),E=M=>{c(M),f(null),t({type:"exhibition/clearStalls"})},C=M=>{f(M),t(d&&M?dn({exhibitionId:d,hallId:M}):{type:"exhibition/clearStalls"})};_.useEffect(()=>{(async()=>{try{p(!0),console.log("Fetching exhibitions...");const L=await wt.getActiveExhibitions();console.log("Exhibitions response:",L.data),a(L.data)}catch(L){console.error("Failed to fetch exhibitions:",L)}finally{p(!1)}})()},[]),_.useEffect(()=>{d?(async()=>{try{p(!0),console.log("Fetching halls for exhibition:",d);const L=await wt.getHalls(d);console.log("Halls response:",L.data),l(L.data)}catch(L){console.error("Failed to fetch halls:",L)}finally{p(!1)}})():l([])},[d]);const I=xt.useMemo(()=>{console.log("Filtering stalls from Redux:",r);const M=r.filter(L=>{const z=!m||L.number.toLowerCase().includes(m.toLowerCase()),J=!S||L.status===S,ne=!h||L.hallId===h,te=L.ratePerSqm*L.dimensions.width*L.dimensions.height,P=te>=y[0]&&te<=y[1];return z&&J&&ne&&P}).sort((L,z)=>k==="number"?j==="ascend"?L.number.localeCompare(z.number):z.number.localeCompare(L.number):0);return console.log("Filtered stalls:",M),M},[r,m,S,h,y,k,j]),F=M=>{switch(M){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},U=(M=>{const L=M.reduce((z,J)=>{var ne,te;return(ne=J==null?void 0:J.dimensions)!=null&&ne.width&&((te=J==null?void 0:J.dimensions)!=null&&te.height)?z+J.dimensions.width*J.dimensions.height:z},0);return{totalStalls:M.length,totalSize:L}})(I);return n.jsx("div",{className:"dashboard-container",children:n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{span:24,children:n.jsxs(ue,{direction:"vertical",size:4,style:{width:"100%"},children:[n.jsx(Qv,{level:4,style:{margin:0},children:"Stalls"}),n.jsx(Jv,{type:"secondary",children:"Manage your exhibition stalls"})]})}),n.jsx(Q,{span:24,children:n.jsxs(Ne,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(Le,{style:{width:"100%"},placeholder:"Select Exhibition",value:d,onChange:E,allowClear:!0,children:i.map(M=>n.jsx(ks,{value:M._id||M.id,children:M.name},M._id||M.id))})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(Le,{style:{width:"100%"},placeholder:"Select Hall",value:h,onChange:C,disabled:!d||o.length===0,allowClear:!0,children:o.map(M=>n.jsx(ks,{value:M._id||M.id,children:M.name},M._id||M.id))})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(he,{placeholder:"Search by stall number",prefix:n.jsx(An,{}),value:m,onChange:M=>v(M.target.value),allowClear:!0})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(Le,{style:{width:"100%"},placeholder:"Filter by status",value:S,onChange:T,allowClear:!0,children:[n.jsx(ks,{value:"available",children:"Available"}),n.jsx(ks,{value:"booked",children:"Booked"}),n.jsx(ks,{value:"reserved",children:"Reserved"}),n.jsx(ks,{value:"sold",children:"Sold"})]})})]})}),n.jsx(Q,{span:24,children:n.jsx(de,{size:"small",children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{xs:12,sm:12,md:6,children:n.jsx(Ze,{title:"Total Stalls",value:U.totalStalls,prefix:n.jsx(Gx,{})})}),n.jsx(Q,{xs:12,sm:12,md:6,children:n.jsx(Ze,{title:"Total Area",value:U.totalSize,suffix:"sqm",prefix:n.jsx(xs,{}),precision:2})})]})})}),n.jsx(Q,{span:24,children:n.jsx(de,{size:"small",title:"Price Range Filter",children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:24,style:{marginBottom:16},children:n.jsxs(ue,{children:[n.jsx(re,{size:"small",onClick:()=>w([0,5e5]),children:"Under 5L"}),n.jsx(re,{size:"small",onClick:()=>w([5e5,1e6]),children:"5L - 10L"}),n.jsx(re,{size:"small",onClick:()=>w([1e6,2e6]),children:"10L - 20L"}),n.jsx(re,{size:"small",onClick:()=>w([2e6,x]),children:"Above 20L"}),n.jsx(re,{size:"small",onClick:()=>w([0,x]),children:"All"})]})}),n.jsx(Q,{span:16,children:n.jsx(Su,{range:!0,min:0,max:x,value:y,onChange:M=>w(M),step:Math.max(1e3,Math.floor(x/1e3)),tooltip:{formatter:M=>`${(M||0).toLocaleString()}`}})}),n.jsx(Q,{span:4,children:n.jsx(jt,{style:{width:"100%"},min:0,max:y[1],value:y[0],onChange:M=>w([M||0,y[1]]),formatter:M=>` ${M}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:M=>M?Number(M.replace(/[^\d.-]/g,"")):0,step:1e3})}),n.jsx(Q,{span:4,children:n.jsx(jt,{style:{width:"100%"},min:y[0],max:x,value:y[1],onChange:M=>w([y[0],M||x]),formatter:M=>` ${M}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:M=>M?Number(M.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),n.jsx(Q,{span:24,children:n.jsx(st,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(M,L)=>M.number.localeCompare(L.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(M,L)=>{var z;return((z=L.stallType)==null?void 0:z.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:M=>M?`${M.toLocaleString()}`:"N/A",sorter:(M,L)=>(M.ratePerSqm||0)-(L.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(M,L)=>{var z,J;return(z=L==null?void 0:L.dimensions)!=null&&z.width&&((J=L==null?void 0:L.dimensions)!=null&&J.height)?`${L.dimensions.width*L.dimensions.height} sqm`:"N/A"},sorter:(M,L)=>{var ne,te,P,H;const z=(((ne=M.dimensions)==null?void 0:ne.width)||0)*(((te=M.dimensions)==null?void 0:te.height)||0),J=(((P=L.dimensions)==null?void 0:P.width)||0)*(((H=L.dimensions)==null?void 0:H.height)||0);return z-J}},{title:"Dimensions",key:"dimensions",render:(M,L)=>{var z,J;return(z=L==null?void 0:L.dimensions)!=null&&z.width&&((J=L==null?void 0:L.dimensions)!=null&&J.height)?`${L.dimensions.width}m  ${L.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(M,L)=>{var z,J;return(z=L==null?void 0:L.dimensions)!=null&&z.width&&((J=L==null?void 0:L.dimensions)!=null&&J.height)&&L.ratePerSqm?`${(L.ratePerSqm*L.dimensions.width*L.dimensions.height).toLocaleString()}`:"N/A"},sorter:(M,L)=>{var ne,te,P,H;const z=(M.ratePerSqm||0)*(((ne=M.dimensions)==null?void 0:ne.width)||0)*(((te=M.dimensions)==null?void 0:te.height)||0),J=(L.ratePerSqm||0)*(((P=L.dimensions)==null?void 0:P.width)||0)*(((H=L.dimensions)==null?void 0:H.height)||0);return z-J}},{title:"Status",dataIndex:"status",key:"status",render:M=>n.jsx(_e,{color:F(M),style:{textTransform:"capitalize"},children:M||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(M,L)=>L.status===M},{title:"Actions",key:"actions",render:(M,L)=>n.jsxs(ue,{children:[n.jsx("a",{onClick:()=>e(`/stall/edit/${L._id||L.id}`),children:"Edit"}),n.jsx("a",{onClick:()=>e(`/stall/view/${L._id||L.id}`),children:"View"})]})}],dataSource:I,rowKey:M=>M._id||M.id,loading:u||s,pagination:{total:I.length,pageSize:10,showSizeChanger:!0,showTotal:M=>`Total ${M} stalls`},onChange:(M,L,z)=>{z.field&&(b(z.field),A(z.order))}})})]})})})},{Title:eb,Text:tb}=Me,{TextArea:rb}=he,{Search:nb}=he,{Option:Eh}=Le,sb=()=>{tt();const{message:e}=Zt.useApp(),[t,r]=_.useState(!1),[s]=W.useForm(),[i,a]=_.useState(!1),[o,l]=_.useState([]),[d,c]=_.useState(!1),[h,f]=_.useState(null);_.useEffect(()=>{u()},[]),_.useEffect(()=>{var S;if(console.log("Modal visibility changed:",t),console.log("Editing stall type:",h),t&&h){const T=((S=h.features)==null?void 0:S.map(y=>y.feature).join(", "))||"";console.log("Setting form values:",{name:h.name,description:h.description,features:T,status:h.status}),setTimeout(()=>{s.setFieldsValue({name:h.name,description:h.description,features:T,status:h.status})},0)}else t&&(s.resetFields(),s.setFieldsValue({status:"active"}))},[h,s,t]);const u=async()=>{try{c(!0);const S=await ss.getStallTypes();l(S.data)}catch(S){e.error("Failed to fetch stall types: "+S.message)}finally{c(!1)}},p=async S=>{try{a(!0),console.log("Form values:",S);const T={name:S.name,description:S.description,status:S.status,features:S.features?S.features.split(",").map(y=>({feature:y.trim()})):[]};console.log("Submitting data:",T),h?(await ss.updateStallType(h._id,T),e.success("Stall type updated successfully")):(await ss.createStallType(T),e.success("Stall type created successfully")),r(!1),f(null),s.resetFields(),u()}catch(T){e.error(`Failed to ${h?"update":"create"} stall type: `+T.message)}finally{a(!1)}},g=S=>{console.log("Editing stall type:",S),f(S),r(!0)},x=async S=>{try{await ss.deleteStallType(S._id),e.success("Stall type deleted successfully"),u()}catch(T){e.error("Failed to delete stall type: "+T.message)}},m=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(S,T)=>S.name.localeCompare(T.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:S=>n.jsx(ue,{wrap:!0,children:S==null?void 0:S.map(({feature:T})=>n.jsx(_e,{children:T},T))})},{title:"Status",dataIndex:"status",key:"status",render:S=>n.jsx(_e,{color:S==="active"?"success":"default",children:S.toUpperCase()})},{title:"Actions",key:"actions",render:(S,T)=>n.jsxs(ue,{children:[n.jsx(re,{type:"link",onClick:()=>g(T),children:"Edit"}),n.jsx(re,{type:"link",danger:!0,onClick:()=>x(T),children:"Delete"})]})}],v=()=>{r(!1),f(null),s.resetFields()};return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ne,{justify:"space-between",align:"middle",children:[n.jsx(Q,{children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(eb,{level:4,style:{margin:0},children:"Stall Types"}),n.jsx(tb,{type:"secondary",children:"Manage your stall types and configurations"})]})}),n.jsx(Q,{children:n.jsxs(ue,{children:[n.jsx(nb,{placeholder:"Search stall types",style:{width:200},onSearch:S=>console.log(S)}),n.jsx(re,{type:"primary",icon:n.jsx(mr,{}),onClick:()=>r(!0),children:"Add Stall Type"})]})})]})}),n.jsx(de,{className:"info-card",children:n.jsx(st,{columns:m,dataSource:o,rowKey:S=>S._id,loading:d})}),n.jsx(Ye,{title:h?"Edit Stall Type":"Add Stall Type",open:t,onCancel:v,footer:null,destroyOnClose:!1,children:n.jsxs(W,{form:s,layout:"vertical",onFinish:p,initialValues:{status:"active"},preserve:!0,children:[n.jsx(W.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:n.jsx(he,{placeholder:"e.g., 1 Side Open"})}),n.jsx(W.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(rb,{rows:4,placeholder:"Enter description"})}),n.jsx(W.Item,{name:"features",label:"Features",children:n.jsx(he,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),n.jsx(W.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Le,{children:[n.jsx(Eh,{value:"active",children:"Active"}),n.jsx(Eh,{value:"inactive",children:"Inactive"})]})}),n.jsx(W.Item,{children:n.jsxs(re,{type:"primary",htmlType:"submit",loading:i,block:!0,children:[h?"Update":"Create"," Stall Type"]})})]})})]})},ib={bookings:[],currentBooking:null,loading:!1,statsLoading:!1,error:null,pagination:{total:0,page:1,limit:10,pages:0},stats:{total:0,pending:0,approved:0,rejected:0,confirmed:0,cancelled:0,totalRevenue:0,totalBaseAmount:0}},Ti=et("booking/fetchBookings",async(e={},{rejectWithValue:t})=>{var r,s;try{const i={};return e.page&&(i.page=e.page),e.limit&&(i.limit=e.limit),(await ke.get("/bookings",{params:i})).data}catch(i){return t(((s=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch bookings")}}),$l=et("booking/fetchBooking",async e=>(await ke.get(`/bookings/${e}`)).data),ao=et("booking/createBooking",async e=>(await ke.post("/bookings",e)).data),oo=et("booking/updateStatus",async({id:e,status:t,rejectionReason:r})=>(await ke.patch(`/bookings/${e}`,{status:t,...r&&{rejectionReason:r}})).data),Ul=et("booking/updatePaymentStatus",async({id:e,paymentStatus:t,paymentDetails:r})=>(await ke.patch(`/bookings/${e}/payment`,{paymentStatus:t,paymentDetails:r})).data),lo=et("booking/deleteBooking",async e=>(await ke.delete(`/bookings/${e}`),e)),co=et("booking/fetchBookingStats",async(e,{rejectWithValue:t})=>{var r,s;try{return(await ke.get("/bookings/stats")).data}catch(i){return t(((s=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch booking statistics")}}),wf=br({name:"booking",initialState:ib,reducers:{clearCurrentBooking:e=>{e.currentBooking=null},clearBookingError:e=>{e.error=null}},extraReducers:e=>{e.addCase(Ti.pending,t=>{t.loading=!0,t.error=null}).addCase(Ti.fulfilled,(t,r)=>{t.loading=!1,t.bookings=r.payload.data||[],r.payload.pagination&&(t.pagination=r.payload.pagination)}).addCase(Ti.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch bookings"}).addCase($l.pending,t=>{t.loading=!0,t.error=null}).addCase($l.fulfilled,(t,r)=>{t.loading=!1,t.currentBooking=r.payload}).addCase($l.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch booking"}).addCase(ao.pending,t=>{t.loading=!0,t.error=null}).addCase(ao.fulfilled,(t,r)=>{t.loading=!1,t.bookings.unshift(r.payload),t.currentBooking=r.payload}).addCase(ao.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to create booking"}).addCase(oo.pending,t=>{t.loading=!0,t.error=null}).addCase(oo.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(oo.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update booking status"}).addCase(Ul.pending,t=>{t.loading=!0,t.error=null}).addCase(Ul.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(Ul.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update payment status"}).addCase(co.pending,t=>{t.statsLoading=!0,t.error=null}).addCase(co.fulfilled,(t,r)=>{t.statsLoading=!1,t.stats=r.payload}).addCase(co.rejected,(t,r)=>{t.statsLoading=!1,t.error=r.error.message||"Failed to fetch booking statistics"}).addCase(lo.pending,t=>{t.loading=!0,t.error=null}).addCase(lo.fulfilled,(t,r)=>{var s;t.loading=!1,t.bookings=t.bookings.filter(i=>i._id!==r.payload),((s=t.currentBooking)==null?void 0:s._id)===r.payload&&(t.currentBooking=null)}).addCase(lo.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:pk,clearBookingError:mk}=wf.actions,ab=wf.reducer,ob="/api",ho=Uc({reducerPath:"invoiceApi",baseQuery:Oc({baseUrl:ob,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["Invoice"],endpoints:e=>({getInvoices:e.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:e.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,r,s)=>[{type:"Invoice",id:s}]}),downloadInvoice:e.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:r})})})}),{useGetInvoicesQuery:Vo,useGetInvoiceQuery:lb,useShareViaEmailMutation:cb}=ho,db=({bookings:e,paginationTotal:t,stats:r,statsLoading:s=!1})=>{const a=r||{total:t!==void 0?t:e.length,pending:e.filter(l=>l.status==="pending").length,approved:e.filter(l=>l.status==="approved").length,rejected:e.filter(l=>l.status==="rejected").length,confirmed:e.filter(l=>l.status==="confirmed").length,cancelled:e.filter(l=>l.status==="cancelled").length,totalRevenue:e.filter(l=>l.status==="confirmed"||l.status==="approved").reduce((l,d)=>l+d.amount,0),totalBaseAmount:e.reduce((l,d)=>{var c;return l+(((c=d.calculations)==null?void 0:c.totalBaseAmount)||0)},0)};return n.jsxs(n.Fragment,{children:[n.jsxs(Ne,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Total count across all pages",children:["Total Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.total,prefix:n.jsx(Ki,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Count of all pending bookings",children:["Pending Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.pending,prefix:n.jsx(Qt,{style:{color:"#faad14"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Count of all approved bookings",children:["Approved Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.approved,prefix:n.jsx(St,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Count of all confirmed bookings",children:["Confirmed Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.confirmed,prefix:n.jsx(St,{style:{color:"#52c41a"}})})})})]}),n.jsxs(Ne,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Count of all rejected bookings",children:["Rejected Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.rejected,prefix:n.jsx(Zr,{style:{color:"#f5222d"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Count of all cancelled bookings",children:["Cancelled Bookings ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.cancelled,prefix:n.jsx(Zr,{style:{color:"#f5222d"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Total revenue from all bookings",children:["Total Revenue ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.totalRevenue,precision:0,prefix:""})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:s?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Vt,{})}):n.jsx(Ze,{title:n.jsxs(Ke,{title:"Total base amount before taxes and discounts",children:["Total Base Amount ",n.jsx(Gt,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.totalBaseAmount,precision:0,prefix:"",valueStyle:{color:"#1890ff"}})})})]})]})},{RangePicker:hb}=Qs,ub=({filters:e,exhibitions:t,onFilterChange:r,onRefresh:s})=>n.jsx(de,{style:{marginBottom:"24px"},children:n.jsxs(ue,{wrap:!0,children:[n.jsx(he,{placeholder:"Search by company name",prefix:n.jsx(An,{}),value:e.search,onChange:i=>r({...e,search:i.target.value}),style:{width:200},allowClear:!0}),n.jsx(Le,{placeholder:"Filter by exhibition",value:e.exhibition,onChange:i=>r({...e,exhibition:i}),style:{minWidth:200},allowClear:!0,options:t.map(i=>({label:i.name,value:i._id}))}),n.jsx(Le,{mode:"multiple",placeholder:"Filter by status",value:e.status,onChange:i=>r({...e,status:i}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),n.jsx(hb,{onChange:i=>{var a,o;return r({...e,dateRange:i?[((a=i[0])==null?void 0:a.toISOString())||"",((o=i[1])==null?void 0:o.toISOString())||""]:null})}}),n.jsx(re,{icon:n.jsx(Ks,{}),onClick:s,children:"Refresh"})]})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jo={};jo.version="0.18.5";var jf=1252,fb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sf=function(e){fb.indexOf(e)!=-1&&(jf=e)};function xb(){Sf(1252)}var Ui=function(e){Sf(e)};function pb(){Ui(1200),xb()}var Aa=function(t){return String.fromCharCode(t)},Th=function(t){return String.fromCharCode(t)},_h,$n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zi(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,i=e.charCodeAt(c++),l=(s&15)<<2|i>>6,d=i&63,isNaN(s)?l=d=64:isNaN(i)&&(d=64),t+=$n.charAt(a)+$n.charAt(o)+$n.charAt(l)+$n.charAt(d);return t}function In(e){var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=$n.indexOf(e.charAt(c++)),o=$n.indexOf(e.charAt(c++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=$n.indexOf(e.charAt(c++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),d=$n.indexOf(e.charAt(c++)),i=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Rn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ds(e){return ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function kh(e){return ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gr=function(t){return ct?Rn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Go(e){if(typeof ArrayBuffer>"u")return Gr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function ea(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function mb(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var rr=ct?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Rn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function gb(e){for(var t=[],r=0,s=e.length+250,i=ds(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>s&&(t.push(i.slice(0,r)),r=0,i=ds(65535),s=65530)}return t.push(i.slice(0,r)),rr(t)}var _i=/\u0000/g,Ia=/[\u0001-\u0006]/g;function zs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xr(e,t){var r=""+e;return r.length>=t?r:Rt("0",t-r.length)+r}function qc(e,t){var r=""+e;return r.length>=t?r:Rt(" ",t-r.length)+r}function So(e,t){var r=""+e;return r.length>=t?r:r+Rt(" ",t-r.length)}function yb(e,t){var r=""+Math.round(e);return r.length>=t?r:Rt("0",t-r.length)+r}function vb(e,t){var r=""+e;return r.length>=t?r:Rt("0",t-r.length)+r}var Ch=Math.pow(2,32);function Cs(e,t){if(e>Ch||e<-Ch)return yb(e,t);var r=Math.round(e);return vb(r,t)}function Eo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ah=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ih={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function To(e,t,r){for(var s=e<0?-1:1,i=e*s,a=0,o=1,l=0,d=1,c=0,h=0,f=Math.floor(i);c<t&&(f=Math.floor(i),l=f*o+a,h=f*c+d,!(i-f<5e-8));)i=1/(i-f),a=o,o=l,d=c,c=h;if(h>t&&(c>t?(h=d,l=a):(h=c,l=o)),!r)return[0,s*l,h];var u=Math.floor(s*l/h);return[u,s*l-u*h,h]}function Na(e,t,r){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),a=0,o=[],l={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],a=d.getDay(),s<60&&(a=(a+6)%7),r&&(a=Cb(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var Ef=new Date(1899,11,31,0,0,0),jb=Ef.getTime(),Sb=new Date(1900,2,1,0,0,0);function Tf(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Sb&&(r+=24*60*60*1e3),(r-(jb+(e.getTimezoneOffset()-Ef.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Wc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Eb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Tb(e){var t=e<0?12:11,r=Wc(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function _b(e){var t=Wc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function kb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Tb(e):t===10?r=e.toFixed(10).substr(0,12):r=_b(e),Wc(Eb(r.toUpperCase()))}function xc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qn(14,Tf(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Cb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ab(e,t,r,s){var i="",a=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return zl[r.m-1][1];case 5:return zl[r.m-1][0];default:return zl[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return Ah[r.q][0];default:return Ah[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xr(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=Xr(a,2+s),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var h=c>0?Xr(d,c):"";return h}function Un(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var _f=/%/g;function Ib(e,t,r){var s=t.replace(_f,""),i=t.length-s.length;return Tn(e,s,r*Math.pow(10,2*i))+Rt("%",i)}function Nb(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function kf(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kf(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Cf=/# (\?+)( ?)\/( ?)(\d+)/;function Fb(e,t,r){var s=parseInt(e[4],10),i=Math.round(t*s),a=Math.floor(i/s),o=i-a*s,l=s;return r+(a===0?"":""+a)+" "+(o===0?Rt(" ",e[1].length+1+e[4].length):qc(o,e[1].length)+e[2]+"/"+e[3]+Xr(l,e[4].length))}function Rb(e,t,r){return r+(t===0?"":""+t)+Rt(" ",e[1].length+2+e[4].length)}var Af=/^#*0*\.([0#]+)/,If=/\).*[0#]/,Nf=/\(###\) ###\\?-####/;function xr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Nh(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Fh(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function Pb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Db(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(If)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lr("n",s,r):"("+Lr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nb(e,t,r);if(t.indexOf("%")!==-1)return Ib(e,t,r);if(t.indexOf("E")!==-1)return kf(t,r);if(t.charCodeAt(0)===36)return"$"+Lr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Cs(d,t.length);if(t.match(/^[#?]+$/))return i=Cs(r,0),i==="0"&&(i=""),i.length>t.length?i:xr(t.substr(0,t.length-i.length))+i;if(a=t.match(Cf))return Fb(a,d,c);if(t.match(/^#+0+$/))return c+Cs(d,t.length-t.indexOf("0"));if(a=t.match(Af))return i=Nh(r,a[1].length).replace(/^([^\.]+)$/,"$1."+xr(a[1])).replace(/\.$/,"."+xr(a[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+Rt("0",xr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Nh(d,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(Cs(d,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):Un(""+(Math.floor(r)+Pb(r,a[1].length)))+"."+Xr(Fh(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Lr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zs(Lr(e,t.replace(/[\\-]/g,""),r)),o=0,zs(zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Nf))return i=Lr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=To(d,Math.pow(10,o)-1,!1),i=""+c,h=Tn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=So(l[2],o),h.length<a[4].length&&(h=xr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=To(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?qc(l[1],o)+a[2]+"/"+a[3]+So(l[2],o):Rt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Cs(r,0),t.length<=i.length?i:xr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,u=t.length-i.length-f;return xr(t.substr(0,f)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Fh(r,a[1].length),r<0?"-"+Lr(e,t,-r):Un(Db(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(o,a[1].length);switch(t){case"###,##0.00":return Lr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Un(Cs(d,0));return p!=="0"?c+p:"";case"###,###.00":return Lr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Lr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Lb(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Ob(e,t,r){var s=t.replace(_f,""),i=t.length-s.length;return Tn(e,s,r*Math.pow(10,2*i))+Rt("%",i)}function Ff(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ff(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(If)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",s,r):"("+nn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Lb(e,t,r);if(t.indexOf("%")!==-1)return Ob(e,t,r);if(t.indexOf("E")!==-1)return Ff(t,r);if(t.charCodeAt(0)===36)return"$"+nn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xr(d,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:xr(t.substr(0,t.length-i.length))+i;if(a=t.match(Cf))return Rb(a,d,c);if(t.match(/^#+0+$/))return c+Xr(d,t.length-t.indexOf("0"));if(a=t.match(Af))return i=(""+r).replace(/^([^\.]+)$/,"$1."+xr(a[1])).replace(/\.$/,"."+xr(a[1])),i=i.replace(/\.(\d*)$/,function(g,x){return"."+x+Rt("0",xr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(""+d);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):Un(""+r)+"."+Rt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zs(nn(e,t.replace(/[\\-]/g,""),r)),o=0,zs(zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Nf))return i=nn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=To(d,Math.pow(10,o)-1,!1),i=""+c,h=Tn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=So(l[2],o),h.length<a[4].length&&(h=xr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=To(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?qc(l[1],o)+a[2]+"/"+a[3]+So(l[2],o):Rt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:xr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,u=t.length-i.length-f;return xr(t.substr(0,f)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):Un(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Un(""+d);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return nn(e,t.slice(0,t.lastIndexOf(".")),r)+xr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Tn(e,t,r){return(r|0)===r?nn(e,t,r):Lr(e,t,r)}function Bb(e){for(var t=[],r=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(i,s-i),i=s+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Rf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pf(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Eo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(Rf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Mb(e,t,r,s){for(var i=[],a="",o=0,l="",d="t",c,h,f,u="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Eo(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);i[i.length]={t:"t",v:a},++o;break;case"\\":var p=e.charAt(++o),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Na(t,r,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Na(t,r),c==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),i[i.length]={t:l,v:a},d=l;break;case"A":case"a":case"":var x={t:l,v:l};if(c==null&&(c=Na(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",u="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",o+=5,u="h"):e.substr(o,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",o+=5,u="h"):(x.t="t",++o),c==null&&x.t==="T")return"";i[i.length]=x,d=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Rf)){if(c==null&&(c=Na(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},d=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pf(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var m=0,v=0,S;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=u,d="h",m<1&&(m=1);break;case"s":(S=i[o].v.match(/\.0+$/))&&(v=Math.max(v,S[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[o].v.match(/[Hh]/)&&(m=1),m<2&&i[o].v.match(/[Mm]/)&&(m=2),m<3&&i[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",y;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Ab(i[o].t.charCodeAt(0),i[o].v,c,v),i[o].t="t";break;case"n":case"?":for(y=o+1;i[y]!=null&&((l=i[y].t)==="?"||l==="D"||(l===" "||l==="t")&&i[y+1]!=null&&(i[y+1].t==="?"||i[y+1].t==="t"&&i[y+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[y].v==="/"||i[y].v===" "&&i[y+1]!=null&&i[y+1].t=="?"));)i[o].v+=i[y].v,i[y]={v:"",t:";"},++y;T+=i[o].v,o=y-1;break;case"G":i[o].t="t",i[o].v=xc(t,r);break}var w="",k,b;if(T.length>0){T.charCodeAt(0)==40?(k=t<0&&T.charCodeAt(0)===45?-t:t,b=Tn("n",T,k)):(k=t<0&&s>1?-t:t,b=Tn("n",T,k),k<0&&i[0]&&i[0].t=="t"&&(b=b.substr(1),i[0].v="-"+i[0].v)),y=b.length-1;var j=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){j=o;break}var A=i.length;if(j===i.length&&b.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(y>=i[o].v.length-1?(y-=i[o].v.length,i[o].v=b.substr(y+1,i[o].v.length)):y<0?i[o].v="":(i[o].v=b.substr(0,y+1),y=-1),i[o].t="t",A=o);y>=0&&A<i.length&&(i[A].v=b.substr(0,y+1)+i[A].v)}else if(j!==i.length&&b.indexOf("E")===-1){for(y=b.indexOf(".")-1,o=j;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")-1:i[o].v.length-1,w=i[o].v.substr(h+1);h>=0;--h)y>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(w=b.charAt(y--)+w);i[o].v=w,i[o].t="t",A=o}for(y>=0&&A<i.length&&(i[A].v=b.substr(0,y+1)+i[A].v),y=b.indexOf(".")+1,o=j;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==j)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")+1:0,w=i[o].v.substr(0,h);h<i[o].v.length;++h)y<b.length&&(w+=b.charAt(y++));i[o].v=w,i[o].t="t",A=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(k=s>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Tn(i[o].t,i[o].v,k),i[o].t="t");var E="";for(o=0;o!==i.length;++o)i[o]!=null&&(E+=i[o].v);return E}var Rh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ph(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function $b(e,t){var r=Bb(e),s=r.length,i=r[s-1].indexOf("@");if(s<4&&i>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Rh),l=r[1].match(Rh);return Ph(t,o)?[s,r[0]]:Ph(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,a]}function qn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Pt)[e],s==null&&(s=r.table&&r.table[Ih[e]]||Pt[Ih[e]]),s==null&&(s=wb[e]||"General");break}if(Eo(s,0))return xc(t,r);t instanceof Date&&(t=Tf(t,r.date1904));var i=$b(s,t);if(Eo(i[1]))return xc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Mb(i[1],t,r,i[0])}function Df(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Pt[r]==null){t<0&&(t=r);continue}if(Pt[r]==e){t=r;break}}t<0&&(t=391)}return Pt[t]=e,t}function Yo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Df(e[t],t)}function Ko(){Pt=bb()}var Lf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Ub(e){var t=typeof e=="number"?Pt[e]:e;return t=t.replace(Lf,"(\\d+)"),new RegExp("^"+t+"$")}function zb(e,t,r){var s=-1,i=-1,a=-1,o=-1,l=-1,d=-1;(t.match(Lf)||[]).forEach(function(f,u){var p=parseInt(r[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=p;break;case"d":a=p;break;case"h":o=p;break;case"s":d=p;break;case"m":o>=0?l=p:i=p;break}}),d>=0&&l==-1&&i>=0&&(l=i,i=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:s==-1&&i==-1&&a==-1?h:c+"T"+h}var qb=function(){var e={};e.version="1.2.0";function t(){for(var b=0,j=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,j[A]=b;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function s(b){var j=0,A=0,E=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)C[E]=b[E];for(E=0;E!=256;++E)for(A=b[E],j=256+E;j<4096;j+=256)A=C[j]=A>>>8^b[A&255];var I=[];for(E=1;E!=16;++E)I[E-1]=typeof Int32Array<"u"?C.subarray(E*256,E*256+256):C.slice(E*256,E*256+256);return I}var i=s(r),a=i[0],o=i[1],l=i[2],d=i[3],c=i[4],h=i[5],f=i[6],u=i[7],p=i[8],g=i[9],x=i[10],m=i[11],v=i[12],S=i[13],T=i[14];function y(b,j){for(var A=j^-1,E=0,C=b.length;E<C;)A=A>>>8^r[(A^b.charCodeAt(E++))&255];return~A}function w(b,j){for(var A=j^-1,E=b.length-15,C=0;C<E;)A=T[b[C++]^A&255]^S[b[C++]^A>>8&255]^v[b[C++]^A>>16&255]^m[b[C++]^A>>>24]^x[b[C++]]^g[b[C++]]^p[b[C++]]^u[b[C++]]^f[b[C++]]^h[b[C++]]^c[b[C++]]^d[b[C++]]^l[b[C++]]^o[b[C++]]^a[b[C++]]^r[b[C++]];for(E+=15;C<E;)A=A>>>8^r[(A^b[C++])&255];return~A}function k(b,j){for(var A=j^-1,E=0,C=b.length,I=0,F=0;E<C;)I=b.charCodeAt(E++),I<128?A=A>>>8^r[(A^I)&255]:I<2048?(A=A>>>8^r[(A^(192|I>>6&31))&255],A=A>>>8^r[(A^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,F=b.charCodeAt(E++)&1023,A=A>>>8^r[(A^(240|I>>8&7))&255],A=A>>>8^r[(A^(128|I>>2&63))&255],A=A>>>8^r[(A^(128|F>>6&15|(I&3)<<4))&255],A=A>>>8^r[(A^(128|F&63))&255]):(A=A>>>8^r[(A^(224|I>>12&15))&255],A=A>>>8^r[(A^(128|I>>6&63))&255],A=A>>>8^r[(A^(128|I&63))&255]);return~A}return e.table=r,e.bstr=y,e.buf=w,e.str=k,e}(),yt=function(){var t={};t.version="1.2.1";function r(D,V){for(var O=D.split("/"),q=V.split("/"),G=0,Y=0,ae=Math.min(O.length,q.length);G<ae;++G){if(Y=O[G].length-q[G].length)return Y;if(O[G]!=q[G])return O[G]<q[G]?-1:1}return O.length-q.length}function s(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:s(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(0,V+1)}function i(D){if(D.charAt(D.length-1)=="/")return i(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(V+1)}function a(D,V){typeof V=="string"&&(V=new Date(V));var O=V.getHours();O=O<<6|V.getMinutes(),O=O<<5|V.getSeconds()>>>1,D.write_shift(2,O);var q=V.getFullYear()-1980;q=q<<4|V.getMonth()+1,q=q<<5|V.getDate(),D.write_shift(2,q)}function o(D){var V=D.read_shift(2)&65535,O=D.read_shift(2)&65535,q=new Date,G=O&31;O>>>=5;var Y=O&15;O>>>=4,q.setMilliseconds(0),q.setFullYear(O+1980),q.setMonth(Y-1),q.setDate(G);var ae=V&31;V>>>=5;var me=V&63;return V>>>=6,q.setHours(V),q.setMinutes(me),q.setSeconds(ae<<1),q}function l(D){kr(D,0);for(var V={},O=0;D.l<=D.length-4;){var q=D.read_shift(2),G=D.read_shift(2),Y=D.l+G,ae={};switch(q){case 21589:O=D.read_shift(1),O&1&&(ae.mtime=D.read_shift(4)),G>5&&(O&2&&(ae.atime=D.read_shift(4)),O&4&&(ae.ctime=D.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}D.l=Y,V[q]=ae}return V}var d;function c(){return d||(d={})}function h(D,V){if(D[0]==80&&D[1]==75)return fd(D,V);if((D[0]|32)==109&&(D[1]|32)==105)return dx(D,V);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var O=3,q=512,G=0,Y=0,ae=0,me=0,ie=0,oe=[],le=D.slice(0,512);kr(le,0);var Te=f(le);switch(O=Te[0],O){case 3:q=512;break;case 4:q=4096;break;case 0:if(Te[1]==0)return fd(D,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}q!==512&&(le=D.slice(0,q),kr(le,28));var Re=D.slice(0,q);u(le,O);var Oe=le.read_shift(4,"i");if(O===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),me=le.read_shift(4,"i"),G=le.read_shift(4,"i"),ie=le.read_shift(4,"i"),Y=le.read_shift(4,"i");for(var Ce=-1,De=0;De<109&&(Ce=le.read_shift(4,"i"),!(Ce<0));++De)oe[De]=Ce;var He=p(D,q);m(ie,Y,He,q,oe);var _t=S(He,ae,oe,q);_t[ae].name="!Directory",G>0&&me!==F&&(_t[me].name="!MiniFAT"),_t[oe[0]].name="!FAT",_t.fat_addrs=oe,_t.ssz=q;var kt={},or=[],si=[],ii=[];T(ae,_t,He,or,G,kt,si,me),g(si,ii,or),or.shift();var ai={FileIndex:si,FullPaths:ii};return V&&V.raw&&(ai.raw={header:Re,sectors:He}),ai}function f(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(N,"Header Signature: "),D.l+=16;var V=D.read_shift(2,"u");return[D.read_shift(2,"u"),V]}function u(D,V){var O=9;switch(D.l+=2,O=D.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function p(D,V){for(var O=Math.ceil(D.length/V)-1,q=[],G=1;G<O;++G)q[G-1]=D.slice(G*V,(G+1)*V);return q[O-1]=D.slice(O*V),q}function g(D,V,O){for(var q=0,G=0,Y=0,ae=0,me=0,ie=O.length,oe=[],le=[];q<ie;++q)oe[q]=le[q]=q,V[q]=O[q];for(;me<le.length;++me)q=le[me],G=D[q].L,Y=D[q].R,ae=D[q].C,oe[q]===q&&(G!==-1&&oe[G]!==G&&(oe[q]=oe[G]),Y!==-1&&oe[Y]!==Y&&(oe[q]=oe[Y])),ae!==-1&&(oe[ae]=q),G!==-1&&q!=oe[q]&&(oe[G]=oe[q],le.lastIndexOf(G)<me&&le.push(G)),Y!==-1&&q!=oe[q]&&(oe[Y]=oe[q],le.lastIndexOf(Y)<me&&le.push(Y));for(q=1;q<ie;++q)oe[q]===q&&(Y!==-1&&oe[Y]!==Y?oe[q]=oe[Y]:G!==-1&&oe[G]!==G&&(oe[q]=oe[G]));for(q=1;q<ie;++q)if(D[q].type!==0){if(me=q,me!=oe[me])do me=oe[me],V[q]=V[me]+"/"+V[q];while(me!==0&&oe[me]!==-1&&me!=oe[me]);oe[q]=-1}for(V[0]+="/",q=1;q<ie;++q)D[q].type!==2&&(V[q]+="/")}function x(D,V,O){for(var q=D.start,G=D.size,Y=[],ae=q;O&&G>0&&ae>=0;)Y.push(V.slice(ae*I,ae*I+I)),G-=I,ae=ts(O,ae*4);return Y.length===0?fe(0):rr(Y).slice(0,D.size)}function m(D,V,O,q,G){var Y=F;if(D===F){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ae=O[D],me=(q>>>2)-1;if(!ae)return;for(var ie=0;ie<me&&(Y=ts(ae,ie*4))!==F;++ie)G.push(Y);m(ts(ae,q-4),V-1,O,q,G)}}function v(D,V,O,q,G){var Y=[],ae=[];G||(G=[]);var me=q-1,ie=0,oe=0;for(ie=V;ie>=0;){G[ie]=!0,Y[Y.length]=ie,ae.push(D[ie]);var le=O[Math.floor(ie*4/q)];if(oe=ie*4&me,q<4+oe)throw new Error("FAT boundary crossed: "+ie+" 4 "+q);if(!D[le])break;ie=ts(D[le],oe)}return{nodes:Y,data:zh([ae])}}function S(D,V,O,q){var G=D.length,Y=[],ae=[],me=[],ie=[],oe=q-1,le=0,Te=0,Re=0,Oe=0;for(le=0;le<G;++le)if(me=[],Re=le+V,Re>=G&&(Re-=G),!ae[Re]){ie=[];var Ce=[];for(Te=Re;Te>=0;){Ce[Te]=!0,ae[Te]=!0,me[me.length]=Te,ie.push(D[Te]);var De=O[Math.floor(Te*4/q)];if(Oe=Te*4&oe,q<4+Oe)throw new Error("FAT boundary crossed: "+Te+" 4 "+q);if(!D[De]||(Te=ts(D[De],Oe),Ce[Te]))break}Y[Re]={nodes:me,data:zh([ie])}}return Y}function T(D,V,O,q,G,Y,ae,me){for(var ie=0,oe=q.length?2:0,le=V[D].data,Te=0,Re=0,Oe;Te<le.length;Te+=128){var Ce=le.slice(Te,Te+128);kr(Ce,64),Re=Ce.read_shift(2),Oe=Kc(Ce,0,Re-oe),q.push(Oe);var De={name:Oe,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},He=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);He!==0&&(De.ct=y(Ce,Ce.l-8));var _t=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);_t!==0&&(De.mt=y(Ce,Ce.l-8)),De.start=Ce.read_shift(4,"i"),De.size=Ce.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=F,De.name=""),De.type===5?(ie=De.start,G>0&&ie!==F&&(V[ie].name="!StreamData")):De.size>=4096?(De.storage="fat",V[De.start]===void 0&&(V[De.start]=v(O,De.start,V.fat_addrs,V.ssz)),V[De.start].name=De.name,De.content=V[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:ie!==F&&De.start!==F&&V[ie]&&(De.content=x(De,V[ie].data,(V[me]||{}).data))),De.content&&kr(De.content,0),Y[Oe]=De,ae.push(De)}}function y(D,V){return new Date((Ir(D,V+4)/1e7*Math.pow(2,32)+Ir(D,V)/1e7-11644473600)*1e3)}function w(D,V){return c(),h(d.readFileSync(D),V)}function k(D,V){var O=V&&V.type;switch(O||ct&&Buffer.isBuffer(D)&&(O="buffer"),O||"base64"){case"file":return w(D,V);case"base64":return h(Gr(In(D)),V);case"binary":return h(Gr(D),V)}return h(D,V)}function b(D,V){var O=V||{},q=O.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=q+"/",D.FileIndex[0]={name:q,type:5}),O.CLSID&&(D.FileIndex[0].clsid=O.CLSID),j(D)}function j(D){var V="Sh33tJ5";if(!yt.find(D,"/"+V)){var O=fe(4);O[0]=55,O[1]=O[3]=50,O[2]=54,D.FileIndex.push({name:V,type:2,content:O,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+V),A(D)}}function A(D,V){b(D);for(var O=!1,q=!1,G=D.FullPaths.length-1;G>=0;--G){var Y=D.FileIndex[G];switch(Y.type){case 0:q?O=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(Y.R*Y.L*Y.C)&&(O=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!V)){var ae=new Date(1987,1,19),me=0,ie=Object.create?Object.create(null):{},oe=[];for(G=0;G<D.FullPaths.length;++G)ie[D.FullPaths[G]]=!0,D.FileIndex[G].type!==0&&oe.push([D.FullPaths[G],D.FileIndex[G]]);for(G=0;G<oe.length;++G){var le=s(oe[G][0]);q=ie[le],q||(oe.push([le,{name:i(le).replace("/",""),type:1,clsid:M,ct:ae,mt:ae,content:null}]),ie[le]=!0)}for(oe.sort(function(Oe,Ce){return r(Oe[0],Ce[0])}),D.FullPaths=[],D.FileIndex=[],G=0;G<oe.length;++G)D.FullPaths[G]=oe[G][0],D.FileIndex[G]=oe[G][1];for(G=0;G<oe.length;++G){var Te=D.FileIndex[G],Re=D.FullPaths[G];if(Te.name=i(Re).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||M,G===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(Re.slice(-1)=="/"){for(me=G+1;me<oe.length&&s(D.FullPaths[me])!=Re;++me);for(Te.C=me>=oe.length?-1:me,me=G+1;me<oe.length&&s(D.FullPaths[me])!=s(Re);++me);Te.R=me>=oe.length?-1:me,Te.type=1}else s(D.FullPaths[G+1]||"")==s(Re)&&(Te.R=G+1),Te.type=2}}}function E(D,V){var O=V||{};if(O.fileType=="mad")return hx(D,O);switch(A(D),O.fileType){case"zip":return sx(D,O)}var q=function(Oe){for(var Ce=0,De=0,He=0;He<Oe.FileIndex.length;++He){var _t=Oe.FileIndex[He];if(_t.content){var kt=_t.content.length;kt>0&&(kt<4096?Ce+=kt+63>>6:De+=kt+511>>9)}}for(var or=Oe.FullPaths.length+3>>2,si=Ce+7>>3,ii=Ce+127>>7,ai=si+De+or+ii,Xn=ai+127>>7,sl=Xn<=109?0:Math.ceil((Xn-109)/127);ai+Xn+sl+127>>7>Xn;)sl=++Xn<=109?0:Math.ceil((Xn-109)/127);var mn=[1,sl,Xn,ii,or,De,Ce,0];return Oe.FileIndex[0].size=Ce<<6,mn[7]=(Oe.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(D),G=fe(q[7]<<9),Y=0,ae=0;{for(Y=0;Y<8;++Y)G.write_shift(1,U[Y]);for(Y=0;Y<8;++Y)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Y=0;Y<3;++Y)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,q[2]),G.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:F),G.write_shift(4,q[3]),G.write_shift(-4,q[1]?q[0]-1:F),G.write_shift(4,q[1]),Y=0;Y<109;++Y)G.write_shift(-4,Y<q[2]?q[1]+Y:-1)}if(q[1])for(ae=0;ae<q[1];++ae){for(;Y<236+ae*127;++Y)G.write_shift(-4,Y<q[2]?q[1]+Y:-1);G.write_shift(-4,ae===q[1]-1?F:ae+1)}var me=function(Oe){for(ae+=Oe;Y<ae-1;++Y)G.write_shift(-4,Y+1);Oe&&(++Y,G.write_shift(-4,F))};for(ae=Y=0,ae+=q[1];Y<ae;++Y)G.write_shift(-4,L.DIFSECT);for(ae+=q[2];Y<ae;++Y)G.write_shift(-4,L.FATSECT);me(q[3]),me(q[4]);for(var ie=0,oe=0,le=D.FileIndex[0];ie<D.FileIndex.length;++ie)le=D.FileIndex[ie],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ae,me(oe+511>>9)));for(me(q[6]+7>>3);G.l&511;)G.write_shift(-4,L.ENDOFCHAIN);for(ae=Y=0,ie=0;ie<D.FileIndex.length;++ie)le=D.FileIndex[ie],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ae,me(oe+63>>6)));for(;G.l&511;)G.write_shift(-4,L.ENDOFCHAIN);for(Y=0;Y<q[4]<<2;++Y){var Te=D.FullPaths[Y];if(!Te||Te.length===0){for(ie=0;ie<17;++ie)G.write_shift(4,0);for(ie=0;ie<3;++ie)G.write_shift(4,-1);for(ie=0;ie<12;++ie)G.write_shift(4,0);continue}le=D.FileIndex[Y],Y===0&&(le.start=le.size?le.start-1:F);var Re=Y===0&&O.root||le.name;if(oe=2*(Re.length+1),G.write_shift(64,Re,"utf16le"),G.write_shift(2,oe),G.write_shift(1,le.type),G.write_shift(1,le.color),G.write_shift(-4,le.L),G.write_shift(-4,le.R),G.write_shift(-4,le.C),le.clsid)G.write_shift(16,le.clsid,"hex");else for(ie=0;ie<4;++ie)G.write_shift(4,0);G.write_shift(4,le.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,le.start),G.write_shift(4,le.size),G.write_shift(4,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(le=D.FileIndex[Y],le.size>=4096)if(G.l=le.start+1<<9,ct&&Buffer.isBuffer(le.content))le.content.copy(G,G.l,0,le.size),G.l+=le.size+511&-512;else{for(ie=0;ie<le.size;++ie)G.write_shift(1,le.content[ie]);for(;ie&511;++ie)G.write_shift(1,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(le=D.FileIndex[Y],le.size>0&&le.size<4096)if(ct&&Buffer.isBuffer(le.content))le.content.copy(G,G.l,0,le.size),G.l+=le.size+63&-64;else{for(ie=0;ie<le.size;++ie)G.write_shift(1,le.content[ie]);for(;ie&63;++ie)G.write_shift(1,0)}if(ct)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function C(D,V){var O=D.FullPaths.map(function(ie){return ie.toUpperCase()}),q=O.map(function(ie){var oe=ie.split("/");return oe[oe.length-(ie.slice(-1)=="/"?2:1)]}),G=!1;V.charCodeAt(0)===47?(G=!0,V=O[0].slice(0,-1)+V):G=V.indexOf("/")!==-1;var Y=V.toUpperCase(),ae=G===!0?O.indexOf(Y):q.indexOf(Y);if(ae!==-1)return D.FileIndex[ae];var me=!Y.match(Ia);for(Y=Y.replace(_i,""),me&&(Y=Y.replace(Ia,"!")),ae=0;ae<O.length;++ae)if((me?O[ae].replace(Ia,"!"):O[ae]).replace(_i,"")==Y||(me?q[ae].replace(Ia,"!"):q[ae]).replace(_i,"")==Y)return D.FileIndex[ae];return null}var I=64,F=-2,N="d0cf11e0a1b11ae1",U=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",L={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:N,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(D,V,O){c();var q=E(D,O);d.writeFileSync(V,q)}function J(D){for(var V=new Array(D.length),O=0;O<D.length;++O)V[O]=String.fromCharCode(D[O]);return V.join("")}function ne(D,V){var O=E(D,V);switch(V&&V.type||"buffer"){case"file":return c(),d.writeFileSync(V.filename,O),O;case"binary":return typeof O=="string"?O:J(O);case"base64":return zi(typeof O=="string"?O:J(O));case"buffer":if(ct)return Buffer.isBuffer(O)?O:Rn(O);case"array":return typeof O=="string"?Gr(O):O}return O}var te;function P(D){try{var V=D.InflateRaw,O=new V;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)te=D;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function H(D,V){if(!te)return hd(D,V);var O=te.InflateRaw,q=new O,G=q._processChunk(D.slice(D.l),q._finishFlushFlag);return D.l+=q.bytesRead,G}function B(D){return te?te.deflateRawSync(D):Tt(D)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(D){var V=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(V>>16|V>>8|V)&255}for(var ye=typeof Uint8Array<"u",X=ye?new Uint8Array(256):[],ee=0;ee<256;++ee)X[ee]=we(ee);function ce(D,V){var O=X[D&255];return V<=8?O>>>8-V:(O=O<<8|X[D>>8&255],V<=16?O>>>16-V:(O=O<<8|X[D>>16&255],O>>>24-V))}function xe(D,V){var O=V&7,q=V>>>3;return(D[q]|(O<=6?0:D[q+1]<<8))>>>O&3}function Z(D,V){var O=V&7,q=V>>>3;return(D[q]|(O<=5?0:D[q+1]<<8))>>>O&7}function ge(D,V){var O=V&7,q=V>>>3;return(D[q]|(O<=4?0:D[q+1]<<8))>>>O&15}function be(D,V){var O=V&7,q=V>>>3;return(D[q]|(O<=3?0:D[q+1]<<8))>>>O&31}function ve(D,V){var O=V&7,q=V>>>3;return(D[q]|(O<=1?0:D[q+1]<<8))>>>O&127}function Fe(D,V,O){var q=V&7,G=V>>>3,Y=(1<<O)-1,ae=D[G]>>>q;return O<8-q||(ae|=D[G+1]<<8-q,O<16-q)||(ae|=D[G+2]<<16-q,O<24-q)||(ae|=D[G+3]<<24-q),ae&Y}function pe(D,V,O){var q=V&7,G=V>>>3;return q<=5?D[G]|=(O&7)<<q:(D[G]|=O<<q&255,D[G+1]=(O&7)>>8-q),V+3}function Ue(D,V,O){var q=V&7,G=V>>>3;return O=(O&1)<<q,D[G]|=O,V+1}function We(D,V,O){var q=V&7,G=V>>>3;return O<<=q,D[G]|=O&255,O>>>=8,D[G+1]=O,V+8}function gt(D,V,O){var q=V&7,G=V>>>3;return O<<=q,D[G]|=O&255,O>>>=8,D[G+1]=O&255,D[G+2]=O>>>8,V+16}function dt(D,V){var O=D.length,q=2*O>V?2*O:V+5,G=0;if(O>=V)return D;if(ct){var Y=kh(q);if(D.copy)D.copy(Y);else for(;G<D.length;++G)Y[G]=D[G];return Y}else if(ye){var ae=new Uint8Array(q);if(ae.set)ae.set(D);else for(;G<O;++G)ae[G]=D[G];return ae}return D.length=q,D}function Pe(D){for(var V=new Array(D),O=0;O<D;++O)V[O]=0;return V}function ze(D,V,O){var q=1,G=0,Y=0,ae=0,me=0,ie=D.length,oe=ye?new Uint16Array(32):Pe(32);for(Y=0;Y<32;++Y)oe[Y]=0;for(Y=ie;Y<O;++Y)D[Y]=0;ie=D.length;var le=ye?new Uint16Array(ie):Pe(ie);for(Y=0;Y<ie;++Y)oe[G=D[Y]]++,q<G&&(q=G),le[Y]=0;for(oe[0]=0,Y=1;Y<=q;++Y)oe[Y+16]=me=me+oe[Y-1]<<1;for(Y=0;Y<ie;++Y)me=D[Y],me!=0&&(le[Y]=oe[me+16]++);var Te=0;for(Y=0;Y<ie;++Y)if(Te=D[Y],Te!=0)for(me=ce(le[Y],q)>>q-Te,ae=(1<<q+4-Te)-1;ae>=0;--ae)V[me|ae<<Te]=Te&15|Y<<4;return q}var Xe=ye?new Uint16Array(512):Pe(512),$e=ye?new Uint16Array(32):Pe(32);if(!ye){for(var Be=0;Be<512;++Be)Xe[Be]=0;for(Be=0;Be<32;++Be)$e[Be]=0}(function(){for(var D=[],V=0;V<32;V++)D.push(5);ze(D,$e,32);var O=[];for(V=0;V<=143;V++)O.push(8);for(;V<=255;V++)O.push(9);for(;V<=279;V++)O.push(7);for(;V<=287;V++)O.push(8);ze(O,Xe,288)})();var at=function(){for(var V=ye?new Uint8Array(32768):[],O=0,q=0;O<se.length-1;++O)for(;q<se[O+1];++q)V[q]=O;for(;q<32768;++q)V[q]=29;var G=ye?new Uint8Array(259):[];for(O=0,q=0;O<K.length-1;++O)for(;q<K[O+1];++q)G[q]=O;function Y(me,ie){for(var oe=0;oe<me.length;){var le=Math.min(65535,me.length-oe),Te=oe+le==me.length;for(ie.write_shift(1,+Te),ie.write_shift(2,le),ie.write_shift(2,~le&65535);le-- >0;)ie[ie.l++]=me[oe++]}return ie.l}function ae(me,ie){for(var oe=0,le=0,Te=ye?new Uint16Array(32768):[];le<me.length;){var Re=Math.min(65535,me.length-le);if(Re<10){for(oe=pe(ie,oe,+(le+Re==me.length)),oe&7&&(oe+=8-(oe&7)),ie.l=oe/8|0,ie.write_shift(2,Re),ie.write_shift(2,~Re&65535);Re-- >0;)ie[ie.l++]=me[le++];oe=ie.l*8;continue}oe=pe(ie,oe,+(le+Re==me.length)+2);for(var Oe=0;Re-- >0;){var Ce=me[le];Oe=(Oe<<5^Ce)&32767;var De=-1,He=0;if((De=Te[Oe])&&(De|=le&-32768,De>le&&(De-=32768),De<le))for(;me[De+He]==me[le+He]&&He<250;)++He;if(He>2){Ce=G[He],Ce<=22?oe=We(ie,oe,X[Ce+1]>>1)-1:(We(ie,oe,3),oe+=5,We(ie,oe,X[Ce-23]>>5),oe+=3);var _t=Ce<8?0:Ce-4>>2;_t>0&&(gt(ie,oe,He-K[Ce]),oe+=_t),Ce=V[le-De],oe=We(ie,oe,X[Ce]>>3),oe-=3;var kt=Ce<4?0:Ce-2>>1;kt>0&&(gt(ie,oe,le-De-se[Ce]),oe+=kt);for(var or=0;or<He;++or)Te[Oe]=le&32767,Oe=(Oe<<5^me[le])&32767,++le;Re-=He-1}else Ce<=143?Ce=Ce+48:oe=Ue(ie,oe,1),oe=We(ie,oe,X[Ce]),Te[Oe]=le&32767,++le}oe=We(ie,oe,0)-1}return ie.l=(oe+7)/8|0,ie.l}return function(ie,oe){return ie.length<8?Y(ie,oe):ae(ie,oe)}}();function Tt(D){var V=fe(50+Math.floor(D.length*1.1)),O=at(D,V);return V.slice(0,O)}var Tr=ye?new Uint16Array(32768):Pe(32768),Pn=ye?new Uint16Array(32768):Pe(32768),aa=ye?new Uint16Array(128):Pe(128),oa=1,la=1;function tl(D,V){var O=be(D,V)+257;V+=5;var q=be(D,V)+1;V+=5;var G=ge(D,V)+4;V+=4;for(var Y=0,ae=ye?new Uint8Array(19):Pe(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,oe=ye?new Uint8Array(8):Pe(8),le=ye?new Uint8Array(8):Pe(8),Te=ae.length,Re=0;Re<G;++Re)ae[R[Re]]=Y=Z(D,V),ie<Y&&(ie=Y),oe[Y]++,V+=3;var Oe=0;for(oe[0]=0,Re=1;Re<=ie;++Re)le[Re]=Oe=Oe+oe[Re-1]<<1;for(Re=0;Re<Te;++Re)(Oe=ae[Re])!=0&&(me[Re]=le[Oe]++);var Ce=0;for(Re=0;Re<Te;++Re)if(Ce=ae[Re],Ce!=0){Oe=X[me[Re]]>>8-Ce;for(var De=(1<<7-Ce)-1;De>=0;--De)aa[Oe|De<<Ce]=Ce&7|Re<<3}var He=[];for(ie=1;He.length<O+q;)switch(Oe=aa[ve(D,V)],V+=Oe&7,Oe>>>=3){case 16:for(Y=3+xe(D,V),V+=2,Oe=He[He.length-1];Y-- >0;)He.push(Oe);break;case 17:for(Y=3+Z(D,V),V+=3;Y-- >0;)He.push(0);break;case 18:for(Y=11+ve(D,V),V+=7;Y-- >0;)He.push(0);break;default:He.push(Oe),ie<Oe&&(ie=Oe);break}var _t=He.slice(0,O),kt=He.slice(O);for(Re=O;Re<286;++Re)_t[Re]=0;for(Re=q;Re<30;++Re)kt[Re]=0;return oa=ze(_t,Tr,286),la=ze(kt,Pn,30),V}function rl(D,V){if(D[0]==3&&!(D[1]&3))return[ds(V),2];for(var O=0,q=0,G=kh(V||1<<18),Y=0,ae=G.length>>>0,me=0,ie=0;!(q&1);){if(q=Z(D,O),O+=3,q>>>1)q>>1==1?(me=9,ie=5):(O=tl(D,O),me=oa,ie=la);else{O&7&&(O+=8-(O&7));var oe=D[O>>>3]|D[(O>>>3)+1]<<8;if(O+=32,oe>0)for(!V&&ae<Y+oe&&(G=dt(G,Y+oe),ae=G.length);oe-- >0;)G[Y++]=D[O>>>3],O+=8;continue}for(;;){!V&&ae<Y+32767&&(G=dt(G,Y+32767),ae=G.length);var le=Fe(D,O,me),Te=q>>>1==1?Xe[le]:Tr[le];if(O+=Te&15,Te>>>=4,!(Te>>>8&255))G[Y++]=Te;else{if(Te==256)break;Te-=257;var Re=Te<8?0:Te-4>>2;Re>5&&(Re=0);var Oe=Y+K[Te];Re>0&&(Oe+=Fe(D,O,Re),O+=Re),le=Fe(D,O,ie),Te=q>>>1==1?$e[le]:Pn[le],O+=Te&15,Te>>>=4;var Ce=Te<4?0:Te-2>>1,De=se[Te];for(Ce>0&&(De+=Fe(D,O,Ce),O+=Ce),!V&&ae<Oe&&(G=dt(G,Oe+100),ae=G.length);Y<Oe;)G[Y]=G[Y-De],++Y}}}return V?[G,O+7>>>3]:[G.slice(0,Y),O+7>>>3]}function hd(D,V){var O=D.slice(D.l||0),q=rl(O,V);return D.l+=q[1],q[0]}function ud(D,V){if(D)typeof console<"u"&&console.error(V);else throw new Error(V)}function fd(D,V){var O=D;kr(O,0);var q=[],G=[],Y={FileIndex:q,FullPaths:G};b(Y,{root:V.root});for(var ae=O.length-4;(O[ae]!=80||O[ae+1]!=75||O[ae+2]!=5||O[ae+3]!=6)&&ae>=0;)--ae;O.l=ae+4,O.l+=4;var me=O.read_shift(2);O.l+=6;var ie=O.read_shift(4);for(O.l=ie,ae=0;ae<me;++ae){O.l+=20;var oe=O.read_shift(4),le=O.read_shift(4),Te=O.read_shift(2),Re=O.read_shift(2),Oe=O.read_shift(2);O.l+=8;var Ce=O.read_shift(4),De=l(O.slice(O.l+Te,O.l+Te+Re));O.l+=Te+Re+Oe;var He=O.l;O.l=Ce+4,nx(O,oe,le,Y,De),O.l=He}return Y}function nx(D,V,O,q,G){D.l+=2;var Y=D.read_shift(2),ae=D.read_shift(2),me=o(D);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ie=D.read_shift(4),oe=D.read_shift(4),le=D.read_shift(4),Te=D.read_shift(2),Re=D.read_shift(2),Oe="",Ce=0;Ce<Te;++Ce)Oe+=String.fromCharCode(D[D.l++]);if(Re){var De=l(D.slice(D.l,D.l+Re));(De[21589]||{}).mt&&(me=De[21589].mt),((G||{})[21589]||{}).mt&&(me=G[21589].mt)}D.l+=Re;var He=D.slice(D.l,D.l+oe);switch(ae){case 8:He=H(D,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var _t=!1;Y&8&&(ie=D.read_shift(4),ie==134695760&&(ie=D.read_shift(4),_t=!0),oe=D.read_shift(4),le=D.read_shift(4)),oe!=V&&ud(_t,"Bad compressed size: "+V+" != "+oe),le!=O&&ud(_t,"Bad uncompressed size: "+O+" != "+le),nl(q,Oe,He,{unsafe:!0,mt:me})}function sx(D,V){var O=V||{},q=[],G=[],Y=fe(1),ae=O.compression?8:0,me=0,ie=0,oe=0,le=0,Te=0,Re=D.FullPaths[0],Oe=Re,Ce=D.FileIndex[0],De=[],He=0;for(ie=1;ie<D.FullPaths.length;++ie)if(Oe=D.FullPaths[ie].slice(Re.length),Ce=D.FileIndex[ie],!(!Ce.size||!Ce.content||Oe=="Sh33tJ5")){var _t=le,kt=fe(Oe.length);for(oe=0;oe<Oe.length;++oe)kt.write_shift(1,Oe.charCodeAt(oe)&127);kt=kt.slice(0,kt.l),De[Te]=qb.buf(Ce.content,0);var or=Ce.content;ae==8&&(or=B(or)),Y=fe(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,me),Y.write_shift(2,ae),Ce.mt?a(Y,Ce.mt):Y.write_shift(4,0),Y.write_shift(-4,De[Te]),Y.write_shift(4,or.length),Y.write_shift(4,Ce.content.length),Y.write_shift(2,kt.length),Y.write_shift(2,0),le+=Y.length,q.push(Y),le+=kt.length,q.push(kt),le+=or.length,q.push(or),Y=fe(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,me),Y.write_shift(2,ae),Y.write_shift(4,0),Y.write_shift(-4,De[Te]),Y.write_shift(4,or.length),Y.write_shift(4,Ce.content.length),Y.write_shift(2,kt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,_t),He+=Y.l,G.push(Y),He+=kt.length,G.push(kt),++Te}return Y=fe(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Te),Y.write_shift(2,Te),Y.write_shift(4,He),Y.write_shift(4,le),Y.write_shift(2,0),rr([rr(q),rr(G),Y])}var ca={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ix(D,V){if(D.ctype)return D.ctype;var O=D.name||"",q=O.match(/\.([^\.]+)$/);return q&&ca[q[1]]||V&&(q=(O=V).match(/[\.\\]([^\.\\])+$/),q&&ca[q[1]])?ca[q[1]]:"application/octet-stream"}function ax(D){for(var V=zi(D),O=[],q=0;q<V.length;q+=76)O.push(V.slice(q,q+76));return O.join(`\r
`)+`\r
`}function ox(D){var V=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],q=V.split(`\r
`),G=0;G<q.length;++G){var Y=q[G];if(Y.length==0){O.push("");continue}for(var ae=0;ae<Y.length;){var me=76,ie=Y.slice(ae,ae+me);ie.charAt(me-1)=="="?me--:ie.charAt(me-2)=="="?me-=2:ie.charAt(me-3)=="="&&(me-=3),ie=Y.slice(ae,ae+me),ae+=me,ae<Y.length&&(ie+="="),O.push(ie)}}return O.join(`\r
`)}function lx(D){for(var V=[],O=0;O<D.length;++O){for(var q=D[O];O<=D.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+D[++O];V.push(q)}for(var G=0;G<V.length;++G)V[G]=V[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Gr(V.join(`\r
`))}function cx(D,V,O){for(var q="",G="",Y="",ae,me=0;me<10;++me){var ie=V[me];if(!ie||ie.match(/^\s*$/))break;var oe=ie.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":q=oe[2].trim();break;case"content-type":Y=oe[2].trim();break;case"content-transfer-encoding":G=oe[2].trim();break}}switch(++me,G.toLowerCase()){case"base64":ae=Gr(In(V.slice(me).join("")));break;case"quoted-printable":ae=lx(V.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var le=nl(D,q.slice(O.length),ae,{unsafe:!0});Y&&(le.ctype=Y)}function dx(D,V){if(J(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=V&&V.root||"",q=(ct&&Buffer.isBuffer(D)?D.toString("binary"):J(D)).split(`\r
`),G=0,Y="";for(G=0;G<q.length;++G)if(Y=q[G],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),O||(O=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),Y.slice(0,O.length)!=O););var ae=(q[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var me="--"+(ae[1]||""),ie=[],oe=[],le={FileIndex:ie,FullPaths:oe};b(le);var Te,Re=0;for(G=0;G<q.length;++G){var Oe=q[G];Oe!==me&&Oe!==me+"--"||(Re++&&cx(le,q.slice(Te,G),O),Te=G)}return le}function hx(D,V){var O=V||{},q=O.boundary||"SheetJS";q="------="+q;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],Y=D.FullPaths[0],ae=Y,me=D.FileIndex[0],ie=1;ie<D.FullPaths.length;++ie)if(ae=D.FullPaths[ie].slice(Y.length),me=D.FileIndex[ie],!(!me.size||!me.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var oe=me.content,le=ct&&Buffer.isBuffer(oe)?oe.toString("binary"):J(oe),Te=0,Re=Math.min(1024,le.length),Oe=0,Ce=0;Ce<=Re;++Ce)(Oe=le.charCodeAt(Ce))>=32&&Oe<128&&++Te;var De=Te>=Re*4/5;G.push(q),G.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ae),G.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),G.push("Content-Type: "+ix(me,ae)),G.push(""),G.push(De?ox(le):ax(le))}return G.push(q+`--\r
`),G.join(`\r
`)}function ux(D){var V={};return b(V,D),V}function nl(D,V,O,q){var G=q&&q.unsafe;G||b(D);var Y=!G&&yt.find(D,V);if(!Y){var ae=D.FullPaths[0];V.slice(0,ae.length)==ae?ae=V:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+V).replace("//","/")),Y={name:i(V),type:2},D.FileIndex.push(Y),D.FullPaths.push(ae),G||yt.utils.cfb_gc(D)}return Y.content=O,Y.size=O?O.length:0,q&&(q.CLSID&&(Y.clsid=q.CLSID),q.mt&&(Y.mt=q.mt),q.ct&&(Y.ct=q.ct)),Y}function fx(D,V){b(D);var O=yt.find(D,V);if(O){for(var q=0;q<D.FileIndex.length;++q)if(D.FileIndex[q]==O)return D.FileIndex.splice(q,1),D.FullPaths.splice(q,1),!0}return!1}function xx(D,V,O){b(D);var q=yt.find(D,V);if(q){for(var G=0;G<D.FileIndex.length;++G)if(D.FileIndex[G]==q)return D.FileIndex[G].name=i(O),D.FullPaths[G]=O,!0}return!1}function px(D){A(D,!0)}return t.find=C,t.read=k,t.parse=h,t.write=ne,t.writeFile=z,t.utils={cfb_new:ux,cfb_add:nl,cfb_del:fx,cfb_mov:xx,cfb_gc:px,ReadShift:Ci,CheckField:e0,prep_blob:kr,bconcat:rr,use_zlib:P,_deflateRaw:Tt,_inflateRaw:hd,consts:L},t}();function Wb(e){return typeof e=="string"?Go(e):Array.isArray(e)?mb(e):e}function ta(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Go(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?Wi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([Wb(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ea(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function ar(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Dh(e,t){for(var r=[],s=ar(e),i=0;i!==s.length;++i)r[e[s[i]][t]]==null&&(r[e[s[i]][t]]=s[i]);return r}function Hc(e){for(var t=[],r=ar(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Xo(e){for(var t=[],r=ar(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function Hb(e){for(var t=[],r=ar(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var _o=new Date(1899,11,30,0,0,0);function Sr(e,t){var r=e.getTime(),s=_o.getTime()+(e.getTimezoneOffset()-_o.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var Of=new Date,Vb=_o.getTime()+(Of.getTimezoneOffset()-_o.getTimezoneOffset())*6e4,Lh=Of.getTimezoneOffset();function Bf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Vb),t.getTimezoneOffset()!==Lh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Lh)*6e4),t}var Oh=new Date("2017-02-19T19:06:09.000Z"),Mf=isNaN(Oh.getFullYear())?new Date("2/19/17"):Oh,Gb=Mf.getFullYear()==2017;function yr(e,t){var r=new Date(e);if(Gb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Mf.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Qo(e,t){if(ct&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function Er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Er(e[r]));return t}function Rt(e,t){for(var r="";r.length<t;)r+=e;return r}function _n(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var Yb=["january","february","march","april","may","june","july","august","september","october","november","december"];function qi(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Yb.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(i>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ge(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return ct?s=Rn(r):s=gb(r),yt.utils.cfb_add(e,t,s)}yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Vc(){return yt.utils.cfb_new()}var $t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Kb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Gc=Hc(Kb),Yc=/[&<>'"]/g,Xb=/[\u0000-\u0008\u000b-\u001f]/g;function pt(e){var t=e+"";return t.replace(Yc,function(r){return Gc[r]}).replace(Xb,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bh(e){return pt(e).replace(/ /g,"_x0020_")}var $f=/[\u0000-\u001f]/g;function Qb(e){var t=e+"";return t.replace(Yc,function(r){return Gc[r]}).replace(/\n/g,"<br/>").replace($f,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Jb(e){var t=e+"";return t.replace(Yc,function(r){return Gc[r]}).replace($f,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Zb(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ew(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ql(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Mh(e){var t=ds(2*e.length),r,s,i=1,a=0,o=0,l;for(s=0;s<e.length;s+=i)i=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function $h(e){return Rn(e,"binary").toString("utf8")}var Fa="foo bar baz",ki=ct&&($h(Fa)==ql(Fa)&&$h||Mh(Fa)==ql(Fa)&&Mh)||ql,Wi=ct?function(e){return Rn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,i=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},tw=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),Uf=/(^\s|\s$|\n)/;function nr(e,t){return"<"+e+(t.match(Uf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Hi(e){return ar(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ae(e,t,r){return"<"+e+(r!=null?Hi(r):"")+(t!=null?(t.match(Uf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function pc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function rw(e,t){switch(typeof e){case"string":var r=Ae("vt:lpwstr",pt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ae((e|0)==e?"vt:i4":"vt:r8",pt(String(e)));case"boolean":return Ae("vt:bool",e?"true":"false")}if(e instanceof Date)return Ae("vt:filetime",pc(e));throw new Error("Unable to serialize "+e)}var Yt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nw(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return s==2047?i==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),r*Math.pow(2,s-52)*i)}function sw(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=s?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|s}var Uh=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,a=e[0][s].length;i<a;i+=r)t.push.apply(t,e[0][s].slice(i,i+r));return t},zh=ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Rn(t)})):Uh(e)}:Uh,qh=function(e,t,r){for(var s=[],i=t;i<r;i+=2)s.push(String.fromCharCode(yi(e,i)));return s.join("").replace(_i,"")},Kc=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_i,""):qh(e,t,r)}:qh,Wh=function(e,t,r){for(var s=[],i=t;i<t+r;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},zf=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Wh(e,t,r)}:Wh,Hh=function(e,t,r){for(var s=[],i=t;i<r;i++)s.push(String.fromCharCode(Os(e,i)));return s.join("")},ra=ct?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):Hh(t,r,s)}:Hh,qf=function(e,t){var r=Ir(e,t);return r>0?ra(e,t+4,t+4+r-1):""},Wf=qf,Hf=function(e,t){var r=Ir(e,t);return r>0?ra(e,t+4,t+4+r-1):""},Vf=Hf,Gf=function(e,t){var r=2*Ir(e,t);return r>0?ra(e,t+4,t+4+r-1):""},Yf=Gf,Kf=function(t,r){var s=Ir(t,r);return s>0?Kc(t,r+4,r+4+s):""},Xf=Kf,Qf=function(e,t){var r=Ir(e,t);return r>0?ra(e,t+4,t+4+r):""},Jf=Qf,Zf=function(e,t){return nw(e,t)},ko=Zf,Xc=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ct&&(Wf=function(t,r){if(!Buffer.isBuffer(t))return qf(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Vf=function(t,r){if(!Buffer.isBuffer(t))return Hf(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Yf=function(t,r){if(!Buffer.isBuffer(t))return Gf(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},Xf=function(t,r){if(!Buffer.isBuffer(t))return Kf(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},Jf=function(t,r){if(!Buffer.isBuffer(t))return Qf(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},ko=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Zf(t,r)},Xc=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Os=function(e,t){return e[t]},yi=function(e,t){return e[t+1]*256+e[t]},iw=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ir=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ts=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},aw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ci(e,t){var r="",s,i,a=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(yi(this,c)),c+=2;e*=2;break;case"utf8":r=ra(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Kc(this,this.l,this.l+e);break;case"wstr":return Ci.call(this,e,"dbcs");case"lpstr-ansi":r=Wf(this,this.l),e=4+Ir(this,this.l);break;case"lpstr-cp":r=Vf(this,this.l),e=4+Ir(this,this.l);break;case"lpwstr":r=Yf(this,this.l),e=4+2*Ir(this,this.l);break;case"lpp4":e=4+Ir(this,this.l),r=Xf(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ir(this,this.l),r=Jf(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Os(this,this.l+e++))!==0;)a.push(Aa(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=yi(this,this.l+e))!==0;)a.push(Aa(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Os(this,c),this.l=c+1,l=Ci.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Aa(yi(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Os(this,c),this.l=c+1,l=Ci.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Aa(Os(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return s=Os(this,this.l),this.l++,s;case 2:return s=(t==="i"?iw:yi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?ts:aw)(this,this.l),this.l+=4,s):(i=Ir(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ko(this,this.l):i=ko([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=zf(this,this.l,e);break}}return this.l+=e,r}var ow=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},lw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function dw(e,t,r){var s=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)cw(this,t.charCodeAt(i),this.l+2*i);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;s=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,ow(this,t,this.l);break;case 8:if(s=8,r==="f"){sw(this,t,this.l);break}case 16:break;case-4:s=4,lw(this,t,this.l);break}return this.l+=s,this}function e0(e,t){var r=zf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function kr(e,t){e.l=t,e.read_shift=Ci,e.chk=e0,e.write_shift=dw}function pn(e,t){e.l+=t}function fe(e){var t=ds(e);return kr(t,0),t}function jr(){var e=[],t=ct?256:2048,r=function(c){var h=fe(c);return kr(h,0),h},s=r(t),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(c){return s&&c<s.length-s.l?s:(i(),s=r(Math.max(c+1,t)))},o=function(){return i(),rr(e)},l=function(c){i(),s=c,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function je(e,t,r,s){var i=+t,a;if(!isNaN(i)){s||(s=n_[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var o=e.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Xc(r)&&e.push(r)}}function Ai(e,t,r){var s=Er(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Vh(e,t,r){var s=Er(e);return s.s=Ai(s.s,t.s,r),s.e=Ai(s.e,t.s,r),s}function Ii(e,t){if(e.cRel&&e.c<0)for(e=Er(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Er(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=mt(e);return!e.cRel&&e.cRel!=null&&(r=fw(r)),!e.rRel&&e.rRel!=null&&(r=hw(r)),r}function Wl(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ur(e.s.c)+":"+(e.e.cRel?"":"$")+ur(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ir(e.s.r)+":"+(e.e.rRel?"":"$")+ir(e.e.r):Ii(e.s,t.biff)+":"+Ii(e.e,t.biff)}function Qc(e){return parseInt(uw(e),10)-1}function ir(e){return""+(e+1)}function hw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uw(e){return e.replace(/\$(\d+)$/,"$1")}function Jc(e){for(var t=xw(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function ur(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fw(e){return e.replace(/^([A-Z])/,"$$$1")}function xw(e){return e.replace(/^\$([A-Z])/,"$1")}function pw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(e){for(var t=0,r=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Pr(e){var t=e.indexOf(":");return t==-1?{s:Kt(e),e:Kt(e)}:{s:Kt(e.slice(0,t)),e:Kt(e.slice(t+1))}}function Mt(e,t){return typeof t>"u"||typeof t=="number"?Mt(e.s,e.e):(typeof e!="string"&&(e=mt(e)),typeof t!="string"&&(t=mt(t)),e==t?e:e+":"+t)}function Et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,i=0,a=e.length;for(r=0;s<a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.s.c=--r,r=0;s<a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;if(t.s.r=--r,s===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.e.c=--r,r=0;s!=a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;return t.e.r=--r,t}function Gh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qn(e.z,r?Sr(t):t)}catch{}try{return e.w=qn((e.XF||{}).numFmtId||(r?14:0),r?Sr(t):t)}catch{return""+t}}function Nn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?na[e.v]||e.v:t==null?Gh(e,e.v):Gh(e,t))}function ms(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function t0(e,t,r){var s=r||{},i=e?Array.isArray(e):s.dense,a=e||(i?[]:{}),o=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Kt(s.origin):s.origin;o=d.r,l=d.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=Et(a["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),o==-1&&(c.e.r=o=h.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[f].length;++u)if(!(typeof t[f][u]>"u")){var p={v:t[f][u]},g=o+f,x=l+u;if(c.s.r>g&&(c.s.r=g),c.s.c>x&&(c.s.c=x),c.e.r<g&&(c.e.r=g),c.e.c<x&&(c.e.c=x),t[f][u]&&typeof t[f][u]=="object"&&!Array.isArray(t[f][u])&&!(t[f][u]instanceof Date))p=t[f][u];else if(Array.isArray(p.v)&&(p.f=t[f][u][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(s.nullError)p.t="e",p.v=0;else if(s.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=s.dateNF||Pt[14],s.cellDates?(p.t="d",p.w=qn(p.z,Sr(p.v))):(p.t="n",p.v=Sr(p.v),p.w=qn(p.z,p.v))):p.t="s";if(i)a[g]||(a[g]=[]),a[g][x]&&a[g][x].z&&(p.z=a[g][x].z),a[g][x]=p;else{var m=mt({c:x,r:g});a[m]&&a[m].z&&(p.z=a[m].z),a[m]=p}}}return c.s.c<1e7&&(a["!ref"]=Mt(c)),a}function ti(e,t){return t0(null,e,t)}function mw(e){return e.read_shift(4,"i")}function Jr(e,t){return t||(t=fe(4)),t.write_shift(4,e),t}function fr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Xt(e,t){var r=!1;return t==null&&(r=!0,t=fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function gw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yw(e,t){return t||(t=fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Zc(e,t){var r=e.l,s=e.read_shift(1),i=fr(e),a=[],o={t:i,h:i};if(s&1){for(var l=e.read_shift(4),d=0;d!=l;++d)a.push(gw(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function vw(e,t){var r=!1;return t==null&&(r=!0,t=fe(15+4*e.t.length)),t.write_shift(1,0),Xt(e.t,t),r?t.slice(0,t.l):t}var bw=Zc;function ww(e,t){var r=!1;return t==null&&(r=!0,t=fe(23+4*e.t.length)),t.write_shift(1,1),Xt(e.t,t),t.write_shift(4,1),yw({},t),r?t.slice(0,t.l):t}function zr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gs(e,t){return t==null&&(t=fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ys(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function vs(e,t){return t==null&&(t=fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var jw=fr,r0=Xt;function ed(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Co(e,t){var r=!1;return t==null&&(r=!0,t=fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Sw=fr,mc=ed,td=Co;function n0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var i=s===0?ko([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ts(t,0)>>2;return r?i/100:i}function s0(e,t){t==null&&(t=fe(4));var r=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function i0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Ew(e,t){return t||(t=fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bs=i0,ri=Ew;function ni(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hs(e,t){return(t||fe(8)).write_shift(8,e,"f")}function Tw(e){var t={},r=e.read_shift(1),s=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=i;var c=Pw[i];c&&(t.rgb=su(c));break;case 2:t.rgb=su([o,l,d]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Ao(e,t){if(t||(t=fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function _w(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function kw(e,t){t||(t=fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var a0=2,_r=3,Ra=11,Io=19,Pa=64,Cw=65,Aw=71,Iw=4108,Nw=4126,tr=80,Yh={1:{n:"CodePage",t:a0},2:{n:"Category",t:tr},3:{n:"PresentationFormat",t:tr},4:{n:"ByteCount",t:_r},5:{n:"LineCount",t:_r},6:{n:"ParagraphCount",t:_r},7:{n:"SlideCount",t:_r},8:{n:"NoteCount",t:_r},9:{n:"HiddenCount",t:_r},10:{n:"MultimediaClipCount",t:_r},11:{n:"ScaleCrop",t:Ra},12:{n:"HeadingPairs",t:Iw},13:{n:"TitlesOfParts",t:Nw},14:{n:"Manager",t:tr},15:{n:"Company",t:tr},16:{n:"LinksUpToDate",t:Ra},17:{n:"CharacterCount",t:_r},19:{n:"SharedDoc",t:Ra},22:{n:"HyperlinksChanged",t:Ra},23:{n:"AppVersion",t:_r,p:"version"},24:{n:"DigSig",t:Cw},26:{n:"ContentType",t:tr},27:{n:"ContentStatus",t:tr},28:{n:"Language",t:tr},29:{n:"Version",t:tr},255:{},2147483648:{n:"Locale",t:Io},2147483651:{n:"Behavior",t:Io},1919054434:{}},Kh={1:{n:"CodePage",t:a0},2:{n:"Title",t:tr},3:{n:"Subject",t:tr},4:{n:"Author",t:tr},5:{n:"Keywords",t:tr},6:{n:"Comments",t:tr},7:{n:"Template",t:tr},8:{n:"LastAuthor",t:tr},9:{n:"RevNumber",t:tr},10:{n:"EditTime",t:Pa},11:{n:"LastPrinted",t:Pa},12:{n:"CreatedDate",t:Pa},13:{n:"ModifiedDate",t:Pa},14:{n:"PageCount",t:_r},15:{n:"WordCount",t:_r},16:{n:"CharCount",t:_r},17:{n:"Thumbnail",t:Aw},18:{n:"Application",t:tr},19:{n:"DocSecurity",t:_r},255:{},2147483648:{n:"Locale",t:Io},2147483651:{n:"Behavior",t:Io},1919054434:{}};function Fw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Rw=Fw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pw=Er(Rw),na={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Da={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function o0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function l0(e,t){var r=Hb(Dw),s=[],i;s[s.length]=$t,s[s.length]=Ae("Types",null,{xmlns:Yt.CT,"xmlns:xsd":Yt.xsd,"xmlns:xsi":Yt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ae("Default",null,{Extension:d[0],ContentType:d[1]})}));var a=function(d){e[d]&&e[d].length>0&&(i=e[d][0],s[s.length]=Ae("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Da[d][t.bookType]||Da[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){s[s.length]=Ae("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Da[d][t.bookType]||Da[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){s[s.length]=Ae("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var ot={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function c0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function qs(e){var t=[$t,Ae("Relationships",null,{xmlns:Yt.RELS})];return ar(e["!id"]).forEach(function(r){t[t.length]=Ae("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ft(e,t,r,s,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=s,i.Target=r,[ot.HLINK,ot.XPATH,ot.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Lw(e){var t=[$t];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Xh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Ow(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Bw(e){var t=[$t];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Xh(e[r][0],e[r][1])),t.push(Ow("",e[r][0]));return t.push(Xh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function d0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jo.version+"</meta:generator></office:meta></office:document-meta>"}var is=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Hl(e,t,r,s,i){i[e]!=null||t==null||t===""||(i[e]=t,t=pt(t),s[s.length]=r?Ae(e,t,r):nr(e,t))}function h0(e,t){var r=t||{},s=[$t,Ae("cp:coreProperties",null,{"xmlns:cp":Yt.CORE_PROPS,"xmlns:dc":Yt.dc,"xmlns:dcterms":Yt.dcterms,"xmlns:dcmitype":Yt.dcmitype,"xmlns:xsi":Yt.xsi})],i={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Hl("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:pc(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&Hl("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:pc(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var a=0;a!=is.length;++a){var o=is[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Hl(o[0],l,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Ws=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],u0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function f0(e){var t=[],r=Ae;return e||(e={}),e.Application="SheetJS",t[t.length]=$t,t[t.length]=Ae("Properties",null,{xmlns:Yt.EXT_PROPS,"xmlns:vt":Yt.vt}),Ws.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=pt(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(s[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+pt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function x0(e){var t=[$t,Ae("Properties",null,{xmlns:Yt.CUST_PROPS,"xmlns:vt":Yt.vt})];if(!e)return t.join("");var r=1;return ar(e).forEach(function(i){++r,t[t.length]=Ae("property",rw(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:pt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Qh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Mw(e,t){var r=[];return ar(Qh).map(function(s){for(var i=0;i<is.length;++i)if(is[i][1]==s)return is[i];for(i=0;i<Ws.length;++i)if(Ws[i][1]==s)return Ws[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(nr(Qh[s[1]]||s[1],i))}}),Ae("DocumentProperties",r.join(""),{xmlns:Ar.o})}function $w(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&ar(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<is.length;++o)if(a==is[o][1])return;for(o=0;o<Ws.length;++o)if(a==Ws[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),i.push(Ae(Bh(a),l,{"dt:dt":d}))}}),t&&ar(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ae(Bh(a),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Ar.o+'">'+i.join("")+"</"+s+">"}function Uw(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),i=(r-s)/Math.pow(2,32);s*=1e7,i*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),i+=a);var o=fe(8);return o.write_shift(4,s),o.write_shift(4,i),o}function Jh(e,t){var r=fe(4),s=fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=fe(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=Uw(t);break;case 31:case 80:for(s=fe(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return rr([r,s])}var p0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zw(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Zh(e,t,r){var s=fe(8),i=[],a=[],o=8,l=0,d=fe(8),c=fe(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),a.push(d),i.push(c),o+=8+d.length,!t){c=fe(8),c.write_shift(4,0),i.unshift(c);var h=[fe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(d=fe(8+2*(f.length+1)+(f.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,f.length+1),d.write_shift(0,f,"dbcs");d.l!=d.length;)d.write_shift(1,0);h.push(d)}d=rr(h),a.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(p0.indexOf(e[l][0])>-1||u0.indexOf(e[l][0])>-1)&&e[l][1]!=null){var u=e[l][1],p=0;if(t){p=+t[e[l][0]];var g=r[p];if(g.p=="version"&&typeof u=="string"){var x=u.split(".");u=(+x[0]<<16)+(+x[1]||0)}d=Jh(g.t,u)}else{var m=zw(u);m==-1&&(m=31,u=String(u)),d=Jh(m,u)}a.push(d),c=fe(8),c.write_shift(4,t?p:2+l),i.push(c),o+=8+d.length}var v=8*(a.length+1);for(l=0;l<a.length;++l)i[l].write_shift(4,v),v+=a[l].length;return s.write_shift(4,o),s.write_shift(4,a.length),rr([s].concat(i).concat(a))}function eu(e,t,r,s,i,a){var o=fe(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,yt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var d=Zh(e,r,s);if(l.push(d),i){var c=Zh(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+d.length),l.push(c)}return rr(l)}function qw(e,t){t||(t=fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Ww(e,t){return e.read_shift(t)===1}function pr(e,t){return t||(t=fe(2)),t.write_shift(2,+!!e),t}function m0(e){return e.read_shift(2,"u")}function Or(e,t){return t||(t=fe(2)),t.write_shift(2,e),t}function g0(e,t,r){return r||(r=fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function y0(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=s?e.read_shift(s,i):"";return o}function Hw(e){var t=e.t||"",r=fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=fe(2*t.length);s.write_shift(2*t.length,t,"utf16le");var i=[r,s];return rr(i)}function Vw(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Gw(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Vw(e,s,r)}function Yw(e,t,r){if(r.biff>5)return Gw(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function v0(e,t,r){return r||(r=fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function tu(e,t){t||(t=fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Kw(e){var t=fe(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),a=i>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)s=s.slice(1),tu(s,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?s.slice(0,i):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&tu(i>-1?s.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function us(e,t,r,s){return s||(s=fe(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function Xw(e,t,r){var s=r.biff>8?4:2,i=e.read_shift(s),a=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[i,a,o]}function Qw(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:t},e:{c:i,r}}}function b0(e,t){return t||(t=fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function rd(e,t,r){var s=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=fe(i);return a.write_shift(2,s),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Jw(e,t){var r=!t||t.biff==8,s=fe(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function Zw(e,t){var r=!t||t.biff>=8?2:1,s=fe(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function e2(e,t){var r=fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=Hw(e[i]);var a=rr([r].concat(s));return a.parts=[r.length].concat(s.map(function(o){return o.length})),a}function t2(){var e=fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function r2(e){var t=fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function n2(e,t){var r=e.name||"Arial",s=t&&t.biff==5,i=s?15+r.length:16+2*r.length,a=fe(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function s2(e,t,r,s){var i=fe(10);return us(e,t,s,i),i.write_shift(4,r),i}function i2(e,t,r,s,i){var a=!i||i.biff==8,o=fe(8+ +a+(1+a)*r.length);return us(e,t,s,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function a2(e,t,r,s){var i=r&&r.biff==5;s||(s=fe(i?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(i?1:2,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}function o2(e,t){var r=t.biff==8||!t.biff?4:2,s=fe(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function ru(e,t,r,s){var i=r&&r.biff==5;s||(s=fe(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function l2(e){var t=fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function c2(e,t,r,s,i,a){var o=fe(8);return us(e,t,s,o),g0(r,a,o),o}function d2(e,t,r,s){var i=fe(14);return us(e,t,s,i),hs(r,i),i}function h2(e,t,r){if(r.biff<8)return u2(e,t,r);for(var s=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(Xw(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function u2(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=y0(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function f2(e){var t=fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)b0(e[r],t);return t}function x2(e){var t=fe(24),r=Kt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(s[i],16));return rr([t,Kw(e[1])])}function p2(e){var t=e[1].Tooltip,r=fe(10+2*(t.length+1));r.write_shift(2,2048);var s=Kt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function m2(e){return e||(e=fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function g2(e,t,r){if(!r.cellStyles)return pn(e,t);var s=r&&r.biff>=12?4:2,i=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var c={s:i,e:a,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function y2(e,t){var r=fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function v2(e){for(var t=fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function b2(e,t,r){var s=fe(15);return ia(s,e,t),s.write_shift(8,r,"f"),s}function w2(e,t,r){var s=fe(9);return ia(s,e,t),s.write_shift(2,r),s}var j2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Hc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],h=ds(1);switch(d.type){case"base64":h=Gr(In(l));break;case"binary":h=Gr(l);break;case"buffer":case"array":h=l;break}kr(h,0);var f=h.read_shift(1),u=!!(f&136),p=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,u=!0;break;case 49:p=!0,u=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,m=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(m=h.read_shift(2));var v=h.read_shift(2),S=d.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var T=[],y={},w=Math.min(h.length,f==2?521:m-10-(p?264:0)),k=g?32:11;h.l<w&&h[h.l]!=13;)switch(y={},y.name=_h.utils.decode(S,h.slice(h.l,h.l+k)).replace(/[\u0000\r\n].*$/g,""),h.l+=k,y.type=String.fromCharCode(h.read_shift(1)),f!=2&&!g&&(y.offset=h.read_shift(4)),y.len=h.read_shift(1),f==2&&(y.offset=h.read_shift(2)),y.dec=h.read_shift(1),y.name.length&&T.push(y),f!=2&&(h.l+=g?13:14),y.type){case"B":(!p||y.len!=8)&&d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(h[h.l]!==13&&(h.l=m-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=m;var b=0,j=0;for(c[0]=[],j=0;j!=T.length;++j)c[0][j]=T[j].name;for(;x-- >0;){if(h[h.l]===42){h.l+=v;continue}for(++h.l,c[++b]=[],j=0,j=0;j!=T.length;++j){var A=h.slice(h.l,h.l+T[j].len);h.l+=T[j].len,kr(A,0);var E=_h.utils.decode(S,A);switch(T[j].type){case"C":E.trim().length&&(c[b][j]=E.replace(/\s+$/,""));break;case"D":E.length===8?c[b][j]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):c[b][j]=E;break;case"F":c[b][j]=parseFloat(E.trim());break;case"+":case"I":c[b][j]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":c[b][j]=!0;break;case"N":case"F":c[b][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[b][j]="##MEMO##"+(g?parseInt(E.trim(),10):A.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(c[b][j]=+E||0);break;case"@":c[b][j]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[b][j]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[b][j]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][j]=-A.read_shift(-8,"f");break;case"B":if(p&&T[j].len==8){c[b][j]=A.read_shift(8,"f");break}case"G":case"P":A.l+=T[j].len;break;case"0":if(T[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[j].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=T,c}function s(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var h=ti(r(l,c),c);return h["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,h}function i(l,d){try{return ms(s(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&Ui(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=jr(),f=Do(l,{header:1,raw:!0,cellDates:!0}),u=f[0],p=f.slice(1),g=l["!cols"]||[],x=0,m=0,v=0,S=1;for(x=0;x<u.length;++x){if(((g[x]||{}).DBF||{}).name){u[x]=g[x].DBF.name,++v;continue}if(u[x]!=null){if(++v,typeof u[x]=="number"&&(u[x]=u[x].toString(10)),typeof u[x]!="string")throw new Error("DBF Invalid column name "+u[x]+" |"+typeof u[x]+"|");if(u.indexOf(u[x])!==x){for(m=0;m<1024;++m)if(u.indexOf(u[x]+"_"+m)==-1){u[x]+="_"+m;break}}}}var T=Et(l["!ref"]),y=[],w=[],k=[];for(x=0;x<=T.e.c-T.s.c;++x){var b="",j="",A=0,E=[];for(m=0;m<p.length;++m)p[m][x]!=null&&E.push(p[m][x]);if(E.length==0||u[x]==null){y[x]="?";continue}for(m=0;m<E.length;++m){switch(typeof E[m]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=E[m]instanceof Date?"D":"C";break;default:j="C"}A=Math.max(A,String(E[m]).length),b=b&&b!=j?"C":j}A>250&&(A=250),j=((g[x]||{}).DBF||{}).type,j=="C"&&g[x].DBF.len>A&&(A=g[x].DBF.len),b=="B"&&j=="N"&&(b="N",k[x]=g[x].DBF.dec,A=g[x].DBF.len),w[x]=b=="C"||j=="N"?A:a[b]||0,S+=w[x],y[x]=b}var C=h.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*v),C.write_shift(2,S),x=0;x<4;++x)C.write_shift(4,0);for(C.write_shift(4,0|(+t[jf]||3)<<8),x=0,m=0;x<u.length;++x)if(u[x]!=null){var I=h.next(32),F=(u[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,F,"sbcs"),I.write_shift(1,y[x]=="?"?"C":y[x],"sbcs"),I.write_shift(4,m),I.write_shift(1,w[x]||a[y[x]]||0),I.write_shift(1,k[x]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),m+=w[x]||a[y[x]]||0}var N=h.next(264);for(N.write_shift(4,13),x=0;x<65;++x)N.write_shift(4,0);for(x=0;x<p.length;++x){var U=h.next(S);for(U.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(y[m]){case"L":U.write_shift(1,p[x][m]==null?63:p[x][m]?84:70);break;case"B":U.write_shift(8,p[x][m]||0,"f");break;case"N":var M="0";for(typeof p[x][m]=="number"&&(M=p[x][m].toFixed(k[m]||0)),v=0;v<w[m]-M.length;++v)U.write_shift(1,32);U.write_shift(1,M,"sbcs");break;case"D":p[x][m]?(U.write_shift(4,("0000"+p[x][m].getFullYear()).slice(-4),"sbcs"),U.write_shift(2,("00"+(p[x][m].getMonth()+1)).slice(-2),"sbcs"),U.write_shift(2,("00"+p[x][m].getDate()).slice(-2),"sbcs")):U.write_shift(8,"00000000","sbcs");break;case"C":var L=String(p[x][m]!=null?p[x][m]:"").slice(0,w[m]);for(U.write_shift(1,L,"sbcs"),v=0;v<w[m]-L.length;++v)U.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:s,from_sheet:o}}(),S2=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ar(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,p){var g=e[p];return typeof g=="number"?Th(g):g},s=function(u,p,g){var x=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?u:Th(x)};e["|"]=254;function i(u,p){switch(p.type){case"base64":return a(In(u),p);case"binary":return a(u,p);case"buffer":return a(ct&&Buffer.isBuffer(u)?u.toString("binary"):ea(u),p);case"array":return a(Qo(u),p)}throw new Error("Unrecognized type "+p.type)}function a(u,p){var g=u.split(/[\n\r]+/),x=-1,m=-1,v=0,S=0,T=[],y=[],w=null,k={},b=[],j=[],A=[],E=0,C;for(+p.codepage>=0&&Ui(+p.codepage);v!==g.length;++v){E=0;var I=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),F=I.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),N=F[0],U;if(I.length>0)switch(N){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&y.push(I.slice(3).replace(/;;/g,";"));break;case"C":var M=!1,L=!1,z=!1,J=!1,ne=-1,te=-1;for(S=1;S<F.length;++S)switch(F[S].charAt(0)){case"A":break;case"X":m=parseInt(F[S].slice(1))-1,L=!0;break;case"Y":for(x=parseInt(F[S].slice(1))-1,L||(m=0),C=T.length;C<=x;++C)T[C]=[];break;case"K":U=F[S].slice(1),U.charAt(0)==='"'?U=U.slice(1,U.length-1):U==="TRUE"?U=!0:U==="FALSE"?U=!1:isNaN(_n(U))?isNaN(qi(U).getDate())||(U=yr(U)):(U=_n(U),w!==null&&Pf(w)&&(U=Bf(U))),M=!0;break;case"E":J=!0;var P=wj(F[S].slice(1),{r:x,c:m});T[x][m]=[T[x][m],P];break;case"S":z=!0,T[x][m]=[T[x][m],"S5S"];break;case"G":break;case"R":ne=parseInt(F[S].slice(1))-1;break;case"C":te=parseInt(F[S].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(M&&(T[x][m]&&T[x][m].length==2?T[x][m][0]=U:T[x][m]=U,w=null),z){if(J)throw new Error("SYLK shared formula cannot have own formula");var H=ne>-1&&T[ne][te];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");T[x][m][1]=jj(H[1],{r:x-ne,c:m-te})}break;case"F":var B=0;for(S=1;S<F.length;++S)switch(F[S].charAt(0)){case"X":m=parseInt(F[S].slice(1))-1,++B;break;case"Y":for(x=parseInt(F[S].slice(1))-1,C=T.length;C<=x;++C)T[C]=[];break;case"M":E=parseInt(F[S].slice(1))/20;break;case"F":break;case"G":break;case"P":w=y[parseInt(F[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=F[S].slice(1).split(" "),C=parseInt(A[0],10);C<=parseInt(A[1],10);++C)E=parseInt(A[2],10),j[C-1]=E===0?{hidden:!0}:{wch:E},nd(j[C-1]);break;case"C":m=parseInt(F[S].slice(1))-1,j[m]||(j[m]={});break;case"R":x=parseInt(F[S].slice(1))-1,b[x]||(b[x]={}),E>0?(b[x].hpt=E,b[x].hpx=T0(E)):E===0&&(b[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}B<1&&(w=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return b.length>0&&(k["!rows"]=b),j.length>0&&(k["!cols"]=j),p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),[T,k]}function o(u,p){var g=i(u,p),x=g[0],m=g[1],v=ti(x,p);return ar(m).forEach(function(S){v[S]=m[S]}),v}function l(u,p){return ms(o(u,p),p)}function d(u,p,g,x){var m="C;Y"+(g+1)+";X"+(x+1)+";K";switch(u.t){case"n":m+=u.v||0,u.f&&!u.F&&(m+=";E"+id(u.f,{r:g,c:x}));break;case"b":m+=u.v?"TRUE":"FALSE";break;case"e":m+=u.w||u.v;break;case"d":m+='"'+(u.w||u.v)+'"';break;case"s":m+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(u,p){p.forEach(function(g,x){var m="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=No(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Fo(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function h(u,p){p.forEach(function(g,x){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*Ro(g.hpx)+";"),m.length>2&&u.push(m+"R"+(x+1))})}function f(u,p){var g=["ID;PWXL;N;E"],x=[],m=Et(u["!ref"]),v,S=Array.isArray(u),T=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),u["!cols"]&&c(g,u["!cols"]),u["!rows"]&&h(g,u["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var y=m.s.r;y<=m.e.r;++y)for(var w=m.s.c;w<=m.e.c;++w){var k=mt({r:y,c:w});v=S?(u[y]||[])[w]:u[k],!(!v||v.v==null&&(!v.f||v.F))&&x.push(d(v,u,y,w))}return g.join(T)+T+x.join(T)+T+"E"+T}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),E2=function(){function e(a,o){switch(o.type){case"base64":return t(In(a),o);case"binary":return t(a,o);case"buffer":return t(ct&&Buffer.isBuffer(a)?a.toString("binary"):ea(a),o);case"array":return t(Qo(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),d=-1,c=-1,h=0,f=[];h!==l.length;++h){if(l[h].trim()==="BOT"){f[++d]=[],c=0;continue}if(!(d<0)){var u=l[h].trim().split(","),p=u[0],g=u[1];++h;for(var x=l[h]||"";(x.match(/["]/g)||[]).length&1&&h<l.length-1;)x+=`
`+l[++h];switch(x=x.trim(),+p){case-1:if(x==="BOT"){f[++d]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[d][c]=!0:x==="FALSE"?f[d][c]=!1:isNaN(_n(g))?isNaN(qi(g).getDate())?f[d][c]=g:f[d][c]=yr(g):f[d][c]=_n(g),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[d][c++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return ti(e(a,o),o)}function s(a,o){return ms(r(a,o),o)}var i=function(){var a=function(d,c,h,f,u){d.push(c),d.push(h+","+f),d.push('"'+u.replace(/"/g,'""')+'"')},o=function(d,c,h,f){d.push(c+","+h),d.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(d){var c=[],h=Et(d["!ref"]),f,u=Array.isArray(d);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,h.e.r-h.s.r+1,""),a(c,"TUPLES",0,h.e.c-h.s.c+1,""),a(c,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){o(c,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var x=mt({r:p,c:g});if(f=u?(d[p]||[])[g]:d[x],!f){o(c,1,0,"");continue}switch(f.t){case"n":var m=f.w;!m&&f.v!=null&&(m=f.v),m==null?f.f&&!f.F?o(c,1,0,"="+f.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=qn(f.z||Pt[14],Sr(yr(f.v)))),o(c,0,f.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,S=c.join(v);return S}}();return{to_workbook:s,to_sheet:r,from_sheet:i}}(),w0=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,u){for(var p=f.split(`
`),g=-1,x=-1,m=0,v=[];m!==p.length;++m){var S=p[m].trim().split(":");if(S[0]==="cell"){var T=Kt(S[1]);if(v.length<=T.r)for(g=v.length;g<=T.r;++g)v[g]||(v[g]=[]);switch(g=T.r,x=T.c,S[2]){case"t":v[g][x]=e(S[3]);break;case"v":v[g][x]=+S[3];break;case"vtf":var y=S[S.length-1];case"vtc":switch(S[3]){case"nl":v[g][x]=!!+S[4];break;default:v[g][x]=+S[4];break}S[2]=="vtf"&&(v[g][x]=[v[g][x],y])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function s(f,u){return ti(r(f,u),u)}function i(f,u){return ms(s(f,u),u)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var u=[],p=[],g,x="",m=Pr(f["!ref"]),v=Array.isArray(f),S=m.s.r;S<=m.e.r;++S)for(var T=m.s.c;T<=m.e.c;++T)if(x=mt({r:S,c:T}),g=v?(f[S]||[])[T]:f[x],!(!g||g.v==null||g.t==="z")){switch(p=["cell",x,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var y=Sr(yr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+y,p[5]=g.w||qn(g.z||Pt[14],y);break;case"e":continue}u.push(p.join(":"))}return u.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(f){return[a,o,l,o,c(f),d].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:h}}(),T2=function(){function e(h,f,u,p,g){g.raw?f[u][p]=h:h===""||(h==="TRUE"?f[u][p]=!0:h==="FALSE"?f[u][p]=!1:isNaN(_n(h))?isNaN(qi(h).getDate())?f[u][p]=h:f[u][p]=yr(h):f[u][p]=_n(h))}function t(h,f){var u=f||{},p=[];if(!h||h.length===0)return p;for(var g=h.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var m=10,v=0,S=0;S<=x;++S)v=g[S].indexOf(" "),v==-1?v=g[S].length:v++,m=Math.max(m,v);for(S=0;S<=x;++S){p[S]=[];var T=0;for(e(g[S].slice(0,m).trim(),p,S,T,u),T=1;T<=(g[S].length-m)/10+1;++T)e(g[S].slice(m+(T-1)*10,m+T*10).trim(),p,S,T,u)}return u.sheetRows&&(p=p.slice(0,u.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(h){for(var f={},u=!1,p=0,g=0;p<h.length;++p)(g=h.charCodeAt(p))==34?u=!u:!u&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p]);if(!g.length){f=s;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p])}return g.sort(function(x,m){return x[0]-m[0]||s[x[1]]-s[m[1]]}),r[g.pop()[1]]||44}function a(h,f){var u=f||{},p="",g=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):u&&u.FS?p=u.FS:p=i(h.slice(0,1024));var m=0,v=0,S=0,T=0,y=0,w=p.charCodeAt(0),k=!1,b=0,j=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var A=u.dateNF!=null?Ub(u.dateNF):null;function E(){var C=h.slice(T,y),I={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)I.t="z";else if(u.raw)I.t="s",I.v=C;else if(C.trim().length===0)I.t="s",I.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(I.t="s",I.v=C.slice(2,-1).replace(/""/g,'"')):Sj(C)?(I.t="n",I.f=C.slice(1)):(I.t="s",I.v=C);else if(C=="TRUE")I.t="b",I.v=!0;else if(C=="FALSE")I.t="b",I.v=!1;else if(!isNaN(S=_n(C)))I.t="n",u.cellText!==!1&&(I.w=C),I.v=S;else if(!isNaN(qi(C).getDate())||A&&C.match(A)){I.z=u.dateNF||Pt[14];var F=0;A&&C.match(A)&&(C=zb(C,u.dateNF,C.match(A)||[]),F=1),u.cellDates?(I.t="d",I.v=yr(C,F)):(I.t="n",I.v=Sr(yr(C,F))),u.cellText!==!1&&(I.w=qn(I.z,I.v instanceof Date?Sr(I.v):I.v)),u.cellNF||delete I.z}else I.t="s",I.v=C;if(I.t=="z"||(u.dense?(g[m]||(g[m]=[]),g[m][v]=I):g[mt({c:v,r:m})]=I),T=y+1,j=h.charCodeAt(T),x.e.c<v&&(x.e.c=v),x.e.r<m&&(x.e.r=m),b==w)++v;else if(v=0,++m,u.sheetRows&&u.sheetRows<=m)return!0}e:for(;y<h.length;++y)switch(b=h.charCodeAt(y)){case 34:j===34&&(k=!k);break;case w:case 10:case 13:if(!k&&E())break e;break}return y-T>0&&E(),g["!ref"]=Mt(x),g}function o(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,f):ti(t(h,f),f)}function l(h,f){var u="",p=f.type=="string"?[0,0,0,0]:O_(h,f);switch(f.type){case"base64":u=In(h);break;case"binary":u=h;break;case"buffer":f.codepage==65001?u=h.toString("utf8"):(f.codepage,u=ct&&Buffer.isBuffer(h)?h.toString("binary"):ea(h));break;case"array":u=Qo(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?u=ki(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=ki(u):f.type=="binary",u.slice(0,19)=="socialcalc:version:"?w0.to_sheet(f.type=="string"?u:ki(u),f):o(u,f)}function d(h,f){return ms(l(h,f),f)}function c(h){for(var f=[],u=Et(h["!ref"]),p,g=Array.isArray(h),x=u.s.r;x<=u.e.r;++x){for(var m=[],v=u.s.c;v<=u.e.c;++v){var S=mt({r:x,c:v});if(p=g?(h[x]||[])[v]:h[S],!p||p.v==null){m.push("          ");continue}for(var T=(p.w||(Nn(p),p.w)||"").slice(0,10);T.length<10;)T+=" ";m.push(T+(v===0?" ":""))}f.push(m.join(""))}return f.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}}(),nu=function(){function e(P,H,B){if(P){kr(P,P.l||0);for(var R=B.Enum||ne;P.l<P.length;){var K=P.read_shift(2),se=R[K]||R[65535],we=P.read_shift(2),ye=P.l+we,X=se.f&&se.f(P,we,B);if(P.l=ye,H(X,se,K))return}}}function t(P,H){switch(H.type){case"base64":return r(Gr(In(P)),H);case"binary":return r(Gr(P),H);case"buffer":case"array":return r(P,H)}throw"Unsupported type "+H.type}function r(P,H){if(!P)return P;var B=H||{},R=B.dense?[]:{},K="Sheet1",se="",we=0,ye={},X=[],ee=[],ce={s:{r:0,c:0},e:{r:0,c:0}},xe=B.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)B.Enum=ne,e(P,function(ve,Fe,pe){switch(pe){case 0:B.vers=ve,ve>=4096&&(B.qpro=!0);break;case 6:ce=ve;break;case 204:ve&&(se=ve);break;case 222:se=ve;break;case 15:case 51:B.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:pe==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=B.dateNF||Pt[14],B.cellDates&&(ve[1].t="d",ve[1].v=Bf(ve[1].v))),B.qpro&&ve[3]>we&&(R["!ref"]=Mt(ce),ye[K]=R,X.push(K),R=B.dense?[]:{},ce={s:{r:0,c:0},e:{r:0,c:0}},we=ve[3],K=se||"Sheet"+(we+1),se="");var Ue=B.dense?(R[ve[0].r]||[])[ve[0].c]:R[mt(ve[0])];if(Ue){Ue.t=ve[1].t,Ue.v=ve[1].v,ve[1].z!=null&&(Ue.z=ve[1].z),ve[1].f!=null&&(Ue.f=ve[1].f);break}B.dense?(R[ve[0].r]||(R[ve[0].r]=[]),R[ve[0].r][ve[0].c]=ve[1]):R[mt(ve[0])]=ve[1];break}},B);else if(P[2]==26||P[2]==14)B.Enum=te,P[2]==14&&(B.qpro=!0,P.l=0),e(P,function(ve,Fe,pe){switch(pe){case 204:K=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>we&&(R["!ref"]=Mt(ce),ye[K]=R,X.push(K),R=B.dense?[]:{},ce={s:{r:0,c:0},e:{r:0,c:0}},we=ve[3],K="Sheet"+(we+1)),xe>0&&ve[0].r>=xe)break;B.dense?(R[ve[0].r]||(R[ve[0].r]=[]),R[ve[0].r][ve[0].c]=ve[1]):R[mt(ve[0])]=ve[1],ce.e.c<ve[0].c&&(ce.e.c=ve[0].c),ce.e.r<ve[0].r&&(ce.e.r=ve[0].r);break;case 27:ve[14e3]&&(ee[ve[14e3][0]]=ve[14e3][1]);break;case 1537:ee[ve[0]]=ve[1],ve[0]==we&&(K=ve[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(R["!ref"]=Mt(ce),ye[se||K]=R,X.push(se||K),!ee.length)return{SheetNames:X,Sheets:ye};for(var Z={},ge=[],be=0;be<ee.length;++be)ye[X[be]]?(ge.push(ee[be]||X[be]),Z[ee[be]]=ye[ee[be]]||ye[X[be]]):(ge.push(ee[be]),Z[ee[be]]={"!ref":"A1"});return{SheetNames:ge,Sheets:Z}}function s(P,H){var B=H||{};if(+B.codepage>=0&&Ui(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var R=jr(),K=Et(P["!ref"]),se=Array.isArray(P),we=[];Ie(R,0,a(1030)),Ie(R,6,d(K));for(var ye=Math.min(K.e.r,8191),X=K.s.r;X<=ye;++X)for(var ee=ir(X),ce=K.s.c;ce<=K.e.c;++ce){X===K.s.r&&(we[ce]=ur(ce));var xe=we[ce]+ee,Z=se?(P[X]||[])[ce]:P[xe];if(!(!Z||Z.t=="z"))if(Z.t=="n")(Z.v|0)==Z.v&&Z.v>=-32768&&Z.v<=32767?Ie(R,13,p(X,ce,Z.v)):Ie(R,14,x(X,ce,Z.v));else{var ge=Nn(Z);Ie(R,15,f(X,ce,ge.slice(0,239)))}}return Ie(R,1),R.end()}function i(P,H){var B=H||{};if(+B.codepage>=0&&Ui(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var R=jr();Ie(R,0,o(P));for(var K=0,se=0;K<P.SheetNames.length;++K)(P.Sheets[P.SheetNames[K]]||{})["!ref"]&&Ie(R,27,J(P.SheetNames[K],se++));var we=0;for(K=0;K<P.SheetNames.length;++K){var ye=P.Sheets[P.SheetNames[K]];if(!(!ye||!ye["!ref"])){for(var X=Et(ye["!ref"]),ee=Array.isArray(ye),ce=[],xe=Math.min(X.e.r,8191),Z=X.s.r;Z<=xe;++Z)for(var ge=ir(Z),be=X.s.c;be<=X.e.c;++be){Z===X.s.r&&(ce[be]=ur(be));var ve=ce[be]+ge,Fe=ee?(ye[Z]||[])[be]:ye[ve];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")Ie(R,23,E(Z,be,we,Fe.v));else{var pe=Nn(Fe);Ie(R,22,b(Z,be,we,pe.slice(0,239)))}}++we}}return Ie(R,1),R.end()}function a(P){var H=fe(2);return H.write_shift(2,P),H}function o(P){var H=fe(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var B=0,R=0,K=0,se=0;se<P.SheetNames.length;++se){var we=P.SheetNames[se],ye=P.Sheets[we];if(!(!ye||!ye["!ref"])){++K;var X=Pr(ye["!ref"]);B<X.e.r&&(B=X.e.r),R<X.e.c&&(R=X.e.c)}}return B>8191&&(B=8191),H.write_shift(2,B),H.write_shift(1,K),H.write_shift(1,R),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(P,H,B){var R={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&B.qpro?(R.s.c=P.read_shift(1),P.l++,R.s.r=P.read_shift(2),R.e.c=P.read_shift(1),P.l++,R.e.r=P.read_shift(2),R):(R.s.c=P.read_shift(2),R.s.r=P.read_shift(2),H==12&&B.qpro&&(P.l+=2),R.e.c=P.read_shift(2),R.e.r=P.read_shift(2),H==12&&B.qpro&&(P.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function d(P){var H=fe(8);return H.write_shift(2,P.s.c),H.write_shift(2,P.s.r),H.write_shift(2,P.e.c),H.write_shift(2,P.e.r),H}function c(P,H,B){var R=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(R[0].c=P.read_shift(1),R[3]=P.read_shift(1),R[0].r=P.read_shift(2),P.l+=2):(R[2]=P.read_shift(1),R[0].c=P.read_shift(2),R[0].r=P.read_shift(2)),R}function h(P,H,B){var R=P.l+H,K=c(P,H,B);if(K[1].t="s",B.vers==20768){P.l++;var se=P.read_shift(1);return K[1].v=P.read_shift(se,"utf8"),K}return B.qpro&&P.l++,K[1].v=P.read_shift(R-P.l,"cstr"),K}function f(P,H,B){var R=fe(7+B.length);R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,P),R.write_shift(1,39);for(var K=0;K<R.length;++K){var se=B.charCodeAt(K);R.write_shift(1,se>=128?95:se)}return R.write_shift(1,0),R}function u(P,H,B){var R=c(P,H,B);return R[1].v=P.read_shift(2,"i"),R}function p(P,H,B){var R=fe(7);return R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,P),R.write_shift(2,B,"i"),R}function g(P,H,B){var R=c(P,H,B);return R[1].v=P.read_shift(8,"f"),R}function x(P,H,B){var R=fe(13);return R.write_shift(1,255),R.write_shift(2,H),R.write_shift(2,P),R.write_shift(8,B,"f"),R}function m(P,H,B){var R=P.l+H,K=c(P,H,B);if(K[1].v=P.read_shift(8,"f"),B.qpro)P.l=R;else{var se=P.read_shift(2);y(P.slice(P.l,P.l+se),K),P.l+=se}return K}function v(P,H,B){var R=H&32768;return H&=-32769,H=(R?P:0)+(H>=8192?H-16384:H),(R?"":"$")+(B?ur(H):ir(H))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(P,H){kr(P,0);for(var B=[],R=0,K="",se="",we="",ye="";P.l<P.length;){var X=P[P.l++];switch(X){case 0:B.push(P.read_shift(8,"f"));break;case 1:se=v(H[0].c,P.read_shift(2),!0),K=v(H[0].r,P.read_shift(2),!1),B.push(se+K);break;case 2:{var ee=v(H[0].c,P.read_shift(2),!0),ce=v(H[0].r,P.read_shift(2),!1);se=v(H[0].c,P.read_shift(2),!0),K=v(H[0].r,P.read_shift(2),!1),B.push(ee+ce+":"+se+K)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(P.read_shift(2));break;case 6:{for(var xe="";X=P[P.l++];)xe+=String.fromCharCode(X);B.push('"'+xe.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:ye=B.pop(),we=B.pop(),B.push(["AND","OR"][X-20]+"("+we+","+ye+")");break;default:if(X<32&&T[X])ye=B.pop(),we=B.pop(),B.push(we+T[X]+ye);else if(S[X]){if(R=S[X][1],R==69&&(R=P[P.l++]),R>B.length){console.error("WK1 bad formula parse 0x"+X.toString(16)+":|"+B.join("|")+"|");return}var Z=B.slice(-R);B.length-=R,B.push(S[X][0]+"("+Z.join(",")+")")}else return X<=7?console.error("WK1 invalid opcode "+X.toString(16)):X<=24?console.error("WK1 unsupported op "+X.toString(16)):X<=30?console.error("WK1 invalid opcode "+X.toString(16)):X<=115?console.error("WK1 unsupported function opcode "+X.toString(16)):console.error("WK1 unrecognized opcode "+X.toString(16))}}B.length==1?H[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function w(P){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=P.read_shift(2),H[3]=P[P.l++],H[0].c=P[P.l++],H}function k(P,H){var B=w(P);return B[1].t="s",B[1].v=P.read_shift(H-4,"cstr"),B}function b(P,H,B,R){var K=fe(6+R.length);K.write_shift(2,P),K.write_shift(1,B),K.write_shift(1,H),K.write_shift(1,39);for(var se=0;se<R.length;++se){var we=R.charCodeAt(se);K.write_shift(1,we>=128?95:we)}return K.write_shift(1,0),K}function j(P,H){var B=w(P);B[1].v=P.read_shift(2);var R=B[1].v>>1;if(B[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return B[1].v=R,B}function A(P,H){var B=w(P),R=P.read_shift(4),K=P.read_shift(4),se=P.read_shift(2);if(se==65535)return R===0&&K===3221225472?(B[1].t="e",B[1].v=15):R===0&&K===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var we=se&32768;return se=(se&32767)-16446,B[1].v=(1-we*2)*(K*Math.pow(2,se+32)+R*Math.pow(2,se)),B}function E(P,H,B,R){var K=fe(14);if(K.write_shift(2,P),K.write_shift(1,B),K.write_shift(1,H),R==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var se=0,we=0,ye=0,X=0;return R<0&&(se=1,R=-R),we=Math.log2(R)|0,R/=Math.pow(2,we-31),X=R>>>0,X&2147483648||(R/=2,++we,X=R>>>0),R-=X,X|=2147483648,X>>>=0,R*=Math.pow(2,32),ye=R>>>0,K.write_shift(4,ye),K.write_shift(4,X),we+=16383+(se?32768:0),K.write_shift(2,we),K}function C(P,H){var B=A(P);return P.l+=H-14,B}function I(P,H){var B=w(P),R=P.read_shift(4);return B[1].v=R>>6,B}function F(P,H){var B=w(P),R=P.read_shift(8,"f");return B[1].v=R,B}function N(P,H){var B=F(P);return P.l+=H-10,B}function U(P,H){return P[P.l+H-1]==0?P.read_shift(H,"cstr"):""}function M(P,H){var B=P[P.l++];B>H-1&&(B=H-1);for(var R="";R.length<B;)R+=String.fromCharCode(P[P.l++]);return R}function L(P,H,B){if(!(!B.qpro||H<21)){var R=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var K=P.read_shift(H-21,"cstr");return[R,K]}}function z(P,H){for(var B={},R=P.l+H;P.l<R;){var K=P.read_shift(2);if(K==14e3){for(B[K]=[0,""],B[K][0]=P.read_shift(2);P[P.l];)B[K][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return B}function J(P,H){var B=fe(5+P.length);B.write_shift(2,14e3),B.write_shift(2,H);for(var R=0;R<P.length;++R){var K=P.charCodeAt(R);B[B.l++]=K>127?95:K}return B[B.l++]=0,B}var ne={0:{n:"BOF",f:m0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:U},222:{n:"SHEETNAMELP",f:M},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:N},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:U},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:L},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:t}}(),_2=/^\s|\s$|[\t\n\r]/;function j0(e,t){if(!t.bookSST)return"";var r=[$t];r[r.length]=Ae("sst",null,{xmlns:ei[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(_2)&&(a+=' xml:space="preserve"'),a+=">"+pt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function k2(e){return[e.read_shift(4),e.read_shift(4)]}function C2(e,t){return t||(t=fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var A2=vw;function I2(e){var t=jr();je(t,159,C2(e));for(var r=0;r<e.length;++r)je(t,19,A2(e[r]));return je(t,160),t.end()}function N2(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function S0(e){var t=0,r,s=N2(e),i=s.length+1,a,o,l,d,c;for(r=ds(i),r[0]=s.length,a=1;a!=i;++a)r[a]=s[a-1];for(a=i-1;a>=0;--a)o=r[a],l=t&16384?1:0,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var F2=function(){function e(i,a){switch(a.type){case"base64":return t(In(i),a);case"binary":return t(i,a);case"buffer":return t(ct&&Buffer.isBuffer(i)?i.toString("binary"):ea(i),a);case"array":return t(Qo(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},l=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var u=/\\\w+\b/g,p=0,g,x=-1;g=u.exec(h);){switch(g[0]){case"\\cell":var m=h.slice(p,u.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++x,m.length){var v={v:m,t:"s"};Array.isArray(l)?l[f][x]=v:l[mt({r:f,c:x})]=v}break}p=u.lastIndex}x>c.e.c&&(c.e.c=x)}),l["!ref"]=Mt(c),l}function r(i,a){return ms(e(i,a),a)}function s(i){for(var a=["{\\rtf1\\ansi"],o=Et(i["!ref"]),l,d=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){a.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var f=mt({r:c,c:h});l=d?(i[c]||[])[h]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Nn(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function su(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var R2=6,kn=R2;function No(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function Fo(e){return Math.floor((e-5)/kn*100+.5)/100}function gc(e){return Math.round((e*kn+5)/kn*256)/256}function nd(e){e.width?(e.wpx=No(e.width),e.wch=Fo(e.wpx),e.MDW=kn):e.wpx?(e.wch=Fo(e.wpx),e.width=gc(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=gc(e.wch),e.wpx=No(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var P2=96,E0=P2;function Ro(e){return e*96/E0}function T0(e){return e*E0/96}function D2(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=Ae("numFmt",null,{numFmtId:s,formatCode:pt(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ae("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function L2(e){var t=[];return t[t.length]=Ae("cellXfs",null),e.forEach(function(r){t[t.length]=Ae("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ae("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function _0(e,t){var r=[$t,Ae("styleSheet",null,{xmlns:ei[0],"xmlns:vt":Yt.vt})],s;return e.SSF&&(s=D2(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=L2(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function O2(e,t){var r=e.read_shift(2),s=fr(e);return[r,s]}function B2(e,t,r){r||(r=fe(6+4*t.length)),r.write_shift(2,e),Xt(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function M2(e,t,r){var s={};s.sz=e.read_shift(2)/20;var i=_w(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=Tw(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=fr(e),s}function $2(e,t){t||(t=fe(25+4*32)),t.write_shift(2,e.sz*20),kw(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ao(e.color,t);var s=0;return s=2,t.write_shift(1,s),Xt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var U2=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Vl,z2=pn;function iu(e,t){t||(t=fe(4*3+8*7+16*1)),Vl||(Vl=Hc(U2));var r=Vl[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Ao({auto:1},t),Ao({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function q2(e,t){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:i}}function k0(e,t,r){r||(r=fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xi(e,t){return t||(t=fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var W2=pn;function H2(e,t){return t||(t=fe(51)),t.write_shift(1,0),xi(null,t),xi(null,t),xi(null,t),xi(null,t),xi(null,t),t.length>t.l?t.slice(0,t.l):t}function V2(e,t){return t||(t=fe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Co(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function G2(e,t,r){var s=fe(2052);return s.write_shift(4,e),Co(t,s),Co(r,s),s.length>s.l?s.slice(0,s.l):s}function Y2(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&++r}),r!=0&&(je(e,615,Jr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&je(e,44,B2(i,t[i]))}),je(e,616))}}function K2(e){var t=1;je(e,611,Jr(t)),je(e,43,$2({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function X2(e){var t=2;je(e,603,Jr(t)),je(e,45,iu({patternType:"none"})),je(e,45,iu({patternType:"gray125"})),je(e,604)}function Q2(e){var t=1;je(e,613,Jr(t)),je(e,46,H2()),je(e,614)}function J2(e){var t=1;je(e,626,Jr(t)),je(e,47,k0({numFmtId:0},65535)),je(e,627)}function Z2(e,t){je(e,617,Jr(t.length)),t.forEach(function(r){je(e,47,k0(r,0))}),je(e,618)}function ej(e){var t=1;je(e,619,Jr(t)),je(e,48,V2({xfId:0,name:"Normal"})),je(e,620)}function tj(e){var t=0;je(e,505,Jr(t)),je(e,506)}function rj(e){var t=0;je(e,508,G2(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function nj(e,t){var r=jr();return je(r,278),Y2(r,e.SSF),K2(r),X2(r),Q2(r),J2(r),Z2(r,t.cellXfs),ej(r),tj(r),rj(r),je(r,279),r.end()}function C0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[$t];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fr(e)}}function ij(e){var t=fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Xt(e.name,t),t.slice(0,t.l)}function aj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function oj(e){var t=fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function lj(e,t){var r=fe(8+2*t.length);return r.write_shift(4,e),Xt(t,r),r.slice(0,r.l)}function cj(e){return e.l+=4,e.read_shift(4)!=0}function dj(e,t){var r=fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function hj(){var e=jr();return je(e,332),je(e,334,Jr(1)),je(e,335,ij({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,lj(1,"XLDAPR")),je(e,52),je(e,35,Jr(514)),je(e,4096,Jr(0)),je(e,4097,Or(1)),je(e,36),je(e,53),je(e,340),je(e,337,dj(1)),je(e,51,oj([[1,0]])),je(e,338),je(e,333),e.end()}function A0(){var e=[$t];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function uj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=mt(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var Bs=1024;function I0(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ae("xml",null,{"xmlns:v":Ar.v,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:mv":Ar.mv}).replace(/\/>/,">"),Ae("o:shapelayout",Ae("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ae("v:shapetype",[Ae("v:stroke",null,{joinstyle:"miter"}),Ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Bs<e*1e3;)Bs+=1e3;return t.forEach(function(a){var o=Kt(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?Ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ae("v:fill",d,l),h={on:"t",obscured:"t"};++Bs,i=i.concat(["<v:shape"+Hi({id:"_x0000_s"+Bs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ae("v:shadow",null,h),Ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",nr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),nr("x:AutoFill","False"),nr("x:Row",String(o.r)),nr("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function N0(e){var t=[$t,Ae("comments",null,{xmlns:ei[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var a=pt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var i=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(i=r.indexOf(pt(d.a))),a.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(nr("t",pt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(nr("t",pt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function fj(e,t,r){var s=[$t,Ae("ThreadedComments",null,{xmlns:Yt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=d.id:d.parentId=a,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(Ae("threadedComment",nr("text",o.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function xj(e){var t=[$t,Ae("personList",null,{xmlns:Yt.TCMNT,"xmlns:x":ei[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(Ae("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function pj(e){var t={};t.iauthor=e.read_shift(4);var r=bs(e);return t.rfx=r.s,t.ref=mt(r.s),e.l+=16,t}function mj(e,t){return t==null&&(t=fe(36)),t.write_shift(4,e[1].iauthor),ri(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var gj=fr;function yj(e){return Xt(e.slice(0,54))}function vj(e){var t=jr(),r=[];return je(t,628),je(t,630),e.forEach(function(s){s[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),je(t,632,yj(i.a)))})}),je(t,631),je(t,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Kt(s[0]),e:Kt(s[0])};je(t,635,mj([a,i])),i.t&&i.t.length>0&&je(t,637,ww(i)),je(t,636),delete i.iauthor})}),je(t,634),je(t,629),t.end()}function bj(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&yt.utils.cfb_add(e,i,t.FileIndex[s].content)}})}var F0=["xlsb","xlsm","xlam","biff8","xla"],wj=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,i,a,o){var l=!1,d=!1;a.length==0?d=!0:a.charAt(0)=="["&&(d=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,d?c+=t.r:--c,i+(l?"":"$")+ur(h)+(d?"":"$")+ir(c)}return function(i,a){return t=a,i.replace(e,r)}}(),sd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,id=function(){return function(t,r){return t.replace(sd,function(s,i,a,o,l,d){var c=Jc(o)-(a?0:r.c),h=Qc(d)-(l?0:r.r),f=h==0?"":l?h+1:"["+h+"]",u=c==0?"":a?c+1:"["+c+"]";return i+"R"+f+"C"+u})}}();function jj(e,t){return e.replace(sd,function(r,s,i,a,o,l){return s+(i=="$"?i+a:ur(Jc(a)+t.c))+(o=="$"?o+l:ir(Qc(l)+t.r))})}function Sj(e){return e.length!=1}function Dt(e){e.l+=1}function Wn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function R0(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return P0(e);r.biff==12&&(s=4)}var i=e.read_shift(s),a=e.read_shift(s),o=Wn(e),l=Wn(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function P0(e){var t=Wn(e),r=Wn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Ej(e,t,r){if(r.biff<8)return P0(e);var s=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Wn(e),o=Wn(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function D0(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Tj(e);var s=e.read_shift(r&&r.biff==12?4:2),i=Wn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function Tj(e){var t=Wn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _j(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kj(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Cj(e);var i=e.read_shift(s>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function Cj(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:s}}function Aj(e,t,r){var s=(e[e.l++]&96)>>5,i=R0(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,i]}function Ij(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=R0(e,a,r);return[s,i,o]}function Nj(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Fj(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,i]}function Rj(e,t,r){var s=(e[e.l++]&96)>>5,i=Ej(e,t-1,r);return[s,i]}function Pj(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function au(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Dj(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=s;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Lj(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Oj(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Bj(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Mj(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function L0(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $j(e){return e.read_shift(2),L0(e)}function Uj(e){return e.read_shift(2),L0(e)}function zj(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=D0(e,0,r);return[s,i]}function qj(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=kj(e,0,r);return[s,i]}function Wj(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=D0(e,0,r);return[s,i,a]}function Hj(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[HS[i],M0[i],s]}function Vj(e,t,r){var s=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:Gj(e);return[i,(a[0]===0?M0:WS)[a[1]]]}function Gj(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Yj(e,t,r){e.l+=r&&r.biff==2?3:4}function Kj(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function Xj(e){return e.l++,na[e.read_shift(1)]}function Qj(e){return e.l++,e.read_shift(2)}function Jj(e){return e.l++,e.read_shift(1)!==0}function Zj(e){return e.l++,ni(e)}function eS(e,t,r){return e.l++,y0(e,t-1,r)}function tS(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ww(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=na[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ni(e);break;case 2:r[1]=Yw(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function rS(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=s;++a)i.push((r.biff==12?bs:Qw)(e));return i}function nS(e,t,r){var s=0,i=0;r.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--i==0&&(i=256));for(var a=0,o=[];a!=s&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=tS(e,r.biff);return o}function sS(e,t,r){var s=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function iS(e,t,r){if(r.biff==5)return aS(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[s,i,a]}function aS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function oS(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function lS(e,t,r){var s=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function cS(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function dS(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,i]}var hS=pn,uS=pn,fS=pn;function sa(e,t,r){return e.l+=2,[_j(e)]}function ad(e){return e.l+=6,[]}var xS=sa,pS=ad,mS=ad,gS=sa;function O0(e){return e.l+=2,[m0(e),e.read_shift(2)&1]}var yS=sa,vS=O0,bS=ad,wS=sa,jS=sa,SS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ES(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=SS[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:i,C:a}}function TS(e){return e.l+=2,[e.read_shift(4)]}function _S(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function kS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IS(e){return e.l+=4,[0,0]}var ou={1:{n:"PtgExp",f:Kj},2:{n:"PtgTbl",f:fS},3:{n:"PtgAdd",f:Dt},4:{n:"PtgSub",f:Dt},5:{n:"PtgMul",f:Dt},6:{n:"PtgDiv",f:Dt},7:{n:"PtgPower",f:Dt},8:{n:"PtgConcat",f:Dt},9:{n:"PtgLt",f:Dt},10:{n:"PtgLe",f:Dt},11:{n:"PtgEq",f:Dt},12:{n:"PtgGe",f:Dt},13:{n:"PtgGt",f:Dt},14:{n:"PtgNe",f:Dt},15:{n:"PtgIsect",f:Dt},16:{n:"PtgUnion",f:Dt},17:{n:"PtgRange",f:Dt},18:{n:"PtgUplus",f:Dt},19:{n:"PtgUminus",f:Dt},20:{n:"PtgPercent",f:Dt},21:{n:"PtgParen",f:Dt},22:{n:"PtgMissArg",f:Dt},23:{n:"PtgStr",f:eS},26:{n:"PtgSheet",f:_S},27:{n:"PtgEndSheet",f:kS},28:{n:"PtgErr",f:Xj},29:{n:"PtgBool",f:Jj},30:{n:"PtgInt",f:Qj},31:{n:"PtgNum",f:Zj},32:{n:"PtgArray",f:Pj},33:{n:"PtgFunc",f:Hj},34:{n:"PtgFuncVar",f:Vj},35:{n:"PtgName",f:sS},36:{n:"PtgRef",f:zj},37:{n:"PtgArea",f:Aj},38:{n:"PtgMemArea",f:oS},39:{n:"PtgMemErr",f:hS},40:{n:"PtgMemNoMem",f:uS},41:{n:"PtgMemFunc",f:lS},42:{n:"PtgRefErr",f:cS},43:{n:"PtgAreaErr",f:Nj},44:{n:"PtgRefN",f:qj},45:{n:"PtgAreaN",f:Rj},46:{n:"PtgMemAreaN",f:CS},47:{n:"PtgMemNoMemN",f:AS},57:{n:"PtgNameX",f:iS},58:{n:"PtgRef3d",f:Wj},59:{n:"PtgArea3d",f:Ij},60:{n:"PtgRefErr3d",f:dS},61:{n:"PtgAreaErr3d",f:Fj},255:{}},NS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FS={1:{n:"PtgElfLel",f:O0},2:{n:"PtgElfRw",f:wS},3:{n:"PtgElfCol",f:xS},6:{n:"PtgElfRwV",f:jS},7:{n:"PtgElfColV",f:gS},10:{n:"PtgElfRadical",f:yS},11:{n:"PtgElfRadicalS",f:bS},13:{n:"PtgElfColS",f:pS},15:{n:"PtgElfColSV",f:mS},16:{n:"PtgElfRadicalLel",f:vS},25:{n:"PtgList",f:ES},29:{n:"PtgSxName",f:TS},255:{}},RS={0:{n:"PtgAttrNoop",f:IS},1:{n:"PtgAttrSemi",f:Mj},2:{n:"PtgAttrIf",f:Oj},4:{n:"PtgAttrChoose",f:Dj},8:{n:"PtgAttrGoto",f:Lj},16:{n:"PtgAttrSum",f:Yj},32:{n:"PtgAttrBaxcel",f:au},33:{n:"PtgAttrBaxcel",f:au},64:{n:"PtgAttrSpace",f:$j},65:{n:"PtgAttrSpaceSemi",f:Uj},128:{n:"PtgAttrIfError",f:Bj},255:{}};function PS(e,t,r,s){if(s.biff<8)return pn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=nS(e,0,s),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=rS(e,r[o][1],s),a.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(pn(e,t)),a}function DS(e,t,r){for(var s=e.l+t,i,a,o=[];s!=e.l;)t=s-e.l,a=e[e.l],i=ou[a]||ou[NS[a]],(a===24||a===25)&&(i=(a===24?FS:RS)[e[e.l+1]]),!i||!i.f?pn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function LS(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],i=[],a=0;a<s.length;++a){var o=s[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var OS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BS(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function B0(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function lu(e,t,r){var s=B0(e,t,r);return s=="#REF"?s:BS(s,r)}function Ys(e,t,r,s,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},l=[],d,c,h,f=0,u=0,p,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,m="",v=0,S=e[0].length;v<S;++v){var T=e[0][v];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:m=Rt(" ",e[0][x][1][1]);break;case 1:m=Rt("\r",e[0][x][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+m,x=-1}l.push(c+OS[T[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Ai(T[1][1],o,i),l.push(Ii(h,a));break;case"PtgRefN":h=r?Ai(T[1][1],r,i):T[1][1],l.push(Ii(h,a));break;case"PtgRef3d":f=T[1][1],h=Ai(T[1][2],o,i),g=lu(s,f,i),l.push(g+"!"+Ii(h,a));break;case"PtgFunc":case"PtgFuncVar":var y=T[1][0],w=T[1][1];y||(y=0),y&=127;var k=y==0?[]:l.slice(-y);l.length-=y,w==="User"&&(w=k.shift()),l.push(w+"("+k.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":p=Vh(T[1][1],r?{s:r}:o,i),l.push(Wl(p,i));break;case"PtgArea":p=Vh(T[1][1],o,i),l.push(Wl(p,i));break;case"PtgArea3d":f=T[1][1],p=T[1][2],g=lu(s,f,i),l.push(g+"!"+Wl(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=T[1][2];var b=(s.names||[])[u-1]||(s[0]||[])[u],j=b?b.Name:"SH33TJSNAME"+String(u);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),l.push(j);break;case"PtgNameX":var A=T[1][1];u=T[1][2];var E;if(i.biff<=5)A<0&&(A=-A),s[A]&&(E=s[A][u]);else{var C="";if(((s[A]||[])[0]||[])[0]==14849||(((s[A]||[])[0]||[])[0]==1025?s[A][u]&&s[A][u].itab>0&&(C=s.SheetNames[s[A][u].itab-1]+"!"):C=s.SheetNames[u-1]+"!"),s[A]&&s[A][u])C+=s[A][u].Name;else if(s[0]&&s[0][u])C+=s[0][u].Name;else{var I=(B0(s,A,i)||"").split(";;");I[u-1]?C=I[u-1]:C+="SH33TJSERRX"}l.push(C);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var F="(",N=")";if(x>=0){switch(m="",e[0][x][1][0]){case 2:F=Rt(" ",e[0][x][1][1])+F;break;case 3:F=Rt("\r",e[0][x][1][1])+F;break;case 4:N=Rt(" ",e[0][x][1][1])+N;break;case 5:N=Rt("\r",e[0][x][1][1])+N;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(F+l.pop()+N);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var U={c:r.c,r:r.r};if(s.sharedf[mt(h)]){var M=s.sharedf[mt(h)];l.push(Ys(M,o,U,s,i))}else{var L=!1;for(d=0;d!=s.arrayf.length;++d)if(c=s.arrayf[d],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){l.push(Ys(c[1],o,U,s,i)),L=!0;break}L||l.push(T[1])}break;case"PtgArray":l.push("{"+LS(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&z.indexOf(e[0][v][0])==-1){T=e[0][x];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:m=Rt(" ",T[1][1]);break;case 5:J=!1;case 1:m=Rt("\r",T[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((J?m:"")+l.pop()+(J?"":m)),x=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function MS(e){if(e==null){var t=fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return hs(e);return hs(0)}function $S(e,t,r,s,i){var a=us(t,r,i),o=MS(e.v),l=fe(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=fe(e.bf.length),h=0;h<e.bf.length;++h)c[h]=e.bf[h];var f=rr([a,o,l,c]);return f}function Jo(e,t,r){var s=e.read_shift(4),i=DS(e,s,r),a=e.read_shift(4),o=a>0?PS(e,a,i,r):null;return[i,o]}var US=Jo,Zo=Jo,zS=Jo,qS=Jo,WS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},M0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},HS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function VS(e){var t="of:="+e.replace(sd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function GS(e){return e.replace(/\./,"!")}var Ni=typeof Map<"u";function od(e,t,r){var s=0,i=e.length;if(r){if(Ni?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ni?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<i;++s)if(e[s].t===t)return e.Count++,s;return e[i]={t},e.Count++,e.Unique++,r&&(Ni?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function el(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(kn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Fo(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=gc(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function $0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Kn(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(s==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Df(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=s=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===s)return i;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function YS(e,t,r){if(e&&e["!ref"]){var s=Et(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function KS(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Mt(e[r])+'"/>';return t+"</mergeCells>"}function XS(e,t,r,s,i){var a=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}a=!0,o.codeName=Wi(pt(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+Ae("outlinePr",null,c)}!a&&!l||(i[i.length]=Ae("sheetPr",l,o))}var QS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],JS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ZS(e){var t={sheet:1};return QS.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),JS.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=S0(e.password).toString(16).toUpperCase()),Ae("sheetProtection",null,t)}function eE(e){return $0(e),Ae("pageMargins",null,e)}function tE(e,t){for(var r=["<cols>"],s,i=0;i!=t.length;++i)(s=t[i])&&(r[r.length]=Ae("col",null,el(i,s)));return r[r.length]="</cols>",r.join("")}function rE(e,t,r,s){var i=typeof e.ref=="string"?e.ref:Mt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Pr(i);o.s.r==o.e.r&&(o.e.r=Pr(t["!ref"]).e.r,i=Mt(o));for(var l=0;l<a.length;++l){var d=a[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Ae("autoFilter",null,{ref:i})}function nE(e,t,r,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Ae("sheetViews",Ae("sheetView",null,i),{})}function sE(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=na[e.v];break;case"d":s&&s.cellDates?i=yr(e.v,-1).toISOString():(e=Er(e),e.t="n",i=""+(e.v=Sr(yr(e.v)))),typeof e.z>"u"&&(e.z=Pt[14]);break;default:i=e.v;break}var l=nr("v",pt(i)),d={r:t},c=Kn(s.cellXfs,e,s);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=nr("v",""+od(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ae("f",pt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Ae("c",l,d)}function iE(e,t,r,s){var i=[],a=[],o=Et(e["!ref"]),l="",d,c="",h=[],f=0,u=0,p=e["!rows"],g=Array.isArray(e),x={r:c},m,v=-1;for(u=o.s.c;u<=o.e.c;++u)h[u]=ur(u);for(f=o.s.r;f<=o.e.r;++f){for(a=[],c=ir(f),u=o.s.c;u<=o.e.c;++u){d=h[u]+c;var S=g?(e[f]||[])[u]:e[d];S!==void 0&&(l=sE(S,d,e,t))!=null&&a.push(l)}(a.length>0||p&&p[f])&&(x={r:c},p&&p[f]&&(m=p[f],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Ro(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level)),i[i.length]=Ae("row",a.join(""),x))}if(p)for(;f<p.length;++f)p&&p[f]&&(x={r:f+1},m=p[f],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Ro(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level),i[i.length]=Ae("row","",x));return i.join("")}function U0(e,t,r,s){var i=[$t,Ae("worksheet",null,{xmlns:ei[0],"xmlns:r":Yt.r})],a=r.SheetNames[e],o=0,l="",d=r.Sheets[a];d==null&&(d={});var c=d["!ref"]||"A1",h=Et(c);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=Mt(h)}s||(s={}),d["!comments"]=[];var f=[];XS(d,r,e,t,i),i[i.length]=Ae("dimension",null,{ref:c}),i[i.length]=nE(d,t,e,r),t.sheetFormat&&(i[i.length]=Ae("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=tE(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=iE(d,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=ZS(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=rE(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=KS(d["!merges"]));var u=-1,p,g=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=ft(s,-1,pt(x[1].Target).replace(/#.*$/,""),ot.HLINK),p["r:id"]="rId"+g),(u=x[1].Target.indexOf("#"))>-1&&(p.location=pt(x[1].Target.slice(u+1))),x[1].Tooltip&&(p.tooltip=pt(x[1].Tooltip)),i[i.length]=Ae("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=eE(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=nr("ignoredErrors",Ae("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(g=ft(s,-1,"../drawings/drawing"+(e+1)+".xml",ot.DRAW),i[i.length]=Ae("drawing",null,{"r:id":"rId"+g}),d["!drawing"]=f),d["!comments"].length>0&&(g=ft(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ot.VML),i[i.length]=Ae("legacyDrawing",null,{"r:id":"rId"+g}),d["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function aE(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function oE(e,t,r){var s=fe(145),i=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;i.hpx?a=Ro(i.hpx)*20:i.hpt&&(a=i.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,d=s.l;s.l+=4;for(var c={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,u=-1,p=h<<10;p<h+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[mt(c)];g&&(f<0&&(f=p),u=p)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,u))}var x=s.l;return s.l=d,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function lE(e,t,r,s){var i=oE(s,r,t);(i.length>17||(t["!rows"]||[])[s])&&je(e,0,i)}var cE=bs,dE=ri;function hE(){}function uE(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=jw(e),r}function fE(e,t,r){r==null&&(r=fe(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var i=1;i<3;++i)r.write_shift(1,0);return Ao({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),r0(e,r),r.slice(0,r.l)}function xE(e){var t=zr(e);return[t]}function pE(e,t,r){return r==null&&(r=fe(8)),gs(t,r)}function mE(e){var t=ys(e);return[t]}function gE(e,t,r){return r==null&&(r=fe(4)),vs(t,r)}function yE(e){var t=zr(e),r=e.read_shift(1);return[t,r,"b"]}function vE(e,t,r){return r==null&&(r=fe(9)),gs(t,r),r.write_shift(1,e.v?1:0),r}function bE(e){var t=ys(e),r=e.read_shift(1);return[t,r,"b"]}function wE(e,t,r){return r==null&&(r=fe(5)),vs(t,r),r.write_shift(1,e.v?1:0),r}function jE(e){var t=zr(e),r=e.read_shift(1);return[t,r,"e"]}function SE(e,t,r){return r==null&&(r=fe(9)),gs(t,r),r.write_shift(1,e.v),r}function EE(e){var t=ys(e),r=e.read_shift(1);return[t,r,"e"]}function TE(e,t,r){return r==null&&(r=fe(8)),vs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function _E(e){var t=zr(e),r=e.read_shift(4);return[t,r,"s"]}function kE(e,t,r){return r==null&&(r=fe(12)),gs(t,r),r.write_shift(4,t.v),r}function CE(e){var t=ys(e),r=e.read_shift(4);return[t,r,"s"]}function AE(e,t,r){return r==null&&(r=fe(8)),vs(t,r),r.write_shift(4,t.v),r}function IE(e){var t=zr(e),r=ni(e);return[t,r,"n"]}function NE(e,t,r){return r==null&&(r=fe(16)),gs(t,r),hs(e.v,r),r}function FE(e){var t=ys(e),r=ni(e);return[t,r,"n"]}function RE(e,t,r){return r==null&&(r=fe(12)),vs(t,r),hs(e.v,r),r}function PE(e){var t=zr(e),r=n0(e);return[t,r,"n"]}function DE(e,t,r){return r==null&&(r=fe(12)),gs(t,r),s0(e.v,r),r}function LE(e){var t=ys(e),r=n0(e);return[t,r,"n"]}function OE(e,t,r){return r==null&&(r=fe(8)),vs(t,r),s0(e.v,r),r}function BE(e){var t=zr(e),r=Zc(e);return[t,r,"is"]}function ME(e){var t=zr(e),r=fr(e);return[t,r,"str"]}function $E(e,t,r){return r==null&&(r=fe(12+4*e.v.length)),gs(t,r),Xt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function UE(e){var t=ys(e),r=fr(e);return[t,r,"str"]}function zE(e,t,r){return r==null&&(r=fe(8+4*e.v.length)),vs(t,r),Xt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function qE(e,t,r){var s=e.l+t,i=zr(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=Zo(e,s-e.l,r);o[3]=Ys(l,null,i,r.supbooks,r)}else e.l=s;return o}function WE(e,t,r){var s=e.l+t,i=zr(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=Zo(e,s-e.l,r);o[3]=Ys(l,null,i,r.supbooks,r)}else e.l=s;return o}function HE(e,t,r){var s=e.l+t,i=zr(e);i.r=r["!row"];var a=ni(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=Zo(e,s-e.l,r);o[3]=Ys(l,null,i,r.supbooks,r)}else e.l=s;return o}function VE(e,t,r){var s=e.l+t,i=zr(e);i.r=r["!row"];var a=fr(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=Zo(e,s-e.l,r);o[3]=Ys(l,null,i,r.supbooks,r)}else e.l=s;return o}var GE=bs,YE=ri;function KE(e,t){return t==null&&(t=fe(4)),t.write_shift(4,e),t}function XE(e,t){var r=e.l+t,s=bs(e),i=ed(e),a=fr(e),o=fr(e),l=fr(e);e.l=r;var d={rfx:s,relId:i,loc:a,display:l};return o&&(d.Tooltip=o),d}function QE(e,t){var r=fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ri({s:Kt(e[0]),e:Kt(e[0])},r),td("rId"+t,r);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return Xt(i||"",r),Xt(e[1].Tooltip||"",r),Xt("",r),r.slice(0,r.l)}function JE(){}function ZE(e,t,r){var s=e.l+t,i=i0(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var l=US(e,s-e.l,r);o[1]=l}else e.l=s;return o}function eT(e,t,r){var s=e.l+t,i=bs(e),a=[i];if(r.cellFormula){var o=qS(e,s-e.l,r);a[1]=o,e.l=s}else e.l=s;return a}function tT(e,t,r){r==null&&(r=fe(18));var s=el(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var z0=["left","right","top","bottom","header","footer"];function rT(e){var t={};return z0.forEach(function(r){t[r]=ni(e)}),t}function nT(e,t){return t==null&&(t=fe(6*8)),$0(e),z0.forEach(function(r){hs(e[r],t)}),t}function sT(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function iT(e,t,r){r==null&&(r=fe(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aT(e){var t=fe(24);return t.write_shift(4,4),t.write_shift(4,1),ri(e,t),t}function oT(e,t){return t==null&&(t=fe(16*4+2)),t.write_shift(2,e.password?S0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lT(){}function cT(){}function dT(e,t,r,s,i,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Er(t),t.z=t.z||Pt[14],t.v=Sr(yr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:s};switch(d.s=Kn(i.cellXfs,t,i),t.l&&a["!links"].push([mt(d),t.l]),t.c&&a["!comments"].push([mt(d),t.c]),t.t){case"s":case"str":return i.bookSST?(l=od(i.Strings,t.v,i.revStrings),d.t="s",d.v=l,o?je(e,18,AE(t,d)):je(e,7,kE(t,d))):(d.t="str",o?je(e,17,zE(t,d)):je(e,6,$E(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?je(e,13,OE(t,d)):je(e,2,DE(t,d)):o?je(e,16,RE(t,d)):je(e,5,NE(t,d)),!0;case"b":return d.t="b",o?je(e,15,wE(t,d)):je(e,4,vE(t,d)),!0;case"e":return d.t="e",o?je(e,14,TE(t,d)):je(e,3,SE(t,d)),!0}return o?je(e,12,gE(t,d)):je(e,1,pE(t,d)),!0}function hT(e,t,r,s){var i=Et(t["!ref"]||"A1"),a,o="",l=[];je(e,145);var d=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=c;++h){o=ir(h),lE(e,t,i,h);var f=!1;if(h<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){h===i.s.r&&(l[u]=ur(u)),a=l[u]+o;var p=d?(t[h]||[])[u]:t[a];if(!p){f=!1;continue}f=dT(e,p,h,u,s,t,f)}}je(e,146)}function uT(e,t){!t||!t["!merges"]||(je(e,177,KE(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,YE(r))}),je(e,178))}function fT(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,s){r&&je(e,60,tT(s,r))}),je(e,391))}function xT(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,aT(Et(t["!ref"]))),je(e,650))}function pT(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var i=ft(r,-1,s[1].Target.replace(/#.*$/,""),ot.HLINK);je(e,494,QE(s,i))}}),delete t["!links"]}function mT(e,t,r,s){if(t["!comments"].length>0){var i=ft(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ot.VML);je(e,551,td("rId"+i)),t["!legacy"]=i}}function gT(e,t,r,s){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:Mt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Pr(a);l.s.r==l.e.r&&(l.e.r=Pr(t["!ref"]).e.r,a=Mt(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+a;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),je(e,161,ri(Et(a))),je(e,162)}}function yT(e,t,r){je(e,133),je(e,137,iT(t,r)),je(e,138),je(e,134)}function vT(e,t){t["!protect"]&&je(e,535,oT(t["!protect"]))}function bT(e,t,r,s){var i=jr(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=Et(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],je(i,129),(r.vbaraw||o["!outline"])&&je(i,147,fE(l,o["!outline"])),je(i,148,dE(d)),yT(i,o,r.Workbook),fT(i,o),hT(i,o,e,t),vT(i,o),gT(i,o,r,e),uT(i,o),pT(i,o,s),o["!margins"]&&je(i,476,nT(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xT(i,o),mT(i,o,e,s),je(i,130),i.end()}function wT(e,t){e.l+=10;var r=fr(e);return{name:r}}var jT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ST(e){return!e.Workbook||!e.Workbook.WBProps?"false":ew(e.Workbook.WBProps.date1904)?"true":"false"}var ET="][*?/\\".split("");function q0(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ET.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function TT(e,t,r){e.forEach(function(s,i){q0(s);for(var a=0;a<i;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[i]&&t[i].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function _T(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];TT(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)YS(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function W0(e){var t=[$t];t[t.length]=Ae("workbook",null,{xmlns:ei[0],"xmlns:r":Yt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jT.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=Ae("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:pt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ae("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=Ae("definedName",pt(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function kT(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=mc(e),r.name=fr(e),r}function CT(e,t){return t||(t=fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),td(e.strRelID,t),Xt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function AT(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?fr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function IT(e,t){t||(t=fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),r0(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NT(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=Sw(e),o=zS(e,0,r),l=ed(e);e.l=s;var d={Name:a,Ptg:o};return i<268435455&&(d.Sheet=i),l&&(d.Comment=l),d}function FT(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,CT(i))}je(e,144)}function RT(e,t){t||(t=fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Xt("SheetJS",t),Xt(jo.version,t),Xt(jo.version,t),Xt("7262",t),t.length>t.l?t.slice(0,t.l):t}function PT(e,t){t||(t=fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function DT(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,i=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&i==-1?i=s:r[s].Hidden==1&&a==-1&&(a=s);a>i||(je(e,135),je(e,158,PT(i)),je(e,136))}}function LT(e,t){var r=jr();return je(r,131),je(r,128,RT()),je(r,153,IT(e.Workbook&&e.Workbook.WBProps||null)),DT(r,e),FT(r,e),je(r,132),r.end()}function OT(e,t,r){return(t.slice(-4)===".bin"?LT:W0)(e)}function BT(e,t,r,s,i){return(t.slice(-4)===".bin"?bT:U0)(e,r,s,i)}function MT(e,t,r){return(t.slice(-4)===".bin"?nj:_0)(e,r)}function $T(e,t,r){return(t.slice(-4)===".bin"?I2:j0)(e,r)}function UT(e,t,r){return(t.slice(-4)===".bin"?vj:N0)(e)}function zT(e){return(e.slice(-4)===".bin"?hj:A0)()}function qT(e,t){var r=[];return e.Props&&r.push(Mw(e.Props,t)),e.Custprops&&r.push($w(e.Props,e.Custprops)),r.join("")}function WT(){return""}function HT(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,i){var a=[];a.push(Ae("NumberFormat",null,{"ss:Format":pt(Pt[s.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ae("Style",a.join(""),o))}),Ae("Styles",r.join(""))}function H0(e){return Ae("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+id(e.Ref,{r:0,c:0})})}function VT(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var i=t[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(H0(i)))}return Ae("Names",r.join(""))}function GT(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,a=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(H0(l)))}return a.join("")}function YT(e,t,r,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ae("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ae("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ae("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)i.push(Ae("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(nr("ProtectContents","True")),e["!protect"].objects&&i.push(nr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(nr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(nr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(nr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ae("WorksheetOptions",i.join(""),{xmlns:Ar.x})}function KT(e){return e.map(function(t){var r=Zb(t.t||""),s=Ae("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ae("Comment",s,{"ss:Author":t.a})}).join("")}function XT(e,t,r,s,i,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+pt(id(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Kt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=pt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=pt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],h=0;h!=c.length;++h)c[h].s.c!=o.c||c[h].s.r!=o.r||(c[h].e.c>c[h].s.c&&(l["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(l["ss:MergeDown"]=c[h].e.r-c[h].s.r));var f="",u="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",u=String(e.v);break;case"b":f="Boolean",u=e.v?"1":"0";break;case"e":f="Error",u=na[e.v];break;case"d":f="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Pt[14]);break;case"s":f="String",u=Jb(e.v||"");break}var p=Kn(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var g=e.v!=null?u:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(x+=KT(e.c)),Ae("Cell",x,l)}function QT(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=T0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function JT(e,t,r,s){if(!e["!ref"])return"";var i=Et(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(m,v){nd(m);var S=!!m.width,T=el(v,m),y={"ss:Index":v+1};S&&(y["ss:Width"]=No(T.width)),m.hidden&&(y["ss:Hidden"]="1"),l.push(Ae("Column",null,y))});for(var d=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var h=[QT(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var u=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>c)&&!(a[o].e.c<f)&&!(a[o].e.r<c)){(a[o].s.c!=f||a[o].s.r!=c)&&(u=!0);break}if(!u){var p={r:c,c:f},g=mt(p),x=d?(e[c]||[])[f]:e[g];h.push(XT(x,g,e,t,r,s,p))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function ZT(e,t,r){var s=[],i=r.SheetNames[e],a=r.Sheets[i],o=a?GT(a,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=a?JT(a,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(YT(a,t,e,r)),s.join("")}function e_(e,t){t||(t={}),e.SSF||(e.SSF=Er(Pt)),e.SSF&&(Ko(),Yo(e.SSF),t.revssf=Xo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qT(e,t)),r.push(WT()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(Ae("Worksheet",ZT(s,t,e),{"ss:Name":pt(e.SheetNames[s])}));return r[2]=HT(e,t),r[3]=VT(e),$t+Ae("Workbook",r.join(""),{xmlns:Ar.ss,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:ss":Ar.ss,"xmlns:dt":Ar.dt,"xmlns:html":Ar.html})}var Gl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function t_(e,t){var r=[],s=[],i=[],a=0,o,l=Dh(Yh,"n"),d=Dh(Kh,"n");if(e.Props)for(o=ar(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=ar(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Custprops[o[a]]]);var c=[];for(a=0;a<i.length;++a)p0.indexOf(i[a][0])>-1||u0.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);s.length&&yt.utils.cfb_add(t,"/SummaryInformation",eu(s,Gl.SI,d,Kh)),(r.length||c.length)&&yt.utils.cfb_add(t,"/DocumentSummaryInformation",eu(r,Gl.DSI,l,Yh,c.length?c:null,Gl.UDI))}function r_(e,t){var r=t||{},s=yt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return yt.utils.cfb_add(s,i,V0(e,r)),r.biff==8&&(e.Props||e.Custprops)&&t_(e,s),r.biff==8&&e.vbaraw&&bj(s,yt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var n_={0:{f:aE},1:{f:xE},2:{f:PE},3:{f:jE},4:{f:yE},5:{f:IE},6:{f:ME},7:{f:_E},8:{f:VE},9:{f:HE},10:{f:qE},11:{f:WE},12:{f:mE},13:{f:LE},14:{f:EE},15:{f:bE},16:{f:FE},17:{f:UE},18:{f:CE},19:{f:Zc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:NT},40:{},42:{},43:{f:M2},44:{f:O2},45:{f:z2},46:{f:W2},47:{f:q2},48:{},49:{f:mw},50:{},51:{f:aj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:g2},62:{f:BE},63:{f:uj},64:{f:lT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uE},148:{f:cE,p:16},151:{f:JE},152:{},153:{f:AT},154:{},155:{},156:{f:kT},157:{},158:{},159:{T:1,f:k2},160:{T:-1},161:{T:1,f:bs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GE},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:sj},336:{T:-1},337:{f:cj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:h2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZE},427:{f:eT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gj},633:{T:1},634:{T:-1},635:{T:1,f:pj},636:{T:-1},637:{f:bw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:wT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ie(e,t,r,s){var i=t;if(!isNaN(i)){var a=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Xc(r)&&e.push(r)}}function s_(e,t,r,s){var i=(r||[]).length||0;if(i<=8224)return Ie(e,t,r,i);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,a),h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<i;){for(h=e.next(4),h.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function ia(e,t,r){return e||(e=fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function i_(e,t,r,s){var i=fe(9);return ia(i,e,t),g0(r,s||"b",i),i}function a_(e,t,r){var s=fe(8+2*r.length);return ia(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function o_(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Sr(yr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ie(e,2,w2(r,s,i)):Ie(e,3,b2(r,s,i));return;case"b":case"e":Ie(e,5,i_(r,s,t.v,t.t));return;case"s":case"str":Ie(e,4,a_(r,s,(t.v||"").slice(0,255)));return}Ie(e,1,ia(null,r,s))}function l_(e,t,r,s){var i=Array.isArray(t),a=Et(t["!ref"]||"A1"),o,l="",d=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Mt(a)}for(var c=a.s.r;c<=a.e.r;++c){l=ir(c);for(var h=a.s.c;h<=a.e.c;++h){c===a.s.r&&(d[h]=ur(h)),o=d[h]+l;var f=i?(t[c]||[])[h]:t[o];f&&o_(e,f,c,h)}}}function c_(e,t){for(var r=t||{},s=jr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(s,r.biff==4?1033:r.biff==3?521:9,rd(e,16,r)),l_(s,e.Sheets[e.SheetNames[i]],i,r),Ie(s,10),s.end()}function d_(e,t,r){Ie(e,49,n2({sz:12,name:"Arial"},r))}function h_(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&Ie(e,1054,a2(i,t[i],r))})}function u_(e,t){var r=fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(e,2151,r),r=fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),b0(Et(t["!ref"]||"A1"),r),r.write_shift(4,4),Ie(e,2152,r)}function f_(e,t){for(var r=0;r<16;++r)Ie(e,224,ru({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){Ie(e,224,ru(s,0,t))})}function x_(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];Ie(e,440,x2(s)),s[1].Tooltip&&Ie(e,2048,p2(s))}delete t["!links"]}function p_(e,t){if(t){var r=0;t.forEach(function(s,i){++r<=256&&s&&Ie(e,125,y2(el(i,s),i))})}}function m_(e,t,r,s,i){var a=16+Kn(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ie(e,513,us(r,s,a));return}if(t.bf)Ie(e,6,$S(t,r,s,i,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?Sr(yr(t.v)):t.v;Ie(e,515,d2(r,s,o,a));break;case"b":case"e":Ie(e,517,c2(r,s,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var l=od(i.Strings,t.v,i.revStrings);Ie(e,253,s2(r,s,l,a))}else Ie(e,516,i2(r,s,(t.v||"").slice(0,255),a,i));break;default:Ie(e,513,us(r,s,a))}}function g_(e,t,r){var s=jr(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(a),c=t.biff==8,h,f="",u=[],p=Et(a["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}Ie(s,2057,rd(r,16,t)),Ie(s,13,Or(1)),Ie(s,12,Or(100)),Ie(s,15,pr(!0)),Ie(s,17,pr(!1)),Ie(s,16,hs(.001)),Ie(s,95,pr(!0)),Ie(s,42,pr(!1)),Ie(s,43,pr(!1)),Ie(s,130,Or(1)),Ie(s,128,l2()),Ie(s,131,pr(!1)),Ie(s,132,pr(!1)),c&&p_(s,a["!cols"]),Ie(s,512,o2(p,t)),c&&(a["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){f=ir(x);for(var m=p.s.c;m<=p.e.c;++m){x===p.s.r&&(u[m]=ur(m)),h=u[m]+f;var v=d?(a[x]||[])[m]:a[h];v&&(m_(s,v,x,m,t),c&&v.l&&a["!links"].push([h,v.l]))}}var S=l.CodeName||l.name||i;return c&&Ie(s,574,r2((o.Views||[])[0])),c&&(a["!merges"]||[]).length&&Ie(s,229,f2(a["!merges"])),c&&x_(s,a),Ie(s,442,v0(S)),c&&u_(s,a),Ie(s,10),s.end()}function y_(e,t,r){var s=jr(),i=(e||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,d=r.biff==5;if(Ie(s,2057,rd(e,5,r)),r.bookType=="xla"&&Ie(s,135),Ie(s,225,l?Or(1200):null),Ie(s,193,qw(2)),d&&Ie(s,191),d&&Ie(s,192),Ie(s,226),Ie(s,92,Jw("SheetJS",r)),Ie(s,66,Or(l?1200:1252)),l&&Ie(s,353,Or(0)),l&&Ie(s,448),Ie(s,317,v2(e.SheetNames.length)),l&&e.vbaraw&&Ie(s,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";Ie(s,442,v0(c))}Ie(s,156,Or(17)),Ie(s,25,pr(!1)),Ie(s,18,pr(!1)),Ie(s,19,Or(0)),l&&Ie(s,431,pr(!1)),l&&Ie(s,444,Or(0)),Ie(s,61,t2()),Ie(s,64,pr(!1)),Ie(s,141,Or(0)),Ie(s,34,pr(ST(e)=="true")),Ie(s,14,pr(!0)),l&&Ie(s,439,pr(!1)),Ie(s,218,Or(0)),d_(s,e,r),h_(s,e.SSF,r),f_(s,r),l&&Ie(s,352,pr(!1));var h=s.end(),f=jr();l&&Ie(f,140,m2()),l&&r.Strings&&s_(f,252,e2(r.Strings)),Ie(f,10);var u=f.end(),p=jr(),g=0,x=0;for(x=0;x<e.SheetNames.length;++x)g+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var m=h.length+g+u.length;for(x=0;x<e.SheetNames.length;++x){var v=a[x]||{};Ie(p,133,Zw({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},r)),m+=t[x].length}var S=p.end();if(g!=S.length)throw new Error("BS8 "+g+" != "+S.length);var T=[];return h.length&&T.push(h),S.length&&T.push(S),u.length&&T.push(u),rr(T)}function v_(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Er(Pt)),e&&e.SSF&&(Ko(),Yo(e.SSF),r.revssf=Xo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ld(r),r.cellXfs=[],Kn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=g_(i,r,e);return s.unshift(y_(e,s,r)),rr(s)}function V0(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var i=Pr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return v_(e,t);case 4:case 3:case 2:return c_(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function b_(e,t,r,s){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){l=-1;break}l=i[c].e.r-i[c].s.r+1,d=i[c].e.c-i[c].s.c+1;break}if(!(l<0)){var h=mt({r,c:o}),f=s.dense?(e[r]||[])[o]:e[h],u=f&&f.v!=null&&(f.h||Qb(f.w||(Nn(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),d>1&&(p.colspan=d),s.editable?u='<span contenteditable="true">'+u+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),p.id=(s.id||"sjs")+"-"+h,a.push(Ae("td",u,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var w_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',j_="</body></html>";function S_(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function G0(e,t){var r=t||{},s=r.header!=null?r.header:w_,i=r.footer!=null?r.footer:j_,a=[s],o=Pr(e["!ref"]);r.dense=Array.isArray(e),a.push(S_(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(b_(e,o,l,r));return a.push("</table>"+i),a.join("")}function Y0(e,t,r){var s=r||{},i=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var o=typeof s.origin=="string"?Kt(s.origin):s.origin;i=o.r,a=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var h=Pr(e["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var f=[],u=0,p=e["!rows"]||(e["!rows"]=[]),g=0,x=0,m=0,v=0,S=0,T=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&x<d;++g){var y=l[g];if(cu(y)){if(s.display)continue;p[x]={hidden:!0}}var w=y.children;for(m=v=0;m<w.length;++m){var k=w[m];if(!(s.display&&cu(k))){var b=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):tw(k.innerHTML),j=k.getAttribute("data-z")||k.getAttribute("z");for(u=0;u<f.length;++u){var A=f[u];A.s.c==v+a&&A.s.r<x+i&&x+i<=A.e.r&&(v=A.e.c+1-a,u=-1)}T=+k.getAttribute("colspan")||1,((S=+k.getAttribute("rowspan")||1)>1||T>1)&&f.push({s:{r:x+i,c:v+a},e:{r:x+i+(S||1)-1,c:v+a+(T||1)-1}});var E={t:"s",v:b},C=k.getAttribute("data-t")||k.getAttribute("t")||"";b!=null&&(b.length==0?E.t=C||"z":s.raw||b.trim().length==0||C=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(_n(b))?isNaN(qi(b).getDate())||(E={t:"d",v:yr(b)},s.cellDates||(E={t:"n",v:Sr(E.v)}),E.z=s.dateNF||Pt[14]):E={t:"n",v:_n(b)})),E.z===void 0&&j!=null&&(E.z=j);var I="",F=k.getElementsByTagName("A");if(F&&F.length)for(var N=0;N<F.length&&!(F[N].hasAttribute("href")&&(I=F[N].getAttribute("href"),I.charAt(0)!="#"));++N);I&&I.charAt(0)!="#"&&(E.l={Target:I}),s.dense?(e[x+i]||(e[x+i]=[]),e[x+i][v+a]=E):e[mt({c:v+a,r:x+i})]=E,c.e.c<v+a&&(c.e.c=v+a),v+=T}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,x-1+i),e["!ref"]=Mt(c),x>=d&&(e["!fullref"]=Mt((c.e.r=l.length-g+x-1+i,c))),e}function K0(e,t){var r=t||{},s=r.dense?[]:{};return Y0(s,e,t)}function E_(e,t){return ms(K0(e,t),t)}function cu(e){var t="",r=T_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function T_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var __=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Hi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return $t+t}}(),du=function(){var e=function(a){return pt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,o,l){var d=[];d.push('      <table:table table:name="'+pt(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,h=0,f=Pr(a["!ref"]||"A1"),u=a["!merges"]||[],p=0,g=Array.isArray(a);if(a["!cols"])for(h=0;h<=f.e.c;++h)d.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",m=a["!rows"]||[];for(c=0;c<f.s.r;++c)x=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=f.e.r;++c){for(x=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)d.push(t);for(;h<=f.e.c;++h){var v=!1,S={},T="";for(p=0;p!=u.length;++p)if(!(u[p].s.c>h)&&!(u[p].s.r>c)&&!(u[p].e.c<h)&&!(u[p].e.r<c)){(u[p].s.c!=h||u[p].s.r!=c)&&(v=!0),S["table:number-columns-spanned"]=u[p].e.c-u[p].s.c+1,S["table:number-rows-spanned"]=u[p].e.r-u[p].s.r+1;break}if(v){d.push(r);continue}var y=mt({r:c,c:h}),w=g?(a[c]||[])[h]:a[y];if(w&&w.f&&(S["table:formula"]=pt(VS(w.f)),w.F&&w.F.slice(0,y.length)==y)){var k=Pr(w.F);S["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,S["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!w){d.push(t);continue}switch(w.t){case"b":T=w.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=w.v?"true":"false";break;case"n":T=w.w||String(w.v||0),S["office:value-type"]="float",S["office:value"]=w.v||0;break;case"s":case"str":T=w.v==null?"":w.v,S["office:value-type"]="string";break;case"d":T=w.w||yr(w.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=yr(w.v).toISOString(),S["table:style-name"]="ce1";break;default:d.push(t);continue}var b=e(T);if(w.l&&w.l.Target){var j=w.l.Target;j=j.charAt(0)=="#"?"#"+GS(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),b=Ae("text:a",b,{"xlink:href":j.replace(/&/g,"&amp;")})}d.push("          "+Ae("table:table-cell",Ae("text:p",b,{}),S)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var f=c["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;nd(f),f.ods=l;var u=c["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),a.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=d;var f=c["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++d}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var d=[$t],c=Hi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Hi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+h+`>
`),d.push(d0().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)d.push(s(o.Sheets[o.SheetNames[f]],o,f));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function X0(e,t){if(t.bookType=="fods")return du(e,t);var r=Vc(),s="",i=[],a=[];return s="mimetype",Ge(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ge(r,s,du(e,t)),i.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",Ge(r,s,__(e,t)),i.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",Ge(r,s,$t+d0()),i.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",Ge(r,s,Bw(a)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ge(r,s,Lw(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Po(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function k_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Gr(Wi(e))}function C_(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Hn(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(i){r.set(i,s),s+=i.length}),r}function A_(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function Vi(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function ut(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Hs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Wt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],i=Vi(e,r),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Vi(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(s))}var c={data:l,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function er(e){var t=[];return e.forEach(function(r,s){r.forEach(function(i){i.data&&(t.push(ut(s*8+i.type)),i.type==2&&t.push(ut(i.data.length)),t.push(i.data))})}),Hn(t)}function qr(e){for(var t,r=[],s=[0];s[0]<e.length;){var i=Vi(e,s),a=Wt(e.slice(s[0],s[0]+i));s[0]+=i;var o={id:Hs(a[1][0].data),messages:[]};a[2].forEach(function(l){var d=Wt(l.data),c=Hs(d[3][0].data);o.messages.push({meta:d,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=a[3])!=null&&t[0]&&(o.merge=Hs(a[3][0].data)>>>0>0),r.push(o)}return r}function As(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:ut(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:ut(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:ut(o.data.length)}],s[2].push({data:er(o.meta),type:2})});var a=er(s);t.push(ut(a.length)),t.push(a),i.forEach(function(o){return t.push(o)})}),Hn(t)}function I_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Vi(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Hn(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(i.push(i[0].slice(-d)),c-=d;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-d,-d+c))}}var h=Hn(i);if(h.length!=s)throw new Error("Unexpected length: ".concat(h.length," != ").concat(s));return h}function Wr(e){for(var t=[],r=0;r<e.length;){var s=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(I_(s,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Hn(t)}function Is(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=ut(s),o=a.length;t.push(a),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=s}return Hn(t)}function Yl(e,t){var r=new Uint8Array(32),s=Po(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,A_(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,s.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,i)}function Kl(e,t){var r=new Uint8Array(32),s=Po(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,s.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,i)}function On(e){var t=Wt(e);return Vi(t[1][0].data)}function N_(e,t,r){var s,i,a,o;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Hs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=Po(e[7][0].data),h=0,f=[],u=Po(e[4][0].data),p=0,g=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),u.setUint16(x*2,65535);continue}c.setUint16(x*2,h,!0),u.setUint16(x*2,p,!0);var m,v;switch(typeof t[x]){case"string":m=Yl({t:"s",v:t[x]},r),v=Kl({t:"s",v:t[x]},r);break;case"number":m=Yl({t:"n",v:t[x]},r),v=Kl({t:"n",v:t[x]},r);break;case"boolean":m=Yl({t:"b",v:t[x]},r),v=Kl({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(m),h+=m.length,g.push(v),p+=v.length,++d}for(e[2][0].data=ut(d);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),u.setUint16(x*2,65535,!0);return e[6][0].data=Hn(f),e[3][0].data=Hn(g),d}function F_(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Pr(r["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Mt(s)));var a=Do(r,{range:s,header:1}),o=["~Sh33tJ5~"];a.forEach(function(H){return H.forEach(function(B){typeof B=="string"&&o.push(B)})});var l={},d=[],c=yt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(H,B){return[H,c.FullPaths[B]]}).forEach(function(H){var B=H[0],R=H[1];if(B.type==2&&B.name.match(/\.iwa/)){var K=B.content,se=Wr(K),we=qr(se);we.forEach(function(ye){d.push(ye.id),l[ye.id]={deps:[],location:R,type:Hs(ye.messages[0].meta[1][0].data)}})}}),d.sort(function(H,B){return H-B});var h=d.filter(function(H){return H>1}).map(function(H){return[H,ut(H)]});c.FileIndex.map(function(H,B){return[H,c.FullPaths[B]]}).forEach(function(H){var B=H[0];if(H[1],!!B.name.match(/\.iwa/)){var R=qr(Wr(B.content));R.forEach(function(K){K.messages.forEach(function(se){h.forEach(function(we){K.messages.some(function(ye){return Hs(ye.meta[1][0].data)!=11006&&C_(ye.data,we[1])})&&l[we[0]].deps.push(K.id)})})})}});for(var f=yt.find(c,l[1].location),u=qr(Wr(f.content)),p,g=0;g<u.length;++g){var x=u[g];x.id==1&&(p=x)}var m=On(Wt(p.messages[0].data)[1][0].data);for(f=yt.find(c,l[m].location),u=qr(Wr(f.content)),g=0;g<u.length;++g)x=u[g],x.id==m&&(p=x);for(m=On(Wt(p.messages[0].data)[2][0].data),f=yt.find(c,l[m].location),u=qr(Wr(f.content)),g=0;g<u.length;++g)x=u[g],x.id==m&&(p=x);for(m=On(Wt(p.messages[0].data)[2][0].data),f=yt.find(c,l[m].location),u=qr(Wr(f.content)),g=0;g<u.length;++g)x=u[g],x.id==m&&(p=x);var v=Wt(p.messages[0].data);{v[6][0].data=ut(s.e.r+1),v[7][0].data=ut(s.e.c+1);var S=On(v[46][0].data),T=yt.find(c,l[S].location),y=qr(Wr(T.content));{for(var w=0;w<y.length&&y[w].id!=S;++w);if(y[w].id!=S)throw"Bad ColumnRowUIDMapArchive";var k=Wt(y[w].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var b=0;b<=s.e.c;++b){var j=[];j[1]=j[2]=[{type:0,data:ut(b+420690)}],k[1].push({type:2,data:er(j)}),k[2].push({type:0,data:ut(b)}),k[3].push({type:0,data:ut(b)})}k[4]=[],k[5]=[],k[6]=[];for(var A=0;A<=s.e.r;++A)j=[],j[1]=j[2]=[{type:0,data:ut(A+726270)}],k[4].push({type:2,data:er(j)}),k[5].push({type:0,data:ut(A)}),k[6].push({type:0,data:ut(A)});y[w].messages[0].data=er(k)}T.content=Is(As(y)),T.size=T.content.length,delete v[46];var E=Wt(v[4][0].data);{E[7][0].data=ut(s.e.r+1);var C=Wt(E[1][0].data),I=On(C[2][0].data);T=yt.find(c,l[I].location),y=qr(Wr(T.content));{if(y[0].id!=I)throw"Bad HeaderStorageBucket";var F=Wt(y[0].messages[0].data);for(A=0;A<a.length;++A){var N=Wt(F[2][0].data);N[1][0].data=ut(A),N[4][0].data=ut(a[A].length),F[2][A]={type:F[2][0].type,data:er(N)}}y[0].messages[0].data=er(F)}T.content=Is(As(y)),T.size=T.content.length;var U=On(E[2][0].data);T=yt.find(c,l[U].location),y=qr(Wr(T.content));{if(y[0].id!=U)throw"Bad HeaderStorageBucket";for(F=Wt(y[0].messages[0].data),b=0;b<=s.e.c;++b)N=Wt(F[2][0].data),N[1][0].data=ut(b),N[4][0].data=ut(s.e.r+1),F[2][b]={type:F[2][0].type,data:er(N)};y[0].messages[0].data=er(F)}T.content=Is(As(y)),T.size=T.content.length;var M=On(E[4][0].data);(function(){for(var H=yt.find(c,l[M].location),B=qr(Wr(H.content)),R,K=0;K<B.length;++K){var se=B[K];se.id==M&&(R=se)}var we=Wt(R.messages[0].data);{we[3]=[];var ye=[];o.forEach(function(ce,xe){ye[1]=[{type:0,data:ut(xe)}],ye[2]=[{type:0,data:ut(1)}],ye[3]=[{type:2,data:k_(ce)}],we[3].push({type:2,data:er(ye)})})}R.messages[0].data=er(we);var X=As(B),ee=Is(X);H.content=ee,H.size=H.content.length})();var L=Wt(E[3][0].data);{var z=L[1][0];delete L[2];var J=Wt(z.data);{var ne=On(J[2][0].data);(function(){for(var H=yt.find(c,l[ne].location),B=qr(Wr(H.content)),R,K=0;K<B.length;++K){var se=B[K];se.id==ne&&(R=se)}var we=Wt(R.messages[0].data);{delete we[6],delete L[7];var ye=new Uint8Array(we[5][0].data);we[5]=[];for(var X=0,ee=0;ee<=s.e.r;++ee){var ce=Wt(ye);X+=N_(ce,a[ee],o),ce[1][0].data=ut(ee),we[5].push({data:er(ce),type:2})}we[1]=[{type:0,data:ut(s.e.c+1)}],we[2]=[{type:0,data:ut(s.e.r+1)}],we[3]=[{type:0,data:ut(X)}],we[4]=[{type:0,data:ut(s.e.r+1)}]}R.messages[0].data=er(we);var xe=As(B),Z=Is(xe);H.content=Z,H.size=H.content.length})()}z.data=er(J)}E[3][0].data=er(L)}v[4][0].data=er(E)}p.messages[0].data=er(v);var te=As(u),P=Is(te);return f.content=P,f.size=f.content.length,c}function R_(e){return function(r){for(var s=0;s!=e.length;++s){var i=e[s];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ld(e){R_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function P_(e,t){return t.bookType=="ods"?X0(e,t):t.bookType=="numbers"?F_(e,t):t.bookType=="xlsb"?D_(e,t):L_(e,t)}function D_(e,t){Bs=1024,e&&!e.SSF&&(e.SSF=Er(Pt)),e&&e.SSF&&(Ko(),Yo(e.SSF),t.revssf=Xo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ni?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=F0.indexOf(t.bookType)>-1,i=o0();ld(t=t||{});var a=Vc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ge(a,o,h0(e.Props,t)),i.coreprops.push(o),ft(t.rels,2,o,ot.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,o,f0(e.Props)),i.extprops.push(o),ft(t.rels,3,o,ot.EXT_PROPS),e.Custprops!==e.Props&&ar(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ge(a,o,x0(e.Custprops)),i.custprops.push(o),ft(t.rels,4,o,ot.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ge(a,o,BT(l-1,o,t,e,h)),i.sheets.push(o),ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ot.WS[0])}if(f){var p=f["!comments"],g=!1,x="";p&&p.length>0&&(x="xl/comments"+l+"."+r,Ge(a,x,UT(p,x)),i.comments.push(x),ft(h,-1,"../comments"+l+"."+r,ot.CMNT),g=!0),f["!legacy"]&&g&&Ge(a,"xl/drawings/vmlDrawing"+l+".vml",I0(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Ge(a,c0(o),qs(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ge(a,o,$T(t.Strings,o,t)),i.strs.push(o),ft(t.wbrels,-1,"sharedStrings."+r,ot.SST)),o="xl/workbook."+r,Ge(a,o,OT(e,o)),i.workbooks.push(o),ft(t.rels,1,o,ot.WB),o="xl/theme/theme1.xml",Ge(a,o,C0(e.Themes,t)),i.themes.push(o),ft(t.wbrels,-1,"theme/theme1.xml",ot.THEME),o="xl/styles."+r,Ge(a,o,MT(e,o,t)),i.styles.push(o),ft(t.wbrels,-1,"styles."+r,ot.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Ge(a,o,e.vbaraw),i.vba.push(o),ft(t.wbrels,-1,"vbaProject.bin",ot.VBA)),o="xl/metadata."+r,Ge(a,o,zT(o)),i.metadata.push(o),ft(t.wbrels,-1,"metadata."+r,ot.XLMETA),Ge(a,"[Content_Types].xml",l0(i,t)),Ge(a,"_rels/.rels",qs(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",qs(t.wbrels)),delete t.revssf,delete t.ssf,a}function L_(e,t){Bs=1024,e&&!e.SSF&&(e.SSF=Er(Pt)),e&&e.SSF&&(Ko(),Yo(e.SSF),t.revssf=Xo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ni?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=F0.indexOf(t.bookType)>-1,i=o0();ld(t=t||{});var a=Vc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ge(a,o,h0(e.Props,t)),i.coreprops.push(o),ft(t.rels,2,o,ot.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,o,f0(e.Props)),i.extprops.push(o),ft(t.rels,3,o,ot.EXT_PROPS),e.Custprops!==e.Props&&ar(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ge(a,o,x0(e.Custprops)),i.custprops.push(o),ft(t.rels,4,o,ot.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},u=e.Sheets[e.SheetNames[l-1]],p=(u||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ge(a,o,U0(l-1,t,e,f)),i.sheets.push(o),ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ot.WS[0])}if(u){var g=u["!comments"],x=!1,m="";if(g&&g.length>0){var v=!1;g.forEach(function(S){S[1].forEach(function(T){T.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+l+"."+r,Ge(a,m,fj(g,h,t)),i.threadedcomments.push(m),ft(f,-1,"../threadedComments/threadedComment"+l+"."+r,ot.TCMNT)),m="xl/comments"+l+"."+r,Ge(a,m,N0(g)),i.comments.push(m),ft(f,-1,"../comments"+l+"."+r,ot.CMNT),x=!0}u["!legacy"]&&x&&Ge(a,"xl/drawings/vmlDrawing"+l+".vml",I0(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Ge(a,c0(o),qs(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ge(a,o,j0(t.Strings,t)),i.strs.push(o),ft(t.wbrels,-1,"sharedStrings."+r,ot.SST)),o="xl/workbook."+r,Ge(a,o,W0(e)),i.workbooks.push(o),ft(t.rels,1,o,ot.WB),o="xl/theme/theme1.xml",Ge(a,o,C0(e.Themes,t)),i.themes.push(o),ft(t.wbrels,-1,"theme/theme1.xml",ot.THEME),o="xl/styles."+r,Ge(a,o,_0(e,t)),i.styles.push(o),ft(t.wbrels,-1,"styles."+r,ot.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Ge(a,o,e.vbaraw),i.vba.push(o),ft(t.wbrels,-1,"vbaProject.bin",ot.VBA)),o="xl/metadata."+r,Ge(a,o,A0()),i.metadata.push(o),ft(t.wbrels,-1,"metadata."+r,ot.XLMETA),h.length>1&&(o="xl/persons/person.xml",Ge(a,o,xj(h)),i.people.push(o),ft(t.wbrels,-1,"persons/person.xml",ot.PEOPLE)),Ge(a,"[Content_Types].xml",l0(i,t)),Ge(a,"_rels/.rels",qs(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",qs(t.wbrels)),delete t.revssf,delete t.ssf,a}function O_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=In(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Q0(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ta(t.file,yt.write(e,{type:ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return yt.write(e,t)}function B_(e,t){var r=Er(t||{}),s=P_(e,r);return M_(s,r)}function M_(e,t){var r={},s=ct?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?yt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Go(i))}return t.password&&typeof encrypt_agile<"u"?Q0(encrypt_agile(i,t.password),t):t.type==="file"?ta(t.file,i):t.type=="string"?ki(i):i}function $_(e,t){var r=t||{},s=r_(e,r);return Q0(s,r)}function sn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return zi(Wi(s));case"binary":return Wi(s);case"string":return e;case"file":return ta(t.file,s,"utf8");case"buffer":return ct?Rn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):sn(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function U_(e,t){switch(t.type){case"base64":return zi(e);case"binary":return e;case"string":return e;case"file":return ta(t.file,e,"binary");case"buffer":return ct?Rn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function La(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?zi(r):t.type=="string"?ki(r):r;case"file":return ta(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function cd(e,t){pb(),_T(e);var r=Er(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=cd(e,r);return r.type="array",Go(s)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sn(e_(e,r),r);case"slk":case"sylk":return sn(S2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return sn(G0(e.Sheets[e.SheetNames[i]],r),r);case"txt":return U_(J0(e.Sheets[e.SheetNames[i]],r),r);case"csv":return sn(dd(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return sn(E2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return La(j2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return sn(T2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return sn(F2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return sn(w0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return sn(X0(e,r),r);case"wk1":return La(nu.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return La(nu.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),La(V0(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$_(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return B_(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function z_(e,t,r,s,i,a,o,l){var d=ir(r),c=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[r][p]:e[s[p]+d];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[p]!=null&&(u[a[p]]=c);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(x==null)if(g.t=="e"&&x===null)u[a[p]]=null;else if(c!==void 0)u[a[p]]=c;else if(h&&x===null)u[a[p]]=null;else continue;else u[a[p]]=h&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?x:Nn(g,x,l);x!=null&&(f=!1)}}return{row:u,isempty:f}}function Do(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,i=1,a=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},h=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof h){case"string":d=Et(h);break;case"number":d=Et(e["!ref"]),d.s.r=h;break;default:d=h}s>0&&(i=0);var f=ir(d.s.r),u=[],p=[],g=0,x=0,m=Array.isArray(e),v=d.s.r,S=0,T={};m&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(S=d.s.c;S<=d.e.c;++S)if(!(y[S]||{}).hidden)switch(u[S]=ur(S),r=m?e[v][S]:e[u[S]+f],s){case 1:a[S]=S-d.s.c;break;case 2:a[S]=u[S];break;case 3:a[S]=c.header[S-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Nn(r,null,c),x=T[o]||0,!x)T[o]=1;else{do l=o+"_"+x++;while(T[l]);T[o]=x,T[l]=1}a[S]=l}for(v=d.s.r+i;v<=d.e.r;++v)if(!(w[v]||{}).hidden){var k=z_(e,d,v,u,s,a,m,c);(k.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var hu=/"/g;function q_(e,t,r,s,i,a,o,l){for(var d=!0,c=[],h="",f=ir(r),u=t.s.c;u<=t.e.c;++u)if(s[u]){var p=l.dense?(e[r]||[])[u]:e[s[u]+f];if(p==null)h="";else if(p.v!=null){d=!1,h=""+(l.rawNumbers&&p.t=="n"?p.v:Nn(p,null,l));for(var g=0,x=0;g!==h.length;++g)if((x=h.charCodeAt(g))===i||x===a||x===34||l.forceQuotes){h='"'+h.replace(hu,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(d=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(hu,'""')+'"')):h="";c.push(h)}return l.blankrows===!1&&d?null:c.join(o)}function dd(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var i=Et(e["!ref"]),a=s.FS!==void 0?s.FS:",",o=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,d=l.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),h="",f=[];s.dense=Array.isArray(e);for(var u=s.skipHidden&&e["!cols"]||[],p=s.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(u[g]||{}).hidden||(f[g]=ur(g));for(var x=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||(h=q_(e,i,m,f,o,d,a,s),h!=null&&(s.strip&&(h=h.replace(c,"")),(h||s.blankrows!==!1)&&r.push((x++?l:"")+h)));return delete s.dense,r.join("")}function J0(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=dd(e,t);return r}function W_(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var i=Et(e["!ref"]),a="",o=[],l,d=[],c=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=ur(l);for(var h=i.s.r;h<=i.e.r;++h)for(a=ir(h),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+a,r=c?(e[h]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function Z0(e,t,r){var s=r||{},i=+!s.skipHeader,a=e||{},o=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Kt(s.origin):s.origin;o=d.r,l=d.c}var c,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(a["!ref"]){var f=Et(a["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),o==-1&&(o=f.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var u=s.header||[],p=0;t.forEach(function(x,m){ar(x).forEach(function(v){(p=u.indexOf(v))==-1&&(u[p=u.length]=v);var S=x[v],T="z",y="",w=mt({c:l+p,r:o+m+i});c=Gi(a,w),S&&typeof S=="object"&&!(S instanceof Date)?a[w]=S:(typeof S=="number"?T="n":typeof S=="boolean"?T="b":typeof S=="string"?T="s":S instanceof Date?(T="d",s.cellDates||(T="n",S=Sr(S)),y=s.dateNF||Pt[14]):S===null&&s.nullError&&(T="e",S=0),c?(c.t=T,c.v=S,delete c.w,delete c.R,y&&(c.z=y)):a[w]=c={t:T,v:S},y&&(c.z=y))})}),h.e.c=Math.max(h.e.c,l+u.length-1);var g=ir(o);if(i)for(p=0;p<u.length;++p)a[ur(p+l)+g]={t:"s",v:u[p]};return a["!ref"]=Mt(h),a}function H_(e,t){return Z0(null,e,t)}function Gi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Kt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gi(e,mt(t)):Gi(e,mt({r:t,c:r||0}))}function V_(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function G_(){return{SheetNames:[],Sheets:{}}}function Y_(e,t,r,s){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(q0(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function K_(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=V_(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function X_(e,t){return e.z=t,e}function ex(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Q_(e,t,r){return ex(e,"#"+t,r)}function J_(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Z_(e,t,r,s){for(var i=typeof t!="string"?t:Et(t),a=typeof t=="string"?t:Mt(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var d=Gi(e,o,l);d.t="n",d.F=a,delete d.v,o==i.s.r&&l==i.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Vs={encode_col:ur,encode_row:ir,encode_cell:mt,encode_range:Mt,decode_col:Jc,decode_row:Qc,split_cell:pw,decode_cell:Kt,decode_range:Pr,format_cell:Nn,sheet_add_aoa:t0,sheet_add_json:Z0,sheet_add_dom:Y0,aoa_to_sheet:ti,json_to_sheet:H_,table_to_sheet:K0,table_to_book:E_,sheet_to_csv:dd,sheet_to_txt:J0,sheet_to_json:Do,sheet_to_html:G0,sheet_to_formulae:W_,sheet_to_row_object_array:Do,sheet_get_cell:Gi,book_new:G_,book_append_sheet:Y_,book_set_sheet_visibility:K_,cell_set_number_format:X_,cell_set_hyperlink:ex,cell_set_internal_link:Q_,cell_add_comment:J_,sheet_set_array_formula:Z_,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},tx={exports:{}};(function(e,t){(function(r,s){s()})(Ls,function(){function r(c,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function s(c,h,f){var u=new XMLHttpRequest;u.open("GET",c),u.responseType="blob",u.onload=function(){d(u.response,h,f)},u.onerror=function(){console.error("could not download file")},u.send()}function i(c){var h=new XMLHttpRequest;h.open("HEAD",c,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ls=="object"&&Ls.global===Ls?Ls:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,h,f){var u=o.URL||o.webkitURL,p=document.createElement("a");h=h||c.name||"download",p.download=h,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?a(p):i(p.href)?s(c,h,f):a(p,p.target="_blank")):(p.href=u.createObjectURL(c),setTimeout(function(){u.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,h,f){if(h=h||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,f),h);else if(i(c))s(c,h,f);else{var u=document.createElement("a");u.href=c,u.target="_blank",setTimeout(function(){a(u)})}}:function(c,h,f,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof c=="string")return s(c,h,f);var p=c.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||p&&g||l)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var T=m.result;T=x?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=T:location=T,u=null},m.readAsDataURL(c)}else{var v=o.URL||o.webkitURL,S=v.createObjectURL(c);u?u.location=S:location.href=S,u=null,setTimeout(function(){v.revokeObjectURL(S)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})})(tx);var rx=tx.exports;const{Title:gk,Text:Ht}=Me,e4=({selectedBooking:e,isDetailsModalVisible:t,setIsDetailsModalVisible:r,setSelectedBooking:s,setIsStatusModalVisible:i,setSelectedStatus:a,setRejectionReasonText:o,formatBookingNumber:l})=>n.jsx(Ye,{title:"Booking Details",open:t,onCancel:()=>{r(!1),s(null)},footer:[n.jsx(re,{type:"primary",disabled:!e,onClick:()=>{e&&(a(e.status),o(e.rejectionReason||""),i(!0))},children:"Update Status"},"updateStatus"),n.jsx(re,{onClick:()=>{r(!1),s(null)},children:"Close"},"close")],width:800,children:e&&n.jsxs(ue,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(Ve,{bordered:!0,column:2,children:[n.jsxs(Ve.Item,{label:"Booking Number",span:2,children:[l(e._id,e.createdAt),n.jsxs(Ht,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",e._id,")"]})]}),n.jsx(Ve.Item,{label:"Exhibition",span:2,children:e.exhibitionId.name}),n.jsxs(Ve.Item,{label:"Status",span:2,children:[n.jsx(_e,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()}),e.rejectionReason&&n.jsxs("div",{style:{marginTop:8},children:[n.jsx(Ht,{type:"secondary",children:"Rejection Reason:"}),n.jsx("br",{}),n.jsx(Ht,{children:e.rejectionReason})]})]}),n.jsx(Ve.Item,{label:"Customer Name",children:e.customerName}),n.jsx(Ve.Item,{label:"Customer Email",children:e.customerEmail}),n.jsx(Ve.Item,{label:"Customer Phone",children:e.customerPhone}),n.jsx(Ve.Item,{label:"Company Name",children:e.companyName})]}),n.jsx(de,{title:"Stall Details",size:"small",children:n.jsx(st,{dataSource:e.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:d=>d.type||"-"},{title:"Dimensions",key:"dimensions",render:d=>n.jsx(_e,{color:"blue",children:d.dimensions?`${d.dimensions.width}x${d.dimensions.height}m`:"No dimensions"})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:d=>`${d.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:d=>{const c=e.calculations.stalls.find(h=>h.stallId===d._id);return c?`${c.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:d=>{const c=e.calculations.stalls.find(h=>h.stallId===d._id);return c!=null&&c.discount?n.jsx(Ke,{title:n.jsx("div",{children:c.discount.type==="percentage"&&` (${c.discount.value}%)`}),children:n.jsxs(_e,{color:"red",children:["-",c.discount.amount.toLocaleString(),c.discount.type==="percentage"&&` (${c.discount.value}%)`]})}):"-"}}]})}),n.jsx(de,{title:"Financial Summary",size:"small",children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},size:"small",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Ht,{children:"Total Base Amount:"}),n.jsxs(Ht,{children:["",e.calculations.totalBaseAmount.toLocaleString()]})]}),e.calculations.totalDiscountAmount>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Ht,{children:"Total Discount:"}),n.jsxs(Ht,{type:"danger",children:["-",e.calculations.totalDiscountAmount.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Ht,{children:"Amount after Discount:"}),n.jsxs(Ht,{children:["",e.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),n.jsx(it,{style:{margin:"8px 0"}}),e.calculations.taxes.map(d=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Ht,{children:[d.name," (",d.rate,"%):"]}),n.jsxs(Ht,{children:["",d.amount.toLocaleString()]})]},`tax-${d.name}-${d.rate}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(Ht,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(Ht,{strong:!0,children:["",e.amount.toLocaleString()]})]})]})})]})}),t4=({selectedBooking:e,isStatusModalVisible:t,setIsStatusModalVisible:r,selectedStatus:s,setSelectedStatus:i,rejectionReasonText:a,setRejectionReasonText:o,formatBookingNumber:l,refreshAfterAction:d})=>{const c=lt(),[h,f]=xt.useState(!1),{refetch:u}=Vo({page:1,limit:100}),p=async(x,m,v)=>{try{f(!0),await c(oo({id:x,status:m,...v&&{rejectionReason:v}})).unwrap(),Se.success(`Booking ${m} successfully`),d(),r(!1),g(null),m==="approved"&&setTimeout(async()=>{await u()},1e3)}catch{Se.error("Failed to update booking status")}finally{f(!1)}},g=x=>{};return n.jsx(Ye,{title:"Update Booking Status",open:t,onCancel:()=>{r(!1),o("")},footer:null,width:600,children:e&&n.jsxs("div",{children:[n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Cn,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},variant:"borderless",size:"small",children:n.jsxs(ue,{direction:"vertical",size:8,style:{width:"100%"},children:[n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(_e,{color:"processing",children:l(e._id,e.createdAt)}),n.jsx(_e,{color:"default",children:e.exhibitionId.name}),n.jsx(_e,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()})]}),n.jsxs("div",{style:{marginTop:"8px"},children:[n.jsx(Ht,{strong:!0,children:"Stall Details:"}),n.jsx("div",{style:{marginTop:"4px"},children:e.stallIds.map((x,m)=>n.jsxs(_e,{style:{margin:"2px"},children:["#",x.number," ",x.type&&`(${x.type})`]},x._id))})]}),n.jsx(it,{style:{margin:"8px 0"}}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(Ht,{strong:!0,style:{minWidth:"120px"},children:"Company:"}),n.jsx(Ht,{children:e.companyName})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(Ht,{strong:!0,style:{minWidth:"120px"},children:"Current Status:"}),n.jsx(_e,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()})]})]})}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Xs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),variant:"borderless",size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Ht,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(vr.Group,{value:s,onChange:x=>i(x.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[n.jsx(vr.Button,{value:"pending",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Qt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(vr.Button,{value:"approved",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(St,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(vr.Button,{value:"rejected",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Zr,{style:{color:"#f5222d"}}),"Rejected"]})}),n.jsx(vr.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(St,{style:{color:"#1890ff"}}),"Confirmed"]})}),n.jsx(vr.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Zr,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),s==="rejected"&&n.jsx("div",{children:n.jsx(W.Item,{label:n.jsx(Ht,{strong:!0,children:"Rejection Reason:"}),required:s==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:n.jsx(he.TextArea,{rows:4,value:a,onChange:x=>o(x.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),s==="approved"&&n.jsx(It,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),s==="confirmed"&&n.jsx(It,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),s==="cancelled"&&n.jsx(It,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),s==="pending"&&n.jsx(It,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(re,{onClick:()=>{r(!1),o("")},children:"Cancel"}),n.jsx(re,{type:"primary",onClick:()=>{if(s==="rejected"&&!a.trim()){Se.error("Rejection reason is required when rejecting a booking");return}p(e._id,s,s==="rejected"?a:void 0)},loading:h,disabled:s==="rejected"&&!a.trim(),children:"Update Status"})]})]})]})})},r4=(e,t,r)=>{Ye.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(sr,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Booking"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete booking ",n.jsx("strong",{children:r(e._id,e.createdAt)}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data including invoices."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(re,{onClick:()=>Ye.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(re,{danger:!0,type:"primary",onClick:()=>{t(e._id),Ye.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},n4=e=>{const t=tt(),{data:r,isLoading:s,error:i,refetch:a}=Vo({page:1,limit:100}),o=d=>{if(s||i||!r)return null;const h=(r.data||[]).find(f=>f.bookingId&&typeof f.bookingId=="object"&&f.bookingId._id===d);return h==null?void 0:h._id},l=async d=>{if(s){Se.loading("Loading invoice data...");return}let c=o(d._id);if(c)t(`/invoice/${c}`);else{const h="invoice-loading";if(Se.loading({content:"Checking for invoice...",key:h}),await a(),c=o(d._id),c){Se.success({content:"Invoice found!",key:h,duration:1}),t(`/invoice/${c}`);return}const f=new Date(d.createdAt),u=new Date(Date.now()-30*60*1e3);if(f>u||d.status==="approved"){Se.info({content:"Invoice is still being generated. Checking again in a moment...",key:h});let g=0;const x=5,m=[2e3,3e3,5e3,8e3,1e4],v=async()=>{g++,await a();const S=o(d._id);if(S)Se.success({content:"Invoice is ready!",key:h,duration:1}),t(`/invoice/${S}`);else if(g<x){const T=m[g]||5e3,y=T/1e3;Se.info({content:`Attempt ${g}/${x}: Invoice not ready yet. Trying again in ${y} seconds...`,key:h}),setTimeout(v,T)}else Se.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:h})};setTimeout(v,m[0])}else Se.error({content:"No invoice found for this booking. Please contact support if this persists.",key:h})}};return[{title:"Booking Number",dataIndex:"_id",key:"bookingNumber",fixed:"left",width:170,render:(d,c)=>n.jsx(re,{type:"link",onClick:()=>{e.setSelectedBooking(c),e.setIsDetailsModalVisible(!0)},children:e.formatBookingNumber(d,c.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(d,c)=>c.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:d=>d||"N/A"},{title:"Stall No.",key:"stallNumber",width:120,render:(d,c)=>n.jsx("span",{children:c.stallIds.map((h,f)=>n.jsxs("span",{children:[h.number,f<c.stallIds.length-1?", ":""]},`stall-${h._id||f}`))})},{title:"Stall Type",key:"stallType",width:120,render:(d,c)=>{const h=Array.from(new Set(c.stallIds.map(f=>f.type)));return n.jsx("span",{children:h.map((f,u)=>n.jsxs("span",{children:[f,u<h.length-1?", ":""]},`type-${f}-${u}`))})}},{title:"Dimensions",key:"dimensions",width:150,render:(d,c)=>n.jsx("span",{children:c.stallIds.map((h,f)=>n.jsxs("span",{children:[h.dimensions?`${h.dimensions.width}m  ${h.dimensions.height}m`:"No dimensions",f<c.stallIds.length-1?", ":""]},`dim-${h._id||f}`))})},{title:"Area (sqm)",key:"area",width:120,render:(d,c)=>{const h=c.stallIds.reduce((f,u)=>u.dimensions?f+u.dimensions.width*u.dimensions.height:f,0);return n.jsxs("span",{children:[Math.round(h)," sqm"]})}},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:d=>`${d.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(d,c)=>{const h=c.calculations.totalDiscountAmount;if(!h||h===0)return"-";const f=c.calculations.stalls.filter(p=>p.discount).map(p=>p.discount);if(f.length===0)return"-";const u=f[0];return n.jsx(Ke,{title:n.jsx("div",{children:f.map((p,g)=>n.jsxs("div",{children:[p==null?void 0:p.name,": ",(p==null?void 0:p.type)==="percentage"?`${p==null?void 0:p.value}%`:`${p==null?void 0:p.value}`,n.jsx("br",{}),"Amount: ",p==null?void 0:p.amount.toLocaleString()]},`discount-${g}-${(p==null?void 0:p.name)||"unnamed"}`))}),children:n.jsxs(_e,{color:"red",children:["-",h.toLocaleString(),(u==null?void 0:u.type)==="percentage"&&` (${u.value}%)`,f.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:d=>`${d.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:d=>n.jsx(_e,{color:d==="confirmed"?"success":d==="approved"?"blue":d==="pending"?"warning":d==="rejected"?"error":"default",children:d.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:d=>nt(d).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(d,c)=>n.jsxs(ue,{children:[n.jsx(Ke,{title:"View Details",children:n.jsx(re,{icon:n.jsx(hn,{}),onClick:()=>{e.setSelectedBooking(c),e.setIsDetailsModalVisible(!0)}})}),n.jsx(Vn,{overlay:n.jsxs(hr,{children:[c.status!=="cancelled"&&e.hasPermission("view_bookings")&&n.jsx(hr.Item,{icon:n.jsx(Cn,{}),disabled:s,onClick:()=>l(c),children:"View Invoice"},"invoice"),n.jsx(hr.Item,{icon:n.jsx(St,{}),onClick:()=>{e.setSelectedBooking(c),e.setSelectedStatus(c.status),e.setRejectionReasonText(c.rejectionReason||""),e.setIsStatusModalVisible(!0)},children:"Update Status"},"updateStatus"),e.hasPermission("bookings_delete")&&n.jsx(hr.Item,{icon:n.jsx(sr,{}),danger:!0,onClick:()=>{r4(c,e.handleDelete,e.formatBookingNumber)},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(re,{icon:n.jsx(Ec,{})})})]})}]},s4=e=>{const{bookings:t,loading:r,pagination:s,fetchBookingsWithPagination:i}=e,a=n4(e),o=(l,d,c,h)=>n.jsx("div",{className:"ant-table-pagination ant-table-pagination-right",style:{padding:"16px 24px",margin:0,display:"flex",justifyContent:"flex-end"},children:n.jsx(Yx,{current:l,pageSize:d,total:c,showTotal:f=>`Total ${f} items`,showSizeChanger:!0,pageSizeOptions:["5","10","20","50","100"],onChange:f=>h(f,d),onShowSizeChange:(f,u)=>h(f,u),size:"default"})});return n.jsxs(n.Fragment,{children:[n.jsx(st,{columns:a,dataSource:t,loading:r,rowKey:"_id",scroll:{x:1800},pagination:!1}),o(s.page,s.limit,s.total,(l,d)=>i(l,d))]})},{Title:i4,Text:a4}=Me,o4=()=>{const e=lt(),{bookings:t,loading:r,pagination:s,stats:i,statsLoading:a}=qe(L=>L.booking),{exhibitions:o}=qe(L=>L.exhibition),[l,d]=_.useState(null),[c,h]=_.useState(!1),[f,u]=_.useState(!1),[p,g]=_.useState("pending"),[x,m]=_.useState(""),[v,S]=_.useState({search:"",status:[],dateRange:null,exhibition:null}),T=tt(),{data:y,isLoading:w,error:k,refetch:b}=Vo({page:1,limit:100}),{hasPermission:j}=Wo(),A=_.useCallback((L=1,z=10)=>{const J={page:L,limit:z};v.search&&(J.search=v.search),v.exhibition&&(J.exhibitionId=v.exhibition),v.status&&v.status.length>0&&(J.status=v.status),v.dateRange&&v.dateRange.length===2&&(J.startDate=v.dateRange[0],J.endDate=v.dateRange[1]),e(Ti(J))},[e,v]),E=_.useCallback(()=>{e(co())},[e]),C=_.useCallback(()=>{A(s.page,s.limit),E()},[A,E,s.page,s.limit]);_.useEffect(()=>{A(s.page,s.limit),E()},[A,E,s.page,s.limit]),_.useEffect(()=>{e(Mr())},[e]),_.useEffect(()=>{t.length>0&&[...new Set(t.map(z=>z.exhibitionId._id))].forEach(z=>{e($r(z))})},[t,e]);const I=async L=>{try{await e(lo(L)).unwrap(),Se.success("Booking deleted successfully"),C()}catch(z){Se.error((z==null?void 0:z.message)||"Failed to delete booking")}},F=L=>{S(L),A(1,s.limit)},N=Array.isArray(t)?t:[],U=(L,z)=>{const J=new Date(z).getFullYear(),ne=N.find(K=>K._id===L);if(!ne)return`--/${J}/--`;const H=(N.filter(K=>K.exhibitionId._id===ne.exhibitionId._id).sort((K,se)=>new Date(K.createdAt).getTime()-new Date(se.createdAt).getTime()).findIndex(K=>K._id===L)+1).toString().padStart(2,"0"),B=o.find(K=>K._id===ne.exhibitionId._id);return`${(B==null?void 0:B.invoicePrefix)||ne.exhibitionId.invoicePrefix||"BK"}/${J}/${H}`},M=async()=>{try{Se.loading({content:"Preparing export...",key:"export"});const L={};v.search&&(L.search=v.search),v.exhibition&&(L.exhibitionId=v.exhibition),v.status&&v.status.length>0&&(L.status=v.status),v.dateRange&&v.dateRange.length===2&&(L.startDate=v.dateRange[0],L.endDate=v.dateRange[1]);const ne=(await(await yu(async()=>{const{default:se}=await Promise.resolve().then(()=>_p);return{default:se}},void 0)).default.get("/bookings/export",{params:L})).data;if(!Array.isArray(ne))throw new Error("Invalid data format received");const te=ne.map(se=>{const we=se.stallIds.reduce((ye,X)=>X.dimensions?ye+X.dimensions.width*X.dimensions.height:ye,0);return{"Booking Number":U(se._id,se.createdAt),Exhibition:se.exhibitionId.name,"Company Name":se.companyName||"N/A","Customer Name":se.customerName,"Customer Email":se.customerEmail,"Customer Phone":se.customerPhone,"Stall Numbers":se.stallIds.map(ye=>ye.number).join(", "),"Stall Types":Array.from(new Set(se.stallIds.map(ye=>ye.type||(ye.stallTypeId&&typeof ye.stallTypeId=="object"?ye.stallTypeId.name:"-")))).join(", "),Dimensions:se.stallIds.map(ye=>ye.dimensions?`${ye.dimensions.width}m  ${ye.dimensions.height}m`:"No dimensions").join(", "),"Total Area (sqm)":Math.round(we),"Base Amount":Math.round(se.calculations.totalBaseAmount),Discount:Math.round(se.calculations.totalDiscountAmount),"Total Amount":Math.round(se.calculations.totalAmount),Status:se.status.toUpperCase(),"Created Date":new Date(se.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}}),P=Vs.json_to_sheet(te),H=Vs.book_new();Vs.book_append_sheet(H,P,"Bookings");const B=cd(H,{bookType:"xlsx",type:"array"}),R=new Blob([B],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),K=new Date().toISOString().split("T")[0];rx.saveAs(R,`bookings_export_${K}.xlsx`),Se.success({content:"Export successful!",key:"export",duration:2})}catch(L){console.error("Export error:",L),Se.error({content:"Failed to export bookings",key:"export",duration:2})}};return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ne,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(i4,{level:4,style:{margin:0},children:"Stall Bookings"}),n.jsx(a4,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),n.jsx(Q,{children:n.jsxs(ue,{children:[n.jsx(re,{icon:n.jsx(Yi,{}),onClick:M,size:"large",children:"Export"}),n.jsx(re,{type:"primary",size:"large",icon:n.jsx(mr,{}),onClick:()=>T("/bookings/create"),children:"Create Booking"})]})})]})}),n.jsx(db,{bookings:t,paginationTotal:s.total,stats:i,statsLoading:a}),n.jsx(ub,{filters:v,exhibitions:o,onFilterChange:F,onRefresh:C}),n.jsx(de,{className:"info-card",styles:{body:{padding:0,overflow:"auto"},header:{paddingBottom:12}},title:"Booking List",children:n.jsx(s4,{bookings:N,loading:r,fetchBookingsWithPagination:A,pagination:s,setSelectedBooking:d,setIsDetailsModalVisible:h,setIsStatusModalVisible:u,setSelectedStatus:g,setRejectionReasonText:m,formatBookingNumber:U,handleDelete:I,hasPermission:j})}),n.jsx(e4,{selectedBooking:l,isDetailsModalVisible:c,setIsDetailsModalVisible:h,setSelectedBooking:d,setIsStatusModalVisible:u,setSelectedStatus:g,setRejectionReasonText:m,formatBookingNumber:U}),n.jsx(t4,{selectedBooking:l,isStatusModalVisible:f,setIsStatusModalVisible:u,selectedStatus:p,setSelectedStatus:g,rejectionReasonText:x,setRejectionReasonText:m,formatBookingNumber:U,refreshAfterAction:C})]})},l4={exhibitors:[],loading:!1,error:null},cn=et("exhibitors/fetchAll",async(e,{rejectWithValue:t})=>{var r,s;try{return(await dr.getExhibitors()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch exhibitors")}}),c4=br({name:"exhibitor",initialState:l4,reducers:{},extraReducers:e=>{e.addCase(cn.pending,t=>{t.loading=!0,t.error=null}).addCase(cn.fulfilled,(t,r)=>{t.exhibitors=r.payload,t.loading=!1}).addCase(cn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),d4=c4.reducer,{Title:h4,Text:tn}=Me,u4=()=>{var se,we,ye;const[e]=W.useForm(),[t]=W.useForm(),[r,s]=_.useState(!1),[i,a]=_.useState([]),[o,l]=_.useState(!1),[d,c]=_.useState([]),[h,f]=_.useState(null),[u,p]=_.useState(),[g,x]=_.useState([]),[m,v]=_.useState({}),[S,T]=_.useState([]),[y,w]=_.useState(0),k=tt(),b=lt(),{loading:j}=qe(X=>X.booking),{exhibitions:A=[],loading:E}=qe(X=>X.exhibition),{exhibitors:C=[],loading:I}=qe(X=>X.exhibitor),{isAuthenticated:F}=qe(X=>X.auth);_.useEffect(()=>{if(!F){Se.error("Please login to create a booking"),k("/login");return}b(Mr()),b(cn())},[b,F,k]);const N=async X=>{try{l(!0),e.setFieldValue("stallIds",[]),e.setFieldValue("discountId",void 0),e.setFieldValue("extraAmenities",[]),c([]),x([]),T([]),w(0);const ee=await wt.getExhibition(X);f(ee.data);const xe=(await wt.getStalls(X)).data.filter(Z=>Z.status==="available");a(xe)}catch(ee){console.error("Failed to fetch exhibition data:",ee),Se.error("Failed to fetch exhibition data")}finally{l(!1)}},U=X=>Math.round(X.ratePerSqm*X.dimensions.width*X.dimensions.height*100)/100,M=X=>{var xe;const ee=i.filter(Z=>{const ge=Z._id||Z.id;return ge&&X.includes(ge)});c(ee);const ce=ee.reduce((Z,ge)=>Z+ge.dimensions.width*ge.dimensions.height,0);if(w(ce),(xe=h==null?void 0:h.basicAmenities)!=null&&xe.length){const Z=h.basicAmenities.map(ge=>{const be=Math.floor(ce/ge.perSqm)*ge.quantity;return{...ge,calculatedQuantity:be>0?be:0,key:ge._id||ge.id}});T(Z)}},L=(X,ee,ce)=>{if(!(ce!=null&&ce.isActive))return 0;let xe=0;if(ce.type==="percentage")xe=X*(Math.max(0,Math.min(100,ce.value))/100);else{const Z=X/ee*ce.value;xe=Math.min(Z,X)}return Math.round(xe*100)/100},z=async X=>{var ee,ce;try{const xe=C.find(Be=>Be._id===X.exhibitorId);if(!xe)throw new Error("Selected exhibitor not found");const[Z,ge,be]=X.discountId?X.discountId.split("-"):[],ve=(ee=h==null?void 0:h.discountConfig)==null?void 0:ee.find(Be=>`${Be.name}-${Be.value}-${Be.type}`===X.discountId),Fe=d.map(Be=>{const at=Be._id||Be.id;if(!at)throw new Error(`Invalid stall ID for stall number ${Be.number}`);return{stall:Be,stallId:at,baseAmount:U(Be)}}),pe=Fe.reduce((Be,{baseAmount:at})=>Be+at,0),Ue=Fe.map(({stall:Be,stallId:at,baseAmount:Tt})=>{const Tr=ve?L(Tt,pe,ve):0;return{stallId:at,number:Be.number,baseAmount:Tt,discount:ve?{name:ve.name,type:ve.type,value:ve.value,amount:Tr}:void 0,amountAfterDiscount:Math.round((Tt-Tr)*100)/100}}),We=Ue.reduce((Be,at)=>{var Tt;return Be+(((Tt=at.discount)==null?void 0:Tt.amount)||0)},0),gt=Math.round((pe-We)*100)/100,dt=((ce=h==null?void 0:h.taxConfig)==null?void 0:ce.filter(Be=>Be.isActive).map(Be=>({name:Be.name,rate:Be.rate,amount:Math.round(gt*Be.rate/100*100)/100})))||[],Pe=dt.reduce((Be,at)=>Be+at.amount,0),ze=Math.round((gt+Pe)*100)/100,Xe={exhibitionId:X.exhibitionId,exhibitorId:X.exhibitorId,stallIds:Ue.map(Be=>Be.stallId),customerName:xe.contactPerson,customerEmail:xe.email,customerPhone:xe.phone,customerAddress:xe.address||"N/A",customerGSTIN:xe.gstNumber||"N/A",customerPAN:xe.panNumber||"N/A",companyName:xe.companyName,discount:ve?{name:ve.name,type:ve.type,value:ve.value}:void 0,amount:ze,calculations:{stalls:Ue,totalBaseAmount:pe,totalDiscountAmount:We,totalAmountAfterDiscount:gt,taxes:dt,totalTaxAmount:Pe,totalAmount:ze}};S.length&&(Xe.basicAmenities=S.filter(Be=>Be.calculatedQuantity>0).map(Be=>({name:Be.name,type:Be.type,perSqm:Be.perSqm,quantity:Be.quantity,calculatedQuantity:Be.calculatedQuantity,description:Be.description}))),g.length&&(Xe.extraAmenities=B());const $e=await b(ao(Xe)).unwrap();$e&&$e.invoiceId?(Se.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{k(`/invoice/${$e.invoiceId}`)},2e3)):(Se.success("Booking created successfully"),k("/bookings")),$e&&$e.warning&&Se.warning($e.warning)}catch(xe){console.error("Error creating booking:",xe),Se.error("Failed to create booking")}},J=async X=>{try{const ee=await dr.createExhibitor(X);Se.success("Exhibitor added successfully"),b(cn()),e.setFieldsValue({exhibitorId:ee.data._id}),s(!1),t.resetFields()}catch(ee){const ce=(ee==null?void 0:ee.message)||"Failed to add exhibitor";Se.error(ce),ce==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},ne=A.map(X=>({label:X.name,value:X._id||X.id})),te=C.map(X=>({label:X.companyName,value:X._id}));i.map(X=>({label:`Stall ${X.number} (${X.dimensions.width}m  ${X.dimensions.height}m = ${(X.dimensions.width*X.dimensions.height).toFixed(2)} sqm) - ${X.ratePerSqm.toLocaleString()}/sq.m`,value:X._id||X.id}));const P=X=>{p(X),e.setFieldValue("discountId",X)},H=()=>{var ve,Fe;const X=d.reduce((pe,Ue)=>pe+U(Ue),0),ee=(ve=h==null?void 0:h.discountConfig)==null?void 0:ve.find(pe=>`${pe.name}-${pe.value}-${pe.type}`===u&&pe.isActive),ce=ee?ee.type==="percentage"?Math.round(X*ee.value/100*100)/100:Math.min(ee.value,X):0,xe=Math.round((X-ce)*100)/100,Z=((Fe=h==null?void 0:h.taxConfig)==null?void 0:Fe.filter(pe=>pe.isActive).map(pe=>({name:pe.name,rate:pe.rate,amount:Math.round(xe*pe.rate/100*100)/100})))||[],ge=Z.reduce((pe,Ue)=>pe+Ue.amount,0),be=Math.round((xe+ge)*100)/100;return{baseAmount:X,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:xe,taxes:Z,totalTaxAmount:ge,totalAmount:be}},B=()=>{var X;return(X=h==null?void 0:h.amenities)!=null&&X.length?h.amenities.filter(ee=>{const ce=ee._id||ee.id;return ce&&g.includes(ce.toString())}).map(ee=>{const ce=(ee._id||ee.id).toString();return{id:ce,name:ee.name,type:ee.type,rate:ee.rate,description:ee.description,quantity:m[ce]||1}}):[]},R=X=>{const ee={...m};X.forEach(ce=>{g.includes(ce)||(ee[ce]=1)}),Object.keys(ee).forEach(ce=>{X.includes(ce)||delete ee[ce]}),v(ee),x(X)},K=(X,ee)=>{v(ce=>({...ce,[X]:ee}))};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{span:24,children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(h4,{level:2,style:{margin:0},children:"Create Booking"}),n.jsx(Me.Text,{type:"secondary",children:"Create a new stall booking"})]})}),n.jsx(Q,{span:24,children:n.jsx(de,{children:n.jsx(W,{form:e,layout:"vertical",onFinish:z,style:{maxWidth:800},children:n.jsxs(Ne,{gutter:16,children:[n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:n.jsx(Le,{placeholder:"Select exhibition",loading:E,options:ne,onChange:N})})}),n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"exhibitorId",label:n.jsxs(ue,{children:[n.jsx("span",{children:"Exhibitor"}),n.jsx(re,{type:"link",icon:n.jsx(mr,{}),onClick:()=>s(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:n.jsx(Le,{showSearch:!0,placeholder:"Select exhibitor",loading:I,options:te,filterOption:(X,ee)=>{var ce;return(((ce=ee==null?void 0:ee.label)==null?void 0:ce.toString())??"").toLowerCase().includes(X.toLowerCase())}})})}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:n.jsx(Le,{mode:"multiple",placeholder:o?"Loading stalls...":"Select stalls",loading:o,onChange:M,options:i.map(X=>({label:`Stall ${X.number} (${X.dimensions.width}m  ${X.dimensions.height}m = ${(X.dimensions.width*X.dimensions.height).toFixed(2)} sqm) - ${X.ratePerSqm.toLocaleString()}/sq.m`,value:X._id||X.id}))})})}),d.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Q,{span:24,children:n.jsx(de,{title:"Selected Stalls Summary",size:"small",children:n.jsx(st,{dataSource:d.map(X=>({...X,key:X._id||X.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(X,ee)=>{var ce,xe;return((ce=ee.stallType)==null?void 0:ce.name)||(typeof ee.stallTypeId=="object"?(xe=ee.stallTypeId)==null?void 0:xe.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(X,ee)=>`${ee.dimensions.width}m  ${ee.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(X,ee)=>(ee.dimensions.width*ee.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:X=>`${X.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(X,ee)=>`${U(ee).toLocaleString()}`}],summary:()=>{const X=d.reduce((ee,ce)=>ee+U(ce),0);return n.jsxs(st.Summary.Row,{children:[n.jsx(st.Summary.Cell,{index:0,colSpan:5,children:n.jsx("strong",{children:"Total Base Amount"})}),n.jsx(st.Summary.Cell,{index:1,children:n.jsxs("strong",{children:["",X.toLocaleString()]})})]},"summary")}})})}),n.jsx(Q,{span:24,children:n.jsx(de,{title:"Stall Amenities",size:"small",children:n.jsxs(Ne,{gutter:[16,24],children:[n.jsxs(Q,{span:24,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Me.Title,{level:5,style:{margin:0},children:n.jsxs(ue,{children:[n.jsx("span",{children:"Included Basic Amenities"}),n.jsx(_e,{color:"green",children:"Based on stall area"})]})}),n.jsxs(Me.Text,{type:"secondary",children:["The following amenities are included based on your total stall area of ",y.toFixed(2)," sqm."]})]}),(se=h==null?void 0:h.basicAmenities)!=null&&se.length?n.jsx(st,{dataSource:S.filter(X=>X.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(X,ee)=>n.jsxs(ue,{children:[n.jsx(Me.Text,{strong:!0,children:X}),n.jsx(_e,{color:"blue",children:ee.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:X=>n.jsxs(_e,{color:"green",children:[X," ",X===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(X,ee)=>n.jsx(Ke,{title:ee.description,children:n.jsxs(Me.Text,{type:"secondary",children:[n.jsx(Gt,{style:{marginRight:5}}),"1 ",ee.quantity>1?`set of ${ee.quantity}`:"unit"," per ",X," sqm"]})})},{title:"Status",key:"status",width:100,align:"right",render:()=>n.jsx(Me.Text,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:n.jsx(Me.Text,{children:"No basic amenities qualify based on the selected stall area."})}}):n.jsx(Me.Text,{type:"secondary",children:"No basic amenities have been configured for this exhibition."})]}),n.jsxs(Q,{span:24,children:[n.jsx(it,{style:{margin:"12px 0 24px"}}),n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Me.Title,{level:5,style:{margin:0},children:n.jsxs(ue,{children:[n.jsx("span",{children:"Additional Amenities"}),n.jsx(_e,{color:"blue",children:"Optional"})]})}),n.jsx(Me.Text,{type:"secondary",children:"Select any additional amenities for the booking."})]}),(we=h==null?void 0:h.amenities)!=null&&we.length?n.jsxs(n.Fragment,{children:[n.jsx(W.Item,{name:"extraAmenities",label:"Select Additional Amenities",children:n.jsx(Le,{mode:"multiple",placeholder:"Select amenities",style:{width:"100%"},onChange:R,optionLabelProp:"label",options:h.amenities.map(X=>({label:`${X.name} (${X.rate?`${X.rate.toLocaleString()}`:"N/A"})`,value:X._id||X.id,key:X._id||X.id}))})}),g.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Me.Text,{strong:!0,children:"Selected Amenities:"}),n.jsx(st,{dataSource:B(),columns:[{title:"Name",dataIndex:"name",key:"name",render:(X,ee)=>n.jsxs(ue,{align:"center",children:[n.jsx(Me.Text,{strong:!0,children:X}),n.jsx(_e,{color:"blue",children:ee.type}),n.jsx(Me.Text,{type:"secondary",style:{fontSize:"13px"},children:ee.description||""})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:X=>n.jsxs(Me.Text,{strong:!0,style:{color:"#1890ff"},children:["",X.toLocaleString("en-IN")]})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(X,ee)=>n.jsx(jt,{min:1,value:m[ee.id]||1,onChange:ce=>K(ee.id,ce||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,align:"right",render:(X,ee)=>{const ce=m[ee.id]||1,xe=ee.rate*ce;return n.jsxs(Me.Text,{strong:!0,style:{color:"#1890ff"},children:["",xe.toLocaleString("en-IN")]})}}],pagination:!1,size:"small"})]})]}):n.jsx(Me.Text,{type:"secondary",children:"No additional amenities have been configured for this exhibition."})]})]})})}),n.jsx(Q,{span:24,children:n.jsxs(de,{title:"Price Calculations",size:"small",children:[n.jsx(Ne,{gutter:[16,16],children:n.jsx(Q,{span:12,children:n.jsx(W.Item,{name:"discountId",label:"Available Discounts",children:n.jsx(Le,{placeholder:"Select discount",allowClear:!0,onChange:P,options:(ye=h==null?void 0:h.discountConfig)==null?void 0:ye.map(X=>({label:`${X.name} (${X.type==="percentage"?X.value+"%":""+X.value})${X.isActive?"":" - Inactive"}`,value:`${X.name}-${X.value}-${X.type}`,disabled:!X.isActive}))})})})}),n.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:n.jsx(ue,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:X,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:xe,taxes:Z,totalAmount:ge}=H();return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(tn,{children:"Total Base Amount:"}),n.jsxs(tn,{children:["",X.toLocaleString()]})]}),ee&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(tn,{children:["Discount (",ee.type==="percentage"?`${ee.value}%`:`${ee.value.toLocaleString()}`,"):"]}),n.jsxs(tn,{type:"danger",children:["-",ce.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(tn,{children:"Amount after Discount:"}),n.jsxs(tn,{children:["",xe.toLocaleString()]})]}),n.jsx(it,{style:{margin:"8px 0"}}),Z.map(be=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(tn,{children:[be.name," (",be.rate,"%):"]}),n.jsxs(tn,{children:["",be.amount.toLocaleString()]})]},`tax-${be.name}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(tn,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(tn,{strong:!0,children:["",ge.toLocaleString()]})]})]})})()})})]})})]}),n.jsx(Q,{span:24,children:n.jsx(W.Item,{children:n.jsxs(ue,{children:[n.jsx(re,{type:"primary",htmlType:"submit",loading:j,children:"Create Booking"}),n.jsx(re,{onClick:()=>k("/bookings"),children:"Cancel"})]})})})]})})})})]}),n.jsx(Ye,{title:n.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:r,onCancel:()=>{s(!1),t.resetFields()},width:800,footer:n.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[n.jsx(re,{onClick:()=>{s(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),n.jsx(re,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:n.jsx(W,{form:t,layout:"vertical",onFinish:J,requiredMark:!1,children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),n.jsx(W.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(he.TextArea,{rows:3})}),n.jsx(W.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"status",label:"Status",initialValue:"active",children:n.jsxs(Le,{children:[n.jsx(Le.Option,{value:"active",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),n.jsx(Le.Option,{value:"inactive",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),n.jsx(W.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(he,{placeholder:"ABCDE1234F"})}),n.jsx(W.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(he,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})},f4=()=>{const{id:e}=Dr(),t=tt(),{data:r,isLoading:s}=lb(e||""),[i,a]=_.useState(!1),[o,l]=_.useState(!1),[d]=W.useForm(),[c,h]=_.useState(0),[f,u]=_.useState(!1),p=async()=>{if(e)try{u(!0),h(0),Se.loading({content:"Preparing invoice...",key:"download"});const m=await Ac(`/invoices/${e}/download?force=false`,!1,T=>{const y=T.total,w=T.loaded;if(y){const k=Math.round(w*100/y);h(k),k%25===0&&Se.loading({content:`Downloading: ${k}% complete`,key:"download"})}}),v=window.URL.createObjectURL(new Blob([m.data])),S=document.createElement("a");S.href=v,S.setAttribute("download",`invoice-${e}.pdf`),document.body.appendChild(S),S.click(),S.remove(),window.URL.revokeObjectURL(v),Se.success({content:"Invoice downloaded successfully",key:"download"})}catch(m){console.error("Download error:",m),Se.error({content:"Failed to download invoice",key:"download"})}finally{u(!1),h(0)}},g=async m=>{try{await ke.post(`/invoices/${e}/share/email`,m),Se.success("Invoice shared via email successfully"),a(!1),d.resetFields()}catch(v){console.error("Email sharing error:",v),Se.error("Failed to share invoice via email")}},x=async m=>{try{await ke.post(`/invoices/${e}/share/whatsapp`,m),Se.success("Invoice shared via WhatsApp successfully"),l(!1),d.resetFields()}catch(v){console.error("WhatsApp sharing error:",v),Se.error("Failed to share invoice via WhatsApp")}};return s||!r?n.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",r),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(de,{title:"Invoice Details",extra:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(re,{icon:n.jsx(Gn,{}),onClick:()=>t(-1),disabled:f,children:"Back"}),n.jsx(re,{type:"primary",icon:n.jsx(Yi,{}),onClick:p,loading:f&&c<100,disabled:f&&c>=100,children:"Download"}),n.jsx(re,{icon:n.jsx(fn,{}),onClick:()=>a(!0),disabled:f,children:"Share via Email"}),n.jsx(re,{icon:n.jsx(ju,{}),onClick:()=>l(!0),disabled:f,children:"Share via WhatsApp"})]}),f&&n.jsx(Qr,{percent:c,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:n.jsx(ff,{booking:{...r.bookingId,customerGSTIN:r.bookingId.customerGSTIN||"",invoiceNumber:r.invoiceNumber,exhibitionId:{...r.bookingId.exhibitionId,companyName:r.bookingId.exhibitionId.companyName||"Company Name",bankName:r.bookingId.exhibitionId.bankName||"",bankAccount:r.bookingId.exhibitionId.bankAccount||"",bankAccountName:r.bookingId.exhibitionId.bankAccountName||"",bankBranch:r.bookingId.exhibitionId.bankBranch||"",bankIFSC:r.bookingId.exhibitionId.bankIFSC||"",companyCIN:r.bookingId.exhibitionId.companyCIN||"",companyPAN:r.bookingId.exhibitionId.companyPAN||"",companySAC:r.bookingId.exhibitionId.companySAC||"",companyGST:r.bookingId.exhibitionId.companyGST||"",companyEmail:r.bookingId.exhibitionId.companyEmail||"",companyWebsite:r.bookingId.exhibitionId.companyWebsite||"",companyAddress:r.bookingId.exhibitionId.companyAddress||"",headerLogo:r.bookingId.exhibitionId.headerLogo||void 0},calculations:{...r.bookingId.calculations,stalls:r.bookingId.calculations.stalls.map(m=>({discount:m.discount?{...m.discount,type:m.discount.type||"percentage",value:m.discount.value}:void 0}))}}})}),n.jsx(Ye,{title:"Share Invoice via Email",open:i,onCancel:()=>a(!1),footer:null,children:n.jsxs(W,{form:d,onFinish:g,layout:"vertical",children:[n.jsx(W.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(he,{placeholder:"Enter email address"})}),n.jsx(W.Item,{name:"message",label:"Message (Optional)",children:n.jsx(he.TextArea,{placeholder:"Enter optional message"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ye,{title:"Share Invoice via WhatsApp",open:o,onCancel:()=>l(!1),footer:null,children:n.jsxs(W,{form:d,onFinish:x,layout:"vertical",children:[n.jsx(W.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:n.jsx(he,{placeholder:"Enter phone number with country code"})}),n.jsx(W.Item,{children:n.jsx(re,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:x4,Text:Ns}=Me,{Option:Oa}=Le,{RangePicker:p4}=Qs,m4=()=>{var X;const e=tt(),t=lt(),[r,s]=_.useState(1),[i,a]=_.useState(10),[o,l]=_.useState(""),[d,c]=_.useState(null),[h,f]=_.useState(null),[u,p]=_.useState(null),[g,x]=_.useState(!1),[m,v]=_.useState(null),[S,T]=_.useState(""),[y,w]=_.useState(""),[k,b]=_.useState("createdAt"),[j,A]=_.useState("descend"),[E,C]=Se.useMessage(),[I,F]=_.useState(null),[N,U]=_.useState(0),{exhibitions:M,loading:L}=qe(ee=>ee.exhibition);_.useEffect(()=>{t(Mr())},[t]);const{data:z,isLoading:J,refetch:ne}=Vo({page:r,limit:i}),[te,{isLoading:P}]=cb(),H=xt.useMemo(()=>z!=null&&z.data?z.data.filter(ee=>{const ce=o.toLowerCase(),xe=o===""||ee.invoiceNumber&&ee.invoiceNumber.toLowerCase().includes(ce)||ee._id.toLowerCase().includes(ce)||ee.bookingId.customerName&&ee.bookingId.customerName.toLowerCase().includes(ce)||ee.bookingId.companyName&&ee.bookingId.companyName.toLowerCase().includes(ce),Z=!d||ee.status===d,ge=!h||ee.bookingId.exhibitionId&&ee.bookingId.exhibitionId._id===h;let be=!0;if(u&&u[0]&&u[1]){const ve=nt(ee.createdAt);be=ve.isAfter(u[0])&&ve.isBefore(u[1])}return xe&&Z&&ge&&be}):[],[z,o,d,h,u]),B=async ee=>{try{F(ee),U(0),E.loading({content:"Preparing invoice...",key:ee});const ce=await Ac(`/invoices/${ee}/download?force=false`,!1,ge=>{const be=ge.total,ve=ge.loaded;if(be){const Fe=Math.round(ve*100/be);U(Fe),Fe%25===0&&E.loading({content:`Downloading: ${Fe}% complete`,key:ee})}}),xe=window.URL.createObjectURL(new Blob([ce.data])),Z=document.createElement("a");Z.href=xe,Z.setAttribute("download",`invoice-${ee}.pdf`),document.body.appendChild(Z),Z.click(),Z.remove(),window.URL.revokeObjectURL(xe),E.success({content:"Invoice downloaded successfully",key:ee})}catch(ce){console.error("Download error:",ce),E.error({content:"Failed to download invoice",key:ee})}finally{F(null),U(0)}},R=async()=>{if(!(!m||!S))try{E.loading({content:"Sending email...",key:"email"}),await te({id:m,email:S,message:y||void 0}).unwrap(),E.success({content:"Invoice sent via email successfully",key:"email"}),x(!1),T(""),w(""),v(null)}catch(ee){console.error("Email error:",ee),E.error({content:"Failed to send invoice via email",key:"email"})}},K=ee=>{v(ee),x(!0)},se=()=>{l(""),c(null),f(null),p(null)},we=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:k==="invoiceNumber"?j:null,render:(ee,ce)=>n.jsx("a",{onClick:()=>e(`/invoice/${ce._id}`),children:ee||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:k==="companyName"?j:null,render:ee=>ee||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:k==="exhibitionName"?j:null,render:(ee,ce)=>n.jsx("a",{onClick:()=>e(`/exhibition/${ce.bookingId.exhibitionId._id}`),children:ee})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:k==="amount"?j:null,render:ee=>`${ee.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:k==="status"?j:null,render:ee=>n.jsx(_e,{color:ee==="paid"?"green":ee==="pending"?"gold":ee==="cancelled"?"red":"blue",children:ee.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:k==="dueDate"?j:null,render:ee=>ee?nt(ee).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:k==="createdAt"?j:null,render:ee=>nt(ee).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(ee,ce)=>n.jsxs(ue,{direction:"vertical",size:"small",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(Ke,{title:"View Invoice",children:n.jsx(re,{type:"text",icon:n.jsx(hn,{}),onClick:()=>e(`/invoice/${ce._id}`)})}),n.jsx(Ke,{title:"Download",children:n.jsx(re,{type:"text",icon:n.jsx(Yi,{}),onClick:()=>B(ce._id),loading:I===ce._id&&N<100,disabled:I!==null&&I!==ce._id})}),n.jsx(Ke,{title:"Email",children:n.jsx(re,{type:"text",icon:n.jsx(fn,{}),onClick:()=>K(ce._id),disabled:I!==null})})]}),I===ce._id&&n.jsx(Qr,{percent:N,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],ye=(ee,ce,xe)=>{xe&&xe.field&&(b(xe.field),A(xe.order||"descend"))};return n.jsxs(Zt,{children:[C,n.jsxs("div",{className:"invoice-list-container",children:[n.jsx(de,{children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},size:"large",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(x4,{level:2,style:{margin:0},children:"Invoices"}),n.jsx(ue,{children:n.jsx(Ke,{title:"Refresh",children:n.jsx(re,{icon:n.jsx(Ks,{}),onClick:()=>ne(),loading:J})})})]}),n.jsx(de,{size:"small",title:n.jsxs(ue,{children:[n.jsx(Ki,{})," Filters"]}),children:n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[n.jsxs("div",{style:{minWidth:"200px",flex:1},children:[n.jsx(Ns,{strong:!0,children:"Search"}),n.jsx(he,{placeholder:"Search by invoice #, company...",value:o,onChange:ee=>l(ee.target.value),prefix:n.jsx(An,{}),allowClear:!0})]}),n.jsxs("div",{style:{minWidth:"150px"},children:[n.jsx(Ns,{strong:!0,children:"Status"}),n.jsxs(Le,{style:{width:"100%"},placeholder:"Filter by status",value:d,onChange:c,allowClear:!0,children:[n.jsx(Oa,{value:"pending",children:"Pending"}),n.jsx(Oa,{value:"paid",children:"Paid"}),n.jsx(Oa,{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{style:{minWidth:"200px"},children:[n.jsx(Ns,{strong:!0,children:"Exhibition"}),n.jsx(Le,{style:{width:"100%"},placeholder:"Filter by exhibition",value:h,onChange:f,loading:L,allowClear:!0,children:M.map(ee=>n.jsx(Oa,{value:ee._id||ee.id,children:ee.name},ee._id||ee.id))})]}),n.jsxs("div",{style:{minWidth:"300px"},children:[n.jsx(Ns,{strong:!0,children:"Date Range"}),n.jsx(p4,{style:{width:"100%"},value:u,onChange:p})]}),n.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:n.jsx(re,{icon:n.jsx(Kx,{}),onClick:se,children:"Clear Filters"})})]})}),n.jsx(st,{columns:we,dataSource:H,rowKey:"_id",loading:J,pagination:{current:r,pageSize:i,total:((X=z==null?void 0:z.pagination)==null?void 0:X.total)||0,onChange:(ee,ce)=>{s(ee),ce&&a(ce)},showSizeChanger:!0,showTotal:ee=>`Total ${ee} invoices`},onChange:ye})]})}),n.jsxs(Ye,{title:"Send Invoice via Email",open:g,onCancel:()=>x(!1),onOk:R,okText:"Send",confirmLoading:P,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Ns,{strong:!0,children:"Email Address"}),n.jsx(he,{placeholder:"Enter recipient email",value:S,onChange:ee=>T(ee.target.value),style:{width:"100%"}})]}),n.jsxs("div",{children:[n.jsx(Ns,{strong:!0,children:"Message (Optional)"}),n.jsx(he.TextArea,{placeholder:"Enter optional message",value:y,onChange:ee=>w(ee.target.value),rows:4})]})]})]})]})},{Title:qt,Paragraph:zt,Text:Ba}=Me,{Content:g4}=Nt,y4=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;return t.includes("logos/")||t.includes("sponsors/")?`${ke.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},v4=Ee(g4)`
  padding-top: 64px;
`,b4=Ee.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,w4=Ee.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,j4=Ee.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Fs=Ee(de)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,S4=Ee(de)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,pi=Ee(qt)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Rs=Ee.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,Ma=Ee.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,uu=Ee.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,E4=Ee(_e)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,fu=Ee(re)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,mi=Ee.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;Ee.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const T4=()=>{const e=tt(),t=lt(),[r,s]=_.useState([]),[i,a]=_.useState(!0);_.useEffect(()=>{(async()=>{try{a(!0);const h=await Fr.getExhibitions();s(h.data.slice(0,4))}catch(h){console.error("Failed to fetch exhibitions:",h)}finally{a(!1)}})()},[]);const o=c=>{const h={year:"numeric",month:"short",day:"numeric"};return new Date(c).toLocaleDateString(void 0,h)},l=(c,h)=>{const f=new Date,u=new Date(c),p=new Date(h);return f<u?{status:"Upcoming",color:"#722ED1"}:f>p?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},d=()=>{t(cs(void 0))};return n.jsxs(Nt,{children:[n.jsx(Kr,{}),n.jsxs(v4,{children:[n.jsxs(b4,{children:[n.jsx(w4,{}),n.jsx(j4,{children:n.jsxs(Ne,{gutter:[48,48],align:"middle",children:[n.jsxs(Q,{xs:24,lg:14,children:[n.jsx(qt,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),n.jsx(zt,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),n.jsx(ue,{size:16,wrap:!0,children:n.jsx(fu,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(ec,{}),children:"Explore Exhibitions"})})]}),n.jsx(Q,{xs:24,lg:10,children:n.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:c=>{const h=c.target;h.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",h.onerror=()=>{h.style.height="300px",h.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",h.onerror=null;const f=h.parentElement;if(f){const u=document.createElement("div");u.style.position="absolute",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)",u.style.color="white",u.style.fontSize="18px",u.style.fontWeight="bold",u.style.textAlign="center",u.textContent="Exhibition Venue",f.appendChild(u)}}}})})]})})]}),n.jsx(mi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(pi,{level:2,children:"Featured Exhibitions"}),i?n.jsx(Ne,{gutter:[24,24],children:[1,2,3,4].map(c=>n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsx(de,{style:{borderRadius:"12px"},children:n.jsx(ln,{active:!0,avatar:!0,paragraph:{rows:3}})})},c))}):r.length>0?n.jsx(Ne,{gutter:[24,24],children:r.map((c,h)=>{const{status:f,color:u}=l(c.startDate,c.endDate);return n.jsx(Q,{xs:24,sm:12,lg:6,children:n.jsxs(S4,{onClick:()=>e(Ho(c)),cover:n.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[n.jsx("img",{alt:c.name,src:c.headerLogo?y4(c.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0.95)"}}),n.jsx(_e,{color:u,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:f}),h===0&&n.jsx(E4,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[n.jsx(qt,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:c.name}),n.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[n.jsx(Yr,{style:{color:"#4158D0"}}),n.jsxs(Ba,{type:"secondary",style:{fontSize:13},children:[o(c.startDate)," - ",o(c.endDate)]})]}),c.venue&&n.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(os,{style:{color:"#C850C0"}}),n.jsx(Ba,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:c.venue})]}),n.jsx(re,{type:"link",style:{padding:0,height:"auto"},icon:n.jsx(ec,{}),children:"View Details"})]})},c._id)})}):n.jsx("div",{style:{textAlign:"center",padding:40},children:n.jsx(zt,{children:"No exhibitions available at the moment. Check back soon!"})}),n.jsx("div",{style:{textAlign:"center",marginTop:40},children:n.jsx(re,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Xx,{}),children:"View All Exhibitions"})})]})}),n.jsx(mi,{className:"how-it-works",children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(pi,{level:2,children:"How to Book Stall"}),n.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:n.jsx(zt,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),n.jsxs("div",{className:"booking-steps",children:[n.jsx("div",{className:"step-indicator",children:n.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(c=>n.jsxs("div",{className:"step-dot-container",children:[n.jsx("div",{className:"step-dot",children:c}),n.jsx("div",{className:"step-label",children:`Step ${c}`})]},c)),n.jsx("div",{className:"step-progress-line"})]})}),n.jsxs(Ne,{gutter:[24,24],style:{marginTop:40},children:[n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx(ht,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Register"}),n.jsx(zt,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx(St,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Admin Approval"}),n.jsx(zt,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx(wr,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Login & Book Stall"}),n.jsx(zt,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"4"}),n.jsx("div",{className:"step-icon",children:n.jsx(Qt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Stall Goes to Reserved"}),n.jsx(zt,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"5"}),n.jsx("div",{className:"step-icon",children:n.jsx(St,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Admin Final Approval"}),n.jsx(zt,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"6"}),n.jsx("div",{className:"step-icon",children:n.jsx(St,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Stall Becomes Booked"}),n.jsx(zt,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),n.jsx(Q,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"7"}),n.jsx("div",{className:"step-icon",children:n.jsx(vd,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(qt,{level:5,children:"Make Payment in 3 Days"}),n.jsx(zt,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),n.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),n.jsx("div",{style:{textAlign:"center",marginTop:60},children:n.jsx(fu,{type:"primary",size:"large",onClick:d,icon:n.jsx(ht,{}),children:"Register as Exhibitor"})})]})}),n.jsx(mi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(pi,{level:2,children:"Why Choose Us"}),n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:n.jsx(xs,{})}),n.jsx(qt,{level:4,children:"Interactive Layouts"}),n.jsx(zt,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:n.jsx(wr,{})}),n.jsx(qt,{level:4,children:"Real-time Availability"}),n.jsx(zt,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:n.jsx(vd,{})}),n.jsx(qt,{level:4,children:"Secure Payments"}),n.jsx(zt,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:n.jsx(bc,{})}),n.jsx(qt,{level:4,children:"Exhibitor Dashboard"}),n.jsx(zt,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:n.jsx(Yr,{})}),n.jsx(qt,{level:4,children:"Schedule Management"}),n.jsx(zt,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),n.jsx(Q,{xs:24,sm:12,lg:8,children:n.jsxs(Fs,{children:[n.jsx(Rs,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:n.jsx(St,{})}),n.jsx(qt,{level:4,children:"Support & Assistance"}),n.jsx(zt,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),n.jsx(mi,{className:"gray-bg",children:n.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:n.jsxs(Ne,{gutter:[48,48],children:[n.jsxs(Q,{xs:24,lg:12,children:[n.jsx(pi,{level:2,children:"Our Impact"}),n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:12,children:n.jsx(Ma,{children:n.jsx(Ze,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Ma,{children:n.jsx(Ze,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Ma,{children:n.jsx(Ze,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),n.jsx(Q,{xs:12,children:n.jsx(Ma,{children:n.jsx(Ze,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),n.jsxs(Q,{xs:24,lg:12,children:[n.jsx(pi,{level:2,children:"What Exhibitors Say"}),n.jsxs(Qx,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[n.jsx("div",{children:n.jsxs(uu,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Ur,{size:64,icon:n.jsx(ht,{}),style:{backgroundColor:"#4158D0"}}),n.jsxs("div",{children:[n.jsx(qt,{level:5,style:{margin:0},children:"Sarah Johnson"}),n.jsx(Ba,{type:"secondary",children:"Tech Innovations Inc."})]})]}),n.jsx(zt,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),n.jsx("div",{children:n.jsxs(uu,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Ur,{size:64,icon:n.jsx(ht,{}),style:{backgroundColor:"#C850C0"}}),n.jsxs("div",{children:[n.jsx(qt,{level:5,style:{margin:0},children:"Michael Chen"}),n.jsx(Ba,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),n.jsx(zt,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),n.jsx(mi,{style:{padding:"60px 0"},children:n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[n.jsx(qt,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),n.jsx(zt,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),n.jsxs(ue,{size:16,wrap:!0,style:{justifyContent:"center"},children:[n.jsx(re,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>e("/exhibitions"),icon:n.jsx(wr,{}),children:"Browse Exhibitions"}),n.jsx(re,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:d,icon:n.jsx(ht,{}),children:"Register as Exhibitor"})]})]})})]}),n.jsx(bf,{})]})},{Title:_4,Text:rt,Paragraph:k4}=Me,{Option:$a}=Le,{TextArea:xu,Search:C4}=he,{RangePicker:A4}=Qs,I4=()=>{const e=lt(),{exhibitors:t,loading:r}=qe(R=>R.exhibitor),[s,i]=_.useState(null),[a,o]=_.useState(!1),[l,d]=_.useState(!1),[c,h]=_.useState(!1),[f,u]=_.useState("approved"),[p,g]=_.useState(""),[x,m]=_.useState(!1),[v,S]=_.useState(!1),[T,y]=_.useState(!1),[w,k]=_.useState(""),[b,j]=_.useState([]),[A]=W.useForm(),[E,C]=_.useState([]);E.length>0;const[I,F]=_.useState({total:0,pending:0,approved:0,rejected:0});_.useEffect(()=>{e(cn())},[e]),_.useEffect(()=>{if(t!=null&&t.length){j(t);const R={total:t.length,pending:t.filter(K=>K.status==="pending").length,approved:t.filter(K=>K.status==="approved").length,rejected:t.filter(K=>K.status==="rejected").length};F(R)}},[t]),_.useEffect(()=>{s&&l&&A.setFieldsValue({companyName:s.companyName,contactPerson:s.contactPerson,email:s.email,phone:s.phone,address:s.address||"",website:s.website||"",description:s.description||"",isActive:s.isActive})},[s,l,A]);const N=R=>{switch(R){case"approved":return n.jsx(_e,{color:"success",children:"Approved"});case"pending":return n.jsx(_e,{color:"warning",children:"Pending"});case"rejected":return n.jsx(_e,{color:"error",children:"Rejected"});default:return n.jsx(_e,{children:"Unknown"})}},U=async()=>{var R,K;if(s)try{m(!0),await dr.updateStatus(s._id,f,f==="rejected"?p:void 0),Se.success(`Exhibitor status updated to ${f}`),o(!1),e(cn())}catch(se){Se.error(((K=(R=se.response)==null?void 0:R.data)==null?void 0:K.message)||"Failed to update exhibitor status")}finally{m(!1)}},M=async R=>{var K,se;if(s)try{S(!0),await dr.updateExhibitor(s._id,R),Se.success("Exhibitor details updated successfully"),d(!1),e(cn())}catch(we){Se.error(((se=(K=we.response)==null?void 0:K.data)==null?void 0:se.message)||"Failed to update exhibitor details")}finally{S(!1)}},L=async R=>{var K,se;try{y(!0),await dr.deleteExhibitor(R),Se.success("Exhibitor deleted successfully"),e(cn())}catch(we){Se.error(((se=(K=we.response)==null?void 0:K.data)==null?void 0:se.message)||"Failed to delete exhibitor")}finally{y(!1)}},z=R=>{if(k(R),!R){j(t);return}const K=R.toLowerCase(),se=t.filter(we=>we.companyName.toLowerCase().includes(K)||we.contactPerson.toLowerCase().includes(K)||we.email.toLowerCase().includes(K)||we.phone.toLowerCase().includes(K));j(se)},J=R=>{if(R==="all"){j(t);return}const K=t.filter(se=>se.status===R);j(K)},ne=R=>{if(!R||R.length!==2){j(t);return}const K=R[0].startOf("day").toISOString(),se=R[1].endOf("day").toISOString(),we=t.filter(ye=>{const X=new Date(ye.createdAt).toISOString();return X>=K&&X<=se});j(we)},te=()=>{const R=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],K=b.map(ee=>[ee.companyName,ee.contactPerson,ee.email,ee.phone,ee.status,ee.isActive?"Yes":"No",new Date(ee.createdAt).toLocaleDateString(),ee.address||"",ee.website||""]);K.unshift(R);const se=K.map(ee=>ee.map(ce=>typeof ce=="string"&&(ce.includes(",")||ce.includes('"')||ce.includes(`
`))?`"${ce.replace(/"/g,'""')}"`:ce).join(",")).join(`
`),we=new Blob([se],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(we),X=document.createElement("a");X.setAttribute("href",ye),X.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),X.style.visibility="hidden",document.body.appendChild(X),X.click(),document.body.removeChild(X),Se.success("Exhibitor data exported successfully")},P=()=>{Ye.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${E.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{y(!0);const R=E.map(K=>dr.deleteExhibitor(K.toString()));await Promise.all(R),Se.success(`${E.length} exhibitors deleted successfully`),C([]),e(cn())}catch{Se.error("Failed to delete some exhibitors")}finally{y(!1)}}})},H={selectedRowKeys:E,onChange:R=>{C(R)}},B=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(R,K)=>R.companyName.localeCompare(K.companyName),filterDropdown:({setSelectedKeys:R,selectedKeys:K,confirm:se,clearFilters:we})=>n.jsxs("div",{style:{padding:8},children:[n.jsx(he,{placeholder:"Search company or contact",value:K[0],onChange:ye=>R(ye.target.value?[ye.target.value]:[]),onPressEnter:()=>se(),style:{width:188,marginBottom:8,display:"block"}}),n.jsxs(ue,{children:[n.jsx(re,{type:"primary",onClick:()=>se(),icon:n.jsx(An,{}),size:"small",style:{width:90},children:"Filter"}),n.jsx(re,{onClick:()=>{we&&we(),se()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:R=>n.jsx(An,{style:{color:R?"#1890ff":void 0}}),onFilter:(R,K)=>{const se=String(R).toLowerCase();return K.companyName.toLowerCase().includes(se)||K.contactPerson.toLowerCase().includes(se)},render:(R,K)=>n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:"bold"},children:R}),n.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",K.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(R,K)=>n.jsxs("div",{children:[n.jsx("div",{children:R}),n.jsx("div",{style:{fontSize:"12px"},children:K.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(R,K)=>K.status===R,render:R=>N(R)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(R,K)=>K.isActive===R,render:R=>n.jsx(_e,{color:R?"green":"red",children:R?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(R,K)=>new Date(R.createdAt).getTime()-new Date(K.createdAt).getTime(),render:R=>n.jsx(Ke,{title:new Date(R).toLocaleString(),children:new Date(R).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:R=>R?n.jsx("a",{href:R,target:"_blank",rel:"noopener noreferrer",children:R.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(R,K)=>n.jsxs(ue,{children:[n.jsx(Ke,{title:"View Details",children:n.jsx(re,{icon:n.jsx(hn,{}),onClick:()=>{i(K),h(!0)}})}),n.jsx(re,{type:"primary",onClick:()=>{i(K),u(K.status),g(K.rejectionReason||""),o(!0)},children:"Update Status"}),n.jsx(Vn,{overlay:n.jsxs(hr,{children:[n.jsx(hr.Item,{icon:n.jsx(as,{}),onClick:()=>{i(K),d(!0)},children:"Edit"},"edit"),n.jsx(hr.Item,{icon:n.jsx(sr,{}),danger:!0,onClick:se=>{se.domEvent.stopPropagation(),Ye.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>L(K._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(re,{icon:n.jsx(Ec,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ne,{gutter:[24,24],align:"middle",children:[n.jsx(Q,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(_4,{level:4,style:{margin:0},children:"Exhibitors"}),n.jsx(rt,{type:"secondary",children:"Manage exhibitors and their information"})]})}),n.jsx(Q,{children:n.jsx(re,{type:"primary",icon:n.jsx(Fi,{}),onClick:()=>d(!0),size:"large",children:"Add Exhibitor"})})]})}),n.jsxs(Ne,{gutter:[16,24],style:{marginBottom:"24px"},children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Total Exhibitors",value:I.total,prefix:n.jsx(ht,{})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Pending",value:I.pending,prefix:n.jsx(Qt,{style:{color:"#faad14"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Approved",value:I.approved,prefix:n.jsx(St,{style:{color:"#52c41a"}})})})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Ze,{title:"Rejected",value:I.rejected,prefix:n.jsx(Zr,{style:{color:"#ff4d4f"}})})})})]}),n.jsx(de,{className:"info-card",style:{marginBottom:"24px"},children:n.jsxs(ue,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ne,{gutter:[16,16],align:"middle",children:[n.jsx(Q,{xs:24,sm:8,md:6,lg:4,children:n.jsx(C4,{placeholder:"Search exhibitors",allowClear:!0,onSearch:z,style:{width:"100%"}})}),n.jsx(Q,{xs:24,sm:8,md:6,lg:4,children:n.jsxs(Le,{placeholder:"Filter by status",style:{width:"100%"},onChange:J,allowClear:!0,children:[n.jsx($a,{value:"all",children:"All Status"}),n.jsx($a,{value:"pending",children:"Pending"}),n.jsx($a,{value:"approved",children:"Approved"}),n.jsx($a,{value:"rejected",children:"Rejected"})]})}),n.jsx(Q,{xs:24,sm:8,md:6,lg:6,children:n.jsx(A4,{style:{width:"100%"},onChange:ne})})]}),E.length>0&&n.jsx(Ne,{children:n.jsxs(ue,{children:[n.jsxs(rt,{children:["Selected ",E.length," items"]}),n.jsx(re,{danger:!0,onClick:P,children:"Delete Selected"}),n.jsx(re,{type:"primary",onClick:te,children:"Export Selected"})]})})]})}),n.jsx(de,{className:"info-card",children:n.jsx(st,{rowSelection:H,dataSource:b,columns:B,rowKey:"_id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(R,K)=>`${K[0]}-${K[1]} of ${R} items`},scroll:{x:1500}})}),n.jsx(Ye,{title:"Exhibitor Details",open:c,onCancel:()=>h(!1),footer:[n.jsx(re,{onClick:()=>h(!1),children:"Close"},"close")],width:600,children:s&&n.jsx("div",{children:n.jsxs(Ne,{gutter:[16,16],children:[n.jsx(Q,{span:24,children:n.jsx(de,{title:"Company Information",children:n.jsxs(Ne,{gutter:[16,8],children:[n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Company Name:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.companyName})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Contact Person:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.contactPerson})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Email:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.email})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Phone:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.phone})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.address||"Not provided"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Status:"})}),n.jsx(Q,{span:12,children:N(s.status)}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Active:"})}),n.jsx(Q,{span:12,children:n.jsx(gr,{status:s.isActive?"success":"error",text:s.isActive?"Yes":"No"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Registration Date:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:new Date(s.createdAt).toLocaleString()})})]})})}),n.jsx(Q,{span:24,children:n.jsxs(de,{title:"Additional Information",children:[n.jsxs(Ne,{gutter:[16,8],children:[n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{children:s.address||"Not provided"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Website:"})}),n.jsx(Q,{span:12,children:s.website?n.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",children:s.website}):"Not provided"}),s.status==="rejected"&&n.jsxs(n.Fragment,{children:[n.jsx(Q,{span:12,children:n.jsx(rt,{strong:!0,children:"Rejection Reason:"})}),n.jsx(Q,{span:12,children:n.jsx(rt,{type:"danger",children:s.rejectionReason||"No reason provided"})})]})]}),s.description&&n.jsxs(n.Fragment,{children:[n.jsx(it,{}),n.jsx(rt,{strong:!0,children:"Description:"}),n.jsx(k4,{style:{marginTop:8},children:s.description})]})]})})]})})}),n.jsx(Ye,{title:"Update Exhibitor Status",open:a,onCancel:()=>o(!1),footer:null,width:600,children:s&&n.jsxs("div",{children:[n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(ht,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:n.jsxs(Ne,{gutter:[16,8],children:[n.jsx(Q,{span:8,children:n.jsx(rt,{strong:!0,children:"Company:"})}),n.jsx(Q,{span:16,children:n.jsx(rt,{children:s.companyName})}),n.jsx(Q,{span:8,children:n.jsx(rt,{strong:!0,children:"Contact Person:"})}),n.jsx(Q,{span:16,children:n.jsx(rt,{children:s.contactPerson})}),n.jsx(Q,{span:8,children:n.jsx(rt,{strong:!0,children:"Email:"})}),n.jsx(Q,{span:16,children:n.jsx(rt,{children:s.email})}),n.jsx(Q,{span:8,children:n.jsx(rt,{strong:!0,children:"Address:"})}),n.jsx(Q,{span:16,children:n.jsx(rt,{children:s.address||"Not provided"})}),n.jsx(Q,{span:8,children:n.jsx(rt,{strong:!0,children:"Current Status:"})}),n.jsx(Q,{span:16,children:N(s.status)})]})}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Xs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(rt,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(vr.Group,{value:f,onChange:R=>u(R.target.value),buttonStyle:"solid",children:[n.jsx(vr.Button,{value:"pending",children:n.jsxs(ue,{children:[n.jsx(Qt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(vr.Button,{value:"approved",children:n.jsxs(ue,{children:[n.jsx(St,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(vr.Button,{value:"rejected",children:n.jsxs(ue,{children:[n.jsx(Zr,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),f==="rejected"&&n.jsx("div",{children:n.jsx(W.Item,{label:n.jsx(rt,{strong:!0,children:"Rejection Reason:"}),required:f==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:n.jsx(xu,{rows:4,value:p,onChange:R=>g(R.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),f==="approved"&&n.jsx(It,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),f==="pending"&&n.jsx(It,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(re,{onClick:()=>o(!1),children:"Cancel"}),n.jsx(re,{type:"primary",onClick:U,loading:x,disabled:f==="rejected"&&!p.trim(),children:"Update Status"})]})]})]})}),n.jsx(Ye,{title:"Edit Exhibitor Details",open:l,onCancel:()=>d(!1),footer:null,width:600,children:n.jsxs(W,{form:A,layout:"vertical",onFinish:M,children:[n.jsx(W.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:n.jsx(he,{})}),n.jsx(W.Item,{name:"address",label:"Address",children:n.jsx(he,{})}),n.jsx(W.Item,{name:"website",label:"Website",children:n.jsx(he,{})}),n.jsx(W.Item,{name:"description",label:"Description",children:n.jsx(xu,{rows:4})}),n.jsx(W.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Rr,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(W.Item,{children:n.jsxs(ue,{children:[n.jsx(re,{type:"primary",htmlType:"submit",loading:v,children:"Save Changes"}),n.jsx(re,{onClick:()=>d(!1),children:"Cancel"})]})})]})})]})},{Title:N4,Text:Ps}=Me,{Option:rn}=Le,{RangePicker:F4}=Qs,R4=({exhibitionId:e,exhibitions:t,exhibitionsLoading:r,onExhibitionChange:s,typeFilter:i,setTypeFilter:a,bookingStatusFilter:o,setBookingStatusFilter:l,searchQuery:d,setSearchQuery:c,dateRange:h,setDateRange:f,resetFilters:u})=>{var x,m;const p=v=>{c(v.target.value)},g=v=>{f(v)};return n.jsxs(de,{className:"amenities-filters",children:[n.jsx(N4,{level:5,className:"filter-heading",children:"Filters"}),n.jsxs(Ne,{gutter:[16,16],children:[n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ps,{className:"filter-label",children:"Exhibition"}),n.jsx(Le,{placeholder:"Select an exhibition",style:{width:"100%"},loading:r,onChange:s,value:e,children:t.map(v=>n.jsx(rn,{value:v._id,children:v.name},v._id))})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ps,{className:"filter-label",children:"Amenity Type"}),n.jsxs(Le,{mode:"multiple",placeholder:"Select types",style:{width:"100%"},value:i,onChange:a,maxTagCount:2,children:[n.jsx(rn,{value:"facility",children:"Facility"}),n.jsx(rn,{value:"service",children:"Service"}),n.jsx(rn,{value:"equipment",children:"Equipment"}),n.jsx(rn,{value:"other",children:"Other"})]})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ps,{className:"filter-label",children:"Booking Status"}),n.jsxs(Le,{mode:"multiple",placeholder:"Select statuses",style:{width:"100%"},value:o,onChange:l,maxTagCount:2,children:[n.jsx(rn,{value:"confirmed",children:"Confirmed"}),n.jsx(rn,{value:"approved",children:"Approved"}),n.jsx(rn,{value:"pending",children:"Pending"}),n.jsx(rn,{value:"rejected",children:"Rejected"}),n.jsx(rn,{value:"cancelled",children:"Cancelled"})]})]})}),n.jsx(Q,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ps,{className:"filter-label",children:"Search"}),n.jsx(he,{placeholder:"Search amenities",prefix:n.jsx(An,{}),value:d,onChange:p,allowClear:!0})]})}),n.jsx(Q,{xs:24,md:16,lg:12,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ps,{className:"filter-label",children:"Booking Date Range"}),n.jsx(F4,{style:{width:"100%"},onChange:g,value:h})]})}),n.jsx(Q,{xs:24,md:8,lg:12,children:n.jsx("div",{className:"filter-group",style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%"},children:n.jsxs(ue,{children:[n.jsx(re,{icon:n.jsx(Ks,{}),onClick:u,children:"Reset"}),n.jsx(re,{type:"primary",icon:n.jsx(Ki,{}),children:"Apply Filters"})]})})})]}),(i.length>0||o.length>0||d||h)&&n.jsxs(n.Fragment,{children:[n.jsx(it,{className:"filter-divider"}),n.jsxs("div",{children:[n.jsx(Ps,{className:"filter-label",children:"Active Filters:"}),n.jsxs("div",{style:{marginTop:8},children:[i.map(v=>n.jsxs(_e,{closable:!0,onClose:()=>a(i.filter(S=>S!==v)),className:`amenity-tag amenity-tag-${v}`,children:["Type: ",v]},`type-${v}`)),o.map(v=>n.jsxs(_e,{closable:!0,onClose:()=>l(o.filter(S=>S!==v)),color:"blue",children:["Status: ",v]},`status-${v}`)),d&&n.jsxs(_e,{closable:!0,onClose:()=>c(""),color:"purple",children:["Search: ",d]}),h&&n.jsxs(_e,{closable:!0,onClose:()=>f(null),color:"green",children:["Date Range: ",(x=h[0])==null?void 0:x.format("MMM DD, YYYY")," - ",(m=h[1])==null?void 0:m.format("MMM DD, YYYY")]})]})]})]})]})},{Text:yk}=Me,P4=({basicAmenities:e,extraAmenities:t,bookedStalls:r,calculatedAmenities:s})=>n.jsxs(Ne,{gutter:[24,24],children:[n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-primary",bordered:!1,children:[n.jsx(Lo,{style:{fontSize:24,color:"#1890ff"}}),n.jsx("div",{className:"stats-value",children:e.length}),n.jsx("div",{className:"stats-label",children:"Basic Amenities"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-secondary",bordered:!1,children:[n.jsx(ps,{style:{fontSize:24,color:"#52c41a"}}),n.jsx("div",{className:"stats-value",children:t.length}),n.jsx("div",{className:"stats-label",children:"Extra Amenities"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-tertiary",bordered:!1,children:[n.jsx(xo,{style:{fontSize:24,color:"#fa8c16"}}),n.jsx("div",{className:"stats-value",children:r}),n.jsx("div",{className:"stats-label",children:"Booked Stalls"})]})}),n.jsx(Q,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-quaternary",bordered:!1,children:[n.jsx(Jx,{style:{fontSize:24,color:"#722ed1"}}),n.jsx("div",{className:"stats-value",children:s}),n.jsx("div",{className:"stats-label",children:"Calculated Amenities"})]})})]}),{Text:Sn,Title:pu}=Me,mu=e=>{switch(e){case"facility":return{color:"#e6f7ff",borderColor:"#91d5ff",textColor:"#1890ff"};case"service":return{color:"#f6ffed",borderColor:"#b7eb8f",textColor:"#52c41a"};case"equipment":return{color:"#fff7e6",borderColor:"#ffd591",textColor:"#fa8c16"};default:return{color:"#f9f0ff",borderColor:"#d3adf7",textColor:"#722ed1"}}},Xl=({title:e,amenities:t,loading:r,onExport:s,isDynamicColumns:i=!1,isCalculated:a=!1,exhibitionId:o,amenityViewType:l="all"})=>{const[d,c]=_.useState([]),[h,f]=_.useState([]),[u,p]=_.useState(!1),g=_.useMemo(()=>!a||l==="all"?t:l==="basic"?t.filter(w=>w.hasOwnProperty("calculatedQuantity")||w.hasOwnProperty("perSqm")):l==="extra"?t.filter(w=>w.hasOwnProperty("rate")&&!w.hasOwnProperty("perSqm")):t,[t,a,l]);_.useEffect(()=>{if(!o){f([]),p(!1);return}p(!0),setTimeout(()=>{p(!1)},500)},[o]);const x=()=>{const w=new Map;return g.forEach(b=>{var j,A;if(b.stallId&&b.stallNumber){w.has(b.stallId)||w.set(b.stallId,{key:b.stallId,companyName:b.exhibitorName||"Unknown",stallNumber:b.stallNumber,dimension:b.dimensions?`${b.dimensions.width}x${b.dimensions.height}m`:"-",stallType:b.stallType||"-",area:b.area||((j=b.dimensions)!=null&&j.width&&((A=b.dimensions)!=null&&A.height)?b.dimensions.width*b.dimensions.height:"-"),bookingDate:b.bookingDate?new Date(b.bookingDate).toISOString().slice(0,10):"-",status:b.bookingStatus||"-",amenities:{}});const E=w.get(b.stallId);if(b.hasOwnProperty("calculatedQuantity"))E.amenities[b.name]=b.calculatedQuantity;else if(b.hasOwnProperty("perSqm")){const C=typeof E.area=="number"?E.area:0,I=Math.floor(C/b.perSqm)*b.quantity;E.amenities[b.name]=I>0?I:b.quantity}else if(b.hasOwnProperty("booked")&&b.booked){let C=1;typeof b.quantity=="number"?C=b.quantity:typeof b.quantity=="string"&&(C=parseInt(b.quantity,10),isNaN(C)&&(C=1)),E.amenities[b.name]=C}else b.hasOwnProperty("rate")&&(E.amenities[b.name]=0)}}),Array.from(w.values()).filter(b=>Object.keys(b.amenities).length>0)},m=()=>{const w=new Set;return g.forEach(k=>{const b=j=>a?!0:e.toLowerCase().includes("basic")?j.hasOwnProperty("perSqm"):e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra")?j.hasOwnProperty("rate"):!0;k.name&&b(k)&&w.add(k.name)}),Array.from(w)},v=()=>{const w=[{title:"Company Name",dataIndex:"companyName",key:"companyName",fixed:"left",width:180,render:A=>n.jsx(Sn,{strong:!0,children:A}),sorter:(A,E)=>A.companyName.localeCompare(E.companyName)},{title:"Stall No.",dataIndex:"stallNumber",key:"stallNumber",width:100,render:A=>n.jsx(gr,{status:"success",text:A}),sorter:(A,E)=>A.stallNumber.localeCompare(E.stallNumber)},{title:"Dimension",dataIndex:"dimension",key:"dimension",width:120},{title:"Stall Type",dataIndex:"stallType",key:"stallType",width:120},{title:"Area (SQM)",dataIndex:"area",key:"area",width:100,render:A=>typeof A=="number"?A.toFixed(2):A,sorter:(A,E)=>{const C=typeof A.area=="number"?A.area:0,I=typeof E.area=="number"?E.area:0;return C-I}}],b=m().map(A=>({title:A,dataIndex:["amenities",A],key:A,width:100,render:E=>E==null?"-":E===0?n.jsx(Sn,{type:"secondary",children:"0"}):E===""?n.jsx(gr,{status:"success"}):n.jsx(Sn,{strong:!0,children:E}),sorter:(E,C)=>{const I=E.amenities[A]||0,F=C.amenities[A]||0;return I-F}})),j={title:"Actions",key:"actions",width:80,fixed:"right",render:(A,E)=>n.jsx(Vn,{overlay:n.jsxs(hr,{children:[n.jsx(hr.Item,{icon:n.jsx(hn,{}),children:"View Details"},"view"),n.jsx(hr.Item,{icon:n.jsx(as,{}),children:"Edit"},"edit"),n.jsx(hr.Item,{icon:n.jsx(Ri,{}),children:"Settings"},"settings")]}),trigger:["click"],children:n.jsx(re,{type:"text",icon:n.jsx(Zx,{})})})};return[...w,...b,j]},S=w=>{c(w)},T=x(),y=w=>n.jsxs("div",{style:{padding:"20px"},children:[n.jsx(pu,{level:5,children:"Stall Details"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:[Object.entries(w).map(([k,b])=>["key","amenities"].includes(k)?null:n.jsxs("div",{style:{marginBottom:"8px"},children:[n.jsxs(Sn,{type:"secondary",style:{fontSize:"12px"},children:[k.charAt(0).toUpperCase()+k.slice(1).replace(/([A-Z])/g," $1"),":"]}),n.jsx("div",{children:n.jsx(Sn,{strong:!0,children:b==null?"-":typeof b=="object"?JSON.stringify(b):String(b)})})]},k)),n.jsxs("div",{style:{marginBottom:"8px",gridColumn:"1 / -1"},children:[n.jsx(Sn,{type:"secondary",style:{fontSize:"12px"},children:"Amenities:"}),n.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},children:Object.entries(w.amenities||{}).map(([k,b])=>n.jsxs(_e,{color:"blue",children:[k,": ",b===""?"Available":b]},k))})]})]})]});return n.jsx(de,{className:"amenities-card",title:n.jsxs(ue,{children:[n.jsx(pu,{level:5,style:{margin:0},children:e}),a&&n.jsxs(n.Fragment,{children:[n.jsx(_e,{color:"green",children:"Calculated"}),l==="basic"&&n.jsx(_e,{color:"blue",children:"Basic Amenities"}),l==="extra"&&n.jsx(_e,{color:"purple",children:"Extra Amenities"}),l==="all"&&n.jsx(_e,{color:"orange",children:"All Amenities"})]})]}),extra:n.jsx(ue,{children:n.jsx(re,{type:"primary",icon:n.jsx(Yi,{}),onClick:s,disabled:g.length===0,children:"Export"})}),children:g.length===0?n.jsx(bt,{image:bt.PRESENTED_IMAGE_SIMPLE,description:"No amenities data available"}):e.toLowerCase().includes("basic")&&!a?n.jsx(st,{dataSource:g.map((w,k)=>({key:w._id||w.id||`basic-${k}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,k)=>n.jsxs(ue,{children:[n.jsx(Sn,{strong:!0,children:w}),n.jsx(_e,{color:mu(k.type).textColor,children:k.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Per SQM",dataIndex:"perSqm",key:"perSqm",render:w=>w?`1 per ${w} sqm`:"-"},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:w=>n.jsx(_e,{color:"blue",children:w})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):(e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra"))&&!a?n.jsx(st,{dataSource:g.map((w,k)=>({key:w._id||w.id||`extra-${k}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,k)=>n.jsxs(ue,{children:[n.jsx(Sn,{strong:!0,children:w}),n.jsx(_e,{color:mu(k.type).textColor,children:k.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Rate",dataIndex:"rate",key:"rate",render:w=>n.jsxs(Sn,{style:{color:"#1890ff"},children:["",w.toLocaleString()]})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):T.length===0?n.jsx(It,{message:"No stall data available",description:"Amenities exist but could not be linked to stalls. Make sure stalls are booked and have amenities assigned.",type:"info",showIcon:!0}):n.jsx(st,{dataSource:T,columns:v(),loading:r||u,pagination:{pageSize:10},className:"amenities-table",scroll:{x:"max-content"},expandable:{expandedRowKeys:d,onExpandedRowsChange:S,expandedRowRender:y}})})},{Title:D4,Text:gu}=Me,{TabPane:vk}=Jt,Ql=(e,t)=>{const r=Vs.json_to_sheet(e),s=Vs.book_new();Vs.book_append_sheet(s,r,"Amenities");const i=cd(s,{bookType:"xlsx",type:"array"}),a=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});rx.saveAs(a,`${t}.xlsx`)},L4=()=>{const e=lt(),{message:t}=Zt.useApp(),{exhibitions:r,loading:s}=qe(xe=>xe.exhibition),{bookings:i,loading:a}=qe(xe=>xe.booking),[o,l]=_.useState(null),[d,c]=_.useState([]),[h,f]=_.useState([]),[u,p]=_.useState([]),[g,x]=_.useState([]),[m,v]=_.useState(!1),[S,T]=_.useState({}),[y,w]=_.useState(!1),[k,b]=_.useState({current:1,pageSize:10,total:0}),[j,A]=_.useState([]),[E,C]=_.useState([]),[I,F]=_.useState(""),[N,U]=_.useState(null),[M,L]=_.useState(0),[z,J]=_.useState(0),[ne,te]=_.useState("basic"),[P,H]=_.useState("basic");_.useEffect(()=>{e(Mr()),e(Ti({page:1,limit:100}))},[e]);const B=async(xe,Z=1,ge=10)=>{try{v(!0);const be=await ke.get("/bookings",{params:{exhibitionId:xe,includeDetails:!0,populate:"stallIds.stallTypeId",page:Z,limit:ge}});if(be&&be.data){const Fe=be.data.data.map(pe=>{const Ue={...pe};return Ue.stallIds&&(Ue.stallIds=Ue.stallIds.map(We=>(We.stallTypeId&&typeof We.stallTypeId=="object"&&(We.type=We.stallTypeId.name),We))),Ue}).filter(pe=>pe.exhibitionId._id===xe&&["confirmed","approved"].includes(pe.status));x(Fe),b({current:be.data.pagination.page,pageSize:be.data.pagination.limit,total:be.data.pagination.total})}else x([]),b({current:1,pageSize:10,total:0})}catch(be){console.error("Error fetching complete booking data:",be),x([]),b({current:1,pageSize:10,total:0})}finally{v(!1)}};_.useEffect(()=>{if(o&&r.length>0){const xe=r.find(Z=>Z._id===o);xe&&(c(xe.basicAmenities||[]),f(xe.amenities||[]),B(o,k.current,k.pageSize))}else c([]),f([]),p([]),L(0),J(0),x([])},[o,r]),_.useEffect(()=>{if(o&&r.length>0&&g.length>0){const xe=r.find(Z=>Z._id===o);if(xe){const Z=g.flatMap(Fe=>Fe.stallIds.map(pe=>{const Ue=pe.type||(pe.stallTypeId&&typeof pe.stallTypeId=="object"?pe.stallTypeId.name:S[pe.stallTypeId])||"-";return{stallId:pe._id,stallNumber:pe.number,bookingId:Fe._id,exhibitorName:Fe.companyName,bookingDate:Fe.createdAt,dimensions:pe.dimensions,area:pe.dimensions.width*pe.dimensions.height,status:Fe.status,stallType:Ue}})),ge=g.flatMap(Fe=>!Fe.basicAmenities||Fe.basicAmenities.length===0?Fe.stallIds.flatMap(pe=>{const Ue=pe.dimensions.width*pe.dimensions.height,We=pe.type||(pe.stallTypeId&&typeof pe.stallTypeId=="object"?pe.stallTypeId.name:S[pe.stallTypeId])||"-";return(xe.basicAmenities||[]).map(gt=>{const dt=Math.floor(Ue/gt.perSqm)*gt.quantity;return{...gt,calculatedQuantity:dt>0?dt:gt.quantity,stallId:pe._id,stallNumber:pe.number,bookingId:Fe._id,exhibitorId:Fe.exhibitorId||"",exhibitorName:Fe.companyName,bookingDate:Fe.createdAt,dimensions:pe.dimensions,area:Ue,bookingStatus:Fe.status,stallType:We}})}):Fe.basicAmenities.flatMap(pe=>Fe.stallIds.map(Ue=>{const We=Ue.type||(Ue.stallTypeId&&typeof Ue.stallTypeId=="object"?Ue.stallTypeId.name:S[Ue.stallTypeId])||"-";return{...pe,stallId:Ue._id,stallNumber:Ue.number,bookingId:Fe._id,exhibitorId:Fe.exhibitorId||"",exhibitorName:Fe.companyName,bookingDate:Fe.createdAt,dimensions:Ue.dimensions,area:Ue.dimensions.width*Ue.dimensions.height,bookingStatus:Fe.status,stallType:We}}))),be=g.flatMap(Fe=>!Fe.extraAmenities||Fe.extraAmenities.length===0?[]:Fe.extraAmenities.flatMap(pe=>Fe.stallIds.map(Ue=>{const We=Ue.type||(Ue.stallTypeId&&typeof Ue.stallTypeId=="object"?Ue.stallTypeId.name:S[Ue.stallTypeId])||"-";return{...pe,booked:!0,stallId:Ue._id,stallNumber:Ue.number,bookingId:Fe._id,exhibitorId:Fe.exhibitorId||"",exhibitorName:Fe.companyName,bookingDate:Fe.createdAt,dimensions:Ue.dimensions,area:Ue.dimensions.width*Ue.dimensions.height,bookingStatus:Fe.status,stallType:We,isExtraAmenity:!0,quantity:pe.quantity||1}})));let ve=be;be.length===0&&xe.amenities&&xe.amenities.length>0&&(ve=g.flatMap(pe=>pe.stallIds).flatMap((pe,Ue)=>(xe.amenities||[]).map((We,gt)=>{var Be;const dt=g.find(at=>at.stallIds.some(Tt=>Tt._id===pe._id)),Pe=(Be=dt==null?void 0:dt.extraAmenities)==null?void 0:Be.find(at=>at.name===We.name),ze=!!Pe,Xe=`sim-${Ue}-${gt}-${Date.now()}`,$e=pe.type||(pe.stallTypeId&&typeof pe.stallTypeId=="object"?pe.stallTypeId.name:S[pe.stallTypeId])||"-";return{...We,id:Xe,booked:ze,stallId:pe._id,stallNumber:pe.number,bookingId:(dt==null?void 0:dt._id)||"",exhibitorId:(dt==null?void 0:dt.exhibitorId)||"",exhibitorName:(dt==null?void 0:dt.companyName)||"Unknown",bookingDate:(dt==null?void 0:dt.createdAt)||new Date().toISOString(),dimensions:pe.dimensions,area:pe.dimensions.width*pe.dimensions.height,bookingStatus:(dt==null?void 0:dt.status)||"approved",stallType:$e,isExtraAmenity:!0,quantity:ze?(Pe==null?void 0:Pe.quantity)||1:0}}))),p([...ge,...ve]),L(Z.length),J(ge.length+ve.length)}}else o&&r.length>0&&(p([]),L(0),J(0))},[o,r,g,S]);const R=_.useMemo(()=>{let xe=d;if(j.length>0&&(xe=xe.filter(Z=>j.includes(Z.type))),I){const Z=I.toLowerCase();xe=xe.filter(ge=>ge.name.toLowerCase().includes(Z)||ge.type.toLowerCase().includes(Z)||ge.description&&ge.description.toLowerCase().includes(Z))}return xe},[d,j,I]),K=_.useMemo(()=>{let xe=h;if(j.length>0&&(xe=xe.filter(Z=>j.includes(Z.type))),I){const Z=I.toLowerCase();xe=xe.filter(ge=>ge.name.toLowerCase().includes(Z)||ge.type.toLowerCase().includes(Z)||ge.description&&ge.description.toLowerCase().includes(Z))}return xe},[h,j,I]),se=_.useMemo(()=>{let xe=u;if(j.length>0&&(xe=xe.filter(Z=>j.includes(Z.type))),E.length>0&&(xe=xe.filter(Z=>E.includes(Z.bookingStatus))),I){const Z=I.toLowerCase();xe=xe.filter(ge=>ge.name.toLowerCase().includes(Z)||ge.type.toLowerCase().includes(Z)||ge.description&&ge.description.toLowerCase().includes(Z)||ge.stallNumber&&ge.stallNumber.toLowerCase().includes(Z)||ge.exhibitorName&&ge.exhibitorName.toLowerCase().includes(Z))}if(N&&N[0]&&N[1]){const Z=N[0].startOf("day"),ge=N[1].endOf("day");xe=xe.filter(be=>{if(!be.bookingDate)return!1;const ve=nt(be.bookingDate);return ve.isAfter(Z)&&ve.isBefore(ge)})}return xe},[u,j,E,I,N]),we=()=>{A([]),C([]),F(""),U(null)},ye=()=>{if(R.length===0){t.warning("No basic amenities to export");return}const xe=R.map(be=>({Name:be.name,Type:be.type,Description:be.description||"","Per Sq. Meter":be.perSqm,"Quantity Per Unit":be.quantity,ID:be._id||be.id})),Z=r.find(be=>be._id===o),ge=`${(Z==null?void 0:Z.name)||"Exhibition"}_Basic_Amenities`;Ql(xe,ge),t.success("Basic amenities exported successfully")},X=()=>{if(K.length===0){t.warning("No extra amenities to export");return}const xe=K.map(be=>({Name:be.name,Type:be.type,Description:be.description||"",Rate:be.rate,ID:be._id||be.id})),Z=r.find(be=>be._id===o),ge=`${(Z==null?void 0:Z.name)||"Exhibition"}_Extra_Amenities`;Ql(xe,ge),t.success("Extra amenities exported successfully")},ee=()=>{if(se.length===0){t.warning("No calculated amenities to export");return}const xe=new Map;se.filter(pe=>P==="all"?!0:P==="basic"?pe.hasOwnProperty("calculatedQuantity")||pe.hasOwnProperty("perSqm"):P==="extra"?pe.hasOwnProperty("rate")&&!pe.hasOwnProperty("perSqm"):!0).forEach(pe=>{if(pe.stallId&&pe.stallNumber){if(!xe.has(pe.stallId)){const We=pe.dimensions||{width:0,height:0},gt=pe.area||(We.width&&We.height?We.width*We.height:0);xe.set(pe.stallId,{"Company Name":pe.exhibitorName||"Unknown","Stall No.":pe.stallNumber,Dimension:We?`${We.width}x${We.height}m`:"-","Stall Type":pe.stallType||"-","Area (SQM)":typeof gt=="number"?gt:0,"Booking Date":pe.bookingDate?new Date(pe.bookingDate).toLocaleDateString():"-","Booking Status":pe.bookingStatus||"-"})}const Ue=xe.get(pe.stallId);if(pe.hasOwnProperty("calculatedQuantity"))Ue[pe.name]=pe.calculatedQuantity;else if(pe.hasOwnProperty("perSqm")){const We=typeof Ue["Area (SQM)"]=="number"?Ue["Area (SQM)"]:0,gt=Math.floor(We/pe.perSqm)*pe.quantity;Ue[pe.name]=gt>0?gt:pe.quantity}else if(pe.hasOwnProperty("booked")&&pe.booked){let We=1;typeof pe.quantity=="number"?We=pe.quantity:typeof pe.quantity=="string"&&(We=parseInt(pe.quantity,10),isNaN(We)&&(We=1)),Ue[pe.name]=We}else pe.hasOwnProperty("rate")&&(Ue[pe.name]=0)}});const ge=Array.from(xe.values()),be=r.find(pe=>pe._id===o),ve=P==="basic"?"Basic":P==="extra"?"Extra":"All",Fe=`${(be==null?void 0:be.name)||"Exhibition"}_${ve}_Calculated_Amenities`;Ql(ge,Fe),t.success(`${ve} calculated amenities exported successfully`)},ce=async()=>{try{w(!0);const{default:xe}=await yu(async()=>{const{default:ge}=await Promise.resolve().then(()=>Cy);return{default:ge}},void 0),Z=await xe.getStallTypes();if(Z&&Z.data){const ge={};Z.data.forEach(be=>{be._id&&(ge[be._id]=be.name)}),T(ge)}}catch(xe){console.error("Error fetching stall types:",xe)}finally{w(!1)}};return _.useEffect(()=>{o&&ce()},[o]),n.jsxs("div",{className:"amenities-container",children:[n.jsxs("div",{className:"amenities-header",children:[n.jsx(D4,{level:4,className:"amenities-title",children:"Amenities Management"}),n.jsx(gu,{type:"secondary",children:"View, filter, and export amenities data. See calculated amenities for booked stalls."})]}),n.jsx(R4,{exhibitionId:o,exhibitions:r,exhibitionsLoading:s,onExhibitionChange:l,typeFilter:j,setTypeFilter:A,bookingStatusFilter:E,setBookingStatusFilter:C,searchQuery:I,setSearchQuery:F,dateRange:N,setDateRange:U,resetFilters:we}),o&&n.jsx("div",{style:{marginBottom:24},children:n.jsx(P4,{basicAmenities:d,extraAmenities:h,bookedStalls:M,calculatedAmenities:z})}),o?n.jsx(Jt,{activeKey:ne,onChange:te,className:"amenities-tabs",items:[{key:"basic",label:n.jsxs("span",{children:[n.jsx(ep,{}),"Basic Amenities"]}),children:n.jsx(Xl,{title:"Basic Amenities",amenities:R,loading:s,onExport:ye,exhibitionId:o})},{key:"extra",label:n.jsxs("span",{children:[n.jsx(ps,{}),"Extra Amenities"]}),children:n.jsx(Xl,{title:"Additional Amenities",amenities:K,loading:s,onExport:X,exhibitionId:o})},{key:"calculated",label:n.jsxs("span",{children:[n.jsx(tp,{}),"Calculated Amenities"]}),children:n.jsxs(n.Fragment,{children:[n.jsx(Ne,{gutter:[0,16],children:n.jsx(Q,{span:24,children:n.jsx(de,{className:"filter-card",children:n.jsxs(ue,{children:[n.jsx(gu,{strong:!0,children:"View: "}),n.jsxs(vr.Group,{value:P,onChange:xe=>H(xe.target.value),optionType:"button",buttonStyle:"solid",children:[n.jsx(vr.Button,{value:"basic",children:"Basic Amenities"}),n.jsx(vr.Button,{value:"extra",children:"Extra Amenities"}),n.jsx(vr.Button,{value:"all",children:"All Amenities"})]})]})})})}),n.jsx(Xl,{title:"Calculated Amenities",amenities:se,loading:s,onExport:ee,isDynamicColumns:!0,isCalculated:!0,exhibitionId:o,amenityViewType:P})]})}]}):n.jsx("div",{style:{marginTop:24,textAlign:"center",padding:48,background:"#fff",borderRadius:8},children:n.jsx(bt,{description:"Please select an exhibition to view amenities",image:bt.PRESENTED_IMAGE_SIMPLE})})]})},At=({children:e})=>qe(r=>r.auth.isAuthenticated)?e:n.jsx(Oo,{to:"/login"}),Ds=({children:e})=>qe(r=>r.exhibitorAuth.isAuthenticated)?e:n.jsx(Oo,{to:"/"});function O4(){return n.jsx(Zt,{children:n.jsx(Ji,{children:n.jsx(up,{children:n.jsxs(fp,{children:[n.jsx(Qe,{path:"/",element:n.jsx(T4,{})}),n.jsx(Qe,{path:"/login",element:n.jsx(Lg,{})}),n.jsx(Qe,{path:"/exhibitions",element:n.jsx(Hv,{})}),n.jsx(Qe,{path:"/exhibitions/:id",element:n.jsx(Iv,{})}),n.jsx(Qe,{path:"/exhibitions/:id/layout",element:n.jsx(kv,{})}),n.jsx(Qe,{path:"/exhibitor/dashboard",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx(Ug,{})})})}),n.jsx(Qe,{path:"/exhibitor/profile",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx(Gg,{})})})}),n.jsx(Qe,{path:"/exhibitor/bookings",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx(Hg,{})})})}),n.jsx(Qe,{path:"/exhibitor/bookings/:id",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx(Vg,{})})})}),n.jsx(Qe,{path:"/exhibitor/support",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx("div",{children:"Help & Support"})})})}),n.jsx(Qe,{path:"/exhibitor/invoice/:id",element:n.jsx(Ds,{children:n.jsx(ws,{children:n.jsx(U1,{})})})}),n.jsx(Qe,{path:"/dashboard",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Mg,{})})})}),n.jsx(Qe,{path:"/account",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(z1,{})})})}),n.jsx(Qe,{path:"/exhibition",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(ky,{})})})}),n.jsx(Qe,{path:"/exhibition/create",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Py,{})})})}),n.jsx(Qe,{path:"/exhibition/:id",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Dy,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/space",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Xy,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/layout",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Jy,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/halls",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(ev,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/stalls",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Gv,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/fixtures",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Xv,{})})})}),n.jsx(Qe,{path:"/exhibition/:id/edit",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Ly,{})})})}),n.jsx(Qe,{path:"/stall/list",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(Zv,{})})})}),n.jsx(Qe,{path:"/stall-types",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(sb,{})})})}),n.jsx(Qe,{path:"/bookings",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(o4,{})})})}),n.jsx(Qe,{path:"/bookings/create",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(u4,{})})})}),n.jsx(Qe,{path:"/amenities",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(L4,{})})})}),n.jsx(Qe,{path:"/invoices",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(m4,{})})})}),n.jsx(Qe,{path:"/invoice/:id",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(f4,{})})})}),n.jsx(Qe,{path:"/index",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(yy,{})})})}),n.jsx(Qe,{path:"/settings",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(H1,{})})})}),n.jsx(Qe,{path:"/roles",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(ry,{})})})}),n.jsx(Qe,{path:"/notifications",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(jy,{})})})}),n.jsx(Qe,{path:"/exhibitors",element:n.jsx(At,{children:n.jsx(Ct,{children:n.jsx(I4,{})})})}),n.jsx(Qe,{path:"*",element:n.jsx(Oo,{to:"/",replace:!0})})]})})})})}const Jl=Uc({reducerPath:"bookingApi",baseQuery:Oc({baseUrl:"/api"}),endpoints:e=>({getBookings:e.query({query:()=>"/bookings"}),getBooking:e.query({query:t=>`/bookings/${t}`}),createBooking:e.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:e.mutation({query:({id:t,status:r})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:r}})})})}),B4=xp({reducer:{auth:Cp,exhibitorAuth:Xm,exhibition:Ey,booking:ab,exhibitor:d4,settings:Mm,role:J1,user:cy,[Jl.reducerPath]:Jl.reducer,[ho.reducerPath]:ho.reducer,[Ya.reducerPath]:Ya.reducer},middleware:e=>e().concat(Jl.middleware).concat(ho.middleware).concat(Ya.middleware)}),M4={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};tc.createRoot(document.getElementById("root")).render(n.jsx(xt.StrictMode,{children:n.jsx(pp,{store:B4,children:n.jsx(rp,{theme:M4,children:n.jsx(Zt,{children:n.jsx(O4,{})})})})}));
