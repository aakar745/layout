var Ja=Object.defineProperty;var eo=(t,s,n)=>s in t?Ja(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Zi=(t,s,n)=>eo(t,typeof s!="symbol"?s+"":s,n);import{j as e,_ as ca,a as da,D as ua,P as ha}from"./vendor-pdf-Bmb9L_Rw.js";import{b as to,c as so,g as no,d as Ne,T as pe,L as Kt,e as We,S as G,f as le,B as Ke,A as gt,h as _n,i as ke,j as io,k as Ye,l as ys,r as u,m as _,n as Ri,o as Ms,p as Pn,q as Xt,s as at,t as Et,E as Ct,D as zt,u as Pe,M as nt,v as xa,w as pa,x as mt,y as Dn,z as rt,C as Rn,F as Ee,G as On,H as ro,I as Ln,J as Bt,K as ao,N as W,O as F,P as oo,Q as Li,U as Qe,V as bn,W as Ft,X as Ws,Y as ee,Z as ie,$ as M,a0 as H,a1 as $n,a2 as Ji,a3 as lo,a4 as ye,a5 as Le,a6 as oe,a7 as Re,a8 as Vn,a9 as Lt,aa as me,ab as Zt,ac as Ut,ad as xe,ae as $i,af as Mt,ag as Fi,ah as vs,ai as co,aj as Bi,ak as ma,al as ft,am as it,an as zs,ao as uo,ap as Us,aq as et,ar as bs,as as ut,at as ho,au as xo,av as po,a as Ae,aw as Mi,ax as er,ay as qs,az as Ys,aA as tr,aB as mo,aC as ts,aD as Fe,aE as ms,aF as ga,aG as kt,aH as Jt,aI as Qs,aJ as go,aK as fo,aL as yo,aM as fa,aN as bo,aO as sr,aP as jo,aQ as vo,aR as wo,aS as ya,aT as zi,aU as So,aV as ko,aW as Io,aX as Co,aY as No,aZ as nr,a_ as ba,a$ as Eo,b0 as Ao,b1 as To,b2 as Po,b3 as Do,b4 as Ro,b5 as Lo,b6 as Ci,b7 as $o,b8 as vt,b9 as Fo,ba as ir,bb as Bo,bc as Mo}from"./vendor-antd-RbeexA_j.js";import{c as ct,u as ve,a as De,b as $e,d as qt,e as ge,L as Je,f as ot,w as rr,n as ja,g as va,i as _s,h as zo,j as ws,k as wa,p as Ui,l as Is,m as Fn,o as qi,q as es,r as ar,s as Uo,S as Sa,t as Xn,v as _i,x as ka,y as qo,z as Ia,A as _o,B as or,C as Oo,D as Vo,E as Ho,F as Wo,G as Ps,N as Hn,H as Yo,I as Qo,R as Go,J as je,K as Ko,P as Xo}from"./vendor-react-AsBsYwNz.js";import{a as ss}from"./vendor-utils-CBI24EYO.js";import{n as K,k as _t}from"./vendor-ui-Bb0P9X4s.js";import{E as Zo}from"./vendor-editor-BzUp9Vpt.js";import{L as Bn,G as js,R as Wn,T as Os,u as Jo,a as el,I as tl,C as sl,b as nl,c as il,S as rl,d as al}from"./vendor-canvas-Bh0RjZpl.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();var Ni={},lr=to;Ni.createRoot=lr.createRoot,Ni.hydrateRoot=lr.hydrateRoot;const cr=localStorage.getItem("token"),ol=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null,ll={isAuthenticated:!!cr,user:ol,token:cr},Ca=ct({name:"auth",initialState:ll,reducers:{setCredentials:(t,s)=>{t.user=s.payload.user,t.token=s.payload.token,t.isAuthenticated=!0,localStorage.setItem("token",s.payload.token),localStorage.setItem("user",JSON.stringify(s.payload.user))},logout:t=>{t.user=null,t.token=null,t.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}}}),{setCredentials:cl,logout:dl}=Ca.actions,ul=Ca.reducer;var tt=(t=>(t.NEW_LEAD="New Lead",t.FOLLOWUP_DUE="Follow-up Due",t.STATUS_CHANGE="Status Changed",t.ASSIGNMENT="Lead Assigned",t))(tt||{}),Rt=(t=>(t.FACEBOOK="Facebook",t.WEBSITE="Website",t.MANUAL="Manual",t.SYSTEM="System",t))(Rt||{}),lt=(t=>(t.HIGH="High",t.MEDIUM="Medium",t.LOW="Low",t))(lt||{}),Ce=(t=>(t.READ="Read",t.UNREAD="Unread",t))(Ce||{});const Na=()=>[{id:"1",userId:"1",type:tt.NEW_LEAD,title:"New Lead from Facebook",message:"John Smith has inquired about Tourist visa",source:Rt.FACEBOOK,priority:lt.HIGH,status:Ce.UNREAD,entityId:"101",entityType:"lead",createdAt:new Date(new Date().setHours(new Date().getHours()-1)).toISOString()},{id:"2",userId:"1",type:tt.FOLLOWUP_DUE,title:"Follow-up Due Today",message:"You have a call scheduled with Emma Wilson at 2:00 PM",source:Rt.SYSTEM,priority:lt.HIGH,status:Ce.UNREAD,entityId:"201",entityType:"followup",createdAt:new Date(new Date().setHours(new Date().getHours()-3)).toISOString()},{id:"3",userId:"1",type:tt.STATUS_CHANGE,title:"Lead Status Changed",message:'Sarah Johnson changed the status of lead Michael Brown from "New" to "Contacted"',source:Rt.SYSTEM,priority:lt.MEDIUM,status:Ce.UNREAD,entityId:"102",entityType:"lead",createdAt:new Date(new Date().setHours(new Date().getHours()-5)).toISOString()},{id:"4",userId:"1",type:tt.ASSIGNMENT,title:"Lead Assigned to You",message:"David Wilson assigned a new lead Raj Patel to you",source:Rt.SYSTEM,priority:lt.MEDIUM,status:Ce.READ,entityId:"103",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-1)).toISOString(),readAt:new Date(new Date().setHours(new Date().getHours()-6)).toISOString()},{id:"5",userId:"1",type:tt.NEW_LEAD,title:"New Lead from Website",message:"Sophie Martin has inquired about Permanent Residency visa",source:Rt.WEBSITE,priority:lt.HIGH,status:Ce.READ,entityId:"104",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-1)).toISOString(),readAt:new Date(new Date().setHours(new Date().getHours()-12)).toISOString()},{id:"6",userId:"1",type:tt.FOLLOWUP_DUE,title:"Follow-up Overdue",message:"You missed a WhatsApp follow-up with Akira Tanaka yesterday",source:Rt.SYSTEM,priority:lt.HIGH,status:Ce.UNREAD,entityId:"202",entityType:"followup",createdAt:new Date(new Date().setDate(new Date().getDate()-2)).toISOString()},{id:"7",userId:"1",type:tt.STATUS_CHANGE,title:"Lead Status Changed",message:'You changed the status of lead Ana Rodriguez from "Contacted" to "Interested"',source:Rt.SYSTEM,priority:lt.LOW,status:Ce.READ,entityId:"105",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-3)).toISOString(),readAt:new Date(new Date().setDate(new Date().getDate()-3)).toISOString()},{id:"8",userId:"1",type:tt.NEW_LEAD,title:"New Lead from Manual Entry",message:"A new lead has been added manually for Business visa",source:Rt.MANUAL,priority:lt.MEDIUM,status:Ce.UNREAD,entityId:"106",entityType:"lead",createdAt:new Date(new Date().setDate(new Date().getDate()-4)).toISOString()}],hl=()=>({userId:"1",inApp:{enabled:!0,newLeads:!0,followUpReminders:!0,statusChanges:!0,leadAssignments:!0},email:{newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0},pushNotifications:!1});var Ea={exports:{}};(function(t,s){(function(n,i){t.exports=i()})(so,function(){return function(n,i,r){n=n||{};var l=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function f(h,S,$,v){return l.fromToBase(h,S,$,v)}r.en.relativeTime=a,l.fromToBase=function(h,S,$,v,T){for(var I,j,R,d=$.$locale().relativeTime||a,p=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],k=p.length,o=0;o<k;o+=1){var c=p[o];c.d&&(I=v?r(h).diff($,c.d,!0):$.diff(h,c.d,!0));var D=(n.rounding||Math.round)(Math.abs(I));if(R=I>0,D<=c.r||!c.r){D<=1&&o>0&&(c=p[o-1]);var w=d[c.l];T&&(D=T(""+D)),j=typeof w=="string"?w.replace("%d",D):w(D,S,c.l,R);break}}if(S)return j;var P=R?d.future:d.past;return typeof P=="function"?P(j):P.replace("%s",j)},l.to=function(h,S){return f(h,S,this,!0)},l.from=function(h,S){return f(h,S,this)};var y=function(h){return h.$u?r.utc():r()};l.toNow=function(h){return this.to(y(this),h)},l.fromNow=function(h){return this.from(y(this),h)}}})})(Ea);var xl=Ea.exports;const pl=no(xl);Ne.extend(pl);const dr=t=>{switch(t){case lt.HIGH:return"#f5222d";case lt.MEDIUM:return"#faad14";case lt.LOW:return"#52c41a";default:return"#1677ff"}},ml=t=>Ne(t).fromNow(),gl=t=>Ne(t).format("YYYY-MM-DD HH:mm"),Ds=t=>t.filter(s=>s.status===Ce.UNREAD).length,fl=t=>{if(!t.entityId||!t.entityType)return"/notifications";switch(t.entityType){case"lead":return`/leads/${t.entityId}`;case"followup":return`/followups/${t.entityId}`;default:return"/notifications"}},{Text:ur,Paragraph:yl}=pe,Aa=({notification:t,onView:s,onMarkAsRead:n})=>{const i=()=>{switch(t.type){case tt.NEW_LEAD:return e.jsx(ys,{style:{color:"#1677ff"}});case tt.FOLLOWUP_DUE:return e.jsx(Ye,{style:{color:"#faad14"}});case tt.STATUS_CHANGE:return e.jsx(io,{style:{color:"#722ed1"}});case tt.ASSIGNMENT:return e.jsx(ke,{style:{color:"#52c41a"}});default:return e.jsx(_n,{style:{color:"#1677ff"}})}},r=()=>{t.status===Ce.UNREAD&&n(t),s(t)};return e.jsx(Kt.Item,{onClick:r,className:t.status===Ce.UNREAD?"notification-unread":"",style:{cursor:"pointer",backgroundColor:t.status===Ce.UNREAD?"#f0f5ff":"transparent",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},children:e.jsx(Kt.Item.Meta,{avatar:e.jsx(Ke,{dot:t.status===Ce.UNREAD,color:dr(t.priority),children:e.jsx(gt,{icon:i(),size:"large",style:{backgroundColor:"white",border:`1px solid ${dr(t.priority)}`}})}),title:e.jsxs(G,{children:[e.jsx(ur,{strong:!0,children:t.title}),t.status===Ce.UNREAD&&e.jsx(le,{color:"blue",children:"New"})]}),description:e.jsxs("div",{children:[e.jsx(yl,{ellipsis:{rows:2},style:{marginBottom:4},children:t.message}),e.jsx(We,{title:gl(t.createdAt),children:e.jsx(ur,{type:"secondary",style:{fontSize:12},children:ml(t.createdAt)})})]})})})},{Title:bl,Text:jl}=pe,{TabPane:hr}=at,vl=()=>{const t=ve(),[s,n]=u.useState([]),[i,r]=u.useState(!1),[l,a]=u.useState(!1),[f,y]=u.useState(!1),[h,S]=u.useState("all"),[$,v]=u.useState(!1),T=u.useRef(null);u.useEffect(()=>{I();const w=setInterval(()=>{Math.random()<.25&&!l&&(y(!0),v(!0),setTimeout(()=>{v(!1)},2e3))},3e4);return()=>clearInterval(w)},[l]);const I=()=>{r(!0),setTimeout(()=>{const w=Na();n(w),r(!1),y(w.some(P=>P.status===Ce.UNREAD))},600)},j=w=>{a(w),w&&(y(!1),T.current&&T.current.classList.remove("bell-animate"))},R=w=>{d(w),a(!1),w.entityId&&w.entityType?w.entityType==="lead"?t(`/leads/${w.entityId}`):w.entityType==="followup"&&t(`/followups/${w.entityId}`):t("/notifications")},d=w=>{const P=s.map(g=>g.id===w.id?{...g,status:Ce.READ,readAt:new Date().toISOString()}:g);n(P)},p=()=>{a(!1),t("/notifications")},k=()=>{const w=s.map(P=>P.status===Ce.UNREAD?{...P,status:Ce.READ,readAt:new Date().toISOString()}:P);n(w),y(!1)},o=()=>h==="unread"?s.filter(w=>w.status===Ce.UNREAD):s.slice(0,5),c=w=>{S(w)},D=e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx(bl,{level:5,style:{margin:0},children:"Notifications"}),e.jsxs(G,{children:[e.jsx(_,{type:"text",size:"small",icon:e.jsx(Ri,{}),onClick:I,loading:i,className:"header-btn",title:"Refresh notifications"}),e.jsx(_,{type:"text",size:"small",icon:e.jsx(Ms,{}),onClick:k,disabled:Ds(s)===0,className:"header-btn",title:"Mark all as read"}),e.jsx(_,{type:"text",size:"small",icon:e.jsx(Pn,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Settings"}),e.jsx(_,{type:"text",size:"small",icon:e.jsx(Xt,{}),onClick:()=>a(!1),className:"header-btn",title:"Close"})]})]}),e.jsxs(at,{activeKey:h,onChange:c,size:"small",className:"notification-tabs",children:[e.jsx(hr,{tab:e.jsx("span",{children:"All"})},"all"),e.jsx(hr,{tab:e.jsxs("span",{className:"tab-label",children:["Unread",e.jsx(Ke,{count:Ds(s),size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})},"unread")]}),i?e.jsxs("div",{className:"notification-loading",children:[e.jsx(Et,{size:"large"}),e.jsx(jl,{type:"secondary",children:"Loading notifications..."})]}):e.jsx("div",{style:{backgroundColor:"white"},children:e.jsx(Kt,{className:"notification-list",dataSource:o(),renderItem:w=>e.jsx("div",{onClick:()=>R(w),className:"notification-item",children:e.jsx(Aa,{notification:w,onView:R,onMarkAsRead:d})}),locale:{emptyText:e.jsx(Ct,{image:Ct.PRESENTED_IMAGE_SIMPLE,description:"No notifications",className:"notification-empty"})}})}),e.jsx("div",{className:"notification-footer",children:e.jsx(_,{type:"primary",onClick:p,style:{width:"100%",borderRadius:"4px"},children:"View All Notifications"})})]});return e.jsx("div",{className:`notification-bell-container ${$?"has-new-notification":""}`,ref:T,children:e.jsx(zt,{open:l,onOpenChange:j,trigger:["click"],dropdownRender:()=>D,placement:"bottomRight",arrow:{pointAtCenter:!0},overlayStyle:{zIndex:1050,boxShadow:"0 6px 16px -8px rgba(0,0,0,0.2), 0 9px 28px rgba(0,0,0,0.1)"},destroyPopupOnHide:!0,children:e.jsx(Ke,{count:Ds(s),overflowCount:99,className:f?"badge-pulse":"",style:{backgroundColor:f?"#f5222d":"#1677ff",transition:"background-color 0.3s ease"},size:"small",offset:[-2,2],children:e.jsx(_,{type:"text",icon:e.jsx(_n,{className:"bell-icon"}),className:"notification-bell-btn","aria-label":"Notifications"})})})})},Yn="/api",ne=ss.create({baseURL:Yn,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Vt=ss.create({baseURL:Yn,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Ta=ss.create({baseURL:Yn,headers:{"Content-Type":"application/json",Accept:"application/json"}});ne.interceptors.request.use(t=>{var l,a,f,y,h,S,$,v,T;const s=localStorage.getItem("token"),n=localStorage.getItem("exhibitor_token"),i=((l=t.url)==null?void 0:l.startsWith("/bookings/"))&&t.method==="patch"||((a=t.url)==null?void 0:a.includes("/exhibition/"))||((f=t.url)==null?void 0:f.includes("/stalls/"))||((y=t.url)==null?void 0:y.includes("/halls/"))||((h=t.url)==null?void 0:h.includes("/users/"))||((S=t.url)==null?void 0:S.includes("/roles/")),r=(($=t.url)==null?void 0:$.includes("/test-booking"))||((v=t.url)==null?void 0:v.includes("/exhibitor-bookings"))||((T=t.url)==null?void 0:T.startsWith("/exhibitors/"));return i?s?t.headers.Authorization=`Bearer ${s}`:console.warn("Admin token required but not found for:",t.url):r&&n?t.headers.Authorization=`Bearer ${n}`:s?t.headers.Authorization=`Bearer ${s}`:n&&(t.headers.Authorization=`Bearer ${n}`),t},t=>Promise.reject(t));Ta.interceptors.request.use(t=>{const s=localStorage.getItem("exhibitor_token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));ne.interceptors.response.use(t=>t,t=>{var n,i,r;((n=t.response)==null?void 0:n.status)===401&&localStorage.removeItem("token");const s=((r=(i=t.response)==null?void 0:i.data)==null?void 0:r.message)||t.message;return Promise.reject(new Error(s))});Ta.interceptors.response.use(t=>t,t=>{var n,i,r;((n=t.response)==null?void 0:n.status)===401&&localStorage.removeItem("exhibitor_token");const s=((r=(i=t.response)==null?void 0:i.data)==null?void 0:r.message)||t.message;return Promise.reject(new Error(s))});const xr=async(t,s=!1)=>{const n=s?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return ss.get(`${Yn}${t}`,{responseType:"blob",headers:{Authorization:`Bearer ${n}`}})};class wl{async getSettings(){return(await ne.get("/settings")).data}async updateSettings(s){return(await ne.put("/settings",s)).data}async uploadLogo(s){const n=new FormData;return n.append("file",s),(await ne.post("/settings/upload/logo",n,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Oi=new wl,Sl={settings:null,loading:!1,error:null},Rs=De("settings/fetchSettings",async(t,{rejectWithValue:s})=>{var n,i;try{return await Oi.getSettings()}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch settings")}}),Ls=De("settings/updateSettings",async(t,{rejectWithValue:s})=>{var n,i;try{return await Oi.updateSettings(t)}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to update settings")}}),jn=De("settings/uploadLogo",async(t,{dispatch:s,rejectWithValue:n})=>{var i,r;try{const l=await Oi.uploadLogo(t);return l.path&&await s(Ls({logo:l.path})),l}catch(l){return n(((r=(i=l.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to upload logo")}}),kl=ct({name:"settings",initialState:Sl,reducers:{},extraReducers:t=>{t.addCase(Rs.pending,s=>{s.loading=!0,s.error=null}).addCase(Rs.fulfilled,(s,n)=>{s.settings=n.payload,s.loading=!1}).addCase(Rs.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Ls.pending,s=>{s.loading=!0,s.error=null}).addCase(Ls.fulfilled,(s,n)=>{s.settings=n.payload,s.loading=!1}).addCase(Ls.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(jn.pending,s=>{s.loading=!0,s.error=null}).addCase(jn.fulfilled,s=>{s.loading=!1}).addCase(jn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),Il=kl.reducer,{Header:Cl,Sider:Nl,Content:El}=Pe,Al=K.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,Tl=K.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,Pl=K.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;K.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const Me=({children:t})=>{var T;const[s,n]=u.useState(!1),i=ve(),r=$e(),l=qt(),a=ge(I=>I.auth.user),{settings:f}=ge(I=>I.settings),[y,h]=u.useState("/logo.png");u.useEffect(()=>{r(Rs())},[r]),u.useEffect(()=>{const I=localStorage.getItem("cachedLogoUrl"),j=localStorage.getItem("logoTimestamp"),R=new Date().getTime();if(I&&j&&R-parseInt(j)<36e5)h(I);else if(f!=null&&f.logo){const d=`${ne.defaults.baseURL}/public/logo`;h(d),localStorage.setItem("cachedLogoUrl",d),localStorage.setItem("logoTimestamp",R.toString());const p=new Image;p.src=d}},[f]);const S=[{key:"dashboard",icon:e.jsx(Dn,{style:{fontSize:"16px"}}),label:"Dashboard",onClick:()=>i("/dashboard")},{key:"exhibition",icon:e.jsx(rt,{style:{fontSize:"16px"}}),label:"Exhibitions",onClick:()=>i("/exhibition")},{key:"stall",icon:e.jsx(Rn,{style:{fontSize:"16px"}}),label:"Stalls",children:[{key:"stall-list",icon:e.jsx(Rn,{style:{fontSize:"16px"}}),label:"Stall List",onClick:()=>i("/stall/list")},{key:"stall-type",icon:e.jsx(Ee,{style:{fontSize:"16px"}}),label:"Stall Types",onClick:()=>i("/stall-types")}]},{key:"bookings",icon:e.jsx(rt,{style:{fontSize:"16px"}}),label:"Stall Bookings",onClick:()=>i("/bookings")},{key:"exhibitors",icon:e.jsx(On,{}),label:"Exhibitors",onClick:()=>i("/exhibitors")},{key:"users",icon:e.jsx(ke,{}),label:"Users",onClick:()=>i("/index")},{key:"roles",icon:e.jsx(ro,{}),label:"Roles",onClick:()=>i("/roles")},{key:"settings",icon:e.jsx(Pn,{}),label:"Settings",onClick:()=>i("/settings")}],$=[{key:"profile",label:"Profile",icon:e.jsx(ke,{})},{key:"settings",label:"Settings",icon:e.jsx(Pn,{})},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(Ln,{}),onClick:()=>{r(dl()),i("/login")}}],v=()=>{const I=l.pathname.substring(1);return I.charAt(0).toUpperCase()+I.slice(1)};return e.jsxs(Pe,{style:{minHeight:"100vh"},children:[e.jsxs(Nl,{trigger:null,collapsible:!0,collapsed:s,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsx(Al,{children:e.jsx(Tl,{children:e.jsx(Pl,{src:y,alt:"Logo",onError:()=>h("/logo.png")})})}),e.jsx(nt,{mode:"inline",selectedKeys:[l.pathname.substring(1)||"dashboard"],items:S,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:s})]}),e.jsxs(Pe,{style:{marginLeft:s?80:256,transition:"all 0.2s"},children:[e.jsxs(Cl,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(_,{type:"text",icon:s?e.jsx(xa,{}):e.jsx(pa,{}),onClick:()=>n(!s),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:v()})]}),e.jsxs(G,{size:16,children:[e.jsx(_,{type:"text",icon:e.jsx(mt,{}),style:{fontSize:16}}),e.jsx(vl,{}),e.jsx(zt,{menu:{items:$},trigger:["click"],children:e.jsxs(G,{style:{cursor:"pointer"},children:[e.jsx(gt,{style:{backgroundColor:"#7C3AED",cursor:"pointer"},children:(T=a==null?void 0:a.username)==null?void 0:T.charAt(0).toUpperCase()}),e.jsx("span",{style:{color:"#111827",fontWeight:500},children:a==null?void 0:a.username})]})})]})]}),e.jsx(El,{style:{margin:"24px",padding:"24px",background:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},children:t})]})]})},pr=localStorage.getItem("exhibitor_token"),Dl=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,Rl={isAuthenticated:!!pr,exhibitor:Dl,token:pr,showLoginModal:!1,loginContext:null},Pa=ct({name:"exhibitorAuth",initialState:Rl,reducers:{setExhibitorCredentials:(t,s)=>{t.exhibitor=s.payload.exhibitor,t.token=s.payload.token,t.isAuthenticated=!0,localStorage.setItem("exhibitor_token",s.payload.token),localStorage.setItem("exhibitor",JSON.stringify(s.payload.exhibitor))},exhibitorLogout:t=>{t.exhibitor=null,t.token=null,t.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(t,s)=>{t.showLoginModal=!0,t.loginContext=s.payload||null},hideLoginModal:t=>{t.showLoginModal=!1,t.loginContext=null}}}),{setExhibitorCredentials:Ei,exhibitorLogout:Da,showLoginModal:Mn,hideLoginModal:mr}=Pa.actions,Ll=Pa.reducer,{Header:$l,Sider:Fl,Content:Bl}=Pe,ns=({children:t})=>{var S;const[s,n]=u.useState(!1),i=ve(),r=$e(),l=qt(),a=ge($=>$.exhibitorAuth.exhibitor),f=[{key:"dashboard",icon:e.jsx(Dn,{}),label:"Dashboard",onClick:()=>i("/exhibitor/dashboard")},{key:"bookings",icon:e.jsx(rt,{}),label:"My Bookings",onClick:()=>i("/exhibitor/bookings")},{key:"profile",icon:e.jsx(ke,{}),label:"My Profile",onClick:()=>i("/exhibitor/profile")},{key:"exhibitions",icon:e.jsx(Bt,{}),label:"Exhibitions",onClick:()=>i("/exhibitions")},{key:"help",icon:e.jsx(ao,{}),label:"Help & Support",onClick:()=>i("/exhibitor/support")}],y=[{key:"profile",label:"Profile",icon:e.jsx(ke,{}),onClick:()=>i("/exhibitor/profile")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(Ln,{}),onClick:()=>{r(Da()),i("/")}}],h=()=>{const $=l.pathname.replace("/exhibitor/","");return $.charAt(0).toUpperCase()+$.slice(1)};return e.jsxs(Pe,{style:{minHeight:"100vh"},children:[e.jsxs(Fl,{trigger:null,collapsible:!0,collapsed:s,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100},width:256,children:[e.jsxs("div",{style:{height:72,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:s?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[e.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!s&&e.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),e.jsx(nt,{mode:"inline",selectedKeys:[l.pathname.split("/").pop()||"dashboard"],items:f,style:{border:"none",padding:"16px 8px",background:"transparent"}})]}),e.jsxs(Pe,{style:{marginLeft:s?80:256,transition:"all 0.2s"},children:[e.jsxs($l,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(_,{type:"text",icon:s?e.jsx(xa,{}):e.jsx(pa,{}),onClick:()=>n(!s),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:h()})]}),e.jsxs(G,{size:16,children:[e.jsx(Ke,{count:3,size:"small",children:e.jsx(_,{type:"text",icon:e.jsx(_n,{}),style:{fontSize:16}})}),e.jsx(zt,{menu:{items:y},trigger:["click"],children:e.jsxs(G,{style:{cursor:"pointer"},children:[e.jsx(gt,{style:{backgroundColor:"#1890ff",cursor:"pointer"},children:((S=a==null?void 0:a.companyName)==null?void 0:S.charAt(0).toUpperCase())||"E"}),e.jsx("span",{style:{color:"#111827",fontWeight:500},children:(a==null?void 0:a.companyName)||"Exhibitor"})]})})]})]}),e.jsx(Bl,{style:{margin:"24px",padding:"24px",background:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},children:t})]})]})},{Title:Ra,Text:yt,Paragraph:Ml}=pe,Gs=_t`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,zl=_t`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,Ul=_t`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Vi=_t`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,La=_t`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,ql=_t`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,_l=_t`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,Ol=_t`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,Vl=K.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,Hl=K.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${zl} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,Wl=K.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${t=>.1+t.index%3*.05}), transparent);
  left: ${t=>20+t.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${t=>t.isHovered?ql:_l} ${t=>1.5+t.index*.2}s ease-out;
  animation-delay: ${t=>t.index*.1}s;
  animation-fill-mode: forwards;
`,Yl=K.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${Ul} 0.8s ease-out forwards;
`,Ql=K.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,Gl=K.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${Ol} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Vi} 2s ease-in-out infinite;
  }
`,Kl=K.span`
  margin-left: 10px;
  animation: ${Gs} 0.5s ease-out;
`,Xl=K.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,Zl=K.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,Jl=K.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${Gs} 0.8s ease-out forwards;
`,ec=K.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,tc=K.img`
  width: 140px;
  height: auto;
  animation: ${La} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;K.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const sc=K.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${Gs} 0.8s ease-out forwards;
`,nc=K.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,ic=K(Ra)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,rc=K(Ml)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,ac=K.div`
  width: 100%;
  max-width: 400px;
  animation: ${Gs} 0.6s ease-out;
`,oc=K(W)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,lc=K(W.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,cc=K(_)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Vi} 0.5s ease-in-out;
  }
`,dc=K.div`
  margin-bottom: 2rem;
  text-align: center;
`,en=K(F.Item)`
  margin-bottom: 24px;
`,uc=K.div`
  margin-top: 8px;
`,hc=K.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,xc=K(oo)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,pc=K.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${Gs} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Vi} 0.5s ease-in-out;
  }
`,gr=()=>e.jsxs(Ql,{children:[e.jsxs(Gl,{viewBox:"0 0 50 50",children:[e.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),e.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),e.jsx(Kl,{children:"Signing in..."})]}),mc=K.div`
  position: absolute;
  width: ${t=>t.size}px;
  height: ${t=>t.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${La} ${t=>t.duration}s ease-in-out infinite;
  animation-delay: ${t=>t.delay}s;
  top: ${t=>t.top}%;
  left: ${t=>t.left}%;
  z-index: 1;
`,gc=t=>{if(!t)return 0;const s=t.length>=8,n=/[A-Z]/.test(t),i=/[a-z]/.test(t),r=/\d/.test(t),l=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(t),a=[s,n,i,r,l];return a.filter(y=>y).length/a.length*100},fc=t=>t<30?"#ff4d4f":t<60?"#faad14":t<80?"#1890ff":"#52c41a",yc=t=>t<30?"Weak":t<60?"Fair":t<80?"Good":"Strong",bc=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],jc=()=>{const t=ve(),s=$e(),[n,i]=u.useState(null),[r,l]=u.useState(!1),[a,f]=u.useState(!1),[y,h]=u.useState(""),[S,$]=u.useState(!1),v=ge(m=>m.auth.isAuthenticated),T=u.useRef(null),[I,j]=u.useState({x:0,y:0}),[R,d]=u.useState(!1),[p,k]=u.useState(!1),[o]=F.useForm(),[c,D]=u.useState("/logo.png"),[w,P]=u.useState("EXHIBITION MANAGER");u.useEffect(()=>{const m=localStorage.getItem("cachedLogoUrl"),C=localStorage.getItem("logoTimestamp"),B=new Date().getTime();if(m&&C&&B-parseInt(C)<36e5)D(m);else{const q=`${ne.defaults.baseURL}/public/logo`;D(q),localStorage.setItem("cachedLogoUrl",q),localStorage.setItem("logoTimestamp",B.toString());const O=new Image;O.src=q}fetch(`${ne.defaults.baseURL}/public/site-info`).then(q=>q.json()).then(q=>{q.siteName&&P(q.siteName)}).catch(q=>{console.error("Error fetching site info:",q)})},[]),u.useEffect(()=>{const m=localStorage.getItem("rememberedUser");if(m)try{const C=JSON.parse(m);o.setFieldsValue({username:C.username,password:C.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[o]),u.useEffect(()=>{const m=setTimeout(()=>{d(!0)},100);return()=>clearTimeout(m)},[]),u.useEffect(()=>{v&&t("/dashboard")},[v,t]),u.useEffect(()=>{const m=C=>{if(T.current){const B=T.current.getBoundingClientRect(),q=C.clientX-B.left,O=C.clientY-B.top;q>=0&&q<=B.width&&O>=0&&O<=B.height&&j({x:q,y:O})}};return window.addEventListener("mousemove",m),()=>{window.removeEventListener("mousemove",m)}},[]);const g=async m=>{var C;try{i(null),l(!0);const B=await ne.post("/auth/login",{username:m.username,password:m.password}),{user:q,token:O}=B.data;if(!q||!O)throw new Error("Invalid response from server");m.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:m.username,password:m.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),f(!0),setTimeout(()=>{s(cl({user:q,token:O})),ee.success("Login successful!"),t("/dashboard")},1200)}catch(B){console.error("Login Error:",B),console.error("Response Data:",(C=B.response)==null?void 0:C.data);let q="Authentication Error",O="Invalid username or password.";if(B.response&&typeof B.response=="object"){const{status:Y,data:Z}=B.response;Y===401?(q="Invalid Credentials",O="The username or password you entered is incorrect."):Y===403?(q="Access Denied",O="You do not have permission to access this resource."):Y===400?(q="Invalid Request",O="Please check your input and try again."):Y===500&&(q="Server Error",O="A server error occurred. Please try again later."),Z&&typeof Z=="object"&&Z.message&&(O=Z.message)}else B.request?(q="Connection Error",O="Unable to connect to the server. Please check your internet connection."):B.message&&(O=B.message);i({title:q,message:O})}finally{l(!1)}},b=gc(y),L=fc(b),N=yc(b),x=localStorage.getItem("rememberUser")==="true";if(v)return e.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[e.jsx(gr,{}),e.jsx(yt,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const E=m=>{const C=[];for(let B=0;B<m;B++){const q=Math.random()*20+8,O=Math.random()*3,Y=Math.random()*10+6,Z=Math.random()*100,te=Math.random()*100;C.push(e.jsx(mc,{size:q,delay:O,duration:Y,top:Z,left:te,style:{transform:`translate(${I.x/50*(B%5-2)}px, ${I.y/50*(B%5-2)}px)`,opacity:p?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},B))}return C},z=m=>{const C=[];for(let B=0;B<m;B++)C.push(e.jsx(Wl,{index:B,isHovered:p},B));return C},A=m=>{k(m)};return e.jsxs(Vl,{style:{opacity:R?1:0,transition:"opacity 0.3s ease-out"},children:[a&&e.jsx(pc,{children:e.jsx(Li,{})}),e.jsxs(Hl,{onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),children:[e.jsx(Jl,{children:e.jsx(ec,{children:e.jsx(tc,{src:c,alt:"Exhibition Manager Logo",onError:()=>D("/logo.png")})})}),e.jsxs(Xl,{ref:T,children:[E(12),z(8)]}),e.jsxs(Zl,{children:[e.jsx(sc,{children:e.jsx(nc,{children:w})}),e.jsx(ic,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),e.jsx(rc,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),e.jsx(Yl,{children:e.jsxs(ac,{children:[e.jsxs(dc,{children:[e.jsx(Ra,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),e.jsx(yt,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),n&&e.jsx(Qe,{message:n.title,description:n.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:e.jsx(_,{size:"small",type:"text",onClick:()=>i(null),children:"Dismiss"})}),e.jsxs(F,{form:o,name:"login",initialValues:{remember:x},onFinish:g,layout:"vertical",children:[e.jsx(en,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:e.jsx(oc,{prefix:e.jsx(ke,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:r,autoComplete:"username"})}),e.jsx(en,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:S&&e.jsxs(uc,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx(yt,{type:"secondary",children:"Password Strength:"}),e.jsx(yt,{strong:!0,style:{color:L},children:N})]}),e.jsx(Ft,{percent:b,showInfo:!1,strokeColor:L,size:"small"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(We,{title:e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:bc.map((m,C)=>e.jsx("li",{children:m},C))}),children:e.jsxs(yt,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[e.jsx(Ws,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:e.jsx(lc,{prefix:e.jsx(bn,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:r,autoComplete:"current-password",onChange:m=>h(m.target.value),onFocus:()=>$(!0),onBlur:()=>$(!1)})}),e.jsx(hc,{children:e.jsx(en,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(xc,{children:"Remember me"})})}),e.jsx(en,{children:r?e.jsx(gr,{}):e.jsx(cc,{type:"primary",htmlType:"submit",block:!0,className:a?"success":"",children:"Sign in"})}),e.jsxs("div",{style:{background:"#f6f6f6",padding:"12px 16px",borderRadius:"8px",border:"1px solid #f0f0f0"},children:[e.jsx(yt,{type:"secondary",children:"Development credentials:"}),e.jsxs("div",{style:{marginTop:"8px",display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(yt,{strong:!0,children:"Username:"})," ",e.jsx(yt,{code:!0,children:"admin"})]}),e.jsxs("div",{children:[e.jsx(yt,{strong:!0,children:"Password:"})," ",e.jsx(yt,{code:!0,children:"admin123"})]})]})]})]})]})})]})},{Title:vc,Text:He}=pe,wc=({title:t,value:s,icon:n,color:i,gradient:r})=>e.jsxs(H,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:r,border:"none",overflow:"hidden",position:"relative"},children:[e.jsx("div",{className:"stat-card-background"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx(He,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:t}),e.jsx(He,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:s})]}),e.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:n})]})]}),Sc=()=>{const t=[{title:"Total Users",value:"1,128",icon:e.jsx(ke,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:"93",icon:e.jsx($n,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:"15,600.00",icon:e.jsx(lo,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Reports",value:"24",icon:e.jsx(Ji,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(vc,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),e.jsx(ie,{gutter:[24,24],children:t.map((s,n)=>e.jsx(M,{xs:24,sm:12,lg:6,children:e.jsx(wc,{...s})},n))}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(M,{xs:24,lg:12,children:e.jsx(H,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"activity-item",children:[e.jsx(ke,{style:{color:"#7C3AED"}}),e.jsxs(He,{children:["User ",e.jsx(He,{strong:!0,children:"'john_doe'"})," logged in"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx($n,{style:{color:"#2563EB"}}),e.jsxs(He,{children:["New order ",e.jsx(He,{strong:!0,children:"#12345"})," received"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(Ji,{style:{color:"#059669"}}),e.jsxs(He,{children:["Product ",e.jsx(He,{strong:!0,children:"'Widget X'"})," updated"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(ke,{style:{color:"#DC2626"}}),e.jsxs(He,{children:["New user registration: ",e.jsx(He,{strong:!0,children:"'jane_smith'"})]})]})]})})}),e.jsx(M,{xs:24,lg:12,children:e.jsx(H,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator online"}),e.jsxs(He,{children:["Server Status: ",e.jsx(He,{strong:!0,type:"success",children:"Online"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator connected"}),e.jsxs(He,{children:["Database Status: ",e.jsx(He,{strong:!0,type:"success",children:"Connected"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator backup"}),e.jsxs(He,{children:["Last Backup: ",e.jsx(He,{strong:!0,children:"2 hours ago"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator normal"}),e.jsxs(He,{children:["System Load: ",e.jsx(He,{strong:!0,children:"Normal"})]})]})]})})})]})]})},{Title:kc,Text:is}=pe,fr=[{id:"1",exhibitionName:"Tech Expo 2023",stallNumber:"A12",status:"approved",bookingDate:"2023-03-15",exhibitionDate:"2023-05-20"},{id:"2",exhibitionName:"Digital Summit",stallNumber:"B45",status:"pending",bookingDate:"2023-04-05",exhibitionDate:"2023-06-10"},{id:"3",exhibitionName:"Innovation Fair",stallNumber:"C33",status:"rejected",bookingDate:"2023-04-12",exhibitionDate:"2023-07-15"}],Ic=()=>{const[t,s]=u.useState(fr),[n,i]=u.useState(!1),r=ge(y=>y.exhibitorAuth.exhibitor);u.useEffect(()=>{i(!0),setTimeout(()=>{s(fr),i(!1)},1e3)},[]);const l=t.filter(y=>y.status==="approved").length,a=t.filter(y=>y.status==="pending").length;t.filter(y=>y.status==="rejected").length;const f=y=>{switch(y){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Ee,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(Ye,{})," Pending"]});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});default:return e.jsx(le,{children:"Unknown"})}};return e.jsxs("div",{children:[e.jsxs(kc,{level:2,children:["Welcome, ",(r==null?void 0:r.companyName)||"Exhibitor"]}),e.jsx(is,{type:"secondary",children:"Here's an overview of your exhibition activities"}),a>0&&e.jsx(Qe,{message:"Pending Approvals",description:`You have ${a} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(_,{size:"small",type:"primary",children:"View Details"})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:24},children:[e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{children:e.jsx(ye,{title:"Total Bookings",value:t.length,prefix:e.jsx(rt,{})})})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{children:e.jsx(ye,{title:"Approved Bookings",value:l,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ee,{})})})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{children:e.jsx(ye,{title:"Pending Approvals",value:a,valueStyle:{color:"#faad14"},prefix:e.jsx(Ye,{})})})})]}),e.jsx(H,{title:"Recent Bookings",extra:e.jsx(Je,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:n,children:e.jsx(Kt,{dataSource:t,renderItem:y=>e.jsxs(Kt.Item,{actions:[e.jsx(Je,{to:`/exhibitor/bookings/${y.id}`,children:"View Details"},"view")],children:[e.jsx(Kt.Item.Meta,{title:e.jsxs("div",{children:[e.jsx(is,{strong:!0,children:y.exhibitionName}),e.jsxs(is,{type:"secondary",style:{marginLeft:12},children:["Stall: ",y.stallNumber]})]}),description:e.jsxs("div",{children:[e.jsxs(is,{children:["Booked on: ",y.bookingDate]}),e.jsx(Le,{type:"vertical"}),e.jsxs(is,{children:["Exhibition date: ",y.exhibitionDate]})]})}),f(y.status)]})})}),e.jsx(H,{title:"Upcoming Exhibitions",style:{marginTop:24},children:e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(Bt,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs("div",{children:[e.jsx(is,{children:"Explore available exhibitions and book your stall"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(Je,{to:"/exhibitions",children:e.jsx(_,{type:"primary",children:"Browse Exhibitions"})})})]})]})})]})},dt={getExhibitions:()=>Vt.get("/public/exhibitions"),getExhibition:t=>Vt.get(`/public/exhibitions/${t}`),getLayout:t=>Vt.get(`/public/exhibitions/${t}/layout`),getStallDetails:(t,s)=>Vt.get(`/public/exhibitions/${t}/stalls/${s}`),bookStall:(t,s,n)=>Vt.post(`/public/exhibitions/${t}/stalls/${s}/book`,n),bookMultipleStalls:(t,s)=>Vt.post(`/public/exhibitions/${t}/stalls/book-multiple`,s),searchExhibitors:t=>Vt.get("/public/exhibitors/search",{params:{query:t}}),exhibitorBookStalls:t=>ne.post(`/exhibitor-bookings/${t.exhibitionId}`,t),getExhibitorBookings:()=>ne.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:t=>ne.get(`/exhibitor-bookings/${t}`),cancelExhibitorBooking:t=>ne.patch(`/exhibitor-bookings/${t}/cancel`),getExhibitorBookingInvoice:t=>ne.get(`/exhibitor-bookings/${t}/invoice`)},{Title:Cc,Text:Nc}=pe,{Option:rs}=oe,{TabPane:as}=at,{confirm:Ec}=me,Ac=()=>{const[t,s]=u.useState([]),[n,i]=u.useState(!1),[r,l]=u.useState(""),[a,f]=u.useState("all"),y=ve();u.useEffect(()=>{h()},[]);const h=async()=>{try{i(!0);const d=await dt.getExhibitorBookings();s(d.data)}catch(d){console.error("Error fetching bookings:",d),ee.error("Failed to load bookings. Please try again.")}finally{i(!1)}},S=d=>{Ec({title:"Are you sure you want to cancel this booking?",icon:e.jsx(Zt,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",onOk:async()=>{try{await dt.cancelExhibitorBooking(d),ee.success("Booking cancelled successfully"),h()}catch(p){console.error("Error cancelling booking:",p),ee.error("Failed to cancel booking")}}})},$=d=>{switch(d){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Ee,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(Ye,{})," Pending"]});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(le,{color:"blue",children:[e.jsx(Ee,{})," Confirmed"]});case"cancelled":return e.jsx(le,{color:"default",children:"Cancelled"});default:return e.jsx(le,{children:"Unknown"})}},v=d=>{switch(d){case"paid":return e.jsx(le,{color:"success",children:"Paid"});case"pending":return e.jsx(le,{color:"warning",children:"Pending"});case"refunded":return e.jsx(le,{color:"default",children:"Refunded"});default:return e.jsx(le,{children:"Unknown"})}},T=async d=>{try{const p=await dt.getExhibitorBookingInvoice(d);p&&p.data&&p.data._id?y(`/exhibitor/invoice/${d}`):ee.error("Invoice not found or not available")}catch(p){console.error("Error fetching invoice:",p),ee.error("Failed to retrieve invoice details")}},I=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(d,p)=>{var k;return((k=p.exhibitionId)==null?void 0:k.name)||"N/A"},sorter:(d,p)=>{var k,o;return(((k=d.exhibitionId)==null?void 0:k.name)||"").localeCompare(((o=p.exhibitionId)==null?void 0:o.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:d=>(d==null?void 0:d.map(p=>p.number).join(", "))||"N/A"},{title:"Booking Date",dataIndex:"createdAt",key:"createdAt",render:d=>Ne(d).format("MMM D, YYYY"),sorter:(d,p)=>Ne(d.createdAt).unix()-Ne(p.createdAt).unix()},{title:"Exhibition Date",key:"exhibitionDate",render:(d,p)=>{var c,D;const k=Ne((c=p.exhibitionId)==null?void 0:c.startDate).format("MMM D"),o=Ne((D=p.exhibitionId)==null?void 0:D.endDate).format("MMM D, YYYY");return`${k} - ${o}`},sorter:(d,p)=>{var k,o;return Ne((k=d.exhibitionId)==null?void 0:k.startDate).unix()-Ne((o=p.exhibitionId)==null?void 0:o.startDate).unix()}},{title:"Status",dataIndex:"status",key:"status",render:d=>$(d),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(d,p)=>p.status===d},{title:"Payment",dataIndex:"paymentStatus",key:"paymentStatus",render:d=>v(d)},{title:"Amount",dataIndex:"amount",key:"amount",render:d=>`â‚¹${d.toLocaleString()}`,sorter:(d,p)=>d.amount-p.amount},{title:"Actions",key:"action",render:(d,p)=>{const k=[{key:"view",icon:e.jsx(Lt,{}),label:"View Details",onClick:()=>y(`/exhibitor/bookings/${p._id}`)}];return["approved","confirmed"].includes(p.status)&&k.push({key:"invoice",icon:e.jsx(Bt,{}),label:"View Invoice",onClick:()=>T(p._id)}),p.status==="pending"&&k.push({key:"cancel",icon:e.jsx(Zt,{}),label:"Cancel Booking",onClick:()=>S(p._id)}),e.jsx(G,{size:"middle",children:e.jsx(zt,{overlay:e.jsx(nt,{items:k}),trigger:["click"],children:e.jsx(_,{type:"text",icon:e.jsx(Vn,{})})})})}}],j=d=>{l(d)},R=t.filter(d=>{var o,c;const p=(((o=d.exhibitionId)==null?void 0:o.name)||"").toLowerCase().includes(r.toLowerCase())||d.stallIds.some(D=>D.number.toLowerCase().includes(r.toLowerCase()))||(((c=d.exhibitionId)==null?void 0:c.venue)||"").toLowerCase().includes(r.toLowerCase()),k=a==="all"||d.status===a;return p&&k});return e.jsxs("div",{children:[e.jsx(Cc,{level:2,children:"My Bookings"}),e.jsx(Nc,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),e.jsx(H,{style:{marginTop:24},children:e.jsxs(at,{defaultActiveKey:"all",children:[e.jsxs(as,{tab:"All Bookings",children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsxs(G,{children:[e.jsx(W,{placeholder:"Search by exhibition, stall, or venue",prefix:e.jsx(mt,{}),style:{width:300},onChange:d=>j(d.target.value),value:r}),e.jsxs(oe,{defaultValue:"all",style:{width:120},onChange:d=>f(d),children:[e.jsx(rs,{value:"all",children:"All Status"}),e.jsx(rs,{value:"approved",children:"Approved"}),e.jsx(rs,{value:"pending",children:"Pending"}),e.jsx(rs,{value:"rejected",children:"Rejected"}),e.jsx(rs,{value:"confirmed",children:"Confirmed"}),e.jsx(rs,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(Je,{to:"/exhibitions",children:e.jsx(_,{type:"primary",children:"Book New Stall"})})]}),e.jsx(Re,{columns:I,dataSource:R,rowKey:"_id",pagination:{pageSize:10},loading:n})]},"all"),e.jsx(as,{tab:"Pending",children:e.jsx(Re,{columns:I,dataSource:t.filter(d=>d.status==="pending"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"pending"),e.jsx(as,{tab:"Approved",children:e.jsx(Re,{columns:I,dataSource:t.filter(d=>d.status==="approved"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"approved"),e.jsx(as,{tab:"Confirmed",children:e.jsx(Re,{columns:I,dataSource:t.filter(d=>d.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"confirmed"),e.jsx(as,{tab:"Rejected",children:e.jsx(Re,{columns:I,dataSource:t.filter(d=>d.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"rejected"),e.jsx(as,{tab:"Cancelled",children:e.jsx(Re,{columns:I,dataSource:t.filter(d=>d.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},loading:n})},"cancelled")]})})]})},{Title:yr,Text:Zn}=pe,Tc=()=>{var $,v,T,I,j,R,d,p,k,o,c,D,w;const{id:t}=ot(),s=ve(),[n,i]=u.useState(null),[r,l]=u.useState(!0);u.useEffect(()=>{a()},[t]);const a=async()=>{try{l(!0);const P=await dt.getExhibitorBooking(t||"");i(P.data)}catch(P){console.error("Error fetching booking details:",P),ee.error("Failed to load booking details")}finally{l(!1)}},f=async()=>{try{s(`/exhibitor/invoice/${t}`)}catch(P){console.error("Error fetching invoice:",P),ee.error("Failed to retrieve invoice")}},y=P=>{switch(P){case"approved":return e.jsxs(le,{color:"success",children:[e.jsx(Ee,{})," Approved"]});case"pending":return e.jsxs(le,{color:"warning",children:[e.jsx(Ye,{})," Pending"]});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(le,{color:"blue",children:[e.jsx(Ee,{})," Confirmed"]});case"cancelled":return e.jsx(le,{color:"default",children:"Cancelled"});default:return e.jsx(le,{children:"Unknown"})}},h=P=>{switch(P){case"paid":return e.jsx(le,{color:"success",children:"Paid"});case"pending":return e.jsx(le,{color:"warning",children:"Pending"});case"refunded":return e.jsx(le,{color:"default",children:"Refunded"});default:return e.jsx(le,{children:"Unknown"})}},S=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:P=>`${P.dimensions.width}m Ã— ${P.dimensions.height}m`},{title:"Size",key:"size",render:P=>`${P.dimensions.width*P.dimensions.height} mÂ²`},{title:"Rate per mÂ²",dataIndex:"ratePerSqm",key:"ratePerSqm",render:P=>`â‚¹${P.toLocaleString()}`},{title:"Amount",key:"amount",render:(P,g,b)=>{var N;const L=(N=n.calculations)==null?void 0:N.stalls[b];return L?`â‚¹${L.baseAmount.toLocaleString()}`:"N/A"}}];return r?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(Et,{size:"large"})}):n?e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>s("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(n.status)&&e.jsx(_,{type:"primary",icon:e.jsx(Bt,{}),onClick:f,children:"View Invoice"})]}),e.jsxs(H,{title:"Booking Details",style:{marginBottom:20},children:[e.jsxs(xe,{bordered:!0,column:{xs:1,sm:2,md:3},children:[e.jsx(xe.Item,{label:"Booking ID",children:n._id}),e.jsx(xe.Item,{label:"Exhibition",children:(($=n.exhibitionId)==null?void 0:$.name)||"N/A"}),e.jsx(xe.Item,{label:"Venue",children:((v=n.exhibitionId)==null?void 0:v.venue)||"N/A"}),e.jsx(xe.Item,{label:"Booking Date",children:Ne(n.createdAt).format("MMM D, YYYY")}),e.jsxs(xe.Item,{label:"Exhibition Dates",children:[Ne((T=n.exhibitionId)==null?void 0:T.startDate).format("MMM D, YYYY")," -",Ne((I=n.exhibitionId)==null?void 0:I.endDate).format("MMM D, YYYY")]}),e.jsx(xe.Item,{label:"Status",children:y(n.status)}),e.jsx(xe.Item,{label:"Payment Status",children:h(n.paymentStatus||"pending")}),e.jsxs(xe.Item,{label:"Total Amount",children:["â‚¹",((j=n.amount)==null?void 0:j.toLocaleString())||"N/A"]})]}),n.rejectionReason&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(yr,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),e.jsx(Zn,{children:n.rejectionReason})]})]}),e.jsx(H,{title:"Stall Details",style:{marginBottom:20},children:e.jsx(Re,{dataSource:n.stallIds||[],columns:S,rowKey:"_id",pagination:!1})}),e.jsx(H,{title:"Calculation Summary",children:e.jsx(ie,{gutter:[16,16],children:e.jsx(M,{span:24,children:e.jsxs(xe,{bordered:!0,column:1,children:[e.jsxs(xe.Item,{label:"Base Amount",children:["â‚¹",((R=n.calculations)==null?void 0:R.totalBaseAmount.toLocaleString())||"N/A"]}),((d=n.calculations)==null?void 0:d.totalDiscountAmount)>0&&e.jsxs(xe.Item,{label:"Discount",children:["- â‚¹",((p=n.calculations)==null?void 0:p.totalDiscountAmount.toLocaleString())||"N/A"]}),((k=n.calculations)==null?void 0:k.totalDiscountAmount)>0&&e.jsxs(xe.Item,{label:"Amount After Discount",children:["â‚¹",((o=n.calculations)==null?void 0:o.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(D=(c=n.calculations)==null?void 0:c.taxes)==null?void 0:D.map(P=>e.jsxs(xe.Item,{label:`${P.name} (${P.rate}%)`,children:["+ â‚¹",P.amount.toLocaleString()||"N/A"]},P.name)),e.jsx(xe.Item,{label:"Total Amount",children:e.jsxs(Zn,{strong:!0,style:{fontSize:"16px"},children:["â‚¹",((w=n.amount)==null?void 0:w.toLocaleString())||"N/A"]})})]})})})}),e.jsx(H,{title:"Customer Information",style:{marginTop:20},children:e.jsxs(xe,{bordered:!0,column:{xs:1,sm:2},children:[e.jsx(xe.Item,{label:"Company Name",children:n.companyName}),e.jsx(xe.Item,{label:"Contact Person",children:n.customerName}),e.jsx(xe.Item,{label:"Email",children:n.customerEmail}),e.jsx(xe.Item,{label:"Phone",children:n.customerPhone})]})})]}):e.jsx(H,{children:e.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[e.jsx(yr,{level:3,children:"Booking Not Found"}),e.jsx(Zn,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),e.jsx("div",{style:{marginTop:20},children:e.jsx(_,{type:"primary",onClick:()=>s("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},Pc=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",Hi=Pc?"https://backend-exhibition-layout.a6zqlx.easypanel.host/api":"http://localhost:5000/api",Dc="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5",Ai=ss.create({baseURL:Hi}),tn=ss.create({baseURL:Hi});Ai.interceptors.request.use(t=>{const s=localStorage.getItem("exhibitor_token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));const Qt=ss.create({baseURL:Hi});Qt.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));const st={sendRegistrationOTP:async t=>await tn.post("/exhibitors/send-otp",{email:t}),verifyOTP:async t=>await tn.post("/exhibitors/verify-otp",t),register:async t=>await tn.post("/exhibitors/register",t),login:async t=>await tn.post("/exhibitors/login",t),getProfile:async()=>await Ai.get("/exhibitors/profile"),updateProfile:async t=>await Ai.put("/exhibitors/profile",t),getExhibitors:async()=>await Qt.get("/exhibitors/admin/exhibitors"),getExhibitor:async t=>await Qt.get(`/exhibitors/admin/exhibitors/${t}`),createExhibitor:async t=>await Qt.post("/exhibitors/admin/exhibitors",t),updateStatus:async(t,s,n)=>await Qt.put(`/exhibitors/admin/exhibitors/${t}/status`,{status:s,rejectionReason:n}),updateExhibitor:async(t,s)=>await Qt.put(`/exhibitors/admin/exhibitors/${t}`,s),deleteExhibitor:async t=>await Qt.delete(`/exhibitors/admin/exhibitors/${t}`)},{Title:br,Text:jr}=pe,{TabPane:vr}=at,Rc=()=>{var y;const[t]=F.useForm(),[s,n]=u.useState(!1),[i,r]=u.useState(!1),l=$e(),a=ge(h=>h.exhibitorAuth.exhibitor);u.useEffect(()=>{(async()=>{try{r(!0);const S=await st.getProfile();S.data&&l(Ei({exhibitor:S.data,token:(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||""}))}catch{ee.error("Failed to fetch exhibitor profile")}finally{r(!1)}})()},[l]),u.useEffect(()=>{a&&t.setFieldsValue({companyName:a.companyName||"",contactPerson:a.contactPerson||"",email:a.email||"",phone:a.phone||"",address:a.address||"",website:a.website||"",description:a.description||"",panNumber:a.panNumber||"",gstNumber:a.gstNumber||"",city:a.city||"",state:a.state||"",pinCode:a.pinCode||""})},[a,t]);const f=async h=>{try{n(!0);const S=await st.updateProfile(h),$=(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||"";l(Ei({exhibitor:{...a,...h},token:$})),ee.success("Profile updated successfully")}catch{ee.error("Failed to update profile")}finally{n(!1)}};return e.jsxs("div",{children:[e.jsx(br,{level:2,children:"My Profile"}),e.jsx(jr,{type:"secondary",children:"Manage your exhibitor profile information"}),e.jsx(H,{style:{marginTop:24},loading:i,children:e.jsxs(at,{defaultActiveKey:"profile",children:[e.jsx(vr,{tab:"Profile Information",children:e.jsxs(ie,{gutter:32,children:[e.jsx(M,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(gt,{size:100,icon:e.jsx(ke,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((y=a==null?void 0:a.companyName)==null?void 0:y.charAt(0).toUpperCase())||"E"}),e.jsx(br,{level:4,children:a==null?void 0:a.companyName}),e.jsx(jr,{type:"secondary",children:a==null?void 0:a.email})]})}),e.jsx(M,{span:18,children:e.jsxs(F,{form:t,layout:"vertical",onFinish:f,initialValues:{companyName:(a==null?void 0:a.companyName)||"",contactPerson:(a==null?void 0:a.contactPerson)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",address:(a==null?void 0:a.address)||"",website:(a==null?void 0:a.website)||"",description:(a==null?void 0:a.description)||"",panNumber:(a==null?void 0:a.panNumber)||"",gstNumber:(a==null?void 0:a.gstNumber)||"",city:(a==null?void 0:a.city)||"",state:(a==null?void 0:a.state)||"",pinCode:(a==null?void 0:a.pinCode)||""},children:[e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:e.jsx(W,{prefix:e.jsx($i,{}),placeholder:"Company Name"})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:e.jsx(W,{prefix:e.jsx(ke,{}),placeholder:"Contact Person"})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{prefix:e.jsx(Mt,{}),placeholder:"Email",disabled:!0})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:e.jsx(W,{prefix:e.jsx(Fi,{}),placeholder:"Phone Number"})})})]}),e.jsx(F.Item,{name:"address",label:"Address",children:e.jsx(W.TextArea,{rows:2,placeholder:"Company Address"})}),e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:8,children:e.jsx(F.Item,{name:"city",label:"City",children:e.jsx(W,{placeholder:"City"})})}),e.jsx(M,{span:8,children:e.jsx(F.Item,{name:"state",label:"State",children:e.jsx(W,{placeholder:"State"})})}),e.jsx(M,{span:8,children:e.jsx(F.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(W,{placeholder:"PIN Code",maxLength:6})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(W,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(W,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),e.jsx(F.Item,{name:"website",label:"Website",children:e.jsx(W,{placeholder:"https://www.yourcompany.com"})}),e.jsx(F.Item,{name:"description",label:"Company Description",children:e.jsx(W.TextArea,{rows:4,placeholder:"Brief description of your company"})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",loading:s,icon:e.jsx(vs,{}),children:"Save Changes"})})]})})]})},"profile"),e.jsx(vr,{tab:"Change Password",children:e.jsxs(F,{layout:"vertical",onFinish:h=>{ee.success("Password updated successfully")},children:[e.jsx(F.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(W.Password,{placeholder:"Current Password"})}),e.jsx(F.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(W.Password,{placeholder:"New Password"})}),e.jsx(F.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:h})=>({validator(S,$){return!$||h("newPassword")===$?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(W.Password,{placeholder:"Confirm New Password"})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var Lc=class extends Error{constructor(s){super(s[0].message);Zi(this,"issues");this.name="SchemaError",this.issues=s}},$a=(t=>(t.uninitialized="uninitialized",t.pending="pending",t.fulfilled="fulfilled",t.rejected="rejected",t))($a||{});function wr(t){return{status:t,isUninitialized:t==="uninitialized",isLoading:t==="pending",isSuccess:t==="fulfilled",isError:t==="rejected"}}var Sr=_s;function Fa(t,s){if(t===s||!(Sr(t)&&Sr(s)||Array.isArray(t)&&Array.isArray(s)))return s;const n=Object.keys(s),i=Object.keys(t);let r=n.length===i.length;const l=Array.isArray(s)?[]:{};for(const a of n)l[a]=Fa(t[a],s[a]),r&&(r=t[a]===l[a]);return r?t:l}function fs(t){let s=0;for(const n in t)s++;return s}var kr=t=>[].concat(...t);function $c(t){return new RegExp("(^|:)//").test(t)}function Fc(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function zn(t){return t!=null}function Bc(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var Mc=t=>t.replace(/\/$/,""),zc=t=>t.replace(/^\//,"");function Uc(t,s){if(!t)return s;if(!s)return t;if($c(s))return s;const n=t.endsWith("/")||!s.startsWith("?")?"/":"";return t=Mc(t),s=zc(s),`${t}${n}${s}`}function qc(t,s,n){return t.has(s)?t.get(s):t.set(s,n).get(s)}var Ir=(...t)=>fetch(...t),_c=t=>t.status>=200&&t.status<=299,Oc=t=>/ion\/(vnd\.api\+)?json/.test(t.get("content-type")||"");function Cr(t){if(!_s(t))return t;const s={...t};for(const[n,i]of Object.entries(s))i===void 0&&delete s[n];return s}function Wi({baseUrl:t,prepareHeaders:s=$=>$,fetchFn:n=Ir,paramsSerializer:i,isJsonContentType:r=Oc,jsonContentType:l="application/json",jsonReplacer:a,timeout:f,responseHandler:y,validateStatus:h,...S}={}){return typeof fetch>"u"&&n===Ir&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(v,T,I)=>{const{getState:j,extra:R,endpoint:d,forced:p,type:k}=T;let o,{url:c,headers:D=new Headers(S.headers),params:w=void 0,responseHandler:P=y??"json",validateStatus:g=h??_c,timeout:b=f,...L}=typeof v=="string"?{url:v}:v,N,x=T.signal;b&&(N=new AbortController,T.signal.addEventListener("abort",N.abort),x=N.signal);let E={...S,signal:x,...L};D=new Headers(Cr(D)),E.headers=await s(D,{getState:j,arg:v,extra:R,endpoint:d,forced:p,type:k,extraOptions:I})||D;const z=te=>typeof te=="object"&&(_s(te)||Array.isArray(te)||typeof te.toJSON=="function");if(!E.headers.has("content-type")&&z(E.body)&&E.headers.set("content-type",l),z(E.body)&&r(E.headers)&&(E.body=JSON.stringify(E.body,a)),w){const te=~c.indexOf("?")?"&":"?",V=i?i(w):new URLSearchParams(Cr(w));c+=te+V}c=Uc(t,c);const A=new Request(c,E);o={request:new Request(c,E)};let C,B=!1,q=N&&setTimeout(()=>{B=!0,N.abort()},b);try{C=await n(A)}catch(te){return{error:{status:B?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(te)},meta:o}}finally{q&&clearTimeout(q),N==null||N.signal.removeEventListener("abort",N.abort)}const O=C.clone();o.response=O;let Y,Z="";try{let te;if(await Promise.all([$(C,P).then(V=>Y=V,V=>te=V),O.text().then(V=>Z=V,()=>{})]),te)throw te}catch(te){return{error:{status:"PARSING_ERROR",originalStatus:C.status,data:Z,error:String(te)},meta:o}}return g(C,Y)?{data:Y,meta:o}:{error:{status:C.status,data:Y},meta:o}};async function $(v,T){if(typeof T=="function")return T(v);if(T==="content-type"&&(T=r(v.headers)?"json":"text"),T==="json"){const I=await v.text();return I.length?JSON.parse(I):null}return v.text()}}var Nr=class{constructor(t,s=void 0){this.value=t,this.meta=s}},Yi=ws("__rtkq/focused"),Ba=ws("__rtkq/unfocused"),Qi=ws("__rtkq/online"),Ma=ws("__rtkq/offline");function Qn(t){return t.type==="query"}function Vc(t){return t.type==="mutation"}function Gn(t){return t.type==="infinitequery"}function Un(t){return Qn(t)||Gn(t)}function Gi(t,s,n,i,r,l){return Hc(t)?t(s,n,i,r).filter(zn).map(Ti).map(l):Array.isArray(t)?t.map(Ti).map(l):[]}function Hc(t){return typeof t=="function"}function Ti(t){return typeof t=="string"?{type:t}:t}function Wc(t,s){return t.catch(s)}var Vs=Symbol("forceQueryFn"),Pi=t=>typeof t[Vs]=="function";function Yc({serializeQueryArgs:t,queryThunk:s,infiniteQueryThunk:n,mutationThunk:i,api:r,context:l}){const a=new Map,f=new Map,{unsubscribeQueryResult:y,removeMutationResult:h,updateSubscriptionOptions:S}=r.internalActions;return{buildInitiateQuery:R,buildInitiateInfiniteQuery:d,buildInitiateMutation:p,getRunningQueryThunk:$,getRunningMutationThunk:v,getRunningQueriesThunk:T,getRunningMutationsThunk:I};function $(k,o){return c=>{var P;const D=l.endpointDefinitions[k],w=t({queryArgs:o,endpointDefinition:D,endpointName:k});return(P=a.get(c))==null?void 0:P[w]}}function v(k,o){return c=>{var D;return(D=f.get(c))==null?void 0:D[o]}}function T(){return k=>Object.values(a.get(k)||{}).filter(zn)}function I(){return k=>Object.values(f.get(k)||{}).filter(zn)}function j(k,o){const c=(D,{subscribe:w=!0,forceRefetch:P,subscriptionOptions:g,[Vs]:b,...L}={})=>(N,x)=>{var Q;const E=t({queryArgs:D,endpointDefinition:o,endpointName:k});let z;const A={...L,type:"query",subscribe:w,forceRefetch:P,subscriptionOptions:g,endpointName:k,originalArgs:D,queryCacheKey:E,[Vs]:b};if(Qn(o))z=s(A);else{const{direction:se,initialPageParam:he}=L;z=n({...A,direction:se,initialPageParam:he})}const m=r.endpoints[k].select(D),C=N(z),B=m(x()),{requestId:q,abort:O}=C,Y=B.requestId!==q,Z=(Q=a.get(N))==null?void 0:Q[E],te=()=>m(x()),V=Object.assign(b?C.then(te):Y&&!Z?Promise.resolve(B):Promise.all([Z,C]).then(te),{arg:D,requestId:q,subscriptionOptions:g,queryCacheKey:E,abort:O,async unwrap(){const se=await V;if(se.isError)throw se.error;return se.data},refetch:()=>N(c(D,{subscribe:!1,forceRefetch:!0})),unsubscribe(){w&&N(y({queryCacheKey:E,requestId:q}))},updateSubscriptionOptions(se){V.subscriptionOptions=se,N(S({endpointName:k,requestId:q,queryCacheKey:E,options:se}))}});if(!Z&&!Y&&!b){const se=qc(a,N,{});se[E]=V,V.then(()=>{delete se[E],fs(se)||a.delete(N)})}return V};return c}function R(k,o){return j(k,o)}function d(k,o){return j(k,o)}function p(k){return(o,{track:c=!0,fixedCacheKey:D}={})=>(w,P)=>{const g=i({type:"mutation",endpointName:k,originalArgs:o,track:c,fixedCacheKey:D}),b=w(g),{requestId:L,abort:N,unwrap:x}=b,E=Wc(b.unwrap().then(C=>({data:C})),C=>({error:C})),z=()=>{w(h({requestId:L,fixedCacheKey:D}))},A=Object.assign(E,{arg:b.arg,requestId:L,abort:N,unwrap:x,reset:z}),m=f.get(w)||{};return f.set(w,m),m[L]=A,A.then(()=>{delete m[L],fs(m)||f.delete(w)}),D&&(m[D]=A,A.then(()=>{m[D]===A&&(delete m[D],fs(m)||f.delete(w))})),A}}}var za=class extends Lc{constructor(t,s,n,i){super(t),this.value=s,this.schemaName=n,this._bqMeta=i}};async function Ht(t,s,n,i){const r=await t["~standard"].validate(s);if(r.issues)throw new za(r.issues,s,n,i);return r.value}function Qc(t){return t}var Cs=(t={})=>({...t,[Sa]:!0});function Gc({reducerPath:t,baseQuery:s,context:{endpointDefinitions:n},serializeQueryArgs:i,api:r,assertTagType:l,selectors:a,onSchemaFailure:f,catchSchemaFailure:y,skipSchemaValidation:h}){const S=(L,N,x,E)=>(z,A)=>{const m=n[L],C=i({queryArgs:N,endpointDefinition:m,endpointName:L});if(z(r.internalActions.queryResultPatched({queryCacheKey:C,patches:x})),!E)return;const B=r.endpoints[L].select(N)(A()),q=Gi(m.providesTags,B.data,void 0,N,{},l);z(r.internalActions.updateProvidedBy([{queryCacheKey:C,providedTags:q}]))};function $(L,N,x=0){const E=[N,...L];return x&&E.length>x?E.slice(0,-1):E}function v(L,N,x=0){const E=[...L,N];return x&&E.length>x?E.slice(1):E}const T=(L,N,x,E=!0)=>(z,A)=>{const C=r.endpoints[L].select(N)(A()),B={patches:[],inversePatches:[],undo:()=>z(r.util.patchQueryData(L,N,B.inversePatches,E))};if(C.status==="uninitialized")return B;let q;if("data"in C)if(qo(C.data)){const[O,Y,Z]=Ia(C.data,x);B.patches.push(...Y),B.inversePatches.push(...Z),q=O}else q=x(C.data),B.patches.push({op:"replace",path:[],value:q}),B.inversePatches.push({op:"replace",path:[],value:C.data});return B.patches.length===0||z(r.util.patchQueryData(L,N,B.patches,E)),B},I=(L,N,x)=>E=>E(r.endpoints[L].initiate(N,{subscribe:!1,forceRefetch:!0,[Vs]:()=>({data:x})})),j=(L,N)=>L.query&&L[N]?L[N]:Qc,R=async(L,{signal:N,abort:x,rejectWithValue:E,fulfillWithValue:z,dispatch:A,getState:m,extra:C})=>{var Y,Z;const B=n[L.endpointName],{metaSchema:q,skipSchemaValidation:O=h}=B;try{let te=j(B,"transformResponse");const V={signal:N,abort:x,dispatch:A,getState:m,extra:C,endpoint:L.endpointName,type:L.type,forced:L.type==="query"?d(L,m()):void 0,queryCacheKey:L.type==="query"?L.queryCacheKey:void 0},Q=L.type==="query"?L[Vs]:void 0;let se;const he=async(ue,de,be,Xe)=>{if(de==null&&ue.pages.length)return Promise.resolve({data:ue});const U={queryArg:L.originalArgs,pageParam:de},X=await we(U),J=Xe?$:v;return{data:{pages:J(ue.pages,X.data,be),pageParams:J(ue.pageParams,de,be)},meta:X.meta}};async function we(ue){let de;const{extraOptions:be,argSchema:Xe,rawResponseSchema:U,responseSchema:X}=B;if(Xe&&!O&&(ue=await Ht(Xe,ue,"argSchema",{})),Q?de=Q():B.query?de=await s(B.query(ue),V,be):de=await B.queryFn(ue,V,be,ae=>s(ae,V,be)),typeof process<"u",de.error)throw new Nr(de.error,de.meta);let{data:J}=de;U&&!O&&(J=await Ht(U,de.data,"rawResponseSchema",de.meta));let re=await te(J,de.meta,ue);return X&&!O&&(re=await Ht(X,re,"responseSchema",de.meta)),{...de,data:re}}if(L.type==="query"&&"infiniteQueryOptions"in B){const{infiniteQueryOptions:ue}=B,{maxPages:de=1/0}=ue;let be;const Xe={pages:[],pageParams:[]},U=(Y=a.selectQueryEntry(m(),L.queryCacheKey))==null?void 0:Y.data,J=d(L,m())&&!L.direction||!U?Xe:U;if("direction"in L&&L.direction&&J.pages.length){const re=L.direction==="backward",ce=(re?Ua:Di)(ue,J);be=await he(J,ce,de,re)}else{const{initialPageParam:re=ue.initialPageParam}=L,ae=(U==null?void 0:U.pageParams)??[],ce=ae[0]??re,Se=ae.length;be=await he(J,ce,de),Q&&(be={data:be.data.pages[0]});for(let Be=1;Be<Se;Be++){const Ve=Di(ue,be.data);be=await he(be.data,Ve,de)}}se=be}else se=await we(L.originalArgs);return q&&!O&&se.meta&&(se.meta=await Ht(q,se.meta,"metaSchema",se.meta)),z(se.data,Cs({fulfilledTimeStamp:Date.now(),baseQueryMeta:se.meta}))}catch(te){let V=te;if(V instanceof Nr){let Q=j(B,"transformErrorResponse");const{rawErrorResponseSchema:se,errorResponseSchema:he}=B;let{value:we,meta:ue}=V;try{se&&!O&&(we=await Ht(se,we,"rawErrorResponseSchema",ue)),q&&!O&&(ue=await Ht(q,ue,"metaSchema",ue));let de=await Q(we,ue,L.originalArgs);return he&&!O&&(de=await Ht(he,de,"errorResponseSchema",ue)),E(de,Cs({baseQueryMeta:ue}))}catch(de){V=de}}try{if(V instanceof za){const Q={endpoint:L.endpointName,arg:L.originalArgs,type:L.type,queryCacheKey:L.type==="query"?L.queryCacheKey:void 0};(Z=B.onSchemaFailure)==null||Z.call(B,V,Q),f==null||f(V,Q);const{catchSchemaFailure:se=y}=B;if(se)return E(se(V,Q),Cs({baseQueryMeta:V._bqMeta}))}}catch(Q){V=Q}throw console.error(V),V}};function d(L,N){const x=a.selectQueryEntry(N,L.queryCacheKey),E=a.selectConfig(N).refetchOnMountOrArgChange,z=x==null?void 0:x.fulfilledTimeStamp,A=L.forceRefetch??(L.subscribe&&E);return A?A===!0||(Number(new Date)-Number(z))/1e3>=A:!1}const p=()=>De(`${t}/executeQuery`,R,{getPendingMeta({arg:N}){const x=n[N.endpointName];return Cs({startedTimeStamp:Date.now(),...Gn(x)?{direction:N.direction}:{}})},condition(N,{getState:x}){var O;const E=x(),z=a.selectQueryEntry(E,N.queryCacheKey),A=z==null?void 0:z.fulfilledTimeStamp,m=N.originalArgs,C=z==null?void 0:z.originalArgs,B=n[N.endpointName],q=N.direction;return Pi(N)?!0:(z==null?void 0:z.status)==="pending"?!1:d(N,E)||Qn(B)&&((O=B==null?void 0:B.forceRefetch)!=null&&O.call(B,{currentArg:m,previousArg:C,endpointState:z,state:E}))?!0:!(A&&!q)},dispatchConditionRejection:!0}),k=p(),o=p(),c=De(`${t}/executeMutation`,R,{getPendingMeta(){return Cs({startedTimeStamp:Date.now()})}}),D=L=>"force"in L,w=L=>"ifOlderThan"in L,P=(L,N,x)=>(E,z)=>{const A=D(x)&&x.force,m=w(x)&&x.ifOlderThan,C=(q=!0)=>{const O={forceRefetch:q,isPrefetch:!0};return r.endpoints[L].initiate(N,O)},B=r.endpoints[L].select(N)(z());if(A)E(C());else if(m){const q=B==null?void 0:B.fulfilledTimeStamp;if(!q){E(C());return}(Number(new Date)-Number(new Date(q)))/1e3>=m&&E(C())}else E(C(!1))};function g(L){return N=>{var x,E;return((E=(x=N==null?void 0:N.meta)==null?void 0:x.arg)==null?void 0:E.endpointName)===L}}function b(L,N){return{matchPending:Xn(ka(L),g(N)),matchFulfilled:Xn(es(L),g(N)),matchRejected:Xn(_i(L),g(N))}}return{queryThunk:k,mutationThunk:c,infiniteQueryThunk:o,prefetch:P,updateQueryData:T,upsertQueryData:I,patchQueryData:S,buildMatchThunkActions:b}}function Di(t,{pages:s,pageParams:n}){const i=s.length-1;return t.getNextPageParam(s[i],s,n[i],n)}function Ua(t,{pages:s,pageParams:n}){var i;return(i=t.getPreviousPageParam)==null?void 0:i.call(t,s[0],s,n[0],n)}function qa(t,s,n,i){return Gi(n[t.meta.arg.endpointName][s],es(t)?t.payload:void 0,qi(t)?t.payload:void 0,t.meta.arg.originalArgs,"baseQueryMeta"in t.meta?t.meta.baseQueryMeta:void 0,i)}function sn(t,s,n){const i=t[s];i&&n(i)}function Hs(t){return("arg"in t?t.arg.fixedCacheKey:t.fixedCacheKey)??t.requestId}function Er(t,s,n){const i=t[Hs(s)];i&&n(i)}var nn={};function Kc({reducerPath:t,queryThunk:s,mutationThunk:n,serializeQueryArgs:i,context:{endpointDefinitions:r,apiUid:l,extractRehydrationInfo:a,hasRehydrationInfo:f},assertTagType:y,config:h}){const S=ws(`${t}/resetApiState`);function $(g,b,L,N){var x;g[x=b.queryCacheKey]??(g[x]={status:"uninitialized",endpointName:b.endpointName}),sn(g,b.queryCacheKey,E=>{E.status="pending",E.requestId=L&&E.requestId?E.requestId:N.requestId,b.originalArgs!==void 0&&(E.originalArgs=b.originalArgs),E.startedTimeStamp=N.startedTimeStamp;const z=r[N.arg.endpointName];Gn(z)&&"direction"in b&&(E.direction=b.direction)})}function v(g,b,L,N){sn(g,b.arg.queryCacheKey,x=>{if(x.requestId!==b.requestId&&!N)return;const{merge:E}=r[b.arg.endpointName];if(x.status="fulfilled",E)if(x.data!==void 0){const{fulfilledTimeStamp:z,arg:A,baseQueryMeta:m,requestId:C}=b;let B=Ui(x.data,q=>E(q,L,{arg:A.originalArgs,baseQueryMeta:m,fulfilledTimeStamp:z,requestId:C}));x.data=B}else x.data=L;else x.data=r[b.arg.endpointName].structuralSharing??!0?Fa(Oo(x.data)?Vo(x.data):x.data,L):L;delete x.error,x.fulfilledTimeStamp=b.fulfilledTimeStamp})}const T=ct({name:`${t}/queries`,initialState:nn,reducers:{removeQueryResult:{reducer(g,{payload:{queryCacheKey:b}}){delete g[b]},prepare:Is()},cacheEntriesUpserted:{reducer(g,b){for(const L of b.payload){const{queryDescription:N,value:x}=L;$(g,N,!0,{arg:N,requestId:b.meta.requestId,startedTimeStamp:b.meta.timestamp}),v(g,{arg:N,requestId:b.meta.requestId,fulfilledTimeStamp:b.meta.timestamp,baseQueryMeta:{}},x,!0)}},prepare:g=>({payload:g.map(N=>{const{endpointName:x,arg:E,value:z}=N,A=r[x];return{queryDescription:{type:"query",endpointName:x,originalArgs:N.arg,queryCacheKey:i({queryArgs:E,endpointDefinition:A,endpointName:x})},value:z}}),meta:{[Sa]:!0,requestId:ja(),timestamp:Date.now()}})},queryResultPatched:{reducer(g,{payload:{queryCacheKey:b,patches:L}}){sn(g,b,N=>{N.data=ar(N.data,L.concat())})},prepare:Is()}},extraReducers(g){g.addCase(s.pending,(b,{meta:L,meta:{arg:N}})=>{const x=Pi(N);$(b,N,x,L)}).addCase(s.fulfilled,(b,{meta:L,payload:N})=>{const x=Pi(L.arg);v(b,L,N,x)}).addCase(s.rejected,(b,{meta:{condition:L,arg:N,requestId:x},error:E,payload:z})=>{sn(b,N.queryCacheKey,A=>{if(!L){if(A.requestId!==x)return;A.status="rejected",A.error=z??E}})}).addMatcher(f,(b,L)=>{const{queries:N}=a(L);for(const[x,E]of Object.entries(N))((E==null?void 0:E.status)==="fulfilled"||(E==null?void 0:E.status)==="rejected")&&(b[x]=E)})}}),I=ct({name:`${t}/mutations`,initialState:nn,reducers:{removeMutationResult:{reducer(g,{payload:b}){const L=Hs(b);L in g&&delete g[L]},prepare:Is()}},extraReducers(g){g.addCase(n.pending,(b,{meta:L,meta:{requestId:N,arg:x,startedTimeStamp:E}})=>{x.track&&(b[Hs(L)]={requestId:N,status:"pending",endpointName:x.endpointName,startedTimeStamp:E})}).addCase(n.fulfilled,(b,{payload:L,meta:N})=>{N.arg.track&&Er(b,N,x=>{x.requestId===N.requestId&&(x.status="fulfilled",x.data=L,x.fulfilledTimeStamp=N.fulfilledTimeStamp)})}).addCase(n.rejected,(b,{payload:L,error:N,meta:x})=>{x.arg.track&&Er(b,x,E=>{E.requestId===x.requestId&&(E.status="rejected",E.error=L??N)})}).addMatcher(f,(b,L)=>{const{mutations:N}=a(L);for(const[x,E]of Object.entries(N))((E==null?void 0:E.status)==="fulfilled"||(E==null?void 0:E.status)==="rejected")&&x!==(E==null?void 0:E.requestId)&&(b[x]=E)})}}),j={tags:{},keys:{}},R=ct({name:`${t}/invalidation`,initialState:j,reducers:{updateProvidedBy:{reducer(g,b){var L,N,x;for(const{queryCacheKey:E,providedTags:z}of b.payload){d(g,E);for(const{type:A,id:m}of z){const C=(N=(L=g.tags)[A]??(L[A]={}))[x=m||"__internal_without_id"]??(N[x]=[]);C.includes(E)||C.push(E)}g.keys[E]=z}},prepare:Is()}},extraReducers(g){g.addCase(T.actions.removeQueryResult,(b,{payload:{queryCacheKey:L}})=>{d(b,L)}).addMatcher(f,(b,L)=>{var x,E,z;const{provided:N}=a(L);for(const[A,m]of Object.entries(N))for(const[C,B]of Object.entries(m)){const q=(E=(x=b.tags)[A]??(x[A]={}))[z=C||"__internal_without_id"]??(E[z]=[]);for(const O of B)q.includes(O)||q.push(O)}}).addMatcher(Fn(es(s),qi(s)),(b,L)=>{p(b,[L])}).addMatcher(T.actions.cacheEntriesUpserted.match,(b,L)=>{const N=L.payload.map(({queryDescription:x,value:E})=>({type:"UNKNOWN",payload:E,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:x}}));p(b,N)})}});function d(g,b){var N;const L=g.keys[b]??[];for(const x of L){const E=x.type,z=x.id??"__internal_without_id",A=(N=g.tags[E])==null?void 0:N[z];A&&(g.tags[E][z]=A.filter(m=>m!==b))}delete g.keys[b]}function p(g,b){const L=b.map(N=>{const x=qa(N,"providesTags",r,y),{queryCacheKey:E}=N.meta.arg;return{queryCacheKey:E,providedTags:x}});R.caseReducers.updateProvidedBy(g,R.actions.updateProvidedBy(L))}const k=ct({name:`${t}/subscriptions`,initialState:nn,reducers:{updateSubscriptionOptions(g,b){},unsubscribeQueryResult(g,b){},internal_getRTKQSubscriptions(){}}}),o=ct({name:`${t}/internalSubscriptions`,initialState:nn,reducers:{subscriptionsUpdated:{reducer(g,b){return ar(g,b.payload)},prepare:Is()}}}),c=ct({name:`${t}/config`,initialState:{online:Bc(),focused:Fc(),middlewareRegistered:!1,...h},reducers:{middlewareRegistered(g,{payload:b}){g.middlewareRegistered=g.middlewareRegistered==="conflict"||l!==b?"conflict":!0}},extraReducers:g=>{g.addCase(Qi,b=>{b.online=!0}).addCase(Ma,b=>{b.online=!1}).addCase(Yi,b=>{b.focused=!0}).addCase(Ba,b=>{b.focused=!1}).addMatcher(f,b=>({...b}))}}),D=Uo({queries:T.reducer,mutations:I.reducer,provided:R.reducer,subscriptions:o.reducer,config:c.reducer}),w=(g,b)=>D(S.match(b)?void 0:g,b),P={...c.actions,...T.actions,...k.actions,...o.actions,...I.actions,...R.actions,resetApiState:S};return{reducer:w,actions:P}}var xt=Symbol.for("RTKQ/skipToken"),_a={status:"uninitialized"},Ar=Ui(_a,()=>{}),Tr=Ui(_a,()=>{});function Xc({serializeQueryArgs:t,reducerPath:s,createSelector:n}){const i=k=>Ar,r=k=>Tr;return{buildQuerySelector:v,buildInfiniteQuerySelector:T,buildMutationSelector:I,selectInvalidatedBy:j,selectCachedArgsForQuery:R,selectApiState:a,selectQueries:f,selectMutations:h,selectQueryEntry:y,selectConfig:S};function l(k){return{...k,...wr(k.status)}}function a(k){return k[s]}function f(k){var o;return(o=a(k))==null?void 0:o.queries}function y(k,o){var c;return(c=f(k))==null?void 0:c[o]}function h(k){var o;return(o=a(k))==null?void 0:o.mutations}function S(k){var o;return(o=a(k))==null?void 0:o.config}function $(k,o,c){return D=>{if(D===xt)return n(i,c);const w=t({queryArgs:D,endpointDefinition:o,endpointName:k});return n(g=>y(g,w)??Ar,c)}}function v(k,o){return $(k,o,l)}function T(k,o){const{infiniteQueryOptions:c}=o;function D(w){const P={...w,...wr(w.status)},{isLoading:g,isError:b,direction:L}=P,N=L==="forward",x=L==="backward";return{...P,hasNextPage:d(c,P.data),hasPreviousPage:p(c,P.data),isFetchingNextPage:g&&N,isFetchingPreviousPage:g&&x,isFetchNextPageError:b&&N,isFetchPreviousPageError:b&&x}}return $(k,o,D)}function I(){return k=>{let o;return typeof k=="object"?o=Hs(k)??xt:o=k,n(o===xt?r:w=>{var P,g;return((g=(P=a(w))==null?void 0:P.mutations)==null?void 0:g[o])??Tr},l)}}function j(k,o){const c=k[s],D=new Set;for(const w of o.filter(zn).map(Ti)){const P=c.provided.tags[w.type];if(!P)continue;let g=(w.id!==void 0?P[w.id]:kr(Object.values(P)))??[];for(const b of g)D.add(b)}return kr(Array.from(D.values()).map(w=>{const P=c.queries[w];return P?[{queryCacheKey:w,endpointName:P.endpointName,originalArgs:P.originalArgs}]:[]}))}function R(k,o){return Object.values(f(k)).filter(c=>(c==null?void 0:c.endpointName)===o&&c.status!=="uninitialized").map(c=>c.originalArgs)}function d(k,o){return o?Di(k,o)!=null:!1}function p(k,o){return!o||!k.getPreviousPageParam?!1:Ua(k,o)!=null}}var os=WeakMap?new WeakMap:void 0,qn=({endpointName:t,queryArgs:s})=>{let n="";const i=os==null?void 0:os.get(s);if(typeof i=="string")n=i;else{const r=JSON.stringify(s,(l,a)=>(a=typeof a=="bigint"?{$bigint:a.toString()}:a,a=_s(a)?Object.keys(a).sort().reduce((f,y)=>(f[y]=a[y],f),{}):a,a));_s(s)&&(os==null||os.set(s,r)),n=r}return`${t}(${n})`};function Oa(...t){return function(n){const i=rr(h=>{var S;return(S=n.extractRehydrationInfo)==null?void 0:S.call(n,h,{reducerPath:n.reducerPath??"api"})}),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...n,extractRehydrationInfo:i,serializeQueryArgs(h){let S=qn;if("serializeQueryArgs"in h.endpointDefinition){const $=h.endpointDefinition.serializeQueryArgs;S=v=>{const T=$(v);return typeof T=="string"?T:qn({...v,queryArgs:T})}}else n.serializeQueryArgs&&(S=n.serializeQueryArgs);return S(h)},tagTypes:[...n.tagTypes||[]]},l={endpointDefinitions:{},batch(h){h()},apiUid:ja(),extractRehydrationInfo:i,hasRehydrationInfo:rr(h=>i(h)!=null)},a={injectEndpoints:y,enhanceEndpoints({addTagTypes:h,endpoints:S}){if(h)for(const $ of h)r.tagTypes.includes($)||r.tagTypes.push($);if(S)for(const[$,v]of Object.entries(S))typeof v=="function"?v(l.endpointDefinitions[$]):Object.assign(l.endpointDefinitions[$]||{},v);return a}},f=t.map(h=>h.init(a,r,l));function y(h){const S=h.endpoints({query:$=>({...$,type:"query"}),mutation:$=>({...$,type:"mutation"}),infiniteQuery:$=>({...$,type:"infinitequery"})});for(const[$,v]of Object.entries(S)){if(h.overrideExisting!==!0&&$ in l.endpointDefinitions){if(h.overrideExisting==="throw")throw new Error(va(39));continue}l.endpointDefinitions[$]=v;for(const T of f)T.injectEndpoint($,v)}return a}return a.injectEndpoints({endpoints:n.endpoints})}}function Tt(t,...s){return Object.assign(t,...s)}var Zc=({api:t,queryThunk:s,internalState:n})=>{const i=`${t.reducerPath}/subscriptions`;let r=null,l=null;const{updateSubscriptionOptions:a,unsubscribeQueryResult:f}=t.internalActions,y=(T,I)=>{var R,d,p;if(a.match(I)){const{queryCacheKey:k,requestId:o,options:c}=I.payload;return(R=T==null?void 0:T[k])!=null&&R[o]&&(T[k][o]=c),!0}if(f.match(I)){const{queryCacheKey:k,requestId:o}=I.payload;return T[k]&&delete T[k][o],!0}if(t.internalActions.removeQueryResult.match(I))return delete T[I.payload.queryCacheKey],!0;if(s.pending.match(I)){const{meta:{arg:k,requestId:o}}=I,c=T[d=k.queryCacheKey]??(T[d]={});return c[`${o}_running`]={},k.subscribe&&(c[o]=k.subscriptionOptions??c[o]??{}),!0}let j=!1;if(s.fulfilled.match(I)||s.rejected.match(I)){const k=T[I.meta.arg.queryCacheKey]||{},o=`${I.meta.requestId}_running`;j||(j=!!k[o]),delete k[o]}if(s.rejected.match(I)){const{meta:{condition:k,arg:o,requestId:c}}=I;if(k&&o.subscribe){const D=T[p=o.queryCacheKey]??(T[p]={});D[c]=o.subscriptionOptions??D[c]??{},j=!0}}return j},h=()=>n.currentSubscriptions,v={getSubscriptions:h,getSubscriptionCount:T=>{const j=h()[T]??{};return fs(j)},isRequestSubscribed:(T,I)=>{var R;const j=h();return!!((R=j==null?void 0:j[T])!=null&&R[I])}};return(T,I)=>{if(r||(r=JSON.parse(JSON.stringify(n.currentSubscriptions))),t.util.resetApiState.match(T))return r=n.currentSubscriptions={},l=null,[!0,!1];if(t.internalActions.internal_getRTKQSubscriptions.match(T))return[!1,v];const j=y(n.currentSubscriptions,T);let R=!0;if(j){l||(l=setTimeout(()=>{const k=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,o]=Ia(r,()=>k);I.next(t.internalActions.subscriptionsUpdated(o)),r=k,l=null},500));const d=typeof T.type=="string"&&!!T.type.startsWith(i),p=s.rejected.match(T)&&T.meta.condition&&!!T.meta.arg.subscribe;R=!d&&!p}return[R,!1]}};function Jc(t){for(const s in t)return!1;return!0}var ed=2147483647/1e3-1,td=({reducerPath:t,api:s,queryThunk:n,context:i,internalState:r,selectors:{selectQueryEntry:l,selectConfig:a}})=>{const{removeQueryResult:f,unsubscribeQueryResult:y,cacheEntriesUpserted:h}=s.internalActions,S=Fn(y.match,n.fulfilled,n.rejected,h.match);function $(R){const d=r.currentSubscriptions[R];return!!d&&!Jc(d)}const v={},T=(R,d,p)=>{const k=d.getState(),o=a(k);if(S(R)){let c;if(h.match(R))c=R.payload.map(D=>D.queryDescription.queryCacheKey);else{const{queryCacheKey:D}=y.match(R)?R.payload:R.meta.arg;c=[D]}I(c,d,o)}if(s.util.resetApiState.match(R))for(const[c,D]of Object.entries(v))D&&clearTimeout(D),delete v[c];if(i.hasRehydrationInfo(R)){const{queries:c}=i.extractRehydrationInfo(R);I(Object.keys(c),d,o)}};function I(R,d,p){const k=d.getState();for(const o of R){const c=l(k,o);j(o,c==null?void 0:c.endpointName,d,p)}}function j(R,d,p,k){const o=i.endpointDefinitions[d],c=(o==null?void 0:o.keepUnusedDataFor)??k.keepUnusedDataFor;if(c===1/0)return;const D=Math.max(0,Math.min(c,ed));if(!$(R)){const w=v[R];w&&clearTimeout(w),v[R]=setTimeout(()=>{$(R)||p.dispatch(f({queryCacheKey:R})),delete v[R]},D*1e3)}}return T},Pr=new Error("Promise never resolved before cacheEntryRemoved."),sd=({api:t,reducerPath:s,context:n,queryThunk:i,mutationThunk:r,internalState:l,selectors:{selectQueryEntry:a,selectApiState:f}})=>{const y=or(i),h=or(r),S=es(i,r),$={};function v(d,p,k){const o=$[d];o!=null&&o.valueResolved&&(o.valueResolved({data:p,meta:k}),delete o.valueResolved)}function T(d){const p=$[d];p&&(delete $[d],p.cacheEntryRemoved())}const I=(d,p,k)=>{const o=j(d);function c(D,w,P,g){const b=a(k,w),L=a(p.getState(),w);!b&&L&&R(D,g,w,p,P)}if(i.pending.match(d))c(d.meta.arg.endpointName,o,d.meta.requestId,d.meta.arg.originalArgs);else if(t.internalActions.cacheEntriesUpserted.match(d))for(const{queryDescription:D,value:w}of d.payload){const{endpointName:P,originalArgs:g,queryCacheKey:b}=D;c(P,b,d.meta.requestId,g),v(b,w,{})}else if(r.pending.match(d))p.getState()[s].mutations[o]&&R(d.meta.arg.endpointName,d.meta.arg.originalArgs,o,p,d.meta.requestId);else if(S(d))v(o,d.payload,d.meta.baseQueryMeta);else if(t.internalActions.removeQueryResult.match(d)||t.internalActions.removeMutationResult.match(d))T(o);else if(t.util.resetApiState.match(d))for(const D of Object.keys($))T(D)};function j(d){return y(d)?d.meta.arg.queryCacheKey:h(d)?d.meta.arg.fixedCacheKey??d.meta.requestId:t.internalActions.removeQueryResult.match(d)?d.payload.queryCacheKey:t.internalActions.removeMutationResult.match(d)?Hs(d.payload):""}function R(d,p,k,o,c){const D=n.endpointDefinitions[d],w=D==null?void 0:D.onCacheEntryAdded;if(!w)return;const P={},g=new Promise(z=>{P.cacheEntryRemoved=z}),b=Promise.race([new Promise(z=>{P.valueResolved=z}),g.then(()=>{throw Pr})]);b.catch(()=>{}),$[k]=P;const L=t.endpoints[d].select(Un(D)?p:k),N=o.dispatch((z,A,m)=>m),x={...o,getCacheEntry:()=>L(o.getState()),requestId:c,extra:N,updateCachedData:Un(D)?z=>o.dispatch(t.util.updateQueryData(d,p,z)):void 0,cacheDataLoaded:b,cacheEntryRemoved:g},E=w(p,x);Promise.resolve(E).catch(z=>{if(z!==Pr)throw z})}return I},nd=({api:t,context:{apiUid:s},reducerPath:n})=>(i,r)=>{t.util.resetApiState.match(i)&&r.dispatch(t.internalActions.middlewareRegistered(s))},id=({reducerPath:t,context:s,context:{endpointDefinitions:n},mutationThunk:i,queryThunk:r,api:l,assertTagType:a,refetchQuery:f,internalState:y})=>{const{removeQueryResult:h}=l.internalActions,S=Fn(es(i),qi(i)),$=Fn(es(i,r),_i(i,r));let v=[];const T=(R,d)=>{S(R)?j(qa(R,"invalidatesTags",n,a),d):$(R)?j([],d):l.util.invalidateTags.match(R)&&j(Gi(R.payload,void 0,void 0,void 0,void 0,a),d)};function I(R){var k;const{queries:d,mutations:p}=R;for(const o of[d,p])for(const c in o)if(((k=o[c])==null?void 0:k.status)==="pending")return!0;return!1}function j(R,d){const p=d.getState(),k=p[t];if(v.push(...R),k.config.invalidationBehavior==="delayed"&&I(k))return;const o=v;if(v=[],o.length===0)return;const c=l.util.selectInvalidatedBy(p,o);s.batch(()=>{const D=Array.from(c.values());for(const{queryCacheKey:w}of D){const P=k.queries[w],g=y.currentSubscriptions[w]??{};P&&(fs(g)===0?d.dispatch(h({queryCacheKey:w})):P.status!=="uninitialized"&&d.dispatch(f(P)))}})}return T},rd=({reducerPath:t,queryThunk:s,api:n,refetchQuery:i,internalState:r})=>{const l={},a=(v,T)=>{(n.internalActions.updateSubscriptionOptions.match(v)||n.internalActions.unsubscribeQueryResult.match(v))&&y(v.payload,T),(s.pending.match(v)||s.rejected.match(v)&&v.meta.condition)&&y(v.meta.arg,T),(s.fulfilled.match(v)||s.rejected.match(v)&&!v.meta.condition)&&f(v.meta.arg,T),n.util.resetApiState.match(v)&&S()};function f({queryCacheKey:v},T){const I=T.getState()[t],j=I.queries[v],R=r.currentSubscriptions[v];if(!j||j.status==="uninitialized")return;const{lowestPollingInterval:d,skipPollingIfUnfocused:p}=$(R);if(!Number.isFinite(d))return;const k=l[v];k!=null&&k.timeout&&(clearTimeout(k.timeout),k.timeout=void 0);const o=Date.now()+d;l[v]={nextPollTimestamp:o,pollingInterval:d,timeout:setTimeout(()=>{(I.config.focused||!p)&&T.dispatch(i(j)),f({queryCacheKey:v},T)},d)}}function y({queryCacheKey:v},T){const j=T.getState()[t].queries[v],R=r.currentSubscriptions[v];if(!j||j.status==="uninitialized")return;const{lowestPollingInterval:d}=$(R);if(!Number.isFinite(d)){h(v);return}const p=l[v],k=Date.now()+d;(!p||k<p.nextPollTimestamp)&&f({queryCacheKey:v},T)}function h(v){const T=l[v];T!=null&&T.timeout&&clearTimeout(T.timeout),delete l[v]}function S(){for(const v of Object.keys(l))h(v)}function $(v={}){let T=!1,I=Number.POSITIVE_INFINITY;for(let j in v)v[j].pollingInterval&&(I=Math.min(v[j].pollingInterval,I),T=v[j].skipPollingIfUnfocused||T);return{lowestPollingInterval:I,skipPollingIfUnfocused:T}}return a},ad=({api:t,context:s,queryThunk:n,mutationThunk:i})=>{const r=ka(n,i),l=_i(n,i),a=es(n,i),f={};return(h,S)=>{var $,v;if(r(h)){const{requestId:T,arg:{endpointName:I,originalArgs:j}}=h.meta,R=s.endpointDefinitions[I],d=R==null?void 0:R.onQueryStarted;if(d){const p={},k=new Promise((w,P)=>{p.resolve=w,p.reject=P});k.catch(()=>{}),f[T]=p;const o=t.endpoints[I].select(Un(R)?j:T),c=S.dispatch((w,P,g)=>g),D={...S,getCacheEntry:()=>o(S.getState()),requestId:T,extra:c,updateCachedData:Un(R)?w=>S.dispatch(t.util.updateQueryData(I,j,w)):void 0,queryFulfilled:k};d(j,D)}}else if(a(h)){const{requestId:T,baseQueryMeta:I}=h.meta;($=f[T])==null||$.resolve({data:h.payload,meta:I}),delete f[T]}else if(l(h)){const{requestId:T,rejectedWithValue:I,baseQueryMeta:j}=h.meta;(v=f[T])==null||v.reject({error:h.payload??h.error,isUnhandledError:!I,meta:j}),delete f[T]}}},od=({reducerPath:t,context:s,api:n,refetchQuery:i,internalState:r})=>{const{removeQueryResult:l}=n.internalActions,a=(y,h)=>{Yi.match(y)&&f(h,"refetchOnFocus"),Qi.match(y)&&f(h,"refetchOnReconnect")};function f(y,h){const S=y.getState()[t],$=S.queries,v=r.currentSubscriptions;s.batch(()=>{for(const T of Object.keys(v)){const I=$[T],j=v[T];if(!j||!I)continue;(Object.values(j).some(d=>d[h]===!0)||Object.values(j).every(d=>d[h]===void 0)&&S.config[h])&&(fs(j)===0?y.dispatch(l({queryCacheKey:T})):I.status!=="uninitialized"&&y.dispatch(i(I)))}})}return a};function ld(t){const{reducerPath:s,queryThunk:n,api:i,context:r}=t,{apiUid:l}=r,a={invalidateTags:ws(`${s}/invalidateTags`)},f=$=>$.type.startsWith(`${s}/`),y=[nd,td,id,rd,sd,ad];return{middleware:$=>{let v=!1;const I={...t,internalState:{currentSubscriptions:{}},refetchQuery:S,isThisApiSliceAction:f},j=y.map(p=>p(I)),R=Zc(I),d=od(I);return p=>k=>{if(!_o(k))return p(k);v||(v=!0,$.dispatch(i.internalActions.middlewareRegistered(l)));const o={...$,next:p},c=$.getState(),[D,w]=R(k,o,c);let P;if(D?P=p(k):P=w,$.getState()[s]&&(d(k,o,c),f(k)||r.hasRehydrationInfo(k)))for(const g of j)g(k,o,c);return P}},actions:a};function S($){return t.api.endpoints[$.endpointName].initiate($.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Dr=Symbol(),Va=({createSelector:t=wa}={})=>({name:Dr,init(s,{baseQuery:n,tagTypes:i,reducerPath:r,serializeQueryArgs:l,keepUnusedDataFor:a,refetchOnMountOrArgChange:f,refetchOnFocus:y,refetchOnReconnect:h,invalidationBehavior:S,onSchemaFailure:$,catchSchemaFailure:v,skipSchemaValidation:T},I){zo();const j=V=>V;Object.assign(s,{reducerPath:r,endpoints:{},internalActions:{onOnline:Qi,onOffline:Ma,onFocus:Yi,onFocusLost:Ba},util:{}});const R=Xc({serializeQueryArgs:l,reducerPath:r,createSelector:t}),{selectInvalidatedBy:d,selectCachedArgsForQuery:p,buildQuerySelector:k,buildInfiniteQuerySelector:o,buildMutationSelector:c}=R;Tt(s.util,{selectInvalidatedBy:d,selectCachedArgsForQuery:p});const{queryThunk:D,infiniteQueryThunk:w,mutationThunk:P,patchQueryData:g,updateQueryData:b,upsertQueryData:L,prefetch:N,buildMatchThunkActions:x}=Gc({baseQuery:n,reducerPath:r,context:I,api:s,serializeQueryArgs:l,assertTagType:j,selectors:R,onSchemaFailure:$,catchSchemaFailure:v,skipSchemaValidation:T}),{reducer:E,actions:z}=Kc({context:I,queryThunk:D,mutationThunk:P,serializeQueryArgs:l,reducerPath:r,assertTagType:j,config:{refetchOnFocus:y,refetchOnReconnect:h,refetchOnMountOrArgChange:f,keepUnusedDataFor:a,reducerPath:r,invalidationBehavior:S}});Tt(s.util,{patchQueryData:g,updateQueryData:b,upsertQueryData:L,prefetch:N,resetApiState:z.resetApiState,upsertQueryEntries:z.cacheEntriesUpserted}),Tt(s.internalActions,z);const{middleware:A,actions:m}=ld({reducerPath:r,context:I,queryThunk:D,mutationThunk:P,infiniteQueryThunk:w,api:s,assertTagType:j,selectors:R});Tt(s.util,m),Tt(s,{reducer:E,middleware:A});const{buildInitiateQuery:C,buildInitiateInfiniteQuery:B,buildInitiateMutation:q,getRunningMutationThunk:O,getRunningMutationsThunk:Y,getRunningQueriesThunk:Z,getRunningQueryThunk:te}=Yc({queryThunk:D,mutationThunk:P,infiniteQueryThunk:w,api:s,serializeQueryArgs:l,context:I});return Tt(s.util,{getRunningMutationThunk:O,getRunningMutationsThunk:Y,getRunningQueryThunk:te,getRunningQueriesThunk:Z}),{name:Dr,injectEndpoint(V,Q){var we;const he=(we=s.endpoints)[V]??(we[V]={});Qn(Q)&&Tt(he,{name:V,select:k(V,Q),initiate:C(V,Q)},x(D,V)),Vc(Q)&&Tt(he,{name:V,select:c(),initiate:q(V)},x(P,V)),Gn(Q)&&Tt(he,{name:V,select:o(V,Q),initiate:B(V,Q)},x(D,V))}}}});Va();function rn(t){return t.replace(t[0],t[0].toUpperCase())}function cd(t){return t.type==="query"}function dd(t){return t.type==="mutation"}function Ha(t){return t.type==="infinitequery"}function Ns(t,...s){return Object.assign(t,...s)}var Jn=Symbol();function ei(t,s,n,i){const r=u.useMemo(()=>({queryArgs:t,serialized:typeof t=="object"?s({queryArgs:t,endpointDefinition:n,endpointName:i}):t}),[t,s,n,i]),l=u.useRef(r);return u.useEffect(()=>{l.current.serialized!==r.serialized&&(l.current=r)},[r]),l.current.serialized===r.serialized?l.current.queryArgs:t}function an(t){const s=u.useRef(t);return u.useEffect(()=>{Ps(s.current,t)||(s.current=t)},[t]),Ps(s.current,t)?s.current:t}var ud=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",hd=ud(),xd=()=>typeof navigator<"u"&&navigator.product==="ReactNative",pd=xd(),md=()=>hd||pd?u.useLayoutEffect:u.useEffect,gd=md(),Rr=t=>t.isUninitialized?{...t,isUninitialized:!1,isFetching:!0,isLoading:t.data===void 0,status:$a.pending}:t;function ti(t,...s){const n={};return s.forEach(i=>{n[i]=t[i]}),n}var si=["data","status","isLoading","isSuccess","isError","error"];function fd({api:t,moduleOptions:{batch:s,hooks:{useDispatch:n,useSelector:i,useStore:r},unstable__sideEffectsInRender:l,createSelector:a},serializeQueryArgs:f,context:y}){const h=l?o=>o():u.useEffect;return{buildQueryHooks:d,buildInfiniteQueryHooks:p,buildMutationHook:k,usePrefetch:v};function S(o,c,D){if(c!=null&&c.endpointName&&o.isUninitialized){const{endpointName:N}=c,x=y.endpointDefinitions[N];D!==xt&&f({queryArgs:c.originalArgs,endpointDefinition:x,endpointName:N})===f({queryArgs:D,endpointDefinition:x,endpointName:N})&&(c=void 0)}let w=o.isSuccess?o.data:c==null?void 0:c.data;w===void 0&&(w=o.data);const P=w!==void 0,g=o.isLoading,b=(!c||c.isLoading||c.isUninitialized)&&!P&&g,L=o.isSuccess||P&&(g&&!(c!=null&&c.isError)||o.isUninitialized);return{...o,data:w,currentData:o.data,isFetching:g,isLoading:b,isSuccess:L}}function $(o,c,D){if(c!=null&&c.endpointName&&o.isUninitialized){const{endpointName:N}=c,x=y.endpointDefinitions[N];D!==xt&&f({queryArgs:c.originalArgs,endpointDefinition:x,endpointName:N})===f({queryArgs:D,endpointDefinition:x,endpointName:N})&&(c=void 0)}let w=o.isSuccess?o.data:c==null?void 0:c.data;w===void 0&&(w=o.data);const P=w!==void 0,g=o.isLoading,b=(!c||c.isLoading||c.isUninitialized)&&!P&&g,L=o.isSuccess||g&&P;return{...o,data:w,currentData:o.data,isFetching:g,isLoading:b,isSuccess:L}}function v(o,c){const D=n(),w=an(c);return u.useCallback((P,g)=>D(t.util.prefetch(o,P,{...w,...g})),[o,D,w])}function T(o,c,{refetchOnReconnect:D,refetchOnFocus:w,refetchOnMountOrArgChange:P,skip:g=!1,pollingInterval:b=0,skipPollingIfUnfocused:L=!1,...N}={}){const{initiate:x}=t.endpoints[o],E=n(),z=u.useRef(void 0);if(!z.current){const V=E(t.internalActions.internal_getRTKQSubscriptions());z.current=V}const A=ei(g?xt:c,qn,y.endpointDefinitions[o],o),m=an({refetchOnReconnect:D,refetchOnFocus:w,pollingInterval:b,skipPollingIfUnfocused:L}),C=N.initialPageParam,B=an(C),q=u.useRef(void 0);let{queryCacheKey:O,requestId:Y}=q.current||{},Z=!1;O&&Y&&(Z=z.current.isRequestSubscribed(O,Y));const te=!Z&&q.current!==void 0;return h(()=>{te&&(q.current=void 0)},[te]),h(()=>{var se;const V=q.current;if(A===xt){V==null||V.unsubscribe(),q.current=void 0;return}const Q=(se=q.current)==null?void 0:se.subscriptionOptions;if(!V||V.arg!==A){V==null||V.unsubscribe();const he=E(x(A,{subscriptionOptions:m,forceRefetch:P,...Ha(y.endpointDefinitions[o])?{initialPageParam:B}:{}}));q.current=he}else m!==Q&&V.updateSubscriptionOptions(m)},[E,x,P,A,m,te,B,o]),[q,E,x,m]}function I(o,c){return(w,{skip:P=!1,selectFromResult:g}={})=>{const{select:b}=t.endpoints[o],L=ei(P?xt:w,f,y.endpointDefinitions[o],o),N=u.useRef(void 0),x=u.useMemo(()=>a([b(L),(C,B)=>B,C=>L],c,{memoizeOptions:{resultEqualityCheck:Ps}}),[b,L]),E=u.useMemo(()=>g?a([x],g,{devModeChecks:{identityFunctionCheck:"never"}}):x,[x,g]),z=i(C=>E(C,N.current),Ps),A=r(),m=x(A.getState(),N.current);return gd(()=>{N.current=m},[m]),z}}function j(o){u.useEffect(()=>()=>{var c,D;(D=(c=o.current)==null?void 0:c.unsubscribe)==null||D.call(c),o.current=void 0},[o])}function R(o){if(!o.current)throw new Error(va(38));return o.current.refetch()}function d(o){const c=(P,g={})=>{const[b]=T(o,P,g);return j(b),u.useMemo(()=>({refetch:()=>R(b)}),[b])},D=({refetchOnReconnect:P,refetchOnFocus:g,pollingInterval:b=0,skipPollingIfUnfocused:L=!1}={})=>{const{initiate:N}=t.endpoints[o],x=n(),[E,z]=u.useState(Jn),A=u.useRef(void 0),m=an({refetchOnReconnect:P,refetchOnFocus:g,pollingInterval:b,skipPollingIfUnfocused:L});h(()=>{var Y,Z;const O=(Y=A.current)==null?void 0:Y.subscriptionOptions;m!==O&&((Z=A.current)==null||Z.updateSubscriptionOptions(m))},[m]);const C=u.useRef(m);h(()=>{C.current=m},[m]);const B=u.useCallback(function(O,Y=!1){let Z;return s(()=>{var te;(te=A.current)==null||te.unsubscribe(),A.current=Z=x(N(O,{subscriptionOptions:C.current,forceRefetch:!Y})),z(O)}),Z},[x,N]),q=u.useCallback(()=>{var O,Y;(O=A.current)!=null&&O.queryCacheKey&&x(t.internalActions.removeQueryResult({queryCacheKey:(Y=A.current)==null?void 0:Y.queryCacheKey}))},[x]);return u.useEffect(()=>()=>{var O;(O=A==null?void 0:A.current)==null||O.unsubscribe()},[]),u.useEffect(()=>{E!==Jn&&!A.current&&B(E,!0)},[E,B]),u.useMemo(()=>[B,E,{reset:q}],[B,E,q])},w=I(o,S);return{useQueryState:w,useQuerySubscription:c,useLazyQuerySubscription:D,useLazyQuery(P){const[g,b,{reset:L}]=D(P),N=w(b,{...P,skip:b===Jn}),x=u.useMemo(()=>({lastArg:b}),[b]);return u.useMemo(()=>[g,{...N,reset:L},x],[g,N,L,x])},useQuery(P,g){const b=c(P,g),L=w(P,{selectFromResult:P===xt||g!=null&&g.skip?void 0:Rr,...g}),N=ti(L,...si);return u.useDebugValue(N),u.useMemo(()=>({...L,...b}),[L,b])}}}function p(o){const c=(w,P={})=>{const[g,b,L,N]=T(o,w,P),x=u.useRef(N);h(()=>{x.current=N},[N]);const E=u.useCallback(function(m,C){let B;return s(()=>{var q;(q=g.current)==null||q.unsubscribe(),g.current=B=b(L(m,{subscriptionOptions:x.current,direction:C}))}),B},[g,b,L]);j(g);const z=ei(P.skip?xt:w,qn,y.endpointDefinitions[o],o),A=u.useCallback(()=>R(g),[g]);return u.useMemo(()=>({trigger:E,refetch:A,fetchNextPage:()=>E(z,"forward"),fetchPreviousPage:()=>E(z,"backward")}),[A,E,z])},D=I(o,$);return{useInfiniteQueryState:D,useInfiniteQuerySubscription:c,useInfiniteQuery(w,P){const{refetch:g,fetchNextPage:b,fetchPreviousPage:L}=c(w,P),N=D(w,{selectFromResult:w===xt||P!=null&&P.skip?void 0:Rr,...P}),x=ti(N,...si,"hasNextPage","hasPreviousPage");return u.useDebugValue(x),u.useMemo(()=>({...N,fetchNextPage:b,fetchPreviousPage:L,refetch:g}),[N,b,L,g])}}}function k(o){return({selectFromResult:c,fixedCacheKey:D}={})=>{const{select:w,initiate:P}=t.endpoints[o],g=n(),[b,L]=u.useState();u.useEffect(()=>()=>{b!=null&&b.arg.fixedCacheKey||b==null||b.reset()},[b]);const N=u.useCallback(function(O){const Y=g(P(O,{fixedCacheKey:D}));return L(Y),Y},[g,P,D]),{requestId:x}=b||{},E=u.useMemo(()=>w({fixedCacheKey:D,requestId:b==null?void 0:b.requestId}),[D,b,w]),z=u.useMemo(()=>c?a([E],c):E,[c,E]),A=i(z,Ps),m=D==null?b==null?void 0:b.arg.originalArgs:void 0,C=u.useCallback(()=>{s(()=>{b&&L(void 0),D&&g(t.internalActions.removeMutationResult({requestId:x,fixedCacheKey:D}))})},[g,D,b,x]),B=ti(A,...si,"endpointName");u.useDebugValue(B);const q=u.useMemo(()=>({...A,originalArgs:m,reset:C}),[A,m,C]);return u.useMemo(()=>[N,q],[N,q])}}}var yd=Symbol(),bd=({batch:t=Ho,hooks:s={useDispatch:$e,useSelector:ge,useStore:Wo},createSelector:n=wa,unstable__sideEffectsInRender:i=!1,...r}={})=>({name:yd,init(l,{serializeQueryArgs:a},f){const y=l,{buildQueryHooks:h,buildInfiniteQueryHooks:S,buildMutationHook:$,usePrefetch:v}=fd({api:l,moduleOptions:{batch:t,hooks:s,unstable__sideEffectsInRender:i,createSelector:n},serializeQueryArgs:a,context:f});return Ns(y,{usePrefetch:v}),Ns(f,{batch:t}),{injectEndpoint(T,I){if(cd(I)){const{useQuery:j,useLazyQuery:R,useLazyQuerySubscription:d,useQueryState:p,useQuerySubscription:k}=h(T);Ns(y.endpoints[T],{useQuery:j,useLazyQuery:R,useLazyQuerySubscription:d,useQueryState:p,useQuerySubscription:k}),l[`use${rn(T)}Query`]=j,l[`useLazy${rn(T)}Query`]=R}if(dd(I)){const j=$(T);Ns(y.endpoints[T],{useMutation:j}),l[`use${rn(T)}Mutation`]=j}else if(Ha(I)){const{useInfiniteQuery:j,useInfiniteQuerySubscription:R,useInfiniteQueryState:d}=S(T);Ns(y.endpoints[T],{useInfiniteQuery:j,useInfiniteQuerySubscription:R,useInfiniteQueryState:d}),l[`use${rn(T)}InfiniteQuery`]=j}}}}}),Ki=Oa(Va(),bd());const jd="/api",vn=Ki({reducerPath:"exhibitorInvoiceApi",baseQuery:Wi({baseUrl:jd,credentials:"include",prepareHeaders:t=>{const s=localStorage.getItem("exhibitor_token");return s&&t.set("authorization",`Bearer ${s}`),t.set("Content-Type","application/json"),t.set("Accept","application/json"),t}}),tagTypes:["ExhibitorInvoice"],endpoints:t=>({getExhibitorInvoice:t.query({query:s=>({url:`/exhibitor-bookings/${s}/invoice`,method:"GET"}),transformErrorResponse:s=>(console.error("Get Exhibitor Invoice Error:",s),s),providesTags:(s,n,i)=>[{type:"ExhibitorInvoice",id:i}]}),downloadExhibitorInvoice:t.mutation({query:s=>({url:`/exhibitor-bookings/${s}/invoice/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:t.mutation({query:({bookingId:s,...n})=>({url:`/exhibitor-bookings/${s}/invoice/share/email`,method:"POST",body:n})}),shareViaWhatsApp:t.mutation({query:({bookingId:s,...n})=>({url:`/exhibitor-bookings/${s}/invoice/share/whatsapp`,method:"POST",body:n})})})}),{useGetExhibitorInvoiceQuery:vd,useDownloadExhibitorInvoiceMutation:wd,useShareViaEmailMutation:Sd,useShareViaWhatsAppMutation:kd}=vn,Wa=({booking:t})=>{var k,o,c,D;const s=()=>{const w=new Date(t.exhibitionId.startDate||""),P=new Date(t.exhibitionId.endDate||""),g={};let b=new Date(w);for(;b<=P;){const N=b.toLocaleString("default",{month:"short",year:"numeric"});g[N]||(g[N]=[]),g[N].push(b.getDate().toString().padStart(2,"0")),b=new Date(b),b.setDate(b.getDate()+1)}const L=Object.entries(g).map(([N,x])=>`${x.join(", ")} ${N}`);return`${t.exhibitionId.name||"ABSE"} (${L.join(" & ")})`},n=w=>{const P=new Date(w);return{date:P.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:P.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},i=t.stallIds.map((w,P)=>{var N;const g=w,b=w.dimensions.width*w.dimensions.height,L=b*w.ratePerSqm;return{key:w._id,sn:P+1,stallNo:w.number,stallType:((N=g.stallTypeId)==null?void 0:N.name)||"Standard",dimensions:`${w.dimensions.width}x${w.dimensions.height}m`,area:b.toFixed(0),rate:w.ratePerSqm.toFixed(0),amount:L}}),r=i.reduce((w,P)=>w+P.amount,0),l=t.calculations,a=((k=l.stalls[0])==null?void 0:k.discount)!==void 0&&((o=l.stalls[0])==null?void 0:o.discount)!==null,f=a&&((D=(c=l.stalls[0])==null?void 0:c.discount)==null?void 0:D.value)||0,y=a&&f>0?Math.round(r*f/100*100)/100:0,h=r-y,S=l.taxes.find(w=>w.name.includes("GST")),$=S?S.rate:18,v=Math.round(h*$/100*100)/100,T=h+v,I=r,j=y,R=h,d=v,p=T;return e.jsx("div",{className:"invoice-container",children:e.jsxs("div",{className:"proforma-invoice",children:[e.jsxs("div",{className:"header-section",children:[e.jsx("div",{className:"logo-cell",children:"Logo"}),e.jsxs("div",{className:"title-company",children:[e.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),e.jsx("div",{className:"company-cell",children:t.exhibitionId.companyName})]})]}),e.jsxs("div",{className:"bill-to-section",children:[e.jsx("div",{className:"bill-to-cell",children:"Bill To"}),e.jsxs("div",{className:"bill-to-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Company Name"}),e.jsx("div",{className:"value-cell",children:t.companyName}),e.jsx("div",{className:"date-label-cell",children:"Date"}),e.jsx("div",{className:"date-value-cell",children:n(t.createdAt).date})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Phone No."}),e.jsx("div",{className:"value-cell",children:t.customerPhone}),e.jsx("div",{className:"date-label-cell",children:"Time"}),e.jsx("div",{className:"date-value-cell",children:n(t.createdAt).time})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"GST No."}),e.jsx("div",{className:"value-cell",children:t.customerGSTIN}),e.jsx("div",{className:"date-label-cell",children:"Invoice No"}),e.jsx("div",{className:"date-value-cell",children:t.invoiceNumber})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Address"}),e.jsx("div",{className:"value-cell",children:t.customerAddress})]})]})]}),e.jsxs("div",{className:"expo-venue-section",children:[e.jsxs("div",{className:"expo-column",children:[e.jsx("div",{className:"heading",children:"Expo Name"}),e.jsx("div",{className:"content",children:s()})]}),e.jsxs("div",{className:"venue-column",children:[e.jsx("div",{className:"heading",children:"Venue"}),e.jsx("div",{className:"content",children:t.exhibitionId.venue})]})]}),e.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),e.jsxs("div",{className:"stall-table",children:[e.jsxs("div",{className:"stall-header",children:[e.jsx("div",{className:"stall-header-cell",children:"S/N"}),e.jsx("div",{className:"stall-header-cell",children:"Stall No."}),e.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),e.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),e.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),i.map(w=>e.jsxs("div",{className:"stall-row",children:[e.jsx("div",{className:"stall-cell",children:w.sn}),e.jsx("div",{className:"stall-cell",children:w.stallNo}),e.jsx("div",{className:"stall-cell",children:w.stallType}),e.jsx("div",{className:"stall-cell",children:w.dimensions}),e.jsx("div",{className:"stall-cell",children:w.area}),e.jsx("div",{className:"stall-cell",children:Number(w.rate).toLocaleString("en-IN")}),e.jsx("div",{className:"stall-cell",children:w.amount.toLocaleString("en-IN")})]},w.key))]}),e.jsx("div",{className:"section-header",children:"Calculation Summary"}),e.jsxs("div",{className:"calc-table",children:[e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),e.jsxs("div",{className:"calc-value",children:["â‚¹",I.toLocaleString("en-IN")]})]}),f>0&&e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["Discount (",f,"%)"]}),e.jsxs("div",{className:"calc-value",children:["-â‚¹",j.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:f>0?"Amount after Discount":"Net Amount"}),e.jsxs("div",{className:"calc-value",children:["â‚¹",R.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["GST (",$,"%)"]}),e.jsxs("div",{className:"calc-value",children:["â‚¹",d.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row total-row",children:[e.jsx("div",{className:"calc-label",children:"Total Amount"}),e.jsxs("div",{className:"calc-value",children:["â‚¹",p.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"details-section",children:[e.jsxs("div",{className:"bank-details",children:[e.jsx("div",{className:"details-header",children:"Bank Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Bank Name"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Account No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankAccount})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Name"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankAccountName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Branch"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankBranch})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"IFSC CODE"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.bankIFSC})]})]}),e.jsxs("div",{className:"company-details",children:[e.jsx("div",{className:"details-header",children:"Company Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"CIN No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyCIN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Pan No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyPAN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"SAC CODE"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companySAC})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"GST No."}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyGST})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Email"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyEmail})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Website"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyWebsite})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Address"}),e.jsx("div",{className:"detail-value",children:t.exhibitionId.companyAddress})]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"PI Instruction"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:t.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:t.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),e.jsx("div",{className:"signature-section",children:e.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})};da.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${ca}/pdf.worker.min.js`;const{Title:Id,Text:Lr}=pe,Cd=()=>{const{id:t}=ot(),{data:s,isLoading:n,error:i}=vd(t||""),[r]=wd(),[l]=Sd(),[a]=kd(),[f,y]=u.useState(!1),[h,S]=u.useState(!1),[$,v]=u.useState(!1),[T,I]=u.useState(null),[j,R]=u.useState(1),[d]=F.useForm(),[p]=F.useForm(),[k,o]=u.useState(null);function c({numPages:N}){I(N),R(1)}const D=async()=>{try{const N=await r(t||"").unwrap(),x=URL.createObjectURL(N);o(x),y(!0)}catch(N){console.error("Error generating PDF preview:",N),ee.error("Failed to generate PDF preview")}},w=async()=>{try{const N=await r(t||"").unwrap(),x=URL.createObjectURL(N),E=document.createElement("a");E.href=x,E.download=`Invoice-${(s==null?void 0:s.invoiceNumber)||t||"download"}.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(x)}catch(N){console.error("Error downloading PDF:",N),ee.error("Failed to download PDF")}},P=()=>{S(!0)},g=()=>{v(!0)},b=async N=>{try{await l({bookingId:t||"",email:N.email,message:N.message}).unwrap(),ee.success(`Invoice sent to ${N.email}`),S(!1),d.resetFields()}catch(x){console.error("Error sending email:",x),ee.error("Failed to send email")}},L=async N=>{try{await a({bookingId:t||"",phoneNumber:N.phoneNumber}).unwrap();const x=N.phoneNumber.replace(/\D/g,""),E=encodeURIComponent(N.message);window.open(`https://wa.me/${x}?text=${E}`,"_blank"),v(!1),p.resetFields()}catch(x){console.error("Error opening WhatsApp:",x),ee.error("Failed to open WhatsApp")}};return n?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(Et,{size:"large"})}):i||!s?e.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[e.jsx(Id,{level:3,children:"Invoice Not Found"}),e.jsx(Lr,{children:"The requested invoice could not be loaded. Please try again later."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(H,{title:"Invoice Details",style:{margin:"20px"},children:[e.jsx(ie,{gutter:[16,24],children:e.jsx(M,{span:24,children:e.jsxs(G,{children:[e.jsx(_,{type:"primary",icon:e.jsx(co,{}),onClick:D,children:"Preview Invoice"}),e.jsx(_,{icon:e.jsx(Bi,{}),onClick:w,children:"Download PDF"}),e.jsx(_,{icon:e.jsx(Mt,{}),onClick:P,children:"Share via Email"}),e.jsx(_,{icon:e.jsx(ma,{}),onClick:g,children:"Share via WhatsApp"})]})})}),e.jsx(Le,{}),e.jsx(Wa,{booking:{...s.bookingId,customerGSTIN:s.bookingId.exhibitionId.companyGST||"",invoiceNumber:s.invoiceNumber,exhibitionId:{...s.bookingId.exhibitionId,companyName:s.bookingId.exhibitionId.companyName||"",bankName:s.bookingId.exhibitionId.bankName||"",bankAccount:s.bookingId.exhibitionId.bankAccount||"",bankAccountName:s.bookingId.exhibitionId.bankAccountName||"",bankBranch:s.bookingId.exhibitionId.bankBranch||"",bankIFSC:s.bookingId.exhibitionId.bankIFSC||"",companyCIN:s.bookingId.exhibitionId.companyCIN||"",companyPAN:s.bookingId.exhibitionId.companyPAN||"",companySAC:s.bookingId.exhibitionId.companySAC||"",companyGST:s.bookingId.exhibitionId.companyGST||"",companyEmail:s.bookingId.exhibitionId.companyEmail||"",companyWebsite:s.bookingId.exhibitionId.companyWebsite||"",companyAddress:s.bookingId.exhibitionId.companyAddress||""}}})]}),e.jsxs(me,{title:"Invoice Preview",visible:f,onCancel:()=>y(!1),footer:null,width:800,children:[k&&e.jsx(ua,{file:k,onLoadSuccess:c,options:{cMapUrl:"cmaps/",cMapPacked:!0},children:e.jsx(ha,{pageNumber:j,width:750})}),T&&e.jsx("div",{style:{textAlign:"center",marginTop:"10px"},children:e.jsxs(Lr,{children:["Page ",j," of ",T]})})]}),e.jsx(me,{title:"Share Invoice via Email",visible:h,onCancel:()=>S(!1),footer:null,children:e.jsxs(F,{form:d,layout:"vertical",onFinish:b,children:[e.jsx(F.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(W,{placeholder:"example@example.com"})}),e.jsx(F.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${s.invoiceNumber}.`,children:e.jsx(W.TextArea,{rows:4})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(me,{title:"Share Invoice via WhatsApp",visible:$,onCancel:()=>v(!1),footer:null,children:e.jsxs(F,{form:p,layout:"vertical",onFinish:L,children:[e.jsx(F.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:e.jsx(W,{placeholder:"+1234567890"})}),e.jsx(F.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${s.invoiceNumber}.`,children:e.jsx(W.TextArea,{rows:4})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Option:ls}=oe,{Title:Nd,Text:Ed}=pe,Ad=()=>{const t=$e(),{message:s}=ft.useApp(),[n]=F.useForm(),{settings:i,loading:r}=ge(v=>v.settings),[l,a]=u.useState([]),[f,y]=u.useState(0);u.useEffect(()=>{t(Rs())},[t]),u.useEffect(()=>{if(i&&(n.setFieldsValue({siteName:i.siteName,adminEmail:i.adminEmail,language:i.language,timezone:i.timezone,emailNotifications:i.emailNotifications,footerText:i.footerText}),i.logo)){const v=j=>{const R=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${j}`,token:R}},{url:T,token:I}=v(i.logo);fetch(T,{headers:{authorization:`Bearer ${I}`}}).then(j=>j.blob()).then(j=>{var d;const R=URL.createObjectURL(j);a([{uid:"-1",name:((d=i.logo)==null?void 0:d.split("/").pop())||"logo",status:"done",url:R,thumbUrl:R,type:j.type,response:{path:i.logo}}])}).catch(()=>{a([])})}},[i,n]);const h=v=>{t(Ls(v)).unwrap().then(()=>s.success("Settings updated successfully")).catch(T=>s.error(`Failed to update settings: ${T}`))},S={name:"file",action:`${ne.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:l,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(v){const{status:T,name:I,response:j,uid:R}=v.file;if(T==="uploading"){a([...v.fileList]);return}if(T==="done"&&j){y(0);const d=localStorage.getItem("token"),p=`${ne.defaults.baseURL}/uploads/${j.path}`;fetch(p,{headers:{authorization:`Bearer ${d}`}}).then(k=>k.blob()).then(k=>{const o=URL.createObjectURL(k);a([{uid:v.file.uid,name:I,status:"done",url:o,thumbUrl:o,type:k.type,response:j}]),s.success(`${I} uploaded successfully`),n.setFieldValue("logo",j.path)}).catch(()=>{s.error(`${I} preview failed to load`),a([])})}else T==="error"?(s.error(`${I} upload failed.`),a([]),y(0)):T==="removed"&&(a([]),n.setFieldValue("logo",null),y(0))},onRemove(){return a([]),n.setFieldValue("logo",null),y(0),!0},customRequest:async({file:v,onSuccess:T,onError:I,onProgress:j})=>{try{t(jn(v)).unwrap().then(R=>{T&&T(R)}).catch(R=>{I&&I(new Error(R))})}catch(R){I&&I(R)}}},$=e.jsx("div",{children:f>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Ft,{type:"circle",percent:f,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ie,{gutter:[24,24],align:"middle",children:e.jsx(M,{flex:"auto",children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(Nd,{level:4,style:{margin:0},children:"Settings"}),e.jsx(Ed,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(H,{className:"info-card",children:e.jsxs(F,{form:n,layout:"vertical",onFinish:h,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(ie,{gutter:24,children:[e.jsxs(M,{span:12,children:[e.jsx(F.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(W,{})}),e.jsx(F.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(W,{})}),e.jsx(F.Item,{label:"Language",name:"language",children:e.jsxs(oe,{children:[e.jsx(ls,{value:"en",children:"English"}),e.jsx(ls,{value:"es",children:"Spanish"}),e.jsx(ls,{value:"fr",children:"French"})]})}),e.jsx(F.Item,{label:"Timezone",name:"timezone",children:e.jsxs(oe,{children:[e.jsx(ls,{value:"UTC",children:"UTC"}),e.jsx(ls,{value:"EST",children:"EST"}),e.jsx(ls,{value:"PST",children:"PST"})]})}),e.jsx(F.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(it,{})})]}),e.jsxs(M,{span:12,children:[e.jsxs(F.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(zs,{...S,children:l.length<1&&$}),l.length>0&&f>0&&e.jsx(Ft,{percent:f,status:"active",style:{marginTop:8}})]}),e.jsx(F.Item,{label:"Footer Text",name:"footerText",children:e.jsx(W.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(F.Item,{children:e.jsxs(G,{children:[e.jsx(_,{type:"primary",htmlType:"submit",icon:e.jsx(vs,{}),loading:r,children:"Save Settings"}),e.jsx(_,{onClick:()=>n.resetFields(),icon:e.jsx(uo,{}),children:"Reset"})]})})]})})]})},{Title:on,Paragraph:$r,Text:cs}=pe,{confirm:Td}=me,Pd=[{id:1,name:"Administrator",description:"Full access to all resources",userCount:3,permissions:{read:!0,write:!0,delete:!0}},{id:2,name:"Editor",description:"Can edit and publish content",userCount:8,permissions:{read:!0,write:!0,delete:!1}},{id:3,name:"Viewer",description:"Can view content only",userCount:15,permissions:{read:!0,write:!1,delete:!1}},{id:4,name:"Analyst",description:"Can view and analyze data",userCount:7,permissions:{read:!0,write:!1,delete:!1}}];function ni({allowed:t}){return t?e.jsx(Li,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):e.jsx(ho,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function Dd(){const[t,s]=u.useState(""),n=l=>{Td({title:"Are you sure you want to delete this role?",icon:e.jsx(Zt,{}),content:`This will permanently delete the ${l} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){console.log("Deleting role:",l)}})},i=[{title:"Role",dataIndex:"name",key:"name",render:(l,a)=>e.jsxs(G,{children:[e.jsx(gt,{style:{backgroundColor:a.id===1?"#1677ff":a.id===2?"#52c41a":a.id===3?"#faad14":"#f5222d"},children:l.charAt(0).toUpperCase()}),e.jsx(cs,{strong:!0,children:l})]})},{title:"Description",dataIndex:"description",key:"description",render:l=>e.jsx(cs,{type:"secondary",children:l})},{title:"Users",dataIndex:"userCount",key:"userCount",render:l=>e.jsx(Ke,{count:l,color:"#1677ff",showZero:!0})},{title:"Read",dataIndex:["permissions","read"],key:"read",align:"center",render:l=>e.jsx(ni,{allowed:l})},{title:"Write",dataIndex:["permissions","write"],key:"write",align:"center",render:l=>e.jsx(ni,{allowed:l})},{title:"Delete",dataIndex:["permissions","delete"],key:"delete",align:"center",render:l=>e.jsx(ni,{allowed:l})},{title:"Actions",key:"actions",align:"right",render:(l,a)=>e.jsxs(G,{children:[e.jsx(We,{title:"Edit role",children:e.jsx(_,{type:"primary",shape:"circle",icon:e.jsx(bs,{}),size:"small",onClick:()=>console.log("Edit role:",a.name)})}),e.jsx(We,{title:"Delete role",children:e.jsx(_,{danger:!0,shape:"circle",icon:e.jsx(ut,{}),size:"small",onClick:()=>n(a.name)})})]})}],r=Pd.filter(l=>l.name.toLowerCase().includes(t.toLowerCase())||l.description.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(on,{level:2,children:"Roles & Permissions"}),e.jsx($r,{children:"Manage role-based access control and permissions for your users."})]}),e.jsxs(H,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(ie,{gutter:16,style:{marginBottom:16},children:[e.jsx(M,{span:16,children:e.jsx(W,{placeholder:"Search roles...",allowClear:!0,value:t,onChange:l=>s(l.target.value),prefix:e.jsx(cs,{type:"secondary",style:{fontSize:16},children:"ðŸ”"})})}),e.jsx(M,{span:8,style:{textAlign:"right"},children:e.jsx(_,{type:"primary",icon:e.jsx(et,{}),style:{borderRadius:6},children:"Add Role"})})]}),e.jsx(Re,{columns:i,dataSource:r,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(l,a)=>`Showing ${a[0]}-${a[1]} of ${l} roles`},style:{marginTop:8}})]}),e.jsx(H,{title:e.jsx(on,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsxs(G,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(on,{level:5,children:"Best Practices"}),e.jsxs("ul",{style:{paddingLeft:20},children:[e.jsx("li",{children:e.jsx(cs,{children:"Follow the principle of least privilege"})}),e.jsx("li",{children:e.jsx(cs,{children:"Regularly audit user roles"})}),e.jsx("li",{children:e.jsx(cs,{children:"Document role responsibilities"})})]})]}),e.jsxs(G,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(on,{level:5,children:"Role Inheritance"}),e.jsx($r,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})})]})}const Rd=async()=>{try{return(await ne.get("/users")).data.map(s=>({...s,id:s._id,name:s.name||s.username,status:s.isActive?"active":"inactive",department:s.department||"General"}))}catch(t){throw console.error("Error fetching users:",t),t}},Ld=async t=>{try{const s={username:t.username,email:t.email,password:t.password,role:t.role,isActive:t.isActive},n=await ne.post("/users",s);return{...n.data,id:n.data._id,name:t.name||n.data.username,status:n.data.isActive?"active":"inactive",department:n.data.department||"General"}}catch(s){throw console.error("Error creating user:",s),s}},$d=async(t,s)=>{const n={...s};s.status&&(n.isActive=s.status==="active",delete n.status);try{const i=await ne.put(`/users/${t}`,n);return{...i.data,id:i.data._id,name:i.data.name||i.data.username,status:i.data.isActive?"active":"inactive",department:i.data.department||"General"}}catch(i){throw console.error("Error updating user:",i),i}},Fd=async t=>{try{return(await ne.delete(`/users/${t}`)).data}catch(s){throw console.error("Error deleting user:",s),s}},Bd=t=>typeof t=="string"?t:(t==null?void 0:t.name)||"Unknown",Md=t=>typeof t=="string"?t:(t==null?void 0:t._id)||"",{Text:ii}=pe,zd=({user:t,visible:s,onClose:n})=>t?e.jsxs(me,{title:"User Details",open:s,onCancel:n,footer:null,width:600,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[e.jsx(gt,{src:t.avatar,icon:!t.avatar&&e.jsx(ke,{}),size:64}),e.jsxs("div",{style:{marginLeft:16},children:[e.jsx(pe.Title,{level:4,style:{margin:0},children:t.name}),e.jsx(ii,{type:"secondary",children:t.email})]})]}),e.jsx(Le,{}),e.jsxs(xe,{bordered:!0,column:1,children:[e.jsx(xe.Item,{label:e.jsxs(e.Fragment,{children:[e.jsx(xo,{})," Role"]}),children:(()=>{const i=Bd(t.role),r=i.toLowerCase()==="admin"?"#1677ff":i.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx(le,{color:r,children:i.toUpperCase()})})()}),e.jsx(xe.Item,{label:e.jsxs(e.Fragment,{children:[e.jsx(On,{})," Department"]}),children:t.department}),e.jsx(xe.Item,{label:e.jsxs(e.Fragment,{children:[e.jsx(Mt,{})," Email"]}),children:t.email}),e.jsx(xe.Item,{label:"Status",children:t.status==="active"?e.jsx(Ke,{status:"success",text:e.jsx(ii,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(Ke,{status:"default",text:e.jsx(ii,{type:"secondary",children:"Inactive"})})}),e.jsx(xe.Item,{label:e.jsxs(e.Fragment,{children:[e.jsx(Ye,{})," Last Login"]}),children:t.lastLogin}),e.jsx(xe.Item,{label:"Created On",children:t.createdAt||"Not available"})]})]}):null,{Option:ri}=oe,Ud=({user:t,visible:s,onClose:n,onSuccess:i})=>{const[r]=F.useForm(),[l,a]=u.useState(!1);u.useEffect(()=>{t&&s&&r.setFieldsValue({name:t.name,email:t.email,role:Md(t.role),status:t.status==="active"})},[t,s,r]);const f=async()=>{try{const y=await r.validateFields();if(!t)return;a(!0);const h={name:y.name,email:y.email,role:y.role,status:y.status?"active":"inactive"};await $d(t.id,h),ee.success("User updated successfully"),i(),n()}catch(y){y instanceof Error?ee.error(`Failed to update user: ${y.message}`):ee.error("Failed to update user"),console.error("Update user error:",y)}finally{a(!1)}};return e.jsx(me,{title:"Edit User",open:s,onCancel:n,footer:[e.jsx(_,{onClick:n,children:"Cancel"},"cancel"),e.jsx(_,{type:"primary",loading:l,onClick:f,children:"Save Changes"},"submit")],children:e.jsxs(F,{form:r,layout:"vertical",requiredMark:!1,children:[e.jsx(F.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:e.jsx(W,{placeholder:"Full name"})}),e.jsx(F.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{placeholder:"Email address"})}),e.jsx(F.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsxs(oe,{placeholder:"Select role",children:[e.jsx(ri,{value:"admin",children:"Admin"}),e.jsx(ri,{value:"manager",children:"Manager"}),e.jsx(ri,{value:"agent",children:"Agent"})]})}),e.jsx(F.Item,{name:"status",label:"Status",valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},qd=async()=>{try{return(await ne.get("/roles")).data}catch(t){throw console.error("Error fetching roles:",t),t}},{Option:ln}=oe,_d=({visible:t,onClose:s,onSuccess:n})=>{const[i]=F.useForm(),[r,l]=u.useState(!1),[a,f]=u.useState([]),[y,h]=u.useState(!1);u.useEffect(()=>{t&&S()},[t]);const S=async()=>{try{h(!0);const v=await qd();f(v)}catch(v){console.error("Failed to fetch roles:",v),ee.error("Failed to load roles")}finally{h(!1)}},$=async()=>{try{const v=await i.validateFields();l(!0);const T={username:v.name.replace(/\s+/g,"_").toLowerCase(),name:v.name,email:v.email,password:v.password,role:v.role,isActive:v.status};await Ld(T),ee.success("User created successfully"),i.resetFields(),n(),s()}catch(v){v instanceof Error?ee.error(`Failed to create user: ${v.message}`):ee.error("Failed to create user"),console.error("Create user error:",v)}finally{l(!1)}};return e.jsx(me,{title:"Create New User",open:t,onCancel:s,footer:[e.jsx(_,{onClick:s,children:"Cancel"},"cancel"),e.jsx(_,{type:"primary",loading:r,onClick:$,children:"Create User"},"submit")],children:e.jsxs(F,{form:i,layout:"vertical",requiredMark:!1,children:[e.jsx(F.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:e.jsx(W,{placeholder:"Full name"})}),e.jsx(F.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{placeholder:"Email address"})}),e.jsx(F.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(W.Password,{placeholder:"Enter password"})}),e.jsx(F.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(oe,{placeholder:"Select role",loading:y,children:a.length>0?a.map(v=>e.jsx(ln,{value:v._id,children:v.name},v._id)):e.jsxs(e.Fragment,{children:[e.jsx(ln,{value:"admin",children:"Admin"}),e.jsx(ln,{value:"manager",children:"Manager"}),e.jsx(ln,{value:"agent",children:"Agent"})]})})}),e.jsx(F.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:Od,Paragraph:Vd,Text:ds}=pe,{TabPane:ai}=at,{confirm:Hd}=me;function Wd(){const[t,s]=u.useState(""),[n,i]=u.useState("all"),[r,l]=u.useState([]),[a,f]=u.useState(!0),[y,h]=u.useState(!1),[S,$]=u.useState(!1),[v,T]=u.useState(!1),[I,j]=u.useState(null);u.useEffect(()=>{R()},[]);const R=async()=>{f(!0);try{const g=await Rd();l(g)}catch(g){console.error("Error fetching users:",g),ee.error("Failed to load users. Please try again later.")}finally{f(!1)}},d=(g,b)=>{Hd({title:"Are you sure you want to delete this user?",icon:e.jsx(Zt,{}),content:`This will permanently delete ${b}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{await Fd(g),ee.success(`${b} has been deleted successfully.`),R()}catch(L){console.error("Error deleting user:",L),ee.error("Failed to delete user. Please try again.")}}})},p=g=>{j(g),h(!0)},k=g=>{j(g),$(!0)},o=()=>{T(!0)},c=[{title:"User",key:"user",render:(g,b)=>e.jsxs(G,{children:[e.jsx(gt,{src:b.avatar,icon:!b.avatar&&e.jsx(ke,{}),size:"large"}),e.jsxs(G,{direction:"vertical",size:0,children:[e.jsx(ds,{strong:!0,children:b.name}),e.jsx(ds,{type:"secondary",style:{fontSize:"12px"},children:b.email})]})]})},{title:"Department",dataIndex:"department",key:"department",render:g=>e.jsx(ds,{children:g})},{title:"Role",dataIndex:"role",key:"role",render:g=>{const b=typeof g=="string"?g:g&&typeof g=="object"&&g.name?g.name:"Unknown";let L=b.toLowerCase()==="admin"?"#1677ff":b.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx(le,{color:L,style:{fontWeight:500,borderRadius:"4px"},children:b.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(g,b)=>{const L=b.role;return(typeof L=="string"?L.toLowerCase():L&&typeof L=="object"&&L.name?L.name.toLowerCase():"").indexOf(g.toLowerCase())===0}},{title:"Status",dataIndex:"status",key:"status",render:g=>e.jsx(G,{children:g==="active"?e.jsx(Ke,{status:"success",text:e.jsx(ds,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(Ke,{status:"default",text:e.jsx(ds,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],onFilter:(g,b)=>b.status===g},{title:"Last Login",dataIndex:"lastLogin",key:"lastLogin",render:g=>e.jsxs(G,{children:[e.jsx(Ye,{style:{color:"#8c8c8c"}}),e.jsx(ds,{type:"secondary",children:g})]}),sorter:(g,b)=>{const L=new Date(g.lastLogin||""),N=new Date(b.lastLogin||"");return L.getTime()-N.getTime()}},{title:"Action",key:"action",render:(g,b)=>e.jsxs(G,{size:"small",children:[e.jsx(We,{title:"View details",children:e.jsx(_,{type:"text",icon:e.jsx(Lt,{}),size:"small",onClick:()=>p(b)})}),e.jsx(We,{title:"Edit user",children:e.jsx(_,{type:"text",icon:e.jsx(bs,{}),size:"small",onClick:()=>k(b)})}),e.jsx(We,{title:"Delete user",children:e.jsx(_,{type:"text",danger:!0,icon:e.jsx(ut,{}),size:"small",onClick:()=>d(b.id,b.name)})})]})}],D=r.filter(g=>(n==="all"||n==="active"&&g.status==="active"||n==="inactive"&&g.status==="inactive")&&Object.values(g).some(b=>typeof b=="string"&&b.toLowerCase().includes(t.toLowerCase()))),w={admin:r.filter(g=>{const b=g.role;return(typeof b=="string"?b.toLowerCase():b&&typeof b=="object"&&b.name?b.name.toLowerCase():"")==="admin"}).length,manager:r.filter(g=>{const b=g.role;return(typeof b=="string"?b.toLowerCase():b&&typeof b=="object"&&b.name?b.name.toLowerCase():"")==="manager"}).length,agent:r.filter(g=>{const b=g.role;return(typeof b=="string"?b.toLowerCase():b&&typeof b=="object"&&b.name?b.name.toLowerCase():"")==="agent"}).length},P={active:r.filter(g=>g.status==="active").length,inactive:r.filter(g=>g.status==="inactive").length};return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(Od,{level:2,children:"User Management"}),e.jsx(Vd,{children:"Manage user accounts, permissions, and access control."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx(W,{placeholder:"Search users...",prefix:e.jsx(mt,{}),style:{width:250},value:t,onChange:g=>s(g.target.value)}),e.jsx(_,{type:"primary",icon:e.jsx(ys,{}),onClick:o,children:"Add User"})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ye,{title:"Total Users",value:r.length,prefix:e.jsx(ke,{}),valueStyle:{color:"#1677ff"},loading:a})})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ye,{title:"Active Users",value:P.active,prefix:e.jsx(Li,{}),valueStyle:{color:"#52c41a"},loading:a})})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(H,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(ye,{title:"Admin Users",value:w.admin,prefix:e.jsx(ke,{}),valueStyle:{color:"#faad14"},loading:a})})})]}),e.jsx(H,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs(ie,{gutter:[16,16],justify:"space-between",align:"middle",children:[e.jsx(M,{xs:24,md:8,children:e.jsx(W,{placeholder:"Search users...",prefix:e.jsx(mt,{style:{color:"rgba(0,0,0,.45)"}}),onChange:g=>s(g.target.value),allowClear:!0,size:"middle"})}),e.jsx(M,{xs:24,md:16,style:{textAlign:"right"},children:e.jsxs(G,{wrap:!0,children:[e.jsx(We,{title:"Refresh data",children:e.jsx(_,{icon:a?e.jsx(po,{}):e.jsx(mt,{}),onClick:R,disabled:a,children:"Refresh"})}),e.jsx(_,{icon:e.jsx(Bi,{}),children:"Export"}),e.jsx(_,{type:"primary",icon:e.jsx(ys,{}),onClick:o,children:"Add User"})]})})]})}),e.jsxs(H,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(at,{defaultActiveKey:"all",onChange:i,tabBarStyle:{marginBottom:24},children:[e.jsx(ai,{tab:`All Users (${r.length})`},"all"),e.jsx(ai,{tab:`Active (${P.active})`},"active"),e.jsx(ai,{tab:`Inactive (${P.inactive})`},"inactive")]}),e.jsx(Re,{columns:c,dataSource:D,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(g,b)=>`${b[0]}-${b[1]} of ${g} users`},loading:a})]}),e.jsx(zd,{user:I,visible:y,onClose:()=>h(!1)}),e.jsx(Ud,{user:I,visible:S,onClose:()=>$(!1),onSuccess:R}),e.jsx(_d,{visible:v,onClose:()=>T(!1),onSuccess:R})]})}const{Title:yx,Text:cn,Paragraph:Es}=pe,Yd=({settings:t,onSave:s,loading:n})=>{const[i]=F.useForm();Ae.useEffect(()=>{i.setFieldsValue(t)},[t,i]);const r=l=>{s(l)};return e.jsxs(H,{title:e.jsxs(G,{children:[e.jsx(Mt,{}),e.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[e.jsx(Es,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),e.jsx(Qe,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(F,{form:i,layout:"vertical",initialValues:t,onFinish:r,children:[e.jsxs(ie,{gutter:[24,16],children:[e.jsxs(M,{span:24,children:[e.jsx(F.Item,{name:"newLeads",valuePropName:"checked",label:e.jsx(cn,{strong:!0,children:"New Lead Notifications"}),children:e.jsx(it,{})}),e.jsx(Es,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),e.jsxs(M,{span:24,children:[e.jsx(F.Item,{name:"followUpReminders",valuePropName:"checked",label:e.jsx(cn,{strong:!0,children:"Follow-up Reminders"}),children:e.jsx(it,{})}),e.jsx(Es,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),e.jsxs(M,{span:24,children:[e.jsx(F.Item,{name:"statusChanges",valuePropName:"checked",label:e.jsx(cn,{strong:!0,children:"Status Change Notifications"}),children:e.jsx(it,{})}),e.jsx(Es,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),e.jsxs(M,{span:24,children:[e.jsx(F.Item,{name:"leadAssignments",valuePropName:"checked",label:e.jsx(cn,{strong:!0,children:"Lead Assignment Notifications"}),children:e.jsx(it,{})}),e.jsx(Es,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),e.jsx(Le,{}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",icon:e.jsx(vs,{}),loading:n,children:"Save Email Preferences"})})]})]})},{Title:Qd,Text:bx,Paragraph:Fr}=pe,{Search:Gd}=W,{TabPane:Br}=at,Kd=()=>{const t=ve();ot();const[s,n]=u.useState([]),[i,r]=u.useState([]),[l,a]=u.useState(!1),[f,y]=u.useState(""),[h,S]=u.useState("ALL"),[$,v]=u.useState("ALL"),[T,I]=u.useState(hl().email),[j,R]=u.useState(!1),[d,p]=u.useState("all");u.useEffect(()=>{k()},[]),u.useEffect(()=>{o()},[s,f,h,$,d]);const k=()=>{a(!0),setTimeout(()=>{n(Na()),a(!1)},500)},o=()=>{let N=s;if(d==="unread"&&(N=N.filter(x=>x.status===Ce.UNREAD)),f){const x=f.toLowerCase();N=N.filter(E=>E.title.toLowerCase().includes(x)||E.message.toLowerCase().includes(x))}h!=="ALL"&&(N=N.filter(x=>x.type===h)),$!=="ALL"&&(N=N.filter(x=>x.source===$)),r(N)},c=N=>{p(N)},D=N=>{y(N)},w=()=>{y(""),S("ALL"),v("ALL"),p("all")},P=N=>{const x=fl(N);t(x)},g=N=>{const x=s.map(E=>E.id===N.id?{...E,status:Ce.READ,readAt:new Date().toISOString()}:E);n(x)},b=()=>{const N=s.map(x=>x.status===Ce.UNREAD?{...x,status:Ce.READ,readAt:new Date().toISOString()}:x);n(N),er.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})},L=N=>{R(!0),setTimeout(()=>{I(N),R(!1),er.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return e.jsx("div",{className:"notifications-page",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:24,children:e.jsx(H,{children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsxs(M,{children:[e.jsx(Qd,{level:4,children:e.jsxs(G,{children:[e.jsx(_n,{}),"Notifications"]})}),e.jsx(Fr,{children:"Stay updated with all your lead activities and follow-ups"})]}),e.jsx(M,{children:e.jsxs(G,{children:[e.jsx(We,{title:"Refresh notifications",children:e.jsx(_,{icon:e.jsx(Ri,{}),onClick:k,loading:l,children:"Refresh"})}),e.jsx(_,{type:"primary",icon:e.jsx(Ms,{}),onClick:b,disabled:Ds(s)===0,children:"Mark All as Read"})]})})]})})}),e.jsx(M,{xs:24,lg:16,children:e.jsxs(H,{className:"notifications-list-card",style:{marginBottom:24},children:[e.jsxs(at,{activeKey:d,onChange:c,tabBarExtraContent:e.jsx(G,{children:e.jsx(Ke,{count:Ds(s),offset:[-5,0],children:e.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[e.jsx(Br,{tab:"All Notifications"},"all"),e.jsx(Br,{tab:"Unread"},"unread")]}),e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsx(Gd,{placeholder:"Search notifications...",onSearch:D,style:{width:300},allowClear:!0}),e.jsx(G,{children:e.jsx(_,{icon:e.jsx(Mi,{}),onClick:w,disabled:f===""&&h==="ALL"&&$==="ALL",children:"Reset Filters"})})]}),e.jsx(Kt,{dataSource:i,renderItem:N=>e.jsx(Aa,{notification:N,onView:P,onMarkAsRead:g}),pagination:{pageSize:10,showTotal:(N,x)=>`${x[0]}-${x[1]} of ${N} notifications`},rowKey:"id",loading:l,locale:{emptyText:e.jsx(Ct,{description:e.jsx("span",{children:"No notifications found"})})}})]})}),e.jsxs(M,{xs:24,lg:8,children:[e.jsx(Yd,{settings:T,onSave:L,loading:j}),e.jsx(H,{title:e.jsxs(G,{children:[e.jsx(Pn,{}),e.jsx("span",{children:"Notification Tips"})]}),children:e.jsx(Fr,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),e.jsx("li",{children:"Use email notifications for critical updates when you're away"}),e.jsx("li",{children:"Click on a notification to see more details or take action"}),e.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class Ks extends Ae.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,n){console.error("Error caught by boundary:",s,n)}render(){var s;return this.state.hasError?e.jsx(qs,{status:"error",title:"Something went wrong",subTitle:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred",extra:[e.jsx(_,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),e.jsx(_,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const qe=t=>{var n,i;const s=((i=(n=t.response)==null?void 0:n.data)==null?void 0:i.message)||"An error occurred";throw new Error(s)},Ie={getExhibitions:async()=>{try{return await ne.get("/exhibitions")}catch(t){return qe(t)}},getActiveExhibitions:async()=>{try{return await ne.get("/exhibitions/active")}catch(t){return qe(t)}},getExhibition:async t=>{try{return await ne.get(`/exhibitions/${t}`)}catch(s){return qe(s)}},createExhibition:async t=>{try{return await ne.post("/exhibitions",t)}catch(s){return qe(s)}},updateExhibition:async(t,s)=>{try{return await ne.put(`/exhibitions/${t}`,s)}catch(n){return qe(n)}},deleteExhibition:async t=>{try{return await ne.delete(`/exhibitions/${t}`)}catch(s){return qe(s)}},getHalls:async t=>{try{return await ne.get(`/exhibitions/${t}/halls`)}catch(s){return qe(s)}},createHall:async(t,s)=>{try{const{_id:n,id:i,createdAt:r,updatedAt:l,...a}=s;return console.log("Creating hall with data:",{exhibitionId:t,data:a}),(await ne.post(`/exhibitions/${t}/halls`,a)).data}catch(n){throw console.error("Error creating hall:",n),n}},updateHall:async(t,s,n)=>{try{const{_id:i,id:r,createdAt:l,updatedAt:a,...f}=n;console.log("Updating hall with data:",{exhibitionId:t,hallId:s,data:f});const y=await ne.put(`/exhibitions/${t}/halls/${s}`,f);return console.log("Hall updated:",y.data),y}catch(i){return console.error("Error updating hall:",i),qe(i)}},deleteHall:async(t,s)=>{var n,i,r;try{if(!t||!s)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:t,hallId:s});const l=await ne.delete(`/exhibitions/${t}/halls/${s}`);if(!l.data)throw new Error("No response received from server");return l}catch(l){throw console.error("Error deleting hall:",l),((n=l.response)==null?void 0:n.status)===401?new Error("Unauthorized. Please log in again."):((i=l.response)==null?void 0:i.status)===403?new Error("You do not have permission to delete halls."):((r=l.response)==null?void 0:r.status)===404?new Error("Hall not found."):l}},saveLayout:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return{data:{halls:s}}}catch(n){return qe(n)}},getLayout:async t=>{try{if(!t)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${t}/layout`)}catch(s){return qe(s)}},getStalls:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${t}/stalls`,{params:{hallId:s}})}catch(n){return qe(n)}},createStall:async(t,s)=>{try{if(!t)throw new Error("Exhibition ID is required");return await ne.post(`/exhibitions/${t}/stalls`,s)}catch(n){return qe(n)}},updateStall:async(t,s,n)=>{try{if(!t||!s)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:t,stallId:s,data:n});const i=await ne.put(`/exhibitions/${t}/stalls/${s}`,n);return console.log("Stall update response:",i),i}catch(i){return console.error("Error updating stall:",i),qe(i)}},deleteStall:async(t,s)=>{try{if(!t||!s)throw new Error("Exhibition ID and Stall ID are required");return await ne.delete(`/exhibitions/${t}/stalls/${s}`)}catch(n){return qe(n)}},getFixtures:async(t,s)=>{try{const n=`/exhibitions/${t}/fixtures`,i=s?{type:s}:void 0;return await ne.get(n,{params:i})}catch(n){return qe(n)}},getFixture:async(t,s)=>{try{return await ne.get(`/exhibitions/${t}/fixtures/${s}`)}catch(n){return qe(n)}},createFixture:async(t,s)=>{try{return await ne.post(`/exhibitions/${t}/fixtures`,s)}catch(n){return qe(n)}},updateFixture:async(t,s,n)=>{try{return await ne.put(`/exhibitions/${t}/fixtures/${s}`,n)}catch(i){return qe(i)}},deleteFixture:async(t,s)=>{try{return await ne.delete(`/exhibitions/${t}/fixtures/${s}`)}catch(n){return qe(n)}}},Xd={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},wt=De("exhibition/fetchExhibitions",async(t,{rejectWithValue:s})=>{try{return(await Ie.getExhibitions()).data.map(r=>({...r,id:r._id||r.id})).filter(r=>r.id)}catch(n){return s(n.message)}}),ht=De("exhibition/fetchExhibition",async(t,{rejectWithValue:s})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.getExhibition(t)).data}catch(n){return s(n.message)}}),wn=De("exhibition/createExhibition",async(t,{rejectWithValue:s})=>{try{return(await Ie.createExhibition(t)).data}catch(n){return s(n.message)}}),Sn=De("exhibition/updateExhibition",async({id:t,data:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.updateExhibition(t,s)).data}catch(i){return n(i.message)}}),Nt=De("exhibition/fetchHalls",async(t,{rejectWithValue:s})=>{var n;try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.getHalls(t)).data}catch(i){return((n=i.response)==null?void 0:n.status)===404?[]:s(i.message)}}),It=De("exhibition/fetchStalls",async({exhibitionId:t,hallId:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.getStalls(t,s)).data}catch(i){return n(i.message)}}),$s=De("exhibition/deleteExhibition",async(t,{rejectWithValue:s})=>{try{return await Ie.deleteExhibition(t),t}catch(n){return s(n.message)}}),Fs=De("exhibition/fetchFixtures",async({exhibitionId:t,type:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.getFixtures(t,s)).data}catch(i){return n(i.message)}}),kn=De("exhibition/createFixture",async({exhibitionId:t,data:s},{rejectWithValue:n})=>{try{if(!t)throw new Error("Exhibition ID is required");return(await Ie.createFixture(t,s)).data}catch(i){return n(i.message)}}),In=De("exhibition/updateFixture",async({exhibitionId:t,id:s,data:n},{rejectWithValue:i})=>{try{if(!t||!s)throw new Error("Exhibition ID and Fixture ID are required");return(await Ie.updateFixture(t,s,n)).data}catch(r){return i(r.message)}}),Cn=De("exhibition/deleteFixture",async({exhibitionId:t,id:s},{rejectWithValue:n})=>{try{if(!t||!s)throw new Error("Exhibition ID and Fixture ID are required");return await Ie.deleteFixture(t,s),s}catch(i){return n(i.message)}}),Ya=ct({name:"exhibition",initialState:Xd,reducers:{clearCurrentExhibition:t=>{t.currentExhibition=null,t.halls=[],t.stalls=[],t.fixtures=[],t.error=null},clearError:t=>{t.error=null},clearStalls:t=>{t.stalls=[]},clearFixtures:t=>{t.fixtures=[]}},extraReducers:t=>{t.addCase(wt.pending,s=>{s.loading=!0,s.error=null}).addCase(wt.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions=n.payload}).addCase(wt.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(ht.pending,s=>{s.loading=!0,s.error=null}).addCase(ht.fulfilled,(s,n)=>{s.loading=!1,s.currentExhibition=n.payload}).addCase(ht.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(wn.pending,s=>{s.loading=!0,s.error=null}).addCase(wn.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions.push(n.payload)}).addCase(wn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Sn.pending,s=>{s.loading=!0,s.error=null}).addCase(Sn.fulfilled,(s,n)=>{s.loading=!1,s.currentExhibition=n.payload;const i=s.exhibitions.findIndex(r=>r.id===n.payload.id);i!==-1&&(s.exhibitions[i]=n.payload)}).addCase(Sn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Nt.pending,s=>{s.loading=!0,s.error=null}).addCase(Nt.fulfilled,(s,n)=>{s.loading=!1,s.halls=n.payload}).addCase(Nt.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(It.pending,s=>{s.loading=!0,s.error=null}).addCase(It.fulfilled,(s,n)=>{s.loading=!1;const i=n.payload.map(r=>{var l;return{...r,id:r._id||r.id,_id:r._id||r.id,stallTypeId:typeof r.stallTypeId=="string"?r.stallTypeId:(l=r.stallTypeId)==null?void 0:l._id,stallType:r.stallType||{name:"N/A",description:null}}});n.meta.arg.hallId,s.stalls=i}).addCase(It.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase($s.pending,s=>{s.loading=!0,s.error=null}).addCase($s.fulfilled,(s,n)=>{s.loading=!1,s.exhibitions=s.exhibitions.filter(i=>(i._id||i.id)!==n.payload)}).addCase($s.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Fs.pending,s=>{s.loading=!0,s.error=null}).addCase(Fs.fulfilled,(s,n)=>{s.loading=!1,s.fixtures=n.payload.map(i=>({...i,id:i._id||i.id,_id:i._id||i.id}))}).addCase(Fs.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(kn.pending,s=>{s.loading=!0,s.error=null}).addCase(kn.fulfilled,(s,n)=>{s.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id};s.fixtures.push(i)}).addCase(kn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(In.pending,s=>{s.loading=!0,s.error=null}).addCase(In.fulfilled,(s,n)=>{s.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id},r=s.fixtures.findIndex(l=>l.id===i.id||l._id===i._id);r!==-1&&(s.fixtures[r]=i)}).addCase(In.rejected,(s,n)=>{s.loading=!1,s.error=n.payload}).addCase(Cn.pending,s=>{s.loading=!0,s.error=null}).addCase(Cn.fulfilled,(s,n)=>{s.loading=!1,s.fixtures=s.fixtures.filter(i=>i.id!==n.payload&&i._id!==n.payload)}).addCase(Cn.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),{clearCurrentExhibition:jx,clearError:vx,clearStalls:wx,clearFixtures:Sx}=Ya.actions,Zd=Ya.reducer,Ue=(t,s)=>{if(!t)return"";let i=`/exhibition/${t.slug||t._id||t.id}`;return s&&(i+=`/${s}`),i},Kn=(t,s)=>t?`/exhibitions/${t.slug||t._id||t.id}`:"",{Title:Jd,Text:Wt}=pe,{RangePicker:eu}=Ys,tu=()=>{const{message:t,modal:s}=ft.useApp(),n=ve(),i=$e(),{exhibitions:r,loading:l}=ge(x=>x.exhibition),[a,f]=u.useState([]),[y,h]=u.useState(!1),[S,$]=u.useState(!1),[v,T]=u.useState({status:[],dateRange:null,search:"",activeStatus:null}),[I,j]=u.useState("all");u.useEffect(()=>{i(wt())},[i]);const R=u.useMemo(()=>{const x=r.length,E=r.filter(C=>C.status==="published").length,z=r.filter(C=>new Date(C.startDate)>new Date).length,A=r.filter(C=>C.status==="completed").length,m=r.filter(C=>C.isActive).length;return{total:x,active:E,upcoming:z,completed:A,activeCount:m}},[r]),d=async x=>{const E=x._id||x.id;try{h(!0),await i($s(E)).unwrap(),t.success("Exhibition deleted successfully")}catch(z){t.error(z.message||"Failed to delete exhibition")}finally{h(!1)}},p=async()=>{s.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ut,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsxs("strong",{children:[a.length," selected exhibitions"]}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(_,{onClick:()=>me.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(_,{danger:!0,type:"primary",onClick:async()=>{try{h(!0),await Promise.all(a.map(x=>i($s(x._id||x.id)).unwrap())),t.success(`Successfully deleted ${a.length} exhibitions`),f([])}catch(x){t.error(x.message||"Failed to delete some exhibitions")}finally{h(!1),me.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},k=async(x,E)=>{try{$(!0);const z=x._id||x.id;await Ie.updateExhibition(z,{status:E});const A=r.map(m=>(m._id||m.id)===z?{...m,status:E}:m);i(wt.fulfilled(A,"",void 0)),t.success("Status updated successfully")}catch{t.error("Failed to update status"),i(wt())}finally{$(!1)}},o=async(x,E)=>{try{$(!0);const z=x._id||x.id;await Ie.updateExhibition(z,{isActive:E});const A=r.map(m=>(m._id||m.id)===z?{...m,isActive:E}:m);i(wt.fulfilled(A,"",void 0)),t.success(`Exhibition ${E?"activated":"deactivated"} successfully`)}catch{t.error("Failed to update active status"),i(wt())}finally{$(!1)}},c=(x,E)=>{const z=x._id||x.id;E==="/layout"?n(Ue(x,"layout"),{state:{exhibitionId:z}}):n(Ue(x)+E,{state:{exhibitionId:z}})},D=x=>{switch(x.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},w=(x,E)=>{const z=D(x);return e.jsxs(G,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[e.jsx(le,{color:z,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:x}),!E&&e.jsx(le,{color:"red",style:{margin:0},children:"Inactive"})]})},P=x=>{const E=new Date,z=new Date(x.startDate),A=new Date(x.endDate);if(E<z)return 0;if(E>A)return 100;const m=A.getTime()-z.getTime(),C=E.getTime()-z.getTime();return Math.round(C/m*100)},g=x=>{s.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(ut,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsx("strong",{children:x.name}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(_,{onClick:()=>me.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(_,{danger:!0,type:"primary",onClick:()=>{d(x),me.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},b=x=>[{key:"view",label:"View Details",icon:e.jsx(Lt,{}),onClick:()=>c(x,"")},{key:"edit",label:"Edit Exhibition",icon:e.jsx(bs,{}),onClick:()=>c(x,"/edit")},{key:"layout",label:"Manage Layout",icon:e.jsx(ts,{}),onClick:()=>c(x,"/layout")},{type:"divider"},...x.status==="published"?[{key:"public-view",label:"Public View",icon:e.jsx(Lt,{}),onClick:()=>window.open(Kn(x),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:e.jsx(Mi,{}),children:[{key:"draft",label:e.jsxs(G,{children:[e.jsx(le,{color:"#faad14",style:{margin:0},children:"Draft"}),e.jsx("span",{children:"Set as Draft"})]}),icon:e.jsx(Bt,{}),onClick:()=>k(x,"draft"),disabled:x.status==="draft"||S},{key:"published",label:e.jsxs(G,{children:[e.jsx(le,{color:"#52c41a",style:{margin:0},children:"Published"}),e.jsx("span",{children:"Publish"})]}),icon:e.jsx(Ee,{}),onClick:()=>k(x,"published"),disabled:x.status==="published"||S},{key:"completed",label:e.jsxs(G,{children:[e.jsx(le,{color:"#1890ff",style:{margin:0},children:"Completed"}),e.jsx("span",{children:"Mark as Completed"})]}),icon:e.jsx(Ye,{}),onClick:()=>k(x,"completed"),disabled:x.status==="completed"||S}]},{key:"active-status",label:e.jsxs(G,{children:[x.isActive?e.jsx(le,{color:"red",style:{margin:0},children:"Deactivate"}):e.jsx(le,{color:"#52c41a",style:{margin:0},children:"Activate"}),e.jsx("span",{children:x.isActive?"Deactivate":"Activate"})]}),icon:e.jsx(tr,{}),onClick:()=>o(x,!x.isActive),disabled:S},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(ut,{}),danger:!0,onClick:()=>g(x)}],L=u.useMemo(()=>r.filter(x=>{if(v.search&&!x.name.toLowerCase().includes(v.search.toLowerCase())||v.status.length>0&&!v.status.includes(x.status)||v.activeStatus!==null&&x.isActive!==v.activeStatus)return!1;if(v.dateRange){const[E,z]=v.dateRange,A=new Date(x.startDate),m=new Date(x.endDate);if(A<new Date(E)||m>new Date(z))return!1}switch(I){case"active":return x.status==="published";case"upcoming":return new Date(x.startDate)>new Date;case"completed":return x.status==="completed";default:return!0}}),[r,v,I]),N=[{title:"Exhibition Details",key:"details",render:(x,E)=>e.jsx(Wt,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>c(E,""),children:E.name})},{title:"Status",key:"status",width:180,align:"center",render:(x,E)=>w(E.status,E.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(x,E)=>E.status===x},{title:"Start Date",key:"startDate",width:130,render:(x,E)=>e.jsx(Wt,{children:Ne(E.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(x,E)=>e.jsx(Wt,{children:Ne(E.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(x,E)=>e.jsx(Wt,{children:Ne(E.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(x,E)=>e.jsx(Ft,{percent:P(E),size:"small",status:E.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(x,E)=>e.jsxs(G,{size:"middle",children:[e.jsx(We,{title:"View Details",children:e.jsx(_,{type:"text",icon:e.jsx(Lt,{}),onClick:()=>c(E,"")})}),e.jsx(We,{title:"Edit Exhibition",children:e.jsx(_,{type:"text",icon:e.jsx(bs,{}),onClick:()=>c(E,"/edit")})}),e.jsx(zt,{menu:{items:b(E)},trigger:["click"],placement:"bottomRight",children:e.jsx(_,{type:"text",icon:e.jsx(Vn,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(M,{flex:"auto",children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(Jd,{level:4,style:{margin:0},children:"Exhibitions"}),e.jsx(Wt,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),e.jsx(M,{children:e.jsx(_,{type:"primary",icon:e.jsx(et,{}),onClick:()=>n("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginBottom:"24px"},children:[e.jsx(M,{xs:24,sm:12,md:6,lg:4,children:e.jsx(H,{children:e.jsx(ye,{title:"Total Exhibitions",value:R.total,prefix:e.jsx(Bt,{})})})}),e.jsx(M,{xs:24,sm:12,md:6,lg:5,children:e.jsx(H,{children:e.jsx(ye,{title:"Published Exhibitions",value:R.active,prefix:e.jsx(Ee,{style:{color:"#52c41a"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,lg:5,children:e.jsx(H,{children:e.jsx(ye,{title:"Upcoming Exhibitions",value:R.upcoming,prefix:e.jsx(Ye,{style:{color:"#1890ff"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,lg:5,children:e.jsx(H,{children:e.jsx(ye,{title:"Completed Exhibitions",value:R.completed,prefix:e.jsx(Ee,{style:{color:"#8c8c8c"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,lg:5,children:e.jsx(H,{children:e.jsx(ye,{title:"Active Status",value:R.activeCount,prefix:e.jsx(tr,{style:{color:"#52c41a"}})})})})]}),e.jsx(H,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:e.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(M,{flex:"auto",children:e.jsxs(G,{size:"middle",wrap:!0,children:[e.jsx(W,{placeholder:"Search exhibitions",prefix:e.jsx(mt,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:v.search,onChange:x=>T(E=>({...E,search:x.target.value})),allowClear:!0}),e.jsx(oe,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:v.status,onChange:x=>T(E=>({...E,status:x})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),e.jsxs(oe,{placeholder:"Active Status",style:{width:"150px"},value:v.activeStatus,onChange:x=>T(E=>({...E,activeStatus:x})),allowClear:!0,children:[e.jsx(oe.Option,{value:!0,children:"Active"}),e.jsx(oe.Option,{value:!1,children:"Inactive"})]}),e.jsx(eu,{onChange:x=>T(E=>{var z,A;return{...E,dateRange:x?[((z=x[0])==null?void 0:z.toISOString())||"",((A=x[1])==null?void 0:A.toISOString())||""]:null}})})]})}),e.jsx(M,{children:e.jsx(mo,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:I,onChange:x=>j(x)})})]}),a.length>0&&e.jsx(ie,{children:e.jsxs(G,{children:[e.jsxs(Wt,{children:["Selected ",a.length," items"]}),e.jsx(_,{danger:!0,onClick:p,children:"Delete Selected"})]})})]})}),e.jsx(H,{className:"info-card",styles:{body:{padding:0}},children:e.jsx(Re,{columns:N,dataSource:L.map(x=>({...x,key:x._id||x.id})),rowKey:x=>x._id||x.id,loading:l||y||S,rowSelection:{selectedRowKeys:a.map(x=>x._id||x.id),onChange:(x,E)=>f(E),selections:[Re.SELECTION_ALL,Re.SELECTION_NONE]},footer:()=>a.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[e.jsxs(Wt,{children:["Selected ",e.jsx("strong",{children:a.length})," ",a.length===1?"exhibition":"exhibitions"]}),e.jsx(_,{danger:!0,onClick:p,icon:e.jsx(ut,{}),loading:y,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:x=>`Total ${x} items`,style:{marginTop:"16px"}}})})]})},gs={getStallTypes:async()=>ne.get("/stall-types"),createStallType:async t=>ne.post("/stall-types",t),updateStallType:async(t,s)=>ne.put(`/stall-types/${t}`,s),deleteStallType:async t=>ne.delete(`/stall-types/${t}`)},{RangePicker:su}=Ys,{Title:Pt,Text:Dt}=pe,Mr=({value:t="",onChange:s})=>{const n=Ae.useRef(null),[i]=Ae.useState(t);return e.jsx(Zo,{apiKey:Dc,onInit:(r,l)=>{n.current=l},value:t,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:r=>{r.on("init",()=>{r.undoManager.clear(),r.undoManager.add()}),r.on("change",()=>{r.undoManager.add()})}},onEditorChange:r=>{s==null||s(r)}})},nu=({form:t})=>{const[s,n]=u.useState([]),[i,r]=u.useState(!1);return u.useEffect(()=>{(async()=>{try{r(!0);const a=await gs.getStallTypes();n(a.data.filter(f=>f.status==="active"))}catch(a){console.error("Failed to fetch stall types:",a)}finally{r(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(H,{className:"settings-card",children:[e.jsx(Pt,{level:4,children:"Basic Information"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:e.jsx(W,{placeholder:"Enter exhibition name"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(W.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:e.jsx(W.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:e.jsx(W,{placeholder:"Enter invoice prefix (default: INV)"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:e.jsx(su,{style:{width:"100%"}})})})]})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Pt,{level:4,children:"Company Details"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(M,{span:12,children:[e.jsx(F.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(W,{placeholder:"Enter company name"})}),e.jsx(F.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:e.jsx(W,{placeholder:"Enter contact number"})}),e.jsx(F.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{placeholder:"Enter email address"})}),e.jsx(F.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(W.TextArea,{rows:4,placeholder:"Enter company address"})}),e.jsx(F.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:e.jsx(Mr,{})})]}),e.jsxs(M,{span:12,children:[e.jsx(F.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:e.jsx(W,{placeholder:"Enter PAN number"})}),e.jsx(F.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:e.jsx(W,{placeholder:"Enter GST number"})}),e.jsx(F.Item,{name:"companySAC",label:"SAC Code No.",children:e.jsx(W,{placeholder:"Enter SAC code number"})}),e.jsx(F.Item,{name:"companyCIN",label:"CIN No.",children:e.jsx(W,{placeholder:"Enter CIN number"})}),e.jsx(F.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:e.jsx(W,{placeholder:"Enter website URL"})}),e.jsx(F.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:e.jsx(Mr,{})})]})]})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Pt,{level:4,children:"Bank Details"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(M,{span:12,children:[e.jsx(F.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:e.jsx(W,{placeholder:"Enter bank name"})}),e.jsx(F.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:e.jsx(W,{placeholder:"Enter branch name"})}),e.jsx(F.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:e.jsx(W,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),e.jsxs(M,{span:12,children:[e.jsx(F.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:e.jsx(W,{placeholder:"Enter account name"})}),e.jsx(F.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:e.jsx(W,{placeholder:"Enter account number"})})]})]})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Pt,{level:4,children:"Stall Rates & Pricing"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Pt,{level:5,children:"Stall Type Rates"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),e.jsx(F.List,{name:"stallRates",children:(l,{add:a,remove:f})=>e.jsxs(e.Fragment,{children:[l.map(({key:y,name:h,...S})=>e.jsxs(G,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(F.Item,{...S,name:[h,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(oe,{loading:i,placeholder:"Select stall type",style:{width:200},children:s.map($=>e.jsx(oe.Option,{value:$._id,children:$.name},$._id))})}),e.jsx(F.Item,{...S,name:[h,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:e.jsx(Fe,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"â‚¹",formatter:$=>`${$}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:$=>{const v=$?Number($.replace(/\â‚¹\s?|(,*)/g,"")):0;return isNaN(v)?0:v}})}),e.jsx(ms,{onClick:()=>f(h)})]},y)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(et,{}),children:"Add Stall Type Rate"})})]})})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Pt,{level:5,children:"Tax Configuration"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),e.jsx(F.List,{name:"taxConfig",children:(l,{add:a,remove:f})=>e.jsxs(e.Fragment,{children:[l.map(({key:y,name:h,...S})=>e.jsxs(G,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(F.Item,{...S,name:[h,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:e.jsx(W,{placeholder:"Tax name",style:{width:150}})}),e.jsx(F.Item,{...S,name:[h,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:e.jsx(Fe,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:$=>`${$}%`,parser:$=>{const v=$?Number($.replace("%","")):0;return isNaN(v)?0:Math.min(v,100)}})}),e.jsx(F.Item,{...S,name:[h,"isActive"],valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(ms,{onClick:()=>f(h)})]},y)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(et,{}),children:"Add Tax"})})]})})]}),e.jsxs("div",{children:[e.jsx(Pt,{level:5,children:"Admin Discount Configuration"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),e.jsx(F.List,{name:"discountConfig",children:(l,{add:a,remove:f})=>e.jsxs(e.Fragment,{children:[l.map(({key:y,name:h,...S})=>e.jsxs(G,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(F.Item,{...S,name:[h,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(W,{placeholder:"Discount",style:{width:150}})}),e.jsx(F.Item,{...S,name:[h,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(oe,{style:{width:150},children:[e.jsx(oe.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(oe.Option,{value:"fixed",children:"Fixed Amount (â‚¹)"})]})}),e.jsx(F.Item,{noStyle:!0,shouldUpdate:($,v)=>{var T,I,j,R;return((I=(T=$==null?void 0:$.discountConfig)==null?void 0:T[h])==null?void 0:I.type)!==((R=(j=v==null?void 0:v.discountConfig)==null?void 0:j[h])==null?void 0:R.type)},children:({getFieldValue:$})=>{const v=$(["discountConfig",h,"type"]);return e.jsx(F.Item,{...S,name:[h,"value"],rules:[{required:!0,message:`Please enter ${v==="percentage"?"percentage":"amount"}`}],children:e.jsx(Fe,{min:0,max:v==="percentage"?100:void 0,placeholder:v==="percentage"?"Percentage":"Amount",style:{width:150},formatter:T=>v==="percentage"?`${T}%`:`â‚¹${T}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:T=>{const I=T?Number(T.replace(/[â‚¹%,]/g,"")):0;return isNaN(I)?0:I}})})}}),e.jsx(F.Item,{...S,name:[h,"isActive"],valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(ms,{onClick:()=>f(h)})]},y)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(et,{}),children:"Add Admin Discount"})})]})})]}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(Pt,{level:5,children:"Public Discount Configuration"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),e.jsx(F.List,{name:"publicDiscountConfig",children:(l,{add:a,remove:f})=>e.jsxs(e.Fragment,{children:[l.map(({key:y,name:h,...S})=>e.jsxs(G,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(F.Item,{...S,name:[h,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(W,{placeholder:"Discount",style:{width:150}})}),e.jsx(F.Item,{...S,name:[h,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(oe,{style:{width:150},children:[e.jsx(oe.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(oe.Option,{value:"fixed",children:"Fixed Amount (â‚¹)"})]})}),e.jsx(F.Item,{noStyle:!0,shouldUpdate:($,v)=>{var T,I,j,R;return((I=(T=$==null?void 0:$.publicDiscountConfig)==null?void 0:T[h])==null?void 0:I.type)!==((R=(j=v==null?void 0:v.publicDiscountConfig)==null?void 0:j[h])==null?void 0:R.type)},children:({getFieldValue:$})=>{const v=$(["publicDiscountConfig",h,"type"]);return e.jsx(F.Item,{...S,name:[h,"value"],rules:[{required:!0,message:`Please enter ${v==="percentage"?"percentage":"amount"}`}],children:e.jsx(Fe,{min:0,max:v==="percentage"?100:void 0,placeholder:v==="percentage"?"Percentage":"Amount",style:{width:150},formatter:T=>v==="percentage"?`${T}%`:`â‚¹${T}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:T=>{const I=T?Number(T.replace(/[â‚¹%,]/g,"")):0;return isNaN(I)?0:I}})})}}),e.jsx(F.Item,{...S,name:[h,"isActive"],valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(ms,{onClick:()=>f(h)})]},y)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(et,{}),children:"Add Public Discount"})})]})})]})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Pt,{level:4,children:"Status Settings"}),e.jsx(Dt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(oe,{children:[e.jsx(oe.Option,{value:"draft",children:"Draft"}),e.jsx(oe.Option,{value:"published",children:"Published"}),e.jsx(oe.Option,{value:"completed",children:"Completed"})]})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:zr,Text:oi}=pe,iu=({form:t})=>{const{message:s}=ft.useApp(),[n,i]=u.useState([]),[r,l]=u.useState([]),[a,f]=u.useState(0),[y,h]=u.useState({}),S=j=>{const R=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${j}`,token:R}};u.useEffect(()=>{const j=t.getFieldValue("headerLogo");if(j){const{url:R,token:d}=S(j);fetch(R,{headers:{authorization:`Bearer ${d}`}}).then(p=>p.blob()).then(p=>{const k=URL.createObjectURL(p);i([{uid:"-1",name:j.split("/").pop()||"logo",status:"done",url:k,thumbUrl:k,type:p.type,response:{path:j}}])}).catch(()=>{i([])})}},[t]),u.useEffect(()=>{const j=t.getFieldValue("sponsorLogos")||[];j.length>0&&Promise.all(j.map(async(R,d)=>{const{url:p,token:k}=S(R);try{const c=await(await fetch(p,{headers:{authorization:`Bearer ${k}`}})).blob(),D=URL.createObjectURL(c);return{uid:`-${d+1}`,name:R.split("/").pop()||`sponsor-${d+1}`,status:"done",url:D,thumbUrl:D,type:c.type,response:{path:R}}}catch{return null}})).then(R=>{l(R.filter(Boolean))})},[t]);const $={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(j){const{status:R,name:d,response:p,uid:k}=j.file;if(R==="uploading"){i([...j.fileList]);return}if(R==="done"&&p){const{url:o,token:c}=S(p.path);f(0),fetch(o,{headers:{authorization:`Bearer ${c}`}}).then(D=>D.blob()).then(D=>{const w=URL.createObjectURL(D);i([{uid:j.file.uid,name:d,status:"done",url:w,thumbUrl:w,type:D.type,response:p}]),s.success(`${d} uploaded successfully`),t.setFieldValue("headerLogo",p.path),p.thumbnail&&t.setFieldValue("headerLogoThumbnail",p.thumbnail)}).catch(()=>{s.error(`${d} preview failed to load`),i([])})}else R==="error"?(s.error(`${d} upload failed.`),i([]),f(0)):R==="removed"&&(i([]),t.setFieldValue("headerLogo",null),t.setFieldValue("headerLogoThumbnail",null),f(0))},customRequest:async j=>{const{onProgress:R,onSuccess:d,onError:p,file:k,action:o,headers:c}=j;try{const D=new FormData;D.append("file",k);const w=new XMLHttpRequest;w.open("POST",o||"",!0),c&&Object.keys(c).forEach(P=>{w.setRequestHeader(P,c[P])}),w.upload.onprogress=P=>{P.lengthComputable&&R&&(R({percent:P.loaded/P.total*100}),f(Math.round(P.loaded/P.total*100)))},w.onload=()=>{if(w.status>=200&&w.status<300)try{const P=JSON.parse(w.response);d==null||d(P,k),f(0)}catch(P){p==null||p(P)}else p==null||p(new Error("Upload failed"))},w.onerror=()=>{f(0),p==null||p(new Error("Upload request failed"))},w.send(D)}catch(D){f(0),p==null||p(D)}},onRemove(){return i([]),t.setFieldValue("headerLogo",null),t.setFieldValue("headerLogoThumbnail",null),f(0),!0},onPreview:async j=>{if(!j.url)return;const R=window.open("");R&&(R.document.write(`
          <img src="${j.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),R.document.head.innerHTML="<title>Image Preview</title>")}},v={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:r,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(j){const{status:R,name:d,response:p,uid:k}=j.file;if(R==="uploading"){l([...j.fileList]);return}if(R==="done"&&p&&p.paths&&p.paths.length>0){h(w=>{const P={...w};return delete P[k],P});const o=p.paths[0],{url:c,token:D}=S(o);fetch(c,{headers:{authorization:`Bearer ${D}`}}).then(w=>w.blob()).then(w=>{const P=URL.createObjectURL(w),g=[...r],b=g.findIndex(x=>x.uid===j.file.uid),L={uid:j.file.uid,name:d,status:"done",url:P,thumbUrl:P,type:w.type,response:{path:o}};b>-1?g[b]=L:g.push(L),l(g),s.success(`${d} uploaded successfully`);const N=g.filter(x=>{var E;return x.status==="done"&&((E=x.response)==null?void 0:E.path)}).map(x=>x.response.path);if(t.setFieldValue("sponsorLogos",N),p.thumbnails&&p.thumbnails.length>0){const x=t.getFieldValue("sponsorLogoThumbnails")||[];t.setFieldValue("sponsorLogoThumbnails",[...x,...p.thumbnails])}}).catch(()=>{s.error(`${d} preview failed to load`),l(w=>w.filter(P=>P.uid!==j.file.uid))})}else R==="error"?(s.error(`${d} upload failed.`),l(o=>o.filter(c=>c.uid!==j.file.uid)),h(o=>{const c={...o};return delete c[k],c})):R==="removed"&&h(o=>{const c={...o};return delete c[k],c})},customRequest:async j=>{const{onProgress:R,onSuccess:d,onError:p,file:k,action:o,headers:c}=j,D=typeof k=="object"&&"uid"in k?k.uid:String(Date.now());try{const w=new FormData;w.append("file",k);const P=new XMLHttpRequest;P.open("POST",o||"",!0),c&&Object.keys(c).forEach(g=>{P.setRequestHeader(g,c[g])}),P.upload.onprogress=g=>{if(g.lengthComputable&&R){const b=g.loaded/g.total*100;R({percent:b}),h(L=>({...L,[D]:Math.round(b)}))}},P.onload=()=>{if(P.status>=200&&P.status<300)try{const g=JSON.parse(P.response);d==null||d(g,k),h(b=>{const L={...b};return delete L[D],L})}catch(g){p==null||p(g)}else p==null||p(new Error("Upload failed"))},P.onerror=()=>{h(g=>{const b={...g};return delete b[D],b}),p==null||p(new Error("Upload request failed"))},P.send(w)}catch(w){h(P=>{const g={...P};return delete g[D],g}),p==null||p(w)}},onRemove(j){var k;const R=r.filter(o=>o.uid!==j.uid);l(R);const d=R.filter(o=>{var c;return o.status==="done"&&((c=o.response)==null?void 0:c.path)}).map(o=>o.response.path);t.setFieldValue("sponsorLogos",d);const p=t.getFieldValue("sponsorLogoThumbnails")||[];if(p.length>0&&(k=j.response)!=null&&k.path){const o=j.response.path.split("/"),c=o[o.length-1],D=p.filter(w=>!w.includes(c));t.setFieldValue("sponsorLogoThumbnails",D)}return h(o=>{const c={...o};return delete c[j.uid],c}),!0},onPreview:async j=>{if(!j.url)return;const R=window.open("");R&&(R.document.write(`
          <img src="${j.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),R.document.head.innerHTML="<title>Image Preview</title>")}},T=e.jsx("div",{children:a>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Ft,{type:"circle",percent:a,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),I=e.jsxs("div",{children:[e.jsx(Us,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return e.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:e.jsxs(H,{className:"settings-card",children:[e.jsx(zr,{level:4,children:"Header Settings"}),e.jsx(oi,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),e.jsxs(ie,{gutter:24,children:[e.jsx(M,{span:24,children:e.jsxs(F.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(zs,{...$,children:n.length<1&&T}),n.length>0&&a>0&&e.jsx(Ft,{percent:a,status:"active",style:{marginTop:8}})]})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:e.jsx(W,{placeholder:"Enter a title for your exhibition header"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:e.jsx(W,{placeholder:"Enter a subtitle (optional)"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:e.jsx(W.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),e.jsxs(M,{span:24,children:[e.jsx(Le,{}),e.jsx(zr,{level:5,children:"Sponsor Logos"}),e.jsx(oi,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),e.jsxs(F.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[e.jsx(zs,{...v,children:I}),Object.entries(y).map(([j,R])=>{var d;return e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[e.jsxs(oi,{style:{marginRight:10,width:150},ellipsis:!0,children:[((d=r.find(p=>p.uid===j))==null?void 0:d.name)||"File",":"]}),e.jsx(Ft,{percent:R,status:"active",style:{flex:1}})]},j)})]})]})]})]})})},{Title:Ur,Text:qr}=pe,ru=({form:t})=>{const{message:s}=ft.useApp(),[n,i]=u.useState([]),r=a=>{const f=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${a}`,token:f}};u.useEffect(()=>{const a=t.getFieldValue("footerLogo");if(a){const{url:f,token:y}=r(a);fetch(f,{headers:{authorization:`Bearer ${y}`}}).then(h=>h.blob()).then(h=>{const S=URL.createObjectURL(h);i([{uid:"-1",name:a.split("/").pop()||"logo",status:"done",url:S,thumbUrl:S,type:h.type,response:{path:a}}])}).catch(()=>{i([])})}},[t]);const l={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:f,name:y,response:h}=a.file;if(f==="uploading"){i([...a.fileList]);return}if(f==="done"&&h){const{url:S,token:$}=r(h.path);fetch(S,{headers:{authorization:`Bearer ${$}`}}).then(v=>v.blob()).then(v=>{const T=URL.createObjectURL(v);i([{uid:a.file.uid,name:y,status:"done",url:T,thumbUrl:T,type:v.type,response:h}]),s.success(`${y} uploaded successfully`),t.setFieldValue("footerLogo",h.path)}).catch(()=>{s.error(`${y} preview failed to load`),i([])})}else f==="error"?(s.error(`${y} upload failed.`),i([])):f==="removed"&&(i([]),t.setFieldValue("footerLogo",null))},onRemove(){return i([]),t.setFieldValue("footerLogo",null),!0},onPreview:async a=>{if(!a.url)return;const f=window.open("");f&&(f.document.write(`
          <img src="${a.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),f.document.head.innerHTML="<title>Image Preview</title>")}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(H,{className:"settings-card",children:[e.jsx(Ur,{level:4,children:"Footer Content"}),e.jsx(qr,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),e.jsxs(ie,{gutter:24,children:[e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:e.jsx(zs,{...l,children:n.length<1&&e.jsxs("div",{children:[e.jsx(Us,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:e.jsx(W.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:e.jsx(W,{placeholder:"Enter contact email"})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:e.jsx(W,{placeholder:"Enter contact phone number"})})})]})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ur,{level:4,children:"Footer Links"}),e.jsx(qr,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),e.jsx(F.List,{name:"footerLinks",children:(a,{add:f,remove:y})=>e.jsxs(e.Fragment,{children:[a.map(({key:h,name:S,...$})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(M,{span:11,children:e.jsx(F.Item,{...$,name:[S,"label"],rules:[{required:!0,message:"Please enter link label"}],children:e.jsx(W,{placeholder:"Link Label"})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{...$,name:[S,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:e.jsx(W,{placeholder:"URL (e.g., https://example.com)"})})}),e.jsx(M,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(ms,{onClick:()=>y(S)})})]},h)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>f(),block:!0,icon:e.jsx(et,{}),children:"Add Footer Link"})})]})})]})]})},{Title:_r,Text:Or}=pe,au=()=>e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(H,{className:"settings-card",children:[e.jsx(_r,{level:4,children:"Exhibition Amenities"}),e.jsx(Or,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add amenities and facilities available at your exhibition with their rates"}),e.jsx(F.List,{name:"amenities",children:(t,{add:s,remove:n})=>e.jsxs(e.Fragment,{children:[t.map(({key:i,name:r,...l})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(M,{span:6,children:e.jsx(F.Item,{...l,name:[r,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(oe,{placeholder:"Select type",children:[e.jsx(oe.Option,{value:"facility",children:"Facility"}),e.jsx(oe.Option,{value:"service",children:"Service"}),e.jsx(oe.Option,{value:"equipment",children:"Equipment"}),e.jsx(oe.Option,{value:"other",children:"Other"})]})})}),e.jsx(M,{span:6,children:e.jsx(F.Item,{...l,name:[r,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(W,{placeholder:"Enter name (e.g. Power)"})})}),e.jsx(M,{span:7,children:e.jsx(F.Item,{...l,name:[r,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(W.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(M,{span:4,children:e.jsx(F.Item,{...l,name:[r,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:e.jsx(Fe,{style:{width:"100%"},placeholder:"Enter rate",prefix:"â‚¹",min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:a=>{const f=a?Number(a.replace(/\â‚¹\s?|(,*)/g,"")):0;return isNaN(f)?0:f}})})}),e.jsx(M,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(ms,{onClick:()=>n(r)})})]},i)),e.jsx(F.Item,{children:e.jsx(_,{type:"dashed",onClick:()=>s(),block:!0,icon:e.jsx(et,{}),children:"Add Amenity"})})]})})]}),e.jsxs(H,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(_r,{level:4,children:"Special Requirements"}),e.jsx(Or,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),e.jsx(ie,{gutter:24,children:e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:e.jsx(W.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),Qa=({initialValues:t,onSubmit:s,submitText:n="Submit"})=>{const[i]=F.useForm(),r=a=>{s(a)},l=[{key:"general",label:"General",children:e.jsx(nu,{form:i})},{key:"header",label:"Header",children:e.jsx(iu,{form:i})},{key:"footer",label:"Footer",children:e.jsx(ru,{form:i})},{key:"amenities",label:"Amenities",children:e.jsx(au,{form:i})}];return e.jsx(F,{form:i,layout:"vertical",initialValues:t,onFinish:r,style:{height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,marginBottom:"24px"},children:e.jsx(at,{defaultActiveKey:"general",items:l,type:"card"})}),e.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:e.jsx(_,{type:"primary",htmlType:"submit",children:n})})]})})},ou=()=>{const t=ve(),s=$e(),n=async i=>{var r;try{const[l,a]=i.dateRange,f={name:i.name,description:i.description,venue:i.venue,startDate:l.toISOString(),endDate:a.toISOString(),status:i.status||"draft",isActive:i.isActive??!0,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:{width:100,height:100},taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((r=i.amenities)==null?void 0:r.map(S=>({type:S.type,name:S.name,description:S.description,rate:S.rate})))||[],specialRequirements:i.specialRequirements},y=await s(wn(f)).unwrap();ee.success("Exhibition created successfully");const h=y._id||y.id;h?t(Ue({_id:h,id:h,name:f.name}),{state:{exhibitionId:h}}):(ee.error("Exhibition ID not found in response"),t("/exhibition"))}catch(l){ee.error(l.message||"Failed to create exhibition"),console.error("Error creating exhibition:",l)}};return e.jsx(H,{title:"Create New Exhibition",children:e.jsx(Qa,{onSubmit:n,submitText:"Create Exhibition"})})},{Title:Vr,Text:Ge,Paragraph:li}=pe,ci=()=>{const t=ve();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>t("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},lu=()=>{const{id:t}=ot(),s=ve(),n=$e(),{currentExhibition:i,halls:r,stalls:l,loading:a}=ge(j=>j.exhibition),[f,y]=u.useState(0);u.useEffect(()=>{t&&(n(ht(t)),n(Nt(t)),n(It({exhibitionId:t})))},[t,n]),u.useEffect(()=>{i&&S()},[i]);const h=()=>{if(!i)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const j=r.length||0;let R=l.length||0,d=l.filter(p=>p.status==="booked"||p.status==="reserved").length;return R===0&&(i.stalls&&i.stalls.length>0?(R=i.stalls.length,d=i.stalls.filter(p=>p.status==="booked"||p.status==="reserved").length):(R=i.stallCount||0,d=i.bookedStallCount||0)),{hallCount:j,stallCount:R,bookedStallCount:d,availableStallCount:R-d}},S=()=>{if(!i)return 0;const j=new Date,R=new Date(i.startDate),d=new Date(i.endDate);if(j<R)return y(0);if(j>d)return y(100);const p=d.getTime()-R.getTime(),k=j.getTime()-R.getTime();y(Math.round(k/p*100))},$=j=>{switch(j.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},v=()=>{if(!i)return{text:"",count:0,isPast:!1};const j=new Date,R=new Date(i.startDate),d=new Date(i.endDate);return j>d?{text:"Ended",count:Math.ceil((j.getTime()-d.getTime())/864e5),isPast:!0}:j>=R&&j<=d?{text:"Days Remaining",count:Math.ceil((d.getTime()-j.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((R.getTime()-j.getTime())/(1e3*60*60*24)),isPast:!1}},T=j=>{s(Ue(i,j))};if(a)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ci,{}),e.jsx(H,{children:e.jsx(ga,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!i)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ci,{}),e.jsx(H,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(Ws,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx(Vr,{level:4,children:"Exhibition not found"}),e.jsx(li,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const I=v();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(ci,{}),e.jsx(H,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsxs(M,{xs:24,md:16,children:[e.jsx(Vr,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:i.name}),e.jsx(li,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:i.description}),e.jsxs(G,{split:e.jsx(Le,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(G,{children:[e.jsx(kt,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(Ge,{style:{color:"rgba(255,255,255,0.8)"},children:[Ne(i.startDate).format("MMM D, YYYY")," - ",Ne(i.endDate).format("MMM D, YYYY")]})]}),i.venue&&e.jsxs(G,{children:[e.jsx(Jt,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(Ge,{style:{color:"rgba(255,255,255,0.8)"},children:i.venue})]})]})]}),e.jsx(M,{xs:24,md:8,children:e.jsxs(H,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:$(i.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:i.status.toUpperCase()}),e.jsx(ye,{title:I.text,value:I.count,suffix:"days",valueStyle:{color:I.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(Ye,{})}),e.jsx(Le,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(Ge,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(Ft,{percent:f,status:f===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(M,{xs:24,sm:8,children:e.jsx(_,{type:"primary",icon:e.jsx(ts,{}),onClick:()=>T(`${t}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(_,{icon:e.jsx(bs,{}),onClick:()=>T(`${t}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(M,{xs:24,sm:8,children:e.jsx(_,{icon:e.jsx(Lt,{}),onClick:()=>window.open(Kn(i),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:i.status!=="published",children:"View Public Page"})})]}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:24,lg:16,children:e.jsxs(H,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsxs(M,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(Ge,{strong:!0,style:{fontSize:"16px"},children:Ne(i.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(Ge,{strong:!0,style:{fontSize:"16px"},children:Ne(i.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(Ge,{strong:!0,style:{fontSize:"16px"},children:Ne(i.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(M,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(le,{color:$(i.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(le,{color:i.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.isActive?"ACTIVE":"INACTIVE"})]}),i.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(Ge,{strong:!0,style:{fontSize:"16px"},children:i.venue})]})]})]}),e.jsx(Le,{}),e.jsxs("div",{children:[e.jsx(Ge,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(li,{children:i.description||"No description provided."})]})]})}),e.jsxs(M,{xs:24,lg:8,children:[e.jsx(H,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:e.jsxs(ie,{gutter:[16,24],children:[e.jsx(M,{span:12,children:e.jsx(ye,{title:"Halls",value:h().hallCount,prefix:e.jsx(Qs,{})})}),e.jsx(M,{span:12,children:e.jsx(ye,{title:"Stalls",value:h().stallCount,prefix:e.jsx(rt,{})})}),e.jsx(M,{span:12,children:e.jsx(ye,{title:"Booked Stalls",value:h().bookedStallCount,prefix:e.jsx(Ee,{})})}),e.jsx(M,{span:12,children:e.jsx(ye,{title:"Available Stalls",value:h().availableStallCount,prefix:e.jsx(go,{})})})]})}),e.jsx(H,{title:"Created By",style:{borderRadius:"12px"},children:i.createdBy?e.jsxs(G,{children:[e.jsx(gt,{icon:e.jsx(ke,{})}),e.jsx(Ge,{children:i.createdByName||"Administrator"})]}):e.jsx(Ge,{type:"secondary",children:"Information not available"})})]})]})]})},cu=()=>{var T;const{message:t}=ft.useApp(),{id:s}=ot(),i=(T=qt().state)==null?void 0:T.exhibitionId,r=ve(),l=$e(),{currentExhibition:a,loading:f,error:y}=ge(I=>I.exhibition),[h,S]=u.useState(!1);u.useEffect(()=>{(async()=>{if(!i){t.error("Exhibition ID not found"),r("/exhibition");return}try{await l(ht(i)).unwrap()}catch(j){t.error(j.message||"Failed to fetch exhibition"),r("/exhibition")}finally{S(!0)}})()},[i,l,t,r]),u.useEffect(()=>{y&&t.error(y)},[y,t]);const $=async I=>{var j;if(!(!i||!a))try{const[R,d]=I.dateRange,p={name:I.name,description:I.description,venue:I.venue,startDate:R.toISOString(),endDate:d.toISOString(),status:I.status,isActive:I.isActive,invoicePrefix:I.invoicePrefix,stallRates:I.stallRates||[],dimensions:a.dimensions,taxConfig:I.taxConfig||[],discountConfig:I.discountConfig||[],publicDiscountConfig:I.publicDiscountConfig||[],companyName:I.companyName,companyContactNo:I.companyContactNo,companyEmail:I.companyEmail,companyAddress:I.companyAddress,companyWebsite:I.companyWebsite,companyPAN:I.companyPAN,companyGST:I.companyGST,companySAC:I.companySAC,companyCIN:I.companyCIN,termsAndConditions:I.termsAndConditions,piInstructions:I.piInstructions,bankName:I.bankName,bankBranch:I.bankBranch,bankIFSC:I.bankIFSC,bankAccountName:I.bankAccountName,bankAccount:I.bankAccount,headerTitle:I.headerTitle,headerSubtitle:I.headerSubtitle,headerDescription:I.headerDescription,headerLogo:I.headerLogo,sponsorLogos:I.sponsorLogos||[],footerText:I.footerText,footerLogo:I.footerLogo,contactEmail:I.contactEmail,contactPhone:I.contactPhone,footerLinks:I.footerLinks||[],amenities:((j=I.amenities)==null?void 0:j.map(k=>({type:k.type,name:k.name,description:k.description,rate:k.rate})))||[],specialRequirements:I.specialRequirements};await l(Sn({id:i,data:p})).unwrap(),t.success("Exhibition updated successfully"),r(Ue(a),{state:{exhibitionId:i}})}catch(R){t.error(R.message||"Failed to update exhibition")}};if(!h)return e.jsx(H,{loading:!0});if(!i)return e.jsx(Hn,{to:"/exhibition",replace:!0});if(f||!a)return e.jsx(H,{loading:!0});const v={name:a.name,description:a.description,venue:a.venue,dateRange:[Ne(a.startDate),Ne(a.endDate)],status:a.status,isActive:a.isActive,invoicePrefix:a.invoicePrefix,stallRates:a.stallRates||[],taxConfig:a.taxConfig||[],discountConfig:a.discountConfig||[],publicDiscountConfig:a.publicDiscountConfig||[],companyName:a.companyName,companyContactNo:a.companyContactNo,companyEmail:a.companyEmail,companyAddress:a.companyAddress,companyWebsite:a.companyWebsite,companyPAN:a.companyPAN,companyGST:a.companyGST,companySAC:a.companySAC,companyCIN:a.companyCIN,termsAndConditions:a.termsAndConditions,piInstructions:a.piInstructions,bankName:a.bankName,bankBranch:a.bankBranch,bankIFSC:a.bankIFSC,bankAccountName:a.bankAccountName,bankAccount:a.bankAccount,headerTitle:a.headerTitle,headerSubtitle:a.headerSubtitle,headerDescription:a.headerDescription,headerLogo:a.headerLogo,sponsorLogos:a.sponsorLogos||[],footerText:a.footerText,footerLogo:a.footerLogo,contactEmail:a.contactEmail,contactPhone:a.contactPhone,footerLinks:a.footerLinks||[],amenities:a.amenities||[],specialRequirements:a.specialRequirements};return e.jsx(H,{title:"Edit Exhibition",extra:e.jsx("a",{onClick:()=>r(Ue(a),{state:{exhibitionId:i}}),children:"Back to Details"}),children:e.jsx(Qa,{initialValues:v,onSubmit:$,submitText:"Update Exhibition"})})},du=({width:t,height:s,scale:n=1,position:i={x:0,y:0},isSelected:r=!1,onSelect:l=()=>{},onChange:a=()=>{},children:f,isEditable:y=!0})=>{const h=$=>{y&&(l(),$.cancelBubble=!0)},S=Ae.useMemo(()=>{const $=[];for(let T=0;T<=t;T+=5)$.push(e.jsx(Bn,{points:[T,0,T,s],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`v${T}`));for(let T=0;T<=s;T+=5)$.push(e.jsx(Bn,{points:[0,T,t,T],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`h${T}`));return $},[t,s,n]);return e.jsxs(js,{x:i.x,y:i.y,width:t,height:s,onClick:h,children:[e.jsx(Wn,{width:t,height:s,fill:"#ffffff",stroke:r&&y?"#1890ff":"#d9d9d9",strokeWidth:r&&y?2/n:1/n,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/n,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/n}),e.jsx(js,{children:S}),e.jsx(Os,{text:`${t}m Ã— ${s}m`,fontSize:14/n,fill:"#666666",x:5,y:5}),f]})},uu=({visible:t,width:s,height:n,onCancel:i,onSubmit:r})=>{const[l]=F.useForm();Ae.useEffect(()=>{t&&l.setFieldsValue({width:s,height:n})},[t,s,n,l]);const a=()=>{l.validateFields().then(f=>{r(f),l.resetFields()})};return e.jsx(me,{title:"Edit Exhibition Space",open:t,onCancel:()=>{l.resetFields(),i()},onOk:a,destroyOnClose:!0,children:e.jsxs(F,{form:l,layout:"vertical",initialValues:{width:s,height:n},children:[e.jsx(F.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(Fe,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),e.jsx(F.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(Fe,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},Ga=({hall:t,isSelected:s=!1,onSelect:n,onChange:i,scale:r=1,position:l={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:f=100,isStallMode:y=!1})=>{const h=Ae.useRef(null),S=Ae.useRef(null),$=Ae.useMemo(()=>{const d=[],{width:p,height:k}=t.dimensions,o=1;for(let c=0;c<=p;c+=o)d.push(e.jsx(Bn,{points:[c,0,c,k],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`v${c}`));for(let c=0;c<=k;c+=o)d.push(e.jsx(Bn,{points:[0,c,p,c],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`h${c}`));return d},[t.dimensions.width,t.dimensions.height,r]);Ae.useEffect(()=>{var d;s&&S.current&&h.current&&(S.current.nodes([h.current]),(d=S.current.getLayer())==null||d.batchDraw())},[s]);const v=d=>{d.cancelBubble=!0;const p=d.target,k=p.x(),o=p.y(),c=Math.max(0,Math.min(k,a-t.dimensions.width)),D=Math.max(0,Math.min(o,f-t.dimensions.height));p.x(Math.round(c)),p.y(Math.round(D))},T=d=>{d.cancelBubble=!0;const p=d.target,k=Math.max(0,Math.min(p.x(),a-t.dimensions.width)),o=Math.max(0,Math.min(p.y(),f-t.dimensions.height));i==null||i({...t,_id:t._id,id:t.id||t._id,exhibitionId:t.exhibitionId,dimensions:{...t.dimensions,x:Math.round(k),y:Math.round(o)}})},I=d=>{d.cancelBubble=!0},j=d=>{if(!h.current)return;const p=h.current,k=p.scaleX(),o=p.scaleY();p.scaleX(1),p.scaleY(1);const c=Math.round(p.width()*k),D=Math.round(p.height()*o),w=p.x(),P=p.y(),g=Math.max(0,Math.min(w,a-c)),b=Math.max(0,Math.min(P,f-D));i==null||i({...t,_id:t._id,id:t.id||t._id,exhibitionId:t.exhibitionId,dimensions:{x:g,y:b,width:Math.max(5,Math.min(c,a-g)),height:Math.max(5,Math.min(D,f-b))}})},R=d=>{d.cancelBubble=!0,n==null||n(t)};return e.jsxs(js,{ref:h,x:t.dimensions.x,y:t.dimensions.y,width:t.dimensions.width,height:t.dimensions.height,draggable:!y&&!!i,onClick:R,onTap:R,onDragStart:I,onDragMove:v,onDragEnd:T,onTransformEnd:j,children:[e.jsx(Wn,{width:t.dimensions.width,height:t.dimensions.height,fill:"#ffffff",stroke:s?"#1890ff":"#d9d9d9",strokeWidth:s?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}),e.jsx(js,{children:$}),e.jsx(Os,{text:t.name,fontSize:14/r,fill:"#000000",width:t.dimensions.width,align:"center",y:t.dimensions.height/2-7/r})]})},hu=t=>{if(!t)return"";const s=window.location.origin,n=t.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${s}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${s}/api/uploads/${n}?token=${i}`:""},Ka=({fixture:t,isSelected:s=!1,onSelect:n,onChange:i,scale:r=1,position:l={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:f=100,isEditable:y=!0})=>{const h=Ae.useRef(null),S=Ae.useRef(null),[$,v]=u.useState("");u.useEffect(()=>{if(t.icon){const o=hu(t.icon);v(o)}else v("")},[t.icon]);const[T]=Jo($);Ae.useEffect(()=>{var o;s&&S.current&&h.current&&(S.current.nodes([h.current]),(o=S.current.getLayer())==null||o.batchDraw())},[s]);const I=o=>{o.cancelBubble=!0},j=o=>{o.cancelBubble=!0;const c=o.target,D=c.x(),w=c.y(),P=Math.max(0,Math.min(D,a-t.dimensions.width)),g=Math.max(0,Math.min(w,f-t.dimensions.height));c.x(Math.round(P)),c.y(Math.round(g))},R=o=>{o.cancelBubble=!0;const c=o.target,D=c.x(),w=c.y(),P=Math.max(0,Math.min(D,a-t.dimensions.width)),g=Math.max(0,Math.min(w,f-t.dimensions.height)),b=t._id||t.id;i==null||i({...t,_id:b,id:b,exhibitionId:t.exhibitionId,position:{x:Math.round(P),y:Math.round(g)}})},d=o=>{if(!h.current)return;const c=h.current,D=c.scaleX(),w=c.scaleY(),P=c.rotation();c.scaleX(1),c.scaleY(1);const g=Math.round(t.dimensions.width*D),b=Math.round(t.dimensions.height*w),L=c.x(),N=c.y(),x=Math.max(0,Math.min(L,a-g)),E=Math.max(0,Math.min(N,f-b)),z=t._id||t.id;i==null||i({...t,_id:z,id:z,exhibitionId:t.exhibitionId,position:{x,y:E},dimensions:{width:Math.max(.5,Math.min(g,a-x)),height:Math.max(.5,Math.min(b,f-E))},rotation:P})},p=o=>{o.cancelBubble=!0,n==null||n(t)},k=()=>{const o=t.borderColor||(s?"#1890ff":"#d9d9d9"),c=t.borderRadius!==void 0?t.borderRadius/r:3/r;return T?e.jsx(tl,{image:T,width:t.dimensions.width,height:t.dimensions.height,fill:t.color||"#ffffff",stroke:o,strokeWidth:s?2/r:1/r,cornerRadius:c,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}):e.jsx(Wn,{width:t.dimensions.width,height:t.dimensions.height,fill:t.color||"#f0f2f5",stroke:o,strokeWidth:s?2/r:1/r,cornerRadius:c,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5})};return e.jsxs(e.Fragment,{children:[e.jsxs(js,{ref:h,x:t.position.x,y:t.position.y,width:t.dimensions.width,height:t.dimensions.height,rotation:t.rotation||0,draggable:y&&!!i,onClick:p,onTap:p,onDragStart:I,onDragMove:j,onDragEnd:R,onTransformEnd:d,children:[k(),t.name&&t.showName!==!1&&e.jsx(Os,{text:t.name,fontSize:12/r,fill:"#000000",width:t.dimensions.width,align:"center",y:-16/r})]}),s&&y&&e.jsx(el,{ref:S,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(o,c)=>c.width<.5||c.height<.5?o:c})]})},xu=({visible:t,x:s,y:n,onExhibitionClick:i,onHallClick:r,onStallClick:l,onFixtureClick:a,onClose:f})=>{if(!t)return null;const y=[{key:"exhibition",icon:e.jsx(ts,{}),label:"Exhibition Space",onClick:()=>{i(),f()}},{key:"hall",icon:e.jsx(Qs,{}),label:"Add Hall",onClick:()=>{r(),f()}}];return l&&y.push({key:"stall",icon:e.jsx(rt,{}),label:"Add Stall",onClick:()=>{l(),f()}}),a&&y.push({key:"fixture",icon:e.jsx(Rn,{}),label:"Add Fixture",onClick:()=>{a(),f()}}),e.jsx("div",{style:{position:"fixed",top:n,left:s,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:e.jsx(nt,{items:y})})},Xi=({stall:t,isSelected:s=!1,onSelect:n,onChange:i,hallWidth:r=0,hallHeight:l=0,hallX:a=0,hallY:f=0,scale:y=1})=>{const h=Ae.useRef(null),[S,$]=u.useState(!1),[v,T]=u.useState(0);u.useEffect(()=>{T(S?1:0)},[S]),u.useEffect(()=>{S&&h.current&&h.current.getStage()&&h.current.moveToTop()},[S]);const I=s||t.isSelected,j=g=>{switch(g){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},R=g=>{switch(g){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},d=g=>{g.cancelBubble=!0;const b=g.target,L=b.x()-a,N=b.y()-f,x=Math.max(0,Math.min(L,r-t.dimensions.width)),E=Math.max(0,Math.min(N,l-t.dimensions.height));b.x(Math.round(x+a)),b.y(Math.round(E+f))},p=g=>{g.cancelBubble=!0;const b=g.target,L=b.x()-a,N=b.y()-f,x=Math.max(0,Math.min(L,r-t.dimensions.width)),E=Math.max(0,Math.min(N,l-t.dimensions.height));i&&i({...t,id:t.id||t._id,_id:t._id||t.id,dimensions:{...t.dimensions,x:Math.round(x),y:Math.round(E)}})},k=g=>{g.cancelBubble=!0},o=g=>{g.cancelBubble=!0,n&&n()},c={x:0,y:0,width:10,height:10},D=t.dimensions||c,w=t.typeName||"Standard";return t.ratePerSqm*D.width*D.height,e.jsxs(js,{ref:h,x:D.x+a,y:D.y+f,width:D.width,height:D.height,draggable:!!i,onClick:o,onTap:o,onDragStart:k,onDragMove:d,onDragEnd:p,opacity:t.status==="available"?1:.7,cursor:t.status==="available"?"pointer":"default",onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),children:[e.jsx(Wn,{width:D.width,height:D.height,fill:I?"rgba(24, 144, 255, 0.1)":R(t.status),stroke:I?"#1890ff":j(t.status),strokeWidth:I?2/y:1/y,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:3,shadowOffset:{x:1,y:1},shadowOpacity:.3,rotation:0}),e.jsx(Os,{text:t.number,fontSize:Math.min(D.width,D.height)*.25,fill:"#000000",width:D.width,height:D.height,align:"center",verticalAlign:"middle"}),I&&e.jsx(sl,{x:D.width-2,y:2,radius:1.5,fill:"#1890ff",stroke:"#ffffff",strokeWidth:.3/y}),S&&e.jsxs(nl,{x:D.width/2,y:0,opacity:1,children:[e.jsx(il,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7}),e.jsx(Os,{text:t.status!=="available"&&t.companyName?`${w} - ${D.width}Ã—${D.height}m - ${t.companyName}`:`${w} - ${D.width}Ã—${D.height}m`,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(t.status!=="available"&&t.companyName?`${w} - ${D.width}Ã—${D.height}m - ${t.companyName}`.length*.7:`${w} - ${D.width}Ã—${D.height}m`.length*.7,25),height:3,verticalAlign:"middle"})]})]})},Xs=({width:t,height:s,exhibitionWidth:n=100,exhibitionHeight:i=100,halls:r=[],stalls:l=[],fixtures:a=[],selectedHall:f=null,selectedFixture:y=null,onSelectHall:h=()=>{},onSelectFixture:S=()=>{},onHallChange:$=()=>{},onFixtureChange:v=()=>{},onExhibitionChange:T=()=>{},onAddHall:I=()=>{},onAddStall:j=()=>{},onAddFixture:R=()=>{},children:d,isStallMode:p=!1,isFixtureMode:k=!1})=>{const o=Ae.useRef(null),[c,D]=u.useState(1),[w,P]=u.useState({x:0,y:0}),[g,b]=u.useState(!1),[L,N]=u.useState(!1),[x,E]=u.useState({visible:!1,x:0,y:0}),[z,A]=u.useState(!1),[m,C]=u.useState(!1),B=u.useCallback(U=>{if(U.evt.preventDefault(),!o.current)return;const X=o.current,J=c,re=X.getPointerPosition(),ae={x:(re.x-X.x())/J,y:(re.y-X.y())/J},ce=1.15,Se=U.evt.deltaY<0?J*ce:J/ce,Be=Math.min(Math.max(.1,Se),20),Ve={x:re.x-ae.x*Be,y:re.y-ae.y*Be};D(Be),P(Ve)},[c]),q=u.useCallback(()=>{if(!o.current)return;const U=o.current,X=Math.min(c*1.15,20),J=U.width()/2,re=U.height()/2,ae={x:(J-w.x)/c,y:(re-w.y)/c},ce={x:J-ae.x*X,y:re-ae.y*X};D(X),P(ce)},[c,w]),O=u.useCallback(()=>{if(!o.current)return;const U=o.current,X=Math.max(c/1.15,.1),J=U.width()/2,re=U.height()/2,ae={x:(J-w.x)/c,y:(re-w.y)/c},ce={x:J-ae.x*X,y:re-ae.y*X};D(X),P(ce)},[c,w]),Y=u.useCallback(U=>{U.target===o.current&&(E({...x,visible:!1}),N(!0))},[x]),Z=u.useCallback(U=>{var X;U.target===o.current&&(P({x:U.target.x(),y:U.target.y()}),(X=o.current)==null||X.batchDraw(),N(!1))},[]),te=u.useCallback(()=>{b(!0),document.body.style.cursor=L?"grabbing":"grab"},[L]),V=u.useCallback(()=>{b(!1),document.body.style.cursor="default"},[]),Q=U=>{var J,re,ae;const X=U.target.getClassName();if(X==="Stage"||X==="Layer"){E({...x,visible:!1});return}if(X==="Group"||X==="Rect"){h(null),S(null);const ce=(J=o.current)==null?void 0:J.getPointerPosition();if(ce&&se(ce)){const{x:Se,y:Be}=ce,{x:Ve,y:Ss}=((re=o.current)==null?void 0:re.position())||{x:0,y:0},{x:Zs,y:Js}=((ae=o.current)==null?void 0:ae.scale())||{x:1,y:1},At=(Se-Ve)/Zs,Ot=(Be-Ss)/Js;E({x:At,y:Ot,visible:!0})}else E({...x,visible:!1})}else E({...x,visible:!1})},se=U=>{if(!n||!i||!o.current)return!1;const{x:X,y:J}=U,{x:re,y:ae}=o.current.position(),{x:ce}=o.current.scale(),Se={x:(X-re)/ce,y:(J-ae)/ce};return Se.x>=0&&Se.x<=n&&Se.y>=0&&Se.y<=i},he=u.useCallback(()=>{h(null),S(null),A(!0),C(!0),E({...x,visible:!1})},[h,S,x]),we=u.useCallback(U=>{T(U),C(!1)},[T]),ue=()=>{A(!0),C(!0),E({...x,visible:!1})},de=()=>{I(),E({...x,visible:!1})},be=()=>{j(),E({...x,visible:!1})};u.useEffect(()=>{if(t>0&&s>0&&n>0&&i>0){const U=p?20:40,X=t-U*2,J=s-U*2,re=X/n,ae=J/i,Se=Math.min(re,ae),Be=(t-n*Se)/2,Ve=(s-i*Se)/2;D(Se),P({x:Be,y:Ve}),o.current&&o.current.batchDraw()}},[t,s,n,i,p]);const Xe=Ae.Children.map(d,U=>Ae.isValidElement(U)?Ae.cloneElement(U,{scale:c,position:w}):U);return t<=0||s<=0||n<=0||i<=0?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:g?L?"grabbing":"grab":"default"},children:[e.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:e.jsxs(G,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[e.jsx(_,{icon:e.jsx(fo,{}),onClick:O,disabled:c<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),e.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(c*100),"%"]}),e.jsx(_,{icon:e.jsx(yo,{}),onClick:q,disabled:c>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),e.jsx(rl,{ref:o,width:t,height:s,onClick:Q,draggable:!0,onDragStart:Y,onDragEnd:Z,onMouseEnter:te,onMouseLeave:V,onWheel:B,x:w.x,y:w.y,scaleX:c,scaleY:c,children:e.jsx(al,{children:e.jsxs(du,{width:n,height:i,scale:c,position:{x:0,y:0},isSelected:z,onSelect:k?void 0:he,onChange:p||k?void 0:T,isEditable:!p&&!k,children:[r.map(U=>e.jsx(Ga,{hall:U,isSelected:(f==null?void 0:f.id)===U.id,onSelect:()=>h(U),onChange:p||k?void 0:$,scale:c,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isStallMode:p||k},U._id||U.id)),l.map(U=>{const X=U._id||U.id,J=r.find(re=>re.id===U.hallId||re._id===U.hallId);return J?e.jsx(Xi,{stall:{...U,_id:X,id:X},hallX:J.dimensions.x,hallY:J.dimensions.y,hallWidth:J.dimensions.width,hallHeight:J.dimensions.height,scale:c},X):null}),a.map(U=>{const X=U._id||U.id,re=((y==null?void 0:y._id)||(y==null?void 0:y.id))===X;return e.jsx(Ka,{fixture:{...U,_id:X,id:X},isSelected:re,onSelect:()=>S(U),onChange:k?v:void 0,scale:c,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isEditable:k},X)}),Xe]})})}),e.jsx(xu,{visible:x.visible,x:x.x,y:x.y,onExhibitionClick:ue,onHallClick:de,onStallClick:be,onClose:()=>E({...x,visible:!1})}),e.jsx(uu,{visible:m,width:n,height:i,onCancel:()=>C(!1),onSubmit:we})]})},pu=({visible:t,hall:s,exhibitionWidth:n,exhibitionHeight:i,onCancel:r,onSubmit:l,onDelete:a})=>{const[f]=F.useForm();Ae.useEffect(()=>{t&&(s?f.setFieldsValue({name:s.name,width:s.dimensions.width,height:s.dimensions.height}):f.setFieldsValue({name:"",width:Math.min(10,n),height:Math.min(10,i)}))},[t,s,n,i,f]);const y=async()=>{var v,T;const S=await f.validateFields(),$=s?{...s,_id:s._id,id:s.id||s._id,name:S.name,dimensions:{x:((v=s.dimensions)==null?void 0:v.x)||0,y:((T=s.dimensions)==null?void 0:T.y)||0,width:S.width,height:S.height},exhibitionId:s.exhibitionId}:{name:S.name,dimensions:{x:0,y:0,width:S.width,height:S.height}};l($),f.resetFields()},h=()=>{s&&a&&me.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${s.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>a(s)})};return e.jsx(me,{title:s?"Edit Hall":"Add New Hall",open:t,onCancel:()=>{f.resetFields(),r()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:e.jsxs(F,{form:f,layout:"vertical",style:{marginTop:"16px"},children:[e.jsx(F.Item,{name:"name",label:e.jsxs("span",{style:{color:"#000"},children:["Hall Name ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:e.jsx(W,{placeholder:"Enter hall name"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsx(F.Item,{name:"width",label:e.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:n,message:`Width cannot exceed ${n} meters`}],children:e.jsx(Fe,{min:5,max:n,style:{width:"100%"},placeholder:"Enter width"})}),e.jsx(F.Item,{name:"height",label:e.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:i,message:`Height cannot exceed ${i} meters`}],children:e.jsx(Fe,{min:5,max:i,style:{width:"100%"},placeholder:"Enter height"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[e.jsx(G,{children:s&&a&&e.jsx(_,{className:"delete-button",icon:e.jsx(ut,{}),onClick:h,children:"Delete Hall"})}),e.jsxs(G,{children:[e.jsx(_,{onClick:()=>{f.resetFields(),r()},children:"Cancel"}),e.jsx(_,{type:"primary",onClick:y,className:"update-button",children:s?"Update Hall":"Create Hall"})]})]})]})})},{Title:mu}=pe,gu=({visible:t,stall:s,hall:n,exhibition:i,onCancel:r,onSubmit:l,onDelete:a})=>{const[f]=F.useForm(),[y,h]=u.useState([]),[S,$]=u.useState(!1),v=(d,p,k,o,c)=>{const w=[...k].sort((g,b)=>{const L=Math.floor(g.dimensions.y/5),N=Math.floor(b.dimensions.y/5);return L===N?g.dimensions.x-b.dimensions.x:g.dimensions.y-b.dimensions.y}),P=(g,b)=>g+d>o||b+p>c?!1:!w.some(L=>{const N=L.dimensions.x,x=L.dimensions.y,E=L.dimensions.width,z=L.dimensions.height,A=1;return!(g+d+A<=N||g>=N+E+A||b+p+A<=x||b>=x+z+A)});for(const g of w){const b=g.dimensions.x+g.dimensions.width+1,L=g.dimensions.y;if(P(b,L))return{x:b,y:L};const N=g.dimensions.x,x=g.dimensions.y+g.dimensions.height+1;if(P(N,x))return{x:N,y:x}}for(let g=0;g<c;g+=5)for(let b=0;b<o;b+=5)if(P(b,g))return{x:b,y:g};return{x:0,y:0}};u.useEffect(()=>{if(s){console.log("Setting form values for stall:",s);const d={number:s.number,stallTypeId:s.stallTypeId,width:s.dimensions.width,height:s.dimensions.height,ratePerSqm:s.ratePerSqm,status:s.status};console.log("Form values to set:",d),f.setFieldsValue(d)}else n&&!f.getFieldValue("status")&&f.setFieldsValue({status:"available",width:Math.min(20,n.dimensions.width/4),height:Math.min(20,n.dimensions.height/4),ratePerSqm:0})},[s,n,f]),u.useEffect(()=>{t&&(async()=>{var p;try{$(!0);const k=await gs.getStallTypes();console.log("Fetched stall types:",k.data);const o=((p=i.stallRates)==null?void 0:p.map(D=>D.stallTypeId))||[];console.log("Configured stall type IDs:",o);const c=k.data.filter(D=>D.status==="active"&&D._id&&o.includes(D._id));console.log("Filtered stall types:",c),h(c)}catch(k){console.error("Failed to fetch stall types:",k)}finally{$(!1)}})()},[t,i.stallRates]);const T=d=>{var k;console.log("Stall type changed to:",d);const p=(k=i.stallRates)==null?void 0:k.find(o=>o.stallTypeId===d);console.log("Found stall rate:",p),p&&f.setFieldsValue({ratePerSqm:p.rate})},I=()=>{f.resetFields(),r()},j=()=>{if(console.log("Hall data:",n),!n||!n._id&&!n.id){ee.error("Invalid hall selected. Please try again.");return}f.validateFields().then(d=>{var c;const p=n._id||n.id;if(!p){ee.error("Hall ID is missing. Please select a hall again.");return}const k=s?{x:s.dimensions.x,y:s.dimensions.y}:v(d.width,d.height,((c=i.stalls)==null?void 0:c.filter(D=>D.hallId===p))||[],n.dimensions.width,n.dimensions.height),o={id:s==null?void 0:s.id,_id:s==null?void 0:s._id,number:d.number,stallTypeId:d.stallTypeId,dimensions:{x:k.x,y:k.y,width:d.width,height:d.height},ratePerSqm:d.ratePerSqm,status:d.status,hallId:p};console.log("Submitting stall data:",o),l(o)})},R=d=>{switch(d){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return e.jsx(e.Fragment,{children:e.jsx(me,{title:e.jsxs(G,{children:[e.jsx(rt,{style:{fontSize:"20px"}}),e.jsx(mu,{level:4,style:{margin:0},children:s?"Edit Stall":"Add Stall"})]}),open:t,onCancel:I,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[e.jsxs(G,{size:"middle",children:[s&&a&&e.jsx(_,{danger:!0,icon:e.jsx(ut,{}),onClick:()=>a(s),children:"Delete"}),e.jsx(_,{onClick:I,children:"Cancel"}),e.jsx(_,{type:"primary",onClick:j,children:s?"Save Changes":"Create"})]},"footer-buttons")],children:e.jsxs(F,{form:f,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[e.jsx(F.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:e.jsx(W,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),e.jsx(F.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(oe,{loading:S,placeholder:"Select stall type",size:"large",onChange:T,children:y.map(d=>e.jsx(oe.Option,{value:d._id,children:d.name},d._id))})}),e.jsx(Le,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),e.jsxs(G,{style:{width:"100%",gap:"16px"},children:[e.jsx(F.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:e.jsx(Fe,{min:1,max:(n==null?void 0:n.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),e.jsx(F.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:e.jsx(Fe,{min:1,max:(n==null?void 0:n.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),e.jsx(Le,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),e.jsx(F.Item,{name:"ratePerSqm",label:"Rate per sq.m (â‚¹)",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:e.jsx(Fe,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"â‚¹",disabled:!0,formatter:d=>`${d}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:d=>{const p=d?Number(d.replace(/\â‚¹\s?|(,*)/g,"")):0;return isNaN(p)?0:p}})}),e.jsx(F.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(oe,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[e.jsx(oe.Option,{value:"available",children:e.jsxs(G,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:R("available")}}),"Available"]})}),e.jsx(oe.Option,{value:"booked",children:e.jsxs(G,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:R("booked")}}),"Booked"]})}),e.jsx(oe.Option,{value:"reserved",children:e.jsxs(G,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:R("reserved")}}),"Reserved"]})})]})})]})})})},Hr=t=>{if(!t)return"";const s=window.location.origin,n=t.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${s}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${s}/api/uploads/${n}?token=${i}`:""},fu=({name:t,type:s,color:n,rotation:i,showName:r,iconUrl:l,defaultIcons:a,borderColor:f=null,borderRadius:y=0})=>{u.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:t,type:s,color:n,rotation:i,showName:r,iconUrl:l,defaultIconAvailable:!!a[s],borderColor:f,borderRadius:y})},[t,s,n,i,r,l,a,f,y]);const h=a[s]||"ðŸ“¦";return e.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[e.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${y||4}px`,backgroundColor:n||"#f0f0f0",transform:`rotate(${i}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:f?`1px solid ${f}`:"1px solid rgba(0,0,0,0.05)"},children:l?e.jsx("img",{src:l,alt:t,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):e.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:h})}),r&&e.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:t}),e.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[e.jsx("span",{children:s.charAt(0).toUpperCase()+s.slice(1)}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:n}),i>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[i,"Â°"]})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Border: ",f]})]}),y>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Radius: ",y,"px"]})]})]})]})},{Text:yu}=pe,di=({activeKey:t,form:s,fixture:n,exhibitionWidth:i,exhibitionHeight:r,selectedType:l,showName:a,iconFileList:f,fixtureTypes:y,fixtureIcons:h,defaultColors:S,defaultDimensions:$,colorPresets:v,uploadProps:T,iconPreviewVisible:I=!1,previewImage:j="",onTypeChange:R,onColorChange:d,onShowNameChange:p,onIconPreviewCancel:k=()=>{}})=>{switch(t){case"basic":return o();case"position":return c();case"appearance":return D();default:return o()}function o(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(F.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:e.jsx(W,{placeholder:"Enter fixture name",prefix:e.jsx(Ws,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(F.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:e.jsx(it,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:w=>{p(w),console.log("Form values after showName toggle:",s.getFieldsValue(!0))}})}),e.jsx(F.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:e.jsx(oe,{placeholder:"Select fixture type",onChange:R,options:y.map(w=>({...w,label:e.jsxs(G,{children:[e.jsx("span",{style:{fontSize:16},children:h[w.value]}),e.jsx("span",{children:w.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function c(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(H,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:e.jsx(Fe,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"X position"})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:e.jsx(Fe,{style:{width:"100%",borderRadius:"8px"},min:0,max:r,step:.1,precision:1,placeholder:"Y position"})})})]})}),e.jsx(H,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:e.jsx(Fe,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:e.jsx(Fe,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),e.jsx(H,{size:"small",title:e.jsxs("span",{children:[e.jsx(bo,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsx(F.Item,{name:"rotation",noStyle:!0,children:e.jsx(fa,{min:0,max:360,marks:{0:"0Â°",90:"90Â°",180:"180Â°",270:"270Â°",360:"360Â°"},tooltip:{formatter:w=>`${w}Â°`},style:{marginTop:10},keyboard:!1})})})]})}function D(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(F.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(w,P)=>{try{return P?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:e.jsx(sr,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:v,onChange:d,style:{width:"100%"}})}),e.jsx(F.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:e.jsx(sr,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:v,style:{width:"100%"}})}),e.jsx(F.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:e.jsx(Fe,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),e.jsxs(H,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[e.jsx("div",{style:{marginBottom:0},children:e.jsx(zs,{...T,children:f.length<1&&e.jsxs("div",{children:[e.jsx(jo,{style:{fontSize:20}}),e.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),e.jsx(yu,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),e.jsx(F.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:e.jsx(W,{placeholder:"https://example.com/icon.png",prefix:e.jsx(vo,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(me,{open:I,title:"Icon Preview",footer:null,onCancel:k,children:e.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:j})})]})}},bu=t=>[{key:"basic",label:e.jsxs("span",{children:[e.jsx(Qs,{}),"Basic Info"]}),children:e.jsx(di,{...t,activeKey:"basic"})},{key:"position",label:e.jsxs("span",{children:[e.jsx(Jt,{}),"Position"]}),children:e.jsx(di,{...t,activeKey:"position"})},{key:"appearance",label:e.jsxs("span",{children:[e.jsx(Us,{}),"Appearance"]}),children:e.jsx(di,{...t,activeKey:"appearance"})}],{Text:kx,Title:Ix}=pe,{TabPane:Cx}=at,ju=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],dn={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},$t={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},ui={sofa:"ðŸ›‹ï¸",chair:"ðŸª‘",table:"ðŸªŸ",desk:"ðŸ–¥ï¸",plant:"ðŸª´",entrance:"ðŸšª",exit:"ðŸšª",info:"â„¹ï¸",restroom:"ðŸš»",food:"ðŸ½ï¸",custom:"ðŸ“¦"},vu=({visible:t,fixture:s,onCancel:n,onSubmit:i,onDelete:r,exhibitionWidth:l,exhibitionHeight:a})=>{const[f]=F.useForm(),[y,h]=u.useState(!1),[S,$]=u.useState(""),[v,T]=u.useState("basic"),[I,j]=u.useState(""),[R,d]=u.useState([]),[p,k]=u.useState(!1),[o,c]=u.useState(""),{message:D}=ft.useApp(),[w,P]=u.useState("#f0f0f0"),[g,b]=u.useState("New Fixture"),[L,N]=u.useState("chair"),[x,E]=u.useState(0),[z,A]=u.useState(!0),[m,C]=u.useState(null),[B,q]=u.useState(0);u.useEffect(()=>{if(t)if(s){const U=se(s.color),X=$t[s.type]||"#f0f0f0",J=U||X;console.log("Setting up fixture colors:",{original:s.color,normalized:U,fallback:X,final:J}),P(J),b(s.name),N(s.type),E(s.rotation||0),$(s.type),A(s.showName!==!1),C(s.borderColor||null),q(s.borderRadius||0)}else{const U="chair",X=$t[U];P(X),b("New Fixture"),N(U),E(0),$(U),A(!0),C(null),q(0)}},[t,s]),u.useEffect(()=>{if(t&&f){if(s){const U=se(s.color),X=$t[s.type]||"#f0f0f0",J=U||X;f.setFieldsValue({name:s.name,type:s.type,position:{x:s.position.x,y:s.position.y},dimensions:{width:s.dimensions.width,height:s.dimensions.height},rotation:s.rotation||0,color:J,icon:s.icon||"",showName:s.showName!==!1,borderColor:s.borderColor||null,borderRadius:s.borderRadius||0});const re=s.icon?Hr(s.icon):"";j(re),s.icon?d([{uid:"-1",name:s.icon.split("/").pop()||"icon",status:"done",url:re,thumbUrl:re}]):d([])}else{const U="chair",X=$t[U];f.setFieldsValue({name:"New Fixture",type:U,position:{x:Math.floor(l/2),y:Math.floor(a/2)},dimensions:dn[U],rotation:0,color:X,icon:"",showName:!0,borderColor:null,borderRadius:0}),j(""),d([])}T("basic")}},[t,s,f,l,a]);const O=()=>{if(f&&t)try{const U=f.getFieldsValue(!0);if(U.name&&b(U.name),U.type&&N(U.type),U.rotation!==void 0&&E(U.rotation),U.color){const X=se(U.color);X&&P(X)}if(U.showName!==void 0&&A(U.showName),U.borderColor!==void 0){const X=U.borderColor?se(U.borderColor):null;C(X)}U.borderRadius!==void 0&&q(U.borderRadius)}catch(U){console.log("Error updating preview",U)}};u.useEffect(()=>{if(f&&t)return f.getFieldsValue,O(),()=>{}},[f,t]);const Y=U=>{if($(U),N(U),!s){const X=$t[U]||$t.custom;f.setFieldsValue({dimensions:dn[U]||dn.custom,color:X}),P(X)}},Z=U=>{const X=se(U);f.setFieldValue("color",X),P(X);const J=Object.entries($t).find(([re,ae])=>ae.toLowerCase()===X.toLowerCase());J&&!s&&(f.setFieldValue("type",J[0]),$(J[0]),N(J[0]))},te=()=>(console.log("Rendering fixture preview with:",{name:g,type:L,color:w,rotation:x,showName:z,iconUrl:I,borderColor:m,borderRadius:B}),e.jsx(fu,{name:g,type:L,color:w,rotation:x,showName:z,iconUrl:I,defaultIcons:ui,borderColor:m,borderRadius:B})),V=({file:U,fileList:X})=>{var J;if(U.status==="uploading"&&d(X),U.status==="done"){D.success(`${U.name} uploaded successfully`);let ae=(((J=U.response)==null?void 0:J.url)||"").replace(/^\/api\/uploads\//,"");ae&&!ae.startsWith("fixtures/")&&(ae=`fixtures/${ae.replace(/^\//,"")}`),console.log("Icon path stored in form:",ae),f.setFieldValue("icon",ae);const ce=Hr(ae);console.log("Using direct backend URL:",ce),j(ce);const Se=U.name.toLowerCase().endsWith(".svg"),Be=X.map(Ve=>Ve.uid===U.uid?{...Ve,url:ce,thumbUrl:ce,type:Se?"image/svg+xml":Ve.type}:Ve);d(Be),console.log("Form values after icon upload:",f.getFieldsValue(!0))}U.status==="error"&&(D.error(`${U.name} upload failed.`),d(X.filter(re=>re.uid!==U.uid)))},Q={name:"file",action:`${ne.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:R,onChange:V,onPreview:U=>{c(U.url||U.thumbUrl||""),k(!0)},onRemove:()=>(j(""),d([]),f.setFieldValue("icon",""),console.log("Form values after icon removal:",f.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:e.jsx(ut,{style:{color:"#ff4d4f"}})}},se=U=>{try{if(!U)return"#f0f0f0";if(typeof U=="object"&&U!==null){if(typeof U.toHexString=="function")return U.toHexString();if(U.rgb||U.hex)return U.hex||`rgb(${U.rgb.r},${U.rgb.g},${U.rgb.b})`}if(typeof U=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(U))return U;if(/^([0-9A-F]{3}){1,2}$/i.test(U))return`#${U}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(U))return U}return"#f0f0f0"}catch(X){return console.error("Error normalizing color:",X),"#f0f0f0"}},he=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],we=Ae.useCallback(()=>{s&&r&&r(s)},[s,r]),ue=U=>{T(U),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},de=bu({form:f,fixture:s,exhibitionWidth:l,exhibitionHeight:a,selectedType:S,showName:z,iconFileList:R,fixtureTypes:ju,fixtureIcons:ui,defaultColors:$t,defaultDimensions:dn,colorPresets:he,uploadProps:Q,iconPreviewVisible:p,previewImage:o,onTypeChange:Y,onColorChange:Z,onShowNameChange:U=>A(U),onIconPreviewCancel:()=>k(!1),activeKey:v}),be=async()=>{try{h(!0);const U=await f.validateFields();b(U.name),N(U.type),E(U.rotation||0),P(se(U.color)),A(U.showName),C(U.borderColor?se(U.borderColor):null),q(U.borderRadius||0);let X="";U.icon?X=Xe(U.icon):s!=null&&s.icon&&(X=s.icon),console.log("Form values being submitted:",{name:U.name,type:U.type,color:U.color,icon:U.icon,originalIcon:s==null?void 0:s.icon,cleanedIcon:X,showName:U.showName,borderColor:U.borderColor,borderRadius:U.borderRadius});const J=(s==null?void 0:s._id)||(s==null?void 0:s.id)||"",re=U.color?se(U.color):(s==null?void 0:s.color)||"#f0f0f0",ae=U.borderColor?se(U.borderColor):null,ce={...s,id:J,_id:J,name:U.name,type:U.type,position:U.position,dimensions:U.dimensions,rotation:U.rotation,color:re,icon:X,zIndex:(s==null?void 0:s.zIndex)||1,isActive:(s==null?void 0:s.isActive)!==void 0?s.isActive:!0,borderColor:ae,borderRadius:U.borderRadius||0};J&&(ce.showName=U.showName),console.log("Submitting fixture with icon path:",X),console.log("Color being submitted:",re),await i(ce),n()}catch(U){console.error("Fixture submission failed:",U),D.error("Failed to save fixture. Please check the form and try again.")}finally{h(!1)}},Xe=U=>{if(!U||typeof U!="string")return"";if(U.startsWith("fixtures/")&&!U.includes("?")&&!U.includes("http"))return U;let X=U.replace(/^\/api\/uploads\//,"");if(X=X.replace(/^\//,""),X.includes("?")||X.includes("http")){const J=X.split("?")[0].split("/").pop()||"";if(J)return`fixtures/${J}`}return X&&!X.startsWith("fixtures/")?`fixtures/${X}`:X};return e.jsxs(me,{title:e.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:24,marginRight:8},children:s?ui[s.type]:"ðŸª‘"}),e.jsx("span",{children:s?`Edit ${s.name}`:"Add New Fixture"})]}),open:t,onCancel:n,confirmLoading:y,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:s&&r&&e.jsx(_,{danger:!0,icon:e.jsx(ut,{}),onClick:we,style:{borderRadius:"6px"},children:"Delete"})}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(_,{onClick:n,icon:e.jsx(wo,{}),style:{borderRadius:"6px"},children:"Cancel"}),e.jsx(_,{type:"primary",onClick:be,icon:e.jsx(vs,{}),style:{borderRadius:"6px"},children:s?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),te(),e.jsx(F,{form:f,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:O,children:e.jsx(at,{activeKey:v,onChange:ue,items:de,tabBarStyle:{marginBottom:16},centered:!0})})]})},wu=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=ve(),{currentExhibition:r}=ge(l=>l.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>i(Ue(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Su=()=>{var I;const{id:t}=ot(),s=qt(),n=ve(),i=$e(),r=((I=s.state)==null?void 0:I.exhibitionId)||t,{currentExhibition:l}=ge(j=>j.exhibition),a=u.useRef(null),[f,y]=u.useState({width:100,height:100}),[h,S]=u.useState({width:0,height:0}),[$]=F.useForm();u.useEffect(()=>{if(!r){ee.error("Exhibition ID not found"),n("/exhibition");return}i(ht(r))},[r,i,n]),u.useEffect(()=>{l!=null&&l.dimensions&&(y(l.dimensions),$.setFieldsValue(l.dimensions))},[l,$]),u.useEffect(()=>{const j=()=>{a.current&&S({width:a.current.clientWidth,height:a.current.clientHeight})};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]);const v=async()=>{try{const j=await $.validateFields();await Ie.updateExhibition(r,{dimensions:j}),ee.success("Exhibition space saved successfully"),await i(ht(r)).unwrap(),n(Ue(l,"layout"),{state:{exhibitionId:r}})}catch{ee.error("Failed to save exhibition space")}},T=j=>{y(R=>({...R,...j})),$.setFieldsValue(j)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(wu,{exhibitionId:r}),e.jsx(H,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Space Setup"}),e.jsx(_,{type:"primary",icon:e.jsx(vs,{}),onClick:v,children:"Save and Continue"})]}),children:e.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[e.jsx("div",{style:{flex:"0 0 300px"},children:e.jsxs(F,{form:$,layout:"vertical",initialValues:f,children:[e.jsx(F.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(Fe,{min:10,max:1e3,style:{width:"100%"},onChange:j=>T({width:j||10})})}),e.jsx(F.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(Fe,{min:10,max:1e3,style:{width:"100%"},onChange:j=>T({height:j||10})})})]})}),e.jsx("div",{ref:a,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:e.jsx(Ks,{children:e.jsx(Xs,{width:h.width,height:h.height,exhibitionWidth:f.width,exhibitionHeight:f.height,onExhibitionChange:T})})})]})})]})},ku=({exhibitionId:t})=>{const s=ve(),{currentExhibition:n}=ge(i=>i.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>s(Ue(n),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Iu=()=>{var f,y,h,S,$;const{id:t}=ot(),s=qt(),n=ve(),i=$e(),r=((f=s.state)==null?void 0:f.exhibitionId)||t,{currentExhibition:l,halls:a}=ge(v=>v.exhibition);return u.useEffect(()=>{r&&(i(ht(r)),i(Nt(r)))},[r,i]),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(ku,{exhibitionId:r}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:24,sm:12,md:8,children:e.jsxs(H,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(ts,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(H.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),e.jsx(_,{type:"primary",onClick:()=>n(Ue(l,"space"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(M,{xs:24,sm:12,md:8,children:e.jsxs(H,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Qs,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(H.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),e.jsx(_,{type:"primary",disabled:!((y=l==null?void 0:l.dimensions)!=null&&y.width)||!((h=l==null?void 0:l.dimensions)!=null&&h.height),onClick:()=>n(Ue(l,"halls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(M,{xs:24,sm:12,md:8,children:e.jsxs(H,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(rt,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(H.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),e.jsx(_,{type:"primary",disabled:!a.length,onClick:()=>n(Ue(l,"stalls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(M,{xs:24,sm:12,md:8,children:e.jsxs(H,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Rn,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(H.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),e.jsx(_,{type:"primary",disabled:!((S=l==null?void 0:l.dimensions)!=null&&S.width)||!(($=l==null?void 0:l.dimensions)!=null&&$.height),onClick:()=>n(Ue(l,"fixtures"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},Cu=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=ve(),{currentExhibition:r}=ge(l=>l.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>i(Ue(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Nu=()=>{var c,D,w;const{id:t}=ot(),s=qt(),n=ve(),i=$e(),r=((c=s.state)==null?void 0:c.exhibitionId)||t,{currentExhibition:l,halls:a}=ge(P=>P.exhibition),f=u.useRef(null),[y,h]=ee.useMessage(),[S,$]=u.useState(!1),[v,T]=u.useState(null),[I,j]=u.useState({width:0,height:0});u.useEffect(()=>{const P=()=>{if(f.current){const{clientWidth:b,clientHeight:L}=f.current;j({width:Math.max(b||400,400),height:Math.max(L||400,400)})}};P();const g=new ResizeObserver(P);return f.current&&g.observe(f.current),window.addEventListener("resize",P),()=>{g.disconnect(),window.removeEventListener("resize",P)}},[]),u.useEffect(()=>{if(!r){y.error("Exhibition ID not found"),n("/exhibition");return}i(ht(r))},[r,i,n,y]),u.useEffect(()=>{var P,g;if(l){if(!((P=l.dimensions)!=null&&P.width)||!((g=l.dimensions)!=null&&g.height)){y.info("Please set up exhibition space first"),n(Ue(l,"space"),{state:{exhibitionId:r}});return}i(Nt(r))}},[l,r,i,n,y]);const R=()=>{T(null),$(!0)},d=P=>{T(P),$(!!P)},p=async P=>{var g;try{P.id?(await Ie.updateHall(r,P.id,P),y.success("Hall updated successfully"),$(!1)):(await Ie.createHall(r,P),y.success("Hall created successfully"),$(!1)),i(Nt(r))}catch(b){console.error("Hall operation failed:",b),((g=b.response)==null?void 0:g.status)===409?y.warning({content:b.response.data.message,duration:6,style:{marginTop:"20vh"}}):(y.error(b.message||"Failed to save hall"),$(!1))}},k=async P=>{var g,b;try{const L=P._id||P.id;if(!L)throw new Error("Hall ID is required");await Ie.deleteHall(r,L),y.success("Hall deleted successfully"),$(!1),T(null),i(Nt(r))}catch(L){console.error("Failed to delete hall:",L),y.error(((b=(g=L.response)==null?void 0:g.data)==null?void 0:b.message)||"Failed to delete hall")}},o=async()=>{try{await Ie.saveLayout(r,a),y.success("Layout saved successfully")}catch{y.error("Failed to save layout")}};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(Cu,{exhibitionId:r}),h,e.jsx(H,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(G,{children:[e.jsx("span",{children:"Hall Management"}),e.jsx(_,{icon:e.jsx(ya,{}),onClick:()=>n(Ue(l,"space"),{state:{exhibitionId:r}}),children:"Back to Space Setup"})]}),e.jsxs(G,{children:[e.jsx(_,{type:"primary",icon:e.jsx(et,{}),onClick:R,children:"Add Hall"}),e.jsx(_,{type:"primary",icon:e.jsx(vs,{}),onClick:o,disabled:!a.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:e.jsx("div",{ref:f,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(Ks,{children:I.width>0&&I.height>0&&(l==null?void 0:l.dimensions)&&e.jsx(Xs,{width:I.width,height:I.height,exhibitionWidth:l.dimensions.width,exhibitionHeight:l.dimensions.height,halls:a,selectedHall:v,onSelectHall:d,onHallChange:p,onAddHall:R})})})}),e.jsx(pu,{visible:S,hall:v,onCancel:()=>$(!1),onSubmit:p,onDelete:k,exhibitionWidth:((D=l==null?void 0:l.dimensions)==null?void 0:D.width)||100,exhibitionHeight:((w=l==null?void 0:l.dimensions)==null?void 0:w.height)||100})]})},Eu=K(me)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,Au=K.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Bs=K.div`
  padding: 24px 32px 32px;
`,Tu=K.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,Pu=K.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`,Du=K.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`,Ru=K.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`,Wr=K.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`,Yr=K.div`
  border: 1px solid ${t=>t.selected?"#4b47b9":"#e6e6f0"};
  background: ${t=>t.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${t=>t.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${t=>t.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${t=>t.selected?"#4b47b9":"white"};
    border: 2px solid ${t=>t.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`,Lu=K(H)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;K(_)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;K.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;K(H)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;K(W)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const hi=K(_)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;K(xe)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;K.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;K(zi)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;K.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;K.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;K.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;K.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;K.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px Ã— 3) + (16px Ã— 2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;K(H)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const Qr=({form:t,stallDetails:s=[],selectedStallId:n,selectedStallIds:i=[],selectedStallsCount:r=0,exhibition:l})=>{const[a,f]=u.useState(""),[y,h]=u.useState(null),[S,$]=u.useState([]),[v,T]=u.useState("selected");u.useEffect(()=>{let D=[...(t.getFieldValue("selectedStalls")||[]).map(w=>String(w))];if(n){const w=String(n);D.some(P=>P===w)||D.push(w)}i.length>0&&i.forEach(w=>{const P=String(w);D.some(g=>g===P)||D.push(P)}),console.log("StallDetailsStep - Initial stalls after normalization:",D),t.setFieldsValue({selectedStalls:D}),$(D)},[t,n,i]),u.useEffect(()=>{if(S.length>0){const o=t.getFieldValue("selectedStalls")||[],c=new Set(o.map(P=>String(P))),D=new Set(S.map(P=>String(P)));let w=c.size!==D.size;if(!w){for(const P of D)if(!c.has(P)){w=!0;break}}if(w){console.log("Syncing form with selected stalls:",S);const P=S.map(g=>String(g));t.setFieldsValue({selectedStalls:P}),t.validateFields(["selectedStalls"]).catch(g=>{})}}},[S,t]);const I=u.useMemo(()=>{if(!s||s.length===0)return[];const o=new Set(s.map(c=>c.hallId));return Array.from(o).map(c=>{var D;return{value:c,label:((D=s.find(w=>w.hallId===c))==null?void 0:D.hallName)||`Hall - ${c}`}})},[s]),j=u.useMemo(()=>!s||s.length===0?[]:s.filter(o=>o.status==="available").filter(o=>{var c;return(!a||((c=o.number)==null?void 0:c.toLowerCase().includes(a.toLowerCase())))&&(!y||o.hallId===y)}),[s,a,y]),R=u.useMemo(()=>!s||s.length===0?[]:s.filter(o=>S.includes(o.id)),[s,S]),d=u.useMemo(()=>{var x,E,z;if(!s||s.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const o=s.filter(A=>S.includes(A.id)),c=o.reduce((A,m)=>A+(m.price||m.ratePerSqm*m.dimensions.width*m.dimensions.height),0),w=(((x=l==null?void 0:l.publicDiscountConfig)==null?void 0:x.filter(A=>A.isActive))||[]).map(A=>{const m=A.type==="percentage"?c*(Math.min(Math.max(0,A.value),100)/100):Math.min(A.value,c);return{name:A.name,type:A.type,value:A.value,amount:m}}),P=w.reduce((A,m)=>A+m.amount,0),g=c-P,b=((z=(E=l==null?void 0:l.taxConfig)==null?void 0:E.filter(A=>A.isActive))==null?void 0:z.map(A=>({name:A.name,rate:A.rate,amount:g*(A.rate/100)})))||[],L=b.reduce((A,m)=>A+m.amount,0),N=g+L;return{baseAmount:c,discounts:w,totalDiscountAmount:P,amountAfterDiscount:g,taxes:b,totalTaxAmount:L,total:N,selectedStallNumbers:o.map(A=>`${A.number} (${A.hallName||`Hall - ${A.hallId}`})`).join(", ")}},[s,S,l==null?void 0:l.taxConfig,l==null?void 0:l.publicDiscountConfig]),p=o=>{const c=String(o),D=S.some(P=>String(P)===c),w=D?S.filter(P=>String(P)!==c):[...S,c];$(w),t.setFieldsValue({selectedStalls:w}),D?ee.info("Stall removed from selection"):ee.success("Stall added to selection")},k=o=>`â‚¹${o.toLocaleString("en-IN")}`;return e.jsxs(Bs,{children:[e.jsx(Tu,{children:"Select Your Stalls"}),e.jsx(Pu,{children:"Click on stalls to select or deselect them. You can select multiple stalls for booking."}),e.jsxs(Du,{children:[e.jsx(W,{placeholder:"Search by stall number",prefix:e.jsx(mt,{}),value:a,onChange:o=>f(o.target.value),className:"search-input"}),e.jsx(oe,{placeholder:"Filter by hall",allowClear:!0,className:"filter-select",options:I,onChange:o=>h(o)})]}),e.jsx(F.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:e.jsx(oe,{mode:"multiple"})}),e.jsxs(Ru,{children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("div",{className:`tab-item ${v==="selected"?"active":""}`,onClick:()=>T("selected"),children:[e.jsx(Ee,{}),e.jsx("span",{children:"Selected Stalls"}),e.jsx("span",{className:`badge ${v==="selected"?"active":""}`,children:S.length})]}),e.jsxs("div",{className:`tab-item ${v==="available"?"active":""}`,onClick:()=>T("available"),children:[e.jsx($n,{}),e.jsx("span",{children:"Available Stalls"})]})]}),v==="selected"&&e.jsx(e.Fragment,{children:R.length>0?e.jsx(Wr,{children:R.map(o=>e.jsxs(Yr,{selected:!0,onClick:()=>p(o.id),children:[e.jsx("div",{className:"selection-indicator",children:e.jsx(Ms,{})}),e.jsx("div",{className:"stall-price",children:k(o.price||o.ratePerSqm*o.dimensions.width*o.dimensions.height)}),e.jsxs("div",{className:"stall-number",children:["Stall ",o.number||o.stallNumber,e.jsxs("span",{className:"hall-label",children:["Hall - ",o.hallName||o.hallId]})]}),e.jsxs("div",{className:"stall-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"label",children:"Area"}),e.jsxs("div",{className:"value",children:[o.dimensions.width*o.dimensions.height," sq.m"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"label",children:"Dimensions"}),e.jsxs("div",{className:"value",children:[o.dimensions.width,"m Ã— ",o.dimensions.height,"m"]})]})]})]},o.id))}):e.jsx(Ct,{description:"No stalls selected yet",image:Ct.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}})}),v==="available"&&e.jsx(Wr,{children:j.map(o=>e.jsxs(Yr,{selected:S.includes(o.id),onClick:()=>p(o.id),children:[e.jsx("div",{className:"selection-indicator",children:S.includes(o.id)&&e.jsx(Ms,{})}),e.jsx("div",{className:"stall-price",children:k(o.price||o.ratePerSqm*o.dimensions.width*o.dimensions.height)}),e.jsxs("div",{className:"stall-number",children:["Stall ",o.number||o.stallNumber,e.jsxs("span",{className:"hall-label",children:["Hall - ",o.hallName||o.hallId]})]}),e.jsxs("div",{className:"stall-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"label",children:"Area"}),e.jsxs("div",{className:"value",children:[o.dimensions.width*o.dimensions.height," sq.m"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"label",children:"Dimensions"}),e.jsxs("div",{className:"value",children:[o.dimensions.width,"m Ã— ",o.dimensions.height,"m"]})]})]})]},o.id))}),S.length>0&&e.jsxs(Lu,{title:"Booking Summary",children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Selected Stalls"}),e.jsxs("div",{className:"value",children:[S.length," stall(s) selected"]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Stall Numbers"}),e.jsx("div",{className:"value",children:d.selectedStallNumbers})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Base Amount"}),e.jsx("div",{className:"value",children:k(d.baseAmount)})]}),d.discounts.map((o,c)=>e.jsxs("div",{className:"summary-row discount",children:[e.jsxs("div",{className:"label",children:["Discount (",o.name,")",o.type==="percentage"?` (${o.value}%)`:""]}),e.jsxs("div",{className:"value",children:["- ",k(o.amount)]})]},`discount-${c}`)),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Amount after Discount"}),e.jsx("div",{className:"value",children:k(d.amountAfterDiscount)})]}),d.taxes.map((o,c)=>e.jsxs("div",{className:"summary-row",children:[e.jsxs("div",{className:"label",children:[o.name," (",o.rate,"%)"]}),e.jsx("div",{className:"value",children:k(o.amount)})]},`tax-${c}`)),e.jsxs("div",{className:"summary-row total",children:[e.jsx("div",{className:"label",children:"Total"}),e.jsx("div",{className:"value",children:k(d.total)})]})]})]})]})},{Title:$u,Paragraph:Gr,Text:Kr}=pe,Xr=({form:t,formValues:s,selectedStallIds:n=[],exhibition:i})=>{const r=t.getFieldValue("selectedStalls")||n||[];return i&&i.amenities&&i.amenities.length>0,console.log("AmenitiesStep - Selected stalls:",r),e.jsxs(Bs,{children:[e.jsx($u,{level:4,children:"Additional Amenities"}),e.jsx(Gr,{type:"secondary",style:{marginBottom:24},children:"Select additional amenities for your exhibition stalls."}),e.jsx(Qe,{message:"Coming Soon",description:"The amenities selection feature is currently under development and will be available soon. You can continue to the next step without selecting amenities.",type:"info",showIcon:!0,icon:e.jsx(So,{}),style:{marginBottom:24}}),e.jsx(H,{title:`Selected Stalls: ${r.length}`,children:r.length>0?e.jsxs(Gr,{children:["You've selected ",r.length," stall(s). Additional amenities will be available for these stalls in the next update."]}):e.jsx(Ct,{image:Ct.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),e.jsx(Le,{}),e.jsx(H,{title:"Available Amenities",style:{marginTop:24},children:e.jsx(Ct,{image:e.jsx(ko,{style:{fontSize:60,color:"#cccccc"}}),description:e.jsxs("span",{children:[e.jsx(Kr,{strong:!0,children:"Amenities Coming Soon"}),e.jsx("br",{}),e.jsx(Kr,{type:"secondary",children:"Please check back later for available amenities."})]})})}),e.jsx(F.Item,{name:"amenities",hidden:!0,initialValue:[],children:e.jsx("input",{type:"hidden"})}),e.jsx(F.Item,{name:"selectedStalls",hidden:!0,children:e.jsx("input",{type:"hidden"})})]})},{Title:xi,Paragraph:Fu,Text:Ze}=pe,Zr=({form:t,stallDetails:s=[],selectedStallId:n,selectedStallIds:i=[],selectedStalls:r=[],exhibition:l,onPrev:a,onFinish:f,loading:y=!1,formValues:h={}})=>{const[S,$]=u.useState([]),v=u.useMemo(()=>{const D=(t.getFieldValue("selectedStalls")||[]).map(P=>String(P));if(console.log("ReviewStep - Form has selectedStalls:",D),console.log("ReviewStep - Props selectedStallIds:",i),console.log("ReviewStep - Props selectedStalls:",r),D.length>0)return D;const w=[];if(n){const P=String(n);w.push(P)}return i&&i.length&&i.forEach(P=>{const g=String(P);w.includes(g)||w.push(g)}),r&&r.length&&r.forEach(P=>{const g=String(P);w.includes(g)||w.push(g)}),console.log("ReviewStep - Final consolidated stall IDs:",w),w},[t,n,i,r]);u.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",v),console.log("ReviewStep - Available stall details:",s),s&&s.length&&v.length){const c=s.filter(w=>v.includes(String(w.id)));console.log("ReviewStep - Matched stalls:",c.length);const D=c.map(w=>({key:w.id,id:w.id,number:w.number||w.stallNumber||`Stall ${w.id}`,hallName:w.hallName||`Hall ${w.hallId}`,size:`${w.dimensions.width}m Ã— ${w.dimensions.height}m`,area:w.dimensions.width*w.dimensions.height,rate:w.ratePerSqm,price:w.price||w.ratePerSqm*w.dimensions.width*w.dimensions.height}));$(D)}},[s,v]);const T=t.getFieldValue("amenities")||[],I=u.useMemo(()=>{var z,A,m;const c=S.reduce((C,B)=>C+B.price,0);let D=0;const w=T.map(C=>{var q;const B=(q=l==null?void 0:l.amenities)==null?void 0:q.find(O=>O.id===C||O._id===C);return B?(D+=B.rate||0,{name:B.name,rate:B.rate,type:B.type}):null}).filter(Boolean),g=(((z=l==null?void 0:l.publicDiscountConfig)==null?void 0:z.filter(C=>C.isActive))||[]).map(C=>{const B=C.type==="percentage"?c*(Math.min(Math.max(0,C.value),100)/100):Math.min(C.value,c);return{name:C.name,type:C.type,value:C.value,amount:B}}),b=g.reduce((C,B)=>C+B.amount,0),L=c-b,N=L+D,x=((m=(A=l==null?void 0:l.taxConfig)==null?void 0:A.filter(C=>C.isActive))==null?void 0:m.map(C=>({name:C.name,rate:C.rate,amount:N*(C.rate/100)})))||[],E=x.reduce((C,B)=>C+B.amount,0);return{baseAmount:c,amenities:w,amenitiesTotal:D,discounts:g,totalDiscountAmount:b,amountAfterDiscount:L,subtotal:N,taxes:x,totalTaxAmount:E,total:N+E,stallCount:S.length}},[S,T,l]);u.useEffect(()=>{var D;const c=((D=l==null?void 0:l.publicDiscountConfig)==null?void 0:D.filter(w=>w.isActive))||[];if(c.length>0){const w=c[0];console.log("Setting discountId in form to:",w),t.setFieldsValue({discountId:{name:w.name,type:w.type,value:w.value}})}},[l,t]);const j=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:c=>`${c} sqm`},{title:"Rate",dataIndex:"rate",key:"rate",render:c=>`â‚¹${c}/sqm`},{title:"Price",dataIndex:"price",key:"price",render:c=>`â‚¹${c.toLocaleString()}`}],R=c=>`â‚¹${c.toLocaleString("en-IN")}`,d=h.customerName||t.getFieldValue("customerName"),p=h.customerPhone||t.getFieldValue("customerPhone"),k=h.email||t.getFieldValue("email"),o=h.companyName||t.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:d,companyName:o,customerPhone:p,customerEmail:k,formValues:h,formFieldValues:{customerName:t.getFieldValue("customerName"),companyName:t.getFieldValue("companyName"),customerPhone:t.getFieldValue("customerPhone"),email:t.getFieldValue("email")}}),y?e.jsx(Bs,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:e.jsx(Et,{size:"large",tip:"Processing your booking..."})}):v.length===0?e.jsxs(Bs,{children:[e.jsx(Qe,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(_,{onClick:a,children:"Back to Stall Selection"})})]}):e.jsxs(Bs,{children:[e.jsx(F.Item,{name:"discountId",hidden:!0,children:e.jsx(W,{})}),e.jsx(xi,{level:4,children:"Booking Summary"}),e.jsx(Fu,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),e.jsx(H,{title:"Exhibitor Information",style:{marginBottom:24},children:e.jsxs(xe,{column:2,children:[e.jsx(xe.Item,{label:"Name",children:d||"Not provided"}),e.jsx(xe.Item,{label:"Company",children:o||"Not provided"}),e.jsx(xe.Item,{label:"Phone",children:p||"Not provided"}),e.jsx(xe.Item,{label:"Email",children:k||"Not provided"})]})}),e.jsxs(H,{title:"Selected Stalls",className:"review-card",size:"small",children:[e.jsx(Re,{dataSource:S,columns:j,pagination:!1,size:"small",style:{marginBottom:16}}),e.jsxs(Ze,{strong:!0,children:["Total Base Amount: ",R(I.baseAmount)]})]}),I.amenities&&I.amenities.length>0&&e.jsxs(H,{title:"Selected Amenities",style:{marginBottom:24},children:[I.amenities.map((c,D)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx(Ze,{children:c.name}),e.jsx(le,{color:"blue",style:{marginLeft:8},children:c.type})]}),e.jsx(Ze,{children:R(c.rate)})]},D)),e.jsx(Le,{}),e.jsxs(Ze,{strong:!0,children:["Amenities Total: ",R(I.amenitiesTotal)]})]}),e.jsxs(H,{title:"Price Calculation",style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Ze,{children:"Base Amount:"}),e.jsx(Ze,{children:R(I.baseAmount)})]}),I.discounts.length>0&&e.jsx(e.Fragment,{children:I.discounts.map((c,D)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(Ze,{children:[c.name," (",c.type==="percentage"?`${c.value}%`:R(c.value),"):"]}),e.jsxs(Ze,{type:"danger",children:["- ",R(c.amount)]})]},D))}),I.amenitiesTotal>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Ze,{children:"Amenities:"}),e.jsx(Ze,{children:R(I.amenitiesTotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(Ze,{strong:!0,children:"Subtotal:"}),e.jsx(Ze,{strong:!0,children:R(I.subtotal)})]}),I.taxes.length>0&&e.jsx(e.Fragment,{children:I.taxes.map((c,D)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(Ze,{children:[c.name," (",c.rate,"%):"]}),e.jsx(Ze,{children:R(c.amount)})]},D))}),e.jsx(Le,{}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(xi,{level:5,children:"Total:"}),e.jsx(xi,{level:5,children:R(I.total)})]})]})]})},{confirm:Bu}=me,Mu=({visible:t,stallDetails:s,selectedStallId:n,selectedStallIds:i,loading:r,exhibition:l,onCancel:a,onSubmit:f})=>{const[y]=F.useForm(),[h,S]=u.useState(0),[$]=u.useState(3),[v,T]=u.useState({}),[I,j]=u.useState(!1),[R,d]=u.useState(!1),p=ge(L=>L.exhibitorAuth.exhibitor);u.useEffect(()=>{if(t){S(0),j(!1),T({}),y.resetFields();const L=i.map(E=>String(E));n&&L.push(String(n));const N=[...new Set(L)],x={selectedStalls:N,exhibitionId:l==null?void 0:l._id};p&&(x.customerName=p.contactPerson||"",x.companyName=p.companyName||"",x.email=p.email||"",x.customerPhone=p.phone||""),y.setFieldsValue(x),T(x),console.log("Booking form initialized with stalls:",N),console.log("Exhibitor profile data:",p)}},[t,y,n,i,l,p]);const k=()=>{j(!0)},o=()=>{I?Bu({title:"Discard changes?",icon:e.jsx(Zt,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){a()}}):a()},c=()=>{d(!0),y.validateFields().then(L=>{const N={...v,...L},x={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},E={...N,...x};T(E),console.log("Step completed, saving form values:",E),console.log("Selected stalls are:",E.selectedStalls||[]),console.log("Exhibitor info:",x),S(h+1),d(!1)}).catch(L=>{d(!1),console.error("Form validation failed:",L),ee.error("Please complete all required fields")})},D=()=>{S(h-1)},w=()=>{y.validateFields().then(L=>{const N={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},x={...v,...L,...N};console.log("Submitting booking with values:",x),f(x)}).catch(L=>{console.error("Form validation failed:",L),ee.error("Please complete all required fields")})},P=["Stall Details","Amenities","Review"],g=[{title:"Stall Details",icon:e.jsx(Io,{}),content:e.jsx(Qr,{form:y,stallDetails:s,selectedStallId:n,selectedStallIds:i,exhibition:l})},{title:"Amenities",icon:e.jsx(Qs,{}),content:e.jsx(Xr,{form:y,stallDetails:s,selectedStallIds:y.getFieldValue("selectedStalls")||[],exhibition:l,formValues:v})},{title:"Review",icon:e.jsx(Ee,{}),content:e.jsx(Zr,{form:y,formValues:v,loading:r,exhibition:l,selectedStalls:y.getFieldValue("selectedStalls")||[],selectedStallIds:y.getFieldValue("selectedStalls")||[],stallDetails:s})}];u.useEffect(()=>{const L=y.getFieldValue("selectedStalls");console.log(`Step ${h} - Form has selectedStalls:`,L)},[h,y]);const b=L=>{const N=y.getFieldValue("selectedStalls")||[],x={customerName:y.getFieldValue("customerName"),companyName:y.getFieldValue("companyName"),email:y.getFieldValue("email"),customerPhone:y.getFieldValue("customerPhone")},E={...v,...x};switch(console.log(`Rendering step ${L} with:`,{selectedStalls:N,exhibitorInfo:x}),L){case 0:return e.jsx(Qr,{form:y,stallDetails:s,selectedStallId:n,selectedStallIds:i,exhibition:l});case 1:return e.jsx(Xr,{form:y,stallDetails:s,selectedStallIds:N,exhibition:l,formValues:E});case 2:return e.jsx(Zr,{form:y,formValues:E,loading:r,exhibition:l,selectedStalls:N,selectedStallIds:N,stallDetails:s,onPrev:D,onFinish:w});default:return null}};return e.jsx(Eu,{title:`Book Exhibition Stall - ${P[h]}`,open:t,onCancel:o,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[h>0&&e.jsx(hi,{onClick:D,disabled:R||r,size:"large",children:"Back"}),e.jsx("div",{children:h<$-1?e.jsx(hi,{type:"primary",onClick:c,loading:R,disabled:r,size:"large",children:"Next"}):e.jsx(hi,{type:"primary",onClick:w,loading:r,disabled:R,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:e.jsxs(Et,{spinning:r||R,tip:r?"Processing your booking...":"Validating...",children:[e.jsx(Au,{children:g.map((L,N)=>e.jsxs("div",{className:`step-item ${h===N?"active":""} ${h>N?"completed":""}`,onClick:()=>h>N?S(N):null,style:{cursor:h>N?"pointer":"default"},children:[e.jsx("span",{className:"step-icon",children:h>N?e.jsx(Ms,{}):N+1}),L.title]},N))}),e.jsx(F,{form:y,layout:"vertical",preserve:!0,onFieldsChange:k,children:b(h)},`form-step-${h}`)]})})},{Header:zu}=Pe,{Step:pi}=zi,{Title:Nx,Text:Uu}=pe,qu=K(zu)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,_u=K.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,Ou=K.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,Vu=K.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,Hu=K.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`;K.span`
  font-size: 1.5rem;
  font-weight: bold;
  color: #1890ff;
`;const Jr=K(gt)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,ea=K(nt)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,Wu=K(nt)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,Yu=K(_)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,Qu=K.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,Gu=K(Je)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,un=K(_)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,Ku=K.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,Xu=K.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,pt=()=>{var X;const t=ve(),s=$e(),[n,i]=u.useState(!1),[r,l]=u.useState(!1),a=ge(J=>J.exhibitorAuth),[f,y]=u.useState("/logo.png"),[h,S]=u.useState("Exhibition Manager"),[$,v]=u.useState(!1),[T,I]=u.useState(!1),[j,R]=u.useState(!1),[d,p]=u.useState(null),[k]=F.useForm(),[o]=F.useForm(),[c]=F.useForm(),[D,w]=u.useState(0),[P,g]=u.useState(""),[b,L]=u.useState(!1),[N,x]=u.useState(!1),[E,z]=u.useState(0),[A,m]=u.useState({companyName:"",contactPerson:""}),C=u.useRef(null);u.useEffect(()=>{const J=localStorage.getItem("cachedLogoUrl"),re=localStorage.getItem("logoTimestamp"),ae=new Date().getTime();if(J&&re&&ae-parseInt(re)<36e5)y(J);else{const ce=`${ne.defaults.baseURL}/public/logo`;y(ce),localStorage.setItem("cachedLogoUrl",ce),localStorage.setItem("logoTimestamp",ae.toString());const Se=new Image;Se.src=ce}fetch(`${ne.defaults.baseURL}/public/site-info`).then(ce=>ce.json()).then(ce=>{ce.siteName&&S(ce.siteName)}).catch(ce=>{console.error("Error fetching site info:",ce)})},[]),u.useEffect(()=>{v(a.showLoginModal)},[a.showLoginModal]),u.useEffect(()=>(ee.config({top:84,duration:3,maxCount:1}),()=>{ee.destroy()}),[]);const B=()=>{s(Da()),ee.success("Successfully logged out"),t("/"),i(!1),l(!1)},q=async J=>{var re,ae,ce,Se,Be,Ve,Ss,Zs,Js;try{p(null),R(!0);const At=await st.login(J),{exhibitor:Ot,token:ks}=At.data;if(!Ot||!ks)throw new Error("Invalid response from server");s(Ei({exhibitor:Ot,token:ks})),s(mr()),k.resetFields(),ee.success("Login successful!")}catch(At){if(((re=At.response)==null?void 0:re.status)===403){const Ot=(ce=(ae=At.response)==null?void 0:ae.data)==null?void 0:ce.status;if(Ot==="pending")p("Your account is pending approval. You will be able to log in after admin approval.");else if(Ot==="rejected"){const ks=(Be=(Se=At.response)==null?void 0:Se.data)==null?void 0:Be.rejectionReason;p(ks?`Your registration has been rejected. Reason: ${ks}`:"Your registration has been rejected. Please contact the administrator for more details.")}else p(((Ss=(Ve=At.response)==null?void 0:Ve.data)==null?void 0:Ss.message)||"Access denied. Please contact administrator.")}else p(((Js=(Zs=At.response)==null?void 0:Zs.data)==null?void 0:Js.message)||"Login failed. Please try again.")}finally{R(!1)}},O=async()=>{var J,re;try{const ae=await o.validateFields(["email","companyName","contactPerson"]);R(!0),p(null),g(ae.email),m({companyName:ae.companyName,contactPerson:ae.contactPerson}),await st.sendRegistrationOTP(ae.email),L(!0),ee.success("OTP sent to your email address"),z(60),Y(),w(1)}catch(ae){if(ae.name==="ValidationError")return;const ce=((re=(J=ae.response)==null?void 0:J.data)==null?void 0:re.message)||"Failed to send OTP. Please try again.";p(ce),ee.error(ce)}finally{R(!1)}},Y=()=>{C.current&&clearInterval(C.current),C.current=setInterval(()=>{z(J=>J<=1?(C.current&&clearInterval(C.current),0):J-1)},1e3)},Z=async()=>{var J,re;try{R(!0),p(null),await st.sendRegistrationOTP(P),ee.success("New OTP sent to your email address"),z(60),Y()}catch(ae){const ce=((re=(J=ae.response)==null?void 0:J.data)==null?void 0:re.message)||"Failed to resend OTP. Please try again.";p(ce),ee.error(ce)}finally{R(!1)}},te=async J=>{var re,ae;try{R(!0),p(null);const ce={email:P,otp:J.otp};await st.verifyOTP(ce),x(!0),ee.success("Email verified successfully"),C.current&&clearInterval(C.current),w(2)}catch(ce){const Se=((ae=(re=ce.response)==null?void 0:re.data)==null?void 0:ae.message)||"Invalid OTP. Please try again.";p(Se),ee.error(Se)}finally{R(!1)}},V=()=>{L(!1),x(!1),g(""),z(0),w(0),m({companyName:"",contactPerson:""}),C.current&&clearInterval(C.current),c.resetFields()},Q=async J=>{var re,ae,ce;try{if(p(null),R(!0),!N){p("Email verification required");return}const{confirmPassword:Se,...Be}=J,Ve={...Be,email:P,companyName:A.companyName,contactPerson:A.contactPerson};console.log("Sending registration data:",Ve);const Ss=await st.register(Ve);ee.success("Registration successful! You can log in and book a stall only after admin approval."),I(!1),o.resetFields(),V(),setTimeout(()=>{s(Mn(void 0))},300)}catch(Se){console.error("Registration error:",Se),console.error("Response data:",(re=Se.response)==null?void 0:re.data);const Be=((ce=(ae=Se.response)==null?void 0:ae.data)==null?void 0:ce.message)||"Registration failed. Please try again.";p(Be),ee.error(Be)}finally{R(!1)}};u.useEffect(()=>()=>{C.current&&clearInterval(C.current)},[]);const se=()=>{I(!1),p(null),o.resetFields(),V()},he=()=>{s(Mn(void 0)),i(!1),l(!1)},we=()=>{I(!0),i(!1),l(!1)},ue=()=>{v(!1),I(!0),k.resetFields()},de=()=>{I(!1),v(!0),o.resetFields()},be=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],Xe=e.jsx(ea,{items:[{key:"exhibitor-login",icon:e.jsx(nr,{}),label:e.jsx("a",{onClick:he,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:e.jsx(ys,{}),label:e.jsx("a",{onClick:we,children:"Register as Exhibitor"})}]}),U=e.jsx(ea,{items:[{key:"exhibitor-dashboard",icon:e.jsx(Dn,{}),label:e.jsx(Je,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:e.jsx(ke,{}),label:e.jsx(Je,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:e.jsx(rt,{}),label:e.jsx(Je,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:e.jsx(Ln,{}),label:e.jsx("a",{onClick:B,children:"Logout"})}]});return e.jsxs(e.Fragment,{children:[e.jsx(qu,{children:e.jsxs(_u,{children:[e.jsx(Ou,{children:e.jsx(Je,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:e.jsx(Vu,{children:e.jsx(Hu,{src:f,alt:"Logo",onError:()=>y("/logo.png")})})})}),e.jsx(Wu,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:be.map(J=>({key:J.key,label:e.jsx(Je,{to:J.path,children:J.label})}))}),e.jsx(Ku,{children:e.jsx(zt,{overlay:a.isAuthenticated?U:Xe,trigger:["click"],placement:"bottomRight",open:n,onOpenChange:i,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:a.isAuthenticated?e.jsxs(G,{style:{cursor:"pointer"},children:[e.jsx(Xu,{children:((X=a.exhibitor)==null?void 0:X.companyName)||"Exhibitor"}),e.jsx(Jr,{icon:e.jsx(ke,{}),size:"large"})]}):e.jsx(Jr,{icon:e.jsx(ke,{}),size:"large"})})}),e.jsx(Yu,{icon:e.jsx(Co,{}),onClick:()=>l(!0)})]})}),e.jsx(Qu,{children:e.jsxs(No,{title:"Exhibition Management System",placement:"right",onClose:()=>l(!1),open:r,width:280,closeIcon:e.jsx("span",{style:{fontSize:"16px"},children:"Ã—"}),children:[e.jsx("div",{style:{marginBottom:24},children:be.map(J=>e.jsx(Gu,{to:J.path,onClick:()=>l(!1),children:J.label},J.key))}),e.jsx("div",{style:{marginTop:40},children:a.isAuthenticated?e.jsxs(e.Fragment,{children:[e.jsx(un,{type:"primary",icon:e.jsx(Dn,{}),onClick:()=>{t("/exhibitor/dashboard"),l(!1)},children:"Dashboard"}),e.jsx(un,{type:"default",icon:e.jsx(Ln,{}),onClick:B,children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(un,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:e.jsx(nr,{}),onClick:()=>{he(),l(!1)},children:"Exhibitor Login"}),e.jsx(un,{type:"default",icon:e.jsx(ys,{}),onClick:()=>{we(),l(!1)},children:"Register as Exhibitor"})]})})]})}),e.jsxs(me,{title:"Exhibitor Login",open:$,onCancel:()=>{s(mr()),p(null),k.resetFields()},footer:null,width:400,children:[a.loginContext==="stall-booking"&&e.jsx(Qe,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),d&&e.jsx(Qe,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),e.jsxs(F,{form:k,name:"exhibitor_login_modal",onFinish:q,layout:"vertical",children:[e.jsx(F.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(W,{prefix:e.jsx(Mt,{}),placeholder:"Email",size:"large",disabled:j})}),e.jsx(F.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(W.Password,{prefix:e.jsx(bn,{}),placeholder:"Password",size:"large",disabled:j})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:j,children:"Login"})})]}),e.jsx(Le,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),e.jsx(_,{type:"default",block:!0,onClick:ue,children:"Register as Exhibitor"})]}),e.jsxs(me,{title:"Exhibitor Registration",open:T,onCancel:se,footer:null,width:500,children:[e.jsxs(zi,{current:D,style:{marginBottom:24},children:[e.jsx(pi,{title:"Basic Info"}),e.jsx(pi,{title:"Verify Email"}),e.jsx(pi,{title:"Complete"})]}),d&&e.jsx(Qe,{message:d,type:"error",showIcon:!0,style:{marginBottom:16}}),D===0&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(F,{form:o,name:"exhibitor_register_step1",layout:"vertical",children:[e.jsx(F.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:e.jsx(W,{prefix:e.jsx($i,{}),placeholder:"Company Name",size:"large",disabled:j})}),e.jsx(F.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:e.jsx(W,{prefix:e.jsx(ke,{}),placeholder:"Contact Person",size:"large",disabled:j})}),e.jsx(F.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(W,{prefix:e.jsx(Mt,{}),placeholder:"Email",size:"large",disabled:j})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",onClick:O,block:!0,size:"large",loading:j,children:"Continue & Verify Email"})})]}),e.jsx(Le,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),e.jsx(_,{type:"default",block:!0,onClick:de,children:"Login"})]}),D===1&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{message:"Email Verification",description:`We've sent a verification code to ${P}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(F,{form:c,name:"verify_otp",onFinish:te,layout:"vertical",children:[e.jsx(F.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:e.jsx(W,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:j})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:j,children:"Verify & Continue"})})]}),e.jsxs(ie,{justify:"space-between",align:"middle",style:{marginTop:16},children:[e.jsx(M,{children:e.jsx(_,{type:"link",disabled:E>0||j,onClick:Z,children:"Resend Code"})}),e.jsx(M,{children:E>0&&e.jsxs(Uu,{type:"secondary",children:["Resend in ",E,"s"]})})]}),e.jsx(Le,{}),e.jsx(_,{type:"default",block:!0,onClick:()=>w(0),children:"Back"})]}),D===2&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),e.jsxs(F,{form:o,name:"exhibitor_register_step2",onFinish:Q,layout:"vertical",children:[e.jsx(F.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:e.jsx(W,{prefix:e.jsx(Fi,{}),placeholder:"Phone Number",size:"large",disabled:j})}),e.jsx(F.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:e.jsx(W.TextArea,{placeholder:"Address",rows:3,disabled:j})}),e.jsx(F.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:e.jsx(W.Password,{prefix:e.jsx(bn,{}),placeholder:"Password",size:"large",disabled:j})}),e.jsx(F.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:J})=>({validator(re,ae){return!ae||J("password")===ae?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:e.jsx(W.Password,{prefix:e.jsx(bn,{}),placeholder:"Confirm Password",size:"large",disabled:j})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:j,children:"Complete Registration"})})]})]})]})]})},{Content:hn}=Pe,{Title:Ex}=pe,Zu=t=>{if(!t)return"";if(t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;if(s.includes("logos/"))return`${ne.defaults.baseURL}/public/images/${s}`;const n=localStorage.getItem("token"),i=`uploads/${s}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},Ju=()=>{var A,m,C,B,q;const{id:t}=ot(),s=ve(),n=$e(),[i,r]=u.useState(null),[l,a]=u.useState(null),[f,y]=u.useState(null),[h,S]=u.useState([]),[$,v]=u.useState(!1),[T,I]=u.useState(!0),[j,R]=u.useState(null),[d,p]=u.useState(!1),[k,o]=u.useState(null),c=u.useRef(null),[D,w]=u.useState({width:800,height:600}),[P]=F.useForm(),{isAuthenticated:g}=ge(O=>O.exhibitorAuth),b=O=>O.status==="booked"||O.status==="reserved",L=()=>{if(c.current){const{clientWidth:O,clientHeight:Y}=c.current,Z=Math.max(O||800,800),te=Math.max(Y||600,600);(Z!==D.width||te!==D.height)&&w({width:Z,height:te})}};u.useEffect(()=>{L();const O=new ResizeObserver(()=>{requestAnimationFrame(L)});return c.current&&O.observe(c.current),window.addEventListener("resize",L),()=>{O.disconnect(),window.removeEventListener("resize",L)}},[]),u.useEffect(()=>{(async()=>{try{if(!t){R("Exhibition ID is missing"),I(!1);return}I(!0),R(null);const Y=await dt.getLayout(t);r(Y.data)}catch(Y){R(Y.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",Y)}finally{I(!1)}})()},[t]),u.useEffect(()=>{i&&L()},[i]),u.useEffect(()=>{console.log("Authentication state changed:",g),g&&i&&(y(null),S([]),L(),ee.info("You can now select stalls to book.",3))},[g]);const N=()=>g,x=async O=>{if(b(O)){ee.info(`This stall (${O.stallNumber}) is already booked.`);return}if(!N()){n(Mn("stall-booking"));return}const Z=O._id||O.id;h.includes(Z)?(S(te=>te.filter(V=>V!==Z)),ee.info(`Stall ${O.stallNumber} removed from selection`)):(S(te=>[...te,Z]),ee.success(`Stall ${O.stallNumber} added to selection`))},E=async O=>{try{p(!0),console.log("BOOKING - Form values:",JSON.stringify(O,null,2)),console.log("BOOKING - DiscountId:",O.discountId),console.log("BOOKING - Selected stalls:",O.selectedStalls);const Y={...O,exhibitionId:i==null?void 0:i.exhibition._id,stallIds:O.selectedStalls};if(console.log("BOOKING - Final data being sent:",JSON.stringify(Y,null,2)),g){const Z=await dt.exhibitorBookStalls(Y);console.log("BOOKING - Response:",Z.data),ee.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const Z=await dt.bookMultipleStalls(t,Y);console.log("BOOKING - Response:",Z.data),ee.success("Your booking request has been submitted successfully!")}if(v(!1),S([]),t)try{const Z=await dt.getLayout(t);r(Z.data),console.log("Layout refreshed with updated stall statuses")}catch(Z){console.error("Error refreshing layout data:",Z)}}catch(Y){console.error("Error booking stall",Y),ee.error("Failed to book stall. Please try again.")}finally{p(!1)}},z=async()=>{if(h.length===0){ee.warning("Please select at least one stall to book");return}try{p(!0),await dt.getStallDetails(t,h[0]);const O=(i==null?void 0:i.layout.flatMap(Y=>Y.stalls.map(Z=>{var te,V;return{id:Z.id,number:Z.stallNumber,stallNumber:Z.stallNumber,price:Z.price||0,ratePerSqm:(te=Z.dimensions)!=null&&te.width&&((V=Z.dimensions)!=null&&V.height)?(Z.price||0)/(Z.dimensions.width*Z.dimensions.height):0,dimensions:Z.dimensions,status:Z.status,hallId:Y.id,hallName:Y.name}})))||[];o(O),v(!0)}catch(O){console.error("Error preparing booking modal",O),ee.error("Failed to load stall details. Please try again.")}finally{p(!1)}};return T?e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(hn,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Et,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):j||!i?e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(hn,{style:{paddingTop:"64px"},children:e.jsx(qs,{status:"error",title:"Failed to load exhibition layout",subTitle:j||"The exhibition layout couldn't be loaded.",extra:[e.jsx(_,{type:"primary",onClick:()=>s("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((A=i.exhibition.dimensions)!=null&&A.width)||!((m=i.exhibition.dimensions)!=null&&m.height)?e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(hn,{style:{paddingTop:"64px"},children:e.jsx(H,{children:e.jsx(qs,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(hn,{style:{paddingTop:"64px",background:"#f7f8fa"},children:e.jsxs(H,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:"10px 0px",border:"none"},children:[e.jsxs(ie,{gutter:[24,24],style:{marginBottom:32},children:[e.jsx(M,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"row",alignItems:"center",gap:"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{flexShrink:0},children:i.exhibition.headerLogo?e.jsx(ba,{src:Zu(i.exhibition.headerLogo),alt:`${i.exhibition.name} logo`,style:{maxHeight:90,maxWidth:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:250,height:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:e.jsx(Et,{size:"small"})})}):e.jsx("div",{style:{width:90,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(kt,{style:{fontSize:32,color:"#aaa"}})})}),e.jsx(Le,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i.exhibition.name}),e.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(kt,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsxs("span",{children:[new Date(i.exhibition.startDate).toLocaleDateString()," -",new Date(i.exhibition.endDate).toLocaleDateString()]})]}),e.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(Ws,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsx("span",{children:i.exhibition.venue})]})]})]})}),e.jsx(M,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"12px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{marginBottom:"12px",fontSize:"16px",fontWeight:500,color:"#444"},children:"Stall Status:"}),e.jsxs(G,{size:"middle",wrap:!0,children:[e.jsx(le,{color:"#87d068",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Ke,{status:"success",text:"Available"})}),e.jsx(le,{color:"#ffd591",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Ke,{status:"warning",text:"Booked"})}),e.jsx(le,{color:"#ffadd2",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Ke,{status:"processing",text:"Reserved"})}),h.length>0&&e.jsx(le,{color:"#1890ff",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.jsx(Ke,{status:"processing",color:"#1890ff",text:`Selected (${h.length})`})})]})]})})]}),e.jsxs("div",{ref:c,style:{width:"100%",height:"80vh",minHeight:"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)"},children:[e.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
              `}),e.jsxs(Xs,{width:D.width,height:D.height,exhibitionWidth:((C=i.exhibition.dimensions)==null?void 0:C.width)||0,exhibitionHeight:((B=i.exhibition.dimensions)==null?void 0:B.height)||0,halls:i.layout,selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},children:[i.layout.map(O=>e.jsx(Ga,{hall:{...O,exhibitionId:t||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},O.id)),i.layout.flatMap(O=>O.stalls.map(Y=>{var Z,te,V,Q,se,he,we,ue;return e.jsx(Xi,{stall:{...Y,hallId:O.id,hallName:O.name,isSelected:h.includes(Y.id),stallTypeId:"default",number:Y.stallNumber,typeName:Y.type||"Standard",ratePerSqm:Y.price||0,rotation:0,dimensions:{x:((Z=Y.position)==null?void 0:Z.x)||0,y:((te=Y.position)==null?void 0:te.y)||0,width:((V=Y.dimensions)==null?void 0:V.width)||0,height:((Q=Y.dimensions)==null?void 0:Q.height)||0},status:Y.status==="maintenance"?"booked":Y.status},isSelected:f===Y.id||h.includes(Y.id),onSelect:Y.status==="available"?()=>x(Y):void 0,hallWidth:((se=O.dimensions)==null?void 0:se.width)||0,hallHeight:((he=O.dimensions)==null?void 0:he.height)||0,hallX:((we=O.dimensions)==null?void 0:we.x)||0,hallY:((ue=O.dimensions)==null?void 0:ue.y)||0},Y.id)})),(q=i.fixtures)==null?void 0:q.map(O=>{var Y,Z;return e.jsx(Ka,{fixture:{...O,id:O.id||O._id,_id:O._id||O.id,exhibitionId:t||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((Y=i.exhibition.dimensions)==null?void 0:Y.width)||0,exhibitionHeight:((Z=i.exhibition.dimensions)==null?void 0:Z.height)||0},O.id||O._id)})]})]})]})}),h.length>0&&e.jsx(Eo,{offsetBottom:20,children:e.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:e.jsxs(_,{type:"primary",size:"large",icon:e.jsx($n,{}),onClick:z,loading:d,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",h.length,")"]})})}),e.jsx(Mu,{visible:$,stallDetails:k,selectedStallId:f,selectedStallIds:h,loading:d,exhibition:i==null?void 0:i.exhibition,onCancel:()=>{v(!1)},onSubmit:E})]})},{Content:mi}=Pe,{Title:gi,Text:Yt,Paragraph:ta}=pe,fi=t=>{if(!t)return"";if(t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;if(s.includes("logos/")||s.includes("sponsors/"))return`${ne.defaults.baseURL}/public/images/${s}`;const n=localStorage.getItem("token"),i=`uploads/${s}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},eh=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},xn=t=>{const s={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString(void 0,s)},th=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);if(n<i){const l=i.getTime()-n.getTime(),a=Math.ceil(l/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} until start`,count:a,isPast:!1}}else if(n>r){const l=n.getTime()-r.getTime(),a=Math.ceil(l/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} since end`,count:a,isPast:!0}}else{const l=r.getTime()-n.getTime(),a=Math.ceil(l/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} remaining`,count:a,isPast:!1}}},sh=()=>{const{id:t}=ot(),s=ve(),[n,i]=u.useState(null),[r,l]=u.useState(!0),[a,f]=u.useState(null),[y,h]=u.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(u.useEffect(()=>{(async()=>{try{if(!t){f("Exhibition ID is missing");return}l(!0),f(null);const I=await dt.getExhibition(t);if(i(I.data),I.data.headerBackground){const j=fi(I.data.headerBackground);h(j);const R=new window.Image;R.src=j}else if(I.data.headerLogo){const j=fi(I.data.headerLogo),R=new window.Image;R.src=j}}catch(I){console.error("Error fetching exhibition:",I),f(I.message||"Error fetching exhibition")}finally{l(!1)}})()},[t]),r)return e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(mi,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Et,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(a||!n)return e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(mi,{style:{paddingTop:"64px"},children:e.jsx(qs,{status:"404",title:"Exhibition not found",subTitle:a||"The exhibition you're looking for doesn't exist or has been removed.",extra:e.jsx(_,{type:"primary",onClick:()=>s("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:S,color:$}=eh(n.startDate,n.endDate),v=th(n.startDate,n.endDate);return e.jsxs(Pe,{className:"exhibition-details-layout",children:[e.jsx(pt,{}),e.jsxs(mi,{className:"exhibition-content",children:[e.jsx("div",{className:"breadcrumb-container",children:e.jsx(Ao,{items:[{title:e.jsx(Je,{to:"/",children:e.jsx($i,{})})},{title:e.jsx(Je,{to:"/exhibitions",children:"Exhibitions"})},{title:n.name}]})}),e.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${y}')`},children:e.jsx("div",{className:"hero-overlay",children:e.jsxs("div",{className:"hero-content",children:[e.jsxs("div",{className:"hero-main",children:[e.jsx(gi,{level:1,className:"exhibition-title",children:n.name}),e.jsxs(G,{size:24,className:"exhibition-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx(kt,{}),e.jsxs(Yt,{children:[xn(n.startDate)," - ",xn(n.endDate)]})]}),n.venue&&e.jsxs("div",{className:"meta-item",children:[e.jsx(Jt,{}),e.jsx(Yt,{children:n.venue})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(Ye,{}),e.jsxs(Yt,{children:[v.text,": ",e.jsx("strong",{children:v.count})]})]})]})]}),e.jsxs("div",{className:"hero-actions",children:[e.jsx(_,{type:"primary",size:"large",icon:e.jsx(ts,{}),onClick:()=>s(`/exhibitions/${t}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),e.jsx(_,{size:"large",icon:e.jsx(rt,{}),onClick:()=>s(`/exhibitions/${t}/layout`),className:"action-button book-button",children:"Book a Stall"}),v.isPast?null:e.jsx(_,{size:"large",icon:e.jsx(On,{}),onClick:()=>s("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),e.jsx("div",{className:"stats-container",children:e.jsxs(ie,{gutter:[16,16],className:"stats-row",children:[e.jsx(M,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon duration-icon",children:e.jsx(kt,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:Math.ceil((new Date(n.endDate).getTime()-new Date(n.startDate).getTime())/(1e3*60*60*24))}),e.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),e.jsx(M,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon countdown-icon",children:e.jsx(Ye,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:v.count}),e.jsx("div",{className:"stat-label",children:v.text})]})]})}),e.jsx(M,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:$+"20",color:$},children:e.jsx(Ws,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value status-value",style:{color:$},children:S}),e.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),n.sponsorLogos&&n.sponsorLogos.length>0&&e.jsxs("div",{className:"sponsors-section",children:[e.jsx("div",{className:"sponsors-header",children:e.jsx(Yt,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),e.jsx("div",{className:"sponsors-container",children:n.sponsorLogos.map((T,I)=>e.jsx("div",{className:"sponsor-logo-wrapper",children:e.jsx("div",{className:"sponsor-logo",children:e.jsx("img",{src:fi(T),alt:`Sponsor ${I+1}`,className:"sponsor-logo-img",onError:j=>{j.target.src="/placeholder-logo.png"}})})},I))})]}),e.jsx("div",{className:"exhibition-details-container",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:24,lg:16,children:e.jsxs(H,{className:"details-card about-card",bordered:!1,children:[e.jsx(gi,{level:3,className:"section-title",children:"About This Exhibition"}),e.jsx(ta,{className:"main-description",children:n.description}),n.headerDescription&&e.jsx(ta,{className:"extended-description",children:n.headerDescription}),n.headerSubtitle&&e.jsxs("div",{className:"subtitle-section",children:[e.jsx(gi,{level:4,children:n.headerSubtitle}),e.jsx(Le,{})]})]})}),e.jsx(M,{xs:24,lg:8,children:e.jsx(G,{direction:"vertical",style:{width:"100%"},size:24,children:e.jsx(H,{title:"Key Information",className:"details-card info-card",bordered:!1,children:e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon start-icon",children:e.jsx(kt,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Yt,{type:"secondary",className:"info-label",children:"Start Date"}),e.jsx("div",{className:"info-value",children:xn(n.startDate)})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon end-icon",children:e.jsx(kt,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Yt,{type:"secondary",className:"info-label",children:"End Date"}),e.jsx("div",{className:"info-value",children:xn(n.endDate)})]})]}),n.venue&&e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon venue-icon",children:e.jsx(Jt,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(Yt,{type:"secondary",className:"info-label",children:"Venue"}),e.jsx("div",{className:"info-value",children:n.venue})]})]})]})})})})]})})]}),e.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:nh}=Pe,{Title:ih,Paragraph:rh,Text:ah}=pe,oh=K(nh)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,lh=K.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,pn=K(ih)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,ch=K.div`
  margin-bottom: 20px;
`,dh=K.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,bt=K(Je)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,yi=K.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,bi=K.div`
  margin-right: 10px;
  color: #4158D0;
`,mn=K.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,uh=K(W)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,hh=K(_)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,xh=K(ah)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,ph=K(Le)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,Xa=()=>{const[t,s]=u.useState("/logo.png"),[n,i]=u.useState("Exhibition Manager"),r=new Date().getFullYear();return u.useEffect(()=>{const l=`${ne.defaults.baseURL}/public/logo`;s(l),fetch(`${ne.defaults.baseURL}/public/site-info`).then(a=>a.json()).then(a=>{a.siteName&&i(a.siteName)}).catch(a=>{console.error("Error fetching site info:",a)})},[]),e.jsx(oh,{children:e.jsxs(lh,{children:[e.jsxs(ie,{gutter:[48,40],children:[e.jsxs(M,{xs:24,sm:24,md:8,lg:7,children:[e.jsx(ch,{children:e.jsx(Je,{to:"/",children:e.jsx(dh,{src:t,alt:n,onError:()=>s("/logo.png")})})}),e.jsx(rh,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),e.jsxs(G,{children:[e.jsx(mn,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(To,{})}),e.jsx(mn,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(Po,{})}),e.jsx(mn,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(Do,{})}),e.jsx(mn,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ro,{})})]})]}),e.jsxs(M,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(pn,{level:4,children:"Quick Links"}),e.jsx(bt,{to:"/exhibitions",children:"Exhibitions"}),e.jsx(bt,{to:"/about",children:"About Us"}),e.jsx(bt,{to:"/contact",children:"Contact Us"}),e.jsx(bt,{to:"/privacy-policy",children:"Privacy Policy"}),e.jsx(bt,{to:"/terms",children:"Terms & Conditions"})]}),e.jsxs(M,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(pn,{level:4,children:"For Exhibitors"}),e.jsx(bt,{to:"/exhibitor/login",children:"Login"}),e.jsx(bt,{to:"/exhibitor/register",children:"Register"}),e.jsx(bt,{to:"/exhibitor/dashboard",children:"Dashboard"}),e.jsx(bt,{to:"/exhibitor/bookings",children:"My Bookings"}),e.jsx(bt,{to:"/faq",children:"FAQ"})]}),e.jsxs(M,{xs:24,sm:24,md:6,lg:7,children:[e.jsx(pn,{level:4,children:"Contact Us"}),e.jsxs(yi,{children:[e.jsx(bi,{children:e.jsx(Jt,{})}),e.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),e.jsxs(yi,{children:[e.jsx(bi,{children:e.jsx(Fi,{})}),e.jsx("div",{children:"+91 98765 43210"})]}),e.jsxs(yi,{children:[e.jsx(bi,{children:e.jsx(Mt,{})}),e.jsx("div",{children:"info@exhibitionmanager.com"})]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx(pn,{level:4,children:"Newsletter"}),e.jsx(F,{children:e.jsxs(G.Compact,{style:{width:"100%"},children:[e.jsx(uh,{placeholder:"Your email address"}),e.jsx(hh,{type:"primary",icon:e.jsx(Lo,{}),children:"Subscribe"})]})})]})]})]}),e.jsx(ph,{}),e.jsxs(xh,{children:["Â© ",r," ",n,". All rights reserved."]})]})})},{Title:sa,Text:ji,Paragraph:na}=pe,{Content:vi}=Pe,mh=(t,s)=>{const n=new Date,i=new Date(t),r=new Date(s);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},ia=t=>{const s={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,s)},gh=t=>{const s=new Date,i=new Date(t).getTime()-s.getTime();return Math.ceil(i/(1e3*60*60*24))},ra=t=>{if(!t)return"/exhibition-placeholder.jpg";if(t.startsWith("/")||t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t,n=s.includes("logos/")?s:`logos/${s}`;return`${ne.defaults.baseURL}/public/images/${n}`},fh=()=>{const t=ve(),[s,n]=u.useState([]),[i,r]=u.useState(!0),[l,a]=u.useState(null),[f,y]=u.useState({});return u.useEffect(()=>{(async()=>{try{r(!0),a(null);const S=await dt.getExhibitions();n(S.data);const $={};S.data.forEach(v=>{if(v.headerLogo){const T=ra(v.headerLogo),I=new window.Image;I.onload=()=>{$[v._id]=!0,y(j=>({...j,[v._id]:!0}))},I.onerror=()=>{console.warn(`Failed to preload image: ${T}`),$[v._id]=!1,y(j=>({...j,[v._id]:!1}))},I.src=T}})}catch(S){a(S.message||"Failed to fetch exhibitions")}finally{r(!1)}})()},[]),i?e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(vi,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Et,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):l?e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(vi,{style:{paddingTop:"64px"},children:e.jsx(qs,{status:"error",title:"Failed to load exhibitions",subTitle:l,extra:[e.jsx(_,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsx(vi,{style:{paddingTop:"64px",background:"#f5f5f5"},children:e.jsxs("div",{style:{padding:"80px 16px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[e.jsx(sa,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),e.jsx(na,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),s.length>0?e.jsx(ie,{gutter:[24,24],children:s.map(h=>{const{status:S,color:$}=mh(h.startDate,h.endDate),v=gh(h.startDate),T=h.headerLogo?ra(h.headerLogo):void 0;return e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(H,{hoverable:!0,onClick:()=>t(Kn(h)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[e.jsx(Ke.Ribbon,{text:S,color:$,style:{right:"-1px",top:"10px",zIndex:2}}),e.jsxs("div",{className:"exhibition-card-container",children:[e.jsx("div",{className:"exhibition-card-logo-container",children:T&&e.jsx("div",{className:"exhibition-logo",children:e.jsx(ba,{src:T,alt:`${h.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:e.jsx(Et,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),e.jsxs("div",{className:"exhibition-card-content",children:[e.jsx("div",{className:"exhibition-title",children:e.jsx(sa,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:h.name})}),e.jsx(na,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:h.description}),e.jsxs("div",{className:"exhibition-card-details",children:[e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(kt,{style:{color:"#722ED1"}}),e.jsx(We,{title:"Exhibition Date Range",children:e.jsxs(ji,{style:{fontSize:14},children:[ia(h.startDate)," - ",ia(h.endDate)]})})]}),h.venue&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Jt,{style:{color:"#F5222D"}}),e.jsx(We,{title:"Venue",children:e.jsx(ji,{style:{fontSize:14},ellipsis:!0,children:h.venue})})]}),S==="Upcoming"&&v>0&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Ye,{style:{color:"#1890FF"}}),e.jsx(We,{title:"Time Remaining",children:e.jsxs(ji,{style:{fontSize:14},children:["Starts in ",v," day",v!==1?"s":""]})})]})]}),e.jsx("div",{className:"exhibition-card-footer",children:e.jsxs(_,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",e.jsx(Ci,{})]})})]})]})]})},h._id)})}):e.jsx(Ct,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:Ct.PRESENTED_IMAGE_SIMPLE})]})}),e.jsx(Xa,{}),e.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},yh=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=ve(),{currentExhibition:r}=ge(l=>l.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>i(Ue(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},bh=()=>{var z,A,m;const{message:t}=ft.useApp(),{id:s}=ot(),n=qt(),i=ve(),r=$e(),[l,a]=Yo(),f=((z=n.state)==null?void 0:z.exhibitionId)||s,{currentExhibition:y,halls:h,stalls:S,loading:$}=ge(C=>C.exhibition),v=u.useRef(null),[T,I]=u.useState(!1),[j,R]=u.useState(null),[d,p]=u.useState(null),[k,o]=u.useState({width:0,height:0}),[c,D]=u.useState(!1);u.useEffect(()=>{if(!f){t.error("Exhibition ID not found"),i("/exhibitions");return}},[f,i,t]),u.useEffect(()=>{if(!f){t.error("Exhibition ID not found"),i("/exhibition");return}(async()=>{try{await r(ht(f)).unwrap(),await r(Nt(f)).unwrap(),D(!0)}catch{t.error("Failed to load data")}})()},[f,r,i]),u.useEffect(()=>{var C,B;!c||!y||(!((C=y.dimensions)!=null&&C.width)||!((B=y.dimensions)!=null&&B.height))&&(t.info("Please set up exhibition space first"),i(Ue(y,"space"),{state:{exhibitionId:f}}))},[y,f,i,c]),u.useEffect(()=>{!c||$||h.length===0&&(t.info("Please create halls first"),i(Ue(y,"halls"),{state:{exhibitionId:f}}))},[h,f,i,$,c]),u.useEffect(()=>{c&&y&&h.length>0&&(async()=>{try{const B=h.map(q=>r(It({exhibitionId:f,hallId:q.id})).unwrap());await Promise.all(B)}catch(B){console.error("Error fetching stalls:",B),t.error("Failed to load stalls")}})()},[y,f,h,r,c]);const w=S.filter(C=>C.hallId===((j==null?void 0:j.id)||(j==null?void 0:j._id)));u.useEffect(()=>{if(!c||h.length===0)return;const C=l.get("hallId");if(C){const B=h.find(q=>q.id===C||q._id===C);if(B)R(B);else if(h.length>0){R(h[0]);const q=h[0].id||h[0]._id;q&&a({hallId:q.toString()})}}else if(h.length>0){R(h[0]);const B=h[0].id||h[0]._id;B&&a({hallId:B.toString()})}},[h,l,c,a]),u.useEffect(()=>{const C=()=>{if(v.current){const{clientWidth:q,clientHeight:O}=v.current;o({width:Math.max(q||400,400),height:Math.max(O||400,400)})}};C();const B=new ResizeObserver(C);return v.current&&B.observe(v.current),window.addEventListener("resize",C),()=>{B.disconnect(),window.removeEventListener("resize",C)}},[]);const P=()=>{if(!j){t.warning("Please select a hall first");return}p(null),I(!0)},g=C=>{if(R(C),p(null),C){const B=C.id||C._id;a(B?{hallId:B.toString()}:{})}else a({})},b=C=>{var q;const B=C?{...C,id:C.id||C._id,_id:C._id||C.id,stallTypeId:typeof C.stallTypeId=="string"?C.stallTypeId:((q=C.stallTypeId)==null?void 0:q._id)||C.stallTypeId,stallType:C.stallType}:null;console.log("Selected stall data:",B),p(B),I(!!B)},L=async C=>{var B,q;try{if(!(j!=null&&j.id)&&!(j!=null&&j._id)){t.error("No hall selected");return}const O=j.id,Y=j._id||j.id;if(C.hallId&&C.hallId!==Y){t.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",C),C.id||C._id){const Z={...C,id:C.id,_id:C._id,hallId:Y,stallTypeId:C.stallTypeId};console.log("Update data:",Z);const te=C.id||C._id;if(!te)throw new Error("Stall ID is missing");await Ie.updateStall(f,te,Z),t.success("Stall updated successfully")}else{const{id:Z,_id:te,...V}=C,Q={...V,hallId:Y,stallTypeId:C.stallTypeId};console.log("Creating new stall with data:",Q),await Ie.createStall(f,Q),t.success("Stall created successfully")}I(!1),r(It({exhibitionId:f,hallId:O}))}catch(O){console.error("Error saving stall:",O),t.error(((q=(B=O.response)==null?void 0:B.data)==null?void 0:q.message)||"Failed to save stall")}},N=async C=>{var B,q;try{if(!f){t.error("Exhibition ID not found");return}const O=j;if(!O){t.error("No hall selected");return}const Y=O.id||O._id;if(!Y){t.error("Invalid hall ID");return}await Ie.deleteStall(f,C),I(!1),p(null),await r(It({exhibitionId:f,hallId:Y})).unwrap(),t.success("Stall deleted successfully")}catch(O){console.error("Error deleting stall:",O),t.error(((q=(B=O.response)==null?void 0:B.data)==null?void 0:q.message)||"Failed to delete stall")}},x=async C=>{var Y,Z;if(!f){t.error("Exhibition ID not found");return}const B=C.id||C._id;if(!B){console.error("Stall data:",C),t.error("Stall ID not found");return}if(!(j!=null&&j.id)&&!(j!=null&&j._id)){t.error("No hall selected");return}const q=j.id,O=j._id||j.id;try{await Ie.updateStall(f,B,{...C,id:B,hallId:O}),r(It({exhibitionId:f,hallId:q}))}catch(te){console.error("Stall update error:",te),t.error(((Z=(Y=te.response)==null?void 0:Y.data)==null?void 0:Z.message)||"Failed to update stall position")}},E=()=>{I(!1),p(null)};return e.jsx(Ks,{children:e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{padding:"24px 24px 0"},children:e.jsx(yh,{exhibitionId:f})}),e.jsx(H,{title:"Stall Manager",extra:e.jsxs(G,{children:[e.jsx(_,{icon:e.jsx(ya,{}),onClick:()=>i(`/exhibition/${f}`,{state:{exhibitionId:f}}),children:"Back to Exhibition"}),e.jsx(_,{type:"primary",icon:e.jsx(et,{}),onClick:P,disabled:!j,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:e.jsx("div",{ref:v,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:y&&e.jsx(Xs,{width:k.width,height:k.height,exhibitionWidth:((A=y.dimensions)==null?void 0:A.width)||100,exhibitionHeight:((m=y.dimensions)==null?void 0:m.height)||100,halls:h,selectedHall:j,onSelectHall:g,isStallMode:!0,children:j&&w.map(C=>e.jsx(Xi,{stall:C,isSelected:(d==null?void 0:d.id)===C.id||(d==null?void 0:d._id)===C._id,onSelect:()=>b(C),onChange:x,hallWidth:j.dimensions.width,hallHeight:j.dimensions.height,hallX:j.dimensions.x,hallY:j.dimensions.y},C.id||C._id))})})}),y&&e.jsx(gu,{visible:T,stall:d,hall:j,exhibition:y,onCancel:E,onSubmit:L,onDelete:d?()=>N(d.id||d._id):void 0})]})})},jh=({exhibitionId:t,destination:s="layout",label:n="Back to Layout"})=>{const i=ve(),{currentExhibition:r}=ge(l=>l.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>i(Ue(r,s),{state:{exhibitionId:t}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},vh=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],wh=()=>{var L,N,x;const{message:t}=ft.useApp(),{id:s}=ot(),n=qt(),i=ve(),r=$e(),l=((L=n.state)==null?void 0:L.exhibitionId)||s,{currentExhibition:a,fixtures:f,halls:y,stalls:h,loading:S}=ge(E=>E.exhibition),$=u.useRef(null),[v,T]=u.useState(!1),[I,j]=u.useState(null),[R,d]=u.useState({width:0,height:0}),[p,k]=u.useState("all"),[o,c]=u.useState([]);u.useEffect(()=>{if(!l){t.error("Exhibition ID not found"),i("/exhibitions");return}},[l,i,t]),u.useEffect(()=>{(async()=>{try{await r(ht(l)).unwrap(),await r(Fs({exhibitionId:l})).unwrap(),await r(Nt(l)).unwrap(),await r(It({exhibitionId:l})).unwrap()}catch{t.error("Failed to load data")}})()},[l,r,t]),u.useEffect(()=>{c(p==="all"?f:f.filter(E=>E.type===p))},[f,p]),u.useEffect(()=>{const E=()=>{if($.current){const{clientWidth:A,clientHeight:m}=$.current;d({width:Math.max(A||400,400),height:Math.max(m||400,400)})}};E();const z=new ResizeObserver(E);return $.current&&z.observe($.current),window.addEventListener("resize",E),()=>{z.disconnect(),window.removeEventListener("resize",E)}},[]);const D=()=>{j(null),T(!0)},w=E=>{j(E),T(!!E)},P=async E=>{try{E.id||E._id?(await r(In({exhibitionId:l,id:E.id||E._id||"",data:E})).unwrap(),t.success("Fixture updated successfully")):(await r(kn({exhibitionId:l,data:E})).unwrap(),t.success("Fixture created successfully")),await r(Fs({exhibitionId:l})).unwrap(),T(!1)}catch(z){console.error("Failed to save fixture:",z),t.error(z.message||"Failed to save fixture")}},g=async E=>{try{const z=E.id||E._id;if(!z)throw new Error("Fixture ID is required");await r(Cn({exhibitionId:l,id:z})).unwrap(),t.success("Fixture deleted successfully"),T(!1),j(null)}catch(z){console.error("Failed to delete fixture:",z),t.error(z.message||"Failed to delete fixture")}},b=E=>{k(E)};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(jh,{exhibitionId:l}),e.jsxs(H,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(G,{children:e.jsx("span",{children:"Fixture Management"})}),e.jsxs(G,{children:[e.jsx(oe,{style:{width:180},value:p,onChange:b,options:vh}),e.jsx(_,{type:"primary",icon:e.jsx(et,{}),onClick:D,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[e.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),e.jsx("div",{ref:$,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(Ks,{children:R.width>0&&R.height>0&&(a==null?void 0:a.dimensions)&&e.jsx(Xs,{width:R.width,height:R.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:y,stalls:h,fixtures:o,selectedFixture:I,onSelectFixture:w,onFixtureChange:P,onAddFixture:D,isFixtureMode:!0})})})]}),e.jsx(vu,{visible:v,fixture:I,onCancel:()=>T(!1),onSubmit:P,onDelete:g,exhibitionWidth:((N=a==null?void 0:a.dimensions)==null?void 0:N.width)||100,exhibitionHeight:((x=a==null?void 0:a.dimensions)==null?void 0:x.height)||100})]})},{Title:Sh,Text:kh}=pe,{Option:us}=oe,Ih=()=>{const t=ve(),s=$e(),{stalls:n,loading:i}=ge(A=>A.exhibition),[r,l]=u.useState([]),[a,f]=u.useState([]),[y,h]=u.useState(null),[S,$]=u.useState(null),[v,T]=u.useState(!1),I=Ae.useMemo(()=>Math.max(...n.map(A=>A.ratePerSqm*A.dimensions.width*A.dimensions.height),1e6),[n]),j=Ae.useMemo(()=>{const A=Math.pow(10,Math.floor(Math.log10(I)));return Math.ceil(I/A)*A},[I]),[R,d]=u.useState(""),[p,k]=u.useState(null),[o,c]=u.useState([0,j]),[D,w]=u.useState("number"),[P,g]=u.useState("ascend"),b=A=>{h(A),$(null),s({type:"exhibition/clearStalls"})},L=A=>{$(A),s(y&&A?It({exhibitionId:y,hallId:A}):{type:"exhibition/clearStalls"})};u.useEffect(()=>{(async()=>{try{T(!0),console.log("Fetching exhibitions...");const m=await Ie.getActiveExhibitions();console.log("Exhibitions response:",m.data),l(m.data)}catch(m){console.error("Failed to fetch exhibitions:",m)}finally{T(!1)}})()},[]),u.useEffect(()=>{y?(async()=>{try{T(!0),console.log("Fetching halls for exhibition:",y);const m=await Ie.getHalls(y);console.log("Halls response:",m.data),f(m.data)}catch(m){console.error("Failed to fetch halls:",m)}finally{T(!1)}})():f([])},[y]);const N=Ae.useMemo(()=>{console.log("Filtering stalls from Redux:",n);const A=n.filter(m=>{const C=!R||m.number.toLowerCase().includes(R.toLowerCase()),B=!p||m.status===p,q=!S||m.hallId===S,O=m.ratePerSqm*m.dimensions.width*m.dimensions.height,Y=O>=o[0]&&O<=o[1];return C&&B&&q&&Y}).sort((m,C)=>D==="number"?P==="ascend"?m.number.localeCompare(C.number):C.number.localeCompare(m.number):0);return console.log("Filtered stalls:",A),A},[n,R,p,S,o,D,P]),x=A=>{switch(A){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},z=(A=>{const m=A.reduce((C,B)=>{var q,O;return(q=B==null?void 0:B.dimensions)!=null&&q.width&&((O=B==null?void 0:B.dimensions)!=null&&O.height)?C+B.dimensions.width*B.dimensions.height:C},0);return{totalStalls:A.length,totalSize:m}})(N);return e.jsx("div",{className:"dashboard-container",children:e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{span:24,children:e.jsxs(G,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx(Sh,{level:4,style:{margin:0},children:"Stalls"}),e.jsx(kh,{type:"secondary",children:"Manage your exhibition stalls"})]})}),e.jsx(M,{span:24,children:e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(oe,{style:{width:"100%"},placeholder:"Select Exhibition",value:y,onChange:b,allowClear:!0,children:r.map(A=>e.jsx(us,{value:A._id||A.id,children:A.name},A._id||A.id))})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(oe,{style:{width:"100%"},placeholder:"Select Hall",value:S,onChange:L,disabled:!y||a.length===0,allowClear:!0,children:a.map(A=>e.jsx(us,{value:A._id||A.id,children:A.name},A._id||A.id))})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(W,{placeholder:"Search by stall number",prefix:e.jsx(mt,{}),value:R,onChange:A=>d(A.target.value),allowClear:!0})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsxs(oe,{style:{width:"100%"},placeholder:"Filter by status",value:p,onChange:k,allowClear:!0,children:[e.jsx(us,{value:"available",children:"Available"}),e.jsx(us,{value:"booked",children:"Booked"}),e.jsx(us,{value:"reserved",children:"Reserved"}),e.jsx(us,{value:"sold",children:"Sold"})]})})]})}),e.jsx(M,{span:24,children:e.jsx(H,{size:"small",children:e.jsxs(ie,{gutter:16,children:[e.jsx(M,{xs:12,sm:12,md:6,children:e.jsx(ye,{title:"Total Stalls",value:z.totalStalls,prefix:e.jsx($o,{})})}),e.jsx(M,{xs:12,sm:12,md:6,children:e.jsx(ye,{title:"Total Area",value:z.totalSize,suffix:"sqm",prefix:e.jsx(ts,{}),precision:2})})]})})}),e.jsx(M,{span:24,children:e.jsx(H,{size:"small",title:"Price Range Filter",children:e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:24,style:{marginBottom:16},children:e.jsxs(G,{children:[e.jsx(_,{size:"small",onClick:()=>c([0,5e5]),children:"Under â‚¹5L"}),e.jsx(_,{size:"small",onClick:()=>c([5e5,1e6]),children:"â‚¹5L - â‚¹10L"}),e.jsx(_,{size:"small",onClick:()=>c([1e6,2e6]),children:"â‚¹10L - â‚¹20L"}),e.jsx(_,{size:"small",onClick:()=>c([2e6,j]),children:"Above â‚¹20L"}),e.jsx(_,{size:"small",onClick:()=>c([0,j]),children:"All"})]})}),e.jsx(M,{span:16,children:e.jsx(fa,{range:!0,min:0,max:j,value:o,onChange:A=>c(A),step:Math.max(1e3,Math.floor(j/1e3)),tooltip:{formatter:A=>`â‚¹${(A||0).toLocaleString()}`}})}),e.jsx(M,{span:4,children:e.jsx(Fe,{style:{width:"100%"},min:0,max:o[1],value:o[0],onChange:A=>c([A||0,o[1]]),formatter:A=>`â‚¹ ${A}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:A=>A?Number(A.replace(/[^\d.-]/g,"")):0,step:1e3})}),e.jsx(M,{span:4,children:e.jsx(Fe,{style:{width:"100%"},min:o[0],max:j,value:o[1],onChange:A=>c([o[0],A||j]),formatter:A=>`â‚¹ ${A}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:A=>A?Number(A.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),e.jsx(M,{span:24,children:e.jsx(Re,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(A,m)=>A.number.localeCompare(m.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(A,m)=>{var C;return((C=m.stallType)==null?void 0:C.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:A=>A?`â‚¹${A.toLocaleString()}`:"N/A",sorter:(A,m)=>(A.ratePerSqm||0)-(m.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(A,m)=>{var C,B;return(C=m==null?void 0:m.dimensions)!=null&&C.width&&((B=m==null?void 0:m.dimensions)!=null&&B.height)?`${m.dimensions.width*m.dimensions.height} sqm`:"N/A"},sorter:(A,m)=>{var q,O,Y,Z;const C=(((q=A.dimensions)==null?void 0:q.width)||0)*(((O=A.dimensions)==null?void 0:O.height)||0),B=(((Y=m.dimensions)==null?void 0:Y.width)||0)*(((Z=m.dimensions)==null?void 0:Z.height)||0);return C-B}},{title:"Dimensions",key:"dimensions",render:(A,m)=>{var C,B;return(C=m==null?void 0:m.dimensions)!=null&&C.width&&((B=m==null?void 0:m.dimensions)!=null&&B.height)?`${m.dimensions.width}m Ã— ${m.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(A,m)=>{var C,B;return(C=m==null?void 0:m.dimensions)!=null&&C.width&&((B=m==null?void 0:m.dimensions)!=null&&B.height)&&m.ratePerSqm?`â‚¹${(m.ratePerSqm*m.dimensions.width*m.dimensions.height).toLocaleString()}`:"N/A"},sorter:(A,m)=>{var q,O,Y,Z;const C=(A.ratePerSqm||0)*(((q=A.dimensions)==null?void 0:q.width)||0)*(((O=A.dimensions)==null?void 0:O.height)||0),B=(m.ratePerSqm||0)*(((Y=m.dimensions)==null?void 0:Y.width)||0)*(((Z=m.dimensions)==null?void 0:Z.height)||0);return C-B}},{title:"Status",dataIndex:"status",key:"status",render:A=>e.jsx(le,{color:x(A),style:{textTransform:"capitalize"},children:A||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(A,m)=>m.status===A},{title:"Actions",key:"actions",render:(A,m)=>e.jsxs(G,{children:[e.jsx("a",{onClick:()=>t(`/stall/edit/${m._id||m.id}`),children:"Edit"}),e.jsx("a",{onClick:()=>t(`/stall/view/${m._id||m.id}`),children:"View"})]})}],dataSource:N,rowKey:A=>A._id||A.id,loading:v||i,pagination:{total:N.length,pageSize:10,showSizeChanger:!0,showTotal:A=>`Total ${A} stalls`},onChange:(A,m,C)=>{C.field&&(w(C.field),g(C.order))}})})]})})})},{Title:Ch,Text:Nh}=pe,{TextArea:Eh}=W,{Search:Ah}=W,{Option:aa}=oe,Th=()=>{ve();const{message:t}=ft.useApp(),[s,n]=u.useState(!1),[i]=F.useForm(),[r,l]=u.useState(!1),[a,f]=u.useState([]),[y,h]=u.useState(!1),[S,$]=u.useState(null);u.useEffect(()=>{v()},[]),u.useEffect(()=>{var p;if(console.log("Modal visibility changed:",s),console.log("Editing stall type:",S),s&&S){const k=((p=S.features)==null?void 0:p.map(o=>o.feature).join(", "))||"";console.log("Setting form values:",{name:S.name,description:S.description,features:k,status:S.status}),setTimeout(()=>{i.setFieldsValue({name:S.name,description:S.description,features:k,status:S.status})},0)}else s&&(i.resetFields(),i.setFieldsValue({status:"active"}))},[S,i,s]);const v=async()=>{try{h(!0);const p=await gs.getStallTypes();f(p.data)}catch(p){t.error("Failed to fetch stall types: "+p.message)}finally{h(!1)}},T=async p=>{try{l(!0),console.log("Form values:",p);const k={name:p.name,description:p.description,status:p.status,features:p.features?p.features.split(",").map(o=>({feature:o.trim()})):[]};console.log("Submitting data:",k),S?(await gs.updateStallType(S._id,k),t.success("Stall type updated successfully")):(await gs.createStallType(k),t.success("Stall type created successfully")),n(!1),$(null),i.resetFields(),v()}catch(k){t.error(`Failed to ${S?"update":"create"} stall type: `+k.message)}finally{l(!1)}},I=p=>{console.log("Editing stall type:",p),$(p),n(!0)},j=async p=>{try{await gs.deleteStallType(p._id),t.success("Stall type deleted successfully"),v()}catch(k){t.error("Failed to delete stall type: "+k.message)}},R=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(p,k)=>p.name.localeCompare(k.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:p=>e.jsx(G,{wrap:!0,children:p==null?void 0:p.map(({feature:k})=>e.jsx(le,{children:k},k))})},{title:"Status",dataIndex:"status",key:"status",render:p=>e.jsx(le,{color:p==="active"?"success":"default",children:p.toUpperCase()})},{title:"Actions",key:"actions",render:(p,k)=>e.jsxs(G,{children:[e.jsx(_,{type:"link",onClick:()=>I(k),children:"Edit"}),e.jsx(_,{type:"link",danger:!0,onClick:()=>j(k),children:"Delete"})]})}],d=()=>{n(!1),$(null),i.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsx(M,{children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(Ch,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(Nh,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(M,{children:e.jsxs(G,{children:[e.jsx(Ah,{placeholder:"Search stall types",style:{width:200},onSearch:p=>console.log(p)}),e.jsx(_,{type:"primary",icon:e.jsx(et,{}),onClick:()=>n(!0),children:"Add Stall Type"})]})})]})}),e.jsx(H,{className:"info-card",children:e.jsx(Re,{columns:R,dataSource:a,rowKey:p=>p._id,loading:y})}),e.jsx(me,{title:S?"Edit Stall Type":"Add Stall Type",open:s,onCancel:d,footer:null,destroyOnClose:!1,children:e.jsxs(F,{form:i,layout:"vertical",onFinish:T,initialValues:{status:"active"},preserve:!0,children:[e.jsx(F.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(W,{placeholder:"e.g., 1 Side Open"})}),e.jsx(F.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(Eh,{rows:4,placeholder:"Enter description"})}),e.jsx(F.Item,{name:"features",label:"Features",children:e.jsx(W,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(F.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(oe,{children:[e.jsx(aa,{value:"active",children:"Active"}),e.jsx(aa,{value:"inactive",children:"Inactive"})]})}),e.jsx(F.Item,{children:e.jsxs(_,{type:"primary",htmlType:"submit",loading:r,block:!0,children:[S?"Update":"Create"," Stall Type"]})})]})})]})},Ph={bookings:[],currentBooking:null,loading:!1,error:null},Gt=De("booking/fetchBookings",async()=>(await ne.get("/bookings")).data),wi=De("booking/fetchBooking",async t=>(await ne.get(`/bookings/${t}`)).data),Nn=De("booking/createBooking",async t=>(await ne.post("/bookings",t)).data),En=De("booking/updateStatus",async({id:t,status:s,rejectionReason:n})=>(await ne.patch(`/bookings/${t}`,{status:s,...n&&{rejectionReason:n}})).data),Si=De("booking/updatePaymentStatus",async({id:t,paymentStatus:s,paymentDetails:n})=>(await ne.patch(`/bookings/${t}/payment`,{paymentStatus:s,paymentDetails:n})).data),An=De("booking/deleteBooking",async t=>(await ne.delete(`/bookings/${t}`),t)),Za=ct({name:"booking",initialState:Ph,reducers:{clearCurrentBooking:t=>{t.currentBooking=null},clearBookingError:t=>{t.error=null}},extraReducers:t=>{t.addCase(Gt.pending,s=>{s.loading=!0,s.error=null}).addCase(Gt.fulfilled,(s,n)=>{s.loading=!1,s.bookings=n.payload}).addCase(Gt.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to fetch bookings"}).addCase(wi.pending,s=>{s.loading=!0,s.error=null}).addCase(wi.fulfilled,(s,n)=>{s.loading=!1,s.currentBooking=n.payload}).addCase(wi.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to fetch booking"}).addCase(Nn.pending,s=>{s.loading=!0,s.error=null}).addCase(Nn.fulfilled,(s,n)=>{s.loading=!1,s.bookings.unshift(n.payload),s.currentBooking=n.payload}).addCase(Nn.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to create booking"}).addCase(En.pending,s=>{s.loading=!0,s.error=null}).addCase(En.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.bookings.findIndex(l=>l._id===n.payload._id);i!==-1&&(s.bookings[i]=n.payload),((r=s.currentBooking)==null?void 0:r._id)===n.payload._id&&(s.currentBooking=n.payload)}).addCase(En.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to update booking status"}).addCase(Si.pending,s=>{s.loading=!0,s.error=null}).addCase(Si.fulfilled,(s,n)=>{var r;s.loading=!1;const i=s.bookings.findIndex(l=>l._id===n.payload._id);i!==-1&&(s.bookings[i]=n.payload),((r=s.currentBooking)==null?void 0:r._id)===n.payload._id&&(s.currentBooking=n.payload)}).addCase(Si.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to update payment status"}).addCase(An.pending,s=>{s.loading=!0,s.error=null}).addCase(An.fulfilled,(s,n)=>{var i;s.loading=!1,s.bookings=s.bookings.filter(r=>r._id!==n.payload),((i=s.currentBooking)==null?void 0:i._id)===n.payload&&(s.currentBooking=null)}).addCase(An.rejected,(s,n)=>{s.loading=!1,s.error=n.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:Ax,clearBookingError:Tx}=Za.actions,Dh=Za.reducer,Rh="/api",Tn=Ki({reducerPath:"invoiceApi",baseQuery:Wi({baseUrl:Rh,credentials:"include",prepareHeaders:t=>{const s=localStorage.getItem("token");return s&&t.set("authorization",`Bearer ${s}`),t.set("Content-Type","application/json"),t.set("Accept","application/json"),t}}),tagTypes:["Invoice"],endpoints:t=>({getInvoices:t.query({query:(s={page:1,limit:10})=>({url:"/invoices",method:"GET",params:s}),transformResponse:s=>(console.log("Raw invoice response:",s),typeof s=="object"&&s!==null&&"data"in s?s:Array.isArray(s)?{success:!0,data:s,pagination:{total:s.length,page:1,limit:s.length,pages:1}}:(console.error("Invalid invoice response:",s),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:s=>(console.error("Invoice API Error:",s),s),providesTags:["Invoice"]}),getInvoice:t.query({query:s=>({url:`/invoices/${s}`,method:"GET"}),transformErrorResponse:s=>(console.error("Get Invoice Error:",s),s),providesTags:(s,n,i)=>[{type:"Invoice",id:i}]}),downloadInvoice:t.mutation({query:s=>({url:`/invoices/${s}/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:t.mutation({query:({id:s,...n})=>({url:`/invoices/${s}/share/email`,method:"POST",body:n})}),shareViaWhatsApp:t.mutation({query:({id:s,...n})=>({url:`/invoices/${s}/share/whatsapp`,method:"POST",body:n})})})}),{useGetInvoicesQuery:Lh,useGetInvoiceQuery:$h}=Tn,Fh=({bookings:t})=>{const n={total:t.length,pending:t.filter(r=>r.status==="pending").length,approved:t.filter(r=>r.status==="approved").length,rejected:t.filter(r=>r.status==="rejected").length,confirmed:t.filter(r=>r.status==="confirmed").length,cancelled:t.filter(r=>r.status==="cancelled").length,totalRevenue:t.filter(r=>r.status==="confirmed"||r.status==="approved").reduce((r,l)=>r+l.amount,0),totalActiveBookings:t.filter(r=>r.status==="confirmed"||r.status==="approved").length,totalDeclinedBookings:t.filter(r=>r.status==="cancelled"||r.status==="rejected").length};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Total Bookings",value:n.total,prefix:e.jsx(Mi,{})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Pending Bookings",value:n.pending,prefix:e.jsx(Ye,{style:{color:"#faad14"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Approved Bookings",value:n.approved,prefix:e.jsx(Ee,{style:{color:"#52c41a"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Confirmed Bookings",value:n.confirmed,prefix:e.jsx(Ee,{style:{color:"#52c41a"}})})})})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Rejected Bookings",value:n.rejected,prefix:e.jsx(Xt,{style:{color:"#f5222d"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Cancelled Bookings",value:n.cancelled,prefix:e.jsx(Xt,{style:{color:"#f5222d"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Total Revenue",value:n.totalRevenue,prefix:"â‚¹",precision:2})})}),e.jsx(M,{xs:24,sm:12,md:6})]})]})},{RangePicker:Bh}=Ys,Mh=({filters:t,exhibitions:s,onFilterChange:n,onRefresh:i})=>e.jsx(H,{style:{marginBottom:"24px"},children:e.jsxs(G,{wrap:!0,children:[e.jsx(W,{placeholder:"Search by company name",prefix:e.jsx(mt,{}),value:t.search,onChange:r=>n({...t,search:r.target.value}),style:{width:200},allowClear:!0}),e.jsx(oe,{placeholder:"Filter by exhibition",value:t.exhibition,onChange:r=>n({...t,exhibition:r}),style:{minWidth:200},allowClear:!0,options:s.map(r=>({label:r.name,value:r._id}))}),e.jsx(oe,{mode:"multiple",placeholder:"Filter by status",value:t.status,onChange:r=>n({...t,status:r}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),e.jsx(Bh,{onChange:r=>{var l,a;return n({...t,dateRange:r?[((l=r[0])==null?void 0:l.toISOString())||"",((a=r[1])==null?void 0:a.toISOString())||""]:null})}}),e.jsx(_,{icon:e.jsx(Ri,{}),onClick:i,children:"Refresh"})]})}),{Title:zh,Text:Te}=pe,{RangePicker:Px}=Ys,Uh=()=>{const t=$e(),{bookings:s,loading:n}=ge(z=>z.booking),{exhibitions:i}=ge(z=>z.exhibition),[r,l]=u.useState(null),[a,f]=u.useState(!1),[y,h]=u.useState({search:"",status:[],dateRange:null,exhibition:null}),S=ve(),{data:$,isLoading:v,error:T,refetch:I}=Lh({page:1,limit:100}),[j,R]=u.useState(!1),[d,p]=u.useState("pending"),[k,o]=u.useState(""),[c,D]=u.useState(!1);u.useEffect(()=>{t(Gt())},[t]),u.useEffect(()=>{t(wt())},[t]),u.useEffect(()=>{s.length>0&&[...new Set(s.map(A=>A.exhibitionId._id))].forEach(A=>{t(ht(A))})},[s,t]);const w=async(z,A,m)=>{try{D(!0),await t(En({id:z,status:A,...m&&{rejectionReason:m}})).unwrap(),ee.success(`Booking ${A} successfully`),t(Gt()),f(!1),R(!1),l(null)}catch{ee.error("Failed to update booking status")}finally{D(!1)}},P=async z=>{try{await t(An(z)).unwrap(),ee.success("Booking deleted successfully"),t(Gt())}catch(A){ee.error((A==null?void 0:A.message)||"Failed to delete booking")}},g=z=>{h(z)},b=s.filter(z=>{var A;if(y.search&&!((A=z.companyName)!=null&&A.toLowerCase().includes(y.search.toLowerCase()))||y.status.length>0&&!y.status.includes(z.status)||y.exhibition&&z.exhibitionId._id!==y.exhibition)return!1;if(y.dateRange){const[m,C]=y.dateRange,B=new Date(z.createdAt);if(B<new Date(m)||B>new Date(C))return!1}return!0}),L=(z,A)=>{const m=new Date(A).getFullYear(),C=s.find(te=>te._id===z);if(!C)return`--/${m}/--`;const O=(s.filter(te=>te.exhibitionId._id===C.exhibitionId._id).sort((te,V)=>new Date(te.createdAt).getTime()-new Date(V.createdAt).getTime()).findIndex(te=>te._id===z)+1).toString().padStart(2,"0"),Y=i.find(te=>te._id===C.exhibitionId._id);return`${(Y==null?void 0:Y.invoicePrefix)||C.exhibitionId.invoicePrefix||"BK"}/${m}/${O}`},N=z=>{if(v)return console.log("Loading invoices..."),null;if(T)return console.error("Error loading invoices:",T),null;if(!$)return console.log("No invoices available"),null;const A=$.data||[];console.log("Looking for invoice with booking ID:",z);const m=A.find(C=>C.bookingId&&typeof C.bookingId=="object"&&C.bookingId._id===z);return console.log("Found invoice:",m),m==null?void 0:m._id},x=async z=>{if(v){ee.loading("Loading invoice data...");return}let A=N(z._id);if(A||(ee.loading("Checking for invoice..."),await I(),A=N(z._id)),A)S(`/invoice/${A}`);else{const m=new Date(z.createdAt),C=new Date(Date.now()-5*60*1e3);m>C?(ee.info("Invoice is still being generated. Checking again in 5 seconds..."),setTimeout(async()=>{await I();const B=N(z._id);B?S(`/invoice/${B}`):ee.warning("Invoice is not ready yet. Please try again in a few moments.")},5e3)):ee.error("No invoice found for this booking. Please contact support if this persists.")}},E=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(z,A)=>e.jsx(_,{type:"link",onClick:()=>{l(s.find(m=>m._id===z)||null),f(!0)},children:L(z,A.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(z,A)=>A.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:z=>z||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(z,A)=>A.stallIds.map(m=>m.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:z=>`â‚¹${z.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(z,A)=>{const m=A.calculations.totalDiscountAmount;if(!m||m===0)return"-";const C=A.calculations.stalls.filter(q=>q.discount).map(q=>q.discount);if(C.length===0)return"-";const B=C[0];return e.jsx(We,{title:e.jsx("div",{children:C.map((q,O)=>e.jsxs("div",{children:[q==null?void 0:q.name,": ",(q==null?void 0:q.type)==="percentage"?`${q==null?void 0:q.value}%`:`â‚¹${q==null?void 0:q.value}`,e.jsx("br",{}),"Amount: â‚¹",q==null?void 0:q.amount.toLocaleString()]},O))}),children:e.jsxs(le,{color:"red",children:["-â‚¹",m.toLocaleString(),(B==null?void 0:B.type)==="percentage"&&` (${B.value}%)`,C.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:z=>`â‚¹${z.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:z=>e.jsx(le,{color:z==="confirmed"?"success":z==="approved"?"blue":z==="pending"?"warning":z==="rejected"?"error":"default",children:z.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:z=>Ne(z).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(z,A)=>e.jsxs(G,{children:[e.jsx(We,{title:"View Details",children:e.jsx(_,{icon:e.jsx(Lt,{}),onClick:()=>{l(A),f(!0)}})}),e.jsx(zt,{overlay:e.jsxs(nt,{children:[A.status!=="cancelled"&&e.jsx(nt.Item,{icon:e.jsx(Bt,{}),disabled:v,onClick:()=>x(A),children:"View Invoice"},"invoice"),e.jsx(nt.Item,{icon:e.jsx(Ee,{}),onClick:()=>{l(A),p(A.status),o(A.rejectionReason||""),R(!0)},children:"Update Status"},"updateStatus"),e.jsx(nt.Item,{icon:e.jsx(ut,{}),danger:!0,onClick:()=>{me.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>P(A._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(_,{icon:e.jsx(Vn,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(M,{flex:"auto",children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(zh,{level:4,style:{margin:0},children:"Stall Bookings"}),e.jsx(Te,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),e.jsx(M,{children:e.jsx(_,{type:"primary",size:"large",icon:e.jsx(et,{}),onClick:()=>S("/bookings/create"),children:"Create Booking"})})]})}),e.jsx(Fh,{bookings:s}),e.jsx(Mh,{filters:y,exhibitions:i,onFilterChange:g,onRefresh:()=>t(Gt())}),e.jsx(H,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:e.jsx(Re,{columns:E,dataSource:b,loading:n,rowKey:"_id",scroll:{x:1500},pagination:{total:b.length,pageSize:10,showSizeChanger:!0,showTotal:z=>`Total ${z} items`,position:["bottomRight"]}})}),e.jsx(me,{title:"Booking Details",open:a,onCancel:()=>{f(!1),l(null)},footer:[e.jsx(_,{type:"primary",disabled:!r,onClick:()=>{r&&(p(r.status),o(r.rejectionReason||""),R(!0))},children:"Update Status"},"updateStatus"),e.jsx(_,{onClick:()=>{f(!1),l(null)},children:"Close"},"close")],width:800,children:r&&e.jsxs(G,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(xe,{bordered:!0,column:2,children:[e.jsxs(xe.Item,{label:"Booking Number",span:2,children:[L(r._id,r.createdAt),e.jsxs(Te,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",r._id,")"]})]}),e.jsx(xe.Item,{label:"Exhibition",span:2,children:r.exhibitionId.name}),e.jsxs(xe.Item,{label:"Status",span:2,children:[e.jsx(le,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()}),r.rejectionReason&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Te,{type:"secondary",children:"Rejection Reason:"}),e.jsx("br",{}),e.jsx(Te,{children:r.rejectionReason})]})]}),e.jsx(xe.Item,{label:"Customer Name",children:r.customerName}),e.jsx(xe.Item,{label:"Customer Email",children:r.customerEmail}),e.jsx(xe.Item,{label:"Customer Phone",children:r.customerPhone}),e.jsx(xe.Item,{label:"Company Name",children:r.companyName})]}),e.jsx(H,{title:"Stall Details",size:"small",children:e.jsx(Re,{dataSource:r.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:z=>e.jsxs(le,{color:"blue",children:[z.dimensions.width,"x",z.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:z=>`â‚¹${z.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:z=>{const A=r.calculations.stalls.find(m=>m.stallId===z._id);return A?`â‚¹${A.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:z=>{const A=r.calculations.stalls.find(m=>m.stallId===z._id);return A!=null&&A.discount?e.jsxs(le,{color:"red",children:["-â‚¹",A.discount.amount.toLocaleString(),A.discount.type==="percentage"&&` (${A.discount.value}%)`]}):"-"}}]})}),e.jsx(H,{title:"Financial Summary",size:"small",children:e.jsxs(G,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Te,{children:"Total Base Amount:"}),e.jsxs(Te,{children:["â‚¹",r.calculations.totalBaseAmount.toLocaleString()]})]}),r.calculations.totalDiscountAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Te,{children:"Total Discount:"}),e.jsxs(Te,{type:"danger",children:["-â‚¹",r.calculations.totalDiscountAmount.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Te,{children:"Amount after Discount:"}),e.jsxs(Te,{children:["â‚¹",r.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),e.jsx(Le,{style:{margin:"8px 0"}}),r.calculations.taxes.map(z=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Te,{children:[z.name," (",z.rate,"%):"]}),e.jsxs(Te,{children:["â‚¹",z.amount.toLocaleString()]})]},z.name)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Te,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Te,{strong:!0,children:["â‚¹",r.amount.toLocaleString()]})]})]})})]})}),e.jsx(me,{title:"Update Booking Status",open:j,onCancel:()=>{R(!1),o("")},footer:null,width:600,children:r&&e.jsxs("div",{children:[e.jsx(H,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Bt,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(M,{span:8,children:e.jsx(Te,{strong:!0,children:"Booking Number:"})}),e.jsx(M,{span:16,children:e.jsx(Te,{children:L(r._id,r.createdAt)})}),e.jsx(M,{span:8,children:e.jsx(Te,{strong:!0,children:"Company:"})}),e.jsx(M,{span:16,children:e.jsx(Te,{children:r.companyName})}),e.jsx(M,{span:8,children:e.jsx(Te,{strong:!0,children:"Exhibition:"})}),e.jsx(M,{span:16,children:e.jsx(Te,{children:r.exhibitionId.name})}),e.jsx(M,{span:8,children:e.jsx(Te,{strong:!0,children:"Current Status:"})}),e.jsx(M,{span:16,children:e.jsx(le,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()})})]})}),e.jsxs(H,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Zt,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Te,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(vt.Group,{value:d,onChange:z=>p(z.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[e.jsx(vt.Button,{value:"pending",style:{flex:"0 0 auto"},children:e.jsxs(G,{children:[e.jsx(Ye,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(vt.Button,{value:"approved",style:{flex:"0 0 auto"},children:e.jsxs(G,{children:[e.jsx(Ee,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(vt.Button,{value:"rejected",style:{flex:"0 0 auto"},children:e.jsxs(G,{children:[e.jsx(Xt,{style:{color:"#f5222d"}}),"Rejected"]})}),e.jsx(vt.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:e.jsxs(G,{children:[e.jsx(Ee,{style:{color:"#1890ff"}}),"Confirmed"]})}),e.jsx(vt.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:e.jsxs(G,{children:[e.jsx(Xt,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),d==="rejected"&&e.jsx("div",{children:e.jsx(F.Item,{label:e.jsx(Te,{strong:!0,children:"Rejection Reason:"}),required:d==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:e.jsx(W.TextArea,{rows:4,value:k,onChange:z=>o(z.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),d==="approved"&&e.jsx(Qe,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),d==="confirmed"&&e.jsx(Qe,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),d==="cancelled"&&e.jsx(Qe,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),d==="pending"&&e.jsx(Qe,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(_,{onClick:()=>{R(!1),o("")},children:"Cancel"}),e.jsx(_,{type:"primary",onClick:()=>{if(d==="rejected"&&!k.trim()){ee.error("Rejection reason is required when rejecting a booking");return}w(r._id,d,d==="rejected"?k:void 0)},loading:c,disabled:d==="rejected"&&!k.trim(),children:"Update Status"})]})]})]})})]})},qh={exhibitors:[],loading:!1,error:null},St=De("exhibitors/fetchAll",async(t,{rejectWithValue:s})=>{var n,i;try{return(await st.getExhibitors()).data}catch(r){return s(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch exhibitors")}}),_h=ct({name:"exhibitor",initialState:qh,reducers:{},extraReducers:t=>{t.addCase(St.pending,s=>{s.loading=!0,s.error=null}).addCase(St.fulfilled,(s,n)=>{s.exhibitors=n.payload,s.loading=!1}).addCase(St.rejected,(s,n)=>{s.loading=!1,s.error=n.payload})}}),Oh=_h.reducer,{Title:Vh,Text:jt}=pe,Hh=()=>{var A;const[t]=F.useForm(),[s]=F.useForm(),[n,i]=u.useState(!1),[r,l]=u.useState([]),[a,f]=u.useState(!1),[y,h]=u.useState([]),[S,$]=u.useState(null),[v,T]=u.useState(),I=ve(),j=$e(),{loading:R}=ge(m=>m.booking),{exhibitions:d=[],loading:p}=ge(m=>m.exhibition),{exhibitors:k=[],loading:o}=ge(m=>m.exhibitor),{isAuthenticated:c}=ge(m=>m.auth);u.useEffect(()=>{if(!c){ee.error("Please login to create a booking"),I("/login");return}j(wt()),j(St())},[j,c,I]);const D=async m=>{try{f(!0),t.setFieldValue("stallIds",[]),t.setFieldValue("discountId",void 0),h([]);const C=await Ie.getExhibition(m);$(C.data);const q=(await Ie.getStalls(m)).data.filter(O=>O.status==="available");l(q)}catch(C){console.error("Failed to fetch exhibition data:",C),ee.error("Failed to fetch exhibition data")}finally{f(!1)}},w=m=>Math.round(m.ratePerSqm*m.dimensions.width*m.dimensions.height*100)/100,P=m=>{const C=r.filter(B=>{const q=B._id||B.id;return q&&m.includes(q)});h(C)},g=(m,C,B)=>{if(!(B!=null&&B.isActive))return 0;let q=0;if(B.type==="percentage")q=m*(Math.max(0,Math.min(100,B.value))/100);else{const O=m/C*B.value;q=Math.min(O,m)}return Math.round(q*100)/100},b=async m=>{var C,B;try{const q=k.find(U=>U._id===m.exhibitorId);if(!q)throw new Error("Selected exhibitor not found");const[O,Y,Z]=m.discountId?m.discountId.split("-"):[],te=(C=S==null?void 0:S.discountConfig)==null?void 0:C.find(U=>`${U.name}-${U.value}-${U.type}`===m.discountId),V=y.map(U=>{const X=U._id||U.id;if(!X)throw new Error(`Invalid stall ID for stall number ${U.number}`);return{stall:U,stallId:X,baseAmount:w(U)}}),Q=V.reduce((U,{baseAmount:X})=>U+X,0),se=V.map(({stall:U,stallId:X,baseAmount:J})=>{const re=te?g(J,Q,te):0;return{stallId:X,number:U.number,baseAmount:J,discount:te?{name:te.name,type:te.type,value:te.value,amount:re}:void 0,amountAfterDiscount:Math.round((J-re)*100)/100}}),he=se.reduce((U,X)=>{var J;return U+(((J=X.discount)==null?void 0:J.amount)||0)},0),we=Math.round((Q-he)*100)/100,ue=((B=S==null?void 0:S.taxConfig)==null?void 0:B.filter(U=>U.isActive).map(U=>({name:U.name,rate:U.rate,amount:Math.round(we*U.rate/100*100)/100})))||[],de=ue.reduce((U,X)=>U+X.amount,0),be=Math.round((we+de)*100)/100,Xe={exhibitionId:m.exhibitionId,exhibitorId:m.exhibitorId,stallIds:se.map(U=>U.stallId),customerName:q.contactPerson,customerEmail:q.email,customerPhone:q.phone,customerAddress:q.address||"N/A",companyName:q.companyName,discount:te?{name:te.name,type:te.type,value:te.value}:void 0,amount:be,calculations:{stalls:se,totalBaseAmount:Q,totalDiscountAmount:he,totalAmountAfterDiscount:we,taxes:ue,totalTaxAmount:de,totalAmount:be}};await j(Nn(Xe)).unwrap(),ee.success("Booking created successfully"),I("/bookings")}catch(q){console.error("Error creating booking:",q),ee.error("Failed to create booking")}},L=async m=>{try{const C=await st.createExhibitor(m);ee.success("Exhibitor added successfully"),j(St()),t.setFieldsValue({exhibitorId:C.data._id}),i(!1),s.resetFields()}catch(C){const B=(C==null?void 0:C.message)||"Failed to add exhibitor";ee.error(B),B==="User with this email already exists"&&s.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},N=d.map(m=>({label:m.name,value:m._id||m.id})),x=k.map(m=>({label:m.companyName,value:m._id}));r.map(m=>({label:`Stall ${m.number} (${m.dimensions.width}m Ã— ${m.dimensions.height}m = ${(m.dimensions.width*m.dimensions.height).toFixed(2)} sqm) - â‚¹${m.ratePerSqm.toLocaleString()}/sq.m`,value:m._id||m.id}));const E=m=>{T(m),t.setFieldValue("discountId",m)},z=()=>{var te,V;const m=y.reduce((Q,se)=>Q+w(se),0),C=(te=S==null?void 0:S.discountConfig)==null?void 0:te.find(Q=>`${Q.name}-${Q.value}-${Q.type}`===v&&Q.isActive),B=C?C.type==="percentage"?Math.round(m*C.value/100*100)/100:Math.min(C.value,m):0,q=Math.round((m-B)*100)/100,O=((V=S==null?void 0:S.taxConfig)==null?void 0:V.filter(Q=>Q.isActive).map(Q=>({name:Q.name,rate:Q.rate,amount:Math.round(q*Q.rate/100*100)/100})))||[],Y=O.reduce((Q,se)=>Q+se.amount,0),Z=Math.round((q+Y)*100)/100;return{baseAmount:m,selectedDiscount:C,discountAmount:B,amountAfterDiscount:q,taxes:O,totalTaxAmount:Y,totalAmount:Z}};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{span:24,children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(Vh,{level:2,style:{margin:0},children:"Create Booking"}),e.jsx(pe.Text,{type:"secondary",children:"Create a new stall booking"})]})}),e.jsx(M,{span:24,children:e.jsx(H,{children:e.jsx(F,{form:t,layout:"vertical",onFinish:b,style:{maxWidth:800},children:e.jsxs(ie,{gutter:16,children:[e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:e.jsx(oe,{placeholder:"Select exhibition",loading:p,options:N,onChange:D})})}),e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"exhibitorId",label:e.jsxs(G,{children:[e.jsx("span",{children:"Exhibitor"}),e.jsx(_,{type:"link",icon:e.jsx(et,{}),onClick:()=>i(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:e.jsx(oe,{showSearch:!0,placeholder:"Select exhibitor",loading:o,options:x,filterOption:(m,C)=>{var B;return(((B=C==null?void 0:C.label)==null?void 0:B.toString())??"").toLowerCase().includes(m.toLowerCase())}})})}),e.jsx(M,{span:24,children:e.jsx(F.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:e.jsx(oe,{mode:"multiple",placeholder:a?"Loading stalls...":"Select stalls",loading:a,onChange:P,options:r.map(m=>({label:`Stall ${m.number} (${m.dimensions.width}m Ã— ${m.dimensions.height}m = ${(m.dimensions.width*m.dimensions.height).toFixed(2)} sqm) - â‚¹${m.ratePerSqm.toLocaleString()}/sq.m`,value:m._id||m.id}))})})}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(M,{span:24,children:e.jsx(H,{title:"Selected Stalls Summary",size:"small",children:e.jsx(Re,{dataSource:y.map(m=>({...m,key:m._id||m.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(m,C)=>{var B,q;return((B=C.stallType)==null?void 0:B.name)||(typeof C.stallTypeId=="object"?(q=C.stallTypeId)==null?void 0:q.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(m,C)=>`${C.dimensions.width}m Ã— ${C.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(m,C)=>(C.dimensions.width*C.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:m=>`â‚¹${m.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(m,C)=>`â‚¹${w(C).toLocaleString()}`}],summary:()=>{const m=y.reduce((C,B)=>C+w(B),0);return e.jsxs(Re.Summary.Row,{children:[e.jsx(Re.Summary.Cell,{index:0,colSpan:5,children:e.jsx("strong",{children:"Total Base Amount"})}),e.jsx(Re.Summary.Cell,{index:1,children:e.jsxs("strong",{children:["â‚¹",m.toLocaleString()]})})]},"summary")}})})}),e.jsx(M,{span:24,children:e.jsxs(H,{title:"Price Calculations",size:"small",children:[e.jsx(ie,{gutter:[16,16],children:e.jsx(M,{span:12,children:e.jsx(F.Item,{name:"discountId",label:"Available Discounts",children:e.jsx(oe,{placeholder:"Select discount",allowClear:!0,onChange:E,options:(A=S==null?void 0:S.discountConfig)==null?void 0:A.map(m=>({label:`${m.name} (${m.type==="percentage"?m.value+"%":"â‚¹"+m.value})${m.isActive?"":" - Inactive"}`,value:`${m.name}-${m.value}-${m.type}`,disabled:!m.isActive}))})})})}),e.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:e.jsx(G,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:m,selectedDiscount:C,discountAmount:B,amountAfterDiscount:q,taxes:O,totalAmount:Y}=z();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(jt,{children:"Total Base Amount:"}),e.jsxs(jt,{children:["â‚¹",m.toLocaleString()]})]}),C&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(jt,{children:["Discount (",C.type==="percentage"?`${C.value}%`:`â‚¹${C.value.toLocaleString()}`,"):"]}),e.jsxs(jt,{type:"danger",children:["-â‚¹",B.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(jt,{children:"Amount after Discount:"}),e.jsxs(jt,{children:["â‚¹",q.toLocaleString()]})]}),e.jsx(Le,{style:{margin:"8px 0"}}),O.map(Z=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(jt,{children:[Z.name," (",Z.rate,"%):"]}),e.jsxs(jt,{children:["â‚¹",Z.amount.toLocaleString()]})]},`tax-${Z.name}`)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(jt,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(jt,{strong:!0,children:["â‚¹",Y.toLocaleString()]})]})]})})()})})]})})]}),e.jsx(M,{span:24,children:e.jsx(F.Item,{children:e.jsxs(G,{children:[e.jsx(_,{type:"primary",htmlType:"submit",loading:R,children:"Create Booking"}),e.jsx(_,{onClick:()=>I("/bookings"),children:"Cancel"})]})})})]})})})})]}),e.jsx(me,{title:e.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:n,onCancel:()=>{i(!1),s.resetFields()},width:800,footer:e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[e.jsx(_,{onClick:()=>{i(!1),s.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),e.jsx(_,{type:"primary",onClick:s.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:e.jsx(F,{form:s,layout:"vertical",onFinish:L,requiredMark:!1,children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),e.jsx(F.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(W.TextArea,{rows:3})}),e.jsx(F.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"status",label:"Status",initialValue:"active",children:e.jsxs(oe,{children:[e.jsx(oe.Option,{value:"active",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),e.jsx(oe.Option,{value:"inactive",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),e.jsx(F.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(W,{placeholder:"ABCDE1234F"})}),e.jsx(F.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(W,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})};da.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${ca}/pdf.worker.min.js`;const Wh=()=>{const{id:t}=ot(),s=ve(),{data:n,isLoading:i}=$h(t||""),[r,l]=u.useState(!1),[a,f]=u.useState(!1),[y,h]=u.useState(!1),[S,$]=u.useState(null),[v,T]=u.useState(null),[I]=F.useForm(),j=async()=>{try{const o=await xr(`/invoices/${t}/download?force=true`),c=window.URL.createObjectURL(new Blob([o.data]));$(c),h(!0)}catch(o){console.error("Preview error:",o),ee.error("Failed to preview invoice")}},R=async()=>{try{const o=await xr(`/invoices/${t}/download?force=true`),c=window.URL.createObjectURL(new Blob([o.data])),D=document.createElement("a");D.href=c,D.setAttribute("download",`invoice-${t}.pdf`),document.body.appendChild(D),D.click(),D.remove(),window.URL.revokeObjectURL(c)}catch(o){console.error("Download error:",o),ee.error("Failed to download invoice")}},d=async o=>{try{await ne.post(`/invoices/${t}/share/email`,o),ee.success("Invoice shared via email successfully"),l(!1),I.resetFields()}catch(c){console.error("Email sharing error:",c),ee.error("Failed to share invoice via email")}},p=async o=>{try{await ne.post(`/invoices/${t}/share/whatsapp`,o),ee.success("Invoice shared via WhatsApp successfully"),f(!1),I.resetFields()}catch(c){console.error("WhatsApp sharing error:",c),ee.error("Failed to share invoice via WhatsApp")}},k=({numPages:o})=>{T(o)};return i||!n?e.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",n),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(H,{title:"Invoice Details",extra:e.jsxs(G,{children:[e.jsx(_,{icon:e.jsx(Ut,{}),onClick:()=>s(-1),children:"Back"}),e.jsx(_,{icon:e.jsx(Lt,{}),onClick:j,children:"Preview"}),e.jsx(_,{type:"primary",icon:e.jsx(Bi,{}),onClick:R,children:"Download"}),e.jsx(_,{icon:e.jsx(Mt,{}),onClick:()=>l(!0),children:"Share via Email"}),e.jsx(_,{icon:e.jsx(ma,{}),onClick:()=>f(!0),children:"Share via WhatsApp"})]}),children:e.jsx(Wa,{booking:{...n.bookingId,customerGSTIN:n.bookingId.customerGSTIN||"",invoiceNumber:n.invoiceNumber,exhibitionId:{...n.bookingId.exhibitionId,companyName:n.bookingId.exhibitionId.companyName||"Company Name",bankName:n.bookingId.exhibitionId.bankName||"",bankAccount:n.bookingId.exhibitionId.bankAccount||"",bankAccountName:n.bookingId.exhibitionId.bankAccountName||"",bankBranch:n.bookingId.exhibitionId.bankBranch||"",bankIFSC:n.bookingId.exhibitionId.bankIFSC||"",companyCIN:n.bookingId.exhibitionId.companyCIN||"",companyPAN:n.bookingId.exhibitionId.companyPAN||"",companySAC:n.bookingId.exhibitionId.companySAC||"",companyGST:n.bookingId.exhibitionId.companyGST||"",companyEmail:n.bookingId.exhibitionId.companyEmail||"",companyWebsite:n.bookingId.exhibitionId.companyWebsite||"",companyAddress:n.bookingId.exhibitionId.companyAddress||""},calculations:{...n.bookingId.calculations,stalls:n.bookingId.calculations.stalls.map(o=>({discount:o.discount?{value:o.discount.value}:void 0}))}}})}),e.jsx(me,{title:"Preview Invoice",open:y,onCancel:()=>{h(!1),S&&(window.URL.revokeObjectURL(S),$(null))},width:1e3,footer:null,children:S&&e.jsx("div",{style:{height:"80vh",overflow:"auto"},children:e.jsx(ua,{file:S,onLoadSuccess:k,loading:e.jsx("div",{children:"Loading PDF..."}),children:Array.from(new Array(v||0),(o,c)=>e.jsx(ha,{pageNumber:c+1,width:900,renderTextLayer:!1,renderAnnotationLayer:!1},`page_${c+1}`))})})}),e.jsx(me,{title:"Share Invoice via Email",open:r,onCancel:()=>l(!1),footer:null,children:e.jsxs(F,{form:I,onFinish:d,layout:"vertical",children:[e.jsx(F.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(W,{placeholder:"Enter email address"})}),e.jsx(F.Item,{name:"message",label:"Message (Optional)",children:e.jsx(W.TextArea,{placeholder:"Enter optional message"})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(me,{title:"Share Invoice via WhatsApp",open:a,onCancel:()=>f(!1),footer:null,children:e.jsxs(F,{form:I,onFinish:p,layout:"vertical",children:[e.jsx(F.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:e.jsx(W,{placeholder:"Enter phone number with country code"})}),e.jsx(F.Item,{children:e.jsx(_,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:Oe,Paragraph:_e,Text:gn}=pe,{Content:Yh}=Pe,Qh=t=>{if(!t)return"/exhibition-placeholder.jpg";if(t.startsWith("/")||t.startsWith("http"))return t;const s=t.startsWith("/")?t.substring(1):t;return s.includes("logos/")||s.includes("sponsors/")?`${ne.defaults.baseURL}/public/images/${s}`:"/exhibition-placeholder.jpg"},Gh=K(Yh)`
  padding-top: 64px;
`,Kh=K.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,Xh=K.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Zh=K.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,hs=K(H)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Jh=K(H)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,As=K(Oe)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,xs=K.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,fn=K.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,oa=K.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,ex=K(le)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,ki=K(_)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,Ts=K.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;K.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const tx=()=>{const t=ve(),s=$e(),[n,i]=u.useState([]),[r,l]=u.useState(!0);u.useEffect(()=>{(async()=>{try{l(!0);const S=await dt.getExhibitions();i(S.data.slice(0,4))}catch(S){console.error("Failed to fetch exhibitions:",S)}finally{l(!1)}})()},[]);const a=h=>{const S={year:"numeric",month:"short",day:"numeric"};return new Date(h).toLocaleDateString(void 0,S)},f=(h,S)=>{const $=new Date,v=new Date(h),T=new Date(S);return $<v?{status:"Upcoming",color:"#722ED1"}:$>T?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},y=()=>{s(Mn(void 0))};return e.jsxs(Pe,{children:[e.jsx(pt,{}),e.jsxs(Gh,{children:[e.jsxs(Kh,{children:[e.jsx(Xh,{}),e.jsx(Zh,{children:e.jsxs(ie,{gutter:[48,48],align:"middle",children:[e.jsxs(M,{xs:24,lg:14,children:[e.jsx(Oe,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),e.jsx(_e,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),e.jsxs(G,{size:16,wrap:!0,children:[e.jsx(ki,{type:"primary",size:"large",onClick:()=>t("/exhibitions"),icon:e.jsx(Ci,{}),children:"Explore Exhibitions"}),e.jsx(ki,{className:"secondary-btn",size:"large",onClick:()=>t("/exhibitor/login"),icon:e.jsx(ke,{}),children:"Exhibitor Portal"})]})]}),e.jsx(M,{xs:24,lg:10,children:e.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:h=>{const S=h.target;S.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",S.onerror=()=>{S.style.height="300px",S.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",S.onerror=null;const $=S.parentElement;if($){const v=document.createElement("div");v.style.position="absolute",v.style.top="50%",v.style.left="50%",v.style.transform="translate(-50%, -50%)",v.style.color="white",v.style.fontSize="18px",v.style.fontWeight="bold",v.style.textAlign="center",v.textContent="Exhibition Venue",$.appendChild(v)}}}})})]})})]}),e.jsx(Ts,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(As,{level:2,children:"Featured Exhibitions"}),r?e.jsx(ie,{gutter:[24,24],children:[1,2,3,4].map(h=>e.jsx(M,{xs:24,sm:12,lg:6,children:e.jsx(H,{style:{borderRadius:"12px"},children:e.jsx(ga,{active:!0,avatar:!0,paragraph:{rows:3}})})},h))}):n.length>0?e.jsx(ie,{gutter:[24,24],children:n.map((h,S)=>{const{status:$,color:v}=f(h.startDate,h.endDate);return e.jsx(M,{xs:24,sm:12,lg:6,children:e.jsxs(Jh,{onClick:()=>t(Kn(h)),cover:e.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[e.jsx("img",{alt:h.name,src:h.headerLogo?Qh(h.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"cover",filter:"brightness(0.95)"}}),e.jsx(le,{color:v,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:$}),S===0&&e.jsx(ex,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[e.jsx(Oe,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:h.name}),e.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[e.jsx(kt,{style:{color:"#4158D0"}}),e.jsxs(gn,{type:"secondary",style:{fontSize:13},children:[a(h.startDate)," - ",a(h.endDate)]})]}),h.venue&&e.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[e.jsx(Jt,{style:{color:"#C850C0"}}),e.jsx(gn,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:h.venue})]}),e.jsx(_,{type:"link",style:{padding:0,height:"auto"},icon:e.jsx(Ci,{}),children:"View Details"})]})},h._id)})}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(_e,{children:"No exhibitions available at the moment. Check back soon!"})}),e.jsx("div",{style:{textAlign:"center",marginTop:40},children:e.jsx(_,{type:"primary",size:"large",onClick:()=>t("/exhibitions"),icon:e.jsx(Fo,{}),children:"View All Exhibitions"})})]})}),e.jsx(Ts,{className:"how-it-works",children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(As,{level:2,children:"How to Book Stall"}),e.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:e.jsx(_e,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),e.jsxs("div",{className:"booking-steps",children:[e.jsx("div",{className:"step-indicator",children:e.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(h=>e.jsxs("div",{className:"step-dot-container",children:[e.jsx("div",{className:"step-dot",children:h}),e.jsx("div",{className:"step-label",children:`Step ${h}`})]},h)),e.jsx("div",{className:"step-progress-line"})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:40},children:[e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"1"}),e.jsx("div",{className:"step-icon",children:e.jsx(ke,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Register"}),e.jsx(_e,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"2"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ee,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Admin Approval"}),e.jsx(_e,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsx("div",{className:"step-icon",children:e.jsx(rt,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Login & Book Stall"}),e.jsx(_e,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"4"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ye,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Stall Goes to Reserved"}),e.jsx(_e,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"5"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ee,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Admin Final Approval"}),e.jsx(_e,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"6"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ee,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Stall Becomes Booked"}),e.jsx(_e,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),e.jsx(M,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"7"}),e.jsx("div",{className:"step-icon",children:e.jsx(ir,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Oe,{level:5,children:"Make Payment in 3 Days"}),e.jsx(_e,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),e.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),e.jsx("div",{style:{textAlign:"center",marginTop:60},children:e.jsx(ki,{type:"primary",size:"large",onClick:y,icon:e.jsx(ke,{}),children:"Register as Exhibitor"})})]})}),e.jsx(Ts,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(As,{level:2,children:"Why Choose Us"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:e.jsx(ts,{})}),e.jsx(Oe,{level:4,children:"Interactive Layouts"}),e.jsx(_e,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:e.jsx(rt,{})}),e.jsx(Oe,{level:4,children:"Real-time Availability"}),e.jsx(_e,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:e.jsx(ir,{})}),e.jsx(Oe,{level:4,children:"Secure Payments"}),e.jsx(_e,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:e.jsx(On,{})}),e.jsx(Oe,{level:4,children:"Exhibitor Dashboard"}),e.jsx(_e,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:e.jsx(kt,{})}),e.jsx(Oe,{level:4,children:"Schedule Management"}),e.jsx(_e,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),e.jsx(M,{xs:24,sm:12,lg:8,children:e.jsxs(hs,{children:[e.jsx(xs,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:e.jsx(Ee,{})}),e.jsx(Oe,{level:4,children:"Support & Assistance"}),e.jsx(_e,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),e.jsx(Ts,{className:"gray-bg",children:e.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:e.jsxs(ie,{gutter:[48,48],children:[e.jsxs(M,{xs:24,lg:12,children:[e.jsx(As,{level:2,children:"Our Impact"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(M,{xs:12,children:e.jsx(fn,{children:e.jsx(ye,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),e.jsx(M,{xs:12,children:e.jsx(fn,{children:e.jsx(ye,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),e.jsx(M,{xs:12,children:e.jsx(fn,{children:e.jsx(ye,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),e.jsx(M,{xs:12,children:e.jsx(fn,{children:e.jsx(ye,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),e.jsxs(M,{xs:24,lg:12,children:[e.jsx(As,{level:2,children:"What Exhibitors Say"}),e.jsxs(Bo,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[e.jsx("div",{children:e.jsxs(oa,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(gt,{size:64,icon:e.jsx(ke,{}),style:{backgroundColor:"#4158D0"}}),e.jsxs("div",{children:[e.jsx(Oe,{level:5,style:{margin:0},children:"Sarah Johnson"}),e.jsx(gn,{type:"secondary",children:"Tech Innovations Inc."})]})]}),e.jsx(_e,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),e.jsx("div",{children:e.jsxs(oa,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(gt,{size:64,icon:e.jsx(ke,{}),style:{backgroundColor:"#C850C0"}}),e.jsxs("div",{children:[e.jsx(Oe,{level:5,style:{margin:0},children:"Michael Chen"}),e.jsx(gn,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),e.jsx(_e,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),e.jsx(Ts,{style:{padding:"60px 0"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Oe,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),e.jsx(_e,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),e.jsxs(G,{size:16,wrap:!0,style:{justifyContent:"center"},children:[e.jsx(_,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>t("/exhibitions"),icon:e.jsx(rt,{}),children:"Browse Exhibitions"}),e.jsx(_,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:y,icon:e.jsx(ke,{}),children:"Register as Exhibitor"})]})]})})]}),e.jsx(Xa,{})]})},{Title:sx,Text:fe,Paragraph:nx}=pe,{Option:yn}=oe,{TextArea:la,Search:ix}=W,{RangePicker:rx}=Ys,ax=()=>{const t=$e(),{exhibitors:s,loading:n}=ge(V=>V.exhibitor),[i,r]=u.useState(null),[l,a]=u.useState(!1),[f,y]=u.useState(!1),[h,S]=u.useState(!1),[$,v]=u.useState("approved"),[T,I]=u.useState(""),[j,R]=u.useState(!1),[d,p]=u.useState(!1),[k,o]=u.useState(!1),[c,D]=u.useState(""),[w,P]=u.useState([]),[g]=F.useForm(),[b,L]=u.useState([]);b.length>0;const[N,x]=u.useState({total:0,pending:0,approved:0,rejected:0});u.useEffect(()=>{t(St())},[t]),u.useEffect(()=>{if(s!=null&&s.length){P(s);const V={total:s.length,pending:s.filter(Q=>Q.status==="pending").length,approved:s.filter(Q=>Q.status==="approved").length,rejected:s.filter(Q=>Q.status==="rejected").length};x(V)}},[s]),u.useEffect(()=>{i&&f&&g.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,f,g]);const E=V=>{switch(V){case"approved":return e.jsx(le,{color:"success",children:"Approved"});case"pending":return e.jsx(le,{color:"warning",children:"Pending"});case"rejected":return e.jsx(le,{color:"error",children:"Rejected"});default:return e.jsx(le,{children:"Unknown"})}},z=async()=>{var V,Q;if(i)try{R(!0),await st.updateStatus(i._id,$,$==="rejected"?T:void 0),ee.success(`Exhibitor status updated to ${$}`),a(!1),t(St())}catch(se){ee.error(((Q=(V=se.response)==null?void 0:V.data)==null?void 0:Q.message)||"Failed to update exhibitor status")}finally{R(!1)}},A=async V=>{var Q,se;if(i)try{p(!0),await st.updateExhibitor(i._id,V),ee.success("Exhibitor details updated successfully"),y(!1),t(St())}catch(he){ee.error(((se=(Q=he.response)==null?void 0:Q.data)==null?void 0:se.message)||"Failed to update exhibitor details")}finally{p(!1)}},m=async V=>{var Q,se;try{o(!0),await st.deleteExhibitor(V),ee.success("Exhibitor deleted successfully"),t(St())}catch(he){ee.error(((se=(Q=he.response)==null?void 0:Q.data)==null?void 0:se.message)||"Failed to delete exhibitor")}finally{o(!1)}},C=V=>{if(D(V),!V){P(s);return}const Q=V.toLowerCase(),se=s.filter(he=>he.companyName.toLowerCase().includes(Q)||he.contactPerson.toLowerCase().includes(Q)||he.email.toLowerCase().includes(Q)||he.phone.toLowerCase().includes(Q));P(se)},B=V=>{if(V==="all"){P(s);return}const Q=s.filter(se=>se.status===V);P(Q)},q=V=>{if(!V||V.length!==2){P(s);return}const Q=V[0].startOf("day").toISOString(),se=V[1].endOf("day").toISOString(),he=s.filter(we=>{const ue=new Date(we.createdAt).toISOString();return ue>=Q&&ue<=se});P(he)},O=()=>{const V=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],Q=w.map(de=>[de.companyName,de.contactPerson,de.email,de.phone,de.status,de.isActive?"Yes":"No",new Date(de.createdAt).toLocaleDateString(),de.address||"",de.website||""]);Q.unshift(V);const se=Q.map(de=>de.map(be=>typeof be=="string"&&(be.includes(",")||be.includes('"')||be.includes(`
`))?`"${be.replace(/"/g,'""')}"`:be).join(",")).join(`
`),he=new Blob([se],{type:"text/csv;charset=utf-8;"}),we=URL.createObjectURL(he),ue=document.createElement("a");ue.setAttribute("href",we),ue.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),ue.style.visibility="hidden",document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),ee.success("Exhibitor data exported successfully")},Y=()=>{me.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${b.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{o(!0);const V=b.map(Q=>st.deleteExhibitor(Q.toString()));await Promise.all(V),ee.success(`${b.length} exhibitors deleted successfully`),L([]),t(St())}catch{ee.error("Failed to delete some exhibitors")}finally{o(!1)}}})},Z={selectedRowKeys:b,onChange:V=>{L(V)}},te=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(V,Q)=>V.companyName.localeCompare(Q.companyName),filterDropdown:({setSelectedKeys:V,selectedKeys:Q,confirm:se,clearFilters:he})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(W,{placeholder:"Search company or contact",value:Q[0],onChange:we=>V(we.target.value?[we.target.value]:[]),onPressEnter:()=>se(),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(G,{children:[e.jsx(_,{type:"primary",onClick:()=>se(),icon:e.jsx(mt,{}),size:"small",style:{width:90},children:"Filter"}),e.jsx(_,{onClick:()=>{he&&he(),se()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:V=>e.jsx(mt,{style:{color:V?"#1890ff":void 0}}),onFilter:(V,Q)=>{const se=String(V).toLowerCase();return Q.companyName.toLowerCase().includes(se)||Q.contactPerson.toLowerCase().includes(se)},render:(V,Q)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:V}),e.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",Q.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(V,Q)=>e.jsxs("div",{children:[e.jsx("div",{children:V}),e.jsx("div",{style:{fontSize:"12px"},children:Q.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(V,Q)=>Q.status===V,render:V=>E(V)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(V,Q)=>Q.isActive===V,render:V=>e.jsx(le,{color:V?"green":"red",children:V?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(V,Q)=>new Date(V.createdAt).getTime()-new Date(Q.createdAt).getTime(),render:V=>e.jsx(We,{title:new Date(V).toLocaleString(),children:new Date(V).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:V=>V?e.jsx("a",{href:V,target:"_blank",rel:"noopener noreferrer",children:V.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(V,Q)=>e.jsxs(G,{children:[e.jsx(We,{title:"View Details",children:e.jsx(_,{icon:e.jsx(Lt,{}),onClick:()=>{r(Q),S(!0)}})}),e.jsx(_,{type:"primary",onClick:()=>{r(Q),v(Q.status),I(Q.rejectionReason||""),a(!0)},children:"Update Status"}),e.jsx(zt,{overlay:e.jsxs(nt,{children:[e.jsx(nt.Item,{icon:e.jsx(bs,{}),onClick:()=>{r(Q),y(!0)},children:"Edit"},"edit"),e.jsx(nt.Item,{icon:e.jsx(ut,{}),danger:!0,onClick:se=>{se.domEvent.stopPropagation(),me.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>m(Q._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(_,{icon:e.jsx(Vn,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(M,{flex:"auto",children:e.jsxs(G,{direction:"vertical",size:4,children:[e.jsx(sx,{level:4,style:{margin:0},children:"Exhibitors"}),e.jsx(fe,{type:"secondary",children:"Manage exhibitors and their information"})]})}),e.jsx(M,{children:e.jsx(_,{type:"primary",icon:e.jsx(ys,{}),onClick:()=>y(!0),size:"large",children:"Add Exhibitor"})})]})}),e.jsxs(ie,{gutter:[16,24],style:{marginBottom:"24px"},children:[e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Total Exhibitors",value:N.total,prefix:e.jsx(ke,{})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Pending",value:N.pending,prefix:e.jsx(Ye,{style:{color:"#faad14"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Approved",value:N.approved,prefix:e.jsx(Ee,{style:{color:"#52c41a"}})})})}),e.jsx(M,{xs:24,sm:12,md:6,children:e.jsx(H,{children:e.jsx(ye,{title:"Rejected",value:N.rejected,prefix:e.jsx(Xt,{style:{color:"#ff4d4f"}})})})})]}),e.jsx(H,{className:"info-card",style:{marginBottom:"24px"},children:e.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(M,{xs:24,sm:8,md:6,lg:4,children:e.jsx(ix,{placeholder:"Search exhibitors",allowClear:!0,onSearch:C,style:{width:"100%"}})}),e.jsx(M,{xs:24,sm:8,md:6,lg:4,children:e.jsxs(oe,{placeholder:"Filter by status",style:{width:"100%"},onChange:B,allowClear:!0,children:[e.jsx(yn,{value:"all",children:"All Status"}),e.jsx(yn,{value:"pending",children:"Pending"}),e.jsx(yn,{value:"approved",children:"Approved"}),e.jsx(yn,{value:"rejected",children:"Rejected"})]})}),e.jsx(M,{xs:24,sm:8,md:6,lg:6,children:e.jsx(rx,{style:{width:"100%"},onChange:q})})]}),b.length>0&&e.jsx(ie,{children:e.jsxs(G,{children:[e.jsxs(fe,{children:["Selected ",b.length," items"]}),e.jsx(_,{danger:!0,onClick:Y,children:"Delete Selected"}),e.jsx(_,{type:"primary",onClick:O,children:"Export Selected"})]})})]})}),e.jsx(H,{className:"info-card",children:e.jsx(Re,{rowSelection:Z,dataSource:w,columns:te,rowKey:"_id",loading:n,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(V,Q)=>`${Q[0]}-${Q[1]} of ${V} items`},scroll:{x:1500}})}),e.jsx(me,{title:"Exhibitor Details",open:h,onCancel:()=>S(!1),footer:[e.jsx(_,{onClick:()=>S(!1),children:"Close"},"close")],width:600,children:i&&e.jsx("div",{children:e.jsxs(ie,{gutter:[16,16],children:[e.jsx(M,{span:24,children:e.jsx(H,{title:"Company Information",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Company Name:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.companyName})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Contact Person:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.contactPerson})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Email:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.email})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Phone:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.phone})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Address:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.address||"Not provided"})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Status:"})}),e.jsx(M,{span:12,children:E(i.status)}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Active:"})}),e.jsx(M,{span:12,children:e.jsx(Ke,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Registration Date:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:new Date(i.createdAt).toLocaleString()})})]})})}),e.jsx(M,{span:24,children:e.jsxs(H,{title:"Additional Information",children:[e.jsxs(ie,{gutter:[16,8],children:[e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Address:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{children:i.address||"Not provided"})}),e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Website:"})}),e.jsx(M,{span:12,children:i.website?e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx(M,{span:12,children:e.jsx(fe,{strong:!0,children:"Rejection Reason:"})}),e.jsx(M,{span:12,children:e.jsx(fe,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&e.jsxs(e.Fragment,{children:[e.jsx(Le,{}),e.jsx(fe,{strong:!0,children:"Description:"}),e.jsx(nx,{style:{marginTop:8},children:i.description})]})]})})]})})}),e.jsx(me,{title:"Update Exhibitor Status",open:l,onCancel:()=>a(!1),footer:null,width:600,children:i&&e.jsxs("div",{children:[e.jsx(H,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ke,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(M,{span:8,children:e.jsx(fe,{strong:!0,children:"Company:"})}),e.jsx(M,{span:16,children:e.jsx(fe,{children:i.companyName})}),e.jsx(M,{span:8,children:e.jsx(fe,{strong:!0,children:"Contact Person:"})}),e.jsx(M,{span:16,children:e.jsx(fe,{children:i.contactPerson})}),e.jsx(M,{span:8,children:e.jsx(fe,{strong:!0,children:"Email:"})}),e.jsx(M,{span:16,children:e.jsx(fe,{children:i.email})}),e.jsx(M,{span:8,children:e.jsx(fe,{strong:!0,children:"Address:"})}),e.jsx(M,{span:16,children:e.jsx(fe,{children:i.address||"Not provided"})}),e.jsx(M,{span:8,children:e.jsx(fe,{strong:!0,children:"Current Status:"})}),e.jsx(M,{span:16,children:E(i.status)})]})}),e.jsxs(H,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Zt,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(fe,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(vt.Group,{value:$,onChange:V=>v(V.target.value),buttonStyle:"solid",children:[e.jsx(vt.Button,{value:"pending",children:e.jsxs(G,{children:[e.jsx(Ye,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(vt.Button,{value:"approved",children:e.jsxs(G,{children:[e.jsx(Ee,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(vt.Button,{value:"rejected",children:e.jsxs(G,{children:[e.jsx(Xt,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),$==="rejected"&&e.jsx("div",{children:e.jsx(F.Item,{label:e.jsx(fe,{strong:!0,children:"Rejection Reason:"}),required:$==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:e.jsx(la,{rows:4,value:T,onChange:V=>I(V.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),$==="approved"&&e.jsx(Qe,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),$==="pending"&&e.jsx(Qe,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(_,{onClick:()=>a(!1),children:"Cancel"}),e.jsx(_,{type:"primary",onClick:z,loading:j,disabled:$==="rejected"&&!T.trim(),children:"Update Status"})]})]})]})}),e.jsx(me,{title:"Edit Exhibitor Details",open:f,onCancel:()=>y(!1),footer:null,width:600,children:e.jsxs(F,{form:g,layout:"vertical",onFinish:A,children:[e.jsx(F.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(W,{})}),e.jsx(F.Item,{name:"address",label:"Address",children:e.jsx(W,{})}),e.jsx(F.Item,{name:"website",label:"Website",children:e.jsx(W,{})}),e.jsx(F.Item,{name:"description",label:"Description",children:e.jsx(la,{rows:4})}),e.jsx(F.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(it,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(F.Item,{children:e.jsxs(G,{children:[e.jsx(_,{type:"primary",htmlType:"submit",loading:d,children:"Save Changes"}),e.jsx(_,{onClick:()=>y(!1),children:"Cancel"})]})})]})})]})},ze=({children:t})=>ge(n=>n.auth.isAuthenticated)?t:e.jsx(Hn,{to:"/login"}),ps=({children:t})=>ge(n=>n.exhibitorAuth.isAuthenticated)?t:e.jsx(Hn,{to:"/"});function ox(){return e.jsx(ft,{children:e.jsx(Ks,{children:e.jsx(Qo,{children:e.jsxs(Go,{children:[e.jsx(je,{path:"/",element:e.jsx(tx,{})}),e.jsx(je,{path:"/login",element:e.jsx(jc,{})}),e.jsx(je,{path:"/exhibitions",element:e.jsx(fh,{})}),e.jsx(je,{path:"/exhibitions/:id",element:e.jsx(sh,{})}),e.jsx(je,{path:"/exhibitions/:id/layout",element:e.jsx(Ju,{})}),e.jsx(je,{path:"/exhibitor/dashboard",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx(Ic,{})})})}),e.jsx(je,{path:"/exhibitor/profile",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx(Rc,{})})})}),e.jsx(je,{path:"/exhibitor/bookings",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx(Ac,{})})})}),e.jsx(je,{path:"/exhibitor/bookings/:id",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx(Tc,{})})})}),e.jsx(je,{path:"/exhibitor/support",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx("div",{children:"Help & Support"})})})}),e.jsx(je,{path:"/exhibitor/invoice/:id",element:e.jsx(ps,{children:e.jsx(ns,{children:e.jsx(Cd,{})})})}),e.jsx(je,{path:"/dashboard",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Sc,{})})})}),e.jsx(je,{path:"/exhibition",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(tu,{})})})}),e.jsx(je,{path:"/exhibition/create",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(ou,{})})})}),e.jsx(je,{path:"/exhibition/:id",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(lu,{})})})}),e.jsx(je,{path:"/exhibition/:id/space",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Su,{})})})}),e.jsx(je,{path:"/exhibition/:id/layout",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Iu,{})})})}),e.jsx(je,{path:"/exhibition/:id/halls",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Nu,{})})})}),e.jsx(je,{path:"/exhibition/:id/stalls",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(bh,{})})})}),e.jsx(je,{path:"/exhibition/:id/fixtures",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(wh,{})})})}),e.jsx(je,{path:"/exhibition/:id/edit",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(cu,{})})})}),e.jsx(je,{path:"/stall/list",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Ih,{})})})}),e.jsx(je,{path:"/stall-types",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Th,{})})})}),e.jsx(je,{path:"/bookings",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Uh,{})})})}),e.jsx(je,{path:"/bookings/create",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Hh,{})})})}),e.jsx(je,{path:"/invoice/:id",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Wh,{})})})}),e.jsx(je,{path:"/index",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Wd,{})})})}),e.jsx(je,{path:"/settings",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Ad,{})})})}),e.jsx(je,{path:"/roles",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Dd,{})})})}),e.jsx(je,{path:"/notifications",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(Kd,{})})})}),e.jsx(je,{path:"/exhibitors",element:e.jsx(ze,{children:e.jsx(Me,{children:e.jsx(ax,{})})})}),e.jsx(je,{path:"*",element:e.jsx(Hn,{to:"/",replace:!0})})]})})})})}const Ii=Ki({reducerPath:"bookingApi",baseQuery:Wi({baseUrl:"/api"}),endpoints:t=>({getBookings:t.query({query:()=>"/bookings"}),getBooking:t.query({query:s=>`/bookings/${s}`}),createBooking:t.mutation({query:s=>({url:"/bookings",method:"POST",body:s})}),updateBookingStatus:t.mutation({query:({id:s,status:n})=>({url:`/bookings/${s}/status`,method:"PATCH",body:{status:n}})})})}),lx=Ko({reducer:{auth:ul,exhibitorAuth:Ll,exhibition:Zd,booking:Dh,exhibitor:Oh,settings:Il,[Ii.reducerPath]:Ii.reducer,[Tn.reducerPath]:Tn.reducer,[vn.reducerPath]:vn.reducer},middleware:t=>t().concat(Ii.middleware).concat(Tn.middleware).concat(vn.middleware)}),cx={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};Ni.createRoot(document.getElementById("root")).render(e.jsx(Ae.StrictMode,{children:e.jsx(Xo,{store:lx,children:e.jsx(Mo,{theme:cx,children:e.jsx(ft,{children:e.jsx(ox,{})})})})}));
