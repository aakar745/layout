import{j as e,l as je,o as ue,q as Ie,t as Ee,v as Z,w as Q,x as Re}from"./index-BP1I9PmK.js";import{j as ce,r as b,i as T}from"./vendor-react-BNeW3y6d.js";import{X as ne,A as X,f as y,T as ae,b as $,D as ze,ai as _,S as r,af as de,J as h,a6 as w,a7 as V,a8 as A,I as k,z as pe,O as ee,U as oe,P as fe,b1 as $e,a2 as q,b2 as B,F as se,a as M,G as ge,a5 as ye,b3 as ke,x as te,c as z,a$ as be,i as ve,aH as le,N as Ue,b4 as xe,b5 as _e,n as we,ak as Le,B as he,h as Te,aN as Ne,R as Pe,ao as Fe}from"./vendor-antd-DhcJxEc5.js";import{u as Me}from"./reduxHooks-D3iepLCM.js";import"./vendor-utils-j652IAQy.js";import"./vendor-styling-BBrlYwaV.js";import"./vendor-canvas-BRbMLhVA.js";const{Text:me}=ae,Be=({visible:p,user:t,onClose:m})=>{if(!t)return null;const x=l=>typeof l=="string"?l:l&&typeof l=="object"&&l.name?l.name:"Unknown",j=l=>x(l.role).toLowerCase().includes("admin");return e.jsxs(ne,{title:"User Details",open:p,onCancel:m,footer:null,width:600,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[e.jsx(X,{size:64,icon:e.jsx(y,{}),style:{backgroundColor:"#1677ff"}}),e.jsxs("div",{style:{marginLeft:20},children:[e.jsx(me,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),e.jsxs("div",{children:[e.jsx($,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),e.jsx($,{color:"blue",children:x(t.role)})]})]})]}),e.jsx(ze,{}),e.jsxs(_,{bordered:!0,column:1,children:[e.jsx(_.Item,{label:"Username",children:t.username}),e.jsx(_.Item,{label:"Email",children:t.email}),e.jsx(_.Item,{label:"Role",children:x(t.role)}),e.jsx(_.Item,{label:"Assigned Exhibitions",children:j(t)?e.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:"4px",color:"#52c41a",fontSize:"14px"},children:["âœ… ",e.jsx("strong",{children:"Admin - Access to all exhibitions"})]}):t.assignedExhibitions&&t.assignedExhibitions.length>0?e.jsx(r,{wrap:!0,children:t.assignedExhibitions.map((l,d)=>{const I=typeof l=="string"?`Exhibition ${l.slice(-4)}...`:l!=null&&l.name?`${l.name}`:`Exhibition ${((l==null?void 0:l._id)||l).toString().slice(-4)}...`;return e.jsx($,{color:"blue",children:I},d)})}):e.jsx(me,{type:"secondary",children:"No exhibitions assigned"})}),e.jsx(_.Item,{label:"Status",children:e.jsx($,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),e.jsx(_.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),e.jsx(_.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:K}=q,{Text:G,Title:Ve}=ae,qe=({visible:p,user:t,onClose:m,onSuccess:x})=>{const{message:j}=de.useApp(),[l]=h.useForm(),d=ce(),[I,E]=b.useState(""),{roles:C,loading:O}=T(n=>n.role),{exhibitions:D,loading:N}=T(n=>n.exhibition),{loading:U}=T(n=>n.user),R=n=>{var v;const o=C.find(f=>f._id===n);return((v=o==null?void 0:o.name)==null?void 0:v.toLowerCase().includes("admin"))||!1};b.useEffect(()=>{var n;if(p&&t){const o=((n=t.assignedExhibitions)==null?void 0:n.map(f=>typeof f=="string"?f:f._id))||[],v=typeof t.role=="object"?t.role._id:t.role;E(v),l.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:v,isActive:t.isActive,assignedExhibitions:o})}},[p,t,l,C]),b.useEffect(()=>{p&&(d(je()),d(ue()))},[p,d]);const W=n=>{E(n),R(n)&&l.setFieldsValue({assignedExhibitions:[]})},P=async()=>{if(t)try{const n=await l.validateFields(),o={username:n.username,name:n.name,email:n.email,role:n.role,isActive:n.isActive,assignedExhibitions:R(n.role)?[]:n.assignedExhibitions||[]};n.password&&n.password.trim()!==""&&(o.password=n.password),d(Ie({id:t._id,userData:o})).unwrap().then(()=>{j.success("User updated successfully"),x(),m()}).catch(v=>{j.error(`Failed to update user: ${v}`)})}catch(n){console.error("Validation error:",n)}},i=n=>typeof n=="string"?n:n&&typeof n=="object"&&n.name?n.name:"Unknown",c=n=>{const o=C.find(Y=>Y._id===n);if(!o)return null;const v=o.name.toLowerCase().includes("admin"),f=o.name.toLowerCase().includes("manager");return{...o,isAdmin:v,isManager:f,icon:v?e.jsx(B,{}):f?e.jsx(se,{}):e.jsx(y,{}),color:v?"#722ed1":f?"#1890ff":"#52c41a"}},u=t?c(typeof t.role=="object"?t.role._id:t.role):null,S=h.useWatch([],l),F=(S==null?void 0:S.isActive)!==void 0?S.isActive:t==null?void 0:t.isActive;return t?e.jsx(ne,{title:e.jsxs(r,{children:[e.jsx(X,{icon:e.jsx(be,{}),style:{backgroundColor:"#52c41a",color:"white"},size:"small"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Edit User"})]}),open:p,onCancel:m,width:700,footer:e.jsxs("div",{style:{textAlign:"right",display:"flex",justifyContent:"flex-end",gap:"8px",padding:"16px 24px"},children:[e.jsx(z,{onClick:m,size:"large",children:"Cancel"},"cancel"),e.jsx(z,{type:"primary",loading:U,onClick:P,size:"large",icon:e.jsx(te,{}),children:"Update User"},"submit")]}),children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(w,{style:{marginBottom:"24px",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",border:"1px solid #bae6fd"},children:e.jsxs(V,{align:"middle",gutter:16,children:[e.jsx(A,{children:e.jsx(X,{size:64,icon:e.jsx(y,{}),style:{backgroundColor:"#0ea5e9"}})}),e.jsx(A,{flex:"auto",children:e.jsxs(r,{direction:"vertical",size:4,children:[e.jsx(Ve,{level:4,style:{margin:0,color:"#0c4a6e"},children:t.name||t.username}),e.jsx(G,{type:"secondary",children:t.email}),e.jsxs(r,{children:[e.jsx($,{color:u==null?void 0:u.color,icon:u==null?void 0:u.icon,style:{borderRadius:"12px"},children:i(t.role)}),e.jsx($,{color:F?"success":"default",style:{borderRadius:"12px"},children:F?"Active":"Inactive"})]})]})})]})}),e.jsxs(h,{form:l,layout:"vertical",size:"large",children:[e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(y,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Basic Information"})]}),style:{marginBottom:"24px"},children:[e.jsxs(V,{gutter:16,children:[e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"},{min:3,message:"Username must be at least 3 characters"}],children:e.jsx(k,{prefix:e.jsx(y,{style:{color:"#bfbfbf"}}),placeholder:"Enter username"})})}),e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"name",label:"Full Name",rules:[{required:!0,message:"Please enter the full name"}],children:e.jsx(k,{prefix:e.jsx(y,{style:{color:"#bfbfbf"}}),placeholder:"Enter full name"})})})]}),e.jsx(h.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(k,{prefix:e.jsx(pe,{style:{color:"#bfbfbf"}}),placeholder:"Enter email address"})})]}),e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx($e,{style:{color:"#fa8c16"}}),e.jsx("span",{children:"Password Management"})]}),style:{marginBottom:"24px"},children:[e.jsx(ee,{type:"info",icon:e.jsx(oe,{}),message:"Password Change",description:"Leave the password field empty to keep the current password unchanged.",showIcon:!0,style:{marginBottom:"16px",borderRadius:"8px"}}),e.jsx(h.Item,{name:"password",label:"New Password (Optional)",rules:[{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(k.Password,{prefix:e.jsx(fe,{style:{color:"#bfbfbf"}}),placeholder:"Enter new password (leave blank to keep current)"})})]}),e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(ge,{style:{color:"#722ed1"}}),e.jsx("span",{children:"Role & Permissions"})]}),style:{marginBottom:"24px"},children:[e.jsx(h.Item,{name:"role",label:"Select Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(q,{placeholder:"Choose a role for this user",loading:O,value:I,onChange:W,children:C.length>0?C.map(n=>{const o=c(n._id);return e.jsx(K,{value:n._id,children:e.jsxs(r,{children:[e.jsx("span",{style:{color:o==null?void 0:o.color},children:o==null?void 0:o.icon}),e.jsx("span",{children:n.name})]})},n._id)}):e.jsxs(e.Fragment,{children:[e.jsx(K,{value:"admin",children:e.jsxs(r,{children:[e.jsx(B,{style:{color:"#722ed1"}}),e.jsx("span",{children:"Admin"})]})}),e.jsx(K,{value:"manager",children:e.jsxs(r,{children:[e.jsx(se,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Manager"})]})}),e.jsx(K,{value:"agent",children:e.jsxs(r,{children:[e.jsx(y,{style:{color:"#52c41a"}}),e.jsx("span",{children:"Agent"})]})})]})})}),!R(I)&&e.jsx(h.Item,{name:"assignedExhibitions",label:e.jsxs(r,{children:[e.jsx("span",{children:"Assigned Exhibitions"}),e.jsx(M,{title:"Select exhibitions this user can manage. If none selected, user won't have access to any exhibition data.",children:e.jsx(oe,{style:{color:"#bfbfbf"}})})]}),children:e.jsx(q,{mode:"multiple",placeholder:"Select exhibitions to assign to this user",loading:N,allowClear:!0,optionLabelProp:"label",children:D.map(n=>e.jsx(K,{value:n._id,label:n.name,children:e.jsxs(r,{direction:"vertical",size:0,children:[e.jsx(G,{strong:!0,children:n.name}),e.jsx(G,{type:"secondary",style:{fontSize:"12px"},children:n.venue})]})},n._id))})}),R(I)&&e.jsx(ee,{type:"success",icon:e.jsx(B,{}),message:"Administrator Access",description:e.jsxs(r,{direction:"vertical",size:4,children:[e.jsx(G,{children:"This user will have access to all exhibitions in the system."}),e.jsx(G,{type:"secondary",style:{fontSize:"12px"},children:"No specific exhibition assignment is required for administrators."})]}),showIcon:!0,style:{borderRadius:"8px"}})]}),e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(te,{style:{color:"#52c41a"}}),e.jsx("span",{children:"Account Status"})]}),children:[e.jsx(h.Item,{name:"isActive",label:"Account Status",valuePropName:"checked",children:e.jsx(ye,{checkedChildren:"Active",unCheckedChildren:"Inactive",size:"default"})}),e.jsx(ee,{type:"warning",icon:e.jsx(ke,{}),message:"Important",description:"Deactivating a user will immediately log them out and prevent them from accessing the system.",showIcon:!0,style:{borderRadius:"8px",marginTop:"8px"}})]})]})]})}):null},{Option:H}=q,{Text:J}=ae,Oe=({visible:p,onClose:t,onSuccess:m})=>{const{message:x}=de.useApp(),[j]=h.useForm(),l=ce(),[d,I]=b.useState(""),{roles:E,loading:C}=T(i=>i.role),{exhibitions:O,loading:D}=T(i=>i.exhibition),{loading:N}=T(i=>i.user),U=i=>{var u;const c=E.find(S=>S._id===i);return((u=c==null?void 0:c.name)==null?void 0:u.toLowerCase().includes("admin"))||!1},R=i=>{const c=E.find(F=>F._id===i);if(!c)return null;const u=c.name.toLowerCase().includes("admin"),S=c.name.toLowerCase().includes("manager");return{...c,isAdmin:u,isManager:S,icon:u?e.jsx(B,{}):S?e.jsx(se,{}):e.jsx(y,{}),color:u?"#722ed1":S?"#1890ff":"#52c41a"}};b.useEffect(()=>{p&&(l(je()),l(ue()))},[p,l]),b.useEffect(()=>{p&&(j.resetFields(),I(""))},[p,j]);const W=i=>{I(i),U(i)&&j.setFieldsValue({assignedExhibitions:[]})},P=async()=>{try{const i=await j.validateFields(),c={username:i.username,name:i.name,email:i.email,password:i.password,role:i.role,isActive:i.isActive,assignedExhibitions:U(i.role)?[]:i.assignedExhibitions||[]};l(Ee(c)).unwrap().then(u=>{x.success("User created successfully"),j.resetFields(),m(),t()}).catch(u=>{x.error(`Failed to create user: ${u}`)})}catch(i){console.error("Validation error:",i)}};return e.jsx(ne,{title:e.jsxs(r,{children:[e.jsx(X,{icon:e.jsx(ve,{}),style:{backgroundColor:"#1890ff",color:"white"},size:"small"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Create New User"})]}),open:p,onCancel:t,width:700,footer:e.jsxs("div",{style:{textAlign:"right",display:"flex",justifyContent:"flex-end",gap:"8px",padding:"16px 24px"},children:[e.jsx(z,{onClick:t,size:"large",children:"Cancel"},"cancel"),e.jsx(z,{type:"primary",loading:N,onClick:P,size:"large",icon:e.jsx(te,{}),children:"Create User"},"submit")]}),children:e.jsx("div",{style:{padding:"24px"},children:e.jsxs(h,{form:j,layout:"vertical",requiredMark:!1,size:"large",children:[e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(y,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Basic Information"})]}),style:{marginBottom:"24px"},children:[e.jsxs(V,{gutter:16,children:[e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"},{min:3,message:"Username must be at least 3 characters"},{pattern:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}],children:e.jsx(k,{prefix:e.jsx(y,{style:{color:"#bfbfbf"}}),placeholder:"Enter username"})})}),e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"name",label:"Full Name",rules:[{required:!0,message:"Please enter the full name"}],children:e.jsx(k,{prefix:e.jsx(y,{style:{color:"#bfbfbf"}}),placeholder:"Enter full name"})})})]}),e.jsxs(V,{gutter:16,children:[e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(k,{prefix:e.jsx(pe,{style:{color:"#bfbfbf"}}),placeholder:"Enter email address"})})}),e.jsx(A,{span:12,children:e.jsx(h.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(k.Password,{prefix:e.jsx(fe,{style:{color:"#bfbfbf"}}),placeholder:"Enter password"})})})]})]}),e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(ge,{style:{color:"#722ed1"}}),e.jsx("span",{children:"Role & Permissions"})]}),style:{marginBottom:"24px"},children:[e.jsx(h.Item,{name:"role",label:"Select Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(q,{placeholder:"Choose a role for this user",loading:C,value:d,onChange:W,children:E.length>0?E.map(i=>{const c=R(i._id);return e.jsx(H,{value:i._id,children:e.jsxs(r,{children:[e.jsx("span",{style:{color:c==null?void 0:c.color},children:c==null?void 0:c.icon}),e.jsx("span",{children:i.name})]})},i._id)}):e.jsxs(e.Fragment,{children:[e.jsx(H,{value:"admin",children:e.jsxs(r,{children:[e.jsx(B,{style:{color:"#722ed1"}}),e.jsx("span",{children:"Admin"})]})}),e.jsx(H,{value:"manager",children:e.jsxs(r,{children:[e.jsx(se,{style:{color:"#1890ff"}}),e.jsx("span",{children:"Manager"})]})}),e.jsx(H,{value:"agent",children:e.jsxs(r,{children:[e.jsx(y,{style:{color:"#52c41a"}}),e.jsx("span",{children:"Agent"})]})})]})})}),!U(d)&&e.jsx(h.Item,{name:"assignedExhibitions",label:e.jsxs(r,{children:[e.jsx("span",{children:"Assigned Exhibitions"}),e.jsx(M,{title:"Select exhibitions this user can manage. If none selected, user won't have access to any exhibition data.",children:e.jsx(oe,{style:{color:"#bfbfbf"}})})]}),children:e.jsx(q,{mode:"multiple",placeholder:"Select exhibitions to assign to this user",loading:D,allowClear:!0,optionLabelProp:"label",children:O.map(i=>e.jsx(H,{value:i._id,label:i.name,children:e.jsxs(r,{direction:"vertical",size:0,children:[e.jsx(J,{strong:!0,children:i.name}),e.jsx(J,{type:"secondary",style:{fontSize:"12px"},children:i.venue})]})},i._id))})}),U(d)&&e.jsx(ee,{type:"success",icon:e.jsx(B,{}),message:"Administrator Access",description:e.jsxs(r,{direction:"vertical",size:4,children:[e.jsx(J,{children:"This user will have access to all exhibitions in the system."}),e.jsx(J,{type:"secondary",style:{fontSize:"12px"},children:"No specific exhibition assignment is required for administrators."})]}),showIcon:!0,style:{borderRadius:"8px"}})]}),e.jsxs(w,{title:e.jsxs(r,{children:[e.jsx(te,{style:{color:"#52c41a"}}),e.jsx("span",{children:"Account Status"})]}),children:[e.jsx(h.Item,{name:"isActive",label:"Account Status",valuePropName:"checked",initialValue:!0,children:e.jsx(ye,{checkedChildren:"Active",unCheckedChildren:"Inactive",size:"default"})}),e.jsx(J,{type:"secondary",style:{fontSize:"12px",marginTop:"8px",display:"block"},children:"Active users can log in and access the system. Inactive users are blocked from logging in."})]})]})})})},{Title:De,Paragraph:We,Text:L}=ae,{TabPane:re}=we,{confirm:Ke}=ne;function es(){const{message:p,notification:t}=de.useApp(),m=ce(),{users:x,loading:j,error:l,selectedUser:d}=T(s=>s.user),[I,E]=b.useState(""),[C,O]=b.useState("all"),[D,N]=b.useState(!1),[U,R]=b.useState(!1),[W,P]=b.useState(!1),{hasPermission:i}=Me();b.useEffect(()=>{m(Z())},[m]),b.useEffect(()=>{l&&t.error({message:"Error",description:l})},[l,t]),b.useEffect(()=>{d||(N(!1),R(!1))},[d]);const c=(s,a)=>{Ke({title:"Are you sure you want to delete this user?",icon:e.jsx(Fe,{}),content:`This will permanently delete ${a}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{m(Re(s)).unwrap().then(()=>{p.success(`${a} has been deleted successfully.`)}).catch(g=>{p.error(`Failed to delete user: ${g}`)})}})},u=s=>{m(Q(s)),N(!0)},S=s=>{m(Q(s)),R(!0)},F=()=>{P(!0)},n=[{title:"User",key:"user",render:(s,a)=>e.jsxs(r,{children:[e.jsx(X,{icon:e.jsx(y,{}),size:"large"}),e.jsxs(r,{direction:"vertical",size:0,children:[e.jsx(L,{strong:!0,children:a.name||a.username}),e.jsx(L,{type:"secondary",style:{fontSize:"12px"},children:a.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:s=>{const a=f(s);let g=a.toLowerCase()==="admin"||a.toLowerCase()==="administrator"?"#1677ff":a.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx($,{color:g,style:{fontWeight:500,borderRadius:"4px"},children:a.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(s,a)=>f(a.role).toLowerCase().indexOf(s.toLowerCase())===0},{title:"Assigned Exhibitions",key:"assignedExhibitions",render:(s,a)=>e.jsxs(r,{direction:"vertical",size:2,children:[Y(a)?e.jsx($,{color:"green",style:{fontSize:"12px"},children:"âœ… All exhibitions"}):a.assignedExhibitions&&a.assignedExhibitions.length>0?a.assignedExhibitions.slice(0,2).map((g,Se)=>{const Ce=typeof g=="string"?`Exhibition ${g.slice(-4)}...`:g!=null&&g.name?`${g.name}`:`Exhibition ${((g==null?void 0:g._id)||g).toString().slice(-4)}...`;return e.jsx($,{color:"blue",style:{fontSize:"12px"},children:Ce},Se)}):e.jsx(L,{type:"secondary",style:{fontSize:"12px"},children:"No assignments"}),!Y(a)&&a.assignedExhibitions&&a.assignedExhibitions.length>2&&e.jsxs(L,{type:"secondary",style:{fontSize:"11px"},children:["+",a.assignedExhibitions.length-2," more"]})]})},{title:"Status",key:"status",render:(s,a)=>e.jsx(r,{children:a.isActive?e.jsx(he,{status:"success",text:e.jsx(L,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(he,{status:"default",text:e.jsx(L,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(s,a)=>a.isActive===s},{title:"Last Active",key:"lastLogin",render:(s,a)=>e.jsxs(r,{children:[e.jsx(Te,{style:{color:"#8c8c8c"}}),e.jsx(L,{type:"secondary",children:a.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(s,a)=>e.jsxs(r,{size:"small",children:[i("users_view")&&e.jsx(M,{title:"View details",children:e.jsx(z,{type:"text",icon:e.jsx(Ne,{}),size:"small",onClick:()=>u(a)})}),i("users_edit")&&e.jsx(M,{title:"Edit user",children:e.jsx(z,{type:"text",icon:e.jsx(be,{}),size:"small",onClick:()=>S(a)})}),i("users_delete")&&e.jsx(M,{title:"Delete user",children:e.jsx(z,{type:"text",danger:!0,icon:e.jsx(Pe,{}),size:"small",onClick:()=>c(a._id,a.name||a.username)})})]})}],o=s=>s.isActive?"active":"inactive",v=x.filter(s=>(C==="all"||C==="active"&&o(s)==="active"||C==="inactive"&&o(s)==="inactive")&&Object.values(s).some(a=>typeof a=="string"&&a.toLowerCase().includes(I.toLowerCase()))),f=s=>typeof s=="string"?s:s&&typeof s=="object"&&s.name?s.name:"Unknown",Y=s=>f(s.role).toLowerCase().includes("admin"),Ae={admin:x.filter(s=>{const a=f(s.role).toLowerCase();return a==="admin"||a==="administrator"}).length,manager:x.filter(s=>f(s.role).toLowerCase()==="manager").length,agent:x.filter(s=>f(s.role).toLowerCase()==="agent").length},ie={active:x.filter(s=>s.isActive).length,inactive:x.filter(s=>!s.isActive).length};return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(De,{level:2,children:"User Management"}),e.jsx(We,{children:"Manage user accounts, permissions, and access control."})]}),e.jsxs(V,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(A,{xs:24,sm:8,children:e.jsx(w,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(le,{title:"Total Users",value:x.length,prefix:e.jsx(y,{}),valueStyle:{color:"#1677ff"},loading:j})})}),e.jsx(A,{xs:24,sm:8,children:e.jsx(w,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(le,{title:"Active Users",value:ie.active,prefix:e.jsx(Ue,{}),valueStyle:{color:"#52c41a"},loading:j})})}),e.jsx(A,{xs:24,sm:8,children:e.jsx(w,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(le,{title:"Admin Users",value:Ae.admin,prefix:e.jsx(y,{}),valueStyle:{color:"#faad14"},loading:j})})})]}),e.jsx(w,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs(V,{gutter:[16,16],justify:"space-between",align:"middle",children:[e.jsx(A,{xs:24,md:12,children:e.jsx(k,{placeholder:"Search users...",prefix:e.jsx(xe,{style:{color:"rgba(0,0,0,.45)"}}),onChange:s=>E(s.target.value),allowClear:!0,size:"middle"})}),e.jsx(A,{xs:24,md:12,style:{textAlign:"right"},children:e.jsxs(r,{wrap:!0,children:[e.jsx(M,{title:"Refresh data",children:e.jsx(z,{icon:j?e.jsx(_e,{}):e.jsx(xe,{}),onClick:()=>m(Z()),disabled:j,children:"Refresh"})}),e.jsx(z,{type:"primary",icon:e.jsx(ve,{}),onClick:F,children:"Add User"})]})})]})}),e.jsxs(w,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(we,{defaultActiveKey:"all",onChange:O,tabBarStyle:{marginBottom:24},children:[e.jsx(re,{tab:`All Users (${x.length})`},"all"),e.jsx(re,{tab:`Active (${ie.active})`},"active"),e.jsx(re,{tab:`Inactive (${ie.inactive})`},"inactive")]}),e.jsx(Le,{columns:n,dataSource:v,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(s,a)=>`${a[0]}-${a[1]} of ${s} users`},loading:j})]}),e.jsx(Be,{user:x.find(s=>s._id===(d==null?void 0:d._id))||null,visible:D,onClose:()=>m(Q(null))}),e.jsx(qe,{user:x.find(s=>s._id===(d==null?void 0:d._id))||null,visible:U,onClose:()=>m(Q(null)),onSuccess:()=>m(Z())}),e.jsx(Oe,{visible:W,onClose:()=>P(!1),onSuccess:()=>m(Z())})]})}export{es as default};
