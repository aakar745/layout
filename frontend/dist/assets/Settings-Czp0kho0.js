import{f as P,a as f,j as e,u as k,c as z}from"./index-DoSueJxk.js";import{l as C,k as B,r as x}from"./vendor-react-dkbxt9Jf.js";/* empty css                  */import{Y as A,K as n,$ as b,a0 as y,S as I,T as V,a1 as q,J as v,ab as S,ac as O,ad as M,U as L,c as R,aa as D,ae as J,af as K}from"./vendor-antd-mFVHvrVJ.js";import"./vendor-utils-ngrFHoWO.js";import"./vendor-styling-CQa69cNz.js";const{Option:d}=S,{Title:Y,Text:G}=V,ee=()=>{const m=C(),{message:u}=A.useApp(),[c]=n.useForm(),{settings:t,loading:$}=B(a=>a.settings),[j,r]=x.useState([]),[h,p]=x.useState(0);x.useEffect(()=>{m(P())},[m]),x.useEffect(()=>{if(t&&(c.setFieldsValue({siteName:t.siteName,adminEmail:t.adminEmail,language:t.language,timezone:t.timezone,emailNotifications:t.emailNotifications,footerText:t.footerText}),t.logo)){const a=s=>{const o=localStorage.getItem("token");return{url:`${f.defaults.baseURL}/uploads/${s}`,token:o}},{url:i,token:l}=a(t.logo);fetch(i,{headers:{authorization:`Bearer ${l}`}}).then(s=>s.blob()).then(s=>{const o=URL.createObjectURL(s);r([{uid:"-1",name:t.logo?.split("/").pop()||"logo",status:"done",url:o,thumbUrl:o,type:s.type,response:{path:t.logo}}])}).catch(()=>{r([])})}},[t,c]);const F=a=>{m(k(a)).unwrap().then(()=>u.success("Settings updated successfully")).catch(i=>u.error(`Failed to update settings: ${i}`))},N={name:"file",action:`${f.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:j,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:i,name:l,response:s,uid:o}=a.file;if(i==="uploading"){r([...a.fileList]);return}if(i==="done"&&s){p(0);const T=localStorage.getItem("token"),E=`${f.defaults.baseURL}/uploads/${s.path}`;fetch(E,{headers:{authorization:`Bearer ${T}`}}).then(g=>g.blob()).then(g=>{const U=URL.createObjectURL(g);r([{uid:a.file.uid,name:l,status:"done",url:U,thumbUrl:U,type:g.type,response:s}]),u.success(`${l} uploaded successfully`),c.setFieldValue("logo",s.path)}).catch(()=>{u.error(`${l} preview failed to load`),r([])})}else i==="error"?(u.error(`${l} upload failed.`),r([]),p(0)):i==="removed"&&(r([]),c.setFieldValue("logo",null),p(0))},onRemove(){return r([]),c.setFieldValue("logo",null),p(0),!0},customRequest:async({file:a,onSuccess:i,onError:l,onProgress:s})=>{try{m(z(a)).unwrap().then(o=>{i&&i(o)}).catch(o=>{l&&l(new Error(o))})}catch(o){l&&l(o)}}},w=e.jsx("div",{children:h>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(L,{type:"circle",percent:h,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(b,{gutter:[24,24],align:"middle",children:e.jsx(y,{flex:"auto",children:e.jsxs(I,{direction:"vertical",size:4,children:[e.jsx(Y,{level:4,style:{margin:0},children:"Settings"}),e.jsx(G,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(q,{className:"info-card",children:e.jsxs(n,{form:c,layout:"vertical",onFinish:F,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(b,{gutter:24,children:[e.jsxs(y,{span:12,children:[e.jsx(n.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Language",name:"language",children:e.jsxs(S,{children:[e.jsx(d,{value:"en",children:"English"}),e.jsx(d,{value:"es",children:"Spanish"}),e.jsx(d,{value:"fr",children:"French"})]})}),e.jsx(n.Item,{label:"Timezone",name:"timezone",children:e.jsxs(S,{children:[e.jsx(d,{value:"UTC",children:"UTC"}),e.jsx(d,{value:"EST",children:"EST"}),e.jsx(d,{value:"PST",children:"PST"})]})}),e.jsx(n.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(O,{})})]}),e.jsxs(y,{span:12,children:[e.jsxs(n.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 10MB)",children:[e.jsx(M,{...N,children:j.length<1&&w}),j.length>0&&h>0&&e.jsx(L,{percent:h,status:"active",style:{marginTop:8}})]}),e.jsx(n.Item,{label:"Footer Text",name:"footerText",children:e.jsx(v.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(n.Item,{children:e.jsxs(I,{children:[e.jsx(R,{type:"primary",htmlType:"submit",icon:e.jsx(D,{}),loading:$,children:"Save Settings"}),e.jsx(R,{onClick:()=>c.resetFields(),icon:e.jsx(J,{}),children:"Reset"})]})})]})})]})};export{ee as default};
