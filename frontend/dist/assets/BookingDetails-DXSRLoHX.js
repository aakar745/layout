import{p as V,j as e}from"./index-BP1I9PmK.js";import{l as z,u as F,r as l}from"./vendor-react-BNeW3y6d.js";import{V as w,o as q,a6 as s,T as _,c,aV as U,C as K,ai as i,d,ak as G,a7 as H,a8 as J,b as o,x as N,h as O}from"./vendor-antd-DhcJxEc5.js";import"./vendor-utils-j652IAQy.js";import"./vendor-styling-BBrlYwaV.js";import"./vendor-canvas-BRbMLhVA.js";const{Title:C,Text:m}=_,ie=()=>{var h,x,j,g,p,b,y,f,I,k,A,S,v;const{id:r}=z(),a=F(),[t,R]=l.useState(null),[T,u]=l.useState(!0);l.useEffect(()=>{E()},[r]);const E=async()=>{try{u(!0);const n=await V.getExhibitorBooking(r||"");R(n.data)}catch(n){console.error("Error fetching booking details:",n),w.error("Failed to load booking details")}finally{u(!1)}},Y=async()=>{try{a(`/exhibitor/invoice/${r}`)}catch(n){console.error("Error fetching invoice:",n),w.error("Failed to retrieve invoice")}},P=n=>{switch(n){case"approved":return e.jsxs(o,{color:"success",children:[e.jsx(N,{})," Approved"]});case"pending":return e.jsxs(o,{color:"warning",children:[e.jsx(O,{})," Pending"]});case"rejected":return e.jsx(o,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(o,{color:"blue",children:[e.jsx(N,{})," Confirmed"]});case"cancelled":return e.jsx(o,{color:"default",children:"Cancelled"});default:return e.jsx(o,{children:"Unknown"})}},$=n=>{switch(n){case"paid":return e.jsx(o,{color:"success",children:"Paid"});case"pending":return e.jsx(o,{color:"warning",children:"Pending"});case"refunded":return e.jsx(o,{color:"default",children:"Refunded"});default:return e.jsx(o,{children:"Unknown"})}},M=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:n=>`${n.dimensions.width}m × ${n.dimensions.height}m`},{title:"Size",key:"size",render:n=>`${n.dimensions.width*n.dimensions.height} m²`},{title:"Rate per m²",dataIndex:"ratePerSqm",key:"ratePerSqm",render:n=>`₹${n.toLocaleString()}`},{title:"Amount",key:"amount",render:(n,Q,L)=>{var B;const D=(B=t.calculations)==null?void 0:B.stalls[L];return D?`₹${D.baseAmount.toLocaleString()}`:"N/A"}}];return T?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(q,{size:"large"})}):t?e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(c,{icon:e.jsx(U,{}),onClick:()=>a("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(t.status)&&e.jsx(c,{type:"primary",icon:e.jsx(K,{}),onClick:Y,children:"View Invoice"})]}),e.jsxs(s,{title:"Booking Details",style:{marginBottom:20},children:[e.jsxs(i,{bordered:!0,column:{xs:1,sm:2,md:3},children:[e.jsx(i.Item,{label:"Booking ID",children:t._id}),e.jsx(i.Item,{label:"Exhibition",children:((h=t.exhibitionId)==null?void 0:h.name)||"N/A"}),e.jsx(i.Item,{label:"Venue",children:((x=t.exhibitionId)==null?void 0:x.venue)||"N/A"}),e.jsx(i.Item,{label:"Booking Date",children:d(t.createdAt).format("MMM D, YYYY")}),e.jsxs(i.Item,{label:"Exhibition Dates",children:[d((j=t.exhibitionId)==null?void 0:j.startDate).format("MMM D, YYYY")," -",d((g=t.exhibitionId)==null?void 0:g.endDate).format("MMM D, YYYY")]}),e.jsx(i.Item,{label:"Status",children:P(t.status)}),e.jsx(i.Item,{label:"Payment Status",children:$(t.paymentStatus||"pending")}),e.jsxs(i.Item,{label:"Total Amount",children:["₹",((p=t.amount)==null?void 0:p.toLocaleString())||"N/A"]})]}),t.rejectionReason&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(C,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),e.jsx(m,{children:t.rejectionReason})]})]}),e.jsx(s,{title:"Stall Details",style:{marginBottom:20},children:e.jsx(G,{dataSource:t.stallIds||[],columns:M,rowKey:"_id",pagination:!1})}),e.jsx(s,{title:"Calculation Summary",children:e.jsx(H,{gutter:[16,16],children:e.jsx(J,{span:24,children:e.jsxs(i,{bordered:!0,column:1,children:[e.jsxs(i.Item,{label:"Base Amount",children:["₹",((b=t.calculations)==null?void 0:b.totalBaseAmount.toLocaleString())||"N/A"]}),((y=t.calculations)==null?void 0:y.totalDiscountAmount)>0&&e.jsxs(i.Item,{label:"Discount",children:["- ₹",((f=t.calculations)==null?void 0:f.totalDiscountAmount.toLocaleString())||"N/A"]}),((I=t.calculations)==null?void 0:I.totalDiscountAmount)>0&&e.jsxs(i.Item,{label:"Amount After Discount",children:["₹",((k=t.calculations)==null?void 0:k.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(S=(A=t.calculations)==null?void 0:A.taxes)==null?void 0:S.map(n=>e.jsxs(i.Item,{label:`${n.name} (${n.rate}%)`,children:["+ ₹",n.amount.toLocaleString()||"N/A"]},n.name)),e.jsx(i.Item,{label:"Total Amount",children:e.jsxs(m,{strong:!0,style:{fontSize:"16px"},children:["₹",((v=t.amount)==null?void 0:v.toLocaleString())||"N/A"]})})]})})})}),e.jsx(s,{title:"Customer Information",style:{marginTop:20},children:e.jsxs(i,{bordered:!0,column:{xs:1,sm:2},children:[e.jsx(i.Item,{label:"Company Name",children:t.companyName}),e.jsx(i.Item,{label:"Contact Person",children:t.customerName}),e.jsx(i.Item,{label:"Email",children:t.customerEmail}),e.jsx(i.Item,{label:"Phone",children:t.customerPhone})]})})]}):e.jsx(s,{children:e.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[e.jsx(C,{level:3,children:"Booking Not Found"}),e.jsx(m,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),e.jsx("div",{style:{marginTop:20},children:e.jsx(c,{type:"primary",onClick:()=>a("/exhibitor/bookings"),children:"Back to Bookings"})})]})})};export{ie as default};
