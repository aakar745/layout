import{j as a,D as x,H as E,K as l}from"./index-0Suq5uxL.js";import{l as D,k as I,u as L,j as P,i as T,r as d,N as R}from"./vendor-react-BNeW3y6d.js";import{E as j}from"./ExhibitionForm-CDfqTYC6.js";import{ae as q,a5 as b,d as y}from"./vendor-antd--VDS8NUg.js";import"./vendor-utils-CtctGR1F.js";import"./vendor-styling-CU6mz1ss.js";import"./vendor-canvas-BRbMLhVA.js";const K=()=>{var h;const{message:e}=q.useApp(),{id:F}=D(),n=(h=I().state)==null?void 0:h.exhibitionId,c=L(),r=P(),{currentExhibition:t,loading:u,error:m}=T(i=>i.exhibition),[g,C]=d.useState(!1);d.useEffect(()=>{(async()=>{if(!n){e.error("Exhibition ID not found"),c("/exhibition");return}try{await r(E(n)).unwrap()}catch(s){e.error(s.message||"Failed to fetch exhibition"),c("/exhibition")}finally{C(!0)}})()},[n,r,e,c]),d.useEffect(()=>{m&&e.error(m)},[m,e]);const A=async i=>{var s,f;if(!(!n||!t))try{const[p,N]=i.dateRange,S={name:i.name,description:i.description,venue:i.venue,startDate:p.toISOString(),endDate:N.toISOString(),status:i.status,isActive:i.isActive,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:t.dimensions,taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((s=i.amenities)==null?void 0:s.map(o=>({type:o.type,name:o.name,description:o.description,rate:o.rate})))||[],basicAmenities:((f=i.basicAmenities)==null?void 0:f.map(o=>({type:o.type,name:o.name,description:o.description,perSqm:o.perSqm,quantity:o.quantity})))||[],specialRequirements:i.specialRequirements};await r(l({id:n,data:S})).unwrap(),e.success("Exhibition updated successfully"),c(x(t),{state:{exhibitionId:n}})}catch(p){e.error(p.message||"Failed to update exhibition")}};if(!g)return a.jsx(b,{loading:!0});if(!n)return a.jsx(R,{to:"/exhibition",replace:!0});if(u||!t)return a.jsx(b,{loading:!0});const k={name:t.name,description:t.description,venue:t.venue,dateRange:[y(t.startDate),y(t.endDate)],status:t.status,isActive:t.isActive,invoicePrefix:t.invoicePrefix,stallRates:t.stallRates||[],taxConfig:t.taxConfig||[],discountConfig:t.discountConfig||[],publicDiscountConfig:t.publicDiscountConfig||[],companyName:t.companyName,companyContactNo:t.companyContactNo,companyEmail:t.companyEmail,companyAddress:t.companyAddress,companyWebsite:t.companyWebsite,companyPAN:t.companyPAN,companyGST:t.companyGST,companySAC:t.companySAC,companyCIN:t.companyCIN,termsAndConditions:t.termsAndConditions,piInstructions:t.piInstructions,bankName:t.bankName,bankBranch:t.bankBranch,bankIFSC:t.bankIFSC,bankAccountName:t.bankAccountName,bankAccount:t.bankAccount,headerTitle:t.headerTitle,headerSubtitle:t.headerSubtitle,headerDescription:t.headerDescription,headerLogo:t.headerLogo,sponsorLogos:t.sponsorLogos||[],footerText:t.footerText,footerLogo:t.footerLogo,contactEmail:t.contactEmail,contactPhone:t.contactPhone,footerLinks:t.footerLinks||[],amenities:t.amenities||[],basicAmenities:t.basicAmenities||[],specialRequirements:t.specialRequirements};return a.jsx(b,{title:"Edit Exhibition",extra:a.jsx("a",{onClick:()=>c(x(t),{state:{exhibitionId:n}}),children:"Back to Details"}),children:a.jsx(j,{initialValues:k,onSubmit:A,submitText:"Update Exhibition"})})};export{K as default};
