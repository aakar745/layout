import{r as e,j as s,x as t,an as a,h as o}from"./vendor-others-aeGeD6f-.js";import"./page-dashboard-984XnN9x.js";import{u as i,a as n}from"./vendor-react-i7tvbPTl.js";import{J as r,K as l,L as d}from"./store-D4NI4RZ9.js";import{a as c}from"./services-DHEt1Qtz.js";import{i as m,R as u,C as h,e as p,T as j,c as g,I as x,f,h as v,U as y,P as b}from"./vendor-antd-core-CLD06I8y.js";import{F as T}from"./vendor-antd-form-DJHhvp8w.js";import{B as S}from"./vendor-antd-buttons-wjEWA2x8.js";import"./vendor-ui-BOD89xu8.js";import"./vendor-canvas-BOVIu3pe.js";import"./vendor-utils-CTzFqUk0.js";import"./component-exhibition-CuwlJtEU.js";import"./vendor-editor-HOXaQDhO.js";import"./vendor-antd-modal-1GBGM2fb.js";import"./component-layout-BTsCaDZB.js";import"./component-auth-ClRi3ofU.js";import"./vendor-antd-table-CA0XBoxE.js";const{Option:U}=f,{Title:E,Text:I}=j,L=()=>{const j=i(),{message:L}=m.useApp(),[N]=T.useForm(),{settings:F,loading:R}=n((e=>e.settings)),[$,w]=e.useState([]),[z,P]=e.useState(0);e.useEffect((()=>{j(r())}),[j]),e.useEffect((()=>{if(F&&(N.setFieldsValue({siteName:F.siteName,adminEmail:F.adminEmail,language:F.language,timezone:F.timezone,emailNotifications:F.emailNotifications,footerText:F.footerText}),F.logo)){const e=e=>{const s=localStorage.getItem("token");return{url:`${c.defaults.baseURL}/uploads/${e}`,token:s}},{url:s,token:t}=e(F.logo);fetch(s,{headers:{authorization:`Bearer ${t}`}}).then((e=>e.blob())).then((e=>{var s;const t=URL.createObjectURL(e);w([{uid:"-1",name:(null==(s=F.logo)?void 0:s.split("/").pop())||"logo",status:"done",url:t,thumbUrl:t,type:e.type,response:{path:F.logo}}])})).catch((()=>{w([])}))}}),[F,N]);const k={name:"file",action:`${c.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:$,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(e){const{status:s,name:t,response:a,uid:o}=e.file;if("uploading"!==s)if("done"===s&&a){P(0);const s=localStorage.getItem("token"),o=`${c.defaults.baseURL}/uploads/${a.path}`;fetch(o,{headers:{authorization:`Bearer ${s}`}}).then((e=>e.blob())).then((s=>{const o=URL.createObjectURL(s);w([{uid:e.file.uid,name:t,status:"done",url:o,thumbUrl:o,type:s.type,response:a}]),L.success(`${t} uploaded successfully`),N.setFieldValue("logo",a.path)})).catch((()=>{L.error(`${t} preview failed to load`),w([])}))}else"error"===s?(L.error(`${t} upload failed.`),w([]),P(0)):"removed"===s&&(w([]),N.setFieldValue("logo",null),P(0));else w([...e.fileList])},onRemove:()=>(w([]),N.setFieldValue("logo",null),P(0),!0),customRequest:async({file:e,onSuccess:s,onError:t,onProgress:a})=>{try{j(d(e)).unwrap().then((e=>{s&&s(e)})).catch((e=>{t&&t(new Error(e))}))}catch(o){t&&t(o)}}},C=s.jsx("div",{children:z>0?s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(b,{type:"circle",percent:z,width:80}),s.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(o,{}),s.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return s.jsxs("div",{className:"dashboard-container",children:[s.jsx("div",{style:{marginBottom:"24px"},children:s.jsx(u,{gutter:[24,24],align:"middle",children:s.jsx(h,{flex:"auto",children:s.jsxs(p,{direction:"vertical",size:4,children:[s.jsx(E,{level:4,style:{margin:0},children:"Settings"}),s.jsx(I,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),s.jsx(g,{className:"info-card",children:s.jsxs(T,{form:N,layout:"vertical",onFinish:e=>{j(l(e)).unwrap().then((()=>L.success("Settings updated successfully"))).catch((e=>L.error(`Failed to update settings: ${e}`)))},initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[s.jsxs(u,{gutter:24,children:[s.jsxs(h,{span:12,children:[s.jsx(T.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:s.jsx(x,{})}),s.jsx(T.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:s.jsx(x,{})}),s.jsx(T.Item,{label:"Language",name:"language",children:s.jsxs(f,{children:[s.jsx(U,{value:"en",children:"English"}),s.jsx(U,{value:"es",children:"Spanish"}),s.jsx(U,{value:"fr",children:"French"})]})}),s.jsx(T.Item,{label:"Timezone",name:"timezone",children:s.jsxs(f,{children:[s.jsx(U,{value:"UTC",children:"UTC"}),s.jsx(U,{value:"EST",children:"EST"}),s.jsx(U,{value:"PST",children:"PST"})]})}),s.jsx(T.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:s.jsx(v,{})})]}),s.jsxs(h,{span:12,children:[s.jsxs(T.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[s.jsx(y,{...k,children:$.length<1&&C}),$.length>0&&z>0&&s.jsx(b,{percent:z,status:"active",style:{marginTop:8}})]}),s.jsx(T.Item,{label:"Footer Text",name:"footerText",children:s.jsx(x.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),s.jsx(T.Item,{children:s.jsxs(p,{children:[s.jsx(S,{type:"primary",htmlType:"submit",icon:s.jsx(t,{}),loading:R,children:"Save Settings"}),s.jsx(S,{onClick:()=>N.resetFields(),icon:s.jsx(a,{}),children:"Reset"})]})})]})})]})};export{L as default};
