var El=Object.defineProperty;var Al=(s,t,n)=>t in s?El(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var Zr=(s,t,n)=>Al(s,typeof t!="symbol"?t+"":t,n);import{j as e,_ as fa,a as ga,D as ya,P as ba}from"./vendor-pdf-AgUq7spB.js";import{b as Nl,c as Tl,g as Pl,d as Ie,T as pe,L as Pt,e as Ve,S as X,f as re,B as bt,A as wt,h as O,i as nt,j as Er,k as Ce,l as Rl,m as Ze,n as nn,r as h,o as bi,p as Ar,q as ci,s as Et,t as dt,u as Bt,E as Xe,D as Ee,v as ms,w as Fe,M as jt,x as ja,y as va,z as di,C as ui,F as Nr,G as ct,H as _e,I as Tr,J as _l,K as es,N as Dl,O as G,P as $,Q as ur,U as Pr,V as qe,W as Ht,X as Jt,Y as Ls,Z as ee,$ as ie,a0 as B,a1 as K,a2 as hr,a3 as eo,a4 as hi,a5 as be,a6 as Rt,a7 as Rr,a8 as ae,a9 as $e,aa as Ct,ab as Wt,ac as ge,ad as $s,ae as ts,af as me,ag as _r,ah as Yt,ai as Dr,aj as fs,ak as wa,al as Sa,am as it,an as mt,ao as rn,ap as Ll,aq as on,ar as lt,as as _s,at as $l,au as us,av as Fl,a as De,aw as zt,ax as Lr,ay as an,az as hn,aA as to,aB as Bl,aC as $r,aD as gs,aE as Ue,aF as As,aG as hs,aH as pn,aI as Ml,aJ as zl,aK as Ol,aL as ka,aM as ql,aN as so,aO as Ul,aP as Vl,aQ as Hl,aR as Ca,aS as xn,aT as Wl,aU as Yl,aV as Ql,aW as Gl,aX as Kl,aY as no,aZ as Ia,a_ as Xl,a$ as Jl,b0 as Zl,b1 as ec,b2 as tc,b3 as sc,b4 as nc,b5 as pr,b6 as ic,b7 as _t,b8 as rc,b9 as io,ba as oc,bb as ac}from"./vendor-antd-ChDT4L8q.js";import{c as je,a as at,u as ke,b as ue,d as Ae,e as Qt,L as pt,f as ft,w as ro,n as Ea,g as Aa,i as ln,h as lc,j as Fs,k as Na,p as Fr,l as Os,m as pi,o as Br,q as ps,r as oo,s as cc,S as Ta,t as Ni,v as Mr,x as Pa,y as dc,z as Ra,A as uc,B as ao,C as hc,D as pc,E as xc,F as mc,G as Xs,N as ji,H as fc,I as gc,R as yc,J as we,K as bc,P as jc}from"./vendor-react-DapMoYHB.js";import{a as ht}from"./vendor-utils-EO_Q7Jpb.js";import{n as J,k as ss}from"./vendor-ui-BOEMdQLn.js";import{E as vc}from"./vendor-editor-DQP6KfiB.js";import{L as xi,G as Ds,R as vi,T as cn,u as wc,a as Sc,I as kc,C as Cc,b as Ic,c as Ec,S as Ac,F as Nc,d as Tc}from"./vendor-canvas-DHYdFWea.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var xr={},lo=Nl;xr.createRoot=lo.createRoot,xr.hydrateRoot=lo.hydrateRoot;const wi="/api",ne=ht.create({baseURL:wi,headers:{"Content-Type":"application/json",Accept:"application/json"}}),is=ht.create({baseURL:wi,headers:{"Content-Type":"application/json",Accept:"application/json"}}),_a=ht.create({baseURL:wi,headers:{"Content-Type":"application/json",Accept:"application/json"}});ne.interceptors.request.use(s=>{var o,a,u,b,c,S,g,x,P;const t=localStorage.getItem("token"),n=localStorage.getItem("exhibitor_token"),i=((o=s.url)==null?void 0:o.startsWith("/bookings/"))&&s.method==="patch"||((a=s.url)==null?void 0:a.includes("/exhibition/"))||((u=s.url)==null?void 0:u.includes("/stalls/"))||((b=s.url)==null?void 0:b.includes("/halls/"))||((c=s.url)==null?void 0:c.includes("/users/"))||((S=s.url)==null?void 0:S.includes("/roles/")),r=((g=s.url)==null?void 0:g.includes("/test-booking"))||((x=s.url)==null?void 0:x.includes("/exhibitor-bookings"))||((P=s.url)==null?void 0:P.startsWith("/exhibitors/"));return i?t?s.headers.Authorization=`Bearer ${t}`:console.warn("Admin token required but not found for:",s.url):r&&n?s.headers.Authorization=`Bearer ${n}`:t?s.headers.Authorization=`Bearer ${t}`:n&&(s.headers.Authorization=`Bearer ${n}`),s},s=>Promise.reject(s));_a.interceptors.request.use(s=>{const t=localStorage.getItem("exhibitor_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));ne.interceptors.response.use(s=>s,s=>{var n,i,r;((n=s.response)==null?void 0:n.status)===401&&localStorage.removeItem("token");const t=((r=(i=s.response)==null?void 0:i.data)==null?void 0:r.message)||s.message;return Promise.reject(new Error(t))});_a.interceptors.response.use(s=>s,s=>{var n,i,r;((n=s.response)==null?void 0:n.status)===401&&localStorage.removeItem("exhibitor_token");const t=((r=(i=s.response)==null?void 0:i.data)==null?void 0:r.message)||s.message;return Promise.reject(new Error(t))});const co=async(s,t=!1)=>{const n=t?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return ht.get(`${wi}${s}`,{responseType:"blob",headers:{Authorization:`Bearer ${n}`}})},mi={login:async s=>await ne.post("/auth/login",s),getProfile:async()=>await ne.get("/auth/me"),changePassword:async s=>await ne.post("/auth/change-password",s)},uo=localStorage.getItem("token"),Ti=localStorage.getItem("user");let Da=null;try{Da=Ti&&Ti!=="undefined"?JSON.parse(Ti):null}catch(s){console.error("Failed to parse user data from localStorage",s),localStorage.removeItem("user")}const Pc={isAuthenticated:!!uo,user:Da,token:uo,loading:!1,error:null},zn=je("auth/refreshUser",async(s,{rejectWithValue:t})=>{var n,i;try{return(await mi.getProfile()).data}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to refresh user data")}}),La=at({name:"auth",initialState:Pc,reducers:{setCredentials:(s,t)=>{s.user=t.payload.user,s.token=t.payload.token,s.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:s=>{s.user=null,s.token=null,s.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:s=>{s.addCase(zn.pending,t=>{t.loading=!0,t.error=null}).addCase(zn.fulfilled,(t,n)=>{t.loading=!1,t.user=n.payload,localStorage.setItem("user",JSON.stringify(n.payload))}).addCase(zn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{setCredentials:$a,logout:ho}=La.actions,Rc=La.reducer,Mt=Object.create(null);Mt.open="0";Mt.close="1";Mt.ping="2";Mt.pong="3";Mt.message="4";Mt.upgrade="5";Mt.noop="6";const On=Object.create(null);Object.keys(Mt).forEach(s=>{On[Mt[s]]=s});const mr={type:"error",data:"parser error"},Fa=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ba=typeof ArrayBuffer=="function",Ma=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,zr=({type:s,data:t},n,i)=>Fa&&t instanceof Blob?n?i(t):po(t,i):Ba&&(t instanceof ArrayBuffer||Ma(t))?n?i(t):po(new Blob([t]),i):i(Mt[s]+(t||"")),po=(s,t)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];t("b"+(i||""))},n.readAsDataURL(s)};function xo(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Pi;function _c(s,t){if(Fa&&s.data instanceof Blob)return s.data.arrayBuffer().then(xo).then(t);if(Ba&&(s.data instanceof ArrayBuffer||Ma(s.data)))return t(xo(s.data));zr(s,!1,n=>{Pi||(Pi=new TextEncoder),t(Pi.encode(n))})}const mo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ks=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<mo.length;s++)Ks[mo.charCodeAt(s)]=s;const Dc=s=>{let t=s.length*.75,n=s.length,i,r=0,o,a,u,b;s[s.length-1]==="="&&(t--,s[s.length-2]==="="&&t--);const c=new ArrayBuffer(t),S=new Uint8Array(c);for(i=0;i<n;i+=4)o=Ks[s.charCodeAt(i)],a=Ks[s.charCodeAt(i+1)],u=Ks[s.charCodeAt(i+2)],b=Ks[s.charCodeAt(i+3)],S[r++]=o<<2|a>>4,S[r++]=(a&15)<<4|u>>2,S[r++]=(u&3)<<6|b&63;return c},Lc=typeof ArrayBuffer=="function",Or=(s,t)=>{if(typeof s!="string")return{type:"message",data:za(s,t)};const n=s.charAt(0);return n==="b"?{type:"message",data:$c(s.substring(1),t)}:On[n]?s.length>1?{type:On[n],data:s.substring(1)}:{type:On[n]}:mr},$c=(s,t)=>{if(Lc){const n=Dc(s);return za(n,t)}else return{base64:!0,data:s}},za=(s,t)=>{switch(t){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},Oa="",Fc=(s,t)=>{const n=s.length,i=new Array(n);let r=0;s.forEach((o,a)=>{zr(o,!1,u=>{i[a]=u,++r===n&&t(i.join(Oa))})})},Bc=(s,t)=>{const n=s.split(Oa),i=[];for(let r=0;r<n.length;r++){const o=Or(n[r],t);if(i.push(o),o.type==="error")break}return i};function Mc(){return new TransformStream({transform(s,t){_c(s,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);const o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(n)})}})}let Ri;function yn(s){return s.reduce((t,n)=>t+n.length,0)}function bn(s,t){if(s[0].length===t)return s.shift();const n=new Uint8Array(t);let i=0;for(let r=0;r<t;r++)n[r]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),n}function zc(s,t){Ri||(Ri=new TextDecoder);const n=[];let i=0,r=-1,o=!1;return new TransformStream({transform(a,u){for(n.push(a);;){if(i===0){if(yn(n)<1)break;const b=bn(n,1);o=(b[0]&128)===128,r=b[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(yn(n)<2)break;const b=bn(n,2);r=new DataView(b.buffer,b.byteOffset,b.length).getUint16(0),i=3}else if(i===2){if(yn(n)<8)break;const b=bn(n,8),c=new DataView(b.buffer,b.byteOffset,b.length),S=c.getUint32(0);if(S>Math.pow(2,21)-1){u.enqueue(mr);break}r=S*Math.pow(2,32)+c.getUint32(4),i=3}else{if(yn(n)<r)break;const b=bn(n,r);u.enqueue(Or(o?b:Ri.decode(b),t)),i=0}if(r===0||r>s){u.enqueue(mr);break}}}})}const qa=4;function We(s){if(s)return Oc(s)}function Oc(s){for(var t in We.prototype)s[t]=We.prototype[t];return s}We.prototype.on=We.prototype.addEventListener=function(s,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(t),this};We.prototype.once=function(s,t){function n(){this.off(s,n),t.apply(this,arguments)}return n.fn=t,this.on(s,n),this};We.prototype.off=We.prototype.removeListener=We.prototype.removeAllListeners=We.prototype.removeEventListener=function(s,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+s];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+s],this};We.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+s],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,t)}return this};We.prototype.emitReserved=We.prototype.emit;We.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};We.prototype.hasListeners=function(s){return!!this.listeners(s).length};const Si=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),yt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),qc="arraybuffer";function Ua(s,...t){return t.reduce((n,i)=>(s.hasOwnProperty(i)&&(n[i]=s[i]),n),{})}const Uc=yt.setTimeout,Vc=yt.clearTimeout;function ki(s,t){t.useNativeTimers?(s.setTimeoutFn=Uc.bind(yt),s.clearTimeoutFn=Vc.bind(yt)):(s.setTimeoutFn=yt.setTimeout.bind(yt),s.clearTimeoutFn=yt.clearTimeout.bind(yt))}const Hc=1.33;function Wc(s){return typeof s=="string"?Yc(s):Math.ceil((s.byteLength||s.size)*Hc)}function Yc(s){let t=0,n=0;for(let i=0,r=s.length;i<r;i++)t=s.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function Va(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Qc(s){let t="";for(let n in s)s.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(s[n]));return t}function Gc(s){let t={},n=s.split("&");for(let i=0,r=n.length;i<r;i++){let o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}class Kc extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}}class qr extends We{constructor(t){super(),this.writable=!1,ki(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,i){return super.emitReserved("error",new Kc(t,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Or(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=Qc(t);return n.length?"?"+n:""}}class Xc extends qr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};Bc(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Fc(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Va()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Ha=!1;try{Ha=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Jc=Ha;function Zc(){}class ed extends Xc{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,n){const i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=t}}let Ts=class qn extends We{constructor(t,n,i){super(),this.createRequest=t,ki(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const n=Ua(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=qn.requestsCount++,qn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Zc,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete qn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Ts.requestsCount=0;Ts.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",fo);else if(typeof addEventListener=="function"){const s="onpagehide"in yt?"pagehide":"unload";addEventListener(s,fo,!1)}}function fo(){for(let s in Ts.requests)Ts.requests.hasOwnProperty(s)&&Ts.requests[s].abort()}const td=function(){const s=Wa({xdomain:!1});return s&&s.responseType!==null}();class sd extends ed{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=td&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Ts(Wa,this.uri(),t)}}function Wa(s){const t=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Jc))return new XMLHttpRequest}catch{}if(!t)try{return new yt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ya=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class nd extends qr{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,i=Ya?{}:Ua(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],r=n===t.length-1;zr(i,this.supportsBinary,o=>{try{this.doWrite(i,o)}catch{}r&&Si(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Va()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const _i=yt.WebSocket||yt.MozWebSocket;class id extends nd{createSocket(t,n,i){return Ya?new _i(t,n,i):n?new _i(t,n):new _i(t)}doWrite(t,n){this.ws.send(n)}}class rd extends qr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=zc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(n).getReader(),r=Mc();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();const o=()=>{i.read().then(({done:u,value:b})=>{u||(this.onPacket(b),o())}).catch(u=>{})};o();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],r=n===t.length-1;this._writer.write(i).then(()=>{r&&Si(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const od={websocket:id,webtransport:rd,polling:sd},ad=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ld=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function fr(s){if(s.length>8e3)throw"URI too long";const t=s,n=s.indexOf("["),i=s.indexOf("]");n!=-1&&i!=-1&&(s=s.substring(0,n)+s.substring(n,i).replace(/:/g,";")+s.substring(i,s.length));let r=ad.exec(s||""),o={},a=14;for(;a--;)o[ld[a]]=r[a]||"";return n!=-1&&i!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=cd(o,o.path),o.queryKey=dd(o,o.query),o}function cd(s,t){const n=/\/{2,9}/g,i=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function dd(s,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,o){r&&(n[r]=o)}),n}const gr=typeof addEventListener=="function"&&typeof removeEventListener=="function",Un=[];gr&&addEventListener("offline",()=>{Un.forEach(s=>s())},!1);class Zt extends We{constructor(t,n){if(super(),this.binaryType=qc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const i=fr(t);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=fr(n.host).host);ki(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Gc(this.opts.query)),gr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Un.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=qa,n.transport=t,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Zt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Zt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(n+=Wc(r)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Si(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,i){return this._sendPacket("message",t,n,i),this}send(t,n,i){return this._sendPacket("message",t,n,i),this}_sendPacket(t,n,i,r){if(typeof n=="function"&&(r=n,n=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const o={type:t,data:n,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(Zt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),gr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Un.indexOf(this._offlineEventListener);i!==-1&&Un.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Zt.protocol=qa;class ud extends Zt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),i=!1;Zt.priorWebsocketSuccess=!1;const r=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",g=>{if(!i)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Zt.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(S(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=n.name,this.emitReserved("upgradeError",x)}}))};function o(){i||(i=!0,S(),n.close(),n=null)}const a=g=>{const x=new Error("probe error: "+g);x.transport=n.name,o(),this.emitReserved("upgradeError",x)};function u(){a("transport closed")}function b(){a("socket closed")}function c(g){n&&g.name!==n.name&&o()}const S=()=>{n.removeListener("open",r),n.removeListener("error",a),n.removeListener("close",u),this.off("close",b),this.off("upgrading",c)};n.once("open",r),n.once("error",a),n.once("close",u),this.once("close",b),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&n.push(t[i]);return n}}let hd=class extends ud{constructor(t,n={}){const i=typeof t=="object"?t:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>od[r]).filter(r=>!!r)),super(t,i)}};function pd(s,t="",n){let i=s;n=n||typeof location<"u"&&location,s==null&&(s=n.protocol+"//"+n.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=n.protocol+s:s=n.host+s),/^(https?|wss?):\/\//.test(s)||(typeof n<"u"?s=n.protocol+"//"+s:s="https://"+s),i=fr(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+t,i.href=i.protocol+"://"+o+(n&&n.port===i.port?"":":"+i.port),i}const xd=typeof ArrayBuffer=="function",md=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Qa=Object.prototype.toString,fd=typeof Blob=="function"||typeof Blob<"u"&&Qa.call(Blob)==="[object BlobConstructor]",gd=typeof File=="function"||typeof File<"u"&&Qa.call(File)==="[object FileConstructor]";function Ur(s){return xd&&(s instanceof ArrayBuffer||md(s))||fd&&s instanceof Blob||gd&&s instanceof File}function Vn(s,t){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let n=0,i=s.length;n<i;n++)if(Vn(s[n]))return!0;return!1}if(Ur(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return Vn(s.toJSON(),!0);for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)&&Vn(s[n]))return!0;return!1}function yd(s){const t=[],n=s.data,i=s;return i.data=yr(n,t),i.attachments=t.length,{packet:i,buffers:t}}function yr(s,t){if(!s)return s;if(Ur(s)){const n={_placeholder:!0,num:t.length};return t.push(s),n}else if(Array.isArray(s)){const n=new Array(s.length);for(let i=0;i<s.length;i++)n[i]=yr(s[i],t);return n}else if(typeof s=="object"&&!(s instanceof Date)){const n={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=yr(s[i],t));return n}return s}function bd(s,t){return s.data=br(s.data,t),delete s.attachments,s}function br(s,t){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<t.length)return t[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let n=0;n<s.length;n++)s[n]=br(s[n],t);else if(typeof s=="object")for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(s[n]=br(s[n],t));return s}const jd=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],vd=5;var ye;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(ye||(ye={}));class wd{constructor(t){this.replacer=t}encode(t){return(t.type===ye.EVENT||t.type===ye.ACK)&&Vn(t)?this.encodeAsBinary({type:t.type===ye.EVENT?ye.BINARY_EVENT:ye.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===ye.BINARY_EVENT||t.type===ye.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=yd(t),i=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(i),r}}function go(s){return Object.prototype.toString.call(s)==="[object Object]"}class Vr extends We{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const i=n.type===ye.BINARY_EVENT;i||n.type===ye.BINARY_ACK?(n.type=i?ye.EVENT:ye.ACK,this.reconstructor=new Sd(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Ur(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const i={type:Number(t.charAt(0))};if(ye[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ye.BINARY_EVENT||i.type===ye.BINARY_ACK){const o=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const a=t.substring(o,n);if(a!=Number(a)||t.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(a)}if(t.charAt(n+1)==="/"){const o=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););i.nsp=t.substring(o,n)}else i.nsp="/";const r=t.charAt(n+1);if(r!==""&&Number(r)==r){const o=n+1;for(;++n;){const a=t.charAt(n);if(a==null||Number(a)!=a){--n;break}if(n===t.length)break}i.id=Number(t.substring(o,n+1))}if(t.charAt(++n)){const o=this.tryParse(t.substr(n));if(Vr.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case ye.CONNECT:return go(n);case ye.DISCONNECT:return n===void 0;case ye.CONNECT_ERROR:return typeof n=="string"||go(n);case ye.EVENT:case ye.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&jd.indexOf(n[0])===-1);case ye.ACK:case ye.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Sd{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=bd(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const kd=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Vr,Encoder:wd,get PacketType(){return ye},protocol:vd},Symbol.toStringTag,{value:"Module"}));function kt(s,t,n){return s.on(t,n),function(){s.off(t,n)}}const Cd=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ga extends We{constructor(t,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[kt(t,"open",this.onopen.bind(this)),kt(t,"packet",this.onpacket.bind(this)),kt(t,"error",this.onerror.bind(this)),kt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var i,r,o;if(Cd.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const a={type:ye.EVENT,data:n};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const S=this.ids++,g=n.pop();this._registerAckCallback(S,g),a.id=S}const u=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,b=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!u||(b?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,n){var i;const r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[t]=n;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===t&&this.sendBuffer.splice(u,1);n.call(this,new Error("operation has timed out"))},r),a=(...u)=>{this.io.clearTimeoutFn(o),n.apply(this,u)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...n){return new Promise((i,r)=>{const o=(a,u)=>a?r(a):i(u);o.withError=!0,n.push(o),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...o)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ye.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ye.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ye.EVENT:case ye.BINARY_EVENT:this.onevent(t);break;case ye.ACK:case ye.BINARY_ACK:this.onack(t);break;case ye.DISCONNECT:this.ondisconnect();break;case ye.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let i=!1;return function(...r){i||(i=!0,n.packet({type:ye.ACK,id:t,data:r}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ye.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,t.data)}}}function Bs(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Bs.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*s);s=Math.floor(t*10)&1?s+n:s-n}return Math.min(s,this.max)|0};Bs.prototype.reset=function(){this.attempts=0};Bs.prototype.setMin=function(s){this.ms=s};Bs.prototype.setMax=function(s){this.max=s};Bs.prototype.setJitter=function(s){this.jitter=s};class jr extends We{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,ki(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Bs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const r=n.parser||kd;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new hd(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=kt(n,"open",function(){i.onopen(),t&&t()}),o=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),t?t(u):this.maybeReconnectOnOpen()},a=kt(n,"error",o);if(this._timeout!==!1){const u=this._timeout,b=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),n.close()},u);this.opts.autoUnref&&b.unref(),this.subs.push(()=>{this.clearTimeoutFn(b)})}return this.subs.push(r),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(kt(t,"ping",this.onping.bind(this)),kt(t,"data",this.ondata.bind(this)),kt(t,"error",this.onerror.bind(this)),kt(t,"close",this.onclose.bind(this)),kt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Si(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Ga(this,t,n),this.nsps[t]=i),i}_destroy(t){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const qs={};function Hn(s,t){typeof s=="object"&&(t=s,s=void 0),t=t||{};const n=pd(s,t.path||"/socket.io"),i=n.source,r=n.id,o=n.path,a=qs[r]&&o in qs[r].nsps,u=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let b;return u?b=new jr(i,t):(qs[r]||(qs[r]=new jr(i,t)),b=qs[r]),n.query&&!t.query&&(t.query=n.queryKey),b.socket(n.path,t)}Object.assign(Hn,{Manager:jr,Socket:Ga,io:Hn,connect:Hn});const Id=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",Tt=Id?"https://aakardata.in/api":"http://localhost:5000/api",Ed="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class Ad{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",n=localStorage.getItem(t);n?this.init(n,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(n=>{this.triggerEvent("notification",n)})}}init(t,n=!1){var i;if(!((i=this.socket)!=null&&i.connected&&this.lastToken===t&&this.isExhibitor===n)){this.isExhibitor=n,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const r=Tt.replace("/api",""),o=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Hn(r,{auth:{token:o,type:n?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(r){console.error("Error initializing notification socket:",r),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}removeEventListener(t,n){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(i=>i!==n))}triggerEvent(t,n){this.listeners[t]&&this.listeners[t].forEach(i=>{try{i(n)}catch(r){console.error(`Error in notification ${t} listener:`,r)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",n={limit:1,page:1,unreadOnly:!0},i=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(i);if(!r)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const o=await ht.get(t,{baseURL:Tt,params:n,headers:{Authorization:`Bearer ${r}`}});return o.data&&o.data.success?(this.unreadCount=o.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,n=10,i=!1){try{const r=this.isExhibitor?"notifications/exhibitor":"notifications/admin",o={page:t,limit:n,unreadOnly:i},a=this.isExhibitor?"exhibitor_token":"token",u=localStorage.getItem(a);if(!u)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await ht.get(r,{baseURL:Tt,params:o,headers:{Authorization:`Bearer ${u}`}})).data}catch(r){return console.error("Error fetching notifications:",r),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const n=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,i=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(i);if(!r)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const o=await ht.put(n,{},{baseURL:Tt,headers:{Authorization:`Bearer ${r}`}});return o.data&&o.data.success&&(this.unreadCount=o.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),o.data}catch(n){throw console.error("Error marking notification as read:",n),n}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",n=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(n);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const r=await ht.put(t,{},{baseURL:Tt,headers:{Authorization:`Bearer ${i}`}});return r.data&&r.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),r.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const n=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,i=await ht.delete(n,{baseURL:Tt,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(i.data.success)return i.data.data.unreadCount!==void 0&&(this.unreadCount=i.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),i.data;throw new Error("Failed to delete notification")}catch(n){throw console.error("Error deleting notification:",n),n}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",n=await ht.delete(t,{baseURL:Tt,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(n.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),n.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const Te=new Ad;var He=(s=>(s.NEW_LEAD="New Lead",s.FOLLOWUP_DUE="Follow-up Due",s.STATUS_CHANGE="Status Changed",s.ASSIGNMENT="Lead Assigned",s.NEW_BOOKING="NEW_BOOKING",s.BOOKING_CONFIRMED="BOOKING_CONFIRMED",s.BOOKING_CANCELLED="BOOKING_CANCELLED",s.PAYMENT_RECEIVED="PAYMENT_RECEIVED",s.INVOICE_GENERATED="INVOICE_GENERATED",s.EXHIBITION_UPDATE="EXHIBITION_UPDATE",s.SYSTEM_MESSAGE="SYSTEM_MESSAGE",s.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",s.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",s))(He||{}),Xt=(s=>(s.HIGH="HIGH",s.MEDIUM="MEDIUM",s.LOW="LOW",s))(Xt||{}),vr=(s=>(s.READ="Read",s.UNREAD="Unread",s))(vr||{}),Ka={exports:{}};(function(s,t){(function(n,i){s.exports=i()})(Tl,function(){return function(n,i,r){n=n||{};var o=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function u(c,S,g,x){return o.fromToBase(c,S,g,x)}r.en.relativeTime=a,o.fromToBase=function(c,S,g,x,P){for(var C,v,T,j=g.$locale().relativeTime||a,N=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=N.length,d=0;d<_;d+=1){var p=N[d];p.d&&(C=x?r(c).diff(g,p.d,!0):g.diff(c,p.d,!0));var L=(n.rounding||Math.round)(Math.abs(C));if(T=C>0,L<=p.r||!p.r){L<=1&&d>0&&(p=N[d-1]);var A=j[p.l];P&&(L=P(""+L)),v=typeof A=="string"?A.replace("%d",L):A(L,S,p.l,T);break}}if(S)return v;var y=T?j.future:j.past;return typeof y=="function"?y(v):y.replace("%s",v)},o.to=function(c,S){return u(c,S,this,!0)},o.from=function(c,S){return u(c,S,this)};var b=function(c){return c.$u?r.utc():r()};o.toNow=function(c){return this.to(b(this),c)},o.fromNow=function(c){return this.from(b(this),c)}}})})(Ka);var Nd=Ka.exports;const Td=Pl(Nd);Ie.extend(Td);const yo=s=>{switch(s){case Xt.HIGH:return"#f5222d";case Xt.MEDIUM:return"#faad14";case Xt.LOW:return"#52c41a";default:return"#1677ff"}},Pd=s=>Ie(s).fromNow(),Rd=s=>Ie(s).format("YYYY-MM-DD HH:mm"),_d=s=>s.filter(t=>t.isRead===!1).length,Dd=s=>{if(!s.entityId||!s.entityType)return"/notifications";switch(s.entityType){case"lead":return`/leads/${s.entityId}`;case"followup":return`/followups/${s.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${s.entityId}`;case"Exhibition":return`/exhibition/${s.entityId}`;case"Exhibitor":return`/exhibitors?id=${s.entityId}`;default:return"/notifications"}},{Text:bo,Paragraph:Ld}=pe,Xa=({notification:s,onView:t,onMarkAsRead:n,onDelete:i})=>{const r=()=>{switch(s.type){case He.NEW_LEAD:return e.jsx(nn,{style:{color:"#1677ff"}});case He.FOLLOWUP_DUE:return e.jsx(Ze,{style:{color:"#faad14"}});case He.STATUS_CHANGE:return e.jsx(Rl,{style:{color:"#722ed1"}});case He.ASSIGNMENT:return e.jsx(Ce,{style:{color:"#52c41a"}});default:return e.jsx(Er,{style:{color:"#1677ff"}})}},o=()=>{s.isRead||n(s),t(s)},a=u=>{u.stopPropagation(),i(s)};return e.jsx(Pt.Item,{onClick:o,className:s.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:s.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[e.jsx(Ve,{title:"Delete notification",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(nt,{}),onClick:a,"aria-label":"Delete notification"})})],children:e.jsx(Pt.Item.Meta,{avatar:e.jsx(bt,{dot:!s.isRead,color:yo(s.priority),children:e.jsx(wt,{icon:r(),size:"large",style:{backgroundColor:"white",border:`1px solid ${yo(s.priority)}`}})}),title:e.jsxs(X,{children:[e.jsx(bo,{strong:!0,children:s.title}),!s.isRead&&e.jsx(re,{color:"blue",children:"New"})]}),description:e.jsxs("div",{children:[e.jsx(Ld,{ellipsis:{rows:2},style:{marginBottom:4},children:s.message}),e.jsx(Ve,{title:Rd(s.createdAt),children:e.jsx(bo,{type:"secondary",style:{fontSize:12},children:Pd(s.createdAt)})})]})})})},{Title:$d,Text:Gm}=pe,Fd=s=>{switch(s){case"NEW_BOOKING":return He.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return He.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return He.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return He.NEW_LEAD;default:return He.STATUS_CHANGE}},Bd=s=>{switch(s){case"HIGH":return Xt.HIGH;case"MEDIUM":return Xt.MEDIUM;case"LOW":return Xt.LOW;default:return Xt.MEDIUM}},Md=({isExhibitor:s=!1})=>{const t=ke(),[n,i]=h.useState([]),[r,o]=h.useState(!1),[a,u]=h.useState(!1),[b,c]=h.useState(0),[S,g]=h.useState(!1),[x,P]=h.useState("all"),C=h.useRef(null),{isAuthenticated:v,user:T}=ue(l=>l.auth),{isAuthenticated:j}=ue(l=>l.exhibitorAuth||{isAuthenticated:!1}),N=s?j:v,[_,d]=h.useState(!1);h.useEffect(()=>{if(N){const l=s?"exhibitor_token":"token",k=localStorage.getItem(l);if(k){Te.init(k,s),Te.subscribeToNotifications();const F=H=>{c(H),H>0&&!a&&(g(!0),setTimeout(()=>{g(!1)},2e3))},z=H=>{i(W=>[H,...W])},U=()=>{d(!0),p()},V=()=>{d(!1)};return Te.addEventListener("unreadCount",F),Te.addEventListener("notification",z),Te.addEventListener("connected",U),Te.addEventListener("disconnected",V),p(),()=>{Te.removeEventListener("unreadCount",F),Te.removeEventListener("notification",z),Te.removeEventListener("connected",U),Te.removeEventListener("disconnected",V),Te.unsubscribeFromNotifications()}}else console.error(`No ${s?"exhibitor":"admin"} token found in localStorage`)}},[N,s]);const p=async()=>{if(N){o(!0);try{const l=await Te.getNotifications(1,10);l.success&&(i(l.data.notifications),c(l.data.unreadCount))}catch(l){console.error("Error fetching notifications:",l)}finally{o(!1)}}},L=l=>{u(l),l&&(C.current&&C.current.classList.remove("bell-animate"),p())},A=async l=>{if(l.isRead||await y(l),u(!1),l.entityId&&l.entityType){let k="";switch(l.entityType){case"Booking":k=s?`/exhibitor/bookings/${l.entityId}`:"/bookings";break;case"Invoice":k=s?`/exhibitor/invoice/${l.entityId}`:`/invoice/${l.entityId}`;break;case"Exhibition":k=`/exhibition/${l.entityId}`;break;case"Exhibitor":k=`/exhibitors?id=${l.entityId}`;break;default:k=""}t(k||"/notifications")}else t("/notifications")},y=async l=>{try{await Te.markAsRead(l._id),i(n.map(k=>k._id===l._id?{...k,isRead:!0}:k))}catch(k){console.error("Error marking notification as read:",k)}},D=async l=>{try{await Te.deleteNotification(l._id),i(n.filter(k=>k._id!==l._id)),l.isRead||c(k=>Math.max(0,k-1))}catch(k){console.error("Error deleting notification:",k)}},f=()=>{u(!1),t("/notifications")},w=async()=>{try{await Te.markAllAsRead(),i(n.map(l=>({...l,isRead:!0}))),c(0)}catch(l){console.error("Error marking all notifications as read:",l)}},I=async()=>{try{await Te.deleteAllNotifications(),i([]),c(0)}catch(l){console.error("Error deleting all notifications:",l)}},R=()=>x==="unread"?n.filter(l=>!l.isRead):n.slice(0,10),m=l=>{P(l)},M=l=>{var k;return{_id:l._id,recipient:l.recipient,recipientType:l.recipientType||"admin",title:l.title,message:l.message,type:Fd(l.type),priority:Bd(l.priority),isRead:l.isRead,readAt:l.readAt,entityId:l.entityId,entityType:l.entityType,data:l.data,createdAt:l.createdAt,updatedAt:l.updatedAt||l.createdAt,id:l._id,userId:l.recipient,source:(k=l.data)==null?void 0:k.source,status:l.isRead?vr.READ:vr.UNREAD}},E=e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx($d,{level:5,style:{margin:0},children:"Notifications"}),e.jsxs(X,{children:[e.jsx(O,{type:"text",size:"small",icon:e.jsx(bi,{}),onClick:p,loading:r,className:"header-btn",title:"Refresh notifications"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(Ar,{}),onClick:w,disabled:b===0,className:"header-btn",title:"Mark all as read"}),e.jsx(O,{type:"text",size:"small",danger:!0,icon:e.jsx(nt,{}),onClick:I,disabled:n.length===0,className:"header-btn",title:"Clear all notifications"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(ci,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),e.jsx(O,{type:"text",size:"small",icon:e.jsx(Et,{}),onClick:()=>u(!1),className:"header-btn",title:"Close"})]})]}),e.jsx(dt,{activeKey:x,onChange:m,size:"small",className:"notification-tabs",items:[{key:"all",label:e.jsx("span",{children:"All"})},{key:"unread",label:e.jsxs("span",{className:"tab-label",children:["Unread",e.jsx(bt,{count:b,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),e.jsx("div",{className:"notification-list",children:e.jsx(Bt,{spinning:r,children:R().length===0?e.jsx(Xe,{image:Xe.PRESENTED_IMAGE_SIMPLE,description:x==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):e.jsx(Pt,{dataSource:R(),renderItem:l=>e.jsx(Xa,{notification:M(l),onView:()=>A(l),onMarkAsRead:()=>y(l),onDelete:D})})})}),e.jsx(Ee,{style:{margin:"0"}}),e.jsx("div",{className:"notification-footer",children:e.jsx(O,{type:"link",onClick:f,children:"View All Notifications"})})]});return e.jsx("div",{ref:C,className:`bell-container ${S?"bell-animate":""}`,children:e.jsx(ms,{overlay:E,trigger:["click"],open:a,onOpenChange:L,placement:"bottomRight",getPopupContainer:l=>l.parentNode,overlayClassName:"notification-dropdown-overlay",children:e.jsx(bt,{count:b,offset:[-2,10],size:"small",children:e.jsx(Er,{className:"notification-bell-icon"})})})})};class zd{async getSettings(){return(await ne.get("/settings")).data}async updateSettings(t){return(await ne.put("/settings",t)).data}async uploadLogo(t){const n=new FormData;return n.append("file",t),(await ne.post("/settings/upload/logo",n,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Hr=new zd,Od={settings:null,loading:!1,error:null},Js=je("settings/fetchSettings",async(s,{rejectWithValue:t})=>{var n,i;try{return await Hr.getSettings()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch settings")}}),Zs=je("settings/updateSettings",async(s,{rejectWithValue:t})=>{var n,i;try{return await Hr.updateSettings(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to update settings")}}),Wn=je("settings/uploadLogo",async(s,{dispatch:t,rejectWithValue:n})=>{var i,r;try{const o=await Hr.uploadLogo(s);return o.path&&await t(Zs({logo:o.path})),o}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to upload logo")}}),qd=at({name:"settings",initialState:Od,reducers:{},extraReducers:s=>{s.addCase(Js.pending,t=>{t.loading=!0,t.error=null}).addCase(Js.fulfilled,(t,n)=>{t.settings=n.payload,t.loading=!1}).addCase(Js.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Zs.pending,t=>{t.loading=!0,t.error=null}).addCase(Zs.fulfilled,(t,n)=>{t.settings=n.payload,t.loading=!1}).addCase(Zs.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Wn.pending,t=>{t.loading=!0,t.error=null}).addCase(Wn.fulfilled,t=>{t.loading=!1}).addCase(Wn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),Ud=qd.reducer,Vd=()=>{const{user:s}=ue(n=>n.auth),t=n=>{if(!s||!s.role||!s.role.permissions)return!1;const i=s.role.permissions;if(i.includes(n)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access")||i.includes("manage_all"))return!0;const r=n.split("_");if(r.length===2){const o=r[0],a=r[1],u=[`${o}.*`,`*.${a}`,`view_${o}`,`${o}_view`,`${o}s_${a}`,`${a}_${o}`,`${o}`,`${a}`,o.endsWith("s")?`${o.slice(0,-1)}_${a}`:`${o}s_${a}`,`${o}_${a==="view"?"read":a}`,`${a==="view"?"read":a}_${o}`];for(const b of u)if(i.includes(b))return!0}return!1};return{hasPermission:t,hasAnyPermission:n=>n.some(i=>t(i)),hasAllPermissions:n=>n.every(i=>t(i))}},{Header:Hd,Sider:Wd,Content:Yd}=Fe,Qd=J.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,Gd=J.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,Kd=J.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;J.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const ze=({children:s})=>{const[t,n]=h.useState(!1),i=ke(),r=Ae(),o=Qt(),a=ue(p=>p.auth.user),{settings:u}=ue(p=>p.settings),[b,c]=h.useState("/logo.png"),[S,g]=h.useState(!1),{hasPermission:x}=Vd(),P=h.useCallback(async()=>{try{g(!0),await r(zn()).unwrap()}catch{}finally{g(!1)}},[r]);h.useEffect(()=>{const p=setInterval(()=>{P()},3e5);return()=>clearInterval(p)},[P]),h.useEffect(()=>{P()},[o.pathname,P]),h.useEffect(()=>{},[a,x]),h.useEffect(()=>{r(Js())},[r]);const C=[{key:"dashboard",icon:e.jsx(ui,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>i("/dashboard")},{key:"exhibition",icon:e.jsx(Nr,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>i("/exhibition")},{key:"stalls",icon:e.jsx(ct,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>i("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>i("/stall-types")}]},{key:"bookings",icon:e.jsx(_e,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>i("/bookings")},{key:"exhibitors",icon:e.jsx(Tr,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>i("/exhibitors")},{key:"index",icon:e.jsx(Ce,{}),label:"Users",requiredPermission:"users_view",onClick:()=>i("/index")},{key:"roles",icon:e.jsx(_l,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>i("/roles")},{key:"settings",icon:e.jsx(ci,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>i("/settings")}],v=p=>p.filter(L=>{if(L.requiredPermission&&!x(L.requiredPermission))return!1;if(L.children){const A=v(L.children);if(A.length===0)return!1;L.children=A}return!0}),T=v(C),j=p=>p.map(L=>{const{requiredPermission:A,...y}=L;return y.children&&(y.children=j(y.children)),y}),N=j(T);h.useEffect(()=>{const p={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},L=o.pathname.substring(1)||"dashboard",A=p[L];if(A&&!x(A)){const y=T.length>0?T[0]:null;y?i(`/${y.key}`):(r(ho()),i("/login"))}},[o.pathname,x,T,i,r]),h.useEffect(()=>{const p=localStorage.getItem("cachedLogoUrl"),L=localStorage.getItem("logoTimestamp"),A=new Date().getTime();if(p&&L&&A-parseInt(L)<36e5)c(p);else if(u!=null&&u.logo){const y=`${ne.defaults.baseURL}/public/logo`;c(y),localStorage.setItem("cachedLogoUrl",y),localStorage.setItem("logoTimestamp",A.toString());const D=new Image;D.src=y}},[u]);const _=[{key:"profile",label:"Profile",icon:e.jsx(Ce,{}),onClick:()=>i("/account")},{key:"settings",label:"Settings",icon:e.jsx(ci,{}),onClick:()=>i("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(di,{}),onClick:()=>{r(ho()),i("/login")}}],d=()=>{const p=o.pathname.substring(1);return p.charAt(0).toUpperCase()+p.slice(1)};return e.jsxs(Fe,{style:{minHeight:"100vh"},children:[e.jsxs(Wd,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsx(Qd,{children:e.jsx(Gd,{children:e.jsx(Kd,{src:b,alt:"Logo",onError:()=>c("/logo.png")})})}),e.jsx(jt,{mode:"inline",selectedKeys:[o.pathname.substring(1)||"dashboard"],items:N,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),e.jsxs(Fe,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[e.jsxs(Hd,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(O,{type:"text",icon:t?e.jsx(ja,{}):e.jsx(va,{}),onClick:()=>n(!t),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:d()})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{marginRight:20},children:e.jsx(Md,{isExhibitor:!1})}),e.jsx(ms,{menu:{items:_},placement:"bottomRight",children:e.jsxs(X,{align:"center",style:{cursor:"pointer"},children:[e.jsx(wt,{size:"small",icon:e.jsx(Ce,{}),style:{backgroundColor:"#5046e5"}}),e.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(a==null?void 0:a.username)||"User"})]})})]})]}),e.jsx(Yd,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:s})]})]})},jo=localStorage.getItem("exhibitor_token"),Xd=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,Jd={isAuthenticated:!!jo,exhibitor:Xd,token:jo,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},Ja=at({name:"exhibitorAuth",initialState:Jd,reducers:{setExhibitorCredentials:(s,t)=>{s.exhibitor=t.payload.exhibitor,s.token=t.payload.token,s.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:s=>{s.exhibitor=null,s.token=null,s.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(s,t)=>{s.showLoginModal=!0,s.showForgotPasswordModal=!1,s.loginContext=t.payload||null},hideLoginModal:s=>{s.showLoginModal=!1,s.loginContext=null},showForgotPasswordModal:s=>{s.showForgotPasswordModal=!0,s.showLoginModal=!1},hideForgotPasswordModal:s=>{s.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:wr,exhibitorLogout:Za,showLoginModal:xs,hideLoginModal:jn,showForgotPasswordModal:Zd,hideForgotPasswordModal:Di}=Ja.actions,eu=Ja.reducer,{Header:tu,Sider:su,Content:nu}=Fe,ys=({children:s})=>{var g;const[t,n]=h.useState(!1),i=ke(),r=Ae(),o=Qt(),a=ue(x=>x.exhibitorAuth.exhibitor),u=()=>{const x=o.pathname;return x.includes("/exhibitor/dashboard")?"dashboard":x.includes("/exhibitor/bookings")?"bookings":x.includes("/exhibitor/profile")?"profile":x.includes("/exhibitions")?"exhibitions":x.includes("/exhibitor/support")?"help":"dashboard"},b=[{key:"dashboard",icon:e.jsx(ui,{}),label:"Dashboard",onClick:()=>i("/exhibitor/dashboard")},{key:"bookings",icon:e.jsx(ct,{}),label:"My Bookings",onClick:()=>i("/exhibitor/bookings")},{key:"profile",icon:e.jsx(Ce,{}),label:"My Profile",onClick:()=>i("/exhibitor/profile")},{key:"exhibitions",icon:e.jsx(es,{}),label:"Exhibitions",onClick:()=>i("/exhibitions")},{key:"help",icon:e.jsx(Dl,{}),label:"Help & Support",onClick:()=>i("/exhibitor/support")}],c=[{key:"profile",label:"My Profile",icon:e.jsx(Ce,{}),onClick:()=>i("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:e.jsx(ct,{}),onClick:()=>i("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:e.jsx(di,{}),onClick:()=>{r(Za()),i("/")}}],S=()=>{const x=o.pathname.replace("/exhibitor/","");return x==="dashboard"?"Dashboard":x.startsWith("bookings")?x.includes("/")?"Booking Details":"My Bookings":x==="profile"?"My Profile":x==="support"?"Help & Support":x.charAt(0).toUpperCase()+x.slice(1)};return e.jsxs(Fe,{style:{minHeight:"100vh"},children:[e.jsxs(su,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[e.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[e.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&e.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),e.jsx(jt,{mode:"inline",selectedKeys:[u()],items:b,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),e.jsxs(Fe,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[e.jsxs(tu,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(O,{type:"text",icon:t?e.jsx(ja,{}):e.jsx(va,{}),onClick:()=>n(!t),style:{fontSize:16}}),e.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:S()})]}),e.jsx(ms,{menu:{items:c},placement:"bottomRight",children:e.jsxs(X,{align:"center",style:{cursor:"pointer"},children:[e.jsx(wt,{size:"small",style:{backgroundColor:"#5046e5"},children:((g=a==null?void 0:a.companyName)==null?void 0:g.charAt(0).toUpperCase())||"E"}),e.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(a==null?void 0:a.companyName)||"Exhibitor"})]})})]}),e.jsx(nu,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:s})]})]})},{Title:el,Text:Us,Paragraph:iu}=pe,mn=ss`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,ru=ss`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,ou=ss`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Wr=ss`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,tl=ss`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,au=ss`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,lu=ss`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,cu=ss`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,du=J.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,uu=J.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${ru} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,hu=J.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${s=>.1+s.index%3*.05}), transparent);
  left: ${s=>20+s.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${s=>s.isHovered?au:lu} ${s=>1.5+s.index*.2}s ease-out;
  animation-delay: ${s=>s.index*.1}s;
  animation-fill-mode: forwards;
`,pu=J.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${ou} 0.8s ease-out forwards;
`,xu=J.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,mu=J.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${cu} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Wr} 2s ease-in-out infinite;
  }
`,fu=J.span`
  margin-left: 10px;
  animation: ${mn} 0.5s ease-out;
`,gu=J.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,yu=J.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,bu=J.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${mn} 0.8s ease-out forwards;
`,ju=J.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,vu=J.img`
  width: 140px;
  height: auto;
  animation: ${tl} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;J.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const wu=J.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${mn} 0.8s ease-out forwards;
`,Su=J.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,ku=J(el)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,Cu=J(iu)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,Iu=J.div`
  width: 100%;
  max-width: 400px;
  animation: ${mn} 0.6s ease-out;
`,Eu=J(G)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Au=J(G.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,Nu=J(O)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Wr} 0.5s ease-in-out;
  }
`,Tu=J.div`
  margin-bottom: 2rem;
  text-align: center;
`,vn=J($.Item)`
  margin-bottom: 24px;
`,Pu=J.div`
  margin-top: 8px;
`,Ru=J.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,_u=J(ur)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,Du=J.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${mn} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Wr} 0.5s ease-in-out;
  }
`,vo=()=>e.jsxs(xu,{children:[e.jsxs(mu,{viewBox:"0 0 50 50",children:[e.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),e.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),e.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),e.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),e.jsx(fu,{children:"Signing in..."})]}),Lu=J.div`
  position: absolute;
  width: ${s=>s.size}px;
  height: ${s=>s.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${tl} ${s=>s.duration}s ease-in-out infinite;
  animation-delay: ${s=>s.delay}s;
  top: ${s=>s.top}%;
  left: ${s=>s.left}%;
  z-index: 1;
`,$u=s=>{if(!s)return 0;const t=s.length>=8,n=/[A-Z]/.test(s),i=/[a-z]/.test(s),r=/\d/.test(s),o=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(s),a=[t,n,i,r,o];return a.filter(b=>b).length/a.length*100},Fu=s=>s<30?"#ff4d4f":s<60?"#faad14":s<80?"#1890ff":"#52c41a",Bu=s=>s<30?"Weak":s<60?"Fair":s<80?"Good":"Strong",Mu=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],zu=()=>{const s=ke(),t=Ae(),[n,i]=h.useState(null),[r,o]=h.useState(!1),[a,u]=h.useState(!1),[b,c]=h.useState(""),[S,g]=h.useState(!1),x=ue(l=>l.auth.isAuthenticated),P=h.useRef(null),[C,v]=h.useState({x:0,y:0}),[T,j]=h.useState(!1),[N,_]=h.useState(!1),[d]=$.useForm(),[p,L]=h.useState("/logo.png"),[A,y]=h.useState("EXHIBITION MANAGER");h.useEffect(()=>{const l=localStorage.getItem("cachedLogoUrl"),k=localStorage.getItem("logoTimestamp"),F=new Date().getTime();if(l&&k&&F-parseInt(k)<36e5)L(l);else{const z=`${ne.defaults.baseURL}/public/logo`;L(z),localStorage.setItem("cachedLogoUrl",z),localStorage.setItem("logoTimestamp",F.toString());const U=new Image;U.src=z}fetch(`${ne.defaults.baseURL}/public/site-info`).then(z=>z.json()).then(z=>{z.siteName&&y(z.siteName)}).catch(z=>{console.error("Error fetching site info:",z)})},[]),h.useEffect(()=>{const l=localStorage.getItem("rememberedUser");if(l)try{const k=JSON.parse(l);d.setFieldsValue({username:k.username,password:k.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[d]),h.useEffect(()=>{const l=setTimeout(()=>{j(!0)},100);return()=>clearTimeout(l)},[]),h.useEffect(()=>{x&&s("/dashboard")},[x,s]),h.useEffect(()=>{const l=k=>{if(P.current){const F=P.current.getBoundingClientRect(),z=k.clientX-F.left,U=k.clientY-F.top;z>=0&&z<=F.width&&U>=0&&U<=F.height&&v({x:z,y:U})}};return window.addEventListener("mousemove",l),()=>{window.removeEventListener("mousemove",l)}},[]);const D=async l=>{var k;try{i(null),o(!0);const F=await mi.login({username:l.username,password:l.password}),{user:z,token:U}=F.data;if(!z||!U)throw new Error("Invalid response from server");l.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:l.username,password:l.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),u(!0),setTimeout(()=>{t($a({user:z,token:U})),ee.success("Login successful!"),s("/dashboard")},1200)}catch(F){console.error("Login Error:",F),console.error("Response Data:",(k=F.response)==null?void 0:k.data);let z="Authentication Error",U="Invalid username or password.";if(F.response&&typeof F.response=="object"){const{status:V,data:H}=F.response;V===401?(z="Invalid Credentials",U="The username or password you entered is incorrect."):V===403?(z="Access Denied",U="You do not have permission to access this resource."):V===400?(z="Invalid Request",U="Please check your input and try again."):V===500&&(z="Server Error",U="A server error occurred. Please try again later."),H&&typeof H=="object"&&H.message&&(U=H.message)}else F.request?(z="Connection Error",U="Unable to connect to the server. Please check your internet connection."):F.message&&(U=F.message);i({title:z,message:U})}finally{o(!1)}},f=$u(b),w=Fu(f),I=Bu(f),R=localStorage.getItem("rememberUser")==="true";if(x)return e.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[e.jsx(vo,{}),e.jsx(Us,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const m=l=>{const k=[];for(let F=0;F<l;F++){const z=Math.random()*20+8,U=Math.random()*3,V=Math.random()*10+6,H=Math.random()*100,W=Math.random()*100;k.push(e.jsx(Lu,{size:z,delay:U,duration:V,top:H,left:W,style:{transform:`translate(${C.x/50*(F%5-2)}px, ${C.y/50*(F%5-2)}px)`,opacity:N?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},F))}return k},M=l=>{const k=[];for(let F=0;F<l;F++)k.push(e.jsx(hu,{index:F,isHovered:N},F));return k},E=l=>{_(l)};return e.jsxs(du,{style:{opacity:T?1:0,transition:"opacity 0.3s ease-out"},children:[a&&e.jsx(Du,{children:e.jsx(Pr,{})}),e.jsxs(uu,{onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),children:[e.jsx(bu,{children:e.jsx(ju,{children:e.jsx(vu,{src:p,alt:"Exhibition Manager Logo",onError:()=>L("/logo.png")})})}),e.jsxs(gu,{ref:P,children:[m(12),M(8)]}),e.jsxs(yu,{children:[e.jsx(wu,{children:e.jsx(Su,{children:A})}),e.jsx(ku,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),e.jsx(Cu,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),e.jsx(pu,{children:e.jsxs(Iu,{children:[e.jsxs(Tu,{children:[e.jsx(el,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),e.jsx(Us,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),n&&e.jsx(qe,{message:n.title,description:n.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:e.jsx(O,{size:"small",type:"text",onClick:()=>i(null),children:"Dismiss"})}),e.jsxs($,{form:d,name:"login",initialValues:{remember:R},onFinish:D,layout:"vertical",children:[e.jsx(vn,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:e.jsx(Eu,{prefix:e.jsx(Ce,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:r,autoComplete:"username"})}),e.jsx(vn,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:S&&e.jsxs(Pu,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx(Us,{type:"secondary",children:"Password Strength:"}),e.jsx(Us,{strong:!0,style:{color:w},children:I})]}),e.jsx(Jt,{percent:f,showInfo:!1,strokeColor:w,size:"small"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(Ve,{title:e.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Mu.map((l,k)=>e.jsx("li",{children:l},k))}),children:e.jsxs(Us,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[e.jsx(Ls,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:e.jsx(Au,{prefix:e.jsx(Ht,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:r,autoComplete:"current-password",onChange:l=>c(l.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1)})}),e.jsx(Ru,{children:e.jsx(vn,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(_u,{children:"Remember me"})})}),e.jsx(vn,{children:r?e.jsx(vo,{}):e.jsx(Nu,{type:"primary",htmlType:"submit",block:!0,className:a?"success":"",children:"Sign in"})})]})]})})]})},{Title:Ou,Text:Je}=pe,qu=({title:s,value:t,icon:n,color:i,gradient:r})=>e.jsxs(K,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:r,border:"none",overflow:"hidden",position:"relative"},children:[e.jsx("div",{className:"stat-card-background"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx(Je,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:s}),e.jsx(Je,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:t})]}),e.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:n})]})]}),Uu=()=>{const s=[{title:"Total Users",value:"1,128",icon:e.jsx(Ce,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:"93",icon:e.jsx(hr,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:"15,600.00",icon:e.jsx(hi,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Reports",value:"24",icon:e.jsx(eo,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(Ou,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),e.jsx(ie,{gutter:[24,24],children:s.map((t,n)=>e.jsx(B,{xs:24,sm:12,lg:6,children:e.jsx(qu,{...t})},n))}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(B,{xs:24,lg:12,children:e.jsx(K,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"activity-item",children:[e.jsx(Ce,{style:{color:"#7C3AED"}}),e.jsxs(Je,{children:["User ",e.jsx(Je,{strong:!0,children:"'john_doe'"})," logged in"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(hr,{style:{color:"#2563EB"}}),e.jsxs(Je,{children:["New order ",e.jsx(Je,{strong:!0,children:"#12345"})," received"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(eo,{style:{color:"#059669"}}),e.jsxs(Je,{children:["Product ",e.jsx(Je,{strong:!0,children:"'Widget X'"})," updated"]})]}),e.jsxs("div",{className:"activity-item",children:[e.jsx(Ce,{style:{color:"#DC2626"}}),e.jsxs(Je,{children:["New user registration: ",e.jsx(Je,{strong:!0,children:"'jane_smith'"})]})]})]})})}),e.jsx(B,{xs:24,lg:12,children:e.jsx(K,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator online"}),e.jsxs(Je,{children:["Server Status: ",e.jsx(Je,{strong:!0,type:"success",children:"Online"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator connected"}),e.jsxs(Je,{children:["Database Status: ",e.jsx(Je,{strong:!0,type:"success",children:"Connected"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator backup"}),e.jsxs(Je,{children:["Last Backup: ",e.jsx(Je,{strong:!0,children:"2 hours ago"})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator normal"}),e.jsxs(Je,{children:["System Load: ",e.jsx(Je,{strong:!0,children:"Normal"})]})]})]})})})]})]})},xt={getExhibitions:()=>is.get("/public/exhibitions"),getExhibition:s=>is.get(`/public/exhibitions/${s}`),getLayout:s=>is.get(`/public/exhibitions/${s}/layout`),getStallDetails:(s,t)=>is.get(`/public/exhibitions/${s}/stalls/${t}`),bookStall:(s,t,n)=>is.post(`/public/exhibitions/${s}/stalls/${t}/book`,n),bookMultipleStalls:(s,t)=>is.post(`/public/exhibitions/${s}/stalls/book-multiple`,t),searchExhibitors:s=>is.get("/public/exhibitors/search",{params:{query:s}}),exhibitorBookStalls:s=>ne.post(`/exhibitor-bookings/${s.exhibitionId}`,s),getExhibitorBookings:()=>ne.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:s=>ne.get(`/exhibitor-bookings/${s}`),cancelExhibitorBooking:s=>ne.patch(`/exhibitor-bookings/${s}/cancel`),getExhibitorBookingInvoice:s=>ne.get(`/exhibitor-bookings/${s}/invoice`)},{Title:Vu,Text:Ot,Paragraph:Km}=pe,Hu=()=>{const[s,t]=h.useState([]),[n,i]=h.useState(!0),[r,o]=h.useState(null),[a,u]=h.useState([]),[b,c]=h.useState(!0),S=ue(d=>d.exhibitorAuth.exhibitor),g=ke();h.useEffect(()=>{x(),P()},[]);const x=async()=>{try{i(!0),o(null);const d=await xt.getExhibitorBookings();t(d.data||[])}catch(d){console.error("Failed to fetch bookings:",d),o("Unable to load your bookings at this time. Please try again later.")}finally{i(!1)}},P=async()=>{try{c(!0);const d=await xt.getExhibitions(),p=Ie(),L=(d.data||[]).filter(A=>A.isActive&&Ie(A.endDate).isAfter(p)).slice(0,3);u(L)}catch(d){console.error("Failed to fetch upcoming exhibitions:",d)}finally{c(!1)}},C=s.filter(d=>d.status==="approved").length,v=s.filter(d=>d.status==="pending").length;s.filter(d=>d.status==="rejected").length;const T=s.filter(d=>d.status==="confirmed").length,j=d=>{switch(d){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx(_e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ze,{})," Pending"]});case"rejected":return e.jsxs(re,{color:"error",children:[e.jsx(Et,{})," Rejected"]});case"confirmed":return e.jsxs(re,{color:"blue",children:[e.jsx(_e,{})," Confirmed"]});case"cancelled":return e.jsxs(re,{color:"default",children:[e.jsx(Et,{})," Cancelled"]});default:return e.jsx(re,{children:"Unknown"})}},N=d=>{g(`/exhibitor/invoice/${d}`)},_=(d,p)=>d.status===p;return e.jsxs("div",{children:[e.jsxs(Vu,{level:2,children:["Welcome, ",(S==null?void 0:S.companyName)||"Exhibitor"]}),e.jsx(Ot,{type:"secondary",children:"Here's an overview of your exhibition activities"}),r&&e.jsx(qe,{message:"Error",description:r,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),v>0&&e.jsx(qe,{message:"Pending Approvals",description:`You have ${v} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(O,{size:"small",type:"primary",onClick:()=>g("/exhibitor/bookings"),children:"View Bookings"})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:24},children:[e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Total Bookings",value:n?"-":s.length,prefix:e.jsx(ct,{}),loading:n})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Confirmed",value:n?"-":T,valueStyle:{color:"#1890ff"},prefix:e.jsx(_e,{}),loading:n})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Approved",value:n?"-":C,valueStyle:{color:"#3f8600"},prefix:e.jsx(_e,{}),loading:n})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Pending",value:n?"-":v,valueStyle:{color:"#faad14"},prefix:e.jsx(Ze,{}),loading:n})})})]}),e.jsx(K,{title:"Recent Bookings",extra:e.jsx(pt,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:n,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:3}}):s.length>0?e.jsx(Pt,{dataSource:s.slice(0,5),renderItem:d=>{var p,L,A,y,D;return e.jsxs(Pt.Item,{actions:[e.jsx(O,{type:"link",onClick:()=>g(`/exhibitor/bookings/${d._id}`),children:"View Details"},"view"),_(d,"approved")||_(d,"confirmed")?e.jsx(O,{type:"link",icon:e.jsx(Rr,{}),onClick:()=>N(d._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[e.jsx(Pt.Item.Meta,{title:e.jsxs("div",{children:[e.jsx(Ot,{strong:!0,children:((p=d.exhibitionId)==null?void 0:p.name)||"Exhibition"}),e.jsxs(Ot,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((L=d.stallIds)==null?void 0:L.map(f=>f.number).join(", "))||"N/A"]})]}),description:e.jsxs(X,{direction:"vertical",size:1,children:[e.jsxs("div",{children:[e.jsxs(Ot,{children:["Booked on: ",Ie(d.createdAt).format("MMM D, YYYY")]}),e.jsx(Ee,{type:"vertical"}),e.jsxs(Ot,{children:["Amount: ",((A=d.amount)==null?void 0:A.toLocaleString())||"N/A"]})]}),e.jsx("div",{children:e.jsxs(Ot,{children:["Exhibition date: ",Ie((y=d.exhibitionId)==null?void 0:y.startDate).format("MMM D")," - ",Ie((D=d.exhibitionId)==null?void 0:D.endDate).format("MMM D, YYYY")]})})]})}),j(d.status)]})}}):e.jsx(Xe,{description:"No bookings found",image:Xe.PRESENTED_IMAGE_SIMPLE})}),e.jsx(K,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:b,extra:e.jsx(pt,{to:"/exhibitions",children:"View All"}),children:b?e.jsx(Rt,{active:!0,paragraph:{rows:3}}):a.length>0?e.jsx(Pt,{dataSource:a,renderItem:d=>e.jsx(Pt.Item,{actions:[e.jsx(O,{type:"primary",onClick:()=>g(`/exhibitions/${d._id}/layout`),children:"Book Stall"},"book")],children:e.jsx(Pt.Item.Meta,{title:d.name,description:e.jsxs(X,{direction:"vertical",size:1,children:[e.jsx(Ot,{children:d.venue}),e.jsxs(Ot,{type:"secondary",children:[Ie(d.startDate).format("MMM D")," - ",Ie(d.endDate).format("MMM D, YYYY")]})]})})})}):e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(es,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs("div",{children:[e.jsx(Ot,{children:"No upcoming exhibitions at the moment"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(pt,{to:"/exhibitions",children:e.jsx(O,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),e.jsx(ie,{gutter:[24,24],style:{marginTop:24},children:e.jsx(B,{span:24,children:e.jsx(K,{title:"Quick Actions",children:e.jsxs(ie,{gutter:[16,16],children:[e.jsx(B,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{type:"primary",icon:e.jsx(ct,{}),block:!0,onClick:()=>g("/exhibitions"),children:"Book New Stall"})}),e.jsx(B,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(es,{}),block:!0,onClick:()=>g("/exhibitor/bookings"),children:"View All Bookings"})}),e.jsx(B,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(hi,{}),block:!0,onClick:()=>g("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),e.jsx(B,{xs:24,sm:12,md:8,lg:6,children:e.jsx(O,{icon:e.jsx(Ce,{}),block:!0,onClick:()=>g("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},{Title:Wu,Text:Gt}=pe,{Option:Xm}=ae,{TabPane:bs}=dt,{confirm:Yu}=ge,{Search:Qu}=G,Gu=()=>{const[s,t]=h.useState([]),[n,i]=h.useState(!0),[r,o]=h.useState(null),[a,u]=h.useState(""),[b,c]=h.useState("all"),S=ke(),g=Qt();h.useEffect(()=>{x()},[]),h.useEffect(()=>{const w=new URLSearchParams(g.search).get("status");w&&c(w)},[g]);const x=async()=>{try{i(!0),o(null);const f=await xt.getExhibitorBookings();t(f.data||[])}catch(f){console.error("Error fetching bookings:",f),o("Failed to load bookings. Please try again.")}finally{i(!1)}},P=f=>{Yu({title:"Are you sure you want to cancel this booking?",icon:e.jsx($s,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await xt.cancelExhibitorBooking(f),ee.success("Booking cancelled successfully"),x()}catch(w){console.error("Error cancelling booking:",w),ee.error("Failed to cancel booking")}}})},C=f=>{switch(f){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx(_e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ze,{})," Pending"]});case"rejected":return e.jsxs(re,{color:"error",children:[e.jsx(Et,{})," Rejected"]});case"confirmed":return e.jsxs(re,{color:"blue",children:[e.jsx(_e,{})," Confirmed"]});case"cancelled":return e.jsxs(re,{color:"default",children:[e.jsx(Et,{})," Cancelled"]});default:return e.jsx(re,{children:"Unknown"})}},v=f=>{switch(f){case"paid":return e.jsxs(re,{color:"success",children:[e.jsx(hi,{})," Paid"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ze,{})," Pending"]});case"refunded":return e.jsxs(re,{color:"default",children:[e.jsx(hi,{})," Refunded"]});default:return e.jsx(re,{children:"Unknown"})}},T=async f=>{try{S(`/exhibitor/invoice/${f}`)}catch(w){console.error("Error navigating to invoice:",w),ee.error("Failed to access invoice. Please try again.")}},j=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(f,w)=>{var I,R;return e.jsxs(X,{direction:"vertical",size:0,children:[e.jsx(Gt,{strong:!0,children:((I=w.exhibitionId)==null?void 0:I.name)||"N/A"}),e.jsx(Gt,{type:"secondary",style:{fontSize:"12px"},children:((R=w.exhibitionId)==null?void 0:R.venue)||"N/A"})]})},sorter:(f,w)=>{var I,R;return(((I=f.exhibitionId)==null?void 0:I.name)||"").localeCompare(((R=w.exhibitionId)==null?void 0:R.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:f=>e.jsx(X,{direction:"vertical",size:4,children:(f==null?void 0:f.map(w=>e.jsx(re,{children:w.number},w._id)))||"N/A"})},{title:"Type",key:"stallType",render:(f,w)=>{var I;return e.jsx(X,{direction:"vertical",size:4,children:((I=w.stallIds)==null?void 0:I.map(R=>{var m;return(m=R.stallTypeId)!=null&&m.name?e.jsx(re,{color:"blue",children:R.stallTypeId.name},R._id):e.jsx(Gt,{type:"secondary",children:"N/A"},R._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(f,w)=>{var I;return e.jsx(X,{direction:"vertical",size:4,children:((I=w.stallIds)==null?void 0:I.map(R=>e.jsxs(Gt,{children:[R.dimensions.width,"m x ",R.dimensions.height,"m"]},R._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(f,w)=>{var I,R;return e.jsxs(X,{direction:"vertical",size:0,children:[e.jsxs(Gt,{children:[e.jsx(Ct,{style:{marginRight:4}}),Ie((I=w.exhibitionId)==null?void 0:I.startDate).format("MMM D")," - ",Ie((R=w.exhibitionId)==null?void 0:R.endDate).format("MMM D, YYYY")]}),e.jsxs(Gt,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",Ie(w.createdAt).format("MMM D, YYYY")]})]})},sorter:(f,w)=>Ie(f.createdAt).unix()-Ie(w.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:f=>e.jsxs(Gt,{strong:!0,children:["",f.toLocaleString()]}),sorter:(f,w)=>f.amount-w.amount},{title:"Status",key:"status",dataIndex:"status",render:(f,w)=>f==="rejected"&&w.rejectionReason?e.jsxs(Ve,{title:w.rejectionReason,children:[C(f),e.jsx(Ls,{style:{marginLeft:4,color:"#ff4d4f"}})]}):C(f),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(f,w)=>w.status===f},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:f=>v(f),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(f,w)=>w.paymentStatus===f},{title:"Actions",key:"actions",render:(f,w)=>e.jsxs(X,{children:[e.jsx(O,{type:"link",icon:e.jsx(Wt,{}),onClick:()=>S(`/exhibitor/bookings/${w._id}`),children:"Details"}),(w.status==="approved"||w.status==="confirmed")&&e.jsx(O,{type:"link",icon:e.jsx(Rr,{}),onClick:()=>T(w._id),children:"Invoice"}),w.status==="pending"&&e.jsx(O,{type:"link",danger:!0,onClick:()=>P(w._id),children:"Cancel"})]})}],N=f=>{u(f)},_=s.filter(f=>{var R,m;const w=(((R=f.exhibitionId)==null?void 0:R.name)||"").toLowerCase().includes(a.toLowerCase())||f.stallIds.some(M=>M.number.toLowerCase().includes(a.toLowerCase()))||(((m=f.exhibitionId)==null?void 0:m.venue)||"").toLowerCase().includes(a.toLowerCase())||(f.customerName||"").toLowerCase().includes(a.toLowerCase()),I=b==="all"||f.status===b;return w&&I}),d=()=>s.length,p=()=>s.filter(f=>f.status==="pending").length,L=()=>s.filter(f=>f.status==="approved").length,A=()=>s.filter(f=>f.status==="confirmed").length,y=()=>s.filter(f=>f.status==="rejected").length,D=()=>s.filter(f=>f.status==="cancelled").length;return e.jsxs("div",{children:[e.jsx(Wu,{level:2,children:"My Bookings"}),e.jsx(Gt,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),r&&e.jsx(qe,{message:"Error",description:r,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(O,{type:"primary",onClick:x,children:"Retry"})}),e.jsxs(K,{style:{marginTop:24},children:[e.jsxs(ie,{gutter:[16,16],style:{marginBottom:16},children:[e.jsx(B,{flex:"auto",children:e.jsx(Qu,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:N,onChange:f=>u(f.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),e.jsx(B,{children:e.jsx(O,{icon:e.jsx(bi,{}),onClick:x,children:"Refresh"})})]}),e.jsxs(dt,{defaultActiveKey:b,onChange:f=>c(f),children:[e.jsx(bs,{tab:`All Bookings (${d()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):_.length>0?e.jsx($e,{columns:j,dataSource:_,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):e.jsx(Xe,{description:a?"No bookings match your search criteria":"No bookings found",image:Xe.PRESENTED_IMAGE_SIMPLE})},"all"),e.jsx(bs,{tab:`Pending (${p()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):e.jsx($e,{columns:j,dataSource:s.filter(f=>f.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Xe,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),e.jsx(bs,{tab:`Approved (${L()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):e.jsx($e,{columns:j,dataSource:s.filter(f=>f.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Xe,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),e.jsx(bs,{tab:`Confirmed (${A()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):e.jsx($e,{columns:j,dataSource:s.filter(f=>f.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Xe,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),e.jsx(bs,{tab:`Rejected (${y()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):e.jsx($e,{columns:j,dataSource:s.filter(f=>f.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Xe,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),e.jsx(bs,{tab:`Cancelled (${D()})`,children:n?e.jsx(Rt,{active:!0,paragraph:{rows:5}}):e.jsx($e,{columns:j,dataSource:s.filter(f=>f.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:e.jsx(Xe,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:wo,Text:Li}=pe,Ku=()=>{var g,x,P,C,v,T,j,N,_,d,p,L,A;const{id:s}=ft(),t=ke(),[n,i]=h.useState(null),[r,o]=h.useState(!0);h.useEffect(()=>{a()},[s]);const a=async()=>{try{o(!0);const y=await xt.getExhibitorBooking(s||"");i(y.data)}catch(y){console.error("Error fetching booking details:",y),ee.error("Failed to load booking details")}finally{o(!1)}},u=async()=>{try{t(`/exhibitor/invoice/${s}`)}catch(y){console.error("Error fetching invoice:",y),ee.error("Failed to retrieve invoice")}},b=y=>{switch(y){case"approved":return e.jsxs(re,{color:"success",children:[e.jsx(_e,{})," Approved"]});case"pending":return e.jsxs(re,{color:"warning",children:[e.jsx(Ze,{})," Pending"]});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});case"confirmed":return e.jsxs(re,{color:"blue",children:[e.jsx(_e,{})," Confirmed"]});case"cancelled":return e.jsx(re,{color:"default",children:"Cancelled"});default:return e.jsx(re,{children:"Unknown"})}},c=y=>{switch(y){case"paid":return e.jsx(re,{color:"success",children:"Paid"});case"pending":return e.jsx(re,{color:"warning",children:"Pending"});case"refunded":return e.jsx(re,{color:"default",children:"Refunded"});default:return e.jsx(re,{children:"Unknown"})}},S=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:y=>`${y.dimensions.width}m  ${y.dimensions.height}m`},{title:"Size",key:"size",render:y=>`${y.dimensions.width*y.dimensions.height} m`},{title:"Rate per m",dataIndex:"ratePerSqm",key:"ratePerSqm",render:y=>`${y.toLocaleString()}`},{title:"Amount",key:"amount",render:(y,D,f)=>{var I;const w=(I=n.calculations)==null?void 0:I.stalls[f];return w?`${w.baseAmount.toLocaleString()}`:"N/A"}}];return r?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(Bt,{size:"large"})}):n?e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(n.status)&&e.jsx(O,{type:"primary",icon:e.jsx(es,{}),onClick:u,children:"View Invoice"})]}),e.jsxs(K,{title:"Booking Details",style:{marginBottom:20},children:[e.jsxs(me,{bordered:!0,column:{xs:1,sm:2,md:3},children:[e.jsx(me.Item,{label:"Booking ID",children:n._id}),e.jsx(me.Item,{label:"Exhibition",children:((g=n.exhibitionId)==null?void 0:g.name)||"N/A"}),e.jsx(me.Item,{label:"Venue",children:((x=n.exhibitionId)==null?void 0:x.venue)||"N/A"}),e.jsx(me.Item,{label:"Booking Date",children:Ie(n.createdAt).format("MMM D, YYYY")}),e.jsxs(me.Item,{label:"Exhibition Dates",children:[Ie((P=n.exhibitionId)==null?void 0:P.startDate).format("MMM D, YYYY")," -",Ie((C=n.exhibitionId)==null?void 0:C.endDate).format("MMM D, YYYY")]}),e.jsx(me.Item,{label:"Status",children:b(n.status)}),e.jsx(me.Item,{label:"Payment Status",children:c(n.paymentStatus||"pending")}),e.jsxs(me.Item,{label:"Total Amount",children:["",((v=n.amount)==null?void 0:v.toLocaleString())||"N/A"]})]}),n.rejectionReason&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(wo,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),e.jsx(Li,{children:n.rejectionReason})]})]}),e.jsx(K,{title:"Stall Details",style:{marginBottom:20},children:e.jsx($e,{dataSource:n.stallIds||[],columns:S,rowKey:"_id",pagination:!1})}),e.jsx(K,{title:"Calculation Summary",children:e.jsx(ie,{gutter:[16,16],children:e.jsx(B,{span:24,children:e.jsxs(me,{bordered:!0,column:1,children:[e.jsxs(me.Item,{label:"Base Amount",children:["",((T=n.calculations)==null?void 0:T.totalBaseAmount.toLocaleString())||"N/A"]}),((j=n.calculations)==null?void 0:j.totalDiscountAmount)>0&&e.jsxs(me.Item,{label:"Discount",children:["- ",((N=n.calculations)==null?void 0:N.totalDiscountAmount.toLocaleString())||"N/A"]}),((_=n.calculations)==null?void 0:_.totalDiscountAmount)>0&&e.jsxs(me.Item,{label:"Amount After Discount",children:["",((d=n.calculations)==null?void 0:d.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(L=(p=n.calculations)==null?void 0:p.taxes)==null?void 0:L.map(y=>e.jsxs(me.Item,{label:`${y.name} (${y.rate}%)`,children:["+ ",y.amount.toLocaleString()||"N/A"]},y.name)),e.jsx(me.Item,{label:"Total Amount",children:e.jsxs(Li,{strong:!0,style:{fontSize:"16px"},children:["",((A=n.amount)==null?void 0:A.toLocaleString())||"N/A"]})})]})})})}),e.jsx(K,{title:"Customer Information",style:{marginTop:20},children:e.jsxs(me,{bordered:!0,column:{xs:1,sm:2},children:[e.jsx(me.Item,{label:"Company Name",children:n.companyName}),e.jsx(me.Item,{label:"Contact Person",children:n.customerName}),e.jsx(me.Item,{label:"Email",children:n.customerEmail}),e.jsx(me.Item,{label:"Phone",children:n.customerPhone})]})})]}):e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[e.jsx(wo,{level:3,children:"Booking Not Found"}),e.jsx(Li,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),e.jsx("div",{style:{marginTop:20},children:e.jsx(O,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},Sr=ht.create({baseURL:Tt}),js=ht.create({baseURL:Tt});Sr.interceptors.request.use(s=>{const t=localStorage.getItem("exhibitor_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));const ls=ht.create({baseURL:Tt});ls.interceptors.request.use(s=>{const t=localStorage.getItem("token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));const st={sendRegistrationOTP:async s=>await js.post("/exhibitors/send-otp",{email:s}),verifyOTP:async s=>await js.post("/exhibitors/verify-otp",s),register:async s=>await js.post("/exhibitors/register",s),login:async s=>await js.post("/exhibitors/login",s),requestPasswordReset:async s=>await js.post("/exhibitors/forgot-password",s),resetPassword:async s=>await js.post("/exhibitors/reset-password",s),getProfile:async()=>await Sr.get("/exhibitors/profile"),updateProfile:async s=>await Sr.put("/exhibitors/profile",s),getExhibitors:async()=>await ls.get("/exhibitors/admin/exhibitors"),getExhibitor:async s=>await ls.get(`/exhibitors/admin/exhibitors/${s}`),createExhibitor:async s=>await ls.post("/exhibitors/admin/exhibitors",s),updateStatus:async(s,t,n)=>await ls.put(`/exhibitors/admin/exhibitors/${s}/status`,{status:t,rejectionReason:n}),updateExhibitor:async(s,t)=>await ls.put(`/exhibitors/admin/exhibitors/${s}`,t),deleteExhibitor:async s=>await ls.delete(`/exhibitors/admin/exhibitors/${s}`)},{Title:So,Text:ko}=pe,{TabPane:Co}=dt,Xu=()=>{var b;const[s]=$.useForm(),[t,n]=h.useState(!1),[i,r]=h.useState(!1),o=Ae(),a=ue(c=>c.exhibitorAuth.exhibitor);h.useEffect(()=>{(async()=>{try{r(!0);const S=await st.getProfile();S.data&&o(wr({exhibitor:S.data,token:(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||""}))}catch{ee.error("Failed to fetch exhibitor profile")}finally{r(!1)}})()},[o]),h.useEffect(()=>{a&&s.setFieldsValue({companyName:a.companyName||"",contactPerson:a.contactPerson||"",email:a.email||"",phone:a.phone||"",address:a.address||"",website:a.website||"",description:a.description||"",panNumber:a.panNumber||"",gstNumber:a.gstNumber||"",city:a.city||"",state:a.state||"",pinCode:a.pinCode||""})},[a,s]);const u=async c=>{try{n(!0);const S=await st.updateProfile(c),g=(a==null?void 0:a.token)||localStorage.getItem("exhibitor_token")||"";o(wr({exhibitor:{...a,...c},token:g})),ee.success("Profile updated successfully")}catch{ee.error("Failed to update profile")}finally{n(!1)}};return e.jsxs("div",{children:[e.jsx(So,{level:2,children:"My Profile"}),e.jsx(ko,{type:"secondary",children:"Manage your exhibitor profile information"}),e.jsx(K,{style:{marginTop:24},loading:i,children:e.jsxs(dt,{defaultActiveKey:"profile",children:[e.jsx(Co,{tab:"Profile Information",children:e.jsxs(ie,{gutter:32,children:[e.jsx(B,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(wt,{size:100,icon:e.jsx(Ce,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((b=a==null?void 0:a.companyName)==null?void 0:b.charAt(0).toUpperCase())||"E"}),e.jsx(So,{level:4,children:a==null?void 0:a.companyName}),e.jsx(ko,{type:"secondary",children:a==null?void 0:a.email})]})}),e.jsx(B,{span:18,children:e.jsxs($,{form:s,layout:"vertical",onFinish:u,initialValues:{companyName:(a==null?void 0:a.companyName)||"",contactPerson:(a==null?void 0:a.contactPerson)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",address:(a==null?void 0:a.address)||"",website:(a==null?void 0:a.website)||"",description:(a==null?void 0:a.description)||"",panNumber:(a==null?void 0:a.panNumber)||"",gstNumber:(a==null?void 0:a.gstNumber)||"",city:(a==null?void 0:a.city)||"",state:(a==null?void 0:a.state)||"",pinCode:(a==null?void 0:a.pinCode)||""},children:[e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:e.jsx(G,{prefix:e.jsx(_r,{}),placeholder:"Company Name"})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:e.jsx(G,{prefix:e.jsx(Ce,{}),placeholder:"Contact Person"})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Yt,{}),placeholder:"Email",disabled:!0})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:e.jsx(G,{prefix:e.jsx(Dr,{}),placeholder:"Phone Number"})})})]}),e.jsx($.Item,{name:"address",label:"Address",children:e.jsx(G.TextArea,{rows:2,placeholder:"Company Address"})}),e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:8,children:e.jsx($.Item,{name:"city",label:"City",children:e.jsx(G,{placeholder:"City"})})}),e.jsx(B,{span:8,children:e.jsx($.Item,{name:"state",label:"State",children:e.jsx(G,{placeholder:"State"})})}),e.jsx(B,{span:8,children:e.jsx($.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(G,{placeholder:"PIN Code",maxLength:6})})})]}),e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(G,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(G,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),e.jsx($.Item,{name:"website",label:"Website",children:e.jsx(G,{placeholder:"https://www.yourcompany.com"})}),e.jsx($.Item,{name:"description",label:"Company Description",children:e.jsx(G.TextArea,{rows:4,placeholder:"Brief description of your company"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",loading:t,icon:e.jsx(fs,{}),children:"Save Changes"})})]})})]})},"profile"),e.jsx(Co,{tab:"Change Password",children:e.jsxs($,{layout:"vertical",onFinish:c=>{ee.success("Password updated successfully")},children:[e.jsx($.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(G.Password,{placeholder:"Current Password"})}),e.jsx($.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"New Password"})}),e.jsx($.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:c})=>({validator(S,g){return!g||c("newPassword")===g?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{placeholder:"Confirm New Password"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var Ju=class extends Error{constructor(t){super(t[0].message);Zr(this,"issues");this.name="SchemaError",this.issues=t}},sl=(s=>(s.uninitialized="uninitialized",s.pending="pending",s.fulfilled="fulfilled",s.rejected="rejected",s))(sl||{});function Io(s){return{status:s,isUninitialized:s==="uninitialized",isLoading:s==="pending",isSuccess:s==="fulfilled",isError:s==="rejected"}}var Eo=ln;function nl(s,t){if(s===t||!(Eo(s)&&Eo(t)||Array.isArray(s)&&Array.isArray(t)))return t;const n=Object.keys(t),i=Object.keys(s);let r=n.length===i.length;const o=Array.isArray(t)?[]:{};for(const a of n)o[a]=nl(s[a],t[a]),r&&(r=s[a]===o[a]);return r?s:o}function Ps(s){let t=0;for(const n in s)t++;return t}var Ao=s=>[].concat(...s);function Zu(s){return new RegExp("(^|:)//").test(s)}function eh(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function fi(s){return s!=null}function th(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var sh=s=>s.replace(/\/$/,""),nh=s=>s.replace(/^\//,"");function ih(s,t){if(!s)return t;if(!t)return s;if(Zu(t))return t;const n=s.endsWith("/")||!t.startsWith("?")?"/":"";return s=sh(s),t=nh(t),`${s}${n}${t}`}function rh(s,t,n){return s.has(t)?s.get(t):s.set(t,n).get(t)}var No=(...s)=>fetch(...s),oh=s=>s.status>=200&&s.status<=299,ah=s=>/ion\/(vnd\.api\+)?json/.test(s.get("content-type")||"");function To(s){if(!ln(s))return s;const t={...s};for(const[n,i]of Object.entries(t))i===void 0&&delete t[n];return t}function Yr({baseUrl:s,prepareHeaders:t=g=>g,fetchFn:n=No,paramsSerializer:i,isJsonContentType:r=ah,jsonContentType:o="application/json",jsonReplacer:a,timeout:u,responseHandler:b,validateStatus:c,...S}={}){return typeof fetch>"u"&&n===No&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(x,P,C)=>{const{getState:v,extra:T,endpoint:j,forced:N,type:_}=P;let d,{url:p,headers:L=new Headers(S.headers),params:A=void 0,responseHandler:y=b??"json",validateStatus:D=c??oh,timeout:f=u,...w}=typeof x=="string"?{url:x}:x,I,R=P.signal;f&&(I=new AbortController,P.signal.addEventListener("abort",I.abort),R=I.signal);let m={...S,signal:R,...w};L=new Headers(To(L)),m.headers=await t(L,{getState:v,arg:x,extra:T,endpoint:j,forced:N,type:_,extraOptions:C})||L;const M=W=>typeof W=="object"&&(ln(W)||Array.isArray(W)||typeof W.toJSON=="function");if(!m.headers.has("content-type")&&M(m.body)&&m.headers.set("content-type",o),M(m.body)&&r(m.headers)&&(m.body=JSON.stringify(m.body,a)),A){const W=~p.indexOf("?")?"&":"?",q=i?i(A):new URLSearchParams(To(A));p+=W+q}p=ih(s,p);const E=new Request(p,m);d={request:new Request(p,m)};let k,F=!1,z=I&&setTimeout(()=>{F=!0,I.abort()},f);try{k=await n(E)}catch(W){return{error:{status:F?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(W)},meta:d}}finally{z&&clearTimeout(z),I==null||I.signal.removeEventListener("abort",I.abort)}const U=k.clone();d.response=U;let V,H="";try{let W;if(await Promise.all([g(k,y).then(q=>V=q,q=>W=q),U.text().then(q=>H=q,()=>{})]),W)throw W}catch(W){return{error:{status:"PARSING_ERROR",originalStatus:k.status,data:H,error:String(W)},meta:d}}return D(k,V)?{data:V,meta:d}:{error:{status:k.status,data:V},meta:d}};async function g(x,P){if(typeof P=="function")return P(x);if(P==="content-type"&&(P=r(x.headers)?"json":"text"),P==="json"){const C=await x.text();return C.length?JSON.parse(C):null}return x.text()}}var Po=class{constructor(s,t=void 0){this.value=s,this.meta=t}},Qr=Fs("__rtkq/focused"),il=Fs("__rtkq/unfocused"),Gr=Fs("__rtkq/online"),rl=Fs("__rtkq/offline");function Ci(s){return s.type==="query"}function lh(s){return s.type==="mutation"}function Ii(s){return s.type==="infinitequery"}function gi(s){return Ci(s)||Ii(s)}function Kr(s,t,n,i,r,o){return ch(s)?s(t,n,i,r).filter(fi).map(kr).map(o):Array.isArray(s)?s.map(kr).map(o):[]}function ch(s){return typeof s=="function"}function kr(s){return typeof s=="string"?{type:s}:s}function dh(s,t){return s.catch(t)}var dn=Symbol("forceQueryFn"),Cr=s=>typeof s[dn]=="function";function uh({serializeQueryArgs:s,queryThunk:t,infiniteQueryThunk:n,mutationThunk:i,api:r,context:o}){const a=new Map,u=new Map,{unsubscribeQueryResult:b,removeMutationResult:c,updateSubscriptionOptions:S}=r.internalActions;return{buildInitiateQuery:T,buildInitiateInfiniteQuery:j,buildInitiateMutation:N,getRunningQueryThunk:g,getRunningMutationThunk:x,getRunningQueriesThunk:P,getRunningMutationsThunk:C};function g(_,d){return p=>{var y;const L=o.endpointDefinitions[_],A=s({queryArgs:d,endpointDefinition:L,endpointName:_});return(y=a.get(p))==null?void 0:y[A]}}function x(_,d){return p=>{var L;return(L=u.get(p))==null?void 0:L[d]}}function P(){return _=>Object.values(a.get(_)||{}).filter(fi)}function C(){return _=>Object.values(u.get(_)||{}).filter(fi)}function v(_,d){const p=(L,{subscribe:A=!0,forceRefetch:y,subscriptionOptions:D,[dn]:f,...w}={})=>(I,R)=>{var Y;const m=s({queryArgs:L,endpointDefinition:d,endpointName:_});let M;const E={...w,type:"query",subscribe:A,forceRefetch:y,subscriptionOptions:D,endpointName:_,originalArgs:L,queryCacheKey:m,[dn]:f};if(Ci(d))M=t(E);else{const{direction:Z,initialPageParam:le}=w;M=n({...E,direction:Z,initialPageParam:le})}const l=r.endpoints[_].select(L),k=I(M),F=l(R()),{requestId:z,abort:U}=k,V=F.requestId!==z,H=(Y=a.get(I))==null?void 0:Y[m],W=()=>l(R()),q=Object.assign(f?k.then(W):V&&!H?Promise.resolve(F):Promise.all([H,k]).then(W),{arg:L,requestId:z,subscriptionOptions:D,queryCacheKey:m,abort:U,async unwrap(){const Z=await q;if(Z.isError)throw Z.error;return Z.data},refetch:()=>I(p(L,{subscribe:!1,forceRefetch:!0})),unsubscribe(){A&&I(b({queryCacheKey:m,requestId:z}))},updateSubscriptionOptions(Z){q.subscriptionOptions=Z,I(S({endpointName:_,requestId:z,queryCacheKey:m,options:Z}))}});if(!H&&!V&&!f){const Z=rh(a,I,{});Z[m]=q,q.then(()=>{delete Z[m],Ps(Z)||a.delete(I)})}return q};return p}function T(_,d){return v(_,d)}function j(_,d){return v(_,d)}function N(_){return(d,{track:p=!0,fixedCacheKey:L}={})=>(A,y)=>{const D=i({type:"mutation",endpointName:_,originalArgs:d,track:p,fixedCacheKey:L}),f=A(D),{requestId:w,abort:I,unwrap:R}=f,m=dh(f.unwrap().then(k=>({data:k})),k=>({error:k})),M=()=>{A(c({requestId:w,fixedCacheKey:L}))},E=Object.assign(m,{arg:f.arg,requestId:w,abort:I,unwrap:R,reset:M}),l=u.get(A)||{};return u.set(A,l),l[w]=E,E.then(()=>{delete l[w],Ps(l)||u.delete(A)}),L&&(l[L]=E,E.then(()=>{l[L]===E&&(delete l[L],Ps(l)||u.delete(A))})),E}}}var ol=class extends Ju{constructor(s,t,n,i){super(s),this.value=t,this.schemaName=n,this._bqMeta=i}};async function rs(s,t,n,i){const r=await s["~standard"].validate(t);if(r.issues)throw new ol(r.issues,t,n,i);return r.value}function hh(s){return s}var Vs=(s={})=>({...s,[Ta]:!0});function ph({reducerPath:s,baseQuery:t,context:{endpointDefinitions:n},serializeQueryArgs:i,api:r,assertTagType:o,selectors:a,onSchemaFailure:u,catchSchemaFailure:b,skipSchemaValidation:c}){const S=(w,I,R,m)=>(M,E)=>{const l=n[w],k=i({queryArgs:I,endpointDefinition:l,endpointName:w});if(M(r.internalActions.queryResultPatched({queryCacheKey:k,patches:R})),!m)return;const F=r.endpoints[w].select(I)(E()),z=Kr(l.providesTags,F.data,void 0,I,{},o);M(r.internalActions.updateProvidedBy([{queryCacheKey:k,providedTags:z}]))};function g(w,I,R=0){const m=[I,...w];return R&&m.length>R?m.slice(0,-1):m}function x(w,I,R=0){const m=[...w,I];return R&&m.length>R?m.slice(1):m}const P=(w,I,R,m=!0)=>(M,E)=>{const k=r.endpoints[w].select(I)(E()),F={patches:[],inversePatches:[],undo:()=>M(r.util.patchQueryData(w,I,F.inversePatches,m))};if(k.status==="uninitialized")return F;let z;if("data"in k)if(dc(k.data)){const[U,V,H]=Ra(k.data,R);F.patches.push(...V),F.inversePatches.push(...H),z=U}else z=R(k.data),F.patches.push({op:"replace",path:[],value:z}),F.inversePatches.push({op:"replace",path:[],value:k.data});return F.patches.length===0||M(r.util.patchQueryData(w,I,F.patches,m)),F},C=(w,I,R)=>m=>m(r.endpoints[w].initiate(I,{subscribe:!1,forceRefetch:!0,[dn]:()=>({data:R})})),v=(w,I)=>w.query&&w[I]?w[I]:hh,T=async(w,{signal:I,abort:R,rejectWithValue:m,fulfillWithValue:M,dispatch:E,getState:l,extra:k})=>{var V,H;const F=n[w.endpointName],{metaSchema:z,skipSchemaValidation:U=c}=F;try{let W=v(F,"transformResponse");const q={signal:I,abort:R,dispatch:E,getState:l,extra:k,endpoint:w.endpointName,type:w.type,forced:w.type==="query"?j(w,l()):void 0,queryCacheKey:w.type==="query"?w.queryCacheKey:void 0},Y=w.type==="query"?w[dn]:void 0;let Z;const le=async(ce,te,de,Pe)=>{if(te==null&&ce.pages.length)return Promise.resolve({data:ce});const Q={queryArg:w.originalArgs,pageParam:te},se=await ve(Q),he=Pe?g:x;return{data:{pages:he(ce.pages,se.data,de),pageParams:he(ce.pageParams,te,de)},meta:se.meta}};async function ve(ce){let te;const{extraOptions:de,argSchema:Pe,rawResponseSchema:Q,responseSchema:se}=F;if(Pe&&!U&&(ce=await rs(Pe,ce,"argSchema",{})),Y?te=Y():F.query?te=await t(F.query(ce),q,de):te=await F.queryFn(ce,q,de,Be=>t(Be,q,de)),typeof process<"u",te.error)throw new Po(te.error,te.meta);let{data:he}=te;Q&&!U&&(he=await rs(Q,te.data,"rawResponseSchema",te.meta));let Ne=await W(he,te.meta,ce);return se&&!U&&(Ne=await rs(se,Ne,"responseSchema",te.meta)),{...te,data:Ne}}if(w.type==="query"&&"infiniteQueryOptions"in F){const{infiniteQueryOptions:ce}=F,{maxPages:te=1/0}=ce;let de;const Pe={pages:[],pageParams:[]},Q=(V=a.selectQueryEntry(l(),w.queryCacheKey))==null?void 0:V.data,he=j(w,l())&&!w.direction||!Q?Pe:Q;if("direction"in w&&w.direction&&he.pages.length){const Ne=w.direction==="backward",ut=(Ne?al:Ir)(ce,he);de=await le(he,ut,te,Ne)}else{const{initialPageParam:Ne=ce.initialPageParam}=w,Be=(Q==null?void 0:Q.pageParams)??[],ut=Be[0]??Ne,Ms=Be.length;de=await le(he,ut,te),Y&&(de={data:de.data.pages[0]});for(let oe=1;oe<Ms;oe++){const fe=Ir(ce,de.data);de=await le(de.data,fe,te)}}Z=de}else Z=await ve(w.originalArgs);return z&&!U&&Z.meta&&(Z.meta=await rs(z,Z.meta,"metaSchema",Z.meta)),M(Z.data,Vs({fulfilledTimeStamp:Date.now(),baseQueryMeta:Z.meta}))}catch(W){let q=W;if(q instanceof Po){let Y=v(F,"transformErrorResponse");const{rawErrorResponseSchema:Z,errorResponseSchema:le}=F;let{value:ve,meta:ce}=q;try{Z&&!U&&(ve=await rs(Z,ve,"rawErrorResponseSchema",ce)),z&&!U&&(ce=await rs(z,ce,"metaSchema",ce));let te=await Y(ve,ce,w.originalArgs);return le&&!U&&(te=await rs(le,te,"errorResponseSchema",ce)),m(te,Vs({baseQueryMeta:ce}))}catch(te){q=te}}try{if(q instanceof ol){const Y={endpoint:w.endpointName,arg:w.originalArgs,type:w.type,queryCacheKey:w.type==="query"?w.queryCacheKey:void 0};(H=F.onSchemaFailure)==null||H.call(F,q,Y),u==null||u(q,Y);const{catchSchemaFailure:Z=b}=F;if(Z)return m(Z(q,Y),Vs({baseQueryMeta:q._bqMeta}))}}catch(Y){q=Y}throw console.error(q),q}};function j(w,I){const R=a.selectQueryEntry(I,w.queryCacheKey),m=a.selectConfig(I).refetchOnMountOrArgChange,M=R==null?void 0:R.fulfilledTimeStamp,E=w.forceRefetch??(w.subscribe&&m);return E?E===!0||(Number(new Date)-Number(M))/1e3>=E:!1}const N=()=>je(`${s}/executeQuery`,T,{getPendingMeta({arg:I}){const R=n[I.endpointName];return Vs({startedTimeStamp:Date.now(),...Ii(R)?{direction:I.direction}:{}})},condition(I,{getState:R}){var U;const m=R(),M=a.selectQueryEntry(m,I.queryCacheKey),E=M==null?void 0:M.fulfilledTimeStamp,l=I.originalArgs,k=M==null?void 0:M.originalArgs,F=n[I.endpointName],z=I.direction;return Cr(I)?!0:(M==null?void 0:M.status)==="pending"?!1:j(I,m)||Ci(F)&&((U=F==null?void 0:F.forceRefetch)!=null&&U.call(F,{currentArg:l,previousArg:k,endpointState:M,state:m}))?!0:!(E&&!z)},dispatchConditionRejection:!0}),_=N(),d=N(),p=je(`${s}/executeMutation`,T,{getPendingMeta(){return Vs({startedTimeStamp:Date.now()})}}),L=w=>"force"in w,A=w=>"ifOlderThan"in w,y=(w,I,R)=>(m,M)=>{const E=L(R)&&R.force,l=A(R)&&R.ifOlderThan,k=(z=!0)=>{const U={forceRefetch:z,isPrefetch:!0};return r.endpoints[w].initiate(I,U)},F=r.endpoints[w].select(I)(M());if(E)m(k());else if(l){const z=F==null?void 0:F.fulfilledTimeStamp;if(!z){m(k());return}(Number(new Date)-Number(new Date(z)))/1e3>=l&&m(k())}else m(k(!1))};function D(w){return I=>{var R,m;return((m=(R=I==null?void 0:I.meta)==null?void 0:R.arg)==null?void 0:m.endpointName)===w}}function f(w,I){return{matchPending:Ni(Pa(w),D(I)),matchFulfilled:Ni(ps(w),D(I)),matchRejected:Ni(Mr(w),D(I))}}return{queryThunk:_,mutationThunk:p,infiniteQueryThunk:d,prefetch:y,updateQueryData:P,upsertQueryData:C,patchQueryData:S,buildMatchThunkActions:f}}function Ir(s,{pages:t,pageParams:n}){const i=t.length-1;return s.getNextPageParam(t[i],t,n[i],n)}function al(s,{pages:t,pageParams:n}){var i;return(i=s.getPreviousPageParam)==null?void 0:i.call(s,t[0],t,n[0],n)}function ll(s,t,n,i){return Kr(n[s.meta.arg.endpointName][t],ps(s)?s.payload:void 0,Br(s)?s.payload:void 0,s.meta.arg.originalArgs,"baseQueryMeta"in s.meta?s.meta.baseQueryMeta:void 0,i)}function wn(s,t,n){const i=s[t];i&&n(i)}function un(s){return("arg"in s?s.arg.fixedCacheKey:s.fixedCacheKey)??s.requestId}function Ro(s,t,n){const i=s[un(t)];i&&n(i)}var Sn={};function xh({reducerPath:s,queryThunk:t,mutationThunk:n,serializeQueryArgs:i,context:{endpointDefinitions:r,apiUid:o,extractRehydrationInfo:a,hasRehydrationInfo:u},assertTagType:b,config:c}){const S=Fs(`${s}/resetApiState`);function g(D,f,w,I){var R;D[R=f.queryCacheKey]??(D[R]={status:"uninitialized",endpointName:f.endpointName}),wn(D,f.queryCacheKey,m=>{m.status="pending",m.requestId=w&&m.requestId?m.requestId:I.requestId,f.originalArgs!==void 0&&(m.originalArgs=f.originalArgs),m.startedTimeStamp=I.startedTimeStamp;const M=r[I.arg.endpointName];Ii(M)&&"direction"in f&&(m.direction=f.direction)})}function x(D,f,w,I){wn(D,f.arg.queryCacheKey,R=>{if(R.requestId!==f.requestId&&!I)return;const{merge:m}=r[f.arg.endpointName];if(R.status="fulfilled",m)if(R.data!==void 0){const{fulfilledTimeStamp:M,arg:E,baseQueryMeta:l,requestId:k}=f;let F=Fr(R.data,z=>m(z,w,{arg:E.originalArgs,baseQueryMeta:l,fulfilledTimeStamp:M,requestId:k}));R.data=F}else R.data=w;else R.data=r[f.arg.endpointName].structuralSharing??!0?nl(hc(R.data)?pc(R.data):R.data,w):w;delete R.error,R.fulfilledTimeStamp=f.fulfilledTimeStamp})}const P=at({name:`${s}/queries`,initialState:Sn,reducers:{removeQueryResult:{reducer(D,{payload:{queryCacheKey:f}}){delete D[f]},prepare:Os()},cacheEntriesUpserted:{reducer(D,f){for(const w of f.payload){const{queryDescription:I,value:R}=w;g(D,I,!0,{arg:I,requestId:f.meta.requestId,startedTimeStamp:f.meta.timestamp}),x(D,{arg:I,requestId:f.meta.requestId,fulfilledTimeStamp:f.meta.timestamp,baseQueryMeta:{}},R,!0)}},prepare:D=>({payload:D.map(I=>{const{endpointName:R,arg:m,value:M}=I,E=r[R];return{queryDescription:{type:"query",endpointName:R,originalArgs:I.arg,queryCacheKey:i({queryArgs:m,endpointDefinition:E,endpointName:R})},value:M}}),meta:{[Ta]:!0,requestId:Ea(),timestamp:Date.now()}})},queryResultPatched:{reducer(D,{payload:{queryCacheKey:f,patches:w}}){wn(D,f,I=>{I.data=oo(I.data,w.concat())})},prepare:Os()}},extraReducers(D){D.addCase(t.pending,(f,{meta:w,meta:{arg:I}})=>{const R=Cr(I);g(f,I,R,w)}).addCase(t.fulfilled,(f,{meta:w,payload:I})=>{const R=Cr(w.arg);x(f,w,I,R)}).addCase(t.rejected,(f,{meta:{condition:w,arg:I,requestId:R},error:m,payload:M})=>{wn(f,I.queryCacheKey,E=>{if(!w){if(E.requestId!==R)return;E.status="rejected",E.error=M??m}})}).addMatcher(u,(f,w)=>{const{queries:I}=a(w);for(const[R,m]of Object.entries(I))((m==null?void 0:m.status)==="fulfilled"||(m==null?void 0:m.status)==="rejected")&&(f[R]=m)})}}),C=at({name:`${s}/mutations`,initialState:Sn,reducers:{removeMutationResult:{reducer(D,{payload:f}){const w=un(f);w in D&&delete D[w]},prepare:Os()}},extraReducers(D){D.addCase(n.pending,(f,{meta:w,meta:{requestId:I,arg:R,startedTimeStamp:m}})=>{R.track&&(f[un(w)]={requestId:I,status:"pending",endpointName:R.endpointName,startedTimeStamp:m})}).addCase(n.fulfilled,(f,{payload:w,meta:I})=>{I.arg.track&&Ro(f,I,R=>{R.requestId===I.requestId&&(R.status="fulfilled",R.data=w,R.fulfilledTimeStamp=I.fulfilledTimeStamp)})}).addCase(n.rejected,(f,{payload:w,error:I,meta:R})=>{R.arg.track&&Ro(f,R,m=>{m.requestId===R.requestId&&(m.status="rejected",m.error=w??I)})}).addMatcher(u,(f,w)=>{const{mutations:I}=a(w);for(const[R,m]of Object.entries(I))((m==null?void 0:m.status)==="fulfilled"||(m==null?void 0:m.status)==="rejected")&&R!==(m==null?void 0:m.requestId)&&(f[R]=m)})}}),v={tags:{},keys:{}},T=at({name:`${s}/invalidation`,initialState:v,reducers:{updateProvidedBy:{reducer(D,f){var w,I,R;for(const{queryCacheKey:m,providedTags:M}of f.payload){j(D,m);for(const{type:E,id:l}of M){const k=(I=(w=D.tags)[E]??(w[E]={}))[R=l||"__internal_without_id"]??(I[R]=[]);k.includes(m)||k.push(m)}D.keys[m]=M}},prepare:Os()}},extraReducers(D){D.addCase(P.actions.removeQueryResult,(f,{payload:{queryCacheKey:w}})=>{j(f,w)}).addMatcher(u,(f,w)=>{var R,m,M;const{provided:I}=a(w);for(const[E,l]of Object.entries(I))for(const[k,F]of Object.entries(l)){const z=(m=(R=f.tags)[E]??(R[E]={}))[M=k||"__internal_without_id"]??(m[M]=[]);for(const U of F)z.includes(U)||z.push(U)}}).addMatcher(pi(ps(t),Br(t)),(f,w)=>{N(f,[w])}).addMatcher(P.actions.cacheEntriesUpserted.match,(f,w)=>{const I=w.payload.map(({queryDescription:R,value:m})=>({type:"UNKNOWN",payload:m,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:R}}));N(f,I)})}});function j(D,f){var I;const w=D.keys[f]??[];for(const R of w){const m=R.type,M=R.id??"__internal_without_id",E=(I=D.tags[m])==null?void 0:I[M];E&&(D.tags[m][M]=E.filter(l=>l!==f))}delete D.keys[f]}function N(D,f){const w=f.map(I=>{const R=ll(I,"providesTags",r,b),{queryCacheKey:m}=I.meta.arg;return{queryCacheKey:m,providedTags:R}});T.caseReducers.updateProvidedBy(D,T.actions.updateProvidedBy(w))}const _=at({name:`${s}/subscriptions`,initialState:Sn,reducers:{updateSubscriptionOptions(D,f){},unsubscribeQueryResult(D,f){},internal_getRTKQSubscriptions(){}}}),d=at({name:`${s}/internalSubscriptions`,initialState:Sn,reducers:{subscriptionsUpdated:{reducer(D,f){return oo(D,f.payload)},prepare:Os()}}}),p=at({name:`${s}/config`,initialState:{online:th(),focused:eh(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(D,{payload:f}){D.middlewareRegistered=D.middlewareRegistered==="conflict"||o!==f?"conflict":!0}},extraReducers:D=>{D.addCase(Gr,f=>{f.online=!0}).addCase(rl,f=>{f.online=!1}).addCase(Qr,f=>{f.focused=!0}).addCase(il,f=>{f.focused=!1}).addMatcher(u,f=>({...f}))}}),L=cc({queries:P.reducer,mutations:C.reducer,provided:T.reducer,subscriptions:d.reducer,config:p.reducer}),A=(D,f)=>L(S.match(f)?void 0:D,f),y={...p.actions,...P.actions,..._.actions,...d.actions,...C.actions,...T.actions,resetApiState:S};return{reducer:A,actions:y}}var St=Symbol.for("RTKQ/skipToken"),cl={status:"uninitialized"},_o=Fr(cl,()=>{}),Do=Fr(cl,()=>{});function mh({serializeQueryArgs:s,reducerPath:t,createSelector:n}){const i=_=>_o,r=_=>Do;return{buildQuerySelector:x,buildInfiniteQuerySelector:P,buildMutationSelector:C,selectInvalidatedBy:v,selectCachedArgsForQuery:T,selectApiState:a,selectQueries:u,selectMutations:c,selectQueryEntry:b,selectConfig:S};function o(_){return{..._,...Io(_.status)}}function a(_){return _[t]}function u(_){var d;return(d=a(_))==null?void 0:d.queries}function b(_,d){var p;return(p=u(_))==null?void 0:p[d]}function c(_){var d;return(d=a(_))==null?void 0:d.mutations}function S(_){var d;return(d=a(_))==null?void 0:d.config}function g(_,d,p){return L=>{if(L===St)return n(i,p);const A=s({queryArgs:L,endpointDefinition:d,endpointName:_});return n(D=>b(D,A)??_o,p)}}function x(_,d){return g(_,d,o)}function P(_,d){const{infiniteQueryOptions:p}=d;function L(A){const y={...A,...Io(A.status)},{isLoading:D,isError:f,direction:w}=y,I=w==="forward",R=w==="backward";return{...y,hasNextPage:j(p,y.data),hasPreviousPage:N(p,y.data),isFetchingNextPage:D&&I,isFetchingPreviousPage:D&&R,isFetchNextPageError:f&&I,isFetchPreviousPageError:f&&R}}return g(_,d,L)}function C(){return _=>{let d;return typeof _=="object"?d=un(_)??St:d=_,n(d===St?r:A=>{var y,D;return((D=(y=a(A))==null?void 0:y.mutations)==null?void 0:D[d])??Do},o)}}function v(_,d){const p=_[t],L=new Set;for(const A of d.filter(fi).map(kr)){const y=p.provided.tags[A.type];if(!y)continue;let D=(A.id!==void 0?y[A.id]:Ao(Object.values(y)))??[];for(const f of D)L.add(f)}return Ao(Array.from(L.values()).map(A=>{const y=p.queries[A];return y?[{queryCacheKey:A,endpointName:y.endpointName,originalArgs:y.originalArgs}]:[]}))}function T(_,d){return Object.values(u(_)).filter(p=>(p==null?void 0:p.endpointName)===d&&p.status!=="uninitialized").map(p=>p.originalArgs)}function j(_,d){return d?Ir(_,d)!=null:!1}function N(_,d){return!d||!_.getPreviousPageParam?!1:al(_,d)!=null}}var vs=WeakMap?new WeakMap:void 0,yi=({endpointName:s,queryArgs:t})=>{let n="";const i=vs==null?void 0:vs.get(t);if(typeof i=="string")n=i;else{const r=JSON.stringify(t,(o,a)=>(a=typeof a=="bigint"?{$bigint:a.toString()}:a,a=ln(a)?Object.keys(a).sort().reduce((u,b)=>(u[b]=a[b],u),{}):a,a));ln(t)&&(vs==null||vs.set(t,r)),n=r}return`${s}(${n})`};function dl(...s){return function(n){const i=ro(c=>{var S;return(S=n.extractRehydrationInfo)==null?void 0:S.call(n,c,{reducerPath:n.reducerPath??"api"})}),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...n,extractRehydrationInfo:i,serializeQueryArgs(c){let S=yi;if("serializeQueryArgs"in c.endpointDefinition){const g=c.endpointDefinition.serializeQueryArgs;S=x=>{const P=g(x);return typeof P=="string"?P:yi({...x,queryArgs:P})}}else n.serializeQueryArgs&&(S=n.serializeQueryArgs);return S(c)},tagTypes:[...n.tagTypes||[]]},o={endpointDefinitions:{},batch(c){c()},apiUid:Ea(),extractRehydrationInfo:i,hasRehydrationInfo:ro(c=>i(c)!=null)},a={injectEndpoints:b,enhanceEndpoints({addTagTypes:c,endpoints:S}){if(c)for(const g of c)r.tagTypes.includes(g)||r.tagTypes.push(g);if(S)for(const[g,x]of Object.entries(S))typeof x=="function"?x(o.endpointDefinitions[g]):Object.assign(o.endpointDefinitions[g]||{},x);return a}},u=s.map(c=>c.init(a,r,o));function b(c){const S=c.endpoints({query:g=>({...g,type:"query"}),mutation:g=>({...g,type:"mutation"}),infiniteQuery:g=>({...g,type:"infinitequery"})});for(const[g,x]of Object.entries(S)){if(c.overrideExisting!==!0&&g in o.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(Aa(39));continue}o.endpointDefinitions[g]=x;for(const P of u)P.injectEndpoint(g,x)}return a}return a.injectEndpoints({endpoints:n.endpoints})}}function qt(s,...t){return Object.assign(s,...t)}var fh=({api:s,queryThunk:t,internalState:n})=>{const i=`${s.reducerPath}/subscriptions`;let r=null,o=null;const{updateSubscriptionOptions:a,unsubscribeQueryResult:u}=s.internalActions,b=(P,C)=>{var T,j,N;if(a.match(C)){const{queryCacheKey:_,requestId:d,options:p}=C.payload;return(T=P==null?void 0:P[_])!=null&&T[d]&&(P[_][d]=p),!0}if(u.match(C)){const{queryCacheKey:_,requestId:d}=C.payload;return P[_]&&delete P[_][d],!0}if(s.internalActions.removeQueryResult.match(C))return delete P[C.payload.queryCacheKey],!0;if(t.pending.match(C)){const{meta:{arg:_,requestId:d}}=C,p=P[j=_.queryCacheKey]??(P[j]={});return p[`${d}_running`]={},_.subscribe&&(p[d]=_.subscriptionOptions??p[d]??{}),!0}let v=!1;if(t.fulfilled.match(C)||t.rejected.match(C)){const _=P[C.meta.arg.queryCacheKey]||{},d=`${C.meta.requestId}_running`;v||(v=!!_[d]),delete _[d]}if(t.rejected.match(C)){const{meta:{condition:_,arg:d,requestId:p}}=C;if(_&&d.subscribe){const L=P[N=d.queryCacheKey]??(P[N]={});L[p]=d.subscriptionOptions??L[p]??{},v=!0}}return v},c=()=>n.currentSubscriptions,x={getSubscriptions:c,getSubscriptionCount:P=>{const v=c()[P]??{};return Ps(v)},isRequestSubscribed:(P,C)=>{var T;const v=c();return!!((T=v==null?void 0:v[P])!=null&&T[C])}};return(P,C)=>{if(r||(r=JSON.parse(JSON.stringify(n.currentSubscriptions))),s.util.resetApiState.match(P))return r=n.currentSubscriptions={},o=null,[!0,!1];if(s.internalActions.internal_getRTKQSubscriptions.match(P))return[!1,x];const v=b(n.currentSubscriptions,P);let T=!0;if(v){o||(o=setTimeout(()=>{const _=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,d]=Ra(r,()=>_);C.next(s.internalActions.subscriptionsUpdated(d)),r=_,o=null},500));const j=typeof P.type=="string"&&!!P.type.startsWith(i),N=t.rejected.match(P)&&P.meta.condition&&!!P.meta.arg.subscribe;T=!j&&!N}return[T,!1]}};function gh(s){for(const t in s)return!1;return!0}var yh=2147483647/1e3-1,bh=({reducerPath:s,api:t,queryThunk:n,context:i,internalState:r,selectors:{selectQueryEntry:o,selectConfig:a}})=>{const{removeQueryResult:u,unsubscribeQueryResult:b,cacheEntriesUpserted:c}=t.internalActions,S=pi(b.match,n.fulfilled,n.rejected,c.match);function g(T){const j=r.currentSubscriptions[T];return!!j&&!gh(j)}const x={},P=(T,j,N)=>{const _=j.getState(),d=a(_);if(S(T)){let p;if(c.match(T))p=T.payload.map(L=>L.queryDescription.queryCacheKey);else{const{queryCacheKey:L}=b.match(T)?T.payload:T.meta.arg;p=[L]}C(p,j,d)}if(t.util.resetApiState.match(T))for(const[p,L]of Object.entries(x))L&&clearTimeout(L),delete x[p];if(i.hasRehydrationInfo(T)){const{queries:p}=i.extractRehydrationInfo(T);C(Object.keys(p),j,d)}};function C(T,j,N){const _=j.getState();for(const d of T){const p=o(_,d);v(d,p==null?void 0:p.endpointName,j,N)}}function v(T,j,N,_){const d=i.endpointDefinitions[j],p=(d==null?void 0:d.keepUnusedDataFor)??_.keepUnusedDataFor;if(p===1/0)return;const L=Math.max(0,Math.min(p,yh));if(!g(T)){const A=x[T];A&&clearTimeout(A),x[T]=setTimeout(()=>{g(T)||N.dispatch(u({queryCacheKey:T})),delete x[T]},L*1e3)}}return P},Lo=new Error("Promise never resolved before cacheEntryRemoved."),jh=({api:s,reducerPath:t,context:n,queryThunk:i,mutationThunk:r,internalState:o,selectors:{selectQueryEntry:a,selectApiState:u}})=>{const b=ao(i),c=ao(r),S=ps(i,r),g={};function x(j,N,_){const d=g[j];d!=null&&d.valueResolved&&(d.valueResolved({data:N,meta:_}),delete d.valueResolved)}function P(j){const N=g[j];N&&(delete g[j],N.cacheEntryRemoved())}const C=(j,N,_)=>{const d=v(j);function p(L,A,y,D){const f=a(_,A),w=a(N.getState(),A);!f&&w&&T(L,D,A,N,y)}if(i.pending.match(j))p(j.meta.arg.endpointName,d,j.meta.requestId,j.meta.arg.originalArgs);else if(s.internalActions.cacheEntriesUpserted.match(j))for(const{queryDescription:L,value:A}of j.payload){const{endpointName:y,originalArgs:D,queryCacheKey:f}=L;p(y,f,j.meta.requestId,D),x(f,A,{})}else if(r.pending.match(j))N.getState()[t].mutations[d]&&T(j.meta.arg.endpointName,j.meta.arg.originalArgs,d,N,j.meta.requestId);else if(S(j))x(d,j.payload,j.meta.baseQueryMeta);else if(s.internalActions.removeQueryResult.match(j)||s.internalActions.removeMutationResult.match(j))P(d);else if(s.util.resetApiState.match(j))for(const L of Object.keys(g))P(L)};function v(j){return b(j)?j.meta.arg.queryCacheKey:c(j)?j.meta.arg.fixedCacheKey??j.meta.requestId:s.internalActions.removeQueryResult.match(j)?j.payload.queryCacheKey:s.internalActions.removeMutationResult.match(j)?un(j.payload):""}function T(j,N,_,d,p){const L=n.endpointDefinitions[j],A=L==null?void 0:L.onCacheEntryAdded;if(!A)return;const y={},D=new Promise(M=>{y.cacheEntryRemoved=M}),f=Promise.race([new Promise(M=>{y.valueResolved=M}),D.then(()=>{throw Lo})]);f.catch(()=>{}),g[_]=y;const w=s.endpoints[j].select(gi(L)?N:_),I=d.dispatch((M,E,l)=>l),R={...d,getCacheEntry:()=>w(d.getState()),requestId:p,extra:I,updateCachedData:gi(L)?M=>d.dispatch(s.util.updateQueryData(j,N,M)):void 0,cacheDataLoaded:f,cacheEntryRemoved:D},m=A(N,R);Promise.resolve(m).catch(M=>{if(M!==Lo)throw M})}return C},vh=({api:s,context:{apiUid:t},reducerPath:n})=>(i,r)=>{s.util.resetApiState.match(i)&&r.dispatch(s.internalActions.middlewareRegistered(t))},wh=({reducerPath:s,context:t,context:{endpointDefinitions:n},mutationThunk:i,queryThunk:r,api:o,assertTagType:a,refetchQuery:u,internalState:b})=>{const{removeQueryResult:c}=o.internalActions,S=pi(ps(i),Br(i)),g=pi(ps(i,r),Mr(i,r));let x=[];const P=(T,j)=>{S(T)?v(ll(T,"invalidatesTags",n,a),j):g(T)?v([],j):o.util.invalidateTags.match(T)&&v(Kr(T.payload,void 0,void 0,void 0,void 0,a),j)};function C(T){var _;const{queries:j,mutations:N}=T;for(const d of[j,N])for(const p in d)if(((_=d[p])==null?void 0:_.status)==="pending")return!0;return!1}function v(T,j){const N=j.getState(),_=N[s];if(x.push(...T),_.config.invalidationBehavior==="delayed"&&C(_))return;const d=x;if(x=[],d.length===0)return;const p=o.util.selectInvalidatedBy(N,d);t.batch(()=>{const L=Array.from(p.values());for(const{queryCacheKey:A}of L){const y=_.queries[A],D=b.currentSubscriptions[A]??{};y&&(Ps(D)===0?j.dispatch(c({queryCacheKey:A})):y.status!=="uninitialized"&&j.dispatch(u(y)))}})}return P},Sh=({reducerPath:s,queryThunk:t,api:n,refetchQuery:i,internalState:r})=>{const o={},a=(x,P)=>{(n.internalActions.updateSubscriptionOptions.match(x)||n.internalActions.unsubscribeQueryResult.match(x))&&b(x.payload,P),(t.pending.match(x)||t.rejected.match(x)&&x.meta.condition)&&b(x.meta.arg,P),(t.fulfilled.match(x)||t.rejected.match(x)&&!x.meta.condition)&&u(x.meta.arg,P),n.util.resetApiState.match(x)&&S()};function u({queryCacheKey:x},P){const C=P.getState()[s],v=C.queries[x],T=r.currentSubscriptions[x];if(!v||v.status==="uninitialized")return;const{lowestPollingInterval:j,skipPollingIfUnfocused:N}=g(T);if(!Number.isFinite(j))return;const _=o[x];_!=null&&_.timeout&&(clearTimeout(_.timeout),_.timeout=void 0);const d=Date.now()+j;o[x]={nextPollTimestamp:d,pollingInterval:j,timeout:setTimeout(()=>{(C.config.focused||!N)&&P.dispatch(i(v)),u({queryCacheKey:x},P)},j)}}function b({queryCacheKey:x},P){const v=P.getState()[s].queries[x],T=r.currentSubscriptions[x];if(!v||v.status==="uninitialized")return;const{lowestPollingInterval:j}=g(T);if(!Number.isFinite(j)){c(x);return}const N=o[x],_=Date.now()+j;(!N||_<N.nextPollTimestamp)&&u({queryCacheKey:x},P)}function c(x){const P=o[x];P!=null&&P.timeout&&clearTimeout(P.timeout),delete o[x]}function S(){for(const x of Object.keys(o))c(x)}function g(x={}){let P=!1,C=Number.POSITIVE_INFINITY;for(let v in x)x[v].pollingInterval&&(C=Math.min(x[v].pollingInterval,C),P=x[v].skipPollingIfUnfocused||P);return{lowestPollingInterval:C,skipPollingIfUnfocused:P}}return a},kh=({api:s,context:t,queryThunk:n,mutationThunk:i})=>{const r=Pa(n,i),o=Mr(n,i),a=ps(n,i),u={};return(c,S)=>{var g,x;if(r(c)){const{requestId:P,arg:{endpointName:C,originalArgs:v}}=c.meta,T=t.endpointDefinitions[C],j=T==null?void 0:T.onQueryStarted;if(j){const N={},_=new Promise((A,y)=>{N.resolve=A,N.reject=y});_.catch(()=>{}),u[P]=N;const d=s.endpoints[C].select(gi(T)?v:P),p=S.dispatch((A,y,D)=>D),L={...S,getCacheEntry:()=>d(S.getState()),requestId:P,extra:p,updateCachedData:gi(T)?A=>S.dispatch(s.util.updateQueryData(C,v,A)):void 0,queryFulfilled:_};j(v,L)}}else if(a(c)){const{requestId:P,baseQueryMeta:C}=c.meta;(g=u[P])==null||g.resolve({data:c.payload,meta:C}),delete u[P]}else if(o(c)){const{requestId:P,rejectedWithValue:C,baseQueryMeta:v}=c.meta;(x=u[P])==null||x.reject({error:c.payload??c.error,isUnhandledError:!C,meta:v}),delete u[P]}}},Ch=({reducerPath:s,context:t,api:n,refetchQuery:i,internalState:r})=>{const{removeQueryResult:o}=n.internalActions,a=(b,c)=>{Qr.match(b)&&u(c,"refetchOnFocus"),Gr.match(b)&&u(c,"refetchOnReconnect")};function u(b,c){const S=b.getState()[s],g=S.queries,x=r.currentSubscriptions;t.batch(()=>{for(const P of Object.keys(x)){const C=g[P],v=x[P];if(!v||!C)continue;(Object.values(v).some(j=>j[c]===!0)||Object.values(v).every(j=>j[c]===void 0)&&S.config[c])&&(Ps(v)===0?b.dispatch(o({queryCacheKey:P})):C.status!=="uninitialized"&&b.dispatch(i(C)))}})}return a};function Ih(s){const{reducerPath:t,queryThunk:n,api:i,context:r}=s,{apiUid:o}=r,a={invalidateTags:Fs(`${t}/invalidateTags`)},u=g=>g.type.startsWith(`${t}/`),b=[vh,bh,wh,Sh,jh,kh];return{middleware:g=>{let x=!1;const C={...s,internalState:{currentSubscriptions:{}},refetchQuery:S,isThisApiSliceAction:u},v=b.map(N=>N(C)),T=fh(C),j=Ch(C);return N=>_=>{if(!uc(_))return N(_);x||(x=!0,g.dispatch(i.internalActions.middlewareRegistered(o)));const d={...g,next:N},p=g.getState(),[L,A]=T(_,d,p);let y;if(L?y=N(_):y=A,g.getState()[t]&&(j(_,d,p),u(_)||r.hasRehydrationInfo(_)))for(const D of v)D(_,d,p);return y}},actions:a};function S(g){return s.api.endpoints[g.endpointName].initiate(g.originalArgs,{subscribe:!1,forceRefetch:!0})}}var $o=Symbol(),ul=({createSelector:s=Na}={})=>({name:$o,init(t,{baseQuery:n,tagTypes:i,reducerPath:r,serializeQueryArgs:o,keepUnusedDataFor:a,refetchOnMountOrArgChange:u,refetchOnFocus:b,refetchOnReconnect:c,invalidationBehavior:S,onSchemaFailure:g,catchSchemaFailure:x,skipSchemaValidation:P},C){lc();const v=q=>q;Object.assign(t,{reducerPath:r,endpoints:{},internalActions:{onOnline:Gr,onOffline:rl,onFocus:Qr,onFocusLost:il},util:{}});const T=mh({serializeQueryArgs:o,reducerPath:r,createSelector:s}),{selectInvalidatedBy:j,selectCachedArgsForQuery:N,buildQuerySelector:_,buildInfiniteQuerySelector:d,buildMutationSelector:p}=T;qt(t.util,{selectInvalidatedBy:j,selectCachedArgsForQuery:N});const{queryThunk:L,infiniteQueryThunk:A,mutationThunk:y,patchQueryData:D,updateQueryData:f,upsertQueryData:w,prefetch:I,buildMatchThunkActions:R}=ph({baseQuery:n,reducerPath:r,context:C,api:t,serializeQueryArgs:o,assertTagType:v,selectors:T,onSchemaFailure:g,catchSchemaFailure:x,skipSchemaValidation:P}),{reducer:m,actions:M}=xh({context:C,queryThunk:L,mutationThunk:y,serializeQueryArgs:o,reducerPath:r,assertTagType:v,config:{refetchOnFocus:b,refetchOnReconnect:c,refetchOnMountOrArgChange:u,keepUnusedDataFor:a,reducerPath:r,invalidationBehavior:S}});qt(t.util,{patchQueryData:D,updateQueryData:f,upsertQueryData:w,prefetch:I,resetApiState:M.resetApiState,upsertQueryEntries:M.cacheEntriesUpserted}),qt(t.internalActions,M);const{middleware:E,actions:l}=Ih({reducerPath:r,context:C,queryThunk:L,mutationThunk:y,infiniteQueryThunk:A,api:t,assertTagType:v,selectors:T});qt(t.util,l),qt(t,{reducer:m,middleware:E});const{buildInitiateQuery:k,buildInitiateInfiniteQuery:F,buildInitiateMutation:z,getRunningMutationThunk:U,getRunningMutationsThunk:V,getRunningQueriesThunk:H,getRunningQueryThunk:W}=uh({queryThunk:L,mutationThunk:y,infiniteQueryThunk:A,api:t,serializeQueryArgs:o,context:C});return qt(t.util,{getRunningMutationThunk:U,getRunningMutationsThunk:V,getRunningQueryThunk:W,getRunningQueriesThunk:H}),{name:$o,injectEndpoint(q,Y){var ve;const le=(ve=t.endpoints)[q]??(ve[q]={});Ci(Y)&&qt(le,{name:q,select:_(q,Y),initiate:k(q,Y)},R(L,q)),lh(Y)&&qt(le,{name:q,select:p(),initiate:z(q)},R(y,q)),Ii(Y)&&qt(le,{name:q,select:d(q,Y),initiate:F(q,Y)},R(L,q))}}}});ul();function kn(s){return s.replace(s[0],s[0].toUpperCase())}function Eh(s){return s.type==="query"}function Ah(s){return s.type==="mutation"}function hl(s){return s.type==="infinitequery"}function Hs(s,...t){return Object.assign(s,...t)}var $i=Symbol();function Fi(s,t,n,i){const r=h.useMemo(()=>({queryArgs:s,serialized:typeof s=="object"?t({queryArgs:s,endpointDefinition:n,endpointName:i}):s}),[s,t,n,i]),o=h.useRef(r);return h.useEffect(()=>{o.current.serialized!==r.serialized&&(o.current=r)},[r]),o.current.serialized===r.serialized?o.current.queryArgs:s}function Cn(s){const t=h.useRef(s);return h.useEffect(()=>{Xs(t.current,s)||(t.current=s)},[s]),Xs(t.current,s)?t.current:s}var Nh=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Th=Nh(),Ph=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Rh=Ph(),_h=()=>Th||Rh?h.useLayoutEffect:h.useEffect,Dh=_h(),Fo=s=>s.isUninitialized?{...s,isUninitialized:!1,isFetching:!0,isLoading:s.data===void 0,status:sl.pending}:s;function Bi(s,...t){const n={};return t.forEach(i=>{n[i]=s[i]}),n}var Mi=["data","status","isLoading","isSuccess","isError","error"];function Lh({api:s,moduleOptions:{batch:t,hooks:{useDispatch:n,useSelector:i,useStore:r},unstable__sideEffectsInRender:o,createSelector:a},serializeQueryArgs:u,context:b}){const c=o?d=>d():h.useEffect;return{buildQueryHooks:j,buildInfiniteQueryHooks:N,buildMutationHook:_,usePrefetch:x};function S(d,p,L){if(p!=null&&p.endpointName&&d.isUninitialized){const{endpointName:I}=p,R=b.endpointDefinitions[I];L!==St&&u({queryArgs:p.originalArgs,endpointDefinition:R,endpointName:I})===u({queryArgs:L,endpointDefinition:R,endpointName:I})&&(p=void 0)}let A=d.isSuccess?d.data:p==null?void 0:p.data;A===void 0&&(A=d.data);const y=A!==void 0,D=d.isLoading,f=(!p||p.isLoading||p.isUninitialized)&&!y&&D,w=d.isSuccess||y&&(D&&!(p!=null&&p.isError)||d.isUninitialized);return{...d,data:A,currentData:d.data,isFetching:D,isLoading:f,isSuccess:w}}function g(d,p,L){if(p!=null&&p.endpointName&&d.isUninitialized){const{endpointName:I}=p,R=b.endpointDefinitions[I];L!==St&&u({queryArgs:p.originalArgs,endpointDefinition:R,endpointName:I})===u({queryArgs:L,endpointDefinition:R,endpointName:I})&&(p=void 0)}let A=d.isSuccess?d.data:p==null?void 0:p.data;A===void 0&&(A=d.data);const y=A!==void 0,D=d.isLoading,f=(!p||p.isLoading||p.isUninitialized)&&!y&&D,w=d.isSuccess||D&&y;return{...d,data:A,currentData:d.data,isFetching:D,isLoading:f,isSuccess:w}}function x(d,p){const L=n(),A=Cn(p);return h.useCallback((y,D)=>L(s.util.prefetch(d,y,{...A,...D})),[d,L,A])}function P(d,p,{refetchOnReconnect:L,refetchOnFocus:A,refetchOnMountOrArgChange:y,skip:D=!1,pollingInterval:f=0,skipPollingIfUnfocused:w=!1,...I}={}){const{initiate:R}=s.endpoints[d],m=n(),M=h.useRef(void 0);if(!M.current){const q=m(s.internalActions.internal_getRTKQSubscriptions());M.current=q}const E=Fi(D?St:p,yi,b.endpointDefinitions[d],d),l=Cn({refetchOnReconnect:L,refetchOnFocus:A,pollingInterval:f,skipPollingIfUnfocused:w}),k=I.initialPageParam,F=Cn(k),z=h.useRef(void 0);let{queryCacheKey:U,requestId:V}=z.current||{},H=!1;U&&V&&(H=M.current.isRequestSubscribed(U,V));const W=!H&&z.current!==void 0;return c(()=>{W&&(z.current=void 0)},[W]),c(()=>{var Z;const q=z.current;if(E===St){q==null||q.unsubscribe(),z.current=void 0;return}const Y=(Z=z.current)==null?void 0:Z.subscriptionOptions;if(!q||q.arg!==E){q==null||q.unsubscribe();const le=m(R(E,{subscriptionOptions:l,forceRefetch:y,...hl(b.endpointDefinitions[d])?{initialPageParam:F}:{}}));z.current=le}else l!==Y&&q.updateSubscriptionOptions(l)},[m,R,y,E,l,W,F,d]),[z,m,R,l]}function C(d,p){return(A,{skip:y=!1,selectFromResult:D}={})=>{const{select:f}=s.endpoints[d],w=Fi(y?St:A,u,b.endpointDefinitions[d],d),I=h.useRef(void 0),R=h.useMemo(()=>a([f(w),(k,F)=>F,k=>w],p,{memoizeOptions:{resultEqualityCheck:Xs}}),[f,w]),m=h.useMemo(()=>D?a([R],D,{devModeChecks:{identityFunctionCheck:"never"}}):R,[R,D]),M=i(k=>m(k,I.current),Xs),E=r(),l=R(E.getState(),I.current);return Dh(()=>{I.current=l},[l]),M}}function v(d){h.useEffect(()=>()=>{var p,L;(L=(p=d.current)==null?void 0:p.unsubscribe)==null||L.call(p),d.current=void 0},[d])}function T(d){if(!d.current)throw new Error(Aa(38));return d.current.refetch()}function j(d){const p=(y,D={})=>{const[f]=P(d,y,D);return v(f),h.useMemo(()=>({refetch:()=>T(f)}),[f])},L=({refetchOnReconnect:y,refetchOnFocus:D,pollingInterval:f=0,skipPollingIfUnfocused:w=!1}={})=>{const{initiate:I}=s.endpoints[d],R=n(),[m,M]=h.useState($i),E=h.useRef(void 0),l=Cn({refetchOnReconnect:y,refetchOnFocus:D,pollingInterval:f,skipPollingIfUnfocused:w});c(()=>{var V,H;const U=(V=E.current)==null?void 0:V.subscriptionOptions;l!==U&&((H=E.current)==null||H.updateSubscriptionOptions(l))},[l]);const k=h.useRef(l);c(()=>{k.current=l},[l]);const F=h.useCallback(function(U,V=!1){let H;return t(()=>{var W;(W=E.current)==null||W.unsubscribe(),E.current=H=R(I(U,{subscriptionOptions:k.current,forceRefetch:!V})),M(U)}),H},[R,I]),z=h.useCallback(()=>{var U,V;(U=E.current)!=null&&U.queryCacheKey&&R(s.internalActions.removeQueryResult({queryCacheKey:(V=E.current)==null?void 0:V.queryCacheKey}))},[R]);return h.useEffect(()=>()=>{var U;(U=E==null?void 0:E.current)==null||U.unsubscribe()},[]),h.useEffect(()=>{m!==$i&&!E.current&&F(m,!0)},[m,F]),h.useMemo(()=>[F,m,{reset:z}],[F,m,z])},A=C(d,S);return{useQueryState:A,useQuerySubscription:p,useLazyQuerySubscription:L,useLazyQuery(y){const[D,f,{reset:w}]=L(y),I=A(f,{...y,skip:f===$i}),R=h.useMemo(()=>({lastArg:f}),[f]);return h.useMemo(()=>[D,{...I,reset:w},R],[D,I,w,R])},useQuery(y,D){const f=p(y,D),w=A(y,{selectFromResult:y===St||D!=null&&D.skip?void 0:Fo,...D}),I=Bi(w,...Mi);return h.useDebugValue(I),h.useMemo(()=>({...w,...f}),[w,f])}}}function N(d){const p=(A,y={})=>{const[D,f,w,I]=P(d,A,y),R=h.useRef(I);c(()=>{R.current=I},[I]);const m=h.useCallback(function(l,k){let F;return t(()=>{var z;(z=D.current)==null||z.unsubscribe(),D.current=F=f(w(l,{subscriptionOptions:R.current,direction:k}))}),F},[D,f,w]);v(D);const M=Fi(y.skip?St:A,yi,b.endpointDefinitions[d],d),E=h.useCallback(()=>T(D),[D]);return h.useMemo(()=>({trigger:m,refetch:E,fetchNextPage:()=>m(M,"forward"),fetchPreviousPage:()=>m(M,"backward")}),[E,m,M])},L=C(d,g);return{useInfiniteQueryState:L,useInfiniteQuerySubscription:p,useInfiniteQuery(A,y){const{refetch:D,fetchNextPage:f,fetchPreviousPage:w}=p(A,y),I=L(A,{selectFromResult:A===St||y!=null&&y.skip?void 0:Fo,...y}),R=Bi(I,...Mi,"hasNextPage","hasPreviousPage");return h.useDebugValue(R),h.useMemo(()=>({...I,fetchNextPage:f,fetchPreviousPage:w,refetch:D}),[I,f,w,D])}}}function _(d){return({selectFromResult:p,fixedCacheKey:L}={})=>{const{select:A,initiate:y}=s.endpoints[d],D=n(),[f,w]=h.useState();h.useEffect(()=>()=>{f!=null&&f.arg.fixedCacheKey||f==null||f.reset()},[f]);const I=h.useCallback(function(U){const V=D(y(U,{fixedCacheKey:L}));return w(V),V},[D,y,L]),{requestId:R}=f||{},m=h.useMemo(()=>A({fixedCacheKey:L,requestId:f==null?void 0:f.requestId}),[L,f,A]),M=h.useMemo(()=>p?a([m],p):m,[p,m]),E=i(M,Xs),l=L==null?f==null?void 0:f.arg.originalArgs:void 0,k=h.useCallback(()=>{t(()=>{f&&w(void 0),L&&D(s.internalActions.removeMutationResult({requestId:R,fixedCacheKey:L}))})},[D,L,f,R]),F=Bi(E,...Mi,"endpointName");h.useDebugValue(F);const z=h.useMemo(()=>({...E,originalArgs:l,reset:k}),[E,l,k]);return h.useMemo(()=>[I,z],[I,z])}}}var $h=Symbol(),Fh=({batch:s=xc,hooks:t={useDispatch:Ae,useSelector:ue,useStore:mc},createSelector:n=Na,unstable__sideEffectsInRender:i=!1,...r}={})=>({name:$h,init(o,{serializeQueryArgs:a},u){const b=o,{buildQueryHooks:c,buildInfiniteQueryHooks:S,buildMutationHook:g,usePrefetch:x}=Lh({api:o,moduleOptions:{batch:s,hooks:t,unstable__sideEffectsInRender:i,createSelector:n},serializeQueryArgs:a,context:u});return Hs(b,{usePrefetch:x}),Hs(u,{batch:s}),{injectEndpoint(P,C){if(Eh(C)){const{useQuery:v,useLazyQuery:T,useLazyQuerySubscription:j,useQueryState:N,useQuerySubscription:_}=c(P);Hs(b.endpoints[P],{useQuery:v,useLazyQuery:T,useLazyQuerySubscription:j,useQueryState:N,useQuerySubscription:_}),o[`use${kn(P)}Query`]=v,o[`useLazy${kn(P)}Query`]=T}if(Ah(C)){const v=g(P);Hs(b.endpoints[P],{useMutation:v}),o[`use${kn(P)}Mutation`]=v}else if(hl(C)){const{useInfiniteQuery:v,useInfiniteQuerySubscription:T,useInfiniteQueryState:j}=S(P);Hs(b.endpoints[P],{useInfiniteQuery:v,useInfiniteQuerySubscription:T,useInfiniteQueryState:j}),o[`use${kn(P)}InfiniteQuery`]=v}}}}}),Xr=dl(ul(),Fh());const Bh="/api",Yn=Xr({reducerPath:"exhibitorInvoiceApi",baseQuery:Yr({baseUrl:Bh,credentials:"include",prepareHeaders:s=>{const t=localStorage.getItem("exhibitor_token");return t&&s.set("authorization",`Bearer ${t}`),s.set("Content-Type","application/json"),s.set("Accept","application/json"),s}}),tagTypes:["ExhibitorInvoice"],endpoints:s=>({getExhibitorInvoice:s.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,n,i)=>[{type:"ExhibitorInvoice",id:i}]}),downloadExhibitorInvoice:s.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:s.mutation({query:({bookingId:t,...n})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:n})}),shareViaWhatsApp:s.mutation({query:({bookingId:t,...n})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:n})})})}),{useGetExhibitorInvoiceQuery:Mh,useDownloadExhibitorInvoiceMutation:zh,useShareViaEmailMutation:Oh,useShareViaWhatsAppMutation:qh}=Yn,pl=({booking:s})=>{var p,L,A;const t=()=>{const y=new Date(s.exhibitionId.startDate||""),D=new Date(s.exhibitionId.endDate||""),f={};let w=new Date(y);for(;w<=D;){const R=w.toLocaleString("default",{month:"short",year:"numeric"});f[R]||(f[R]=[]),f[R].push(w.getDate().toString().padStart(2,"0")),w=new Date(w),w.setDate(w.getDate()+1)}const I=Object.entries(f).map(([R,m])=>`${m.join(", ")} ${R}`);return`${s.exhibitionId.name||"ABSE"} (${I.join(" & ")})`},n=y=>{const D=new Date(y);return{date:D.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:D.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},i=s.stallIds.map((y,D)=>{var R;const f=y,w=y.dimensions.width*y.dimensions.height,I=w*y.ratePerSqm;return{key:y._id,sn:D+1,stallNo:y.number,stallType:((R=f.stallTypeId)==null?void 0:R.name)||"Standard",dimensions:`${y.dimensions.width}x${y.dimensions.height}m`,area:w.toFixed(0),rate:y.ratePerSqm.toFixed(0),amount:I}}),r=i.reduce((y,D)=>y+D.amount,0),o=s.calculations,a=((p=o.stalls[0])==null?void 0:p.discount)!==void 0&&((L=o.stalls[0])==null?void 0:L.discount)!==null,u=a?(A=o.stalls[0])==null?void 0:A.discount:null,b=(u==null?void 0:u.type)||"percentage",c=(u==null?void 0:u.value)||0;let S=0;a&&c>0&&(b==="percentage"?S=Math.round(r*c/100*100)/100:b==="fixed"&&(S=Math.min(c,r)));const g=r-S,x=o.taxes.find(y=>y.name.includes("GST")),P=x?x.rate:18,C=Math.round(g*P/100*100)/100,v=g+C,T=r,j=S,N=g,_=C,d=v;return e.jsx("div",{className:"invoice-container",children:e.jsxs("div",{className:"proforma-invoice",children:[e.jsxs("div",{className:"header-section",children:[e.jsx("div",{className:"logo-cell",children:"Logo"}),e.jsxs("div",{className:"title-company",children:[e.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),e.jsx("div",{className:"company-cell",children:s.exhibitionId.companyName})]})]}),e.jsxs("div",{className:"bill-to-section",children:[e.jsx("div",{className:"bill-to-cell",children:"Bill To"}),e.jsxs("div",{className:"bill-to-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Company Name"}),e.jsx("div",{className:"value-cell",children:s.companyName}),e.jsx("div",{className:"date-label-cell",children:"Date"}),e.jsx("div",{className:"date-value-cell",children:n(s.createdAt).date})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Phone No."}),e.jsx("div",{className:"value-cell",children:s.customerPhone}),e.jsx("div",{className:"date-label-cell",children:"Time"}),e.jsx("div",{className:"date-value-cell",children:n(s.createdAt).time})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"GST No."}),e.jsx("div",{className:"value-cell",children:s.customerGSTIN}),e.jsx("div",{className:"date-label-cell",children:"Invoice No"}),e.jsx("div",{className:"date-value-cell",children:s.invoiceNumber})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Address"}),e.jsx("div",{className:"value-cell",children:s.customerAddress})]})]})]}),e.jsxs("div",{className:"expo-venue-section",children:[e.jsxs("div",{className:"expo-column",children:[e.jsx("div",{className:"heading",children:"Expo Name"}),e.jsx("div",{className:"content",children:t()})]}),e.jsxs("div",{className:"venue-column",children:[e.jsx("div",{className:"heading",children:"Venue"}),e.jsx("div",{className:"content",children:s.exhibitionId.venue})]})]}),e.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),e.jsxs("div",{className:"stall-table",children:[e.jsxs("div",{className:"stall-header",children:[e.jsx("div",{className:"stall-header-cell",children:"S/N"}),e.jsx("div",{className:"stall-header-cell",children:"Stall No."}),e.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),e.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),e.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),i.map(y=>e.jsxs("div",{className:"stall-row",children:[e.jsx("div",{className:"stall-cell",children:y.sn}),e.jsx("div",{className:"stall-cell",children:y.stallNo}),e.jsx("div",{className:"stall-cell",children:y.stallType}),e.jsx("div",{className:"stall-cell",children:y.dimensions}),e.jsx("div",{className:"stall-cell",children:y.area}),e.jsx("div",{className:"stall-cell",children:Number(y.rate).toLocaleString("en-IN")}),e.jsx("div",{className:"stall-cell",children:y.amount.toLocaleString("en-IN")})]},y.key))]}),e.jsx("div",{className:"section-header",children:"Calculation Summary"}),e.jsxs("div",{className:"calc-table",children:[e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),e.jsxs("div",{className:"calc-value",children:["",T.toLocaleString("en-IN")]})]}),a&&j>0&&e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:b==="percentage"?`Discount (${c}%)`:`Discount (Fixed ${c.toLocaleString("en-IN")})`}),e.jsxs("div",{className:"calc-value",children:["-",j.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:a&&j>0?"Amount after Discount":"Net Amount"}),e.jsxs("div",{className:"calc-value",children:["",N.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["GST (",P,"%)"]}),e.jsxs("div",{className:"calc-value",children:["",_.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row total-row",children:[e.jsx("div",{className:"calc-label",children:"Total Amount"}),e.jsxs("div",{className:"calc-value",children:["",d.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"details-section",children:[e.jsxs("div",{className:"bank-details",children:[e.jsx("div",{className:"details-header",children:"Bank Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Bank Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Account No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccount})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccountName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Branch"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankBranch})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"IFSC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankIFSC})]})]}),e.jsxs("div",{className:"company-details",children:[e.jsx("div",{className:"details-header",children:"Company Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"CIN No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyCIN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Pan No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyPAN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"SAC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companySAC})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"GST No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyGST})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Email"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyEmail})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Website"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyWebsite})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Address"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyAddress})]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"PI Instruction"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),e.jsx("div",{className:"signature-section",children:e.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})};ga.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${fa}/pdf.worker.min.js`;const{Title:Uh,Text:Bo}=pe,Vh=()=>{var I,R,m,M,E,l,k,F,z,U,V,H,W,q,Y,Z,le,ve,ce;const{id:s}=ft(),{data:t,isLoading:n,error:i}=Mh(s||""),[r]=zh(),[o]=Oh(),[a]=qh(),[u,b]=h.useState(!1),[c,S]=h.useState(!1),[g,x]=h.useState(!1),[P,C]=h.useState(null),[v,T]=h.useState(1),[j]=$.useForm(),[N]=$.useForm(),[_,d]=h.useState(null);function p({numPages:te}){C(te),T(1)}const L=async()=>{try{const te=await r(s||"").unwrap(),de=URL.createObjectURL(te);d(de),b(!0)}catch(te){console.error("Error generating PDF preview:",te),ee.error("Failed to generate PDF preview")}},A=async()=>{try{const te=await r(s||"").unwrap(),de=URL.createObjectURL(te),Pe=document.createElement("a");Pe.href=de,Pe.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||s||"download"}.pdf`,document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),URL.revokeObjectURL(de)}catch(te){console.error("Error downloading PDF:",te),ee.error("Failed to download PDF")}},y=()=>{S(!0)},D=()=>{x(!0)},f=async te=>{try{await o({bookingId:s||"",email:te.email,message:te.message}).unwrap(),ee.success(`Invoice sent to ${te.email}`),S(!1),j.resetFields()}catch(de){console.error("Error sending email:",de),ee.error("Failed to send email")}},w=async te=>{try{await a({bookingId:s||"",phoneNumber:te.phoneNumber}).unwrap();const de=te.phoneNumber.replace(/\D/g,""),Pe=encodeURIComponent(te.message);window.open(`https://wa.me/${de}?text=${Pe}`,"_blank"),x(!1),N.resetFields()}catch(de){console.error("Error opening WhatsApp:",de),ee.error("Failed to open WhatsApp")}};return n?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(Bt,{size:"large"})}):i||!t?e.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[e.jsx(Uh,{level:3,children:"Invoice Not Found"}),e.jsx(Bo,{children:"The requested invoice could not be loaded. Please try again later."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(K,{title:"Invoice Details",style:{margin:"20px"},children:[e.jsx(ie,{gutter:[16,24],children:e.jsx(B,{span:24,children:e.jsxs(X,{children:[e.jsx(O,{type:"primary",icon:e.jsx(Rr,{}),onClick:L,children:"Preview Invoice"}),e.jsx(O,{icon:e.jsx(wa,{}),onClick:A,children:"Download PDF"}),e.jsx(O,{icon:e.jsx(Yt,{}),onClick:y,children:"Share via Email"}),e.jsx(O,{icon:e.jsx(Sa,{}),onClick:D,children:"Share via WhatsApp"})]})})}),e.jsx(Ee,{}),e.jsx(pl,{booking:{...t.bookingId,customerGSTIN:(I=t.bookingId)!=null&&I.customerGSTIN||((R=t.bookingId)==null?void 0:R.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(m=t.bookingId)!=null&&m.customerAddress||((M=t.bookingId)==null?void 0:M.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((E=t.bookingId.exhibitionId)==null?void 0:E.companyName)||"",bankName:((l=t.bookingId.exhibitionId)==null?void 0:l.bankName)||"",bankAccount:((k=t.bookingId.exhibitionId)==null?void 0:k.bankAccount)||"",bankAccountName:((F=t.bookingId.exhibitionId)==null?void 0:F.bankAccountName)||"",bankBranch:((z=t.bookingId.exhibitionId)==null?void 0:z.bankBranch)||"",bankIFSC:((U=t.bookingId.exhibitionId)==null?void 0:U.bankIFSC)||"",companyCIN:((V=t.bookingId.exhibitionId)==null?void 0:V.companyCIN)||"",companyPAN:((H=t.bookingId.exhibitionId)==null?void 0:H.companyPAN)||"",companySAC:((W=t.bookingId.exhibitionId)==null?void 0:W.companySAC)||"",companyGST:((q=t.bookingId.exhibitionId)==null?void 0:q.companyGST)||"",companyEmail:((Y=t.bookingId.exhibitionId)==null?void 0:Y.companyEmail)||"",companyWebsite:((Z=t.bookingId.exhibitionId)==null?void 0:Z.companyWebsite)||"",companyAddress:((le=t.bookingId.exhibitionId)==null?void 0:le.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((ce=(ve=t.bookingId.calculations)==null?void 0:ve.stalls)==null?void 0:ce.map(te=>({...te,discount:te.discount?{...te.discount,type:te.discount.type||"percentage",value:te.discount.value}:void 0})))||[]}}})]}),e.jsxs(ge,{title:"Invoice Preview",visible:u,onCancel:()=>b(!1),footer:null,width:800,children:[_&&e.jsx(ya,{file:_,onLoadSuccess:p,options:{cMapUrl:"cmaps/",cMapPacked:!0},children:e.jsx(ba,{pageNumber:v,width:750})}),P&&e.jsx("div",{style:{textAlign:"center",marginTop:"10px"},children:e.jsxs(Bo,{children:["Page ",v," of ",P]})})]}),e.jsx(ge,{title:"Share Invoice via Email",visible:c,onCancel:()=>S(!1),footer:null,children:e.jsxs($,{form:j,layout:"vertical",onFinish:f,children:[e.jsx($.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(G,{placeholder:"example@example.com"})}),e.jsx($.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:e.jsx(G.TextArea,{rows:4})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(ge,{title:"Share Invoice via WhatsApp",visible:g,onCancel:()=>x(!1),footer:null,children:e.jsxs($,{form:N,layout:"vertical",onFinish:w,children:[e.jsx($.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:e.jsx(G,{placeholder:"+1234567890"})}),e.jsx($.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:e.jsx(G.TextArea,{rows:4})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Mo,Text:zo}=pe,{TabPane:Oo}=dt,Hh=()=>{var v;const{notification:s}=it.useApp(),[t]=$.useForm(),[n]=$.useForm(),[i,r]=h.useState(!1),[o,a]=h.useState(!1),[u,b]=h.useState(!1),[c,S]=h.useState(null),g=Ae(),x=ue(T=>T.auth.user);h.useEffect(()=>{(async()=>{try{b(!0);const j=await mi.getProfile();j.data&&g($a({user:j.data,token:localStorage.getItem("token")||""}))}catch{ee.error("Failed to fetch profile")}finally{b(!1)}})()},[g]);const P=async T=>{var j,N;try{S(null),a(!0),await mi.changePassword({currentPassword:T.currentPassword,newPassword:T.newPassword}),s.success({message:"Success",description:"Password has been changed successfully"}),n.resetFields()}catch(_){S(((N=(j=_.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to change password. Please try again.")}finally{a(!1)}},C=()=>x!=null&&x.role?typeof x.role=="string"?x.role:typeof x.role=="object"&&"name"in x.role?x.role.name:"User":"User";return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ie,{gutter:[24,24],align:"middle",children:e.jsxs(B,{flex:"auto",children:[e.jsx(Mo,{level:4,children:"My Account"}),e.jsx(zo,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),e.jsx(K,{loading:u,children:e.jsxs(dt,{defaultActiveKey:"account",children:[e.jsx(Oo,{tab:"Account Information",children:e.jsxs(ie,{gutter:32,children:[e.jsx(B,{span:6,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[e.jsx(wt,{size:100,icon:e.jsx(Ce,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((v=x==null?void 0:x.username)==null?void 0:v.charAt(0).toUpperCase())||"U"}),e.jsx(Mo,{level:4,children:x==null?void 0:x.username}),e.jsx(zo,{type:"secondary",children:C()})]})}),e.jsx(B,{span:18,children:e.jsx($,{layout:"vertical",initialValues:{username:x==null?void 0:x.username,email:x==null?void 0:x.email},disabled:!0,children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:e.jsx(G,{prefix:e.jsx(Ce,{}),placeholder:"Username"})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Yt,{}),placeholder:"Email Address"})})})]})})})]})},"account"),e.jsxs(Oo,{tab:"Change Password",children:[c&&e.jsx(qe,{message:"Error",description:c,type:"error",showIcon:!0,style:{marginBottom:24}}),e.jsxs($,{form:n,layout:"vertical",onFinish:P,children:[e.jsx($.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Current Password"})}),e.jsx($.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"New Password"})}),e.jsx($.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:T})=>({validator(j,N){return!N||T("newPassword")===N?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Confirm New Password"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",loading:o,icon:e.jsx(fs,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:ws}=ae,{Title:Wh,Text:Yh}=pe,Qh=()=>{const s=Ae(),{message:t}=it.useApp(),[n]=$.useForm(),{settings:i,loading:r}=ue(x=>x.settings),[o,a]=h.useState([]),[u,b]=h.useState(0);h.useEffect(()=>{s(Js())},[s]),h.useEffect(()=>{if(i&&(n.setFieldsValue({siteName:i.siteName,adminEmail:i.adminEmail,language:i.language,timezone:i.timezone,emailNotifications:i.emailNotifications,footerText:i.footerText}),i.logo)){const x=v=>{const T=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${v}`,token:T}},{url:P,token:C}=x(i.logo);fetch(P,{headers:{authorization:`Bearer ${C}`}}).then(v=>v.blob()).then(v=>{var j;const T=URL.createObjectURL(v);a([{uid:"-1",name:((j=i.logo)==null?void 0:j.split("/").pop())||"logo",status:"done",url:T,thumbUrl:T,type:v.type,response:{path:i.logo}}])}).catch(()=>{a([])})}},[i,n]);const c=x=>{s(Zs(x)).unwrap().then(()=>t.success("Settings updated successfully")).catch(P=>t.error(`Failed to update settings: ${P}`))},S={name:"file",action:`${ne.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:o,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(x){const{status:P,name:C,response:v,uid:T}=x.file;if(P==="uploading"){a([...x.fileList]);return}if(P==="done"&&v){b(0);const j=localStorage.getItem("token"),N=`${ne.defaults.baseURL}/uploads/${v.path}`;fetch(N,{headers:{authorization:`Bearer ${j}`}}).then(_=>_.blob()).then(_=>{const d=URL.createObjectURL(_);a([{uid:x.file.uid,name:C,status:"done",url:d,thumbUrl:d,type:_.type,response:v}]),t.success(`${C} uploaded successfully`),n.setFieldValue("logo",v.path)}).catch(()=>{t.error(`${C} preview failed to load`),a([])})}else P==="error"?(t.error(`${C} upload failed.`),a([]),b(0)):P==="removed"&&(a([]),n.setFieldValue("logo",null),b(0))},onRemove(){return a([]),n.setFieldValue("logo",null),b(0),!0},customRequest:async({file:x,onSuccess:P,onError:C,onProgress:v})=>{try{s(Wn(x)).unwrap().then(T=>{P&&P(T)}).catch(T=>{C&&C(new Error(T))})}catch(T){C&&C(T)}}},g=e.jsx("div",{children:u>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Jt,{type:"circle",percent:u,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(on,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ie,{gutter:[24,24],align:"middle",children:e.jsx(B,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(Wh,{level:4,style:{margin:0},children:"Settings"}),e.jsx(Yh,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(K,{className:"info-card",children:e.jsxs($,{form:n,layout:"vertical",onFinish:c,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(ie,{gutter:24,children:[e.jsxs(B,{span:12,children:[e.jsx($.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(G,{})}),e.jsx($.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(G,{})}),e.jsx($.Item,{label:"Language",name:"language",children:e.jsxs(ae,{children:[e.jsx(ws,{value:"en",children:"English"}),e.jsx(ws,{value:"es",children:"Spanish"}),e.jsx(ws,{value:"fr",children:"French"})]})}),e.jsx($.Item,{label:"Timezone",name:"timezone",children:e.jsxs(ae,{children:[e.jsx(ws,{value:"UTC",children:"UTC"}),e.jsx(ws,{value:"EST",children:"EST"}),e.jsx(ws,{value:"PST",children:"PST"})]})}),e.jsx($.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(mt,{})})]}),e.jsxs(B,{span:12,children:[e.jsxs($.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(rn,{...S,children:o.length<1&&g}),o.length>0&&u>0&&e.jsx(Jt,{percent:u,status:"active",style:{marginTop:8}})]}),e.jsx($.Item,{label:"Footer Text",name:"footerText",children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx($.Item,{children:e.jsxs(X,{children:[e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(fs,{}),loading:r,children:"Save Settings"}),e.jsx(O,{onClick:()=>n.resetFields(),icon:e.jsx(Ll,{}),children:"Reset"})]})})]})})]})},Gh=async()=>{try{return(await ne.get("/roles")).data}catch(s){throw console.error("Error fetching roles:",s),s}},Kh=async s=>{try{return(await ne.get(`/roles/${s}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},Xh=async s=>{try{return(await ne.post("/roles",s)).data}catch(t){throw console.error("Error creating role:",t),t}},Jh=async(s,t)=>{try{return(await ne.put(`/roles/${s}`,t)).data}catch(n){throw console.error("Error updating role:",n),n}},Zh=async s=>{try{await ne.delete(`/roles/${s}`)}catch(t){throw console.error("Error deleting role:",t),t}},ep={roles:[],role:null,loading:!1,error:null},Rs=je("roles/fetchRoles",async(s,{rejectWithValue:t})=>{var n,i;try{return await Gh()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch roles")}}),zi=je("roles/fetchRoleById",async(s,{rejectWithValue:t})=>{var n,i;try{return await Kh(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch role")}}),Qn=je("roles/addRole",async(s,{rejectWithValue:t})=>{var n,i;try{return await Xh(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create role")}}),Gn=je("roles/modifyRole",async({id:s,roleData:t},{rejectWithValue:n})=>{var i,r;try{return await Jh(s,t)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update role")}}),Kn=je("roles/removeRole",async(s,{rejectWithValue:t})=>{var n,i;try{return await Zh(s),s}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete role")}}),xl=at({name:"roles",initialState:ep,reducers:{clearRoleError:s=>{s.error=null},setSelectedRole:(s,t)=>{s.role=t.payload}},extraReducers:s=>{s.addCase(Rs.pending,t=>{t.loading=!0,t.error=null}).addCase(Rs.fulfilled,(t,n)=>{t.loading=!1,t.roles=n.payload}).addCase(Rs.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(zi.pending,t=>{t.loading=!0,t.error=null}).addCase(zi.fulfilled,(t,n)=>{t.loading=!1,t.role=n.payload}).addCase(zi.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Qn.pending,t=>{t.loading=!0,t.error=null}).addCase(Qn.fulfilled,(t,n)=>{t.loading=!1,t.roles.push(n.payload)}).addCase(Qn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Gn.pending,t=>{t.loading=!0,t.error=null}).addCase(Gn.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.roles.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.roles[i]=n.payload),((r=t.role)==null?void 0:r._id)===n.payload._id&&(t.role=n.payload)}).addCase(Gn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Kn.pending,t=>{t.loading=!0,t.error=null}).addCase(Kn.fulfilled,(t,n)=>{var i;t.loading=!1,t.roles=t.roles.filter(r=>r._id!==n.payload),((i=t.role)==null?void 0:i._id)===n.payload&&(t.role=null)}).addCase(Kn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearRoleError:Jm,setSelectedRole:Zm}=xl.actions,tp=xl.reducer,{Text:qo}=pe,sp=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],Oi=sp.reduce((s,t)=>(s[t.group]||(s[t.group]=[]),s[t.group].push({key:t.key,label:t.label}),s),{}),np=({visible:s,onCancel:t,onSave:n,role:i,loading:r})=>{const[o]=$.useForm(),a=!!i,[u,b]=h.useState([]);h.useEffect(()=>{if(s)if(i){const C=i.permissions||[];o.setFieldsValue({name:i.name,description:i.description,permissions:C}),b(C)}else o.resetFields(),b([])},[s,i,o]);const c=()=>{o.setFieldsValue({permissions:u}),o.validateFields().then(C=>{n(C)})},S=C=>{const v=Oi[C].map(T=>T.key);return v.length>0&&v.every(T=>u.includes(T))},g=(C,v)=>{let T;v?T=[...u,C]:T=u.filter(j=>j!==C),b(T)},x=(C,v)=>{const T=Oi[C].map(N=>N.key);let j;if(v){const N=T.filter(_=>!u.includes(_));j=[...u,...N]}else j=u.filter(N=>!T.includes(N));b(j)},P=C=>u.includes(C);return e.jsx(ge,{title:a?"Edit Role":"Add New Role",open:s,onCancel:t,width:700,footer:[e.jsx(O,{onClick:t,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:r,onClick:c,children:a?"Update":"Create"},"submit")],children:e.jsxs($,{form:o,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[e.jsx($.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:e.jsx(G,{placeholder:"e.g., Administrator, Editor, Viewer"})}),e.jsx($.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:e.jsx(G.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),e.jsx(Ee,{plain:!0,children:"Permissions"}),e.jsx($.Item,{name:"permissions",hidden:!0,children:e.jsx(G,{})}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(Oi).map(([C,v])=>e.jsx(K,{size:"small",title:e.jsxs(X,{children:[e.jsx(qo,{strong:!0,children:C}),e.jsx(ur,{checked:S(C),onChange:T=>x(C,T.target.checked),children:"Select All"})]}),style:{marginBottom:16},children:e.jsx(ie,{gutter:[16,12],children:v.map(T=>e.jsx(B,{span:12,children:e.jsx(ur,{checked:P(T.key),onChange:j=>g(T.key,j.target.checked),children:e.jsx(qo,{children:T.label})})},T.key))})},C))})]})})},Ei=()=>{const{user:s}=ue(n=>n.auth),t=n=>{if(!s||!s.role||!s.role.permissions)return!1;const i=s.role.permissions;if(i.includes(n)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access"))return!0;const r=n.split("_");if(r.length===2){const o=r[0],a=r[1],u=[`${o}.*`,`*.${a}`,`view_${o}`,`${o}_view`,`${o}s_${a}`,`${a}_${o}`,o.endsWith("s")?`${o.slice(0,-1)}_${a}`:`${o}s_${a}`,`${o}_${a==="view"?"read":a}`,`${a==="view"?"read":a}_${o}`];for(const b of u)if(i.includes(b))return!0}return!1};return{hasPermission:t,hasAnyPermission:n=>n.some(i=>t(i)),hasAllPermissions:n=>n.every(i=>t(i))}},{Title:In,Paragraph:Uo,Text:Ss}=pe,{confirm:ip}=ge;function qi({allowed:s}){return s?e.jsx(Pr,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):e.jsx($l,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function rp(){const{message:s,notification:t}=it.useApp(),n=Ae(),{roles:i,loading:r,error:o}=ue(A=>A.role),[a,u]=h.useState(""),[b,c]=h.useState(!1),[S,g]=h.useState(null),{hasPermission:x}=Ei();h.useEffect(()=>{n(Rs())},[n]),h.useEffect(()=>{o&&t.error({message:"Error",description:o})},[o,t]);const P=()=>{g(null),c(!0)},C=A=>{g(A),c(!0)},v=A=>{S?n(Gn({id:S._id,roleData:A})).unwrap().then(()=>{c(!1),s.success("Role updated successfully")}).catch(y=>{s.error(`Failed to update role: ${y.message}`)}):n(Qn(A)).unwrap().then(()=>{c(!1),s.success("Role created successfully")}).catch(y=>{s.error(`Failed to create role: ${y.message}`)})},T=A=>{ip({title:"Are you sure you want to delete this role?",icon:e.jsx($s,{}),content:`This will permanently delete the ${A.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){n(Kn(A._id)).unwrap().then(()=>{s.success(`${A.name} role deleted successfully`)}).catch(y=>{s.error(`Failed to delete role: ${y.message}`)})}})},j=[{title:"Role",dataIndex:"name",key:"name",render:(A,y)=>e.jsxs(X,{children:[e.jsx(wt,{style:{backgroundColor:p(y.name)},children:A.charAt(0).toUpperCase()}),e.jsx(Ss,{strong:!0,children:A})]})},{title:"Description",dataIndex:"description",key:"description",render:A=>e.jsx(Ss,{type:"secondary",children:A})},{title:"Read",key:"read",align:"center",render:(A,y)=>e.jsx(qi,{allowed:N(y)})},{title:"Write",key:"write",align:"center",render:(A,y)=>e.jsx(qi,{allowed:_(y)})},{title:"Delete",key:"delete",align:"center",render:(A,y)=>e.jsx(qi,{allowed:d(y)})},{title:"Actions",key:"actions",align:"right",render:(A,y)=>e.jsxs(X,{children:[x("roles_edit")&&e.jsx(Ve,{title:y.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:e.jsx(O,{type:"primary",shape:"circle",icon:e.jsx(_s,{}),size:"small",onClick:()=>C(y),disabled:y.name==="Administrator"})}),x("roles_delete")&&e.jsx(Ve,{title:"Delete role",children:e.jsx(O,{danger:!0,shape:"circle",icon:e.jsx(nt,{}),size:"small",onClick:()=>T(y),disabled:y.name==="Administrator"})})]})}],N=A=>A.permissions.some(y=>y.endsWith("_view")),_=A=>A.permissions.some(y=>y.endsWith("_create")||y.endsWith("_edit")),d=A=>A.permissions.some(y=>y.endsWith("_delete")),p=A=>{const y=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let D=0;for(let f=0;f<A.length;f++)D=A.charCodeAt(f)+((D<<5)-D);return y[Math.abs(D)%y.length]},L=i.filter(A=>A.name.toLowerCase().includes(a.toLowerCase())||A.description.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(In,{level:2,children:"Roles & Permissions"}),e.jsx(Uo,{children:"Manage role-based access control and permissions for your users."})]}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:r&&i.length===0,children:[e.jsxs(ie,{gutter:16,style:{marginBottom:16},children:[e.jsx(B,{span:16,children:e.jsx(G,{placeholder:"Search roles...",allowClear:!0,value:a,onChange:A=>u(A.target.value),prefix:e.jsx(Ss,{type:"secondary",style:{fontSize:16},children:""})})}),e.jsx(B,{span:8,style:{textAlign:"right"},children:x("roles_create")&&e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),style:{borderRadius:6},onClick:P,children:"Add Role"})})]}),e.jsx($e,{columns:j,dataSource:L,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(A,y)=>`Showing ${y[0]}-${y[1]} of ${A} roles`},style:{marginTop:8},loading:r&&i.length>0})]}),e.jsx(K,{title:e.jsx(In,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[e.jsxs(X,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(In,{level:5,children:"Best Practices"}),e.jsxs("ul",{style:{paddingLeft:20},children:[e.jsx("li",{children:e.jsx(Ss,{children:"Follow the principle of least privilege"})}),e.jsx("li",{children:e.jsx(Ss,{children:"Regularly audit user roles"})}),e.jsx("li",{children:e.jsx(Ss,{children:"Document role responsibilities"})})]})]}),e.jsxs(X,{direction:"vertical",style:{flex:1,minWidth:250},children:[e.jsx(In,{level:5,children:"Role Inheritance"}),e.jsx(Uo,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),e.jsx(np,{visible:b,onCancel:()=>c(!1),onSave:v,role:S,loading:r})]})}const op=async()=>{try{return(await ne.get("/users")).data}catch(s){throw console.error("Error fetching users:",s),s}},ap=async s=>{try{return(await ne.get(`/users/${s}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},lp=async s=>{try{return(await ne.post("/users",s)).data}catch(t){throw console.error("Error creating user:",t),t}},cp=async(s,t)=>{try{return(await ne.put(`/users/${s}`,t)).data}catch(n){throw console.error("Error updating user:",n),n}},dp=async s=>{try{await ne.delete(`/users/${s}`)}catch(t){throw console.error("Error deleting user:",t),t}},up={users:[],selectedUser:null,loading:!1,error:null},cs=je("users/fetchUsers",async(s,{rejectWithValue:t})=>{var n,i;try{return await op()}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch users")}}),Ui=je("users/fetchUserById",async(s,{rejectWithValue:t})=>{var n,i;try{return await ap(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch user")}}),Xn=je("users/addUser",async(s,{rejectWithValue:t})=>{var n,i;try{return await lp(s)}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to create user")}}),Jn=je("users/modifyUser",async({id:s,userData:t},{rejectWithValue:n})=>{var i,r;try{return await cp(s,t)}catch(o){return n(((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update user")}}),Zn=je("users/removeUser",async(s,{rejectWithValue:t})=>{var n,i;try{return await dp(s),s}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to delete user")}}),ml=at({name:"users",initialState:up,reducers:{clearUserError:s=>{s.error=null},setSelectedUser:(s,t)=>{s.selectedUser=t.payload}},extraReducers:s=>{s.addCase(cs.pending,t=>{t.loading=!0,t.error=null}).addCase(cs.fulfilled,(t,n)=>{t.loading=!1,t.users=n.payload}).addCase(cs.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Ui.pending,t=>{t.loading=!0,t.error=null}).addCase(Ui.fulfilled,(t,n)=>{t.loading=!1,t.selectedUser=n.payload}).addCase(Ui.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Xn.pending,t=>{t.loading=!0,t.error=null}).addCase(Xn.fulfilled,(t,n)=>{t.loading=!1,t.users.push(n.payload)}).addCase(Xn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Jn.pending,t=>{t.loading=!0,t.error=null}).addCase(Jn.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.users.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.users[i]=n.payload),((r=t.selectedUser)==null?void 0:r._id)===n.payload._id&&(t.selectedUser=n.payload)}).addCase(Jn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Zn.pending,t=>{t.loading=!0,t.error=null}).addCase(Zn.fulfilled,(t,n)=>{var i;t.loading=!1,t.users=t.users.filter(r=>r._id!==n.payload),((i=t.selectedUser)==null?void 0:i._id)===n.payload&&(t.selectedUser=null)}).addCase(Zn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearUserError:ef,setSelectedUser:En}=ml.actions,hp=ml.reducer,{Text:pp}=pe,xp=({visible:s,user:t,onClose:n})=>{if(!t)return null;const i=r=>typeof r=="string"?r:r&&typeof r=="object"&&r.name?r.name:"Unknown";return e.jsxs(ge,{title:"User Details",open:s,onCancel:n,footer:null,width:600,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Ce,{}),style:{backgroundColor:"#1677ff"}}),e.jsxs("div",{style:{marginLeft:20},children:[e.jsx(pp,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),e.jsxs("div",{children:[e.jsx(re,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),e.jsx(re,{color:"blue",children:i(t.role)})]})]})]}),e.jsx(Ee,{}),e.jsxs(me,{bordered:!0,column:1,children:[e.jsx(me.Item,{label:"Username",children:t.username}),e.jsx(me.Item,{label:"Email",children:t.email}),e.jsx(me.Item,{label:"Role",children:i(t.role)}),e.jsx(me.Item,{label:"Status",children:e.jsx(re,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),e.jsx(me.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),e.jsx(me.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:An}=ae,{Text:mp}=pe,fp=({visible:s,user:t,onClose:n,onSuccess:i})=>{const{message:r}=it.useApp(),[o]=$.useForm(),a=Ae(),{roles:u,loading:b}=ue(g=>g.role),{loading:c}=ue(g=>g.user);h.useEffect(()=>{s&&t&&o.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:typeof t.role=="object"?t.role._id:t.role,isActive:t.isActive})},[s,t,o]),h.useEffect(()=>{s&&a(Rs())},[s,a]);const S=async()=>{if(t)try{const g=await o.validateFields(),x={username:g.username,name:g.name,email:g.email,role:g.role,isActive:g.isActive};g.password&&g.password.trim()!==""&&(x.password=g.password),a(Jn({id:t._id,userData:x})).unwrap().then(()=>{r.success("User updated successfully"),i(),n()}).catch(P=>{r.error(`Failed to update user: ${P}`)})}catch(g){console.error("Validation error:",g)}};return t?e.jsx(ge,{title:"Edit User",open:s,onCancel:n,width:600,footer:[e.jsx(O,{onClick:n,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:c,onClick:S,children:"Update User"},"submit")],children:e.jsxs($,{form:o,layout:"vertical",children:[e.jsx($.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(G,{placeholder:"Username"})}),e.jsx($.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:e.jsx(G,{placeholder:"Full name"})}),e.jsx($.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Email address"})}),e.jsx(Ee,{children:e.jsx(mp,{type:"secondary",children:"Change Password (Optional)"})}),e.jsx($.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"New password (optional)"})}),e.jsx(Ee,{}),e.jsx($.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(ae,{loading:b,children:u.length>0?u.map(g=>e.jsx(An,{value:g._id,children:g.name},g._id)):e.jsxs(e.Fragment,{children:[e.jsx(An,{value:"admin",children:"Admin"}),e.jsx(An,{value:"manager",children:"Manager"}),e.jsx(An,{value:"agent",children:"Agent"})]})})}),e.jsx($.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:Nn}=ae,{Text:tf}=pe,gp=({visible:s,onClose:t,onSuccess:n})=>{const{message:i}=it.useApp(),[r]=$.useForm(),o=Ae(),{roles:a,loading:u}=ue(S=>S.role),{loading:b}=ue(S=>S.user);h.useEffect(()=>{s&&o(Rs())},[s,o]),h.useEffect(()=>{s&&r.resetFields()},[s,r]);const c=async()=>{try{const S=await r.validateFields(),g={username:S.username,name:S.name,email:S.email,password:S.password,role:S.role,isActive:S.status};o(Xn(g)).unwrap().then(x=>{i.success("User created successfully"),r.resetFields(),n(),t()}).catch(x=>{i.error(`Failed to create user: ${x}`)})}catch(S){console.error("Validation error:",S)}};return e.jsx(ge,{title:"Create New User",open:s,onCancel:t,width:600,footer:[e.jsx(O,{onClick:t,children:"Cancel"},"cancel"),e.jsx(O,{type:"primary",loading:b,onClick:c,children:"Create User"},"submit")],children:e.jsxs($,{form:r,layout:"vertical",requiredMark:!1,children:[e.jsx($.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:e.jsx(G,{placeholder:"Username"})}),e.jsx($.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:e.jsx(G,{placeholder:"Full name"})}),e.jsx($.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Email address"})}),e.jsx($.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{placeholder:"Enter password"})}),e.jsx(Ee,{}),e.jsx($.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(ae,{placeholder:"Select role",loading:u,children:a.length>0?a.map(S=>e.jsx(Nn,{value:S._id,children:S.name},S._id)):e.jsxs(e.Fragment,{children:[e.jsx(Nn,{value:"admin",children:"Admin"}),e.jsx(Nn,{value:"manager",children:"Manager"}),e.jsx(Nn,{value:"agent",children:"Agent"})]})})}),e.jsx($.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:yp,Paragraph:bp,Text:Ws}=pe,{TabPane:Vi}=dt,{confirm:jp}=ge;function vp(){const{message:s,notification:t}=it.useApp(),n=Ae(),{users:i,loading:r,error:o,selectedUser:a}=ue(I=>I.user),[u,b]=h.useState(""),[c,S]=h.useState("all"),[g,x]=h.useState(!1),[P,C]=h.useState(!1),[v,T]=h.useState(!1),{hasPermission:j}=Ei();h.useEffect(()=>{n(cs())},[n]),h.useEffect(()=>{o&&t.error({message:"Error",description:o})},[o,t]),h.useEffect(()=>{a||(x(!1),C(!1))},[a]);const N=(I,R)=>{jp({title:"Are you sure you want to delete this user?",icon:e.jsx($s,{}),content:`This will permanently delete ${R}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{n(Zn(I)).unwrap().then(()=>{s.success(`${R} has been deleted successfully.`)}).catch(m=>{s.error(`Failed to delete user: ${m}`)})}})},_=I=>{n(En(I)),x(!0)},d=I=>{n(En(I)),C(!0)},p=()=>{T(!0)},L=[{title:"User",key:"user",render:(I,R)=>e.jsxs(X,{children:[e.jsx(wt,{icon:e.jsx(Ce,{}),size:"large"}),e.jsxs(X,{direction:"vertical",size:0,children:[e.jsx(Ws,{strong:!0,children:R.name||R.username}),e.jsx(Ws,{type:"secondary",style:{fontSize:"12px"},children:R.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:I=>{const R=D(I);let m=R.toLowerCase()==="admin"||R.toLowerCase()==="administrator"?"#1677ff":R.toLowerCase()==="manager"?"#52c41a":"#faad14";return e.jsx(re,{color:m,style:{fontWeight:500,borderRadius:"4px"},children:R.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(I,R)=>D(R.role).toLowerCase().indexOf(I.toLowerCase())===0},{title:"Status",key:"status",render:(I,R)=>e.jsx(X,{children:R.isActive?e.jsx(bt,{status:"success",text:e.jsx(Ws,{style:{color:"#52c41a"},children:"Active"})}):e.jsx(bt,{status:"default",text:e.jsx(Ws,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(I,R)=>R.isActive===I},{title:"Last Active",key:"lastLogin",render:(I,R)=>e.jsxs(X,{children:[e.jsx(Ze,{style:{color:"#8c8c8c"}}),e.jsx(Ws,{type:"secondary",children:R.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(I,R)=>e.jsxs(X,{size:"small",children:[j("users_view")&&e.jsx(Ve,{title:"View details",children:e.jsx(O,{type:"text",icon:e.jsx(Wt,{}),size:"small",onClick:()=>_(R)})}),j("users_edit")&&e.jsx(Ve,{title:"Edit user",children:e.jsx(O,{type:"text",icon:e.jsx(_s,{}),size:"small",onClick:()=>d(R)})}),j("users_delete")&&e.jsx(Ve,{title:"Delete user",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(nt,{}),size:"small",onClick:()=>N(R._id,R.name||R.username)})})]})}],A=I=>I.isActive?"active":"inactive",y=i.filter(I=>(c==="all"||c==="active"&&A(I)==="active"||c==="inactive"&&A(I)==="inactive")&&Object.values(I).some(R=>typeof R=="string"&&R.toLowerCase().includes(u.toLowerCase()))),D=I=>typeof I=="string"?I:I&&typeof I=="object"&&I.name?I.name:"Unknown",f={admin:i.filter(I=>{const R=D(I.role).toLowerCase();return R==="admin"||R==="administrator"}).length,manager:i.filter(I=>D(I.role).toLowerCase()==="manager").length,agent:i.filter(I=>D(I.role).toLowerCase()==="agent").length},w={active:i.filter(I=>I.isActive).length,inactive:i.filter(I=>!I.isActive).length};return e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(yp,{level:2,children:"User Management"}),e.jsx(bp,{children:"Manage user accounts, permissions, and access control."})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(B,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(be,{title:"Total Users",value:i.length,prefix:e.jsx(Ce,{}),valueStyle:{color:"#1677ff"},loading:r})})}),e.jsx(B,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(be,{title:"Active Users",value:w.active,prefix:e.jsx(Pr,{}),valueStyle:{color:"#52c41a"},loading:r})})}),e.jsx(B,{xs:24,sm:8,children:e.jsx(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsx(be,{title:"Admin Users",value:f.admin,prefix:e.jsx(Ce,{}),valueStyle:{color:"#faad14"},loading:r})})})]}),e.jsx(K,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:e.jsxs(ie,{gutter:[16,16],justify:"space-between",align:"middle",children:[e.jsx(B,{xs:24,md:12,children:e.jsx(G,{placeholder:"Search users...",prefix:e.jsx(us,{style:{color:"rgba(0,0,0,.45)"}}),onChange:I=>b(I.target.value),allowClear:!0,size:"middle"})}),e.jsx(B,{xs:24,md:12,style:{textAlign:"right"},children:e.jsxs(X,{wrap:!0,children:[e.jsx(Ve,{title:"Refresh data",children:e.jsx(O,{icon:r?e.jsx(Fl,{}):e.jsx(us,{}),onClick:()=>n(cs()),disabled:r,children:"Refresh"})}),e.jsx(O,{type:"primary",icon:e.jsx(nn,{}),onClick:p,children:"Add User"})]})})]})}),e.jsxs(K,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[e.jsxs(dt,{defaultActiveKey:"all",onChange:S,tabBarStyle:{marginBottom:24},children:[e.jsx(Vi,{tab:`All Users (${i.length})`},"all"),e.jsx(Vi,{tab:`Active (${w.active})`},"active"),e.jsx(Vi,{tab:`Inactive (${w.inactive})`},"inactive")]}),e.jsx($e,{columns:L,dataSource:y,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(I,R)=>`${R[0]}-${R[1]} of ${I} users`},loading:r})]}),e.jsx(xp,{user:i.find(I=>I._id===(a==null?void 0:a._id))||null,visible:g,onClose:()=>n(En(null))}),e.jsx(fp,{user:i.find(I=>I._id===(a==null?void 0:a._id))||null,visible:P,onClose:()=>n(En(null)),onSuccess:()=>n(cs())}),e.jsx(gp,{visible:v,onClose:()=>T(!1),onSuccess:()=>n(cs())})]})}const{Title:sf,Text:Tn,Paragraph:Ys}=pe,wp=({settings:s,onSave:t,loading:n})=>{const[i]=$.useForm();De.useEffect(()=>{i.setFieldsValue(s)},[s,i]);const r=o=>{t(o)};return e.jsxs(K,{title:e.jsxs(X,{children:[e.jsx(Yt,{}),e.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[e.jsx(Ys,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),e.jsx(qe,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs($,{form:i,layout:"vertical",initialValues:s,onFinish:r,children:[e.jsxs(ie,{gutter:[24,16],children:[e.jsxs(B,{span:24,children:[e.jsx($.Item,{name:"newLeads",valuePropName:"checked",label:e.jsx(Tn,{strong:!0,children:"New Lead Notifications"}),children:e.jsx(mt,{})}),e.jsx(Ys,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),e.jsxs(B,{span:24,children:[e.jsx($.Item,{name:"followUpReminders",valuePropName:"checked",label:e.jsx(Tn,{strong:!0,children:"Follow-up Reminders"}),children:e.jsx(mt,{})}),e.jsx(Ys,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),e.jsxs(B,{span:24,children:[e.jsx($.Item,{name:"statusChanges",valuePropName:"checked",label:e.jsx(Tn,{strong:!0,children:"Status Change Notifications"}),children:e.jsx(mt,{})}),e.jsx(Ys,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),e.jsxs(B,{span:24,children:[e.jsx($.Item,{name:"leadAssignments",valuePropName:"checked",label:e.jsx(Tn,{strong:!0,children:"Lead Assignment Notifications"}),children:e.jsx(mt,{})}),e.jsx(Ys,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),e.jsx(Ee,{}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(fs,{}),loading:n,children:"Save Email Preferences"})})]})]})},Hi=s=>{switch(s){case"NEW_BOOKING":return He.NEW_BOOKING;case"BOOKING_CONFIRMED":return He.BOOKING_CONFIRMED;case"BOOKING_CANCELLED":return He.BOOKING_CANCELLED;case"PAYMENT_RECEIVED":return He.PAYMENT_RECEIVED;case"INVOICE_GENERATED":return He.INVOICE_GENERATED;case"EXHIBITION_UPDATE":return He.EXHIBITION_UPDATE;case"SYSTEM_MESSAGE":return He.SYSTEM_MESSAGE;case"EXHIBITOR_MESSAGE":return He.EXHIBITOR_MESSAGE;case"EXHIBITOR_REGISTERED":return He.EXHIBITOR_REGISTERED;default:return He.SYSTEM_MESSAGE}},{Title:Sp,Text:nf,Paragraph:Vo}=pe,{Search:kp}=G,{TabPane:Ho}=dt,Cp=()=>{const s=ke();ft();const[t,n]=h.useState([]),[i,r]=h.useState([]),[o,a]=h.useState(!1),[u,b]=h.useState(""),[c,S]=h.useState("ALL"),[g,x]=h.useState("ALL"),[P,C]=h.useState({newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0}),[v,T]=h.useState(!1),[j,N]=h.useState("all");h.useEffect(()=>{const M=localStorage.getItem("token");M&&Te.init(M,!1),_(),Te.subscribeToNotifications();const E=k=>{const F={...k,type:Hi(k.type)};n(z=>z.some(U=>U._id===k._id)?z:[F,...z])},l=k=>{if(k.newNotifications&&k.newNotifications.length>0){const F=k.newNotifications.map(z=>({...z,type:Hi(z.type)}));n(z=>[...F.filter(V=>!z.some(H=>H._id===V._id)),...z])}};return Te.addEventListener("notification",E),Te.addEventListener("notification_update",l),()=>{Te.removeEventListener("notification",E),Te.removeEventListener("notification_update",l)}},[]),h.useEffect(()=>{d()},[t,u,c,g,j]),h.useEffect(()=>{_();const m=()=>{t.length===0&&_()};return window.addEventListener("focus",m),()=>{window.removeEventListener("focus",m)}},[t.length]);const _=async()=>{a(!0);try{const m=await Te.getNotifications(1,50);if(m.success){const M=m.data.notifications.map(E=>({...E,type:Hi(E.type)}));n(M)}}catch{zt.error({message:"Failed to fetch notifications",description:"There was an error loading your notifications. Please try again later."})}finally{a(!1)}},d=()=>{let m=t;if(j==="unread"&&(m=m.filter(M=>M.isRead===!1)),u){const M=u.toLowerCase();m=m.filter(E=>E.title.toLowerCase().includes(M)||E.message.toLowerCase().includes(M))}c!=="ALL"&&(m=m.filter(M=>M.type===c)),g!=="ALL"&&(m=m.filter(M=>M.source===g)),r(m)},p=m=>{N(m)},L=m=>{b(m)},A=()=>{b(""),S("ALL"),x("ALL"),N("all")},y=m=>{const M=Dd(m);s(M)},D=async m=>{try{await Te.markAsRead(m._id);const M=t.map(E=>E._id===m._id?{...E,isRead:!0,readAt:new Date().toISOString()}:E);n(M)}catch{zt.error({message:"Failed to mark notification as read",description:"There was an error updating the notification status. Please try again later."})}},f=async m=>{try{await Te.deleteNotification(m._id);const M=t.filter(E=>E._id!==m._id);n(M),zt.success({message:"Notification deleted",description:"The notification has been deleted successfully."})}catch{zt.error({message:"Failed to delete notification",description:"There was an error deleting the notification. Please try again later."})}},w=async()=>{try{await Te.markAllAsRead();const m=t.map(M=>({...M,isRead:!0,readAt:new Date().toISOString()}));n(m),zt.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})}catch{zt.error({message:"Failed to mark all notifications as read",description:"There was an error updating the notification status. Please try again later."})}},I=async()=>{try{await Te.deleteAllNotifications(),n([]),zt.success({message:"All notifications cleared",description:"All notifications have been deleted successfully."})}catch{zt.error({message:"Failed to clear notifications",description:"There was an error deleting the notifications. Please try again later."})}},R=m=>{T(!0),setTimeout(()=>{C(m),T(!1),zt.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return e.jsx("div",{className:"notifications-page",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:24,children:e.jsx(K,{children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsxs(B,{children:[e.jsx(Sp,{level:4,children:e.jsxs(X,{children:[e.jsx(Er,{}),"Notifications ",t.length>0?`(${t.length})`:""]})}),e.jsx(Vo,{children:"Stay updated with all your lead activities and follow-ups"})]}),e.jsx(B,{children:e.jsxs(X,{children:[e.jsx(Ve,{title:"Refresh notifications",children:e.jsx(O,{icon:e.jsx(bi,{}),onClick:_,loading:o,children:"Refresh"})}),e.jsx(O,{type:"primary",icon:e.jsx(Ar,{}),onClick:w,disabled:t.filter(m=>!m.isRead).length===0,children:"Mark All as Read"}),e.jsx(O,{type:"primary",danger:!0,icon:e.jsx(nt,{}),onClick:I,disabled:t.length===0,children:"Clear All"})]})})]})})}),e.jsx(B,{xs:24,lg:16,children:e.jsxs(K,{className:"notifications-list-card",style:{marginBottom:24},children:[e.jsxs(dt,{activeKey:j,onChange:p,tabBarExtraContent:e.jsx(X,{children:e.jsx(bt,{count:_d(t),offset:[-5,0],children:e.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[e.jsx(Ho,{tab:"All Notifications"},"all"),e.jsx(Ho,{tab:"Unread"},"unread")]}),e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[e.jsx(kp,{placeholder:"Search notifications...",onSearch:L,style:{width:300},allowClear:!0}),e.jsx(X,{children:e.jsx(O,{icon:e.jsx(Lr,{}),onClick:A,disabled:u===""&&c==="ALL"&&g==="ALL",children:"Reset Filters"})})]}),e.jsx(Pt,{dataSource:i,renderItem:m=>e.jsx(Xa,{notification:m,onView:y,onMarkAsRead:D,onDelete:f}),pagination:{pageSize:10,showTotal:(m,M)=>`${M[0]}-${M[1]} of ${m} notifications`},rowKey:"_id",loading:o,locale:{emptyText:e.jsx(Xe,{description:e.jsx("span",{children:"No notifications found"})})}})]})}),e.jsxs(B,{xs:24,lg:8,children:[e.jsx(wp,{settings:P,onSave:R,loading:v}),e.jsx(K,{title:e.jsxs(X,{children:[e.jsx(ci,{}),e.jsx("span",{children:"Notification Tips"})]}),children:e.jsx(Vo,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),e.jsx("li",{children:"Use email notifications for critical updates when you're away"}),e.jsx("li",{children:"Click on a notification to see more details or take action"}),e.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class fn extends De.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Error caught by boundary:",t,n)}render(){var t;return this.state.hasError?e.jsx(an,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[e.jsx(O,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),e.jsx(O,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Qe=s=>{var n,i;const t=((i=(n=s.response)==null?void 0:n.data)==null?void 0:i.message)||"An error occurred";throw new Error(t)},Re={getExhibitions:async()=>{try{return await ne.get("/exhibitions")}catch(s){return Qe(s)}},getActiveExhibitions:async()=>{try{return await ne.get("/exhibitions/active")}catch(s){return Qe(s)}},getExhibition:async s=>{try{return await ne.get(`/exhibitions/${s}`)}catch(t){return Qe(t)}},createExhibition:async s=>{try{return await ne.post("/exhibitions",s)}catch(t){return Qe(t)}},updateExhibition:async(s,t)=>{try{return await ne.put(`/exhibitions/${s}`,t)}catch(n){return Qe(n)}},deleteExhibition:async s=>{try{return await ne.delete(`/exhibitions/${s}`)}catch(t){return Qe(t)}},getHalls:async s=>{try{return await ne.get(`/exhibitions/${s}/halls`)}catch(t){return Qe(t)}},createHall:async(s,t)=>{try{const{_id:n,id:i,createdAt:r,updatedAt:o,...a}=t;return console.log("Creating hall with data:",{exhibitionId:s,data:a}),(await ne.post(`/exhibitions/${s}/halls`,a)).data}catch(n){throw console.error("Error creating hall:",n),n}},updateHall:async(s,t,n)=>{try{const{_id:i,id:r,createdAt:o,updatedAt:a,...u}=n;console.log("Updating hall with data:",{exhibitionId:s,hallId:t,data:u});const b=await ne.put(`/exhibitions/${s}/halls/${t}`,u);return console.log("Hall updated:",b.data),b}catch(i){return console.error("Error updating hall:",i),Qe(i)}},deleteHall:async(s,t)=>{var n,i,r;try{if(!s||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:s,hallId:t});const o=await ne.delete(`/exhibitions/${s}/halls/${t}`);if(!o.data)throw new Error("No response received from server");return o}catch(o){throw console.error("Error deleting hall:",o),((n=o.response)==null?void 0:n.status)===401?new Error("Unauthorized. Please log in again."):((i=o.response)==null?void 0:i.status)===403?new Error("You do not have permission to delete halls."):((r=o.response)==null?void 0:r.status)===404?new Error("Hall not found."):o}},saveLayout:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(n){return Qe(n)}},getLayout:async s=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${s}/layout`)}catch(t){return Qe(t)}},getStalls:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.get(`/exhibitions/${s}/stalls`,{params:{hallId:t}})}catch(n){return Qe(n)}},createStall:async(s,t)=>{try{if(!s)throw new Error("Exhibition ID is required");return await ne.post(`/exhibitions/${s}/stalls`,t)}catch(n){return Qe(n)}},updateStall:async(s,t,n)=>{try{if(!s||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:s,stallId:t,data:n});const i=await ne.put(`/exhibitions/${s}/stalls/${t}`,n);return console.log("Stall update response:",i),i}catch(i){return console.error("Error updating stall:",i),Qe(i)}},deleteStall:async(s,t)=>{try{if(!s||!t)throw new Error("Exhibition ID and Stall ID are required");return await ne.delete(`/exhibitions/${s}/stalls/${t}`)}catch(n){return Qe(n)}},getFixtures:async(s,t)=>{try{const n=`/exhibitions/${s}/fixtures`,i=t?{type:t}:void 0;return await ne.get(n,{params:i})}catch(n){return Qe(n)}},getFixture:async(s,t)=>{try{return await ne.get(`/exhibitions/${s}/fixtures/${t}`)}catch(n){return Qe(n)}},createFixture:async(s,t)=>{try{return await ne.post(`/exhibitions/${s}/fixtures`,t)}catch(n){return Qe(n)}},updateFixture:async(s,t,n)=>{try{return await ne.put(`/exhibitions/${s}/fixtures/${t}`,n)}catch(i){return Qe(i)}},deleteFixture:async(s,t)=>{try{return await ne.delete(`/exhibitions/${s}/fixtures/${t}`)}catch(n){return Qe(n)}}},Ip={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},Dt=je("exhibition/fetchExhibitions",async(s,{rejectWithValue:t})=>{try{return(await Re.getExhibitions()).data.map(r=>({...r,id:r._id||r.id})).filter(r=>r.id)}catch(n){return t(n.message)}}),vt=je("exhibition/fetchExhibition",async(s,{rejectWithValue:t})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Re.getExhibition(s)).data}catch(n){return t(n.message)}}),ei=je("exhibition/createExhibition",async(s,{rejectWithValue:t})=>{try{return(await Re.createExhibition(s)).data}catch(n){return t(n.message)}}),ti=je("exhibition/updateExhibition",async({id:s,data:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Re.updateExhibition(s,t)).data}catch(i){return n(i.message)}}),Ft=je("exhibition/fetchHalls",async(s,{rejectWithValue:t})=>{var n;try{if(!s)throw new Error("Exhibition ID is required");return(await Re.getHalls(s)).data}catch(i){return((n=i.response)==null?void 0:n.status)===404?[]:t(i.message)}}),$t=je("exhibition/fetchStalls",async({exhibitionId:s,hallId:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Re.getStalls(s,t)).data}catch(i){return n(i.message)}}),en=je("exhibition/deleteExhibition",async(s,{rejectWithValue:t})=>{try{return await Re.deleteExhibition(s),s}catch(n){return t(n.message)}}),tn=je("exhibition/fetchFixtures",async({exhibitionId:s,type:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Re.getFixtures(s,t)).data}catch(i){return n(i.message)}}),si=je("exhibition/createFixture",async({exhibitionId:s,data:t},{rejectWithValue:n})=>{try{if(!s)throw new Error("Exhibition ID is required");return(await Re.createFixture(s,t)).data}catch(i){return n(i.message)}}),ni=je("exhibition/updateFixture",async({exhibitionId:s,id:t,data:n},{rejectWithValue:i})=>{try{if(!s||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await Re.updateFixture(s,t,n)).data}catch(r){return i(r.message)}}),ii=je("exhibition/deleteFixture",async({exhibitionId:s,id:t},{rejectWithValue:n})=>{try{if(!s||!t)throw new Error("Exhibition ID and Fixture ID are required");return await Re.deleteFixture(s,t),t}catch(i){return n(i.message)}}),fl=at({name:"exhibition",initialState:Ip,reducers:{clearCurrentExhibition:s=>{s.currentExhibition=null,s.halls=[],s.stalls=[],s.fixtures=[],s.error=null},clearError:s=>{s.error=null},clearStalls:s=>{s.stalls=[]},clearFixtures:s=>{s.fixtures=[]}},extraReducers:s=>{s.addCase(Dt.pending,t=>{t.loading=!0,t.error=null}).addCase(Dt.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions=n.payload}).addCase(Dt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(vt.pending,t=>{t.loading=!0,t.error=null}).addCase(vt.fulfilled,(t,n)=>{t.loading=!1,t.currentExhibition=n.payload}).addCase(vt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ei.pending,t=>{t.loading=!0,t.error=null}).addCase(ei.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions.push(n.payload)}).addCase(ei.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ti.pending,t=>{t.loading=!0,t.error=null}).addCase(ti.fulfilled,(t,n)=>{t.loading=!1,t.currentExhibition=n.payload;const i=t.exhibitions.findIndex(r=>r.id===n.payload.id);i!==-1&&(t.exhibitions[i]=n.payload)}).addCase(ti.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Ft.pending,t=>{t.loading=!0,t.error=null}).addCase(Ft.fulfilled,(t,n)=>{t.loading=!1,t.halls=n.payload}).addCase(Ft.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase($t.pending,t=>{t.loading=!0,t.error=null}).addCase($t.fulfilled,(t,n)=>{t.loading=!1;const i=n.payload.map(r=>{var o;return{...r,id:r._id||r.id,_id:r._id||r.id,stallTypeId:typeof r.stallTypeId=="string"?r.stallTypeId:(o=r.stallTypeId)==null?void 0:o._id,stallType:r.stallType||{name:"N/A",description:null}}});n.meta.arg.hallId,t.stalls=i}).addCase($t.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(en.pending,t=>{t.loading=!0,t.error=null}).addCase(en.fulfilled,(t,n)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(i=>(i._id||i.id)!==n.payload)}).addCase(en.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(tn.pending,t=>{t.loading=!0,t.error=null}).addCase(tn.fulfilled,(t,n)=>{t.loading=!1,t.fixtures=n.payload.map(i=>({...i,id:i._id||i.id,_id:i._id||i.id}))}).addCase(tn.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(si.pending,t=>{t.loading=!0,t.error=null}).addCase(si.fulfilled,(t,n)=>{t.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id};t.fixtures.push(i)}).addCase(si.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ni.pending,t=>{t.loading=!0,t.error=null}).addCase(ni.fulfilled,(t,n)=>{t.loading=!1;const i={...n.payload,id:n.payload._id||n.payload.id,_id:n.payload._id||n.payload.id},r=t.fixtures.findIndex(o=>o.id===i.id||o._id===i._id);r!==-1&&(t.fixtures[r]=i)}).addCase(ni.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(ii.pending,t=>{t.loading=!0,t.error=null}).addCase(ii.fulfilled,(t,n)=>{t.loading=!1,t.fixtures=t.fixtures.filter(i=>i.id!==n.payload&&i._id!==n.payload)}).addCase(ii.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearCurrentExhibition:rf,clearError:of,clearStalls:af,clearFixtures:lf}=fl.actions,Ep=fl.reducer,Ye=(s,t)=>{if(!s)return"";let i=`/exhibition/${s.slug||s._id||s.id}`;return t&&(i+=`/${t}`),i},Ai=(s,t)=>s?`/exhibitions/${s.slug||s._id||s.id}`:"",{Title:Ap,Text:os}=pe,{RangePicker:Np}=hn,Tp=()=>{const{message:s,modal:t}=it.useApp(),n=ke(),i=Ae(),{exhibitions:r,loading:o}=ue(m=>m.exhibition),[a,u]=h.useState([]),[b,c]=h.useState(!1),[S,g]=h.useState(!1),[x,P]=h.useState({status:[],dateRange:null,search:"",activeStatus:null}),[C,v]=h.useState("all"),{hasPermission:T}=Ei();h.useEffect(()=>{i(Dt())},[i]);const j=h.useMemo(()=>{const m=r.length,M=r.filter(F=>F.status==="published").length,E=r.filter(F=>new Date(F.startDate)>new Date).length,l=r.filter(F=>F.status==="completed").length,k=r.filter(F=>F.isActive).length;return{total:m,active:M,upcoming:E,completed:l,activeCount:k}},[r]),N=async m=>{const M=m._id||m.id;try{c(!0),await i(en(M)).unwrap(),s.success("Exhibition deleted successfully")}catch(E){s.error(E.message||"Failed to delete exhibition")}finally{c(!1)}},_=async()=>{t.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(nt,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsxs("strong",{children:[a.length," selected exhibitions"]}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(O,{onClick:()=>ge.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(O,{danger:!0,type:"primary",onClick:async()=>{try{c(!0),await Promise.all(a.map(m=>i(en(m._id||m.id)).unwrap())),s.success(`Successfully deleted ${a.length} exhibitions`),u([])}catch(m){s.error(m.message||"Failed to delete some exhibitions")}finally{c(!1),ge.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},d=async(m,M)=>{try{g(!0);const E=m._id||m.id;await Re.updateExhibition(E,{status:M});const l=r.map(k=>(k._id||k.id)===E?{...k,status:M}:k);i(Dt.fulfilled(l,"",void 0)),s.success("Status updated successfully")}catch{s.error("Failed to update status"),i(Dt())}finally{g(!1)}},p=async(m,M)=>{try{g(!0);const E=m._id||m.id;await Re.updateExhibition(E,{isActive:M});const l=r.map(k=>(k._id||k.id)===E?{...k,isActive:M}:k);i(Dt.fulfilled(l,"",void 0)),s.success(`Exhibition ${M?"activated":"deactivated"} successfully`)}catch{s.error("Failed to update active status"),i(Dt())}finally{g(!1)}},L=(m,M)=>{const E=m._id||m.id;M==="/layout"?n(Ye(m,"layout"),{state:{exhibitionId:E}}):n(Ye(m)+M,{state:{exhibitionId:E}})},A=m=>{switch(m.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},y=(m,M)=>{const E=A(m);return e.jsxs(X,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[e.jsx(re,{color:E,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:m}),!M&&e.jsx(re,{color:"red",style:{margin:0},children:"Inactive"})]})},D=m=>{const M=new Date,E=new Date(m.startDate),l=new Date(m.endDate);if(M<E)return 0;if(M>l)return 100;const k=l.getTime()-E.getTime(),F=M.getTime()-E.getTime();return Math.round(F/k*100)},f=m=>{t.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[e.jsx(nt,{style:{color:"#F04438",fontSize:"22px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:e.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[e.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",e.jsx("strong",{children:m.name}),"?"]}),e.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[e.jsx(O,{onClick:()=>ge.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),e.jsx(O,{danger:!0,type:"primary",onClick:()=>{N(m),ge.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},w=m=>[{key:"view",label:"View Details",icon:e.jsx(Wt,{}),onClick:()=>L(m,"")},{key:"edit",label:"Edit Exhibition",icon:e.jsx(_s,{}),onClick:()=>L(m,"/edit")},{key:"layout",label:"Manage Layout",icon:e.jsx(gs,{}),onClick:()=>L(m,"/layout")},{type:"divider"},...m.status==="published"?[{key:"public-view",label:"Public View",icon:e.jsx(Wt,{}),onClick:()=>window.open(Ai(m),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:e.jsx(Lr,{}),children:[{key:"draft",label:e.jsxs(X,{children:[e.jsx(re,{color:"#faad14",style:{margin:0},children:"Draft"}),e.jsx("span",{children:"Set as Draft"})]}),icon:e.jsx(es,{}),onClick:()=>d(m,"draft"),disabled:m.status==="draft"||S},{key:"published",label:e.jsxs(X,{children:[e.jsx(re,{color:"#52c41a",style:{margin:0},children:"Published"}),e.jsx("span",{children:"Publish"})]}),icon:e.jsx(_e,{}),onClick:()=>d(m,"published"),disabled:m.status==="published"||S},{key:"completed",label:e.jsxs(X,{children:[e.jsx(re,{color:"#1890ff",style:{margin:0},children:"Completed"}),e.jsx("span",{children:"Mark as Completed"})]}),icon:e.jsx(Ze,{}),onClick:()=>d(m,"completed"),disabled:m.status==="completed"||S}]},{key:"active-status",label:e.jsxs(X,{children:[m.isActive?e.jsx(re,{color:"red",style:{margin:0},children:"Deactivate"}):e.jsx(re,{color:"#52c41a",style:{margin:0},children:"Activate"}),e.jsx("span",{children:m.isActive?"Deactivate":"Activate"})]}),icon:e.jsx(to,{}),onClick:()=>p(m,!m.isActive),disabled:S},{type:"divider"},{key:"delete",label:"Delete",icon:e.jsx(nt,{}),danger:!0,onClick:()=>f(m)}],I=h.useMemo(()=>r.filter(m=>{if(x.search&&!m.name.toLowerCase().includes(x.search.toLowerCase())||x.status.length>0&&!x.status.includes(m.status)||x.activeStatus!==null&&m.isActive!==x.activeStatus)return!1;if(x.dateRange){const[M,E]=x.dateRange,l=new Date(m.startDate),k=new Date(m.endDate);if(l<new Date(M)||k>new Date(E))return!1}switch(C){case"active":return m.status==="published";case"upcoming":return new Date(m.startDate)>new Date;case"completed":return m.status==="completed";default:return!0}}),[r,x,C]),R=[{title:"Exhibition Details",key:"details",render:(m,M)=>e.jsx(os,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>L(M,""),children:M.name})},{title:"Status",key:"status",width:180,align:"center",render:(m,M)=>y(M.status,M.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(m,M)=>M.status===m},{title:"Start Date",key:"startDate",width:130,render:(m,M)=>e.jsx(os,{children:Ie(M.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(m,M)=>e.jsx(os,{children:Ie(M.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(m,M)=>e.jsx(os,{children:Ie(M.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(m,M)=>e.jsx(Jt,{percent:D(M),size:"small",status:M.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(m,M)=>e.jsxs(X,{size:"middle",children:[T("exhibitions_view")&&e.jsx(Ve,{title:"View Details",children:e.jsx(O,{type:"text",icon:e.jsx(Wt,{}),onClick:()=>L(M,"")})}),T("exhibitions_edit")&&e.jsx(Ve,{title:"Edit Exhibition",children:e.jsx(O,{type:"text",icon:e.jsx(_s,{}),onClick:()=>L(M,"/edit")})}),T("exhibitions_delete")&&e.jsx(ms,{menu:{items:w(M)},trigger:["click"],placement:"bottomRight",children:e.jsx(O,{type:"text",icon:e.jsx($r,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(B,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(Ap,{level:4,style:{margin:0},children:"Exhibitions"}),e.jsx(os,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),e.jsx(B,{children:e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:()=>n("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginBottom:"24px"},children:[e.jsx(B,{xs:24,sm:12,md:6,lg:4,children:e.jsx(K,{children:e.jsx(be,{title:"Total Exhibitions",value:j.total,prefix:e.jsx(es,{})})})}),e.jsx(B,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(be,{title:"Published Exhibitions",value:j.active,prefix:e.jsx(_e,{style:{color:"#52c41a"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(be,{title:"Upcoming Exhibitions",value:j.upcoming,prefix:e.jsx(Ze,{style:{color:"#1890ff"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(be,{title:"Completed Exhibitions",value:j.completed,prefix:e.jsx(_e,{style:{color:"#8c8c8c"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,lg:5,children:e.jsx(K,{children:e.jsx(be,{title:"Active Status",value:j.activeCount,prefix:e.jsx(to,{style:{color:"#52c41a"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:e.jsxs(X,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(B,{flex:"auto",children:e.jsxs(X,{size:"middle",wrap:!0,children:[e.jsx(G,{placeholder:"Search exhibitions",prefix:e.jsx(us,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:x.search,onChange:m=>P(M=>({...M,search:m.target.value})),allowClear:!0}),e.jsx(ae,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:x.status,onChange:m=>P(M=>({...M,status:m})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),e.jsxs(ae,{placeholder:"Active Status",style:{width:"150px"},value:x.activeStatus,onChange:m=>P(M=>({...M,activeStatus:m})),allowClear:!0,children:[e.jsx(ae.Option,{value:!0,children:"Active"}),e.jsx(ae.Option,{value:!1,children:"Inactive"})]}),e.jsx(Np,{onChange:m=>P(M=>{var E,l;return{...M,dateRange:m?[((E=m[0])==null?void 0:E.toISOString())||"",((l=m[1])==null?void 0:l.toISOString())||""]:null}})})]})}),e.jsx(B,{children:e.jsx(Bl,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:C,onChange:m=>v(m)})})]}),a.length>0&&e.jsx(ie,{children:e.jsxs(X,{children:[e.jsxs(os,{children:["Selected ",a.length," items"]}),e.jsx(O,{danger:!0,onClick:_,children:"Delete Selected"})]})})]})}),e.jsx(K,{className:"info-card",styles:{body:{padding:0}},children:e.jsx($e,{columns:R,dataSource:I.map(m=>({...m,key:m._id||m.id})),rowKey:m=>m._id||m.id,loading:o||b||S,rowSelection:{selectedRowKeys:a.map(m=>m._id||m.id),onChange:(m,M)=>u(M),selections:[$e.SELECTION_ALL,$e.SELECTION_NONE]},footer:()=>a.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[e.jsxs(os,{children:["Selected ",e.jsx("strong",{children:a.length})," ",a.length===1?"exhibition":"exhibitions"]}),e.jsx(O,{danger:!0,onClick:_,icon:e.jsx(nt,{}),loading:b,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:m=>`Total ${m} items`,style:{marginTop:"16px"}}})})]})},Ns={getStallTypes:async()=>ne.get("/stall-types"),createStallType:async s=>ne.post("/stall-types",s),updateStallType:async(s,t)=>ne.put(`/stall-types/${s}`,t),deleteStallType:async s=>ne.delete(`/stall-types/${s}`)},{RangePicker:Pp}=hn,{Title:Ut,Text:Vt}=pe,Wo=({value:s="",onChange:t})=>{const n=De.useRef(null),[i]=De.useState(s);return e.jsx(vc,{apiKey:Ed,onInit:(r,o)=>{n.current=o},value:s,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:r=>{r.on("init",()=>{r.undoManager.clear(),r.undoManager.add()}),r.on("change",()=>{r.undoManager.add()})}},onEditorChange:r=>{t==null||t(r)}})},Rp=({form:s})=>{const[t,n]=h.useState([]),[i,r]=h.useState(!1);return h.useEffect(()=>{(async()=>{try{r(!0);const a=await Ns.getStallTypes();n(a.data.filter(u=>u.status==="active"))}catch(a){console.error("Failed to fetch stall types:",a)}finally{r(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(Ut,{level:4,children:"Basic Information"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(B,{span:24,children:e.jsx($.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:e.jsx(G,{placeholder:"Enter exhibition name"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:e.jsx(G.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:e.jsx(G,{placeholder:"Enter invoice prefix (default: INV)"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:e.jsx(Pp,{style:{width:"100%"}})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ut,{level:4,children:"Company Details"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(B,{span:12,children:[e.jsx($.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{placeholder:"Enter company name"})}),e.jsx($.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:e.jsx(G,{placeholder:"Enter contact number"})}),e.jsx($.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{placeholder:"Enter email address"})}),e.jsx($.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter company address"})}),e.jsx($.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:e.jsx(Wo,{})})]}),e.jsxs(B,{span:12,children:[e.jsx($.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:e.jsx(G,{placeholder:"Enter PAN number"})}),e.jsx($.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:e.jsx(G,{placeholder:"Enter GST number"})}),e.jsx($.Item,{name:"companySAC",label:"SAC Code No.",children:e.jsx(G,{placeholder:"Enter SAC code number"})}),e.jsx($.Item,{name:"companyCIN",label:"CIN No.",children:e.jsx(G,{placeholder:"Enter CIN number"})}),e.jsx($.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:e.jsx(G,{placeholder:"Enter website URL"})}),e.jsx($.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:e.jsx(Wo,{})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ut,{level:4,children:"Bank Details"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),e.jsxs(ie,{gutter:24,children:[e.jsxs(B,{span:12,children:[e.jsx($.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:e.jsx(G,{placeholder:"Enter bank name"})}),e.jsx($.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:e.jsx(G,{placeholder:"Enter branch name"})}),e.jsx($.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:e.jsx(G,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),e.jsxs(B,{span:12,children:[e.jsx($.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:e.jsx(G,{placeholder:"Enter account name"})}),e.jsx($.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:e.jsx(G,{placeholder:"Enter account number"})})]})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ut,{level:4,children:"Stall Rates & Pricing"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Ut,{level:5,children:"Stall Type Rates"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),e.jsx($.List,{name:"stallRates",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:b,name:c,...S})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx($.Item,{...S,name:[c,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(ae,{loading:i,placeholder:"Select stall type",style:{width:200},children:t.map(g=>e.jsx(ae.Option,{value:g._id,children:g.name},g._id))})}),e.jsx($.Item,{...S,name:[c,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:e.jsx(Ue,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"",formatter:g=>`${g}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:g=>{const x=g?Number(g.replace(/\\s?|(,*)/g,"")):0;return isNaN(x)?0:x}})}),e.jsx(As,{onClick:()=>u(c)})]},b)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Stall Type Rate"})})]})})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(Ut,{level:5,children:"Tax Configuration"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),e.jsx($.List,{name:"taxConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:b,name:c,...S})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx($.Item,{...S,name:[c,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:e.jsx(G,{placeholder:"Tax name",style:{width:150}})}),e.jsx($.Item,{...S,name:[c,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:e.jsx(Ue,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:g=>`${g}%`,parser:g=>{const x=g?Number(g.replace("%","")):0;return isNaN(x)?0:Math.min(x,100)}})}),e.jsx($.Item,{...S,name:[c,"isActive"],valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(As,{onClick:()=>u(c)})]},b)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Tax"})})]})})]}),e.jsxs("div",{children:[e.jsx(Ut,{level:5,children:"Admin Discount Configuration"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),e.jsx($.List,{name:"discountConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:b,name:c,...S})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx($.Item,{...S,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(G,{placeholder:"Discount",style:{width:150}})}),e.jsx($.Item,{...S,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(ae,{style:{width:150},children:[e.jsx(ae.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(ae.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx($.Item,{noStyle:!0,shouldUpdate:(g,x)=>{var P,C,v,T;return((C=(P=g==null?void 0:g.discountConfig)==null?void 0:P[c])==null?void 0:C.type)!==((T=(v=x==null?void 0:x.discountConfig)==null?void 0:v[c])==null?void 0:T.type)},children:({getFieldValue:g})=>{const x=g(["discountConfig",c,"type"]);return e.jsx($.Item,{...S,name:[c,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(Ue,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:P=>x==="percentage"?`${P}%`:`${P}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:P=>{const C=P?Number(P.replace(/[%,]/g,"")):0;return isNaN(C)?0:C}})})}}),e.jsx($.Item,{...S,name:[c,"isActive"],valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(As,{onClick:()=>u(c)})]},b)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Admin Discount"})})]})})]}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(Ut,{level:5,children:"Public Discount Configuration"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),e.jsx($.List,{name:"publicDiscountConfig",children:(o,{add:a,remove:u})=>e.jsxs(e.Fragment,{children:[o.map(({key:b,name:c,...S})=>e.jsxs(X,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx($.Item,{...S,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(G,{placeholder:"Discount",style:{width:150}})}),e.jsx($.Item,{...S,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(ae,{style:{width:150},children:[e.jsx(ae.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(ae.Option,{value:"fixed",children:"Fixed Amount ()"})]})}),e.jsx($.Item,{noStyle:!0,shouldUpdate:(g,x)=>{var P,C,v,T;return((C=(P=g==null?void 0:g.publicDiscountConfig)==null?void 0:P[c])==null?void 0:C.type)!==((T=(v=x==null?void 0:x.publicDiscountConfig)==null?void 0:v[c])==null?void 0:T.type)},children:({getFieldValue:g})=>{const x=g(["publicDiscountConfig",c,"type"]);return e.jsx($.Item,{...S,name:[c,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(Ue,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:P=>x==="percentage"?`${P}%`:`${P}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:P=>{const C=P?Number(P.replace(/[%,]/g,"")):0;return isNaN(C)?0:C}})})}}),e.jsx($.Item,{...S,name:[c,"isActive"],valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(As,{onClick:()=>u(c)})]},b)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(lt,{}),children:"Add Public Discount"})})]})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ut,{level:4,children:"Status Settings"}),e.jsx(Vt,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),e.jsxs(ie,{gutter:24,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(ae,{children:[e.jsx(ae.Option,{value:"draft",children:"Draft"}),e.jsx(ae.Option,{value:"published",children:"Published"}),e.jsx(ae.Option,{value:"completed",children:"Completed"})]})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:Yo,Text:Wi}=pe,_p=({form:s})=>{const{message:t}=it.useApp(),[n,i]=h.useState([]),[r,o]=h.useState([]),[a,u]=h.useState(0),[b,c]=h.useState({}),S=v=>{const T=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${v}`,token:T}};h.useEffect(()=>{const v=s.getFieldValue("headerLogo");if(v){const{url:T,token:j}=S(v);fetch(T,{headers:{authorization:`Bearer ${j}`}}).then(N=>N.blob()).then(N=>{const _=URL.createObjectURL(N);i([{uid:"-1",name:v.split("/").pop()||"logo",status:"done",url:_,thumbUrl:_,type:N.type,response:{path:v}}])}).catch(()=>{i([])})}},[s]),h.useEffect(()=>{const v=s.getFieldValue("sponsorLogos")||[];v.length>0&&Promise.all(v.map(async(T,j)=>{const{url:N,token:_}=S(T);try{const p=await(await fetch(N,{headers:{authorization:`Bearer ${_}`}})).blob(),L=URL.createObjectURL(p);return{uid:`-${j+1}`,name:T.split("/").pop()||`sponsor-${j+1}`,status:"done",url:L,thumbUrl:L,type:p.type,response:{path:T}}}catch{return null}})).then(T=>{o(T.filter(Boolean))})},[s]);const g={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(v){const{status:T,name:j,response:N,uid:_}=v.file;if(T==="uploading"){i([...v.fileList]);return}if(T==="done"&&N){const{url:d,token:p}=S(N.path);u(0),fetch(d,{headers:{authorization:`Bearer ${p}`}}).then(L=>L.blob()).then(L=>{const A=URL.createObjectURL(L);i([{uid:v.file.uid,name:j,status:"done",url:A,thumbUrl:A,type:L.type,response:N}]),t.success(`${j} uploaded successfully`),s.setFieldValue("headerLogo",N.path),N.thumbnail&&s.setFieldValue("headerLogoThumbnail",N.thumbnail)}).catch(()=>{t.error(`${j} preview failed to load`),i([])})}else T==="error"?(t.error(`${j} upload failed.`),i([]),u(0)):T==="removed"&&(i([]),s.setFieldValue("headerLogo",null),s.setFieldValue("headerLogoThumbnail",null),u(0))},customRequest:async v=>{const{onProgress:T,onSuccess:j,onError:N,file:_,action:d,headers:p}=v;try{const L=new FormData;L.append("file",_);const A=new XMLHttpRequest;A.open("POST",d||"",!0),p&&Object.keys(p).forEach(y=>{A.setRequestHeader(y,p[y])}),A.upload.onprogress=y=>{y.lengthComputable&&T&&(T({percent:y.loaded/y.total*100}),u(Math.round(y.loaded/y.total*100)))},A.onload=()=>{if(A.status>=200&&A.status<300)try{const y=JSON.parse(A.response);j==null||j(y,_),u(0)}catch(y){N==null||N(y)}else N==null||N(new Error("Upload failed"))},A.onerror=()=>{u(0),N==null||N(new Error("Upload request failed"))},A.send(L)}catch(L){u(0),N==null||N(L)}},onRemove(){return i([]),s.setFieldValue("headerLogo",null),s.setFieldValue("headerLogoThumbnail",null),u(0),!0},onPreview:async v=>{if(!v.url)return;const T=window.open("");T&&(T.document.write(`
          <img src="${v.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),T.document.head.innerHTML="<title>Image Preview</title>")}},x={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:r,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(v){const{status:T,name:j,response:N,uid:_}=v.file;if(T==="uploading"){o([...v.fileList]);return}if(T==="done"&&N&&N.paths&&N.paths.length>0){c(A=>{const y={...A};return delete y[_],y});const d=N.paths[0],{url:p,token:L}=S(d);fetch(p,{headers:{authorization:`Bearer ${L}`}}).then(A=>A.blob()).then(A=>{const y=URL.createObjectURL(A),D=[...r],f=D.findIndex(R=>R.uid===v.file.uid),w={uid:v.file.uid,name:j,status:"done",url:y,thumbUrl:y,type:A.type,response:{path:d}};f>-1?D[f]=w:D.push(w),o(D),t.success(`${j} uploaded successfully`);const I=D.filter(R=>{var m;return R.status==="done"&&((m=R.response)==null?void 0:m.path)}).map(R=>R.response.path);if(s.setFieldValue("sponsorLogos",I),N.thumbnails&&N.thumbnails.length>0){const R=s.getFieldValue("sponsorLogoThumbnails")||[];s.setFieldValue("sponsorLogoThumbnails",[...R,...N.thumbnails])}}).catch(()=>{t.error(`${j} preview failed to load`),o(A=>A.filter(y=>y.uid!==v.file.uid))})}else T==="error"?(t.error(`${j} upload failed.`),o(d=>d.filter(p=>p.uid!==v.file.uid)),c(d=>{const p={...d};return delete p[_],p})):T==="removed"&&c(d=>{const p={...d};return delete p[_],p})},customRequest:async v=>{const{onProgress:T,onSuccess:j,onError:N,file:_,action:d,headers:p}=v,L=typeof _=="object"&&"uid"in _?_.uid:String(Date.now());try{const A=new FormData;A.append("file",_);const y=new XMLHttpRequest;y.open("POST",d||"",!0),p&&Object.keys(p).forEach(D=>{y.setRequestHeader(D,p[D])}),y.upload.onprogress=D=>{if(D.lengthComputable&&T){const f=D.loaded/D.total*100;T({percent:f}),c(w=>({...w,[L]:Math.round(f)}))}},y.onload=()=>{if(y.status>=200&&y.status<300)try{const D=JSON.parse(y.response);j==null||j(D,_),c(f=>{const w={...f};return delete w[L],w})}catch(D){N==null||N(D)}else N==null||N(new Error("Upload failed"))},y.onerror=()=>{c(D=>{const f={...D};return delete f[L],f}),N==null||N(new Error("Upload request failed"))},y.send(A)}catch(A){c(y=>{const D={...y};return delete D[L],D}),N==null||N(A)}},onRemove(v){var _;const T=r.filter(d=>d.uid!==v.uid);o(T);const j=T.filter(d=>{var p;return d.status==="done"&&((p=d.response)==null?void 0:p.path)}).map(d=>d.response.path);s.setFieldValue("sponsorLogos",j);const N=s.getFieldValue("sponsorLogoThumbnails")||[];if(N.length>0&&(_=v.response)!=null&&_.path){const d=v.response.path.split("/"),p=d[d.length-1],L=N.filter(A=>!A.includes(p));s.setFieldValue("sponsorLogoThumbnails",L)}return c(d=>{const p={...d};return delete p[v.uid],p}),!0},onPreview:async v=>{if(!v.url)return;const T=window.open("");T&&(T.document.write(`
          <img src="${v.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),T.document.head.innerHTML="<title>Image Preview</title>")}},P=e.jsx("div",{children:a>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Jt,{type:"circle",percent:a,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(on,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),C=e.jsxs("div",{children:[e.jsx(on,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return e.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:e.jsxs(K,{className:"settings-card",children:[e.jsx(Yo,{level:4,children:"Header Settings"}),e.jsx(Wi,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),e.jsxs(ie,{gutter:24,children:[e.jsx(B,{span:24,children:e.jsxs($.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(rn,{...g,children:n.length<1&&P}),n.length>0&&a>0&&e.jsx(Jt,{percent:a,status:"active",style:{marginTop:8}})]})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:e.jsx(G,{placeholder:"Enter a title for your exhibition header"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:e.jsx(G,{placeholder:"Enter a subtitle (optional)"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:e.jsx(G.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),e.jsxs(B,{span:24,children:[e.jsx(Ee,{}),e.jsx(Yo,{level:5,children:"Sponsor Logos"}),e.jsx(Wi,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),e.jsxs($.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[e.jsx(rn,{...x,children:C}),Object.entries(b).map(([v,T])=>{var j;return e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[e.jsxs(Wi,{style:{marginRight:10,width:150},ellipsis:!0,children:[((j=r.find(N=>N.uid===v))==null?void 0:j.name)||"File",":"]}),e.jsx(Jt,{percent:T,status:"active",style:{flex:1}})]},v)})]})]})]})]})})},{Title:Qo,Text:Go}=pe,Dp=({form:s})=>{const{message:t}=it.useApp(),[n,i]=h.useState([]),r=a=>{const u=localStorage.getItem("token");return{url:`${ne.defaults.baseURL}/uploads/${a}`,token:u}};h.useEffect(()=>{const a=s.getFieldValue("footerLogo");if(a){const{url:u,token:b}=r(a);fetch(u,{headers:{authorization:`Bearer ${b}`}}).then(c=>c.blob()).then(c=>{const S=URL.createObjectURL(c);i([{uid:"-1",name:a.split("/").pop()||"logo",status:"done",url:S,thumbUrl:S,type:c.type,response:{path:a}}])}).catch(()=>{i([])})}},[s]);const o={name:"file",action:`${ne.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:n,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:u,name:b,response:c}=a.file;if(u==="uploading"){i([...a.fileList]);return}if(u==="done"&&c){const{url:S,token:g}=r(c.path);fetch(S,{headers:{authorization:`Bearer ${g}`}}).then(x=>x.blob()).then(x=>{const P=URL.createObjectURL(x);i([{uid:a.file.uid,name:b,status:"done",url:P,thumbUrl:P,type:x.type,response:c}]),t.success(`${b} uploaded successfully`),s.setFieldValue("footerLogo",c.path)}).catch(()=>{t.error(`${b} preview failed to load`),i([])})}else u==="error"?(t.error(`${b} upload failed.`),i([])):u==="removed"&&(i([]),s.setFieldValue("footerLogo",null))},onRemove(){return i([]),s.setFieldValue("footerLogo",null),!0},onPreview:async a=>{if(!a.url)return;const u=window.open("");u&&(u.document.write(`
          <img src="${a.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),u.document.head.innerHTML="<title>Image Preview</title>")}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(Qo,{level:4,children:"Footer Content"}),e.jsx(Go,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),e.jsxs(ie,{gutter:24,children:[e.jsx(B,{span:24,children:e.jsx($.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:e.jsx(rn,{...o,children:n.length<1&&e.jsxs("div",{children:[e.jsx(on,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:e.jsx(G,{placeholder:"Enter contact email"})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:e.jsx(G,{placeholder:"Enter contact phone number"})})})]})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Qo,{level:4,children:"Footer Links"}),e.jsx(Go,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),e.jsx($.List,{name:"footerLinks",children:(a,{add:u,remove:b})=>e.jsxs(e.Fragment,{children:[a.map(({key:c,name:S,...g})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(B,{span:11,children:e.jsx($.Item,{...g,name:[S,"label"],rules:[{required:!0,message:"Please enter link label"}],children:e.jsx(G,{placeholder:"Link Label"})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{...g,name:[S,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:e.jsx(G,{placeholder:"URL (e.g., https://example.com)"})})}),e.jsx(B,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(As,{onClick:()=>b(S)})})]},c)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>u(),block:!0,icon:e.jsx(lt,{}),children:"Add Footer Link"})})]})})]})]})},{Title:Ko,Text:Xo}=pe,Lp=()=>e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(K,{className:"settings-card",children:[e.jsx(Ko,{level:4,children:"Exhibition Amenities"}),e.jsx(Xo,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add amenities and facilities available at your exhibition with their rates"}),e.jsx($.List,{name:"amenities",children:(s,{add:t,remove:n})=>e.jsxs(e.Fragment,{children:[s.map(({key:i,name:r,...o})=>e.jsxs(ie,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(B,{span:6,children:e.jsx($.Item,{...o,name:[r,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(ae,{placeholder:"Select type",children:[e.jsx(ae.Option,{value:"facility",children:"Facility"}),e.jsx(ae.Option,{value:"service",children:"Service"}),e.jsx(ae.Option,{value:"equipment",children:"Equipment"}),e.jsx(ae.Option,{value:"other",children:"Other"})]})})}),e.jsx(B,{span:6,children:e.jsx($.Item,{...o,name:[r,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(G,{placeholder:"Enter name (e.g. Power)"})})}),e.jsx(B,{span:7,children:e.jsx($.Item,{...o,name:[r,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(G.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(B,{span:4,children:e.jsx($.Item,{...o,name:[r,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:e.jsx(Ue,{style:{width:"100%"},placeholder:"Enter rate",prefix:"",min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:a=>{const u=a?Number(a.replace(/\\s?|(,*)/g,"")):0;return isNaN(u)?0:u}})})}),e.jsx(B,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(As,{onClick:()=>n(r)})})]},i)),e.jsx($.Item,{children:e.jsx(O,{type:"dashed",onClick:()=>t(),block:!0,icon:e.jsx(lt,{}),children:"Add Amenity"})})]})})]}),e.jsxs(K,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Ko,{level:4,children:"Special Requirements"}),e.jsx(Xo,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),e.jsx(ie,{gutter:24,children:e.jsx(B,{span:24,children:e.jsx($.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:e.jsx(G.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),gl=({initialValues:s,onSubmit:t,submitText:n="Submit"})=>{const[i]=$.useForm(),r=a=>{t(a)},o=[{key:"general",label:"General",children:e.jsx(Rp,{form:i})},{key:"header",label:"Header",children:e.jsx(_p,{form:i})},{key:"footer",label:"Footer",children:e.jsx(Dp,{form:i})},{key:"amenities",label:"Amenities",children:e.jsx(Lp,{form:i})}];return e.jsx($,{form:i,layout:"vertical",initialValues:s,onFinish:r,style:{height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,marginBottom:"24px"},children:e.jsx(dt,{defaultActiveKey:"general",items:o,type:"card"})}),e.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:e.jsx(O,{type:"primary",htmlType:"submit",children:n})})]})})},$p=()=>{const s=ke(),t=Ae(),n=async i=>{var r;try{const[o,a]=i.dateRange,u={name:i.name,description:i.description,venue:i.venue,startDate:o.toISOString(),endDate:a.toISOString(),status:i.status||"draft",isActive:i.isActive??!0,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:{width:100,height:100},taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((r=i.amenities)==null?void 0:r.map(S=>({type:S.type,name:S.name,description:S.description,rate:S.rate})))||[],specialRequirements:i.specialRequirements},b=await t(ei(u)).unwrap();ee.success("Exhibition created successfully");const c=b._id||b.id;c?s(Ye({_id:c,id:c,name:u.name}),{state:{exhibitionId:c}}):(ee.error("Exhibition ID not found in response"),s("/exhibition"))}catch(o){ee.error(o.message||"Failed to create exhibition"),console.error("Error creating exhibition:",o)}};return e.jsx(K,{title:"Create New Exhibition",children:e.jsx(gl,{onSubmit:n,submitText:"Create Exhibition"})})},{Title:Jo,Text:et,Paragraph:Yi}=pe,Qi=()=>{const s=ke();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>s("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Fp=()=>{const{id:s}=ft(),t=ke(),n=Ae(),{currentExhibition:i,halls:r,stalls:o,loading:a}=ue(v=>v.exhibition),[u,b]=h.useState(0);h.useEffect(()=>{s&&(n(vt(s)),n(Ft(s)),n($t({exhibitionId:s})))},[s,n]),h.useEffect(()=>{i&&S()},[i]);const c=()=>{if(!i)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const v=r.length||0;let T=o.length||0,j=o.filter(N=>N.status==="booked"||N.status==="reserved").length;return T===0&&(i.stalls&&i.stalls.length>0?(T=i.stalls.length,j=i.stalls.filter(N=>N.status==="booked"||N.status==="reserved").length):(T=i.stallCount||0,j=i.bookedStallCount||0)),{hallCount:v,stallCount:T,bookedStallCount:j,availableStallCount:T-j}},S=()=>{if(!i)return 0;const v=new Date,T=new Date(i.startDate),j=new Date(i.endDate);if(v<T)return b(0);if(v>j)return b(100);const N=j.getTime()-T.getTime(),_=v.getTime()-T.getTime();b(Math.round(_/N*100))},g=v=>{switch(v.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},x=()=>{if(!i)return{text:"",count:0,isPast:!1};const v=new Date,T=new Date(i.startDate),j=new Date(i.endDate);return v>j?{text:"Ended",count:Math.ceil((v.getTime()-j.getTime())/864e5),isPast:!0}:v>=T&&v<=j?{text:"Days Remaining",count:Math.ceil((j.getTime()-v.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((T.getTime()-v.getTime())/(1e3*60*60*24)),isPast:!1}},P=v=>{t(Ye(i,v))};if(a)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Qi,{}),e.jsx(K,{children:e.jsx(Rt,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!i)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Qi,{}),e.jsx(K,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(Ls,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx(Jo,{level:4,children:"Exhibition not found"}),e.jsx(Yi,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const C=x();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(Qi,{}),e.jsx(K,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsxs(B,{xs:24,md:16,children:[e.jsx(Jo,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:i.name}),e.jsx(Yi,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:i.description}),e.jsxs(X,{split:e.jsx(Ee,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(X,{children:[e.jsx(Ct,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(et,{style:{color:"rgba(255,255,255,0.8)"},children:[Ie(i.startDate).format("MMM D, YYYY")," - ",Ie(i.endDate).format("MMM D, YYYY")]})]}),i.venue&&e.jsxs(X,{children:[e.jsx(hs,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(et,{style:{color:"rgba(255,255,255,0.8)"},children:i.venue})]})]})]}),e.jsx(B,{xs:24,md:8,children:e.jsxs(K,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:g(i.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:i.status.toUpperCase()}),e.jsx(be,{title:C.text,value:C.count,suffix:"days",valueStyle:{color:C.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(Ze,{})}),e.jsx(Ee,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(et,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(Jt,{percent:u,status:u===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(B,{xs:24,sm:8,children:e.jsx(O,{type:"primary",icon:e.jsx(gs,{}),onClick:()=>P(`${s}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(B,{xs:24,sm:8,children:e.jsx(O,{icon:e.jsx(_s,{}),onClick:()=>P(`${s}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(B,{xs:24,sm:8,children:e.jsx(O,{icon:e.jsx(Wt,{}),onClick:()=>window.open(Ai(i),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:i.status!=="published",children:"View Public Page"})})]}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:24,lg:16,children:e.jsxs(K,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsxs(B,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(et,{strong:!0,style:{fontSize:"16px"},children:Ie(i.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(et,{strong:!0,style:{fontSize:"16px"},children:Ie(i.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(et,{strong:!0,style:{fontSize:"16px"},children:Ie(i.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(B,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(re,{color:g(i.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(re,{color:i.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:i.isActive?"ACTIVE":"INACTIVE"})]}),i.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(et,{strong:!0,style:{fontSize:"16px"},children:i.venue})]})]})]}),e.jsx(Ee,{}),e.jsxs("div",{children:[e.jsx(et,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(Yi,{children:i.description||"No description provided."})]})]})}),e.jsxs(B,{xs:24,lg:8,children:[e.jsx(K,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:e.jsxs(ie,{gutter:[16,24],children:[e.jsx(B,{span:12,children:e.jsx(be,{title:"Halls",value:c().hallCount,prefix:e.jsx(pn,{})})}),e.jsx(B,{span:12,children:e.jsx(be,{title:"Stalls",value:c().stallCount,prefix:e.jsx(ct,{})})}),e.jsx(B,{span:12,children:e.jsx(be,{title:"Booked Stalls",value:c().bookedStallCount,prefix:e.jsx(_e,{})})}),e.jsx(B,{span:12,children:e.jsx(be,{title:"Available Stalls",value:c().availableStallCount,prefix:e.jsx(Ml,{})})})]})}),e.jsx(K,{title:"Created By",style:{borderRadius:"12px"},children:i.createdBy?e.jsxs(X,{children:[e.jsx(wt,{icon:e.jsx(Ce,{})}),e.jsx(et,{children:i.createdByName||"Administrator"})]}):e.jsx(et,{type:"secondary",children:"Information not available"})})]})]})]})},Bp=()=>{var P;const{message:s}=it.useApp(),{id:t}=ft(),i=(P=Qt().state)==null?void 0:P.exhibitionId,r=ke(),o=Ae(),{currentExhibition:a,loading:u,error:b}=ue(C=>C.exhibition),[c,S]=h.useState(!1);h.useEffect(()=>{(async()=>{if(!i){s.error("Exhibition ID not found"),r("/exhibition");return}try{await o(vt(i)).unwrap()}catch(v){s.error(v.message||"Failed to fetch exhibition"),r("/exhibition")}finally{S(!0)}})()},[i,o,s,r]),h.useEffect(()=>{b&&s.error(b)},[b,s]);const g=async C=>{var v;if(!(!i||!a))try{const[T,j]=C.dateRange,N={name:C.name,description:C.description,venue:C.venue,startDate:T.toISOString(),endDate:j.toISOString(),status:C.status,isActive:C.isActive,invoicePrefix:C.invoicePrefix,stallRates:C.stallRates||[],dimensions:a.dimensions,taxConfig:C.taxConfig||[],discountConfig:C.discountConfig||[],publicDiscountConfig:C.publicDiscountConfig||[],companyName:C.companyName,companyContactNo:C.companyContactNo,companyEmail:C.companyEmail,companyAddress:C.companyAddress,companyWebsite:C.companyWebsite,companyPAN:C.companyPAN,companyGST:C.companyGST,companySAC:C.companySAC,companyCIN:C.companyCIN,termsAndConditions:C.termsAndConditions,piInstructions:C.piInstructions,bankName:C.bankName,bankBranch:C.bankBranch,bankIFSC:C.bankIFSC,bankAccountName:C.bankAccountName,bankAccount:C.bankAccount,headerTitle:C.headerTitle,headerSubtitle:C.headerSubtitle,headerDescription:C.headerDescription,headerLogo:C.headerLogo,sponsorLogos:C.sponsorLogos||[],footerText:C.footerText,footerLogo:C.footerLogo,contactEmail:C.contactEmail,contactPhone:C.contactPhone,footerLinks:C.footerLinks||[],amenities:((v=C.amenities)==null?void 0:v.map(_=>({type:_.type,name:_.name,description:_.description,rate:_.rate})))||[],specialRequirements:C.specialRequirements};await o(ti({id:i,data:N})).unwrap(),s.success("Exhibition updated successfully"),r(Ye(a),{state:{exhibitionId:i}})}catch(T){s.error(T.message||"Failed to update exhibition")}};if(!c)return e.jsx(K,{loading:!0});if(!i)return e.jsx(ji,{to:"/exhibition",replace:!0});if(u||!a)return e.jsx(K,{loading:!0});const x={name:a.name,description:a.description,venue:a.venue,dateRange:[Ie(a.startDate),Ie(a.endDate)],status:a.status,isActive:a.isActive,invoicePrefix:a.invoicePrefix,stallRates:a.stallRates||[],taxConfig:a.taxConfig||[],discountConfig:a.discountConfig||[],publicDiscountConfig:a.publicDiscountConfig||[],companyName:a.companyName,companyContactNo:a.companyContactNo,companyEmail:a.companyEmail,companyAddress:a.companyAddress,companyWebsite:a.companyWebsite,companyPAN:a.companyPAN,companyGST:a.companyGST,companySAC:a.companySAC,companyCIN:a.companyCIN,termsAndConditions:a.termsAndConditions,piInstructions:a.piInstructions,bankName:a.bankName,bankBranch:a.bankBranch,bankIFSC:a.bankIFSC,bankAccountName:a.bankAccountName,bankAccount:a.bankAccount,headerTitle:a.headerTitle,headerSubtitle:a.headerSubtitle,headerDescription:a.headerDescription,headerLogo:a.headerLogo,sponsorLogos:a.sponsorLogos||[],footerText:a.footerText,footerLogo:a.footerLogo,contactEmail:a.contactEmail,contactPhone:a.contactPhone,footerLinks:a.footerLinks||[],amenities:a.amenities||[],specialRequirements:a.specialRequirements};return e.jsx(K,{title:"Edit Exhibition",extra:e.jsx("a",{onClick:()=>r(Ye(a),{state:{exhibitionId:i}}),children:"Back to Details"}),children:e.jsx(gl,{initialValues:x,onSubmit:g,submitText:"Update Exhibition"})})},Zo=({width:s,height:t,scale:n=1,position:i={x:0,y:0},isSelected:r=!1,onSelect:o=()=>{},onChange:a=()=>{},children:u,isEditable:b=!0})=>{const c=g=>{b&&(o(),g.cancelBubble=!0)},S=De.useMemo(()=>{const g=[];for(let P=0;P<=s;P+=5)g.push(e.jsx(xi,{points:[P,0,P,t],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`v${P}`));for(let P=0;P<=t;P+=5)g.push(e.jsx(xi,{points:[0,P,s,P],stroke:"#e8e8e8",strokeWidth:1/n,dash:[5/n]},`h${P}`));return g},[s,t,n]);return e.jsxs(Ds,{x:i.x,y:i.y,width:s,height:t,onClick:c,children:[e.jsx(vi,{width:s,height:t,fill:"#ffffff",stroke:r&&b?"#1890ff":"#d9d9d9",strokeWidth:r&&b?2/n:1/n,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/n,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/n}),e.jsx(Ds,{children:S}),e.jsx(cn,{text:`${s}m  ${t}m`,fontSize:14/n,fill:"#666666",x:5,y:5}),u]})},Mp=({visible:s,width:t,height:n,onCancel:i,onSubmit:r})=>{const[o]=$.useForm();De.useEffect(()=>{s&&o.setFieldsValue({width:t,height:n})},[s,t,n,o]);const a=()=>{o.validateFields().then(u=>{r(u),o.resetFields()})};return e.jsx(ge,{title:"Edit Exhibition Space",open:s,onCancel:()=>{o.resetFields(),i()},onOk:a,destroyOnClose:!0,children:e.jsxs($,{form:o,layout:"vertical",initialValues:{width:t,height:n},children:[e.jsx($.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(Ue,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),e.jsx($.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(Ue,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},yl=({hall:s,isSelected:t=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:u=100,isStallMode:b=!1})=>{const c=De.useRef(null),S=De.useRef(null),g=De.useMemo(()=>{const j=[],{width:N,height:_}=s.dimensions,d=1;for(let p=0;p<=N;p+=d)j.push(e.jsx(xi,{points:[p,0,p,_],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`v${p}`));for(let p=0;p<=_;p+=d)j.push(e.jsx(xi,{points:[0,p,N,p],stroke:"#ddd",strokeWidth:1/r,dash:[2/r,2/r],listening:!1},`h${p}`));return j},[s.dimensions.width,s.dimensions.height,r]);De.useEffect(()=>{var j;t&&S.current&&c.current&&(S.current.nodes([c.current]),(j=S.current.getLayer())==null||j.batchDraw())},[t]);const x=j=>{j.cancelBubble=!0;const N=j.target,_=N.x(),d=N.y(),p=Math.max(0,Math.min(_,a-s.dimensions.width)),L=Math.max(0,Math.min(d,u-s.dimensions.height));N.x(Math.round(p)),N.y(Math.round(L))},P=j=>{j.cancelBubble=!0;const N=j.target,_=Math.max(0,Math.min(N.x(),a-s.dimensions.width)),d=Math.max(0,Math.min(N.y(),u-s.dimensions.height));i==null||i({...s,_id:s._id,id:s.id||s._id,exhibitionId:s.exhibitionId,dimensions:{...s.dimensions,x:Math.round(_),y:Math.round(d)}})},C=j=>{j.cancelBubble=!0},v=j=>{if(!c.current)return;const N=c.current,_=N.scaleX(),d=N.scaleY();N.scaleX(1),N.scaleY(1);const p=Math.round(N.width()*_),L=Math.round(N.height()*d),A=N.x(),y=N.y(),D=Math.max(0,Math.min(A,a-p)),f=Math.max(0,Math.min(y,u-L));i==null||i({...s,_id:s._id,id:s.id||s._id,exhibitionId:s.exhibitionId,dimensions:{x:D,y:f,width:Math.max(5,Math.min(p,a-D)),height:Math.max(5,Math.min(L,u-f))}})},T=j=>{j.cancelBubble=!0,n==null||n(s)};return e.jsxs(Ds,{ref:c,x:s.dimensions.x,y:s.dimensions.y,width:s.dimensions.width,height:s.dimensions.height,draggable:!b&&!!i,onClick:T,onTap:T,onDragStart:C,onDragMove:x,onDragEnd:P,onTransformEnd:v,children:[e.jsx(vi,{width:s.dimensions.width,height:s.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}),e.jsx(Ds,{children:g}),e.jsx(cn,{text:s.name,fontSize:14/r,fill:"#000000",width:s.dimensions.width,align:"center",y:s.dimensions.height/2-7/r})]})},zp=s=>{if(!s)return"";const t=window.location.origin,n=s.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${t}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${n}?token=${i}`:""},bl=({fixture:s,isSelected:t=!1,onSelect:n,onChange:i,scale:r=1,position:o={x:0,y:0},exhibitionWidth:a=100,exhibitionHeight:u=100,isEditable:b=!0})=>{const c=De.useRef(null),S=De.useRef(null),[g,x]=h.useState("");h.useEffect(()=>{if(s.icon){const d=zp(s.icon);x(d)}else x("")},[s.icon]);const[P]=wc(g);De.useEffect(()=>{var d;t&&S.current&&c.current&&(S.current.nodes([c.current]),(d=S.current.getLayer())==null||d.batchDraw())},[t]);const C=d=>{d.cancelBubble=!0},v=d=>{d.cancelBubble=!0;const p=d.target,L=p.x(),A=p.y(),y=Math.max(0,Math.min(L,a-s.dimensions.width)),D=Math.max(0,Math.min(A,u-s.dimensions.height));p.x(Math.round(y)),p.y(Math.round(D))},T=d=>{d.cancelBubble=!0;const p=d.target,L=p.x(),A=p.y(),y=Math.max(0,Math.min(L,a-s.dimensions.width)),D=Math.max(0,Math.min(A,u-s.dimensions.height)),f=s._id||s.id;i==null||i({...s,_id:f,id:f,exhibitionId:s.exhibitionId,position:{x:Math.round(y),y:Math.round(D)}})},j=d=>{if(!c.current)return;const p=c.current,L=p.scaleX(),A=p.scaleY(),y=p.rotation();p.scaleX(1),p.scaleY(1);const D=Math.round(s.dimensions.width*L),f=Math.round(s.dimensions.height*A),w=p.x(),I=p.y(),R=Math.max(0,Math.min(w,a-D)),m=Math.max(0,Math.min(I,u-f)),M=s._id||s.id;i==null||i({...s,_id:M,id:M,exhibitionId:s.exhibitionId,position:{x:R,y:m},dimensions:{width:Math.max(.5,Math.min(D,a-R)),height:Math.max(.5,Math.min(f,u-m))},rotation:y})},N=d=>{d.cancelBubble=!0,n==null||n(s)},_=()=>{const d=s.borderColor||(t?"#1890ff":"#d9d9d9"),p=s.borderRadius!==void 0?s.borderRadius/r:3/r;return P?e.jsx(kc,{image:P,width:s.dimensions.width,height:s.dimensions.height,fill:s.color||"#ffffff",stroke:d,strokeWidth:t?2/r:1/r,cornerRadius:p,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5}):e.jsx(vi,{width:s.dimensions.width,height:s.dimensions.height,fill:s.color||"#f0f2f5",stroke:d,strokeWidth:t?2/r:1/r,cornerRadius:p,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/r,shadowOffset:{x:2/r,y:2/r},shadowOpacity:.5})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ds,{ref:c,x:s.position.x,y:s.position.y,width:s.dimensions.width,height:s.dimensions.height,rotation:s.rotation||0,draggable:b&&!!i,onClick:N,onTap:N,onDragStart:C,onDragMove:v,onDragEnd:T,onTransformEnd:j,children:[_(),s.name&&s.showName!==!1&&e.jsx(cn,{text:s.name,fontSize:12/r,fill:"#000000",width:s.dimensions.width,align:"center",y:-16/r})]}),t&&b&&e.jsx(Sc,{ref:S,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(d,p)=>p.width<.5||p.height<.5?d:p})]})},Op=({visible:s,x:t,y:n,onExhibitionClick:i,onHallClick:r,onStallClick:o,onFixtureClick:a,onClose:u})=>{if(!s)return null;const b=[{key:"exhibition",icon:e.jsx(gs,{}),label:"Exhibition Space",onClick:()=>{i(),u()}},{key:"hall",icon:e.jsx(pn,{}),label:"Add Hall",onClick:()=>{r(),u()}}];return o&&b.push({key:"stall",icon:e.jsx(ct,{}),label:"Add Stall",onClick:()=>{o(),u()}}),a&&b.push({key:"fixture",icon:e.jsx(Nr,{}),label:"Add Fixture",onClick:()=>{a(),u()}}),e.jsx("div",{style:{position:"fixed",top:n,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:e.jsx(jt,{items:b})})},qp=({stall:s,isSelected:t=!1,onSelect:n,onChange:i,hallWidth:r=0,hallHeight:o=0,hallX:a=0,hallY:u=0,scale:b=1,isDragging:c=!1})=>{const S=h.useRef(null),[g,x]=h.useState(!1),[P,C]=h.useState(!1),[v,T]=h.useState(!1);h.useEffect(()=>{T(window.innerWidth<768);const M=()=>{T(window.innerWidth<768)};return window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[]),h.useEffect(()=>{if(g&&!c)C(!0);else if(c)C(!1);else{const M=setTimeout(()=>{C(!1)},100);return()=>clearTimeout(M)}},[g,c]),h.useEffect(()=>{if(g&&S.current&&!c){if(v&&!t)return;S.current.getStage()&&S.current.moveToTop()}},[g,t,v,c]);const j=t||s.isSelected,N=h.useCallback(M=>{switch(M){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),_=h.useCallback(M=>{switch(M){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),d=h.useCallback(M=>{M.cancelBubble=!0;const E=M.target,l=E.x()-a,k=E.y()-u,F=Math.max(0,Math.min(l,r-s.dimensions.width)),z=Math.max(0,Math.min(k,o-s.dimensions.height));E.x(Math.round(F+a)),E.y(Math.round(z+u))},[a,u,r,o,s.dimensions.width,s.dimensions.height]),p=h.useCallback(M=>{if(M.cancelBubble=!0,!i)return;const E=M.target,l=E.x()-a,k=E.y()-u,F=Math.max(0,Math.min(l,r-s.dimensions.width)),z=Math.max(0,Math.min(k,o-s.dimensions.height));i({...s,id:s.id||s._id,_id:s._id||s.id,dimensions:{...s.dimensions,x:Math.round(F),y:Math.round(z)}})},[i,a,u,r,o,s]),L=h.useCallback(M=>{M.cancelBubble=!0},[]),A=h.useCallback(M=>{M.cancelBubble=!0,n&&!c&&n()},[n,c]),y=h.useCallback(()=>{v&&!j||c||x(!0)},[v,j,c]),D=h.useCallback(()=>{x(!1)},[]),f={x:0,y:0,width:10,height:10},w=s.dimensions||f,I=s.typeName||"Standard";s.ratePerSqm*w.width*w.height;const R=0,m=h.useMemo(()=>s.status!=="available"&&s.companyName?`${I} - ${w.width}${w.height}m - ${s.companyName}`:`${I} - ${w.width}${w.height}m`,[I,w.width,w.height,s.status,s.companyName]);return e.jsxs(Ds,{ref:S,x:w.x+a,y:w.y+u,width:w.width,height:w.height,draggable:!!i,onClick:A,onTap:A,onDragStart:L,onDragMove:d,onDragEnd:p,opacity:s.status==="available"?1:.7,cursor:s.status==="available"?"pointer":"default",onMouseEnter:y,onMouseLeave:D,listening:c?!1:!v||s.status==="available",transformsEnabled:c||v?"position":"all",children:[e.jsx(vi,{width:w.width,height:w.height,fill:j?"rgba(24, 144, 255, 0.1)":_(s.status),stroke:j?"#1890ff":N(s.status),strokeWidth:j?2/b:1/b,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:c?0:v?2:3,shadowOffset:{x:1,y:1},shadowOpacity:c?0:.3,rotation:R,perfectDrawEnabled:!c,transformsEnabled:c?"position":"all",cornerRadius:.05}),e.jsx(cn,{text:s.number,fontSize:Math.min(w.width,w.height)*.25,fill:"#000000",width:w.width,height:w.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!c,fontStyle:"bold",listening:!1}),j&&!c&&e.jsx(Cc,{x:w.width-2,y:2,radius:1.5,fill:"#1890ff",stroke:"#ffffff",strokeWidth:.3/b,transformsEnabled:"position",listening:!1}),P&&!c&&e.jsxs(Ic,{x:w.width/2,y:0,opacity:1,listening:!1,children:[e.jsx(Ec,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),e.jsx(cn,{text:m,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(m.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},Jr=h.memo(qp),gn=({width:s,height:t,exhibitionWidth:n=100,exhibitionHeight:i=100,halls:r=[],stalls:o=[],fixtures:a=[],selectedHall:u=null,selectedFixture:b=null,onSelectHall:c=()=>{},onSelectFixture:S=()=>{},onHallChange:g=()=>{},onFixtureChange:x=()=>{},onExhibitionChange:P=()=>{},onAddHall:C=()=>{},onAddStall:v=()=>{},onAddFixture:T=()=>{},children:j,isStallMode:N=!1,isFixtureMode:_=!1,isPublicView:d=!1})=>{const p=h.useRef(null),L=h.useRef(null),A=h.useRef(null),[y,D]=h.useState(1),[f,w]=h.useState({x:0,y:0}),[I,R]=h.useState(!1),[m,M]=h.useState(!1),[E,l]=h.useState({visible:!1,x:0,y:0}),[k,F]=h.useState(!1),[z,U]=h.useState(!1),[V,H]=h.useState(!1);h.useEffect(()=>{const oe=()=>{H(window.innerWidth<768)};return oe(),window.addEventListener("resize",oe),()=>{window.removeEventListener("resize",oe)}},[]);const W=h.useCallback(oe=>{if(oe.evt.preventDefault(),!p.current)return;const fe=p.current,xe=y,Me=fe.getPointerPosition(),rt={x:(Me.x-fe.x())/xe,y:(Me.y-fe.y())/xe},ot=1.15,gt=oe.evt.deltaY<0?xe*ot:xe/ot,ns=Math.min(Math.max(.1,gt),20),zs={x:Me.x-rt.x*ns,y:Me.y-rt.y*ns};D(ns),w(zs)},[y]),q=h.useCallback(()=>{if(!p.current)return;const oe=p.current,fe=Math.min(y*1.15,20),xe=oe.width()/2,Me=oe.height()/2,rt={x:(xe-f.x)/y,y:(Me-f.y)/y},ot={x:xe-rt.x*fe,y:Me-rt.y*fe};D(fe),w(ot)},[y,f]),Y=h.useCallback(()=>{if(!p.current)return;const oe=p.current,fe=Math.max(y/1.15,.1),xe=oe.width()/2,Me=oe.height()/2,rt={x:(xe-f.x)/y,y:(Me-f.y)/y},ot={x:xe-rt.x*fe,y:Me-rt.y*fe};D(fe),w(ot)},[y,f]),Z=h.useCallback(oe=>{oe.target===p.current&&(l({...E,visible:!1}),M(!0),L.current&&(L.current.hitGraphEnabled(!1),d&&p.current&&(p.current.container().style.cursor="grabbing",L.current.getChildren().forEach(xe=>{xe.shadowForStrokeEnabled&&(xe._savedShadowForStroke=xe.shadowForStrokeEnabled(),xe.shadowForStrokeEnabled(!1)),xe.perfectDrawEnabled&&(xe._savedPerfectDraw=xe.perfectDrawEnabled(),xe.perfectDrawEnabled(!1))}))))},[E,d]),le=h.useCallback(oe=>{d&&oe.target===p.current||oe.target===p.current&&V&&L.current&&(oe.cancelBubble=!0)},[V,d]),ve=h.useCallback(oe=>{oe.target===p.current&&(w({x:oe.target.x(),y:oe.target.y()}),L.current&&(L.current.hitGraphEnabled(!0),d&&p.current&&(p.current.container().style.cursor="",L.current.getChildren().forEach(xe=>{xe._savedShadowForStroke!==void 0&&(xe.shadowForStrokeEnabled(xe._savedShadowForStroke),delete xe._savedShadowForStroke),xe._savedPerfectDraw!==void 0&&(xe.perfectDrawEnabled(xe._savedPerfectDraw),delete xe._savedPerfectDraw)}))),p.current&&p.current.batchDraw(),M(!1))},[d]),ce=h.useCallback(()=>{R(!0),document.body.style.cursor=m?"grabbing":"grab"},[m]),te=h.useCallback(()=>{R(!1),document.body.style.cursor="default"},[]),de=oe=>{var xe,Me,rt;const fe=oe.target.getClassName();if(fe==="Stage"||fe==="Layer"){l({...E,visible:!1});return}if(fe==="Group"||fe==="Rect"){c(null),S(null);const ot=(xe=p.current)==null?void 0:xe.getPointerPosition();if(ot&&Pe(ot)){const{x:gt,y:ns}=ot,{x:zs,y:wl}=((Me=p.current)==null?void 0:Me.position())||{x:0,y:0},{x:Sl,y:kl}=((rt=p.current)==null?void 0:rt.scale())||{x:1,y:1},Cl=(gt-zs)/Sl,Il=(ns-wl)/kl;l({x:Cl,y:Il,visible:!0})}else l({...E,visible:!1})}else l({...E,visible:!1})},Pe=oe=>{if(!n||!i||!p.current)return!1;const{x:fe,y:xe}=oe,{x:Me,y:rt}=p.current.position(),{x:ot}=p.current.scale(),gt={x:(fe-Me)/ot,y:(xe-rt)/ot};return gt.x>=0&&gt.x<=n&&gt.y>=0&&gt.y<=i},Q=h.useCallback(()=>{c(null),S(null),F(!0),U(!0),l({...E,visible:!1})},[c,S,E]),se=h.useCallback(oe=>{P(oe),U(!1)},[P]),he=()=>{F(!0),U(!0),l({...E,visible:!1})},Ne=()=>{C(),l({...E,visible:!1})},Be=()=>{v(),l({...E,visible:!1})};h.useEffect(()=>{if(s>0&&t>0&&n>0&&i>0){const oe=N?20:40,fe=s-oe*2,xe=t-oe*2,Me=fe/n,rt=xe/i,gt=Math.min(Me,rt),ns=(s-n*gt)/2,zs=(t-i*gt)/2;D(gt),w({x:ns,y:zs}),p.current&&p.current.batchDraw()}},[s,t,n,i,N]);const ut=De.Children.map(j,oe=>De.isValidElement(oe)?De.cloneElement(oe,{scale:y,position:f}):oe),Ms=e.jsx(Zo,{width:n,height:i,scale:y,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return s<=0||t<=0||n<=0||i<=0?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:I?m?"grabbing":"grab":"default"},children:[e.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:e.jsxs(X,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[e.jsx(O,{icon:e.jsx(zl,{}),onClick:Y,disabled:y<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),e.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(y*100),"%"]}),e.jsx(O,{icon:e.jsx(Ol,{}),onClick:q,disabled:y>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),e.jsxs(Ac,{ref:p,width:s,height:t,onClick:de,draggable:!0,onDragStart:Z,onDragMove:le,onDragEnd:ve,onMouseEnter:ce,onMouseLeave:te,onWheel:W,x:f.x,y:f.y,scaleX:y,scaleY:y,perfectDrawEnabled:!m&&!d,hitGraphEnabled:!m,pixelRatio:Math.min(1.5,window.devicePixelRatio||1),dragDistance:d?0:3,children:[d&&e.jsx(Nc,{ref:A,listening:!1,children:Ms}),e.jsxs(Tc,{ref:L,imageSmoothingEnabled:!m||!d,children:[!d&&e.jsx(Zo,{width:n,height:i,scale:y,position:{x:0,y:0},isSelected:k,onSelect:_?void 0:Q,onChange:N||_?void 0:P,isEditable:!N&&!_}),r.map(oe=>e.jsx(yl,{hall:oe,isSelected:(u==null?void 0:u.id)===oe.id,onSelect:()=>c(oe),onChange:N||_?void 0:g,scale:y,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isStallMode:N||_},oe._id||oe.id)),o.map(oe=>{const fe=oe._id||oe.id,xe=r.find(Me=>Me.id===oe.hallId||Me._id===oe.hallId);return xe?e.jsx(Jr,{stall:{...oe,_id:fe,id:fe},hallX:xe.dimensions.x,hallY:xe.dimensions.y,hallWidth:xe.dimensions.width,hallHeight:xe.dimensions.height,scale:y,isDragging:m&&d},fe):null}),a.map(oe=>{const fe=oe._id||oe.id,Me=((b==null?void 0:b._id)||(b==null?void 0:b.id))===fe;return e.jsx(bl,{fixture:{...oe,_id:fe,id:fe},isSelected:Me,onSelect:()=>S(oe),onChange:_?x:void 0,scale:y,position:{x:0,y:0},exhibitionWidth:n,exhibitionHeight:i,isEditable:_},fe)}),ut]})]}),e.jsx(Op,{visible:E.visible,x:E.x,y:E.y,onExhibitionClick:he,onHallClick:Ne,onStallClick:Be,onClose:()=>l({...E,visible:!1})}),e.jsx(Mp,{visible:z,width:n,height:i,onCancel:()=>U(!1),onSubmit:se})]})},Up=({visible:s,hall:t,exhibitionWidth:n,exhibitionHeight:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[u]=$.useForm();De.useEffect(()=>{s&&(t?u.setFieldsValue({name:t.name,width:t.dimensions.width,height:t.dimensions.height}):u.setFieldsValue({name:"",width:Math.min(10,n),height:Math.min(10,i)}))},[s,t,n,i,u]);const b=async()=>{var x,P;const S=await u.validateFields(),g=t?{...t,_id:t._id,id:t.id||t._id,name:S.name,dimensions:{x:((x=t.dimensions)==null?void 0:x.x)||0,y:((P=t.dimensions)==null?void 0:P.y)||0,width:S.width,height:S.height},exhibitionId:t.exhibitionId}:{name:S.name,dimensions:{x:0,y:0,width:S.width,height:S.height}};o(g),u.resetFields()},c=()=>{t&&a&&ge.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${t.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>a(t)})};return e.jsx(ge,{title:t?"Edit Hall":"Add New Hall",open:s,onCancel:()=>{u.resetFields(),r()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:e.jsxs($,{form:u,layout:"vertical",style:{marginTop:"16px"},children:[e.jsx($.Item,{name:"name",label:e.jsxs("span",{style:{color:"#000"},children:["Hall Name ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:e.jsx(G,{placeholder:"Enter hall name"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[e.jsx($.Item,{name:"width",label:e.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:n,message:`Width cannot exceed ${n} meters`}],children:e.jsx(Ue,{min:5,max:n,style:{width:"100%"},placeholder:"Enter width"})}),e.jsx($.Item,{name:"height",label:e.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",e.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:i,message:`Height cannot exceed ${i} meters`}],children:e.jsx(Ue,{min:5,max:i,style:{width:"100%"},placeholder:"Enter height"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[e.jsx(X,{children:t&&a&&e.jsx(O,{className:"delete-button",icon:e.jsx(nt,{}),onClick:c,children:"Delete Hall"})}),e.jsxs(X,{children:[e.jsx(O,{onClick:()=>{u.resetFields(),r()},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:b,className:"update-button",children:t?"Update Hall":"Create Hall"})]})]})]})})},{Title:Vp}=pe,Hp=({visible:s,stall:t,hall:n,exhibition:i,onCancel:r,onSubmit:o,onDelete:a})=>{const[u]=$.useForm(),[b,c]=h.useState([]),[S,g]=h.useState(!1),x=(j,N,_,d,p)=>{const A=[..._].sort((D,f)=>{const w=Math.floor(D.dimensions.y/5),I=Math.floor(f.dimensions.y/5);return w===I?D.dimensions.x-f.dimensions.x:D.dimensions.y-f.dimensions.y}),y=(D,f)=>D+j>d||f+N>p?!1:!A.some(w=>{const I=w.dimensions.x,R=w.dimensions.y,m=w.dimensions.width,M=w.dimensions.height,E=1;return!(D+j+E<=I||D>=I+m+E||f+N+E<=R||f>=R+M+E)});for(const D of A){const f=D.dimensions.x+D.dimensions.width+1,w=D.dimensions.y;if(y(f,w))return{x:f,y:w};const I=D.dimensions.x,R=D.dimensions.y+D.dimensions.height+1;if(y(I,R))return{x:I,y:R}}for(let D=0;D<p;D+=5)for(let f=0;f<d;f+=5)if(y(f,D))return{x:f,y:D};return{x:0,y:0}};h.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const j={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",j),u.setFieldsValue(j)}else n&&!u.getFieldValue("status")&&u.setFieldsValue({status:"available",width:Math.min(20,n.dimensions.width/4),height:Math.min(20,n.dimensions.height/4),ratePerSqm:0})},[t,n,u]),h.useEffect(()=>{s&&(async()=>{var N;try{g(!0);const _=await Ns.getStallTypes();console.log("Fetched stall types:",_.data);const d=((N=i.stallRates)==null?void 0:N.map(L=>L.stallTypeId))||[];console.log("Configured stall type IDs:",d);const p=_.data.filter(L=>L.status==="active"&&L._id&&d.includes(L._id));console.log("Filtered stall types:",p),c(p)}catch(_){console.error("Failed to fetch stall types:",_)}finally{g(!1)}})()},[s,i.stallRates]);const P=j=>{var _;console.log("Stall type changed to:",j);const N=(_=i.stallRates)==null?void 0:_.find(d=>d.stallTypeId===j);console.log("Found stall rate:",N),N&&u.setFieldsValue({ratePerSqm:N.rate})},C=()=>{u.resetFields(),r()},v=()=>{if(console.log("Hall data:",n),!n||!n._id&&!n.id){ee.error("Invalid hall selected. Please try again.");return}u.validateFields().then(j=>{var p;const N=n._id||n.id;if(!N){ee.error("Hall ID is missing. Please select a hall again.");return}const _=t?{x:t.dimensions.x,y:t.dimensions.y}:x(j.width,j.height,((p=i.stalls)==null?void 0:p.filter(L=>L.hallId===N))||[],n.dimensions.width,n.dimensions.height),d={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:j.number,stallTypeId:j.stallTypeId,dimensions:{x:_.x,y:_.y,width:j.width,height:j.height},ratePerSqm:j.ratePerSqm,status:j.status,hallId:N};console.log("Submitting stall data:",d),o(d)})},T=j=>{switch(j){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return e.jsx(e.Fragment,{children:e.jsx(ge,{title:e.jsxs(X,{children:[e.jsx(ct,{style:{fontSize:"20px"}}),e.jsx(Vp,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:s,onCancel:C,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[e.jsxs(X,{size:"middle",children:[t&&a&&e.jsx(O,{danger:!0,icon:e.jsx(nt,{}),onClick:()=>a(t),children:"Delete"}),e.jsx(O,{onClick:C,children:"Cancel"}),e.jsx(O,{type:"primary",onClick:v,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:e.jsxs($,{form:u,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[e.jsx($.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:e.jsx(G,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),e.jsx($.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(ae,{loading:S,placeholder:"Select stall type",size:"large",onChange:P,children:b.map(j=>e.jsx(ae.Option,{value:j._id,children:j.name},j._id))})}),e.jsx(Ee,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),e.jsxs(X,{style:{width:"100%",gap:"16px"},children:[e.jsx($.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:e.jsx(Ue,{min:1,max:(n==null?void 0:n.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),e.jsx($.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(n==null?void 0:n.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:e.jsx(Ue,{min:1,max:(n==null?void 0:n.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),e.jsx(Ee,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),e.jsx($.Item,{name:"ratePerSqm",label:"Rate per sq.m ()",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:e.jsx(Ue,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"",disabled:!0,formatter:j=>`${j}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:j=>{const N=j?Number(j.replace(/\\s?|(,*)/g,"")):0;return isNaN(N)?0:N}})}),e.jsx($.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(ae,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[e.jsx(ae.Option,{value:"available",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:T("available")}}),"Available"]})}),e.jsx(ae.Option,{value:"booked",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:T("booked")}}),"Booked"]})}),e.jsx(ae.Option,{value:"reserved",children:e.jsxs(X,{children:[e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:T("reserved")}}),"Reserved"]})})]})})]})})})},ea=s=>{if(!s)return"";const t=window.location.origin,n=s.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${t}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${n}?token=${i}`:""},Wp=({name:s,type:t,color:n,rotation:i,showName:r,iconUrl:o,defaultIcons:a,borderColor:u=null,borderRadius:b=0})=>{h.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:s,type:t,color:n,rotation:i,showName:r,iconUrl:o,defaultIconAvailable:!!a[t],borderColor:u,borderRadius:b})},[s,t,n,i,r,o,a,u,b]);const c=a[t]||"";return e.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[e.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${b||4}px`,backgroundColor:n||"#f0f0f0",transform:`rotate(${i}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:u?`1px solid ${u}`:"1px solid rgba(0,0,0,0.05)"},children:o?e.jsx("img",{src:o,alt:s,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):e.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:c})}),r&&e.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:s}),e.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[e.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),e.jsx("span",{children:""}),e.jsx("span",{children:n}),i>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[i,""]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Border: ",u]})]}),b>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Radius: ",b,"px"]})]})]})]})},{Text:Yp}=pe,Gi=({activeKey:s,form:t,fixture:n,exhibitionWidth:i,exhibitionHeight:r,selectedType:o,showName:a,iconFileList:u,fixtureTypes:b,fixtureIcons:c,defaultColors:S,defaultDimensions:g,colorPresets:x,uploadProps:P,iconPreviewVisible:C=!1,previewImage:v="",onTypeChange:T,onColorChange:j,onShowNameChange:N,onIconPreviewCancel:_=()=>{}})=>{switch(s){case"basic":return d();case"position":return p();case"appearance":return L();default:return d()}function d(){return e.jsxs("div",{className:"tab-content",children:[e.jsx($.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:e.jsx(G,{placeholder:"Enter fixture name",prefix:e.jsx(Ls,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx($.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:e.jsx(mt,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:A=>{N(A),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),e.jsx($.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:e.jsx(ae,{placeholder:"Select fixture type",onChange:T,options:b.map(A=>({...A,label:e.jsxs(X,{children:[e.jsx("span",{style:{fontSize:16},children:c[A.value]}),e.jsx("span",{children:A.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function p(){return e.jsxs("div",{className:"tab-content",children:[e.jsx(K,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:e.jsx(Ue,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"X position"})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:e.jsx(Ue,{style:{width:"100%",borderRadius:"8px"},min:0,max:r,step:.1,precision:1,placeholder:"Y position"})})})]})}),e.jsx(K,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:e.jsx(Ue,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:e.jsx(Ue,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),e.jsx(K,{size:"small",title:e.jsxs("span",{children:[e.jsx(ql,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:e.jsx($.Item,{name:"rotation",noStyle:!0,children:e.jsx(ka,{min:0,max:360,marks:{0:"0",90:"90",180:"180",270:"270",360:"360"},tooltip:{formatter:A=>`${A}`},style:{marginTop:10},keyboard:!1})})})]})}function L(){return e.jsxs("div",{className:"tab-content",children:[e.jsx($.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(A,y)=>{try{return y?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:e.jsx(so,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:x,onChange:j,style:{width:"100%"}})}),e.jsx($.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:e.jsx(so,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:x,style:{width:"100%"}})}),e.jsx($.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:e.jsx(Ue,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),e.jsxs(K,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[e.jsx("div",{style:{marginBottom:0},children:e.jsx(rn,{...P,children:u.length<1&&e.jsxs("div",{children:[e.jsx(Ul,{style:{fontSize:20}}),e.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),e.jsx(Yp,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),e.jsx($.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:e.jsx(G,{placeholder:"https://example.com/icon.png",prefix:e.jsx(Vl,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),e.jsx(ge,{open:C,title:"Icon Preview",footer:null,onCancel:_,children:e.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:v})})]})}},Qp=s=>[{key:"basic",label:e.jsxs("span",{children:[e.jsx(pn,{}),"Basic Info"]}),children:e.jsx(Gi,{...s,activeKey:"basic"})},{key:"position",label:e.jsxs("span",{children:[e.jsx(hs,{}),"Position"]}),children:e.jsx(Gi,{...s,activeKey:"position"})},{key:"appearance",label:e.jsxs("span",{children:[e.jsx(on,{}),"Appearance"]}),children:e.jsx(Gi,{...s,activeKey:"appearance"})}],{Text:cf,Title:df}=pe,{TabPane:uf}=dt,Gp=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],Pn={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},Kt={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},Ki={sofa:"",chair:"",table:"",desk:"",plant:"",entrance:"",exit:"",info:"",restroom:"",food:"",custom:""},Kp=({visible:s,fixture:t,onCancel:n,onSubmit:i,onDelete:r,exhibitionWidth:o,exhibitionHeight:a})=>{const[u]=$.useForm(),[b,c]=h.useState(!1),[S,g]=h.useState(""),[x,P]=h.useState("basic"),[C,v]=h.useState(""),[T,j]=h.useState([]),[N,_]=h.useState(!1),[d,p]=h.useState(""),{message:L}=it.useApp(),[A,y]=h.useState("#f0f0f0"),[D,f]=h.useState("New Fixture"),[w,I]=h.useState("chair"),[R,m]=h.useState(0),[M,E]=h.useState(!0),[l,k]=h.useState(null),[F,z]=h.useState(0);h.useEffect(()=>{if(s)if(t){const Q=Z(t.color),se=Kt[t.type]||"#f0f0f0",he=Q||se;console.log("Setting up fixture colors:",{original:t.color,normalized:Q,fallback:se,final:he}),y(he),f(t.name),I(t.type),m(t.rotation||0),g(t.type),E(t.showName!==!1),k(t.borderColor||null),z(t.borderRadius||0)}else{const Q="chair",se=Kt[Q];y(se),f("New Fixture"),I(Q),m(0),g(Q),E(!0),k(null),z(0)}},[s,t]),h.useEffect(()=>{if(s&&u){if(t){const Q=Z(t.color),se=Kt[t.type]||"#f0f0f0",he=Q||se;u.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:he,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const Ne=t.icon?ea(t.icon):"";v(Ne),t.icon?j([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:Ne,thumbUrl:Ne}]):j([])}else{const Q="chair",se=Kt[Q];u.setFieldsValue({name:"New Fixture",type:Q,position:{x:Math.floor(o/2),y:Math.floor(a/2)},dimensions:Pn[Q],rotation:0,color:se,icon:"",showName:!0,borderColor:null,borderRadius:0}),v(""),j([])}P("basic")}},[s,t,u,o,a]);const U=()=>{if(u&&s)try{const Q=u.getFieldsValue(!0);if(Q.name&&f(Q.name),Q.type&&I(Q.type),Q.rotation!==void 0&&m(Q.rotation),Q.color){const se=Z(Q.color);se&&y(se)}if(Q.showName!==void 0&&E(Q.showName),Q.borderColor!==void 0){const se=Q.borderColor?Z(Q.borderColor):null;k(se)}Q.borderRadius!==void 0&&z(Q.borderRadius)}catch(Q){console.log("Error updating preview",Q)}};h.useEffect(()=>{if(u&&s)return u.getFieldsValue,U(),()=>{}},[u,s]);const V=Q=>{if(g(Q),I(Q),!t){const se=Kt[Q]||Kt.custom;u.setFieldsValue({dimensions:Pn[Q]||Pn.custom,color:se}),y(se)}},H=Q=>{const se=Z(Q);u.setFieldValue("color",se),y(se);const he=Object.entries(Kt).find(([Ne,Be])=>Be.toLowerCase()===se.toLowerCase());he&&!t&&(u.setFieldValue("type",he[0]),g(he[0]),I(he[0]))},W=()=>(console.log("Rendering fixture preview with:",{name:D,type:w,color:A,rotation:R,showName:M,iconUrl:C,borderColor:l,borderRadius:F}),e.jsx(Wp,{name:D,type:w,color:A,rotation:R,showName:M,iconUrl:C,defaultIcons:Ki,borderColor:l,borderRadius:F})),q=({file:Q,fileList:se})=>{var he;if(Q.status==="uploading"&&j(se),Q.status==="done"){L.success(`${Q.name} uploaded successfully`);let Be=(((he=Q.response)==null?void 0:he.url)||"").replace(/^\/api\/uploads\//,"");Be&&!Be.startsWith("fixtures/")&&(Be=`fixtures/${Be.replace(/^\//,"")}`),console.log("Icon path stored in form:",Be),u.setFieldValue("icon",Be);const ut=ea(Be);console.log("Using direct backend URL:",ut),v(ut);const Ms=Q.name.toLowerCase().endsWith(".svg"),oe=se.map(fe=>fe.uid===Q.uid?{...fe,url:ut,thumbUrl:ut,type:Ms?"image/svg+xml":fe.type}:fe);j(oe),console.log("Form values after icon upload:",u.getFieldsValue(!0))}Q.status==="error"&&(L.error(`${Q.name} upload failed.`),j(se.filter(Ne=>Ne.uid!==Q.uid)))},Y={name:"file",action:`${ne.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:T,onChange:q,onPreview:Q=>{p(Q.url||Q.thumbUrl||""),_(!0)},onRemove:()=>(v(""),j([]),u.setFieldValue("icon",""),console.log("Form values after icon removal:",u.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:e.jsx(nt,{style:{color:"#ff4d4f"}})}},Z=Q=>{try{if(!Q)return"#f0f0f0";if(typeof Q=="object"&&Q!==null){if(typeof Q.toHexString=="function")return Q.toHexString();if(Q.rgb||Q.hex)return Q.hex||`rgb(${Q.rgb.r},${Q.rgb.g},${Q.rgb.b})`}if(typeof Q=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(Q))return Q;if(/^([0-9A-F]{3}){1,2}$/i.test(Q))return`#${Q}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(Q))return Q}return"#f0f0f0"}catch(se){return console.error("Error normalizing color:",se),"#f0f0f0"}},le=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],ve=De.useCallback(()=>{t&&r&&r(t)},[t,r]),ce=Q=>{P(Q),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},te=Qp({form:u,fixture:t,exhibitionWidth:o,exhibitionHeight:a,selectedType:S,showName:M,iconFileList:T,fixtureTypes:Gp,fixtureIcons:Ki,defaultColors:Kt,defaultDimensions:Pn,colorPresets:le,uploadProps:Y,iconPreviewVisible:N,previewImage:d,onTypeChange:V,onColorChange:H,onShowNameChange:Q=>E(Q),onIconPreviewCancel:()=>_(!1),activeKey:x}),de=async()=>{try{c(!0);const Q=await u.validateFields();f(Q.name),I(Q.type),m(Q.rotation||0),y(Z(Q.color)),E(Q.showName),k(Q.borderColor?Z(Q.borderColor):null),z(Q.borderRadius||0);let se="";Q.icon?se=Pe(Q.icon):t!=null&&t.icon&&(se=t.icon),console.log("Form values being submitted:",{name:Q.name,type:Q.type,color:Q.color,icon:Q.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:se,showName:Q.showName,borderColor:Q.borderColor,borderRadius:Q.borderRadius});const he=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",Ne=Q.color?Z(Q.color):(t==null?void 0:t.color)||"#f0f0f0",Be=Q.borderColor?Z(Q.borderColor):null,ut={...t,id:he,_id:he,name:Q.name,type:Q.type,position:Q.position,dimensions:Q.dimensions,rotation:Q.rotation,color:Ne,icon:se,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:Be,borderRadius:Q.borderRadius||0};he&&(ut.showName=Q.showName),console.log("Submitting fixture with icon path:",se),console.log("Color being submitted:",Ne),await i(ut),n()}catch(Q){console.error("Fixture submission failed:",Q),L.error("Failed to save fixture. Please check the form and try again.")}finally{c(!1)}},Pe=Q=>{if(!Q||typeof Q!="string")return"";if(Q.startsWith("fixtures/")&&!Q.includes("?")&&!Q.includes("http"))return Q;let se=Q.replace(/^\/api\/uploads\//,"");if(se=se.replace(/^\//,""),se.includes("?")||se.includes("http")){const he=se.split("?")[0].split("/").pop()||"";if(he)return`fixtures/${he}`}return se&&!se.startsWith("fixtures/")?`fixtures/${se}`:se};return e.jsxs(ge,{title:e.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:24,marginRight:8},children:t?Ki[t.type]:""}),e.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:s,onCancel:n,confirmLoading:b,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:t&&r&&e.jsx(O,{danger:!0,icon:e.jsx(nt,{}),onClick:ve,style:{borderRadius:"6px"},children:"Delete"})}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(O,{onClick:n,icon:e.jsx(Hl,{}),style:{borderRadius:"6px"},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:de,icon:e.jsx(fs,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),W(),e.jsx($,{form:u,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:U,children:e.jsx(dt,{activeKey:x,onChange:ce,items:te,tabBarStyle:{marginBottom:16},centered:!0})})]})},Xp=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=ke(),{currentExhibition:r}=ue(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>i(Ye(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Jp=()=>{var C;const{id:s}=ft(),t=Qt(),n=ke(),i=Ae(),r=((C=t.state)==null?void 0:C.exhibitionId)||s,{currentExhibition:o}=ue(v=>v.exhibition),a=h.useRef(null),[u,b]=h.useState({width:100,height:100}),[c,S]=h.useState({width:0,height:0}),[g]=$.useForm();h.useEffect(()=>{if(!r){ee.error("Exhibition ID not found"),n("/exhibition");return}i(vt(r))},[r,i,n]),h.useEffect(()=>{o!=null&&o.dimensions&&(b(o.dimensions),g.setFieldsValue(o.dimensions))},[o,g]),h.useEffect(()=>{const v=()=>{a.current&&S({width:a.current.clientWidth,height:a.current.clientHeight})};return v(),window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]);const x=async()=>{try{const v=await g.validateFields();await Re.updateExhibition(r,{dimensions:v}),ee.success("Exhibition space saved successfully"),await i(vt(r)).unwrap(),n(Ye(o,"layout"),{state:{exhibitionId:r}})}catch{ee.error("Failed to save exhibition space")}},P=v=>{b(T=>({...T,...v})),g.setFieldsValue(v)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Xp,{exhibitionId:r}),e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Space Setup"}),e.jsx(O,{type:"primary",icon:e.jsx(fs,{}),onClick:x,children:"Save and Continue"})]}),children:e.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[e.jsx("div",{style:{flex:"0 0 300px"},children:e.jsxs($,{form:g,layout:"vertical",initialValues:u,children:[e.jsx($.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:e.jsx(Ue,{min:10,max:1e3,style:{width:"100%"},onChange:v=>P({width:v||10})})}),e.jsx($.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:e.jsx(Ue,{min:10,max:1e3,style:{width:"100%"},onChange:v=>P({height:v||10})})})]})}),e.jsx("div",{ref:a,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:e.jsx(fn,{children:e.jsx(gn,{width:c.width,height:c.height,exhibitionWidth:u.width,exhibitionHeight:u.height,onExhibitionChange:P})})})]})})]})},Zp=({exhibitionId:s})=>{const t=ke(),{currentExhibition:n}=ue(i=>i.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>t(Ye(n),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ex=()=>{var u,b,c,S,g;const{id:s}=ft(),t=Qt(),n=ke(),i=Ae(),r=((u=t.state)==null?void 0:u.exhibitionId)||s,{currentExhibition:o,halls:a}=ue(x=>x.exhibition);return h.useEffect(()=>{r&&(i(vt(r)),i(Ft(r)))},[r,i]),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(Zp,{exhibitionId:r}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(gs,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",onClick:()=>n(Ye(o,"space"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(B,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(pn,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!((b=o==null?void 0:o.dimensions)!=null&&b.width)||!((c=o==null?void 0:o.dimensions)!=null&&c.height),onClick:()=>n(Ye(o,"halls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(B,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(ct,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!a.length,onClick:()=>n(Ye(o,"stalls"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),e.jsx(B,{xs:24,sm:12,md:8,children:e.jsxs(K,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:e.jsx(Nr,{style:{fontSize:"48px",color:"#1890ff"}})}),e.jsx(K.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),e.jsx(O,{type:"primary",disabled:!((S=o==null?void 0:o.dimensions)!=null&&S.width)||!((g=o==null?void 0:o.dimensions)!=null&&g.height),onClick:()=>n(Ye(o,"fixtures"),{state:{exhibitionId:r}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},tx=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=ke(),{currentExhibition:r}=ue(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>i(Ye(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},sx=()=>{var p,L,A;const{id:s}=ft(),t=Qt(),n=ke(),i=Ae(),r=((p=t.state)==null?void 0:p.exhibitionId)||s,{currentExhibition:o,halls:a}=ue(y=>y.exhibition),u=h.useRef(null),[b,c]=ee.useMessage(),[S,g]=h.useState(!1),[x,P]=h.useState(null),[C,v]=h.useState({width:0,height:0});h.useEffect(()=>{const y=()=>{if(u.current){const{clientWidth:f,clientHeight:w}=u.current;v({width:Math.max(f||400,400),height:Math.max(w||400,400)})}};y();const D=new ResizeObserver(y);return u.current&&D.observe(u.current),window.addEventListener("resize",y),()=>{D.disconnect(),window.removeEventListener("resize",y)}},[]),h.useEffect(()=>{if(!r){b.error("Exhibition ID not found"),n("/exhibition");return}i(vt(r))},[r,i,n,b]),h.useEffect(()=>{var y,D;if(o){if(!((y=o.dimensions)!=null&&y.width)||!((D=o.dimensions)!=null&&D.height)){b.info("Please set up exhibition space first"),n(Ye(o,"space"),{state:{exhibitionId:r}});return}i(Ft(r))}},[o,r,i,n,b]);const T=()=>{P(null),g(!0)},j=y=>{P(y),g(!!y)},N=async y=>{var D;try{y.id?(await Re.updateHall(r,y.id,y),b.success("Hall updated successfully"),g(!1)):(await Re.createHall(r,y),b.success("Hall created successfully"),g(!1)),i(Ft(r))}catch(f){console.error("Hall operation failed:",f),((D=f.response)==null?void 0:D.status)===409?b.warning({content:f.response.data.message,duration:6,style:{marginTop:"20vh"}}):(b.error(f.message||"Failed to save hall"),g(!1))}},_=async y=>{var D,f;try{const w=y._id||y.id;if(!w)throw new Error("Hall ID is required");await Re.deleteHall(r,w),b.success("Hall deleted successfully"),g(!1),P(null),i(Ft(r))}catch(w){console.error("Failed to delete hall:",w),b.error(((f=(D=w.response)==null?void 0:D.data)==null?void 0:f.message)||"Failed to delete hall")}},d=async()=>{try{await Re.saveLayout(r,a),b.success("Layout saved successfully")}catch{b.error("Failed to save layout")}};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(tx,{exhibitionId:r}),c,e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(X,{children:[e.jsx("span",{children:"Hall Management"}),e.jsx(O,{icon:e.jsx(Ca,{}),onClick:()=>n(Ye(o,"space"),{state:{exhibitionId:r}}),children:"Back to Space Setup"})]}),e.jsxs(X,{children:[e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:T,children:"Add Hall"}),e.jsx(O,{type:"primary",icon:e.jsx(fs,{}),onClick:d,disabled:!a.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:e.jsx("div",{ref:u,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(fn,{children:C.width>0&&C.height>0&&(o==null?void 0:o.dimensions)&&e.jsx(gn,{width:C.width,height:C.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:a,selectedHall:x,onSelectHall:j,onHallChange:N,onAddHall:T})})})}),e.jsx(Up,{visible:S,hall:x,onCancel:()=>g(!1),onSubmit:N,onDelete:_,exhibitionWidth:((L=o==null?void 0:o.dimensions)==null?void 0:L.width)||100,exhibitionHeight:((A=o==null?void 0:o.dimensions)==null?void 0:A.height)||100})]})},nx=J(ge)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,ix=J.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,sn=J.div`
  padding: 24px 32px 32px;
`,rx=J.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,ox=J.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;J.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;J.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;J.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;J.div`
  border: 1px solid ${s=>s.selected?"#4b47b9":"#e6e6f0"};
  background: ${s=>s.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${s=>s.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${s=>s.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${s=>s.selected?"#4b47b9":"white"};
    border: 2px solid ${s=>s.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const ax=J(K)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;J(O)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;J.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;J(K)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;J(G)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const Xi=J(O)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;J(me)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;J.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;J(xn)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;J.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;J.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;J.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;J.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;J.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px  3) + (16px  2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;J(K)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const ta=({form:s,stallDetails:t=[],selectedStallId:n,selectedStallIds:i=[],exhibition:r})=>{const[o,a]=h.useState([]);h.useEffect(()=>{let P=[...(s.getFieldValue("selectedStalls")||[]).map(C=>String(C))];if(n){const C=String(n);P.some(v=>v===C)||P.push(C)}i.length>0&&i.forEach(C=>{const v=String(C);P.some(T=>T===v)||P.push(v)}),console.log("StallDetailsStep - Initial stalls after normalization:",P),s.setFieldsValue({selectedStalls:P}),a(P)},[s,n,i]),h.useEffect(()=>{if(o.length>0){const g=s.getFieldValue("selectedStalls")||[],x=new Set(g.map(v=>String(v))),P=new Set(o.map(v=>String(v)));let C=x.size!==P.size;if(!C){for(const v of P)if(!x.has(v)){C=!0;break}}if(C){console.log("Syncing form with selected stalls:",o);const v=o.map(T=>String(T));s.setFieldsValue({selectedStalls:v}),s.validateFields(["selectedStalls"]).catch(T=>{})}}},[o,s]);const u=h.useMemo(()=>!t||t.length===0?[]:t.filter(g=>o.includes(g.id)),[t,o]),b=h.useMemo(()=>{var d,p,L;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const g=t.filter(A=>o.includes(A.id)),x=g.reduce((A,y)=>A+(y.price||y.ratePerSqm*y.dimensions.width*y.dimensions.height),0),C=(((d=r==null?void 0:r.publicDiscountConfig)==null?void 0:d.filter(A=>A.isActive))||[]).map(A=>{const y=A.type==="percentage"?x*(Math.min(Math.max(0,A.value),100)/100):Math.min(A.value,x);return{name:A.name,type:A.type,value:A.value,amount:y}}),v=C.reduce((A,y)=>A+y.amount,0),T=x-v,j=((L=(p=r==null?void 0:r.taxConfig)==null?void 0:p.filter(A=>A.isActive))==null?void 0:L.map(A=>({name:A.name,rate:A.rate,amount:T*(A.rate/100)})))||[],N=j.reduce((A,y)=>A+y.amount,0),_=T+N;return{baseAmount:x,discounts:C,totalDiscountAmount:v,amountAfterDiscount:T,taxes:j,totalTaxAmount:N,total:_,selectedStallNumbers:g.map(A=>`${A.number} (${A.hallName||`Hall - ${A.hallId}`})`).join(", ")}},[t,o,r==null?void 0:r.taxConfig,r==null?void 0:r.publicDiscountConfig]),c=g=>{const x=String(g);if(o.some(C=>String(C)===x)){const C=o.filter(v=>String(v)!==x);a(C),s.setFieldsValue({selectedStalls:C}),ee.info("Stall removed from selection")}},S=g=>`${g.toLocaleString("en-IN")}`;return e.jsxs(sn,{children:[e.jsx(rx,{children:"Your Selected Stalls"}),e.jsx(ox,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),e.jsx($.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:e.jsx(ae,{mode:"multiple"})}),u.length>0?e.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:e.jsx($e,{dataSource:u.map(g=>({...g,key:g.id,price:g.price||g.ratePerSqm*g.dimensions.width*g.dimensions.height,area:g.dimensions.width*g.dimensions.height,dimensions:`${g.dimensions.width}m  ${g.dimensions.height}m`,size:`${g.dimensions.width}m  ${g.dimensions.height}m`,stallType:g.stallType||{name:g.typeName||g.type||"Standard"},type:g.typeName||g.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(g,x)=>e.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",g||x.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(g,x)=>e.jsx(re,{color:"blue",style:{borderRadius:"4px"},children:g||`Hall ${x.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(g,x)=>{var C;const P=((C=x.stallType)==null?void 0:C.name)||x.type||"Standard";return e.jsx(re,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:P})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(g,x)=>e.jsxs(X,{direction:"vertical",size:0,children:[e.jsx("span",{style:{fontWeight:500},children:g}),e.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[x.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(g,x)=>e.jsxs("span",{style:{color:"#555"},children:["",(x.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:g=>e.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:S(g)})},{title:"",key:"action",width:70,align:"center",render:(g,x)=>e.jsx(Ve,{title:"Remove from selection",children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(nt,{}),onClick:()=>c(x.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):e.jsx(Xe,{description:"No stalls selected yet. Please select stalls from the layout.",image:Xe.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),o.length>0&&e.jsxs(ax,{title:e.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Selected Stalls"}),e.jsxs("div",{className:"value",children:[o.length," stall(s) selected"]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Stall Numbers"}),e.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:b.selectedStallNumbers})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Base Amount"}),e.jsx("div",{className:"value",children:S(b.baseAmount)})]}),b.discounts.map((g,x)=>e.jsxs("div",{className:"summary-row discount",children:[e.jsxs("div",{className:"label",children:[g.name,g.type==="percentage"?` (${g.value}%)`:""]}),e.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",S(g.amount)]})]},`discount-${x}`)),e.jsxs("div",{className:"summary-row",children:[e.jsx("div",{className:"label",children:"Amount after Discount"}),e.jsx("div",{className:"value",style:{fontWeight:500},children:S(b.amountAfterDiscount)})]}),b.taxes.map((g,x)=>e.jsxs("div",{className:"summary-row",children:[e.jsxs("div",{className:"label",children:[g.name," (",g.rate,"%)"]}),e.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",S(g.amount)]})]},`tax-${x}`)),e.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[e.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),e.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:S(b.total)})]})]})]})},{Title:lx,Paragraph:sa,Text:na}=pe,ia=({form:s,formValues:t,selectedStallIds:n=[],exhibition:i})=>{const r=s.getFieldValue("selectedStalls")||n||[];return i&&i.amenities&&i.amenities.length>0,console.log("AmenitiesStep - Selected stalls:",r),e.jsxs(sn,{children:[e.jsx(lx,{level:4,children:"Additional Amenities"}),e.jsx(sa,{type:"secondary",style:{marginBottom:24},children:"Select additional amenities for your exhibition stalls."}),e.jsx(qe,{message:"Coming Soon",description:"The amenities selection feature is currently under development and will be available soon. You can continue to the next step without selecting amenities.",type:"info",showIcon:!0,icon:e.jsx(Wl,{}),style:{marginBottom:24}}),e.jsx(K,{title:`Selected Stalls: ${r.length}`,children:r.length>0?e.jsxs(sa,{children:["You've selected ",r.length," stall(s). Additional amenities will be available for these stalls in the next update."]}):e.jsx(Xe,{image:Xe.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),e.jsx(Ee,{}),e.jsx(K,{title:"Available Amenities",style:{marginTop:24},children:e.jsx(Xe,{image:e.jsx(Yl,{style:{fontSize:60,color:"#cccccc"}}),description:e.jsxs("span",{children:[e.jsx(na,{strong:!0,children:"Amenities Coming Soon"}),e.jsx("br",{}),e.jsx(na,{type:"secondary",children:"Please check back later for available amenities."})]})})}),e.jsx($.Item,{name:"amenities",hidden:!0,initialValue:[],children:e.jsx("input",{type:"hidden"})}),e.jsx($.Item,{name:"selectedStalls",hidden:!0,children:e.jsx("input",{type:"hidden"})})]})},{Title:Ji,Paragraph:cx,Text:tt}=pe,ra=({form:s,stallDetails:t=[],selectedStallId:n,selectedStallIds:i=[],selectedStalls:r=[],exhibition:o,onPrev:a,onFinish:u,loading:b=!1,formValues:c={}})=>{const[S,g]=h.useState([]),x=h.useMemo(()=>{const L=(s.getFieldValue("selectedStalls")||[]).map(y=>String(y));if(console.log("ReviewStep - Form has selectedStalls:",L),console.log("ReviewStep - Props selectedStallIds:",i),console.log("ReviewStep - Props selectedStalls:",r),L.length>0)return L;const A=[];if(n){const y=String(n);A.push(y)}return i&&i.length&&i.forEach(y=>{const D=String(y);A.includes(D)||A.push(D)}),r&&r.length&&r.forEach(y=>{const D=String(y);A.includes(D)||A.push(D)}),console.log("ReviewStep - Final consolidated stall IDs:",A),A},[s,n,i,r]);h.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",x),console.log("ReviewStep - Available stall details:",t),t&&t.length&&x.length){const p=t.filter(A=>x.includes(String(A.id)));console.log("ReviewStep - Matched stalls:",p.length);const L=p.map(A=>({key:A.id,id:A.id,number:A.number||A.stallNumber||`Stall ${A.id}`,hallName:A.hallName||`Hall ${A.hallId}`,size:`${A.dimensions.width}m  ${A.dimensions.height}m`,area:A.dimensions.width*A.dimensions.height,rate:A.ratePerSqm,price:A.price||A.ratePerSqm*A.dimensions.width*A.dimensions.height,type:A.typeName||A.type||"Standard"}));g(L)}},[t,x]);const P=s.getFieldValue("amenities")||[],C=h.useMemo(()=>{var M,E,l;const p=S.reduce((k,F)=>k+F.price,0);let L=0;const A=P.map(k=>{var z;const F=(z=o==null?void 0:o.amenities)==null?void 0:z.find(U=>U.id===k||U._id===k);return F?(L+=F.rate||0,{name:F.name,rate:F.rate,type:F.type}):null}).filter(Boolean),D=(((M=o==null?void 0:o.publicDiscountConfig)==null?void 0:M.filter(k=>k.isActive))||[]).map(k=>{const F=k.type==="percentage"?p*(Math.min(Math.max(0,k.value),100)/100):Math.min(k.value,p);return{name:k.name,type:k.type,value:k.value,amount:F}}),f=D.reduce((k,F)=>k+F.amount,0),w=p-f,I=w+L,R=((l=(E=o==null?void 0:o.taxConfig)==null?void 0:E.filter(k=>k.isActive))==null?void 0:l.map(k=>({name:k.name,rate:k.rate,amount:I*(k.rate/100)})))||[],m=R.reduce((k,F)=>k+F.amount,0);return{baseAmount:p,amenities:A,amenitiesTotal:L,discounts:D,totalDiscountAmount:f,amountAfterDiscount:w,subtotal:I,taxes:R,totalTaxAmount:m,total:I+m,stallCount:S.length}},[S,P,o]);h.useEffect(()=>{var L;const p=((L=o==null?void 0:o.publicDiscountConfig)==null?void 0:L.filter(A=>A.isActive))||[];if(p.length>0){const A=p[0];console.log("Setting discountId in form to:",A),s.setFieldsValue({discountId:{name:A.name,type:A.type,value:A.value}})}},[o,s]);const v=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:p=>e.jsx(re,{color:"purple",children:p})},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:p=>`${p} sqm`},{title:"Rate",dataIndex:"rate",key:"rate",render:p=>`${p}/sqm`},{title:"Price",dataIndex:"price",key:"price",render:p=>`${p.toLocaleString()}`}],T=p=>`${p.toLocaleString("en-IN")}`,j=c.customerName||s.getFieldValue("customerName"),N=c.customerPhone||s.getFieldValue("customerPhone"),_=c.email||s.getFieldValue("email"),d=c.companyName||s.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:j,companyName:d,customerPhone:N,customerEmail:_,formValues:c,formFieldValues:{customerName:s.getFieldValue("customerName"),companyName:s.getFieldValue("companyName"),customerPhone:s.getFieldValue("customerPhone"),email:s.getFieldValue("email")}}),b?e.jsx(sn,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:e.jsx(Bt,{size:"large",tip:"Processing your booking..."})}):x.length===0?e.jsxs(sn,{children:[e.jsx(qe,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(O,{onClick:a,children:"Back to Stall Selection"})})]}):e.jsxs(sn,{children:[e.jsx($.Item,{name:"discountId",hidden:!0,children:e.jsx(G,{})}),e.jsx(Ji,{level:4,children:"Booking Summary"}),e.jsx(cx,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),e.jsx(K,{title:"Exhibitor Information",style:{marginBottom:24},children:e.jsxs(me,{column:2,children:[e.jsx(me.Item,{label:"Name",children:j||"Not provided"}),e.jsx(me.Item,{label:"Company",children:d||"Not provided"}),e.jsx(me.Item,{label:"Phone",children:N||"Not provided"}),e.jsx(me.Item,{label:"Email",children:_||"Not provided"})]})}),e.jsxs(K,{title:"Selected Stalls",className:"review-card",size:"small",children:[e.jsx($e,{dataSource:S,columns:v,pagination:!1,size:"small",style:{marginBottom:16}}),e.jsxs(tt,{strong:!0,children:["Total Base Amount: ",T(C.baseAmount)]})]}),C.amenities&&C.amenities.length>0&&e.jsxs(K,{title:"Selected Amenities",style:{marginBottom:24},children:[C.amenities.map((p,L)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx(tt,{children:p.name}),e.jsx(re,{color:"blue",style:{marginLeft:8},children:p.type})]}),e.jsx(tt,{children:T(p.rate)})]},L)),e.jsx(Ee,{}),e.jsxs(tt,{strong:!0,children:["Amenities Total: ",T(C.amenitiesTotal)]})]}),e.jsxs(K,{title:"Price Calculation",style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(tt,{children:"Base Amount:"}),e.jsx(tt,{children:T(C.baseAmount)})]}),C.discounts.length>0&&e.jsxs(e.Fragment,{children:[C.discounts.map((p,L)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(tt,{children:[p.name," (",p.type==="percentage"?`${p.value}%`:T(p.value),"):"]}),e.jsxs(tt,{type:"danger",children:["- ",T(p.amount)]})]},L)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(tt,{children:"Amount after Discount:"}),e.jsx(tt,{children:T(C.amountAfterDiscount)})]})]}),C.amenitiesTotal>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(tt,{children:"Amenities:"}),e.jsx(tt,{children:T(C.amenitiesTotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(tt,{strong:!0,children:"Subtotal:"}),e.jsx(tt,{strong:!0,children:T(C.subtotal)})]}),C.taxes.length>0&&e.jsx(e.Fragment,{children:C.taxes.map((p,L)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(tt,{children:[p.name," (",p.rate,"%):"]}),e.jsx(tt,{children:T(p.amount)})]},L))}),e.jsx(Ee,{}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Ji,{level:5,children:"Total:"}),e.jsx(Ji,{level:5,children:T(C.total)})]})]})]})},{confirm:dx}=ge,ux=({visible:s,stallDetails:t,selectedStallId:n,selectedStallIds:i,loading:r,exhibition:o,onCancel:a,onSubmit:u})=>{const[b]=$.useForm(),[c,S]=h.useState(0),[g]=h.useState(3),[x,P]=h.useState({}),[C,v]=h.useState(!1),[T,j]=h.useState(!1),N=ue(w=>w.exhibitorAuth.exhibitor);h.useEffect(()=>{if(s){S(0),v(!1),P({}),b.resetFields();const w=i.map(m=>String(m));n&&w.push(String(n));const I=[...new Set(w)],R={selectedStalls:I,exhibitionId:o==null?void 0:o._id};N&&(R.customerName=N.contactPerson||"",R.companyName=N.companyName||"",R.email=N.email||"",R.customerPhone=N.phone||""),b.setFieldsValue(R),P(R),console.log("Booking form initialized with stalls:",I),console.log("Exhibitor profile data:",N)}},[s,b,n,i,o,N]);const _=()=>{v(!0)},d=()=>{C?dx({title:"Discard changes?",icon:e.jsx($s,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){a()}}):a()},p=()=>{j(!0),b.validateFields().then(w=>{const I={...x,...w},R={customerName:b.getFieldValue("customerName"),companyName:b.getFieldValue("companyName"),email:b.getFieldValue("email"),customerPhone:b.getFieldValue("customerPhone")},m={...I,...R};P(m),console.log("Step completed, saving form values:",m),console.log("Selected stalls are:",m.selectedStalls||[]),console.log("Exhibitor info:",R),S(c+1),j(!1)}).catch(w=>{j(!1),console.error("Form validation failed:",w),ee.error("Please complete all required fields")})},L=()=>{S(c-1)},A=()=>{b.validateFields().then(w=>{const I={customerName:b.getFieldValue("customerName"),companyName:b.getFieldValue("companyName"),email:b.getFieldValue("email"),customerPhone:b.getFieldValue("customerPhone")},R={...x,...w,...I};console.log("Submitting booking with values:",R),u(R)}).catch(w=>{console.error("Form validation failed:",w),ee.error("Please complete all required fields")})},y=["Stall Details","Amenities","Review"],D=[{title:"Stall Details",icon:e.jsx(Ql,{}),content:e.jsx(ta,{form:b,stallDetails:t,selectedStallId:n,selectedStallIds:i,exhibition:o})},{title:"Amenities",icon:e.jsx(pn,{}),content:e.jsx(ia,{form:b,stallDetails:t,selectedStallIds:b.getFieldValue("selectedStalls")||[],exhibition:o,formValues:x})},{title:"Review",icon:e.jsx(_e,{}),content:e.jsx(ra,{form:b,formValues:x,loading:r,exhibition:o,selectedStalls:b.getFieldValue("selectedStalls")||[],selectedStallIds:b.getFieldValue("selectedStalls")||[],stallDetails:t})}];h.useEffect(()=>{const w=b.getFieldValue("selectedStalls");console.log(`Step ${c} - Form has selectedStalls:`,w)},[c,b]);const f=w=>{const I=b.getFieldValue("selectedStalls")||[],R={customerName:b.getFieldValue("customerName"),companyName:b.getFieldValue("companyName"),email:b.getFieldValue("email"),customerPhone:b.getFieldValue("customerPhone")},m={...x,...R};switch(console.log(`Rendering step ${w} with:`,{selectedStalls:I,exhibitorInfo:R}),w){case 0:return e.jsx(ta,{form:b,stallDetails:t,selectedStallId:n,selectedStallIds:i,exhibition:o});case 1:return e.jsx(ia,{form:b,stallDetails:t,selectedStallIds:I,exhibition:o,formValues:m});case 2:return e.jsx(ra,{form:b,formValues:m,loading:r,exhibition:o,selectedStalls:I,selectedStallIds:I,stallDetails:t,onPrev:L,onFinish:A});default:return null}};return e.jsx(nx,{title:`Book Exhibition Stall - ${y[c]}`,open:s,onCancel:d,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[c>0&&e.jsx(Xi,{onClick:L,disabled:T||r,size:"large",children:"Back"}),e.jsx("div",{children:c<g-1?e.jsx(Xi,{type:"primary",onClick:p,loading:T,disabled:r,size:"large",children:"Next"}):e.jsx(Xi,{type:"primary",onClick:A,loading:r,disabled:T,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:e.jsxs(Bt,{spinning:r||T,tip:r?"Processing your booking...":"Validating...",children:[e.jsx(ix,{children:D.map((w,I)=>e.jsxs("div",{className:`step-item ${c===I?"active":""} ${c>I?"completed":""}`,onClick:()=>c>I?S(I):null,style:{cursor:c>I?"pointer":"default"},children:[e.jsx("span",{className:"step-icon",children:c>I?e.jsx(Ar,{}):I+1}),w.title]},I))}),e.jsx($,{form:b,layout:"vertical",preserve:!0,onFieldsChange:_,children:f(c)},`form-step-${c}`)]})})},{Step:Zi}=xn,{Text:hx}=pe,px=({loginModalVisible:s,registerModalVisible:t,setRegisterModalVisible:n,setExhibitorCredentials:i,onForgotPassword:r})=>{const o=Ae(),a=ue(U=>U.exhibitorAuth),[u,b]=h.useState(!1),[c,S]=h.useState(null),[g]=$.useForm(),[x]=$.useForm(),[P]=$.useForm(),[C,v]=h.useState(0),[T,j]=h.useState(""),[N,_]=h.useState(!1),[d,p]=h.useState(!1),[L,A]=h.useState(0),[y,D]=h.useState({companyName:"",contactPerson:""}),f=h.useRef(null),w=async U=>{var V,H,W,q,Y,Z,le,ve,ce;try{S(null),b(!0);const te=await st.login(U),{exhibitor:de,token:Pe}=te.data;if(!de||!Pe)throw new Error("Invalid response from server");i({exhibitor:de,token:Pe}),o(jn()),g.resetFields(),ee.success("Login successful!")}catch(te){if(((V=te.response)==null?void 0:V.status)===403){const de=(W=(H=te.response)==null?void 0:H.data)==null?void 0:W.status;if(de==="pending")S("Your account is pending approval. You will be able to log in after admin approval.");else if(de==="rejected"){const Pe=(Y=(q=te.response)==null?void 0:q.data)==null?void 0:Y.rejectionReason;S(Pe?`Your registration has been rejected. Reason: ${Pe}`:"Your registration has been rejected. Please contact the administrator for more details.")}else S(((le=(Z=te.response)==null?void 0:Z.data)==null?void 0:le.message)||"Access denied. Please contact administrator.")}else S(((ce=(ve=te.response)==null?void 0:ve.data)==null?void 0:ce.message)||"Login failed. Please try again.")}finally{b(!1)}},I=async()=>{var U,V;try{const H=await x.validateFields(["email","companyName","contactPerson"]);b(!0),S(null),j(H.email),D({companyName:H.companyName,contactPerson:H.contactPerson}),await st.sendRegistrationOTP(H.email),_(!0),ee.success("OTP sent to your email address"),A(60),R(),v(1)}catch(H){if(H.name==="ValidationError")return;const W=((V=(U=H.response)==null?void 0:U.data)==null?void 0:V.message)||"Failed to send OTP. Please try again.";S(W),ee.error(W)}finally{b(!1)}},R=()=>{f.current&&clearInterval(f.current),f.current=setInterval(()=>{A(U=>U<=1?(f.current&&clearInterval(f.current),0):U-1)},1e3)},m=async()=>{var U,V;try{b(!0),S(null),await st.sendRegistrationOTP(T),ee.success("New OTP sent to your email address"),A(60),R()}catch(H){const W=((V=(U=H.response)==null?void 0:U.data)==null?void 0:V.message)||"Failed to resend OTP. Please try again.";S(W),ee.error(W)}finally{b(!1)}},M=async U=>{var V,H;try{b(!0),S(null);const W={email:T,otp:U.otp};await st.verifyOTP(W),p(!0),ee.success("Email verified successfully"),f.current&&clearInterval(f.current),v(2)}catch(W){const q=((H=(V=W.response)==null?void 0:V.data)==null?void 0:H.message)||"Invalid OTP. Please try again.";S(q),ee.error(q)}finally{b(!1)}},E=()=>{_(!1),p(!1),j(""),A(0),v(0),D({companyName:"",contactPerson:""}),f.current&&clearInterval(f.current),P.resetFields()},l=async U=>{var V,H,W;try{if(S(null),b(!0),!d){S("Email verification required");return}const{confirmPassword:q,...Y}=U,Z={...Y,email:T,companyName:y.companyName,contactPerson:y.contactPerson};console.log("Sending registration data:",Z);const le=await st.register(Z);ee.success("Registration successful! You can log in and book a stall only after admin approval."),n(!1),x.resetFields(),E(),setTimeout(()=>{o(xs(void 0))},500)}catch(q){console.error("Registration error:",q),console.error("Response data:",(V=q.response)==null?void 0:V.data);const Y=((W=(H=q.response)==null?void 0:H.data)==null?void 0:W.message)||"Registration failed. Please try again.";S(Y),ee.error(Y)}finally{b(!1)}};De.useEffect(()=>()=>{f.current&&clearInterval(f.current)},[]);const k=()=>{n(!1),S(null),x.resetFields(),E()},F=()=>{o(jn()),n(!0),g.resetFields()},z=()=>{n(!1),o(xs(void 0)),x.resetFields()};return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{title:"Exhibitor Login",open:s,onCancel:()=>{o(jn()),S(null),g.resetFields()},footer:null,width:400,children:[a.loginContext==="stall-booking"&&e.jsx(qe,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),c&&e.jsx(qe,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),e.jsxs($,{form:g,name:"exhibitor_login_modal",onFinish:w,layout:"vertical",children:[e.jsx($.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(G,{prefix:e.jsx(Yt,{}),placeholder:"Email",size:"large",disabled:u})}),e.jsx($.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Password",size:"large",disabled:u})}),e.jsxs($.Item,{children:[e.jsx("div",{style:{textAlign:"right",marginBottom:10},children:e.jsx(O,{type:"link",onClick:()=>{o(jn()),r()},style:{padding:0},children:"Forgot password?"})}),e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Login"})]})]}),e.jsx(Ee,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),e.jsx(O,{type:"default",block:!0,onClick:F,children:"Register as Exhibitor"})]}),e.jsxs(ge,{title:"Exhibitor Registration",open:t,onCancel:k,footer:null,width:500,children:[e.jsxs(xn,{current:C,style:{marginBottom:24},children:[e.jsx(Zi,{title:"Basic Info"}),e.jsx(Zi,{title:"Verify Email"}),e.jsx(Zi,{title:"Complete"})]}),c&&e.jsx(qe,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),C===0&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs($,{form:x,name:"exhibitor_register_step1",layout:"vertical",children:[e.jsx($.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:e.jsx(G,{prefix:e.jsx(_r,{}),placeholder:"Company Name",size:"large",disabled:u})}),e.jsx($.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:e.jsx(G,{prefix:e.jsx(Ce,{}),placeholder:"Contact Person",size:"large",disabled:u})}),e.jsx($.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(G,{prefix:e.jsx(Yt,{}),placeholder:"Email",size:"large",disabled:u})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",onClick:I,block:!0,size:"large",loading:u,children:"Continue & Verify Email"})})]}),e.jsx(Ee,{children:e.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),e.jsx(O,{type:"default",block:!0,onClick:z,children:"Login"})]}),C===1&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{message:"Email Verification",description:`We've sent a verification code to ${T}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs($,{form:P,name:"verify_otp",onFinish:M,layout:"vertical",children:[e.jsx($.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:e.jsx(G,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:u})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Verify & Continue"})})]}),e.jsxs(ie,{justify:"space-between",align:"middle",style:{marginTop:16},children:[e.jsx(B,{children:e.jsx(O,{type:"link",disabled:L>0||u,onClick:m,children:"Resend Code"})}),e.jsx(B,{children:L>0&&e.jsxs(hx,{type:"secondary",children:["Resend in ",L,"s"]})})]}),e.jsx(Ee,{}),e.jsx(O,{type:"default",block:!0,onClick:()=>v(0),children:"Back"})]}),C===2&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),e.jsxs($,{form:x,name:"exhibitor_register_step2",onFinish:l,layout:"vertical",children:[e.jsx($.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:e.jsx(G,{prefix:e.jsx(Dr,{}),placeholder:"Phone Number",size:"large",disabled:u})}),e.jsx($.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:e.jsx(G.TextArea,{placeholder:"Address",rows:3,disabled:u})}),e.jsx($.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Password",size:"large",disabled:u})}),e.jsx($.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:U})=>({validator(V,H){return!H||U("password")===H?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Confirm Password",size:"large",disabled:u})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:u,children:"Complete Registration"})})]})]})]})]})},{Step:hf}=xn,{Text:pf}=pe,xx=({visible:s})=>{const t=Ae(),[n,i]=h.useState(!1),[r,o]=h.useState(null),[a,u]=h.useState(0),[b,c]=h.useState(""),[S,g]=h.useState(!1),[x,P]=h.useState(0),C=$.useForm()[0],v=$.useForm()[0],T=$.useForm()[0],j=h.useRef(null),N=async f=>{var w,I;try{i(!0),o(null);const R=await st.requestPasswordReset(f);c(f.email),g(!0),u(1),ee.success("Password reset code sent to your email"),P(60),_()}catch(R){const m=((I=(w=R.response)==null?void 0:w.data)==null?void 0:I.message)||"Failed to send password reset code. Please try again.";o(m)}finally{i(!1)}},_=()=>{j.current&&clearInterval(j.current),j.current=setInterval(()=>{P(f=>f<=1?(j.current&&clearInterval(j.current),0):f-1)},1e3)},d=async()=>{var f,w;try{i(!0),o(null),await st.requestPasswordReset({email:b}),ee.success("New password reset code sent to your email"),P(60),_()}catch(I){const R=((w=(f=I.response)==null?void 0:f.data)==null?void 0:w.message)||"Failed to resend password reset code. Please try again.";o(R)}finally{i(!1)}},p=async f=>{var w,I;try{i(!0),o(null),u(2),j.current&&clearInterval(j.current)}catch(R){const m=((I=(w=R.response)==null?void 0:w.data)==null?void 0:I.message)||"Invalid code. Please try again.";o(m)}finally{i(!1)}},L=async f=>{var w,I;try{i(!0),o(null);const R=v.getFieldValue("otp"),m={email:b,otp:R,newPassword:f.newPassword};await st.resetPassword(m),ee.success("Password reset successful. You can now log in with your new password."),A(),t(Di()),t(xs())}catch(R){const m=((I=(w=R.response)==null?void 0:w.data)==null?void 0:I.message)||"Failed to reset password. Please try again.";o(m)}finally{i(!1)}},A=()=>{u(0),c(""),g(!1),P(0),j.current&&clearInterval(j.current),C.resetFields(),v.resetFields(),T.resetFields()},y=()=>{A(),t(Di())},D=()=>{A(),t(Di()),t(xs())};return De.useEffect(()=>()=>{j.current&&clearInterval(j.current)},[]),e.jsxs(ge,{title:"Forgot Password",open:s,onCancel:y,footer:null,width:400,children:[r&&e.jsx(qe,{message:r,type:"error",style:{marginBottom:16}}),e.jsx(xn,{current:a,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),a===0&&e.jsxs($,{form:C,onFinish:N,layout:"vertical",children:[e.jsx($.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{prefix:e.jsx(Yt,{}),placeholder:"Email"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Send Reset Code"})}),e.jsx(Ee,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),e.jsx(O,{type:"link",onClick:D,block:!0,children:"Back to Login"})]}),a===1&&e.jsxs($,{form:v,onFinish:p,layout:"vertical",children:[e.jsxs("p",{children:["We've sent a verification code to ",e.jsx("strong",{children:b}),". Please check your email and enter the code below."]}),e.jsx($.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:e.jsx(G,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Verify Code"})}),e.jsx("div",{style:{textAlign:"center",marginTop:8},children:x>0?e.jsxs(pe.Text,{type:"secondary",children:["Resend code in ",x,"s"]}):e.jsx(O,{type:"link",onClick:d,disabled:n,children:"Resend Code"})}),e.jsx(Ee,{style:{margin:"12px 0"},children:e.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),e.jsx(O,{type:"link",onClick:()=>{u(0),j.current&&(clearInterval(j.current),P(0))},block:!0,children:"Change Email"})]}),a===2&&e.jsxs($,{form:T,onFinish:L,layout:"vertical",children:[e.jsx($.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"New Password"})}),e.jsx($.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:f})=>({validator(w,I){return!I||f("newPassword")===I?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:e.jsx(G.Password,{prefix:e.jsx(Ht,{}),placeholder:"Confirm Password"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",block:!0,loading:n,children:"Reset Password"})})]})]})},{Header:mx}=Fe,fx=J(mx)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,gx=J.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,yx=J.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,bx=J.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,jx=J.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,oa=J(wt)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,aa=J(jt)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,vx=J(jt)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,wx=J(O)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,Sx=J.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,kx=J(pt)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,Rn=J(O)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,Cx=J.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,Ix=J.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,It=()=>{var y;const s=ke(),t=Ae(),[n,i]=h.useState(!1),[r,o]=h.useState(!1),[a,u]=h.useState(!1),[b,c]=h.useState("/logo.png"),[S,g]=h.useState("Exhibition Manager"),x=ue(D=>D.exhibitorAuth),{exhibitor:P,isAuthenticated:C,showLoginModal:v,showForgotPasswordModal:T}=x;h.useEffect(()=>{const D=localStorage.getItem("cachedLogoUrl"),f=localStorage.getItem("logoTimestamp"),w=new Date().getTime();if(D&&f&&w-parseInt(f)<36e5)c(D);else{const I=`${ne.defaults.baseURL}/public/logo`;c(I),localStorage.setItem("cachedLogoUrl",I),localStorage.setItem("logoTimestamp",w.toString());const R=new Image;R.src=I}fetch(`${ne.defaults.baseURL}/public/site-info`).then(I=>I.json()).then(I=>{I.siteName&&g(I.siteName)}).catch(I=>{console.error("Error fetching site info:",I)})},[]),h.useEffect(()=>(ee.config({top:84,duration:3,maxCount:1}),()=>{ee.destroy()}),[]);const j=()=>{t(Za()),ee.success("Successfully logged out"),s("/"),i(!1),o(!1)},N=()=>{t(xs(void 0)),i(!1),o(!1)},_=()=>{u(!0),i(!1),o(!1)},d=()=>{t(Zd())},p=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],L=e.jsx(aa,{items:[{key:"exhibitor-login",icon:e.jsx(no,{}),label:e.jsx("a",{onClick:N,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:e.jsx(nn,{}),label:e.jsx("a",{onClick:_,children:"Register as Exhibitor"})}]}),A=e.jsx(aa,{items:[{key:"exhibitor-dashboard",icon:e.jsx(ui,{}),label:e.jsx(pt,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:e.jsx(Ce,{}),label:e.jsx(pt,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:e.jsx(ct,{}),label:e.jsx(pt,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:e.jsx(di,{}),label:e.jsx("a",{onClick:j,children:"Logout"})}]});return e.jsxs(e.Fragment,{children:[e.jsx(fx,{children:e.jsxs(gx,{children:[e.jsx(yx,{children:e.jsx(pt,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:e.jsx(bx,{children:e.jsx(jx,{src:b,alt:"Logo",onError:()=>c("/logo.png")})})})}),e.jsx(vx,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:p.map(D=>({key:D.key,label:e.jsx(pt,{to:D.path,children:D.label})}))}),e.jsx(Cx,{children:e.jsx(ms,{overlay:x.isAuthenticated?A:L,trigger:["click"],placement:"bottomRight",open:n,onOpenChange:i,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:x.isAuthenticated?e.jsxs(X,{style:{cursor:"pointer"},children:[e.jsx(Ix,{children:((y=x.exhibitor)==null?void 0:y.companyName)||"Exhibitor"}),e.jsx(oa,{icon:e.jsx(Ce,{}),size:"large"})]}):e.jsx(oa,{icon:e.jsx(Ce,{}),size:"large"})})}),e.jsx(wx,{icon:e.jsx(Gl,{}),onClick:()=>o(!0)})]})}),e.jsx(Sx,{children:e.jsxs(Kl,{title:"Exhibition Management System",placement:"right",onClose:()=>o(!1),open:r,width:280,closeIcon:e.jsx("span",{style:{fontSize:"16px"},children:""}),children:[e.jsx("div",{style:{marginBottom:24},children:p.map(D=>e.jsx(kx,{to:D.path,onClick:()=>o(!1),children:D.label},D.key))}),e.jsx("div",{style:{marginTop:40},children:x.isAuthenticated?e.jsxs(e.Fragment,{children:[e.jsx(Rn,{type:"primary",icon:e.jsx(ui,{}),onClick:()=>{s("/exhibitor/dashboard"),o(!1)},children:"Dashboard"}),e.jsx(Rn,{type:"default",icon:e.jsx(di,{}),onClick:j,children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Rn,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:e.jsx(no,{}),onClick:()=>{N(),o(!1)},children:"Exhibitor Login"}),e.jsx(Rn,{type:"default",icon:e.jsx(nn,{}),onClick:()=>{_(),o(!1)},children:"Register as Exhibitor"})]})})]})}),e.jsx(px,{loginModalVisible:v,registerModalVisible:a,setRegisterModalVisible:u,setExhibitorCredentials:D=>t(wr(D)),onForgotPassword:d}),e.jsx(xx,{visible:T})]})},{Content:_n}=Fe,{Title:xf}=pe,Ex=s=>{if(!s)return"";if(s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;if(t.includes("logos/"))return`${ne.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},Ax=()=>{var k,F,z,U;const{id:s}=ft(),t=ke(),n=Ae(),[i,r]=h.useState(null),[o,a]=h.useState(null),[u,b]=h.useState(null),[c,S]=h.useState([]),[g,x]=h.useState(!1),[P,C]=h.useState(!0),[v,T]=h.useState(null),[j,N]=h.useState(!1),[_,d]=h.useState(null),p=h.useRef(null),[L,A]=h.useState({width:800,height:600}),[y,D]=h.useState(!1),[f]=$.useForm(),{isAuthenticated:w}=ue(V=>V.exhibitorAuth);h.useEffect(()=>{const V=()=>{D(window.innerWidth<768)};return V(),window.addEventListener("resize",V),()=>{window.removeEventListener("resize",V)}},[]);const I=h.useCallback(V=>V.status==="booked"||V.status==="reserved",[]),R=h.useCallback(()=>{if(p.current){const{clientWidth:V,clientHeight:H}=p.current,W=y?320:800,q=y?480:600,Y=Math.max(V||W,W),Z=Math.max(H||q,q);(Math.abs(Y-L.width)>5||Math.abs(Z-L.height)>5)&&A({width:Y,height:Z})}},[L.width,L.height,y]);h.useEffect(()=>{let V=null;const H=()=>{V===null&&(V=window.setTimeout(()=>{V=null,R()},y?100:50))};R();const W=new ResizeObserver(H);return p.current&&W.observe(p.current),window.addEventListener("resize",H),()=>{V!==null&&window.clearTimeout(V),W.disconnect(),window.removeEventListener("resize",H)}},[R,y]),h.useEffect(()=>{(async()=>{try{if(!s){T("Exhibition ID is missing"),C(!1);return}C(!0),T(null);const H=await xt.getLayout(s);r(H.data)}catch(H){T(H.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",H)}finally{C(!1)}})()},[s]),h.useEffect(()=>{i&&R()},[i]),h.useEffect(()=>{w&&i&&(b(null),S([]),R(),ee.info("You can now select stalls to book.",3))},[w]);const m=h.useCallback(async V=>{if(I(V)){ee.info(`This stall (${V.stallNumber}) is already booked.`);return}if(!w){n(xs("stall-booking"));return}const W=V._id||V.id;S(q=>q.includes(W)?(ee.info(`Stall ${V.stallNumber} removed from selection`),q.filter(Y=>Y!==W)):(ee.success(`Stall ${V.stallNumber} added to selection`),[...q,W]))},[I,w,n]),M=async V=>{try{N(!0);const H={...V,exhibitionId:i==null?void 0:i.exhibition._id,stallIds:V.selectedStalls};if(w){const W=await xt.exhibitorBookStalls(H);ee.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const W=await xt.bookMultipleStalls(s,H);ee.success("Your booking request has been submitted successfully!")}if(x(!1),S([]),s)try{const W=await xt.getLayout(s);r(W.data)}catch(W){console.error("Error refreshing layout data:",W)}}catch(H){console.error("Error booking stall",H),ee.error("Failed to book stall. Please try again.")}finally{N(!1)}},E=async()=>{if(c.length===0){ee.warning("Please select at least one stall to book");return}try{N(!0),await xt.getStallDetails(s,c[0]);const V=(i==null?void 0:i.layout.flatMap(H=>H.stalls.map(W=>{var q,Y;return{id:W.id,number:W.stallNumber,stallNumber:W.stallNumber,price:W.price||0,ratePerSqm:(q=W.dimensions)!=null&&q.width&&((Y=W.dimensions)!=null&&Y.height)?(W.price||0)/(W.dimensions.width*W.dimensions.height):0,dimensions:W.dimensions,status:W.status,hallId:H.id,hallName:H.name,type:W.type||"Standard",typeName:W.typeName||W.type||"Standard"}})))||[];d(V),x(!0)}catch(V){console.error("Error preparing booking modal",V),ee.error("Failed to load stall details. Please try again.")}finally{N(!1)}};h.useCallback(V=>{V.cancelBubble=!0},[]);const l=h.useMemo(()=>{var V;return i?{halls:i.layout.map(H=>e.jsx(yl,{hall:{...H,exhibitionId:s||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},H.id)),stalls:i.layout.flatMap(H=>H.stalls.map(W=>{var q,Y,Z,le,ve,ce,te,de;return e.jsx(Jr,{stall:{...W,hallId:H.id,hallName:H.name,isSelected:c.includes(W.id),stallTypeId:"default",number:W.stallNumber,typeName:W.type||"Standard",ratePerSqm:W.price||0,rotation:0,dimensions:{x:((q=W.position)==null?void 0:q.x)||0,y:((Y=W.position)==null?void 0:Y.y)||0,width:((Z=W.dimensions)==null?void 0:Z.width)||0,height:((le=W.dimensions)==null?void 0:le.height)||0},status:W.status==="maintenance"?"booked":W.status},isSelected:u===W.id||c.includes(W.id),onSelect:W.status==="available"?()=>m(W):void 0,hallWidth:((ve=H.dimensions)==null?void 0:ve.width)||0,hallHeight:((ce=H.dimensions)==null?void 0:ce.height)||0,hallX:((te=H.dimensions)==null?void 0:te.x)||0,hallY:((de=H.dimensions)==null?void 0:de.y)||0},W.id)})),fixtures:(V=i.fixtures)==null?void 0:V.map(H=>{var W,q;return e.jsx(bl,{fixture:{...H,id:H.id||H._id,_id:H._id||H.id,exhibitionId:s||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((W=i.exhibition.dimensions)==null?void 0:W.width)||0,exhibitionHeight:((q=i.exhibition.dimensions)==null?void 0:q.height)||0},H.id||H._id)})}:null},[i,s,u,c,m]);return P?e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(_n,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Bt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):v||!i?e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(_n,{style:{paddingTop:"64px"},children:e.jsx(an,{status:"error",title:"Failed to load exhibition layout",subTitle:v||"The exhibition layout couldn't be loaded.",extra:[e.jsx(O,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((k=i.exhibition.dimensions)!=null&&k.width)||!((F=i.exhibition.dimensions)!=null&&F.height)?e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(_n,{style:{paddingTop:"64px"},children:e.jsx(K,{children:e.jsx(an,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(_n,{style:{paddingTop:"64px",background:"#f7f8fa"},children:e.jsxs(K,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:"10px 0px",border:"none"},children:[e.jsxs(ie,{gutter:[24,24],style:{marginBottom:32},children:[e.jsx(B,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"row",alignItems:"center",gap:"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{flexShrink:0},children:i.exhibition.headerLogo?e.jsx(Ia,{src:Ex(i.exhibition.headerLogo),alt:`${i.exhibition.name} logo`,style:{maxHeight:90,maxWidth:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:250,height:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:e.jsx(Bt,{size:"small"})})}):e.jsx("div",{style:{width:90,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(Ct,{style:{fontSize:32,color:"#aaa"}})})}),e.jsx(Ee,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i.exhibition.name}),e.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(Ct,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsxs("span",{children:[new Date(i.exhibition.startDate).toLocaleDateString()," -",new Date(i.exhibition.endDate).toLocaleDateString()]})]}),e.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:"14px"},children:[e.jsx(Ls,{style:{fontSize:"16px",color:"#1890ff"}}),e.jsx("span",{children:i.exhibition.venue})]})]})]})}),e.jsx(B,{xs:24,md:12,children:e.jsxs("div",{style:{padding:"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"12px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{style:{marginBottom:"12px",fontSize:"16px",fontWeight:500,color:"#444"},children:"Stall Status:"}),e.jsxs(X,{size:"middle",wrap:!0,children:[e.jsx(re,{color:"#87d068",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(bt,{status:"success",text:"Available"})}),e.jsx(re,{color:"#ffd591",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(bt,{status:"warning",text:"Booked"})}),e.jsx(re,{color:"#ffadd2",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:e.jsx(bt,{status:"processing",text:"Reserved"})}),c.length>0&&e.jsx(re,{color:"#1890ff",style:{padding:"6px 14px",borderRadius:"20px",fontSize:"13px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.jsx(bt,{status:"processing",color:"#1890ff",text:`Selected (${c.length})`})})]})]})})]}),e.jsxs("div",{ref:p,style:{width:"100%",height:"80vh",minHeight:"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform"},className:"public-canvas-container",children:[e.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Optimize rendering without affecting appearance */
                .konvajs-content {
                  will-change: transform;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Very subtle drag optimization for smoother experience */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                }
              `}),e.jsxs(gn,{width:L.width,height:L.height,exhibitionWidth:((z=i==null?void 0:i.exhibition.dimensions)==null?void 0:z.width)||0,exhibitionHeight:((U=i==null?void 0:i.exhibition.dimensions)==null?void 0:U.height)||0,halls:(i==null?void 0:i.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[l==null?void 0:l.halls,l==null?void 0:l.stalls,l==null?void 0:l.fixtures]})]})]})}),c.length>0&&e.jsx(Xl,{offsetBottom:20,children:e.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:e.jsxs(O,{type:"primary",size:"large",icon:e.jsx(hr,{}),onClick:E,loading:j,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",c.length,")"]})})}),e.jsx(ux,{visible:g,stallDetails:_,selectedStallId:u,selectedStallIds:c,loading:j,exhibition:i==null?void 0:i.exhibition,onCancel:()=>{x(!1)},onSubmit:M})]})},Nx=De.memo(Ax),{Content:er}=Fe,{Title:tr,Text:as,Paragraph:la}=pe,sr=s=>{if(!s)return"";if(s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;if(t.includes("logos/")||t.includes("sponsors/"))return`${ne.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${ne.defaults.baseURL}/${i}?token=${n}`:`${ne.defaults.baseURL}/${i}`},Tx=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},Dn=s=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},Px=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);if(n<i){const o=i.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} until start`,count:a,isPast:!1}}else if(n>r){const o=n.getTime()-r.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} since end`,count:a,isPast:!0}}else{const o=r.getTime()-n.getTime(),a=Math.ceil(o/(1e3*60*60*24));return{text:`Day${a!==1?"s":""} remaining`,count:a,isPast:!1}}},Rx=()=>{const{id:s}=ft(),t=ke(),[n,i]=h.useState(null),[r,o]=h.useState(!0),[a,u]=h.useState(null),[b,c]=h.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(h.useEffect(()=>{(async()=>{try{if(!s){u("Exhibition ID is missing");return}o(!0),u(null);const C=await xt.getExhibition(s);if(i(C.data),C.data.headerBackground){const v=sr(C.data.headerBackground);c(v);const T=new window.Image;T.src=v}else if(C.data.headerLogo){const v=sr(C.data.headerLogo),T=new window.Image;T.src=v}}catch(C){console.error("Error fetching exhibition:",C),u(C.message||"Error fetching exhibition")}finally{o(!1)}})()},[s]),r)return e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(er,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Bt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(a||!n)return e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(er,{style:{paddingTop:"64px"},children:e.jsx(an,{status:"404",title:"Exhibition not found",subTitle:a||"The exhibition you're looking for doesn't exist or has been removed.",extra:e.jsx(O,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:S,color:g}=Tx(n.startDate,n.endDate),x=Px(n.startDate,n.endDate);return e.jsxs(Fe,{className:"exhibition-details-layout",children:[e.jsx(It,{}),e.jsxs(er,{className:"exhibition-content",children:[e.jsx("div",{className:"breadcrumb-container",children:e.jsx(Jl,{items:[{title:e.jsx(pt,{to:"/",children:e.jsx(_r,{})})},{title:e.jsx(pt,{to:"/exhibitions",children:"Exhibitions"})},{title:n.name}]})}),e.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${b}')`},children:e.jsx("div",{className:"hero-overlay",children:e.jsxs("div",{className:"hero-content",children:[e.jsxs("div",{className:"hero-main",children:[e.jsx(tr,{level:1,className:"exhibition-title",children:n.name}),e.jsxs(X,{size:24,className:"exhibition-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx(Ct,{}),e.jsxs(as,{children:[Dn(n.startDate)," - ",Dn(n.endDate)]})]}),n.venue&&e.jsxs("div",{className:"meta-item",children:[e.jsx(hs,{}),e.jsx(as,{children:n.venue})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(Ze,{}),e.jsxs(as,{children:[x.text,": ",e.jsx("strong",{children:x.count})]})]})]})]}),e.jsxs("div",{className:"hero-actions",children:[e.jsx(O,{type:"primary",size:"large",icon:e.jsx(gs,{}),onClick:()=>t(`/exhibitions/${s}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),e.jsx(O,{size:"large",icon:e.jsx(ct,{}),onClick:()=>t(`/exhibitions/${s}/layout`),className:"action-button book-button",children:"Book a Stall"}),x.isPast?null:e.jsx(O,{size:"large",icon:e.jsx(Tr,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),e.jsx("div",{className:"stats-container",children:e.jsxs(ie,{gutter:[16,16],className:"stats-row",children:[e.jsx(B,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon duration-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:Math.ceil((new Date(n.endDate).getTime()-new Date(n.startDate).getTime())/(1e3*60*60*24))}),e.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),e.jsx(B,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon countdown-icon",children:e.jsx(Ze,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:x.count}),e.jsx("div",{className:"stat-label",children:x.text})]})]})}),e.jsx(B,{xs:24,sm:8,children:e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:g+"20",color:g},children:e.jsx(Ls,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value status-value",style:{color:g},children:S}),e.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),n.sponsorLogos&&n.sponsorLogos.length>0&&e.jsxs("div",{className:"sponsors-section",children:[e.jsx("div",{className:"sponsors-header",children:e.jsx(as,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),e.jsx("div",{className:"sponsors-container",children:n.sponsorLogos.map((P,C)=>e.jsx("div",{className:"sponsor-logo-wrapper",children:e.jsx("div",{className:"sponsor-logo",children:e.jsx("img",{src:sr(P),alt:`Sponsor ${C+1}`,className:"sponsor-logo-img",onError:v=>{v.target.src="/placeholder-logo.png"}})})},C))})]}),e.jsx("div",{className:"exhibition-details-container",children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:24,lg:16,children:e.jsxs(K,{className:"details-card about-card",bordered:!1,children:[e.jsx(tr,{level:3,className:"section-title",children:"About This Exhibition"}),e.jsx(la,{className:"main-description",children:n.description}),n.headerDescription&&e.jsx(la,{className:"extended-description",children:n.headerDescription}),n.headerSubtitle&&e.jsxs("div",{className:"subtitle-section",children:[e.jsx(tr,{level:4,children:n.headerSubtitle}),e.jsx(Ee,{})]})]})}),e.jsx(B,{xs:24,lg:8,children:e.jsx(X,{direction:"vertical",style:{width:"100%"},size:24,children:e.jsx(K,{title:"Key Information",className:"details-card info-card",bordered:!1,children:e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon start-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(as,{type:"secondary",className:"info-label",children:"Start Date"}),e.jsx("div",{className:"info-value",children:Dn(n.startDate)})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon end-icon",children:e.jsx(Ct,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(as,{type:"secondary",className:"info-label",children:"End Date"}),e.jsx("div",{className:"info-value",children:Dn(n.endDate)})]})]}),n.venue&&e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-icon venue-icon",children:e.jsx(hs,{})}),e.jsxs("div",{className:"info-content",children:[e.jsx(as,{type:"secondary",className:"info-label",children:"Venue"}),e.jsx("div",{className:"info-value",children:n.venue})]})]})]})})})})]})})]}),e.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:_x}=Fe,{Title:Dx,Paragraph:Lx,Text:$x}=pe,Fx=J(_x)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Bx=J.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Ln=J(Dx)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Mx=J.div`
  margin-bottom: 20px;
`,zx=J.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,At=J(pt)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,nr=J.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,ir=J.div`
  margin-right: 10px;
  color: #4158D0;
`,$n=J.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Ox=J(G)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,qx=J(O)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Ux=J($x)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Vx=J(Ee)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,jl=()=>{const[s,t]=h.useState("/logo.png"),[n,i]=h.useState("Exhibition Manager"),r=new Date().getFullYear();return h.useEffect(()=>{const o=`${ne.defaults.baseURL}/public/logo`;t(o),fetch(`${ne.defaults.baseURL}/public/site-info`).then(a=>a.json()).then(a=>{a.siteName&&i(a.siteName)}).catch(a=>{console.error("Error fetching site info:",a)})},[]),e.jsx(Fx,{children:e.jsxs(Bx,{children:[e.jsxs(ie,{gutter:[48,40],children:[e.jsxs(B,{xs:24,sm:24,md:8,lg:7,children:[e.jsx(Mx,{children:e.jsx(pt,{to:"/",children:e.jsx(zx,{src:s,alt:n,onError:()=>t("/logo.png")})})}),e.jsx(Lx,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),e.jsxs(X,{children:[e.jsx($n,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(Zl,{})}),e.jsx($n,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(ec,{})}),e.jsx($n,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(tc,{})}),e.jsx($n,{href:"#",target:"_blank",rel:"noopener noreferrer",children:e.jsx(sc,{})})]})]}),e.jsxs(B,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(Ln,{level:4,children:"Quick Links"}),e.jsx(At,{to:"/exhibitions",children:"Exhibitions"}),e.jsx(At,{to:"/about",children:"About Us"}),e.jsx(At,{to:"/contact",children:"Contact Us"}),e.jsx(At,{to:"/privacy-policy",children:"Privacy Policy"}),e.jsx(At,{to:"/terms",children:"Terms & Conditions"})]}),e.jsxs(B,{xs:24,sm:12,md:5,lg:5,children:[e.jsx(Ln,{level:4,children:"For Exhibitors"}),e.jsx(At,{to:"/exhibitor/login",children:"Login"}),e.jsx(At,{to:"/exhibitor/register",children:"Register"}),e.jsx(At,{to:"/exhibitor/dashboard",children:"Dashboard"}),e.jsx(At,{to:"/exhibitor/bookings",children:"My Bookings"}),e.jsx(At,{to:"/faq",children:"FAQ"})]}),e.jsxs(B,{xs:24,sm:24,md:6,lg:7,children:[e.jsx(Ln,{level:4,children:"Contact Us"}),e.jsxs(nr,{children:[e.jsx(ir,{children:e.jsx(hs,{})}),e.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),e.jsxs(nr,{children:[e.jsx(ir,{children:e.jsx(Dr,{})}),e.jsx("div",{children:"+91 98765 43210"})]}),e.jsxs(nr,{children:[e.jsx(ir,{children:e.jsx(Yt,{})}),e.jsx("div",{children:"info@exhibitionmanager.com"})]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx(Ln,{level:4,children:"Newsletter"}),e.jsx($,{children:e.jsxs(X.Compact,{style:{width:"100%"},children:[e.jsx(Ox,{placeholder:"Your email address"}),e.jsx(qx,{type:"primary",icon:e.jsx(nc,{}),children:"Subscribe"})]})})]})]})]}),e.jsx(Vx,{}),e.jsxs(Ux,{children:[" ",r," ",n,". All rights reserved."]})]})})},{Title:ca,Text:rr,Paragraph:da}=pe,{Content:or}=Fe,Hx=(s,t)=>{const n=new Date,i=new Date(s),r=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>r?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},ua=s=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)},Wx=s=>{const t=new Date,i=new Date(s).getTime()-t.getTime();return Math.ceil(i/(1e3*60*60*24))},ha=s=>{if(!s)return"/exhibition-placeholder.jpg";if(s.startsWith("/")||s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s,n=t.includes("logos/")?t:`logos/${t}`;return`${ne.defaults.baseURL}/public/images/${n}`},Yx=()=>{const s=ke(),[t,n]=h.useState([]),[i,r]=h.useState(!0),[o,a]=h.useState(null),[u,b]=h.useState({});return h.useEffect(()=>{(async()=>{try{r(!0),a(null);const S=await xt.getExhibitions();n(S.data);const g={};S.data.forEach(x=>{if(x.headerLogo){const P=ha(x.headerLogo),C=new window.Image;C.onload=()=>{g[x._id]=!0,b(v=>({...v,[x._id]:!0}))},C.onerror=()=>{console.warn(`Failed to preload image: ${P}`),g[x._id]=!1,b(v=>({...v,[x._id]:!1}))},C.src=P}})}catch(S){a(S.message||"Failed to fetch exhibitions")}finally{r(!1)}})()},[]),i?e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(or,{style:{paddingTop:"64px"},children:e.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[e.jsx(Bt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):o?e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(or,{style:{paddingTop:"64px"},children:e.jsx(an,{status:"error",title:"Failed to load exhibitions",subTitle:o,extra:[e.jsx(O,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsx(or,{style:{paddingTop:"64px",background:"#f5f5f5"},children:e.jsxs("div",{style:{padding:"80px 16px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[e.jsx(ca,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),e.jsx(da,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?e.jsx(ie,{gutter:[24,24],children:t.map(c=>{const{status:S,color:g}=Hx(c.startDate,c.endDate),x=Wx(c.startDate),P=c.headerLogo?ha(c.headerLogo):void 0;return e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(K,{hoverable:!0,onClick:()=>s(Ai(c)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[e.jsx(bt.Ribbon,{text:S,color:g,style:{right:"-1px",top:"10px",zIndex:2}}),e.jsxs("div",{className:"exhibition-card-container",children:[e.jsx("div",{className:"exhibition-card-logo-container",children:P&&e.jsx("div",{className:"exhibition-logo",children:e.jsx(Ia,{src:P,alt:`${c.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:e.jsx(Bt,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),e.jsxs("div",{className:"exhibition-card-content",children:[e.jsx("div",{className:"exhibition-title",children:e.jsx(ca,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:c.name})}),e.jsx(da,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:c.description}),e.jsxs("div",{className:"exhibition-card-details",children:[e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Ct,{style:{color:"#722ED1"}}),e.jsx(Ve,{title:"Exhibition Date Range",children:e.jsxs(rr,{style:{fontSize:14},children:[ua(c.startDate)," - ",ua(c.endDate)]})})]}),c.venue&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(hs,{style:{color:"#F5222D"}}),e.jsx(Ve,{title:"Venue",children:e.jsx(rr,{style:{fontSize:14},ellipsis:!0,children:c.venue})})]}),S==="Upcoming"&&x>0&&e.jsxs("div",{className:"exhibition-card-detail-item",children:[e.jsx(Ze,{style:{color:"#1890FF"}}),e.jsx(Ve,{title:"Time Remaining",children:e.jsxs(rr,{style:{fontSize:14},children:["Starts in ",x," day",x!==1?"s":""]})})]})]}),e.jsx("div",{className:"exhibition-card-footer",children:e.jsxs(O,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",e.jsx(pr,{})]})})]})]})]})},c._id)})}):e.jsx(Xe,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:Xe.PRESENTED_IMAGE_SIMPLE})]})}),e.jsx(jl,{}),e.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},Qx=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=ke(),{currentExhibition:r}=ue(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>i(Ye(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Gx=()=>{var M,E,l;const{message:s}=it.useApp(),{id:t}=ft(),n=Qt(),i=ke(),r=Ae(),[o,a]=fc(),u=((M=n.state)==null?void 0:M.exhibitionId)||t,{currentExhibition:b,halls:c,stalls:S,loading:g}=ue(k=>k.exhibition),x=h.useRef(null),[P,C]=h.useState(!1),[v,T]=h.useState(null),[j,N]=h.useState(null),[_,d]=h.useState({width:0,height:0}),[p,L]=h.useState(!1);h.useEffect(()=>{if(!u){s.error("Exhibition ID not found"),i("/exhibitions");return}},[u,i,s]),h.useEffect(()=>{if(!u){s.error("Exhibition ID not found"),i("/exhibition");return}(async()=>{try{await r(vt(u)).unwrap(),await r(Ft(u)).unwrap(),L(!0)}catch{s.error("Failed to load data")}})()},[u,r,i]),h.useEffect(()=>{var k,F;!p||!b||(!((k=b.dimensions)!=null&&k.width)||!((F=b.dimensions)!=null&&F.height))&&(s.info("Please set up exhibition space first"),i(Ye(b,"space"),{state:{exhibitionId:u}}))},[b,u,i,p]),h.useEffect(()=>{!p||g||c.length===0&&(s.info("Please create halls first"),i(Ye(b,"halls"),{state:{exhibitionId:u}}))},[c,u,i,g,p]),h.useEffect(()=>{p&&b&&c.length>0&&(async()=>{try{const F=c.map(z=>r($t({exhibitionId:u,hallId:z.id})).unwrap());await Promise.all(F)}catch(F){console.error("Error fetching stalls:",F),s.error("Failed to load stalls")}})()},[b,u,c,r,p]);const A=S.filter(k=>k.hallId===((v==null?void 0:v.id)||(v==null?void 0:v._id)));h.useEffect(()=>{if(!p||c.length===0)return;const k=o.get("hallId");if(k){const F=c.find(z=>z.id===k||z._id===k);if(F)T(F);else if(c.length>0){T(c[0]);const z=c[0].id||c[0]._id;z&&a({hallId:z.toString()})}}else if(c.length>0){T(c[0]);const F=c[0].id||c[0]._id;F&&a({hallId:F.toString()})}},[c,o,p,a]),h.useEffect(()=>{const k=()=>{if(x.current){const{clientWidth:z,clientHeight:U}=x.current;d({width:Math.max(z||400,400),height:Math.max(U||400,400)})}};k();const F=new ResizeObserver(k);return x.current&&F.observe(x.current),window.addEventListener("resize",k),()=>{F.disconnect(),window.removeEventListener("resize",k)}},[]);const y=()=>{if(!v){s.warning("Please select a hall first");return}N(null),C(!0)},D=k=>{if(T(k),N(null),k){const F=k.id||k._id;a(F?{hallId:F.toString()}:{})}else a({})},f=k=>{var z;const F=k?{...k,id:k.id||k._id,_id:k._id||k.id,stallTypeId:typeof k.stallTypeId=="string"?k.stallTypeId:((z=k.stallTypeId)==null?void 0:z._id)||k.stallTypeId,stallType:k.stallType}:null;console.log("Selected stall data:",F),N(F),C(!!F)},w=async k=>{var F,z;try{if(!(v!=null&&v.id)&&!(v!=null&&v._id)){s.error("No hall selected");return}const U=v.id,V=v._id||v.id;if(k.hallId&&k.hallId!==V){s.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",k),k.id||k._id){const H={...k,id:k.id,_id:k._id,hallId:V,stallTypeId:k.stallTypeId};console.log("Update data:",H);const W=k.id||k._id;if(!W)throw new Error("Stall ID is missing");await Re.updateStall(u,W,H),s.success("Stall updated successfully")}else{const{id:H,_id:W,...q}=k,Y={...q,hallId:V,stallTypeId:k.stallTypeId};console.log("Creating new stall with data:",Y),await Re.createStall(u,Y),s.success("Stall created successfully")}C(!1),r($t({exhibitionId:u,hallId:U}))}catch(U){console.error("Error saving stall:",U),s.error(((z=(F=U.response)==null?void 0:F.data)==null?void 0:z.message)||"Failed to save stall")}},I=async k=>{var F,z;try{if(!u){s.error("Exhibition ID not found");return}const U=v;if(!U){s.error("No hall selected");return}const V=U.id||U._id;if(!V){s.error("Invalid hall ID");return}await Re.deleteStall(u,k),C(!1),N(null),await r($t({exhibitionId:u,hallId:V})).unwrap(),s.success("Stall deleted successfully")}catch(U){console.error("Error deleting stall:",U),s.error(((z=(F=U.response)==null?void 0:F.data)==null?void 0:z.message)||"Failed to delete stall")}},R=async k=>{var V,H;if(!u){s.error("Exhibition ID not found");return}const F=k.id||k._id;if(!F){console.error("Stall data:",k),s.error("Stall ID not found");return}if(!(v!=null&&v.id)&&!(v!=null&&v._id)){s.error("No hall selected");return}const z=v.id,U=v._id||v.id;try{await Re.updateStall(u,F,{...k,id:F,hallId:U}),r($t({exhibitionId:u,hallId:z}))}catch(W){console.error("Stall update error:",W),s.error(((H=(V=W.response)==null?void 0:V.data)==null?void 0:H.message)||"Failed to update stall position")}},m=()=>{C(!1),N(null)};return e.jsx(fn,{children:e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{padding:"24px 24px 0"},children:e.jsx(Qx,{exhibitionId:u})}),e.jsx(K,{title:"Stall Manager",extra:e.jsxs(X,{children:[e.jsx(O,{icon:e.jsx(Ca,{}),onClick:()=>i(`/exhibition/${u}`,{state:{exhibitionId:u}}),children:"Back to Exhibition"}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:y,disabled:!v,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:e.jsx("div",{ref:x,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:b&&e.jsx(gn,{width:_.width,height:_.height,exhibitionWidth:((E=b.dimensions)==null?void 0:E.width)||100,exhibitionHeight:((l=b.dimensions)==null?void 0:l.height)||100,halls:c,selectedHall:v,onSelectHall:D,isStallMode:!0,children:v&&A.map(k=>e.jsx(Jr,{stall:k,isSelected:(j==null?void 0:j.id)===k.id||(j==null?void 0:j._id)===k._id,onSelect:()=>f(k),onChange:R,hallWidth:v.dimensions.width,hallHeight:v.dimensions.height,hallX:v.dimensions.x,hallY:v.dimensions.y},k.id||k._id))})})}),b&&e.jsx(Hp,{visible:P,stall:j,hall:v,exhibition:b,onCancel:m,onSubmit:w,onDelete:j?()=>I(j.id||j._id):void 0})]})})},Kx=({exhibitionId:s,destination:t="layout",label:n="Back to Layout"})=>{const i=ke(),{currentExhibition:r}=ue(o=>o.exhibition);return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>i(Ye(r,t),{state:{exhibitionId:s}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:n})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Xx=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],Jx=()=>{var w,I,R;const{message:s}=it.useApp(),{id:t}=ft(),n=Qt(),i=ke(),r=Ae(),o=((w=n.state)==null?void 0:w.exhibitionId)||t,{currentExhibition:a,fixtures:u,halls:b,stalls:c,loading:S}=ue(m=>m.exhibition),g=h.useRef(null),[x,P]=h.useState(!1),[C,v]=h.useState(null),[T,j]=h.useState({width:0,height:0}),[N,_]=h.useState("all"),[d,p]=h.useState([]);h.useEffect(()=>{if(!o){s.error("Exhibition ID not found"),i("/exhibitions");return}},[o,i,s]),h.useEffect(()=>{(async()=>{try{await r(vt(o)).unwrap(),await r(tn({exhibitionId:o})).unwrap(),await r(Ft(o)).unwrap(),await r($t({exhibitionId:o})).unwrap()}catch{s.error("Failed to load data")}})()},[o,r,s]),h.useEffect(()=>{p(N==="all"?u:u.filter(m=>m.type===N))},[u,N]),h.useEffect(()=>{const m=()=>{if(g.current){const{clientWidth:E,clientHeight:l}=g.current;j({width:Math.max(E||400,400),height:Math.max(l||400,400)})}};m();const M=new ResizeObserver(m);return g.current&&M.observe(g.current),window.addEventListener("resize",m),()=>{M.disconnect(),window.removeEventListener("resize",m)}},[]);const L=()=>{v(null),P(!0)},A=m=>{v(m),P(!!m)},y=async m=>{try{m.id||m._id?(await r(ni({exhibitionId:o,id:m.id||m._id||"",data:m})).unwrap(),s.success("Fixture updated successfully")):(await r(si({exhibitionId:o,data:m})).unwrap(),s.success("Fixture created successfully")),await r(tn({exhibitionId:o})).unwrap(),P(!1)}catch(M){console.error("Failed to save fixture:",M),s.error(M.message||"Failed to save fixture")}},D=async m=>{try{const M=m.id||m._id;if(!M)throw new Error("Fixture ID is required");await r(ii({exhibitionId:o,id:M})).unwrap(),s.success("Fixture deleted successfully"),P(!1),v(null)}catch(M){console.error("Failed to delete fixture:",M),s.error(M.message||"Failed to delete fixture")}},f=m=>{_(m)};return e.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(Kx,{exhibitionId:o}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(X,{children:e.jsx("span",{children:"Fixture Management"})}),e.jsxs(X,{children:[e.jsx(ae,{style:{width:180},value:N,onChange:f,options:Xx}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:L,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[e.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),e.jsx("div",{ref:g,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:e.jsx(fn,{children:T.width>0&&T.height>0&&(a==null?void 0:a.dimensions)&&e.jsx(gn,{width:T.width,height:T.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:b,stalls:c,fixtures:d,selectedFixture:C,onSelectFixture:A,onFixtureChange:y,onAddFixture:L,isFixtureMode:!0})})})]}),e.jsx(Kp,{visible:x,fixture:C,onCancel:()=>P(!1),onSubmit:y,onDelete:D,exhibitionWidth:((I=a==null?void 0:a.dimensions)==null?void 0:I.width)||100,exhibitionHeight:((R=a==null?void 0:a.dimensions)==null?void 0:R.height)||100})]})},{Title:Zx,Text:em}=pe,{Option:ks}=ae,tm=()=>{const s=ke(),t=Ae(),{stalls:n,loading:i}=ue(E=>E.exhibition),[r,o]=h.useState([]),[a,u]=h.useState([]),[b,c]=h.useState(null),[S,g]=h.useState(null),[x,P]=h.useState(!1),C=De.useMemo(()=>Math.max(...n.map(E=>E.ratePerSqm*E.dimensions.width*E.dimensions.height),1e6),[n]),v=De.useMemo(()=>{const E=Math.pow(10,Math.floor(Math.log10(C)));return Math.ceil(C/E)*E},[C]),[T,j]=h.useState(""),[N,_]=h.useState(null),[d,p]=h.useState([0,v]),[L,A]=h.useState("number"),[y,D]=h.useState("ascend"),f=E=>{c(E),g(null),t({type:"exhibition/clearStalls"})},w=E=>{g(E),t(b&&E?$t({exhibitionId:b,hallId:E}):{type:"exhibition/clearStalls"})};h.useEffect(()=>{(async()=>{try{P(!0),console.log("Fetching exhibitions...");const l=await Re.getActiveExhibitions();console.log("Exhibitions response:",l.data),o(l.data)}catch(l){console.error("Failed to fetch exhibitions:",l)}finally{P(!1)}})()},[]),h.useEffect(()=>{b?(async()=>{try{P(!0),console.log("Fetching halls for exhibition:",b);const l=await Re.getHalls(b);console.log("Halls response:",l.data),u(l.data)}catch(l){console.error("Failed to fetch halls:",l)}finally{P(!1)}})():u([])},[b]);const I=De.useMemo(()=>{console.log("Filtering stalls from Redux:",n);const E=n.filter(l=>{const k=!T||l.number.toLowerCase().includes(T.toLowerCase()),F=!N||l.status===N,z=!S||l.hallId===S,U=l.ratePerSqm*l.dimensions.width*l.dimensions.height,V=U>=d[0]&&U<=d[1];return k&&F&&z&&V}).sort((l,k)=>L==="number"?y==="ascend"?l.number.localeCompare(k.number):k.number.localeCompare(l.number):0);return console.log("Filtered stalls:",E),E},[n,T,N,S,d,L,y]),R=E=>{switch(E){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},M=(E=>{const l=E.reduce((k,F)=>{var z,U;return(z=F==null?void 0:F.dimensions)!=null&&z.width&&((U=F==null?void 0:F.dimensions)!=null&&U.height)?k+F.dimensions.width*F.dimensions.height:k},0);return{totalStalls:E.length,totalSize:l}})(I);return e.jsx("div",{className:"dashboard-container",children:e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{span:24,children:e.jsxs(X,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx(Zx,{level:4,style:{margin:0},children:"Stalls"}),e.jsx(em,{type:"secondary",children:"Manage your exhibition stalls"})]})}),e.jsx(B,{span:24,children:e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(ae,{style:{width:"100%"},placeholder:"Select Exhibition",value:b,onChange:f,allowClear:!0,children:r.map(E=>e.jsx(ks,{value:E._id||E.id,children:E.name},E._id||E.id))})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(ae,{style:{width:"100%"},placeholder:"Select Hall",value:S,onChange:w,disabled:!b||a.length===0,allowClear:!0,children:a.map(E=>e.jsx(ks,{value:E._id||E.id,children:E.name},E._id||E.id))})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(G,{placeholder:"Search by stall number",prefix:e.jsx(us,{}),value:T,onChange:E=>j(E.target.value),allowClear:!0})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsxs(ae,{style:{width:"100%"},placeholder:"Filter by status",value:N,onChange:_,allowClear:!0,children:[e.jsx(ks,{value:"available",children:"Available"}),e.jsx(ks,{value:"booked",children:"Booked"}),e.jsx(ks,{value:"reserved",children:"Reserved"}),e.jsx(ks,{value:"sold",children:"Sold"})]})})]})}),e.jsx(B,{span:24,children:e.jsx(K,{size:"small",children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{xs:12,sm:12,md:6,children:e.jsx(be,{title:"Total Stalls",value:M.totalStalls,prefix:e.jsx(ic,{})})}),e.jsx(B,{xs:12,sm:12,md:6,children:e.jsx(be,{title:"Total Area",value:M.totalSize,suffix:"sqm",prefix:e.jsx(gs,{}),precision:2})})]})})}),e.jsx(B,{span:24,children:e.jsx(K,{size:"small",title:"Price Range Filter",children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:24,style:{marginBottom:16},children:e.jsxs(X,{children:[e.jsx(O,{size:"small",onClick:()=>p([0,5e5]),children:"Under 5L"}),e.jsx(O,{size:"small",onClick:()=>p([5e5,1e6]),children:"5L - 10L"}),e.jsx(O,{size:"small",onClick:()=>p([1e6,2e6]),children:"10L - 20L"}),e.jsx(O,{size:"small",onClick:()=>p([2e6,v]),children:"Above 20L"}),e.jsx(O,{size:"small",onClick:()=>p([0,v]),children:"All"})]})}),e.jsx(B,{span:16,children:e.jsx(ka,{range:!0,min:0,max:v,value:d,onChange:E=>p(E),step:Math.max(1e3,Math.floor(v/1e3)),tooltip:{formatter:E=>`${(E||0).toLocaleString()}`}})}),e.jsx(B,{span:4,children:e.jsx(Ue,{style:{width:"100%"},min:0,max:d[1],value:d[0],onChange:E=>p([E||0,d[1]]),formatter:E=>` ${E}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:E=>E?Number(E.replace(/[^\d.-]/g,"")):0,step:1e3})}),e.jsx(B,{span:4,children:e.jsx(Ue,{style:{width:"100%"},min:d[0],max:v,value:d[1],onChange:E=>p([d[0],E||v]),formatter:E=>` ${E}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:E=>E?Number(E.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),e.jsx(B,{span:24,children:e.jsx($e,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(E,l)=>E.number.localeCompare(l.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(E,l)=>{var k;return((k=l.stallType)==null?void 0:k.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:E=>E?`${E.toLocaleString()}`:"N/A",sorter:(E,l)=>(E.ratePerSqm||0)-(l.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(E,l)=>{var k,F;return(k=l==null?void 0:l.dimensions)!=null&&k.width&&((F=l==null?void 0:l.dimensions)!=null&&F.height)?`${l.dimensions.width*l.dimensions.height} sqm`:"N/A"},sorter:(E,l)=>{var z,U,V,H;const k=(((z=E.dimensions)==null?void 0:z.width)||0)*(((U=E.dimensions)==null?void 0:U.height)||0),F=(((V=l.dimensions)==null?void 0:V.width)||0)*(((H=l.dimensions)==null?void 0:H.height)||0);return k-F}},{title:"Dimensions",key:"dimensions",render:(E,l)=>{var k,F;return(k=l==null?void 0:l.dimensions)!=null&&k.width&&((F=l==null?void 0:l.dimensions)!=null&&F.height)?`${l.dimensions.width}m  ${l.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(E,l)=>{var k,F;return(k=l==null?void 0:l.dimensions)!=null&&k.width&&((F=l==null?void 0:l.dimensions)!=null&&F.height)&&l.ratePerSqm?`${(l.ratePerSqm*l.dimensions.width*l.dimensions.height).toLocaleString()}`:"N/A"},sorter:(E,l)=>{var z,U,V,H;const k=(E.ratePerSqm||0)*(((z=E.dimensions)==null?void 0:z.width)||0)*(((U=E.dimensions)==null?void 0:U.height)||0),F=(l.ratePerSqm||0)*(((V=l.dimensions)==null?void 0:V.width)||0)*(((H=l.dimensions)==null?void 0:H.height)||0);return k-F}},{title:"Status",dataIndex:"status",key:"status",render:E=>e.jsx(re,{color:R(E),style:{textTransform:"capitalize"},children:E||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(E,l)=>l.status===E},{title:"Actions",key:"actions",render:(E,l)=>e.jsxs(X,{children:[e.jsx("a",{onClick:()=>s(`/stall/edit/${l._id||l.id}`),children:"Edit"}),e.jsx("a",{onClick:()=>s(`/stall/view/${l._id||l.id}`),children:"View"})]})}],dataSource:I,rowKey:E=>E._id||E.id,loading:x||i,pagination:{total:I.length,pageSize:10,showSizeChanger:!0,showTotal:E=>`Total ${E} stalls`},onChange:(E,l,k)=>{k.field&&(A(k.field),D(k.order))}})})]})})})},{Title:sm,Text:nm}=pe,{TextArea:im}=G,{Search:rm}=G,{Option:pa}=ae,om=()=>{ke();const{message:s}=it.useApp(),[t,n]=h.useState(!1),[i]=$.useForm(),[r,o]=h.useState(!1),[a,u]=h.useState([]),[b,c]=h.useState(!1),[S,g]=h.useState(null);h.useEffect(()=>{x()},[]),h.useEffect(()=>{var N;if(console.log("Modal visibility changed:",t),console.log("Editing stall type:",S),t&&S){const _=((N=S.features)==null?void 0:N.map(d=>d.feature).join(", "))||"";console.log("Setting form values:",{name:S.name,description:S.description,features:_,status:S.status}),setTimeout(()=>{i.setFieldsValue({name:S.name,description:S.description,features:_,status:S.status})},0)}else t&&(i.resetFields(),i.setFieldsValue({status:"active"}))},[S,i,t]);const x=async()=>{try{c(!0);const N=await Ns.getStallTypes();u(N.data)}catch(N){s.error("Failed to fetch stall types: "+N.message)}finally{c(!1)}},P=async N=>{try{o(!0),console.log("Form values:",N);const _={name:N.name,description:N.description,status:N.status,features:N.features?N.features.split(",").map(d=>({feature:d.trim()})):[]};console.log("Submitting data:",_),S?(await Ns.updateStallType(S._id,_),s.success("Stall type updated successfully")):(await Ns.createStallType(_),s.success("Stall type created successfully")),n(!1),g(null),i.resetFields(),x()}catch(_){s.error(`Failed to ${S?"update":"create"} stall type: `+_.message)}finally{o(!1)}},C=N=>{console.log("Editing stall type:",N),g(N),n(!0)},v=async N=>{try{await Ns.deleteStallType(N._id),s.success("Stall type deleted successfully"),x()}catch(_){s.error("Failed to delete stall type: "+_.message)}},T=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(N,_)=>N.name.localeCompare(_.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:N=>e.jsx(X,{wrap:!0,children:N==null?void 0:N.map(({feature:_})=>e.jsx(re,{children:_},_))})},{title:"Status",dataIndex:"status",key:"status",render:N=>e.jsx(re,{color:N==="active"?"success":"default",children:N.toUpperCase()})},{title:"Actions",key:"actions",render:(N,_)=>e.jsxs(X,{children:[e.jsx(O,{type:"link",onClick:()=>C(_),children:"Edit"}),e.jsx(O,{type:"link",danger:!0,onClick:()=>v(_),children:"Delete"})]})}],j=()=>{n(!1),g(null),i.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{justify:"space-between",align:"middle",children:[e.jsx(B,{children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(sm,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(nm,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(B,{children:e.jsxs(X,{children:[e.jsx(rm,{placeholder:"Search stall types",style:{width:200},onSearch:N=>console.log(N)}),e.jsx(O,{type:"primary",icon:e.jsx(lt,{}),onClick:()=>n(!0),children:"Add Stall Type"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx($e,{columns:T,dataSource:a,rowKey:N=>N._id,loading:b})}),e.jsx(ge,{title:S?"Edit Stall Type":"Add Stall Type",open:t,onCancel:j,footer:null,destroyOnClose:!1,children:e.jsxs($,{form:i,layout:"vertical",onFinish:P,initialValues:{status:"active"},preserve:!0,children:[e.jsx($.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(G,{placeholder:"e.g., 1 Side Open"})}),e.jsx($.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(im,{rows:4,placeholder:"Enter description"})}),e.jsx($.Item,{name:"features",label:"Features",children:e.jsx(G,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx($.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(ae,{children:[e.jsx(pa,{value:"active",children:"Active"}),e.jsx(pa,{value:"inactive",children:"Inactive"})]})}),e.jsx($.Item,{children:e.jsxs(O,{type:"primary",htmlType:"submit",loading:r,block:!0,children:[S?"Update":"Create"," Stall Type"]})})]})})]})},am={bookings:[],currentBooking:null,loading:!1,error:null},ds=je("booking/fetchBookings",async()=>(await ne.get("/bookings")).data),ar=je("booking/fetchBooking",async s=>(await ne.get(`/bookings/${s}`)).data),ri=je("booking/createBooking",async s=>(await ne.post("/bookings",s)).data),oi=je("booking/updateStatus",async({id:s,status:t,rejectionReason:n})=>(await ne.patch(`/bookings/${s}`,{status:t,...n&&{rejectionReason:n}})).data),lr=je("booking/updatePaymentStatus",async({id:s,paymentStatus:t,paymentDetails:n})=>(await ne.patch(`/bookings/${s}/payment`,{paymentStatus:t,paymentDetails:n})).data),ai=je("booking/deleteBooking",async s=>(await ne.delete(`/bookings/${s}`),s)),vl=at({name:"booking",initialState:am,reducers:{clearCurrentBooking:s=>{s.currentBooking=null},clearBookingError:s=>{s.error=null}},extraReducers:s=>{s.addCase(ds.pending,t=>{t.loading=!0,t.error=null}).addCase(ds.fulfilled,(t,n)=>{t.loading=!1,t.bookings=n.payload}).addCase(ds.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to fetch bookings"}).addCase(ar.pending,t=>{t.loading=!0,t.error=null}).addCase(ar.fulfilled,(t,n)=>{t.loading=!1,t.currentBooking=n.payload}).addCase(ar.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to fetch booking"}).addCase(ri.pending,t=>{t.loading=!0,t.error=null}).addCase(ri.fulfilled,(t,n)=>{t.loading=!1,t.bookings.unshift(n.payload),t.currentBooking=n.payload}).addCase(ri.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to create booking"}).addCase(oi.pending,t=>{t.loading=!0,t.error=null}).addCase(oi.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.bookings[i]=n.payload),((r=t.currentBooking)==null?void 0:r._id)===n.payload._id&&(t.currentBooking=n.payload)}).addCase(oi.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to update booking status"}).addCase(lr.pending,t=>{t.loading=!0,t.error=null}).addCase(lr.fulfilled,(t,n)=>{var r;t.loading=!1;const i=t.bookings.findIndex(o=>o._id===n.payload._id);i!==-1&&(t.bookings[i]=n.payload),((r=t.currentBooking)==null?void 0:r._id)===n.payload._id&&(t.currentBooking=n.payload)}).addCase(lr.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to update payment status"}).addCase(ai.pending,t=>{t.loading=!0,t.error=null}).addCase(ai.fulfilled,(t,n)=>{var i;t.loading=!1,t.bookings=t.bookings.filter(r=>r._id!==n.payload),((i=t.currentBooking)==null?void 0:i._id)===n.payload&&(t.currentBooking=null)}).addCase(ai.rejected,(t,n)=>{t.loading=!1,t.error=n.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:mf,clearBookingError:ff}=vl.actions,lm=vl.reducer,cm="/api",li=Xr({reducerPath:"invoiceApi",baseQuery:Yr({baseUrl:cm,credentials:"include",prepareHeaders:s=>{const t=localStorage.getItem("token");return t&&s.set("authorization",`Bearer ${t}`),s.set("Content-Type","application/json"),s.set("Accept","application/json"),s}}),tagTypes:["Invoice"],endpoints:s=>({getInvoices:s.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:s.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,n,i)=>[{type:"Invoice",id:i}]}),downloadInvoice:s.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:n=>n.blob()})}),shareViaEmail:s.mutation({query:({id:t,...n})=>({url:`/invoices/${t}/share/email`,method:"POST",body:n})}),shareViaWhatsApp:s.mutation({query:({id:t,...n})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:n})})})}),{useGetInvoicesQuery:dm,useGetInvoiceQuery:um}=li,hm=({bookings:s})=>{const n={total:s.length,pending:s.filter(r=>r.status==="pending").length,approved:s.filter(r=>r.status==="approved").length,rejected:s.filter(r=>r.status==="rejected").length,confirmed:s.filter(r=>r.status==="confirmed").length,cancelled:s.filter(r=>r.status==="cancelled").length,totalRevenue:s.filter(r=>r.status==="confirmed"||r.status==="approved").reduce((r,o)=>r+o.amount,0),totalActiveBookings:s.filter(r=>r.status==="confirmed"||r.status==="approved").length,totalDeclinedBookings:s.filter(r=>r.status==="cancelled"||r.status==="rejected").length};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Total Bookings",value:n.total,prefix:e.jsx(Lr,{})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Pending Bookings",value:n.pending,prefix:e.jsx(Ze,{style:{color:"#faad14"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Approved Bookings",value:n.approved,prefix:e.jsx(_e,{style:{color:"#52c41a"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Confirmed Bookings",value:n.confirmed,prefix:e.jsx(_e,{style:{color:"#52c41a"}})})})})]}),e.jsxs(ie,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Rejected Bookings",value:n.rejected,prefix:e.jsx(Et,{style:{color:"#f5222d"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Cancelled Bookings",value:n.cancelled,prefix:e.jsx(Et,{style:{color:"#f5222d"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Total Revenue",value:n.totalRevenue,prefix:"",precision:2})})}),e.jsx(B,{xs:24,sm:12,md:6})]})]})},{RangePicker:pm}=hn,xm=({filters:s,exhibitions:t,onFilterChange:n,onRefresh:i})=>e.jsx(K,{style:{marginBottom:"24px"},children:e.jsxs(X,{wrap:!0,children:[e.jsx(G,{placeholder:"Search by company name",prefix:e.jsx(us,{}),value:s.search,onChange:r=>n({...s,search:r.target.value}),style:{width:200},allowClear:!0}),e.jsx(ae,{placeholder:"Filter by exhibition",value:s.exhibition,onChange:r=>n({...s,exhibition:r}),style:{minWidth:200},allowClear:!0,options:t.map(r=>({label:r.name,value:r._id}))}),e.jsx(ae,{mode:"multiple",placeholder:"Filter by status",value:s.status,onChange:r=>n({...s,status:r}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),e.jsx(pm,{onChange:r=>{var o,a;return n({...s,dateRange:r?[((o=r[0])==null?void 0:o.toISOString())||"",((a=r[1])==null?void 0:a.toISOString())||""]:null})}}),e.jsx(O,{icon:e.jsx(bi,{}),onClick:i,children:"Refresh"})]})}),{Title:mm,Text:Le}=pe,{RangePicker:gf}=hn,fm=()=>{const s=Ae(),{bookings:t,loading:n}=ue(E=>E.booking),{exhibitions:i}=ue(E=>E.exhibition),[r,o]=h.useState(null),[a,u]=h.useState(!1),[b,c]=h.useState({search:"",status:[],dateRange:null,exhibition:null}),S=ke(),{data:g,isLoading:x,error:P,refetch:C}=dm({page:1,limit:100}),[v,T]=h.useState(!1),[j,N]=h.useState("pending"),[_,d]=h.useState(""),[p,L]=h.useState(!1),{hasPermission:A}=Ei();h.useEffect(()=>{s(ds())},[s]),h.useEffect(()=>{s(Dt())},[s]),h.useEffect(()=>{t.length>0&&[...new Set(t.map(l=>l.exhibitionId._id))].forEach(l=>{s(vt(l))})},[t,s]);const y=async(E,l,k)=>{try{L(!0),await s(oi({id:E,status:l,...k&&{rejectionReason:k}})).unwrap(),ee.success(`Booking ${l} successfully`),s(ds()),l==="approved"&&setTimeout(async()=>{await C()},1e3),u(!1),T(!1),o(null)}catch{ee.error("Failed to update booking status")}finally{L(!1)}},D=async E=>{try{await s(ai(E)).unwrap(),ee.success("Booking deleted successfully"),s(ds())}catch(l){ee.error((l==null?void 0:l.message)||"Failed to delete booking")}},f=E=>{c(E)},w=t.filter(E=>{var l;if(b.search&&!((l=E.companyName)!=null&&l.toLowerCase().includes(b.search.toLowerCase()))||b.status.length>0&&!b.status.includes(E.status)||b.exhibition&&E.exhibitionId._id!==b.exhibition)return!1;if(b.dateRange){const[k,F]=b.dateRange,z=new Date(E.createdAt);if(z<new Date(k)||z>new Date(F))return!1}return!0}),I=(E,l)=>{const k=new Date(l).getFullYear(),F=t.find(q=>q._id===E);if(!F)return`--/${k}/--`;const V=(t.filter(q=>q.exhibitionId._id===F.exhibitionId._id).sort((q,Y)=>new Date(q.createdAt).getTime()-new Date(Y.createdAt).getTime()).findIndex(q=>q._id===E)+1).toString().padStart(2,"0"),H=i.find(q=>q._id===F.exhibitionId._id);return`${(H==null?void 0:H.invoicePrefix)||F.exhibitionId.invoicePrefix||"BK"}/${k}/${V}`},R=E=>{if(x)return console.log("Loading invoices..."),null;if(P)return console.error("Error loading invoices:",P),null;if(!g)return console.log("No invoices available"),null;const l=g.data||[];console.log("Looking for invoice with booking ID:",E);const k=l.find(F=>F.bookingId&&typeof F.bookingId=="object"&&F.bookingId._id===E);return console.log("Found invoice:",k),k==null?void 0:k._id},m=async E=>{if(x){ee.loading("Loading invoice data...");return}let l=R(E._id);if(l)S(`/invoice/${l}`);else{const k="invoice-loading";if(ee.loading({content:"Checking for invoice...",key:k}),await C(),l=R(E._id),l){ee.success({content:"Invoice found!",key:k,duration:1}),S(`/invoice/${l}`);return}const F=new Date(E.createdAt),z=new Date(Date.now()-30*60*1e3);if(F>z||E.status==="approved"){ee.info({content:"Invoice is still being generated. Checking again in a moment...",key:k});let V=0;const H=5,W=[2e3,3e3,5e3,8e3,1e4],q=async()=>{V++,await C();const Y=R(E._id);if(Y)ee.success({content:"Invoice is ready!",key:k,duration:1}),S(`/invoice/${Y}`);else if(V<H){const Z=W[V]||5e3,le=Z/1e3;ee.info({content:`Attempt ${V}/${H}: Invoice not ready yet. Trying again in ${le} seconds...`,key:k}),setTimeout(q,Z)}else ee.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:k})};setTimeout(q,W[0])}else ee.error({content:"No invoice found for this booking. Please contact support if this persists.",key:k})}},M=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(E,l)=>e.jsx(O,{type:"link",onClick:()=>{o(t.find(k=>k._id===E)||null),u(!0)},children:I(E,l.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(E,l)=>l.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:E=>E||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(E,l)=>l.stallIds.map(k=>k.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:E=>`${E.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(E,l)=>{const k=l.calculations.totalDiscountAmount;if(!k||k===0)return"-";const F=l.calculations.stalls.filter(U=>U.discount).map(U=>U.discount);if(F.length===0)return"-";const z=F[0];return e.jsx(Ve,{title:e.jsx("div",{children:F.map((U,V)=>e.jsxs("div",{children:[U==null?void 0:U.name,": ",(U==null?void 0:U.type)==="percentage"?`${U==null?void 0:U.value}%`:`${U==null?void 0:U.value}`,e.jsx("br",{}),"Amount: ",U==null?void 0:U.amount.toLocaleString()]},V))}),children:e.jsxs(re,{color:"red",children:["-",k.toLocaleString(),(z==null?void 0:z.type)==="percentage"&&` (${z.value}%)`,F.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:E=>`${E.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:E=>e.jsx(re,{color:E==="confirmed"?"success":E==="approved"?"blue":E==="pending"?"warning":E==="rejected"?"error":"default",children:E.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:E=>Ie(E).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(E,l)=>e.jsxs(X,{children:[e.jsx(Ve,{title:"View Details",children:e.jsx(O,{icon:e.jsx(Wt,{}),onClick:()=>{o(l),u(!0)}})}),e.jsx(ms,{overlay:e.jsxs(jt,{children:[l.status!=="cancelled"&&A("view_bookings")&&e.jsx(jt.Item,{icon:e.jsx(es,{}),disabled:x,onClick:()=>m(l),children:"View Invoice"},"invoice"),e.jsx(jt.Item,{icon:e.jsx(_e,{}),onClick:()=>{o(l),N(l.status),d(l.rejectionReason||""),T(!0)},children:"Update Status"},"updateStatus"),A("bookings_delete")&&e.jsx(jt.Item,{icon:e.jsx(nt,{}),danger:!0,onClick:()=>{ge.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>D(l._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(O,{icon:e.jsx($r,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(B,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(mm,{level:4,style:{margin:0},children:"Stall Bookings"}),e.jsx(Le,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),e.jsx(B,{children:e.jsx(O,{type:"primary",size:"large",icon:e.jsx(lt,{}),onClick:()=>S("/bookings/create"),children:"Create Booking"})})]})}),e.jsx(hm,{bookings:t}),e.jsx(xm,{filters:b,exhibitions:i,onFilterChange:f,onRefresh:()=>s(ds())}),e.jsx(K,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:e.jsx($e,{columns:M,dataSource:w,loading:n,rowKey:"_id",scroll:{x:1500},pagination:{total:w.length,pageSize:10,showSizeChanger:!0,showTotal:E=>`Total ${E} items`,position:["bottomRight"]}})}),e.jsx(ge,{title:"Booking Details",open:a,onCancel:()=>{u(!1),o(null)},footer:[e.jsx(O,{type:"primary",disabled:!r,onClick:()=>{r&&(N(r.status),d(r.rejectionReason||""),T(!0))},children:"Update Status"},"updateStatus"),e.jsx(O,{onClick:()=>{u(!1),o(null)},children:"Close"},"close")],width:800,children:r&&e.jsxs(X,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(me,{bordered:!0,column:2,children:[e.jsxs(me.Item,{label:"Booking Number",span:2,children:[I(r._id,r.createdAt),e.jsxs(Le,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",r._id,")"]})]}),e.jsx(me.Item,{label:"Exhibition",span:2,children:r.exhibitionId.name}),e.jsxs(me.Item,{label:"Status",span:2,children:[e.jsx(re,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()}),r.rejectionReason&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Le,{type:"secondary",children:"Rejection Reason:"}),e.jsx("br",{}),e.jsx(Le,{children:r.rejectionReason})]})]}),e.jsx(me.Item,{label:"Customer Name",children:r.customerName}),e.jsx(me.Item,{label:"Customer Email",children:r.customerEmail}),e.jsx(me.Item,{label:"Customer Phone",children:r.customerPhone}),e.jsx(me.Item,{label:"Company Name",children:r.companyName})]}),e.jsx(K,{title:"Stall Details",size:"small",children:e.jsx($e,{dataSource:r.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:E=>e.jsxs(re,{color:"blue",children:[E.dimensions.width,"x",E.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:E=>`${E.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:E=>{const l=r.calculations.stalls.find(k=>k.stallId===E._id);return l?`${l.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:E=>{const l=r.calculations.stalls.find(k=>k.stallId===E._id);return l!=null&&l.discount?e.jsxs(re,{color:"red",children:["-",l.discount.amount.toLocaleString(),l.discount.type==="percentage"&&` (${l.discount.value}%)`]}):"-"}}]})}),e.jsx(K,{title:"Financial Summary",size:"small",children:e.jsxs(X,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Le,{children:"Total Base Amount:"}),e.jsxs(Le,{children:["",r.calculations.totalBaseAmount.toLocaleString()]})]}),r.calculations.totalDiscountAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Le,{children:"Total Discount:"}),e.jsxs(Le,{type:"danger",children:["-",r.calculations.totalDiscountAmount.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Le,{children:"Amount after Discount:"}),e.jsxs(Le,{children:["",r.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),e.jsx(Ee,{style:{margin:"8px 0"}}),r.calculations.taxes.map(E=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Le,{children:[E.name," (",E.rate,"%):"]}),e.jsxs(Le,{children:["",E.amount.toLocaleString()]})]},E.name)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Le,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Le,{strong:!0,children:["",r.amount.toLocaleString()]})]})]})})]})}),e.jsx(ge,{title:"Update Booking Status",open:v,onCancel:()=>{T(!1),d("")},footer:null,width:600,children:r&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(es,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(B,{span:8,children:e.jsx(Le,{strong:!0,children:"Booking Number:"})}),e.jsx(B,{span:16,children:e.jsx(Le,{children:I(r._id,r.createdAt)})}),e.jsx(B,{span:8,children:e.jsx(Le,{strong:!0,children:"Company:"})}),e.jsx(B,{span:16,children:e.jsx(Le,{children:r.companyName})}),e.jsx(B,{span:8,children:e.jsx(Le,{strong:!0,children:"Exhibition:"})}),e.jsx(B,{span:16,children:e.jsx(Le,{children:r.exhibitionId.name})}),e.jsx(B,{span:8,children:e.jsx(Le,{strong:!0,children:"Current Status:"})}),e.jsx(B,{span:16,children:e.jsx(re,{color:r.status==="confirmed"?"success":r.status==="approved"?"blue":r.status==="pending"?"warning":r.status==="rejected"?"error":"default",children:r.status.toUpperCase()})})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx($s,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Le,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(_t.Group,{value:j,onChange:E=>N(E.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[e.jsx(_t.Button,{value:"pending",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(Ze,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(_t.Button,{value:"approved",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(_e,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(_t.Button,{value:"rejected",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(Et,{style:{color:"#f5222d"}}),"Rejected"]})}),e.jsx(_t.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(_e,{style:{color:"#1890ff"}}),"Confirmed"]})}),e.jsx(_t.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:e.jsxs(X,{children:[e.jsx(Et,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),j==="rejected"&&e.jsx("div",{children:e.jsx($.Item,{label:e.jsx(Le,{strong:!0,children:"Rejection Reason:"}),required:j==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:e.jsx(G.TextArea,{rows:4,value:_,onChange:E=>d(E.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),j==="approved"&&e.jsx(qe,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),j==="confirmed"&&e.jsx(qe,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),j==="cancelled"&&e.jsx(qe,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),j==="pending"&&e.jsx(qe,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(O,{onClick:()=>{T(!1),d("")},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:()=>{if(j==="rejected"&&!_.trim()){ee.error("Rejection reason is required when rejecting a booking");return}y(r._id,j,j==="rejected"?_:void 0)},loading:p,disabled:j==="rejected"&&!_.trim(),children:"Update Status"})]})]})]})})]})},gm={exhibitors:[],loading:!1,error:null},Lt=je("exhibitors/fetchAll",async(s,{rejectWithValue:t})=>{var n,i;try{return(await st.getExhibitors()).data}catch(r){return t(((i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to fetch exhibitors")}}),ym=at({name:"exhibitor",initialState:gm,reducers:{},extraReducers:s=>{s.addCase(Lt.pending,t=>{t.loading=!0,t.error=null}).addCase(Lt.fulfilled,(t,n)=>{t.exhibitors=n.payload,t.loading=!1}).addCase(Lt.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),bm=ym.reducer,{Title:jm,Text:Nt}=pe,vm=()=>{var E;const[s]=$.useForm(),[t]=$.useForm(),[n,i]=h.useState(!1),[r,o]=h.useState([]),[a,u]=h.useState(!1),[b,c]=h.useState([]),[S,g]=h.useState(null),[x,P]=h.useState(),C=ke(),v=Ae(),{loading:T}=ue(l=>l.booking),{exhibitions:j=[],loading:N}=ue(l=>l.exhibition),{exhibitors:_=[],loading:d}=ue(l=>l.exhibitor),{isAuthenticated:p}=ue(l=>l.auth);h.useEffect(()=>{if(!p){ee.error("Please login to create a booking"),C("/login");return}v(Dt()),v(Lt())},[v,p,C]);const L=async l=>{try{u(!0),s.setFieldValue("stallIds",[]),s.setFieldValue("discountId",void 0),c([]);const k=await Re.getExhibition(l);g(k.data);const z=(await Re.getStalls(l)).data.filter(U=>U.status==="available");o(z)}catch(k){console.error("Failed to fetch exhibition data:",k),ee.error("Failed to fetch exhibition data")}finally{u(!1)}},A=l=>Math.round(l.ratePerSqm*l.dimensions.width*l.dimensions.height*100)/100,y=l=>{const k=r.filter(F=>{const z=F._id||F.id;return z&&l.includes(z)});c(k)},D=(l,k,F)=>{if(!(F!=null&&F.isActive))return 0;let z=0;if(F.type==="percentage")z=l*(Math.max(0,Math.min(100,F.value))/100);else{const U=l/k*F.value;z=Math.min(U,l)}return Math.round(z*100)/100},f=async l=>{var k,F;try{const z=_.find(se=>se._id===l.exhibitorId);if(!z)throw new Error("Selected exhibitor not found");const[U,V,H]=l.discountId?l.discountId.split("-"):[],W=(k=S==null?void 0:S.discountConfig)==null?void 0:k.find(se=>`${se.name}-${se.value}-${se.type}`===l.discountId),q=b.map(se=>{const he=se._id||se.id;if(!he)throw new Error(`Invalid stall ID for stall number ${se.number}`);return{stall:se,stallId:he,baseAmount:A(se)}}),Y=q.reduce((se,{baseAmount:he})=>se+he,0),Z=q.map(({stall:se,stallId:he,baseAmount:Ne})=>{const Be=W?D(Ne,Y,W):0;return{stallId:he,number:se.number,baseAmount:Ne,discount:W?{name:W.name,type:W.type,value:W.value,amount:Be}:void 0,amountAfterDiscount:Math.round((Ne-Be)*100)/100}}),le=Z.reduce((se,he)=>{var Ne;return se+(((Ne=he.discount)==null?void 0:Ne.amount)||0)},0),ve=Math.round((Y-le)*100)/100,ce=((F=S==null?void 0:S.taxConfig)==null?void 0:F.filter(se=>se.isActive).map(se=>({name:se.name,rate:se.rate,amount:Math.round(ve*se.rate/100*100)/100})))||[],te=ce.reduce((se,he)=>se+he.amount,0),de=Math.round((ve+te)*100)/100,Pe={exhibitionId:l.exhibitionId,exhibitorId:l.exhibitorId,stallIds:Z.map(se=>se.stallId),customerName:z.contactPerson,customerEmail:z.email,customerPhone:z.phone,customerAddress:z.address||"N/A",customerGSTIN:z.gstNumber||"N/A",customerPAN:z.panNumber||"N/A",companyName:z.companyName,discount:W?{name:W.name,type:W.type,value:W.value}:void 0,amount:de,calculations:{stalls:Z,totalBaseAmount:Y,totalDiscountAmount:le,totalAmountAfterDiscount:ve,taxes:ce,totalTaxAmount:te,totalAmount:de}},Q=await v(ri(Pe)).unwrap();Q&&Q.invoiceId?(ee.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{C(`/invoice/${Q.invoiceId}`)},2e3)):(ee.success("Booking created successfully"),C("/bookings")),Q&&Q.warning&&ee.warning(Q.warning)}catch(z){console.error("Error creating booking:",z),ee.error("Failed to create booking")}},w=async l=>{try{const k=await st.createExhibitor(l);ee.success("Exhibitor added successfully"),v(Lt()),s.setFieldsValue({exhibitorId:k.data._id}),i(!1),t.resetFields()}catch(k){const F=(k==null?void 0:k.message)||"Failed to add exhibitor";ee.error(F),F==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},I=j.map(l=>({label:l.name,value:l._id||l.id})),R=_.map(l=>({label:l.companyName,value:l._id}));r.map(l=>({label:`Stall ${l.number} (${l.dimensions.width}m  ${l.dimensions.height}m = ${(l.dimensions.width*l.dimensions.height).toFixed(2)} sqm) - ${l.ratePerSqm.toLocaleString()}/sq.m`,value:l._id||l.id}));const m=l=>{P(l),s.setFieldValue("discountId",l)},M=()=>{var W,q;const l=b.reduce((Y,Z)=>Y+A(Z),0),k=(W=S==null?void 0:S.discountConfig)==null?void 0:W.find(Y=>`${Y.name}-${Y.value}-${Y.type}`===x&&Y.isActive),F=k?k.type==="percentage"?Math.round(l*k.value/100*100)/100:Math.min(k.value,l):0,z=Math.round((l-F)*100)/100,U=((q=S==null?void 0:S.taxConfig)==null?void 0:q.filter(Y=>Y.isActive).map(Y=>({name:Y.name,rate:Y.rate,amount:Math.round(z*Y.rate/100*100)/100})))||[],V=U.reduce((Y,Z)=>Y+Z.amount,0),H=Math.round((z+V)*100)/100;return{baseAmount:l,selectedDiscount:k,discountAmount:F,amountAfterDiscount:z,taxes:U,totalTaxAmount:V,totalAmount:H}};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{span:24,children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(jm,{level:2,style:{margin:0},children:"Create Booking"}),e.jsx(pe.Text,{type:"secondary",children:"Create a new stall booking"})]})}),e.jsx(B,{span:24,children:e.jsx(K,{children:e.jsx($,{form:s,layout:"vertical",onFinish:f,style:{maxWidth:800},children:e.jsxs(ie,{gutter:16,children:[e.jsx(B,{span:12,children:e.jsx($.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:e.jsx(ae,{placeholder:"Select exhibition",loading:N,options:I,onChange:L})})}),e.jsx(B,{span:12,children:e.jsx($.Item,{name:"exhibitorId",label:e.jsxs(X,{children:[e.jsx("span",{children:"Exhibitor"}),e.jsx(O,{type:"link",icon:e.jsx(lt,{}),onClick:()=>i(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:e.jsx(ae,{showSearch:!0,placeholder:"Select exhibitor",loading:d,options:R,filterOption:(l,k)=>{var F;return(((F=k==null?void 0:k.label)==null?void 0:F.toString())??"").toLowerCase().includes(l.toLowerCase())}})})}),e.jsx(B,{span:24,children:e.jsx($.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:e.jsx(ae,{mode:"multiple",placeholder:a?"Loading stalls...":"Select stalls",loading:a,onChange:y,options:r.map(l=>({label:`Stall ${l.number} (${l.dimensions.width}m  ${l.dimensions.height}m = ${(l.dimensions.width*l.dimensions.height).toFixed(2)} sqm) - ${l.ratePerSqm.toLocaleString()}/sq.m`,value:l._id||l.id}))})})}),b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(B,{span:24,children:e.jsx(K,{title:"Selected Stalls Summary",size:"small",children:e.jsx($e,{dataSource:b.map(l=>({...l,key:l._id||l.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(l,k)=>{var F,z;return((F=k.stallType)==null?void 0:F.name)||(typeof k.stallTypeId=="object"?(z=k.stallTypeId)==null?void 0:z.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(l,k)=>`${k.dimensions.width}m  ${k.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(l,k)=>(k.dimensions.width*k.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:l=>`${l.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(l,k)=>`${A(k).toLocaleString()}`}],summary:()=>{const l=b.reduce((k,F)=>k+A(F),0);return e.jsxs($e.Summary.Row,{children:[e.jsx($e.Summary.Cell,{index:0,colSpan:5,children:e.jsx("strong",{children:"Total Base Amount"})}),e.jsx($e.Summary.Cell,{index:1,children:e.jsxs("strong",{children:["",l.toLocaleString()]})})]},"summary")}})})}),e.jsx(B,{span:24,children:e.jsxs(K,{title:"Price Calculations",size:"small",children:[e.jsx(ie,{gutter:[16,16],children:e.jsx(B,{span:12,children:e.jsx($.Item,{name:"discountId",label:"Available Discounts",children:e.jsx(ae,{placeholder:"Select discount",allowClear:!0,onChange:m,options:(E=S==null?void 0:S.discountConfig)==null?void 0:E.map(l=>({label:`${l.name} (${l.type==="percentage"?l.value+"%":""+l.value})${l.isActive?"":" - Inactive"}`,value:`${l.name}-${l.value}-${l.type}`,disabled:!l.isActive}))})})})}),e.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:e.jsx(X,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:l,selectedDiscount:k,discountAmount:F,amountAfterDiscount:z,taxes:U,totalAmount:V}=M();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Nt,{children:"Total Base Amount:"}),e.jsxs(Nt,{children:["",l.toLocaleString()]})]}),k&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Nt,{children:["Discount (",k.type==="percentage"?`${k.value}%`:`${k.value.toLocaleString()}`,"):"]}),e.jsxs(Nt,{type:"danger",children:["-",F.toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Nt,{children:"Amount after Discount:"}),e.jsxs(Nt,{children:["",z.toLocaleString()]})]}),e.jsx(Ee,{style:{margin:"8px 0"}}),U.map(H=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(Nt,{children:[H.name," (",H.rate,"%):"]}),e.jsxs(Nt,{children:["",H.amount.toLocaleString()]})]},`tax-${H.name}`)),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(Nt,{strong:!0,children:"Total Amount (incl. Taxes):"}),e.jsxs(Nt,{strong:!0,children:["",V.toLocaleString()]})]})]})})()})})]})})]}),e.jsx(B,{span:24,children:e.jsx($.Item,{children:e.jsxs(X,{children:[e.jsx(O,{type:"primary",htmlType:"submit",loading:T,children:"Create Booking"}),e.jsx(O,{onClick:()=>C("/bookings"),children:"Cancel"})]})})})]})})})})]}),e.jsx(ge,{title:e.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:n,onCancel:()=>{i(!1),t.resetFields()},width:800,footer:e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[e.jsx(O,{onClick:()=>{i(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),e.jsx(O,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:e.jsx($,{form:t,layout:"vertical",onFinish:w,requiredMark:!1,children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),e.jsx($.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(G.TextArea,{rows:3})}),e.jsx($.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"status",label:"Status",initialValue:"active",children:e.jsxs(ae,{children:[e.jsx(ae.Option,{value:"active",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),e.jsx(ae.Option,{value:"inactive",children:e.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),e.jsx($.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:e.jsx(G,{placeholder:"ABCDE1234F"})}),e.jsx($.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:e.jsx(G,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})};ga.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${fa}/pdf.worker.min.js`;const wm=()=>{const{id:s}=ft(),t=ke(),{data:n,isLoading:i}=um(s||""),[r,o]=h.useState(!1),[a,u]=h.useState(!1),[b,c]=h.useState(!1),[S,g]=h.useState(null),[x,P]=h.useState(null),[C]=$.useForm(),v=async()=>{try{const d=await co(`/invoices/${s}/download?force=true`),p=window.URL.createObjectURL(new Blob([d.data]));g(p),c(!0)}catch(d){console.error("Preview error:",d),ee.error("Failed to preview invoice")}},T=async()=>{try{const d=await co(`/invoices/${s}/download?force=true`),p=window.URL.createObjectURL(new Blob([d.data])),L=document.createElement("a");L.href=p,L.setAttribute("download",`invoice-${s}.pdf`),document.body.appendChild(L),L.click(),L.remove(),window.URL.revokeObjectURL(p)}catch(d){console.error("Download error:",d),ee.error("Failed to download invoice")}},j=async d=>{try{await ne.post(`/invoices/${s}/share/email`,d),ee.success("Invoice shared via email successfully"),o(!1),C.resetFields()}catch(p){console.error("Email sharing error:",p),ee.error("Failed to share invoice via email")}},N=async d=>{try{await ne.post(`/invoices/${s}/share/whatsapp`,d),ee.success("Invoice shared via WhatsApp successfully"),u(!1),C.resetFields()}catch(p){console.error("WhatsApp sharing error:",p),ee.error("Failed to share invoice via WhatsApp")}},_=({numPages:d})=>{P(d)};return i||!n?e.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",n),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(K,{title:"Invoice Details",extra:e.jsxs(X,{children:[e.jsx(O,{icon:e.jsx(ts,{}),onClick:()=>t(-1),children:"Back"}),e.jsx(O,{icon:e.jsx(Wt,{}),onClick:v,children:"Preview"}),e.jsx(O,{type:"primary",icon:e.jsx(wa,{}),onClick:T,children:"Download"}),e.jsx(O,{icon:e.jsx(Yt,{}),onClick:()=>o(!0),children:"Share via Email"}),e.jsx(O,{icon:e.jsx(Sa,{}),onClick:()=>u(!0),children:"Share via WhatsApp"})]}),children:e.jsx(pl,{booking:{...n.bookingId,customerGSTIN:n.bookingId.customerGSTIN||"",invoiceNumber:n.invoiceNumber,exhibitionId:{...n.bookingId.exhibitionId,companyName:n.bookingId.exhibitionId.companyName||"Company Name",bankName:n.bookingId.exhibitionId.bankName||"",bankAccount:n.bookingId.exhibitionId.bankAccount||"",bankAccountName:n.bookingId.exhibitionId.bankAccountName||"",bankBranch:n.bookingId.exhibitionId.bankBranch||"",bankIFSC:n.bookingId.exhibitionId.bankIFSC||"",companyCIN:n.bookingId.exhibitionId.companyCIN||"",companyPAN:n.bookingId.exhibitionId.companyPAN||"",companySAC:n.bookingId.exhibitionId.companySAC||"",companyGST:n.bookingId.exhibitionId.companyGST||"",companyEmail:n.bookingId.exhibitionId.companyEmail||"",companyWebsite:n.bookingId.exhibitionId.companyWebsite||"",companyAddress:n.bookingId.exhibitionId.companyAddress||""},calculations:{...n.bookingId.calculations,stalls:n.bookingId.calculations.stalls.map(d=>({discount:d.discount?{...d.discount,type:d.discount.type||"percentage",value:d.discount.value}:void 0}))}}})}),e.jsx(ge,{title:"Preview Invoice",open:b,onCancel:()=>{c(!1),S&&(window.URL.revokeObjectURL(S),g(null))},width:1e3,footer:null,children:S&&e.jsx("div",{style:{height:"80vh",overflow:"auto"},children:e.jsx(ya,{file:S,onLoadSuccess:_,loading:e.jsx("div",{children:"Loading PDF..."}),children:Array.from(new Array(x||0),(d,p)=>e.jsx(ba,{pageNumber:p+1,width:900,renderTextLayer:!1,renderAnnotationLayer:!1},`page_${p+1}`))})})}),e.jsx(ge,{title:"Share Invoice via Email",open:r,onCancel:()=>o(!1),footer:null,children:e.jsxs($,{form:C,onFinish:j,layout:"vertical",children:[e.jsx($.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(G,{placeholder:"Enter email address"})}),e.jsx($.Item,{name:"message",label:"Message (Optional)",children:e.jsx(G.TextArea,{placeholder:"Enter optional message"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(ge,{title:"Share Invoice via WhatsApp",open:a,onCancel:()=>u(!1),footer:null,children:e.jsxs($,{form:C,onFinish:N,layout:"vertical",children:[e.jsx($.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:e.jsx(G,{placeholder:"Enter phone number with country code"})}),e.jsx($.Item,{children:e.jsx(O,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:Ke,Paragraph:Ge,Text:Fn}=pe,{Content:Sm}=Fe,km=s=>{if(!s)return"/exhibition-placeholder.jpg";if(s.startsWith("/")||s.startsWith("http"))return s;const t=s.startsWith("/")?s.substring(1):s;return t.includes("logos/")||t.includes("sponsors/")?`${ne.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},Cm=J(Sm)`
  padding-top: 64px;
`,Im=J.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,Em=J.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Am=J.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Cs=J(K)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Nm=J(K)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Qs=J(Ke)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Is=J.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,Bn=J.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,xa=J.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,Tm=J(re)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,cr=J(O)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,Gs=J.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;J.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const Pm=()=>{const s=ke(),t=Ae(),[n,i]=h.useState([]),[r,o]=h.useState(!0);h.useEffect(()=>{(async()=>{try{o(!0);const S=await xt.getExhibitions();i(S.data.slice(0,4))}catch(S){console.error("Failed to fetch exhibitions:",S)}finally{o(!1)}})()},[]);const a=c=>{const S={year:"numeric",month:"short",day:"numeric"};return new Date(c).toLocaleDateString(void 0,S)},u=(c,S)=>{const g=new Date,x=new Date(c),P=new Date(S);return g<x?{status:"Upcoming",color:"#722ED1"}:g>P?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},b=()=>{t(xs(void 0))};return e.jsxs(Fe,{children:[e.jsx(It,{}),e.jsxs(Cm,{children:[e.jsxs(Im,{children:[e.jsx(Em,{}),e.jsx(Am,{children:e.jsxs(ie,{gutter:[48,48],align:"middle",children:[e.jsxs(B,{xs:24,lg:14,children:[e.jsx(Ke,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),e.jsx(Ge,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),e.jsxs(X,{size:16,wrap:!0,children:[e.jsx(cr,{type:"primary",size:"large",onClick:()=>s("/exhibitions"),icon:e.jsx(pr,{}),children:"Explore Exhibitions"}),e.jsx(cr,{className:"secondary-btn",size:"large",onClick:()=>s("/exhibitor/login"),icon:e.jsx(Ce,{}),children:"Exhibitor Portal"})]})]}),e.jsx(B,{xs:24,lg:10,children:e.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:c=>{const S=c.target;S.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",S.onerror=()=>{S.style.height="300px",S.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",S.onerror=null;const g=S.parentElement;if(g){const x=document.createElement("div");x.style.position="absolute",x.style.top="50%",x.style.left="50%",x.style.transform="translate(-50%, -50%)",x.style.color="white",x.style.fontSize="18px",x.style.fontWeight="bold",x.style.textAlign="center",x.textContent="Exhibition Venue",g.appendChild(x)}}}})})]})})]}),e.jsx(Gs,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Qs,{level:2,children:"Featured Exhibitions"}),r?e.jsx(ie,{gutter:[24,24],children:[1,2,3,4].map(c=>e.jsx(B,{xs:24,sm:12,lg:6,children:e.jsx(K,{style:{borderRadius:"12px"},children:e.jsx(Rt,{active:!0,avatar:!0,paragraph:{rows:3}})})},c))}):n.length>0?e.jsx(ie,{gutter:[24,24],children:n.map((c,S)=>{const{status:g,color:x}=u(c.startDate,c.endDate);return e.jsx(B,{xs:24,sm:12,lg:6,children:e.jsxs(Nm,{onClick:()=>s(Ai(c)),cover:e.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[e.jsx("img",{alt:c.name,src:c.headerLogo?km(c.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"cover",filter:"brightness(0.95)"}}),e.jsx(re,{color:x,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:g}),S===0&&e.jsx(Tm,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[e.jsx(Ke,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:c.name}),e.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[e.jsx(Ct,{style:{color:"#4158D0"}}),e.jsxs(Fn,{type:"secondary",style:{fontSize:13},children:[a(c.startDate)," - ",a(c.endDate)]})]}),c.venue&&e.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[e.jsx(hs,{style:{color:"#C850C0"}}),e.jsx(Fn,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:c.venue})]}),e.jsx(O,{type:"link",style:{padding:0,height:"auto"},icon:e.jsx(pr,{}),children:"View Details"})]})},c._id)})}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(Ge,{children:"No exhibitions available at the moment. Check back soon!"})}),e.jsx("div",{style:{textAlign:"center",marginTop:40},children:e.jsx(O,{type:"primary",size:"large",onClick:()=>s("/exhibitions"),icon:e.jsx(rc,{}),children:"View All Exhibitions"})})]})}),e.jsx(Gs,{className:"how-it-works",children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Qs,{level:2,children:"How to Book Stall"}),e.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:e.jsx(Ge,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),e.jsxs("div",{className:"booking-steps",children:[e.jsx("div",{className:"step-indicator",children:e.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(c=>e.jsxs("div",{className:"step-dot-container",children:[e.jsx("div",{className:"step-dot",children:c}),e.jsx("div",{className:"step-label",children:`Step ${c}`})]},c)),e.jsx("div",{className:"step-progress-line"})]})}),e.jsxs(ie,{gutter:[24,24],style:{marginTop:40},children:[e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"1"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ce,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Register"}),e.jsx(Ge,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"2"}),e.jsx("div",{className:"step-icon",children:e.jsx(_e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Admin Approval"}),e.jsx(Ge,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsx("div",{className:"step-icon",children:e.jsx(ct,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Login & Book Stall"}),e.jsx(Ge,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"4"}),e.jsx("div",{className:"step-icon",children:e.jsx(Ze,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Stall Goes to Reserved"}),e.jsx(Ge,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"5"}),e.jsx("div",{className:"step-icon",children:e.jsx(_e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Admin Final Approval"}),e.jsx(Ge,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"6"}),e.jsx("div",{className:"step-icon",children:e.jsx(_e,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Stall Becomes Booked"}),e.jsx(Ge,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),e.jsx(B,{xs:24,md:12,lg:8,xl:6,children:e.jsxs("div",{className:"step-card",children:[e.jsxs("div",{className:"step-card-header",children:[e.jsx("div",{className:"step-number",children:"7"}),e.jsx("div",{className:"step-icon",children:e.jsx(io,{})})]}),e.jsxs("div",{className:"step-card-body",children:[e.jsx(Ke,{level:5,children:"Make Payment in 3 Days"}),e.jsx(Ge,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),e.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),e.jsx("div",{style:{textAlign:"center",marginTop:60},children:e.jsx(cr,{type:"primary",size:"large",onClick:b,icon:e.jsx(Ce,{}),children:"Register as Exhibitor"})})]})}),e.jsx(Gs,{children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[e.jsx(Qs,{level:2,children:"Why Choose Us"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:e.jsx(gs,{})}),e.jsx(Ke,{level:4,children:"Interactive Layouts"}),e.jsx(Ge,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:e.jsx(ct,{})}),e.jsx(Ke,{level:4,children:"Real-time Availability"}),e.jsx(Ge,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:e.jsx(io,{})}),e.jsx(Ke,{level:4,children:"Secure Payments"}),e.jsx(Ge,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:e.jsx(Tr,{})}),e.jsx(Ke,{level:4,children:"Exhibitor Dashboard"}),e.jsx(Ge,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:e.jsx(Ct,{})}),e.jsx(Ke,{level:4,children:"Schedule Management"}),e.jsx(Ge,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),e.jsx(B,{xs:24,sm:12,lg:8,children:e.jsxs(Cs,{children:[e.jsx(Is,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:e.jsx(_e,{})}),e.jsx(Ke,{level:4,children:"Support & Assistance"}),e.jsx(Ge,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),e.jsx(Gs,{className:"gray-bg",children:e.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:e.jsxs(ie,{gutter:[48,48],children:[e.jsxs(B,{xs:24,lg:12,children:[e.jsx(Qs,{level:2,children:"Our Impact"}),e.jsxs(ie,{gutter:[24,24],children:[e.jsx(B,{xs:12,children:e.jsx(Bn,{children:e.jsx(be,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),e.jsx(B,{xs:12,children:e.jsx(Bn,{children:e.jsx(be,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),e.jsx(B,{xs:12,children:e.jsx(Bn,{children:e.jsx(be,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),e.jsx(B,{xs:12,children:e.jsx(Bn,{children:e.jsx(be,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),e.jsxs(B,{xs:24,lg:12,children:[e.jsx(Qs,{level:2,children:"What Exhibitors Say"}),e.jsxs(oc,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[e.jsx("div",{children:e.jsxs(xa,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Ce,{}),style:{backgroundColor:"#4158D0"}}),e.jsxs("div",{children:[e.jsx(Ke,{level:5,style:{margin:0},children:"Sarah Johnson"}),e.jsx(Fn,{type:"secondary",children:"Tech Innovations Inc."})]})]}),e.jsx(Ge,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),e.jsx("div",{children:e.jsxs(xa,{children:[e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsx(wt,{size:64,icon:e.jsx(Ce,{}),style:{backgroundColor:"#C850C0"}}),e.jsxs("div",{children:[e.jsx(Ke,{level:5,style:{margin:0},children:"Michael Chen"}),e.jsx(Fn,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),e.jsx(Ge,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),e.jsx(Gs,{style:{padding:"60px 0"},children:e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Ke,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),e.jsx(Ge,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),e.jsxs(X,{size:16,wrap:!0,style:{justifyContent:"center"},children:[e.jsx(O,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>s("/exhibitions"),icon:e.jsx(ct,{}),children:"Browse Exhibitions"}),e.jsx(O,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:b,icon:e.jsx(Ce,{}),children:"Register as Exhibitor"})]})]})})]}),e.jsx(jl,{})]})},{Title:Rm,Text:Se,Paragraph:_m}=pe,{Option:Mn}=ae,{TextArea:ma,Search:Dm}=G,{RangePicker:Lm}=hn,$m=()=>{const s=Ae(),{exhibitors:t,loading:n}=ue(q=>q.exhibitor),[i,r]=h.useState(null),[o,a]=h.useState(!1),[u,b]=h.useState(!1),[c,S]=h.useState(!1),[g,x]=h.useState("approved"),[P,C]=h.useState(""),[v,T]=h.useState(!1),[j,N]=h.useState(!1),[_,d]=h.useState(!1),[p,L]=h.useState(""),[A,y]=h.useState([]),[D]=$.useForm(),[f,w]=h.useState([]);f.length>0;const[I,R]=h.useState({total:0,pending:0,approved:0,rejected:0});h.useEffect(()=>{s(Lt())},[s]),h.useEffect(()=>{if(t!=null&&t.length){y(t);const q={total:t.length,pending:t.filter(Y=>Y.status==="pending").length,approved:t.filter(Y=>Y.status==="approved").length,rejected:t.filter(Y=>Y.status==="rejected").length};R(q)}},[t]),h.useEffect(()=>{i&&u&&D.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,u,D]);const m=q=>{switch(q){case"approved":return e.jsx(re,{color:"success",children:"Approved"});case"pending":return e.jsx(re,{color:"warning",children:"Pending"});case"rejected":return e.jsx(re,{color:"error",children:"Rejected"});default:return e.jsx(re,{children:"Unknown"})}},M=async()=>{var q,Y;if(i)try{T(!0),await st.updateStatus(i._id,g,g==="rejected"?P:void 0),ee.success(`Exhibitor status updated to ${g}`),a(!1),s(Lt())}catch(Z){ee.error(((Y=(q=Z.response)==null?void 0:q.data)==null?void 0:Y.message)||"Failed to update exhibitor status")}finally{T(!1)}},E=async q=>{var Y,Z;if(i)try{N(!0),await st.updateExhibitor(i._id,q),ee.success("Exhibitor details updated successfully"),b(!1),s(Lt())}catch(le){ee.error(((Z=(Y=le.response)==null?void 0:Y.data)==null?void 0:Z.message)||"Failed to update exhibitor details")}finally{N(!1)}},l=async q=>{var Y,Z;try{d(!0),await st.deleteExhibitor(q),ee.success("Exhibitor deleted successfully"),s(Lt())}catch(le){ee.error(((Z=(Y=le.response)==null?void 0:Y.data)==null?void 0:Z.message)||"Failed to delete exhibitor")}finally{d(!1)}},k=q=>{if(L(q),!q){y(t);return}const Y=q.toLowerCase(),Z=t.filter(le=>le.companyName.toLowerCase().includes(Y)||le.contactPerson.toLowerCase().includes(Y)||le.email.toLowerCase().includes(Y)||le.phone.toLowerCase().includes(Y));y(Z)},F=q=>{if(q==="all"){y(t);return}const Y=t.filter(Z=>Z.status===q);y(Y)},z=q=>{if(!q||q.length!==2){y(t);return}const Y=q[0].startOf("day").toISOString(),Z=q[1].endOf("day").toISOString(),le=t.filter(ve=>{const ce=new Date(ve.createdAt).toISOString();return ce>=Y&&ce<=Z});y(le)},U=()=>{const q=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],Y=A.map(te=>[te.companyName,te.contactPerson,te.email,te.phone,te.status,te.isActive?"Yes":"No",new Date(te.createdAt).toLocaleDateString(),te.address||"",te.website||""]);Y.unshift(q);const Z=Y.map(te=>te.map(de=>typeof de=="string"&&(de.includes(",")||de.includes('"')||de.includes(`
`))?`"${de.replace(/"/g,'""')}"`:de).join(",")).join(`
`),le=new Blob([Z],{type:"text/csv;charset=utf-8;"}),ve=URL.createObjectURL(le),ce=document.createElement("a");ce.setAttribute("href",ve),ce.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),ce.style.visibility="hidden",document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),ee.success("Exhibitor data exported successfully")},V=()=>{ge.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${f.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{d(!0);const q=f.map(Y=>st.deleteExhibitor(Y.toString()));await Promise.all(q),ee.success(`${f.length} exhibitors deleted successfully`),w([]),s(Lt())}catch{ee.error("Failed to delete some exhibitors")}finally{d(!1)}}})},H={selectedRowKeys:f,onChange:q=>{w(q)}},W=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(q,Y)=>q.companyName.localeCompare(Y.companyName),filterDropdown:({setSelectedKeys:q,selectedKeys:Y,confirm:Z,clearFilters:le})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(G,{placeholder:"Search company or contact",value:Y[0],onChange:ve=>q(ve.target.value?[ve.target.value]:[]),onPressEnter:()=>Z(),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(X,{children:[e.jsx(O,{type:"primary",onClick:()=>Z(),icon:e.jsx(us,{}),size:"small",style:{width:90},children:"Filter"}),e.jsx(O,{onClick:()=>{le&&le(),Z()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:q=>e.jsx(us,{style:{color:q?"#1890ff":void 0}}),onFilter:(q,Y)=>{const Z=String(q).toLowerCase();return Y.companyName.toLowerCase().includes(Z)||Y.contactPerson.toLowerCase().includes(Z)},render:(q,Y)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:q}),e.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",Y.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(q,Y)=>e.jsxs("div",{children:[e.jsx("div",{children:q}),e.jsx("div",{style:{fontSize:"12px"},children:Y.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(q,Y)=>Y.status===q,render:q=>m(q)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(q,Y)=>Y.isActive===q,render:q=>e.jsx(re,{color:q?"green":"red",children:q?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(q,Y)=>new Date(q.createdAt).getTime()-new Date(Y.createdAt).getTime(),render:q=>e.jsx(Ve,{title:new Date(q).toLocaleString(),children:new Date(q).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:q=>q?e.jsx("a",{href:q,target:"_blank",rel:"noopener noreferrer",children:q.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(q,Y)=>e.jsxs(X,{children:[e.jsx(Ve,{title:"View Details",children:e.jsx(O,{icon:e.jsx(Wt,{}),onClick:()=>{r(Y),S(!0)}})}),e.jsx(O,{type:"primary",onClick:()=>{r(Y),x(Y.status),C(Y.rejectionReason||""),a(!0)},children:"Update Status"}),e.jsx(ms,{overlay:e.jsxs(jt,{children:[e.jsx(jt.Item,{icon:e.jsx(_s,{}),onClick:()=>{r(Y),b(!0)},children:"Edit"},"edit"),e.jsx(jt.Item,{icon:e.jsx(nt,{}),danger:!0,onClick:Z=>{Z.domEvent.stopPropagation(),ge.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>l(Y._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(O,{icon:e.jsx($r,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(ie,{gutter:[24,24],align:"middle",children:[e.jsx(B,{flex:"auto",children:e.jsxs(X,{direction:"vertical",size:4,children:[e.jsx(Rm,{level:4,style:{margin:0},children:"Exhibitors"}),e.jsx(Se,{type:"secondary",children:"Manage exhibitors and their information"})]})}),e.jsx(B,{children:e.jsx(O,{type:"primary",icon:e.jsx(nn,{}),onClick:()=>b(!0),size:"large",children:"Add Exhibitor"})})]})}),e.jsxs(ie,{gutter:[16,24],style:{marginBottom:"24px"},children:[e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Total Exhibitors",value:I.total,prefix:e.jsx(Ce,{})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Pending",value:I.pending,prefix:e.jsx(Ze,{style:{color:"#faad14"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Approved",value:I.approved,prefix:e.jsx(_e,{style:{color:"#52c41a"}})})})}),e.jsx(B,{xs:24,sm:12,md:6,children:e.jsx(K,{children:e.jsx(be,{title:"Rejected",value:I.rejected,prefix:e.jsx(Et,{style:{color:"#ff4d4f"}})})})})]}),e.jsx(K,{className:"info-card",style:{marginBottom:"24px"},children:e.jsxs(X,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{gutter:[16,16],align:"middle",children:[e.jsx(B,{xs:24,sm:8,md:6,lg:4,children:e.jsx(Dm,{placeholder:"Search exhibitors",allowClear:!0,onSearch:k,style:{width:"100%"}})}),e.jsx(B,{xs:24,sm:8,md:6,lg:4,children:e.jsxs(ae,{placeholder:"Filter by status",style:{width:"100%"},onChange:F,allowClear:!0,children:[e.jsx(Mn,{value:"all",children:"All Status"}),e.jsx(Mn,{value:"pending",children:"Pending"}),e.jsx(Mn,{value:"approved",children:"Approved"}),e.jsx(Mn,{value:"rejected",children:"Rejected"})]})}),e.jsx(B,{xs:24,sm:8,md:6,lg:6,children:e.jsx(Lm,{style:{width:"100%"},onChange:z})})]}),f.length>0&&e.jsx(ie,{children:e.jsxs(X,{children:[e.jsxs(Se,{children:["Selected ",f.length," items"]}),e.jsx(O,{danger:!0,onClick:V,children:"Delete Selected"}),e.jsx(O,{type:"primary",onClick:U,children:"Export Selected"})]})})]})}),e.jsx(K,{className:"info-card",children:e.jsx($e,{rowSelection:H,dataSource:A,columns:W,rowKey:"_id",loading:n,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(q,Y)=>`${Y[0]}-${Y[1]} of ${q} items`},scroll:{x:1500}})}),e.jsx(ge,{title:"Exhibitor Details",open:c,onCancel:()=>S(!1),footer:[e.jsx(O,{onClick:()=>S(!1),children:"Close"},"close")],width:600,children:i&&e.jsx("div",{children:e.jsxs(ie,{gutter:[16,16],children:[e.jsx(B,{span:24,children:e.jsx(K,{title:"Company Information",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Company Name:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.companyName})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Contact Person:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.contactPerson})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Email:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.email})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Phone:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.phone})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Address:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.address||"Not provided"})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Status:"})}),e.jsx(B,{span:12,children:m(i.status)}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Active:"})}),e.jsx(B,{span:12,children:e.jsx(bt,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Registration Date:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:new Date(i.createdAt).toLocaleString()})})]})})}),e.jsx(B,{span:24,children:e.jsxs(K,{title:"Additional Information",children:[e.jsxs(ie,{gutter:[16,8],children:[e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Address:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{children:i.address||"Not provided"})}),e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Website:"})}),e.jsx(B,{span:12,children:i.website?e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{span:12,children:e.jsx(Se,{strong:!0,children:"Rejection Reason:"})}),e.jsx(B,{span:12,children:e.jsx(Se,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&e.jsxs(e.Fragment,{children:[e.jsx(Ee,{}),e.jsx(Se,{strong:!0,children:"Description:"}),e.jsx(_m,{style:{marginTop:8},children:i.description})]})]})})]})})}),e.jsx(ge,{title:"Update Exhibitor Status",open:o,onCancel:()=>a(!1),footer:null,width:600,children:i&&e.jsxs("div",{children:[e.jsx(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Ce,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(ie,{gutter:[16,8],children:[e.jsx(B,{span:8,children:e.jsx(Se,{strong:!0,children:"Company:"})}),e.jsx(B,{span:16,children:e.jsx(Se,{children:i.companyName})}),e.jsx(B,{span:8,children:e.jsx(Se,{strong:!0,children:"Contact Person:"})}),e.jsx(B,{span:16,children:e.jsx(Se,{children:i.contactPerson})}),e.jsx(B,{span:8,children:e.jsx(Se,{strong:!0,children:"Email:"})}),e.jsx(B,{span:16,children:e.jsx(Se,{children:i.email})}),e.jsx(B,{span:8,children:e.jsx(Se,{strong:!0,children:"Address:"})}),e.jsx(B,{span:16,children:e.jsx(Se,{children:i.address||"Not provided"})}),e.jsx(B,{span:8,children:e.jsx(Se,{strong:!0,children:"Current Status:"})}),e.jsx(B,{span:16,children:m(i.status)})]})}),e.jsxs(K,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx($s,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(Se,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(_t.Group,{value:g,onChange:q=>x(q.target.value),buttonStyle:"solid",children:[e.jsx(_t.Button,{value:"pending",children:e.jsxs(X,{children:[e.jsx(Ze,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(_t.Button,{value:"approved",children:e.jsxs(X,{children:[e.jsx(_e,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(_t.Button,{value:"rejected",children:e.jsxs(X,{children:[e.jsx(Et,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),g==="rejected"&&e.jsx("div",{children:e.jsx($.Item,{label:e.jsx(Se,{strong:!0,children:"Rejection Reason:"}),required:g==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:e.jsx(ma,{rows:4,value:P,onChange:q=>C(q.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),g==="approved"&&e.jsx(qe,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),g==="pending"&&e.jsx(qe,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(O,{onClick:()=>a(!1),children:"Cancel"}),e.jsx(O,{type:"primary",onClick:M,loading:v,disabled:g==="rejected"&&!P.trim(),children:"Update Status"})]})]})]})}),e.jsx(ge,{title:"Edit Exhibitor Details",open:u,onCancel:()=>b(!1),footer:null,width:600,children:e.jsxs($,{form:D,layout:"vertical",onFinish:E,children:[e.jsx($.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(G,{})}),e.jsx($.Item,{name:"address",label:"Address",children:e.jsx(G,{})}),e.jsx($.Item,{name:"website",label:"Website",children:e.jsx(G,{})}),e.jsx($.Item,{name:"description",label:"Description",children:e.jsx(ma,{rows:4})}),e.jsx($.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(mt,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx($.Item,{children:e.jsxs(X,{children:[e.jsx(O,{type:"primary",htmlType:"submit",loading:j,children:"Save Changes"}),e.jsx(O,{onClick:()=>b(!1),children:"Cancel"})]})})]})})]})},Oe=({children:s})=>ue(n=>n.auth.isAuthenticated)?s:e.jsx(ji,{to:"/login"}),Es=({children:s})=>ue(n=>n.exhibitorAuth.isAuthenticated)?s:e.jsx(ji,{to:"/"});function Fm(){return e.jsx(it,{children:e.jsx(fn,{children:e.jsx(gc,{children:e.jsxs(yc,{children:[e.jsx(we,{path:"/",element:e.jsx(Pm,{})}),e.jsx(we,{path:"/login",element:e.jsx(zu,{})}),e.jsx(we,{path:"/exhibitions",element:e.jsx(Yx,{})}),e.jsx(we,{path:"/exhibitions/:id",element:e.jsx(Rx,{})}),e.jsx(we,{path:"/exhibitions/:id/layout",element:e.jsx(Nx,{})}),e.jsx(we,{path:"/exhibitor/dashboard",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx(Hu,{})})})}),e.jsx(we,{path:"/exhibitor/profile",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx(Xu,{})})})}),e.jsx(we,{path:"/exhibitor/bookings",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx(Gu,{})})})}),e.jsx(we,{path:"/exhibitor/bookings/:id",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx(Ku,{})})})}),e.jsx(we,{path:"/exhibitor/support",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx("div",{children:"Help & Support"})})})}),e.jsx(we,{path:"/exhibitor/invoice/:id",element:e.jsx(Es,{children:e.jsx(ys,{children:e.jsx(Vh,{})})})}),e.jsx(we,{path:"/dashboard",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Uu,{})})})}),e.jsx(we,{path:"/account",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Hh,{})})})}),e.jsx(we,{path:"/exhibition",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Tp,{})})})}),e.jsx(we,{path:"/exhibition/create",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx($p,{})})})}),e.jsx(we,{path:"/exhibition/:id",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Fp,{})})})}),e.jsx(we,{path:"/exhibition/:id/space",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Jp,{})})})}),e.jsx(we,{path:"/exhibition/:id/layout",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(ex,{})})})}),e.jsx(we,{path:"/exhibition/:id/halls",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(sx,{})})})}),e.jsx(we,{path:"/exhibition/:id/stalls",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Gx,{})})})}),e.jsx(we,{path:"/exhibition/:id/fixtures",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Jx,{})})})}),e.jsx(we,{path:"/exhibition/:id/edit",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Bp,{})})})}),e.jsx(we,{path:"/stall/list",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(tm,{})})})}),e.jsx(we,{path:"/stall-types",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(om,{})})})}),e.jsx(we,{path:"/bookings",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(fm,{})})})}),e.jsx(we,{path:"/bookings/create",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(vm,{})})})}),e.jsx(we,{path:"/invoice/:id",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(wm,{})})})}),e.jsx(we,{path:"/index",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(vp,{})})})}),e.jsx(we,{path:"/settings",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Qh,{})})})}),e.jsx(we,{path:"/roles",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(rp,{})})})}),e.jsx(we,{path:"/notifications",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx(Cp,{})})})}),e.jsx(we,{path:"/exhibitors",element:e.jsx(Oe,{children:e.jsx(ze,{children:e.jsx($m,{})})})}),e.jsx(we,{path:"*",element:e.jsx(ji,{to:"/",replace:!0})})]})})})})}const dr=Xr({reducerPath:"bookingApi",baseQuery:Yr({baseUrl:"/api"}),endpoints:s=>({getBookings:s.query({query:()=>"/bookings"}),getBooking:s.query({query:t=>`/bookings/${t}`}),createBooking:s.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:s.mutation({query:({id:t,status:n})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:n}})})})}),Bm=bc({reducer:{auth:Rc,exhibitorAuth:eu,exhibition:Ep,booking:lm,exhibitor:bm,settings:Ud,role:tp,user:hp,[dr.reducerPath]:dr.reducer,[li.reducerPath]:li.reducer,[Yn.reducerPath]:Yn.reducer},middleware:s=>s().concat(dr.middleware).concat(li.middleware).concat(Yn.middleware)}),Mm={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};xr.createRoot(document.getElementById("root")).render(e.jsx(De.StrictMode,{children:e.jsx(jc,{store:Bm,children:e.jsx(ac,{theme:Mm,children:e.jsx(it,{children:e.jsx(Fm,{})})})})}));
