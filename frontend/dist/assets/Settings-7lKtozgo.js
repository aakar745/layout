import{f as P,j as e,u as z,b as k}from"./index-aoH9EzMk.js";import{F as C,aO as B,Z as n,p as A,r as j,a9 as U,aa as y,S as I,T as O,ab as V,Y as v,aF as b,aH as q,aL as M,a3 as L,i as R,aQ as D,bO as G,aG as H}from"./vendor-Be5M1UDi.js";import{a as S}from"./apis-CU9I9MMq.js";import"./canvas-C-A9eff5.js";const{Option:d}=b,{Title:Q,Text:Y}=O,X=()=>{const h=C(),{message:u}=B.useApp(),[c]=n.useForm(),{settings:t,loading:F}=A(a=>a.settings),[f,r]=j.useState([]),[p,g]=j.useState(0);j.useEffect(()=>{h(P())},[h]),j.useEffect(()=>{if(t&&(c.setFieldsValue({siteName:t.siteName,adminEmail:t.adminEmail,language:t.language,timezone:t.timezone,emailNotifications:t.emailNotifications,footerText:t.footerText}),t.logo)){const a=s=>{const o=localStorage.getItem("token");return{url:`${S.defaults.baseURL}/uploads/${s}`,token:o}},{url:i,token:l}=a(t.logo);fetch(i,{headers:{authorization:`Bearer ${l}`}}).then(s=>s.blob()).then(s=>{var m;const o=URL.createObjectURL(s);r([{uid:"-1",name:((m=t.logo)==null?void 0:m.split("/").pop())||"logo",status:"done",url:o,thumbUrl:o,type:s.type,response:{path:t.logo}}])}).catch(()=>{r([])})}},[t,c]);const $=a=>{h(z(a)).unwrap().then(()=>u.success("Settings updated successfully")).catch(i=>u.error(`Failed to update settings: ${i}`))},N={name:"file",action:`${S.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:f,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:i,name:l,response:s,uid:o}=a.file;if(i==="uploading"){r([...a.fileList]);return}if(i==="done"&&s){g(0);const m=localStorage.getItem("token"),E=`${S.defaults.baseURL}/uploads/${s.path}`;fetch(E,{headers:{authorization:`Bearer ${m}`}}).then(x=>x.blob()).then(x=>{const T=URL.createObjectURL(x);r([{uid:a.file.uid,name:l,status:"done",url:T,thumbUrl:T,type:x.type,response:s}]),u.success(`${l} uploaded successfully`),c.setFieldValue("logo",s.path)}).catch(()=>{u.error(`${l} preview failed to load`),r([])})}else i==="error"?(u.error(`${l} upload failed.`),r([]),g(0)):i==="removed"&&(r([]),c.setFieldValue("logo",null),g(0))},onRemove(){return r([]),c.setFieldValue("logo",null),g(0),!0},customRequest:async({file:a,onSuccess:i,onError:l,onProgress:s})=>{try{h(k(a)).unwrap().then(o=>{i&&i(o)}).catch(o=>{l&&l(new Error(o))})}catch(o){l&&l(o)}}},w=e.jsx("div",{children:p>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(L,{type:"circle",percent:p,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(U,{gutter:[24,24],align:"middle",children:e.jsx(y,{flex:"auto",children:e.jsxs(I,{direction:"vertical",size:4,children:[e.jsx(Q,{level:4,style:{margin:0},children:"Settings"}),e.jsx(Y,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(V,{className:"info-card",children:e.jsxs(n,{form:c,layout:"vertical",onFinish:$,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(U,{gutter:24,children:[e.jsxs(y,{span:12,children:[e.jsx(n.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Language",name:"language",children:e.jsxs(b,{children:[e.jsx(d,{value:"en",children:"English"}),e.jsx(d,{value:"es",children:"Spanish"}),e.jsx(d,{value:"fr",children:"French"})]})}),e.jsx(n.Item,{label:"Timezone",name:"timezone",children:e.jsxs(b,{children:[e.jsx(d,{value:"UTC",children:"UTC"}),e.jsx(d,{value:"EST",children:"EST"}),e.jsx(d,{value:"PST",children:"PST"})]})}),e.jsx(n.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(q,{})})]}),e.jsxs(y,{span:12,children:[e.jsxs(n.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(M,{...N,children:f.length<1&&w}),f.length>0&&p>0&&e.jsx(L,{percent:p,status:"active",style:{marginTop:8}})]}),e.jsx(n.Item,{label:"Footer Text",name:"footerText",children:e.jsx(v.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(n.Item,{children:e.jsxs(I,{children:[e.jsx(R,{type:"primary",htmlType:"submit",icon:e.jsx(D,{}),loading:F,children:"Save Settings"}),e.jsx(R,{onClick:()=>c.resetFields(),icon:e.jsx(G,{}),children:"Reset"})]})})]})})]})};export{X as default};
