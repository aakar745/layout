import{I as J,J as K,K as Q,D as X,j as e,G as Z,F as _}from"./index-BP1I9PmK.js";import{l as q,u as V,j as O,i as ee,r as h}from"./vendor-react-BNeW3y6d.js";import{a6 as p,aM as te,U as se,T as re,a7 as u,a8 as i,S as v,av as oe,d as j,a3 as ie,D as S,aH as y,h as ne,Q as N,c as f,Z as ae,a$ as le,aN as de,b as L,o as ce,$ as xe,w as pe,x as ge,bc as he,j as ue,A as je,f as ye,aV as fe}from"./vendor-antd-DhcJxEc5.js";import"./vendor-utils-j652IAQy.js";import"./vendor-styling-BBrlYwaV.js";import"./vendor-canvas-BRbMLhVA.js";const{Title:U,Text:r,Paragraph:B}=re,P=()=>{const n=V();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(f,{icon:e.jsx(fe,{}),onClick:()=>n("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Be=()=>{const{id:n}=q(),H=V(),m=O(),{currentExhibition:t,halls:a,stalls:l,loading:W}=ee(s=>s.exhibition),[b,x]=h.useState(0),[o,D]=h.useState(null),[w,R]=h.useState(!1);h.useEffect(()=>{n&&(m(J(n)),m(K(n)),m(Q({exhibitionId:n})),I(n))},[n,m]),h.useEffect(()=>{t&&F()},[t,o]);const I=async s=>{try{R(!0);const d=await X.getExhibitionProgress(s);D({hallCount:(a==null?void 0:a.length)||0,stallCount:d.stats.totalStalls,bookedStallCount:d.stats.bookedStalls,progress:d.progress})}catch(d){console.error("Failed to fetch exhibition stats:",d),D({hallCount:(a==null?void 0:a.length)||0,stallCount:(l==null?void 0:l.length)||0,bookedStallCount:(l==null?void 0:l.filter(c=>c.status==="booked").length)||0})}finally{R(!1)}},g=()=>o||(t?t.stats?{hallCount:(a==null?void 0:a.length)||t.hallCount||0,stallCount:t.stats.totalStalls,bookedStallCount:t.stats.bookedStalls}:{hallCount:(a==null?void 0:a.length)||0,stallCount:(l==null?void 0:l.length)||0,bookedStallCount:(l==null?void 0:l.filter(s=>s.status==="booked").length)||0}:{hallCount:0,stallCount:0,bookedStallCount:0}),F=()=>{var z,Y,$,A;if(!t)return 0;if(((z=o==null?void 0:o.progress)==null?void 0:z.combinedProgress)!==void 0)return x(o.progress.combinedProgress);if(((Y=t.progress)==null?void 0:Y.combinedProgress)!==void 0)return x(t.progress.combinedProgress);if((($=o==null?void 0:o.progress)==null?void 0:$.stallBookingProgress)!==void 0)return x(o.progress.stallBookingProgress);if(((A=t.progress)==null?void 0:A.stallBookingProgress)!==void 0)return x(t.progress.stallBookingProgress);const s=new Date,d=new Date(t.startDate),c=new Date(t.endDate);if(s<d)return x(0);if(s>c)return x(100);const M=c.getTime()-d.getTime(),C=s.getTime()-d.getTime();x(Math.round(C/M*100))},T=s=>{switch(s.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},G=()=>{if(!t)return{text:"",count:0,isPast:!1};const s=new Date,d=new Date(t.startDate),c=new Date(t.endDate);return s>c?{text:"Ended",count:Math.ceil((s.getTime()-c.getTime())/864e5),isPast:!0}:s>=d&&s<=c?{text:"Days Remaining",count:Math.ceil((c.getTime()-s.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((d.getTime()-s.getTime())/(1e3*60*60*24)),isPast:!1}},E=s=>{H(_(t,s))};if(W)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(P,{}),e.jsx(p,{children:e.jsx(te,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!t)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(P,{}),e.jsx(p,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(se,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx(U,{level:4,children:"Exhibition not found"}),e.jsx(B,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const k=G();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(P,{}),e.jsx(p,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(u,{gutter:[24,24],align:"middle",children:[e.jsxs(i,{xs:24,md:16,children:[e.jsx(U,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:t.name}),e.jsx(B,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:t.description}),e.jsxs(v,{split:e.jsx(S,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(v,{children:[e.jsx(oe,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(r,{style:{color:"rgba(255,255,255,0.8)"},children:[j(t.startDate).format("MMM D, YYYY")," - ",j(t.endDate).format("MMM D, YYYY")]})]}),t.venue&&e.jsxs(v,{children:[e.jsx(ie,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(r,{style:{color:"rgba(255,255,255,0.8)"},children:t.venue})]})]})]}),e.jsx(i,{xs:24,md:8,children:e.jsxs(p,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:T(t.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:t.status.toUpperCase()}),e.jsx(y,{title:k.text,value:k.count,suffix:"days",valueStyle:{color:k.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(ne,{})}),e.jsx(S,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(r,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(N,{percent:b,status:b===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),t.progress&&e.jsxs("div",{style:{marginTop:"12px",fontSize:"12px",color:"#8c8c8c"},children:[e.jsxs("div",{children:["Stall Booking: ",t.progress.stallBookingProgress,"%"]}),e.jsxs("div",{children:["Timeline: ",t.progress.timeProgress,"%"]})]}),t.stats&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#595959"},children:[t.stats.bookedStalls,"/",t.stats.totalStalls," stalls booked"]})]})})]})})}),e.jsxs(u,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(i,{xs:24,sm:8,children:e.jsx(f,{type:"primary",icon:e.jsx(ae,{}),onClick:()=>E(`${n}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(i,{xs:24,sm:8,children:e.jsx(f,{icon:e.jsx(le,{}),onClick:()=>E(`${n}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(i,{xs:24,sm:8,children:e.jsx(f,{icon:e.jsx(de,{}),onClick:()=>window.open(Z(t),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:t.status!=="published",children:"View Public Page"})})]}),e.jsxs(u,{gutter:[24,24],children:[e.jsx(i,{xs:24,lg:16,children:e.jsxs(p,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(u,{gutter:[24,24],children:[e.jsxs(i,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(r,{strong:!0,style:{fontSize:"16px"},children:j(t.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(r,{strong:!0,style:{fontSize:"16px"},children:j(t.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(r,{strong:!0,style:{fontSize:"16px"},children:j(t.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(i,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(L,{color:T(t.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:t.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(L,{color:t.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:t.isActive?"ACTIVE":"INACTIVE"})]}),t.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(r,{strong:!0,style:{fontSize:"16px"},children:t.venue})]})]})]}),e.jsx(S,{}),e.jsxs("div",{children:[e.jsx(r,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(B,{children:t.description||"No description provided."})]})]})}),e.jsxs(i,{xs:24,lg:8,children:[e.jsxs(p,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Stats"}),e.jsx(f,{type:"text",size:"small",loading:w,onClick:()=>n&&I(n),icon:e.jsx(ue,{}),title:"Refresh Stats"})]}),style:{borderRadius:"12px",marginBottom:"24px"},children:[w?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(ce,{size:"large"}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsx(r,{type:"secondary",children:"Loading real-time statistics..."})})]}):e.jsxs(u,{gutter:[16,24],children:[e.jsx(i,{span:12,children:e.jsx(y,{title:"Halls",value:g().hallCount,prefix:e.jsx(xe,{})})}),e.jsx(i,{span:12,children:e.jsx(y,{title:"Stalls",value:g().stallCount,prefix:e.jsx(pe,{})})}),e.jsx(i,{span:12,children:e.jsx(y,{title:"Booked Stalls",value:g().bookedStallCount,prefix:e.jsx(ge,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(i,{span:12,children:e.jsx(y,{title:"Available Stalls",value:g().stallCount-g().bookedStallCount,prefix:e.jsx(he,{}),valueStyle:{color:"#1890ff"}})})]}),e.jsx(S,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(r,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(N,{percent:b,status:b===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),(o==null?void 0:o.progress)&&e.jsxs("div",{style:{marginTop:"12px",fontSize:"12px",color:"#8c8c8c"},children:[e.jsxs("div",{children:["Stall Booking: ",o.progress.stallBookingProgress,"%"]}),e.jsxs("div",{children:["Time Progress: ",o.progress.timeProgress,"%"]}),e.jsxs("div",{children:["Combined: ",o.progress.combinedProgress,"%"]})]})]}),e.jsx(p,{title:"Created By",style:{borderRadius:"12px"},children:t.createdBy?e.jsxs(v,{children:[e.jsx(je,{icon:e.jsx(ye,{})}),e.jsx(r,{children:t.createdByName||"Administrator"})]}):e.jsx(r,{type:"secondary",children:"Information not available"})})]})]})]})};export{Be as default};
