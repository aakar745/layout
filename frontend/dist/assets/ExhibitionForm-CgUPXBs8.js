import{j as e}from"./vendor-pdf-Cn0rG44s.js";import{r as A,G as N,T as G,y as U,z as o,F as t,t as d,al as he,S as z,Z as L,W as O,h as F,af as M,$ as _,a as te,a4 as ce,a3 as J,P as V,D as pe,m as Y,e as se}from"./vendor-antd-B8jUXf3i.js";import{E as ue}from"./vendor-editor-CDayDKFN.js";import{D as me,E as xe,b as W}from"./index-4IR4xblb.js";import{Z as H,K as Q,q as ne}from"./vendor-antd-icons-BoTJB7uA.js";const{RangePicker:ge}=he,{Title:B,Text:$}=G,ae=({value:j="",onChange:v})=>{const S=te.useRef(null),[u]=te.useState(j);return e.jsx(ue,{apiKey:xe,onInit:(I,c)=>{S.current=c},value:j,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:I=>{I.on("init",()=>{I.undoManager.clear(),I.undoManager.add()}),I.on("change",()=>{I.undoManager.add()})}},onEditorChange:I=>{v==null||v(I)}})},je=({form:j})=>{const[v,S]=A.useState([]),[u,I]=A.useState(!1);return A.useEffect(()=>{(async()=>{try{I(!0);const a=await me.getStallTypes();S(a.data.filter(l=>l.status==="active"))}catch(a){console.error("Failed to fetch stall types:",a)}finally{I(!1)}})()},[]),e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(N,{className:"settings-card",children:[e.jsx(B,{level:4,children:"Basic Information"}),e.jsx($,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),e.jsxs(U,{gutter:24,children:[e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:e.jsx(d,{placeholder:"Enter exhibition name"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(d.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:e.jsx(d.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:e.jsx(d,{placeholder:"Enter invoice prefix (default: INV)"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:e.jsx(ge,{style:{width:"100%"}})})})]})]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(B,{level:4,children:"Company Details"}),e.jsx($,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),e.jsxs(U,{gutter:24,children:[e.jsxs(o,{span:12,children:[e.jsx(t.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(d,{placeholder:"Enter company name"})}),e.jsx(t.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:e.jsx(d,{placeholder:"Enter contact number"})}),e.jsx(t.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(d,{placeholder:"Enter email address"})}),e.jsx(t.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(d.TextArea,{rows:4,placeholder:"Enter company address"})}),e.jsx(t.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:e.jsx(ae,{})})]}),e.jsxs(o,{span:12,children:[e.jsx(t.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:e.jsx(d,{placeholder:"Enter PAN number"})}),e.jsx(t.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:e.jsx(d,{placeholder:"Enter GST number"})}),e.jsx(t.Item,{name:"companySAC",label:"SAC Code No.",children:e.jsx(d,{placeholder:"Enter SAC code number"})}),e.jsx(t.Item,{name:"companyCIN",label:"CIN No.",children:e.jsx(d,{placeholder:"Enter CIN number"})}),e.jsx(t.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:e.jsx(d,{placeholder:"Enter website URL"})}),e.jsx(t.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:e.jsx(ae,{})})]})]})]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(B,{level:4,children:"Bank Details"}),e.jsx($,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),e.jsxs(U,{gutter:24,children:[e.jsxs(o,{span:12,children:[e.jsx(t.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:e.jsx(d,{placeholder:"Enter bank name"})}),e.jsx(t.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:e.jsx(d,{placeholder:"Enter branch name"})}),e.jsx(t.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:e.jsx(d,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),e.jsxs(o,{span:12,children:[e.jsx(t.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:e.jsx(d,{placeholder:"Enter account name"})}),e.jsx(t.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:e.jsx(d,{placeholder:"Enter account number"})})]})]})]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(B,{level:4,children:"Stall Rates & Pricing"}),e.jsx($,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(B,{level:5,children:"Stall Type Rates"}),e.jsx($,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),e.jsx(t.List,{name:"stallRates",children:(c,{add:a,remove:l})=>e.jsxs(e.Fragment,{children:[c.map(({key:w,name:n,...m})=>e.jsxs(z,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(t.Item,{...m,name:[n,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:e.jsx(L,{loading:u,placeholder:"Select stall type",style:{width:200},children:v.map(h=>e.jsx(L.Option,{value:h._id,children:h.name},h._id))})}),e.jsx(t.Item,{...m,name:[n,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:e.jsx(O,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"₹",formatter:h=>`${h}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:h=>{const x=h?Number(h.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(x)?0:x}})}),e.jsx(H,{onClick:()=>l(n)})]},w)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(M,{}),children:"Add Stall Type Rate"})})]})})]}),e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx(B,{level:5,children:"Tax Configuration"}),e.jsx($,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),e.jsx(t.List,{name:"taxConfig",children:(c,{add:a,remove:l})=>e.jsxs(e.Fragment,{children:[c.map(({key:w,name:n,...m})=>e.jsxs(z,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(t.Item,{...m,name:[n,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:e.jsx(d,{placeholder:"Tax name",style:{width:150}})}),e.jsx(t.Item,{...m,name:[n,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:e.jsx(O,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:h=>`${h}%`,parser:h=>{const x=h?Number(h.replace("%","")):0;return isNaN(x)?0:Math.min(x,100)}})}),e.jsx(t.Item,{...m,name:[n,"isActive"],valuePropName:"checked",children:e.jsx(_,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(H,{onClick:()=>l(n)})]},w)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(M,{}),children:"Add Tax"})})]})})]}),e.jsxs("div",{children:[e.jsx(B,{level:5,children:"Admin Discount Configuration"}),e.jsx($,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),e.jsx(t.List,{name:"discountConfig",children:(c,{add:a,remove:l})=>e.jsxs(e.Fragment,{children:[c.map(({key:w,name:n,...m})=>e.jsxs(z,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(t.Item,{...m,name:[n,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(d,{placeholder:"Discount",style:{width:150}})}),e.jsx(t.Item,{...m,name:[n,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(L,{style:{width:150},children:[e.jsx(L.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(L.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),e.jsx(t.Item,{noStyle:!0,shouldUpdate:(h,x)=>{var P,q,r,i;return((q=(P=h==null?void 0:h.discountConfig)==null?void 0:P[n])==null?void 0:q.type)!==((i=(r=x==null?void 0:x.discountConfig)==null?void 0:r[n])==null?void 0:i.type)},children:({getFieldValue:h})=>{const x=h(["discountConfig",n,"type"]);return e.jsx(t.Item,{...m,name:[n,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(O,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:P=>x==="percentage"?`${P}%`:`₹${P}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:P=>{const q=P?Number(P.replace(/[₹%,]/g,"")):0;return isNaN(q)?0:q}})})}}),e.jsx(t.Item,{...m,name:[n,"isActive"],valuePropName:"checked",children:e.jsx(_,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(H,{onClick:()=>l(n)})]},w)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(M,{}),children:"Add Admin Discount"})})]})})]}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(B,{level:5,children:"Public Discount Configuration"}),e.jsx($,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),e.jsx(t.List,{name:"publicDiscountConfig",children:(c,{add:a,remove:l})=>e.jsxs(e.Fragment,{children:[c.map(({key:w,name:n,...m})=>e.jsxs(z,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(t.Item,{...m,name:[n,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:e.jsx(d,{placeholder:"Discount",style:{width:150}})}),e.jsx(t.Item,{...m,name:[n,"type"],rules:[{required:!0,message:"Please select type"}],children:e.jsxs(L,{style:{width:150},children:[e.jsx(L.Option,{value:"percentage",children:"Percentage (%)"}),e.jsx(L.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),e.jsx(t.Item,{noStyle:!0,shouldUpdate:(h,x)=>{var P,q,r,i;return((q=(P=h==null?void 0:h.publicDiscountConfig)==null?void 0:P[n])==null?void 0:q.type)!==((i=(r=x==null?void 0:x.publicDiscountConfig)==null?void 0:r[n])==null?void 0:i.type)},children:({getFieldValue:h})=>{const x=h(["publicDiscountConfig",n,"type"]);return e.jsx(t.Item,{...m,name:[n,"value"],rules:[{required:!0,message:`Please enter ${x==="percentage"?"percentage":"amount"}`}],children:e.jsx(O,{min:0,max:x==="percentage"?100:void 0,placeholder:x==="percentage"?"Percentage":"Amount",style:{width:150},formatter:P=>x==="percentage"?`${P}%`:`₹${P}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:P=>{const q=P?Number(P.replace(/[₹%,]/g,"")):0;return isNaN(q)?0:q}})})}}),e.jsx(t.Item,{...m,name:[n,"isActive"],valuePropName:"checked",children:e.jsx(_,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(H,{onClick:()=>l(n)})]},w)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(M,{}),children:"Add Public Discount"})})]})})]})]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(B,{level:4,children:"Status Settings"}),e.jsx($,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),e.jsxs(U,{gutter:24,children:[e.jsx(o,{span:12,children:e.jsx(t.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(L,{children:[e.jsx(L.Option,{value:"draft",children:"Draft"}),e.jsx(L.Option,{value:"published",children:"Published"}),e.jsx(L.Option,{value:"completed",children:"Completed"})]})})}),e.jsx(o,{span:12,children:e.jsx(t.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(_,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:re,Text:K}=G,ye=({form:j})=>{const{message:v}=ce.useApp(),[S,u]=A.useState([]),[I,c]=A.useState([]),[a,l]=A.useState(0),[w,n]=A.useState({}),m=r=>{const i=localStorage.getItem("token");return{url:`${W.defaults.baseURL}/uploads/${r}`,token:i}};A.useEffect(()=>{const r=j.getFieldValue("headerLogo");if(r){const{url:i,token:y}=m(r);fetch(i,{headers:{authorization:`Bearer ${y}`}}).then(s=>s.blob()).then(s=>{const T=URL.createObjectURL(s);u([{uid:"-1",name:r.split("/").pop()||"logo",status:"done",url:T,thumbUrl:T,type:s.type,response:{path:r}}])}).catch(()=>{u([])})}},[j]),A.useEffect(()=>{const r=j.getFieldValue("sponsorLogos")||[];r.length>0&&Promise.all(r.map(async(i,y)=>{const{url:s,token:T}=m(i);try{const g=await(await fetch(s,{headers:{authorization:`Bearer ${T}`}})).blob(),k=URL.createObjectURL(g);return{uid:`-${y+1}`,name:i.split("/").pop()||`sponsor-${y+1}`,status:"done",url:k,thumbUrl:k,type:g.type,response:{path:i}}}catch{return null}})).then(i=>{c(i.filter(Boolean))})},[j]);const h={name:"file",action:`${W.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:S,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(r){const{status:i,name:y,response:s,uid:T}=r.file;if(i==="uploading"){u([...r.fileList]);return}if(i==="done"&&s){const{url:f,token:g}=m(s.path);l(0),fetch(f,{headers:{authorization:`Bearer ${g}`}}).then(k=>k.blob()).then(k=>{const b=URL.createObjectURL(k);u([{uid:r.file.uid,name:y,status:"done",url:b,thumbUrl:b,type:k.type,response:s}]),v.success(`${y} uploaded successfully`),j.setFieldValue("headerLogo",s.path),s.thumbnail&&j.setFieldValue("headerLogoThumbnail",s.thumbnail)}).catch(()=>{v.error(`${y} preview failed to load`),u([])})}else i==="error"?(v.error(`${y} upload failed.`),u([]),l(0)):i==="removed"&&(u([]),j.setFieldValue("headerLogo",null),j.setFieldValue("headerLogoThumbnail",null),l(0))},customRequest:async r=>{const{onProgress:i,onSuccess:y,onError:s,file:T,action:f,headers:g}=r;try{const k=new FormData;k.append("file",T);const b=new XMLHttpRequest;b.open("POST",f||"",!0),g&&Object.keys(g).forEach(p=>{b.setRequestHeader(p,g[p])}),b.upload.onprogress=p=>{p.lengthComputable&&i&&(i({percent:p.loaded/p.total*100}),l(Math.round(p.loaded/p.total*100)))},b.onload=()=>{if(b.status>=200&&b.status<300)try{const p=JSON.parse(b.response);y==null||y(p,T),l(0)}catch(p){s==null||s(p)}else s==null||s(new Error("Upload failed"))},b.onerror=()=>{l(0),s==null||s(new Error("Upload request failed"))},b.send(k)}catch(k){l(0),s==null||s(k)}},onRemove(){return u([]),j.setFieldValue("headerLogo",null),j.setFieldValue("headerLogoThumbnail",null),l(0),!0},onPreview:async r=>{if(!r.url)return;const i=window.open("");i&&(i.document.write(`
          <img src="${r.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),i.document.head.innerHTML="<title>Image Preview</title>")}},x={name:"file",action:`${W.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:I,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(r){const{status:i,name:y,response:s,uid:T}=r.file;if(i==="uploading"){c([...r.fileList]);return}if(i==="done"&&s&&s.paths&&s.paths.length>0){n(b=>{const p={...b};return delete p[T],p});const f=s.paths[0],{url:g,token:k}=m(f);fetch(g,{headers:{authorization:`Bearer ${k}`}}).then(b=>b.blob()).then(b=>{const p=URL.createObjectURL(b),C=[...I],R=C.findIndex(E=>E.uid===r.file.uid),D={uid:r.file.uid,name:y,status:"done",url:p,thumbUrl:p,type:b.type,response:{path:f}};R>-1?C[R]=D:C.push(D),c(C),v.success(`${y} uploaded successfully`);const de=C.filter(E=>{var ee;return E.status==="done"&&((ee=E.response)==null?void 0:ee.path)}).map(E=>E.response.path);if(j.setFieldValue("sponsorLogos",de),s.thumbnails&&s.thumbnails.length>0){const E=j.getFieldValue("sponsorLogoThumbnails")||[];j.setFieldValue("sponsorLogoThumbnails",[...E,...s.thumbnails])}}).catch(()=>{v.error(`${y} preview failed to load`),c(b=>b.filter(p=>p.uid!==r.file.uid))})}else i==="error"?(v.error(`${y} upload failed.`),c(f=>f.filter(g=>g.uid!==r.file.uid)),n(f=>{const g={...f};return delete g[T],g})):i==="removed"&&n(f=>{const g={...f};return delete g[T],g})},customRequest:async r=>{const{onProgress:i,onSuccess:y,onError:s,file:T,action:f,headers:g}=r,k=typeof T=="object"&&"uid"in T?T.uid:String(Date.now());try{const b=new FormData;b.append("file",T);const p=new XMLHttpRequest;p.open("POST",f||"",!0),g&&Object.keys(g).forEach(C=>{p.setRequestHeader(C,g[C])}),p.upload.onprogress=C=>{if(C.lengthComputable&&i){const R=C.loaded/C.total*100;i({percent:R}),n(D=>({...D,[k]:Math.round(R)}))}},p.onload=()=>{if(p.status>=200&&p.status<300)try{const C=JSON.parse(p.response);y==null||y(C,T),n(R=>{const D={...R};return delete D[k],D})}catch(C){s==null||s(C)}else s==null||s(new Error("Upload failed"))},p.onerror=()=>{n(C=>{const R={...C};return delete R[k],R}),s==null||s(new Error("Upload request failed"))},p.send(b)}catch(b){n(p=>{const C={...p};return delete C[k],C}),s==null||s(b)}},onRemove(r){var T;const i=I.filter(f=>f.uid!==r.uid);c(i);const y=i.filter(f=>{var g;return f.status==="done"&&((g=f.response)==null?void 0:g.path)}).map(f=>f.response.path);j.setFieldValue("sponsorLogos",y);const s=j.getFieldValue("sponsorLogoThumbnails")||[];if(s.length>0&&(T=r.response)!=null&&T.path){const f=r.response.path.split("/"),g=f[f.length-1],k=s.filter(b=>!b.includes(g));j.setFieldValue("sponsorLogoThumbnails",k)}return n(f=>{const g={...f};return delete g[r.uid],g}),!0},onPreview:async r=>{if(!r.url)return;const i=window.open("");i&&(i.document.write(`
          <img src="${r.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),i.document.head.innerHTML="<title>Image Preview</title>")}},P=e.jsx("div",{children:a>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(V,{type:"circle",percent:a,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),q=e.jsxs("div",{children:[e.jsx(Q,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return e.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:e.jsxs(N,{className:"settings-card",children:[e.jsx(re,{level:4,children:"Header Settings"}),e.jsx(K,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),e.jsxs(U,{gutter:24,children:[e.jsx(o,{span:24,children:e.jsxs(t.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(J,{...h,children:S.length<1&&P}),S.length>0&&a>0&&e.jsx(V,{percent:a,status:"active",style:{marginTop:8}})]})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:e.jsx(d,{placeholder:"Enter a title for your exhibition header"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:e.jsx(d,{placeholder:"Enter a subtitle (optional)"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:e.jsx(d.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),e.jsxs(o,{span:24,children:[e.jsx(pe,{}),e.jsx(re,{level:5,children:"Sponsor Logos"}),e.jsx(K,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),e.jsxs(t.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[e.jsx(J,{...x,children:q}),Object.entries(w).map(([r,i])=>{var y;return e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[e.jsxs(K,{style:{marginRight:10,width:150},ellipsis:!0,children:[((y=I.find(s=>s.uid===r))==null?void 0:y.name)||"File",":"]}),e.jsx(V,{percent:i,status:"active",style:{flex:1}})]},r)})]})]})]})]})})},{Title:ie,Text:le}=G,be=({form:j})=>{const{message:v}=ce.useApp(),[S,u]=A.useState([]),I=a=>{const l=localStorage.getItem("token");return{url:`${W.defaults.baseURL}/uploads/${a}`,token:l}};A.useEffect(()=>{const a=j.getFieldValue("footerLogo");if(a){const{url:l,token:w}=I(a);fetch(l,{headers:{authorization:`Bearer ${w}`}}).then(n=>n.blob()).then(n=>{const m=URL.createObjectURL(n);u([{uid:"-1",name:a.split("/").pop()||"logo",status:"done",url:m,thumbUrl:m,type:n.type,response:{path:a}}])}).catch(()=>{u([])})}},[j]);const c={name:"file",action:`${W.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:S,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:l,name:w,response:n}=a.file;if(l==="uploading"){u([...a.fileList]);return}if(l==="done"&&n){const{url:m,token:h}=I(n.path);fetch(m,{headers:{authorization:`Bearer ${h}`}}).then(x=>x.blob()).then(x=>{const P=URL.createObjectURL(x);u([{uid:a.file.uid,name:w,status:"done",url:P,thumbUrl:P,type:x.type,response:n}]),v.success(`${w} uploaded successfully`),j.setFieldValue("footerLogo",n.path)}).catch(()=>{v.error(`${w} preview failed to load`),u([])})}else l==="error"?(v.error(`${w} upload failed.`),u([])):l==="removed"&&(u([]),j.setFieldValue("footerLogo",null))},onRemove(){return u([]),j.setFieldValue("footerLogo",null),!0},onPreview:async a=>{if(!a.url)return;const l=window.open("");l&&(l.document.write(`
          <img src="${a.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),l.document.head.innerHTML="<title>Image Preview</title>")}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(N,{className:"settings-card",children:[e.jsx(ie,{level:4,children:"Footer Content"}),e.jsx(le,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),e.jsxs(U,{gutter:24,children:[e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:e.jsx(J,{...c,children:S.length<1&&e.jsxs("div",{children:[e.jsx(Q,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:e.jsx(d.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:e.jsx(d,{placeholder:"Enter contact email"})})}),e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:e.jsx(d,{placeholder:"Enter contact phone number"})})})]})]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(ie,{level:4,children:"Footer Links"}),e.jsx(le,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),e.jsx(t.List,{name:"footerLinks",children:(a,{add:l,remove:w})=>e.jsxs(e.Fragment,{children:[a.map(({key:n,name:m,...h})=>e.jsxs(U,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(o,{span:11,children:e.jsx(t.Item,{...h,name:[m,"label"],rules:[{required:!0,message:"Please enter link label"}],children:e.jsx(d,{placeholder:"Link Label"})})}),e.jsx(o,{span:12,children:e.jsx(t.Item,{...h,name:[m,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:e.jsx(d,{placeholder:"URL (e.g., https://example.com)"})})}),e.jsx(o,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(H,{onClick:()=>w(m)})})]},n)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>l(),block:!0,icon:e.jsx(M,{}),children:"Add Footer Link"})})]})})]})]})},{Title:Z,Text:X}=G,{TabPane:oe}=Y,fe=({form:j})=>e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(Y,{defaultActiveKey:"basic",type:"card",children:[e.jsx(oe,{tab:"Basic Amenities",children:e.jsxs(N,{className:"settings-card",children:[e.jsx(Z,{level:4,children:"Basic Amenities"}),e.jsx(X,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),e.jsx(t.List,{name:"basicAmenities",children:(v,{add:S,remove:u})=>e.jsxs(e.Fragment,{children:[v.map(({key:I,name:c,...a})=>e.jsxs(U,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(o,{span:5,children:e.jsx(t.Item,{...a,name:[c,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(L,{placeholder:"Select type",children:[e.jsx(L.Option,{value:"facility",children:"Facility"}),e.jsx(L.Option,{value:"service",children:"Service"}),e.jsx(L.Option,{value:"equipment",children:"Equipment"}),e.jsx(L.Option,{value:"other",children:"Other"})]})})}),e.jsx(o,{span:6,children:e.jsx(t.Item,{...a,name:[c,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(d,{placeholder:"Enter name (e.g. Tables)"})})}),e.jsx(o,{span:6,children:e.jsx(t.Item,{...a,name:[c,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(d.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(o,{span:3,children:e.jsx(t.Item,{...a,name:[c,"perSqm"],label:e.jsxs(z,{children:["Per sqm",e.jsx(se,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:e.jsx(ne,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:e.jsx(O,{style:{width:"100%"},placeholder:"9",min:1})})}),e.jsx(o,{span:3,children:e.jsx(t.Item,{...a,name:[c,"quantity"],label:e.jsxs(z,{children:["Quantity",e.jsx(se,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:e.jsx(ne,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:e.jsx(O,{style:{width:"100%"},placeholder:"1",min:1})})}),e.jsx(o,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:e.jsx(H,{onClick:()=>u(c)})})]},I)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>S({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:e.jsx(M,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),e.jsx(oe,{tab:"Extra Amenities",children:e.jsxs(N,{className:"settings-card",children:[e.jsx(Z,{level:4,children:"Extra Amenities"}),e.jsx(X,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),e.jsx(t.List,{name:"amenities",children:(v,{add:S,remove:u})=>e.jsxs(e.Fragment,{children:[v.map(({key:I,name:c,...a})=>e.jsxs(U,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(o,{span:5,children:e.jsx(t.Item,{...a,name:[c,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:e.jsxs(L,{placeholder:"Select type",children:[e.jsx(L.Option,{value:"facility",children:"Facility"}),e.jsx(L.Option,{value:"service",children:"Service"}),e.jsx(L.Option,{value:"equipment",children:"Equipment"}),e.jsx(L.Option,{value:"other",children:"Other"})]})})}),e.jsx(o,{span:6,children:e.jsx(t.Item,{...a,name:[c,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:e.jsx(d,{placeholder:"Enter name (e.g. Power)"})})}),e.jsx(o,{span:8,children:e.jsx(t.Item,{...a,name:[c,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:e.jsx(d.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),e.jsx(o,{span:4,children:e.jsx(t.Item,{...a,name:[c,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:e.jsx(O,{style:{width:"100%"},placeholder:"Enter rate",prefix:"₹",min:0,formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>{const w=l?Number(l.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(w)?0:w}})})}),e.jsx(o,{span:1,style:{display:"flex",alignItems:"center"},children:e.jsx(H,{onClick:()=>u(c)})})]},I)),e.jsx(t.Item,{children:e.jsx(F,{type:"dashed",onClick:()=>S({type:"service"}),block:!0,icon:e.jsx(M,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),e.jsxs(N,{className:"settings-card",style:{marginTop:"24px"},children:[e.jsx(Z,{level:4,children:"Special Requirements"}),e.jsx(X,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),e.jsx(U,{gutter:24,children:e.jsx(o,{span:24,children:e.jsx(t.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:e.jsx(d.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),Te=({initialValues:j,onSubmit:v,submitText:S="Submit"})=>{const[u]=t.useForm(),I=a=>{v(a)},c=[{key:"general",label:"General",children:e.jsx(je,{form:u})},{key:"header",label:"Header",children:e.jsx(ye,{form:u})},{key:"footer",label:"Footer",children:e.jsx(be,{form:u})},{key:"amenities",label:"Amenities",children:e.jsx(fe,{form:u})}];return e.jsx(t,{form:u,layout:"vertical",initialValues:j,onFinish:I,style:{height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,marginBottom:"24px"},children:e.jsx(Y,{defaultActiveKey:"general",items:c,type:"card"})}),e.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:e.jsx(F,{type:"primary",htmlType:"submit",children:S})})]})})};export{Te as E};
