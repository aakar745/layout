var xx=Object.defineProperty;var px=(e,t,r)=>t in e?xx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var dd=(e,t,r)=>px(e,typeof t!="symbol"?t+"":t,r);import{j as n}from"./vendor-pdf-BUV7_PsA.js";import{b as mx,c as Os,g as gx,d as et,T as Le,L as an,e as ct,S as ue,f as Se,B as xr,A as Br,h as te,i as ar,j as gc,k as at,l as yx,m as Vt,n as Ni,r as k,o as Xs,p as yc,q as Fi,s as Xr,t as Gt,u as Qr,E as mt,D as nt,v as Vn,w as kt,M as or,x as xu,y as pu,z as lo,C as co,F as Ro,G as yr,H as vt,I as vx,J as _n,K as vc,N as bx,O as wx,P as he,Q as H,U as Jl,V as bc,W as _t,X as jn,Y as Yr,Z as Jr,$ as be,a0 as ho,a1 as uo,a2 as jx,a3 as Ce,a4 as K,a5 as de,a as xt,a6 as Xe,a7 as on,a8 as mu,a9 as Pe,aa as tt,ab as Hr,ac as dn,ad as Ve,ae as Qs,af as Gn,ag as We,ah as wc,ai as un,aj as jc,ak as fs,al as Po,am as gu,an as Yt,ao as Ir,ap as Ri,aq as Sx,ar as Pi,as as fr,at as as,au as Ex,av as kn,aw as Tx,ax as mn,ay as Gi,az as Di,aA as xs,aB as hd,aC as _x,aD as Sc,aE as ps,aF as yt,aG as ns,aH as os,aI as ms,aJ as kx,aK as Cx,aL as Ax,aM as yu,aN as Ix,aO as ud,aP as Nx,aQ as Fx,aR as Rx,aS as vu,aT as Yi,aU as Px,aV as fd,aW as Dx,aX as Lx,aY as Ox,aZ as xd,a_ as bu,a$ as Bx,b0 as Mx,b1 as $x,b2 as Ux,b3 as zx,b4 as qx,b5 as Wx,b6 as Zl,b7 as Hx,b8 as mr,b9 as Vx,ba as Gx,bb as pd,bc as Yx,bd as Kx,be as Xx,bf as Qx,bg as Jx,bh as Zx}from"./vendor-antd-BvnfjvBw.js";import{c as Qe,a as gr,u as Je,b as Me,d as it,e as In,L as Cr,f as Fr,w as md,n as wu,g as ju,i as Li,h as ep,j as Js,k as Su,p as Ec,l as oi,m as fo,o as Tc,q as ls,r as gd,s as tp,S as Eu,t as rl,v as _c,x as Tu,y as rp,z as _u,A as np,B as yd,C as sp,D as ip,E as ap,F as op,G as vi,N as Do,H as lp,I as cp,R as dp,J as Ge,K as hp,P as up}from"./vendor-react-BKuczOpz.js";import{a as Tr}from"./vendor-utils-D85JRr-X.js";import{n as ve,k as Yn}from"./vendor-ui-BBmc9poM.js";import{E as fp}from"./vendor-editor-B_qKlG3f.js";import{L as xo,G as Ys,R as Lo,T as Oi,u as xp,a as pp,I as mp,C as gp,b as yp,c as vp,K as nl,S as bp,F as wp,d as jp}from"./vendor-canvas-CwpfxZ4P.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var ec={},vd=mx;ec.createRoot=vd.createRoot,ec.hydrateRoot=vd.hydrateRoot;const Oo="/api",Ee=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),Qn=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}}),ku=Tr.create({baseURL:Oo,headers:{"Content-Type":"application/json",Accept:"application/json"}});Ee.interceptors.request.use(e=>{var a,o,l,d,c,h,x,u,p;const t=localStorage.getItem("token"),r=localStorage.getItem("exhibitor_token"),s=((a=e.url)==null?void 0:a.startsWith("/bookings/"))&&e.method==="patch"||((o=e.url)==null?void 0:o.includes("/exhibition/"))||((l=e.url)==null?void 0:l.includes("/stalls/"))||((d=e.url)==null?void 0:d.includes("/halls/"))||((c=e.url)==null?void 0:c.includes("/users/"))||((h=e.url)==null?void 0:h.includes("/roles/")),i=((x=e.url)==null?void 0:x.includes("/test-booking"))||((u=e.url)==null?void 0:u.includes("/exhibitor-bookings"))||((p=e.url)==null?void 0:p.startsWith("/exhibitors/"));return s?t?e.headers.Authorization=`Bearer ${t}`:console.warn("Admin token required but not found for:",e.url):i&&r?e.headers.Authorization=`Bearer ${r}`:t?e.headers.Authorization=`Bearer ${t}`:r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));ku.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ee.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});ku.interceptors.response.use(e=>e,e=>{var r,s,i;((r=e.response)==null?void 0:r.status)===401&&localStorage.removeItem("exhibitor_token");const t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message;return Promise.reject(new Error(t))});const Cu=async(e,t=!1,r)=>{const s=t?localStorage.getItem("exhibitor_token"):localStorage.getItem("token");return Tr.get(`${Oo}${e}`,{responseType:"blob",headers:{Authorization:`Bearer ${s}`},onDownloadProgress:r})},po={login:async e=>await Ee.post("/auth/login",e),getProfile:async()=>await Ee.get("/auth/me"),changePassword:async e=>await Ee.post("/auth/change-password",e)},bd=localStorage.getItem("token"),sl=localStorage.getItem("user");let Au=null;try{Au=sl&&sl!=="undefined"?JSON.parse(sl):null}catch(e){console.error("Failed to parse user data from localStorage",e),localStorage.removeItem("user")}const Sp={isAuthenticated:!!bd,user:Au,token:bd,loading:!1,error:null},Ma=Qe("auth/refreshUser",async(e,{rejectWithValue:t})=>{var r,s;try{return(await po.getProfile()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to refresh user data")}}),Iu=gr({name:"auth",initialState:Sp,reducers:{setCredentials:(e,t)=>{e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:e=>{e.addCase(Ma.pending,t=>{t.loading=!0,t.error=null}).addCase(Ma.fulfilled,(t,r)=>{t.loading=!1,t.user=r.payload,localStorage.setItem("user",JSON.stringify(r.payload))}).addCase(Ma.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{setCredentials:Nu,logout:wd}=Iu.actions,Ep=Iu.reducer,fn=Object.create(null);fn.open="0";fn.close="1";fn.ping="2";fn.pong="3";fn.message="4";fn.upgrade="5";fn.noop="6";const $a=Object.create(null);Object.keys(fn).forEach(e=>{$a[fn[e]]=e});const tc={type:"error",data:"parser error"},Fu=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ru=typeof ArrayBuffer=="function",Pu=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,kc=({type:e,data:t},r,s)=>Fu&&t instanceof Blob?r?s(t):jd(t,s):Ru&&(t instanceof ArrayBuffer||Pu(t))?r?s(t):jd(new Blob([t]),s):s(fn[e]+(t||"")),jd=(e,t)=>{const r=new FileReader;return r.onload=function(){const s=r.result.split(",")[1];t("b"+(s||""))},r.readAsDataURL(e)};function Sd(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let il;function Tp(e,t){if(Fu&&e.data instanceof Blob)return e.data.arrayBuffer().then(Sd).then(t);if(Ru&&(e.data instanceof ArrayBuffer||Pu(e.data)))return t(Sd(e.data));kc(e,!1,r=>{il||(il=new TextEncoder),t(il.encode(r))})}const Ed="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gi=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Ed.length;e++)gi[Ed.charCodeAt(e)]=e;const _p=e=>{let t=e.length*.75,r=e.length,s,i=0,a,o,l,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const c=new ArrayBuffer(t),h=new Uint8Array(c);for(s=0;s<r;s+=4)a=gi[e.charCodeAt(s)],o=gi[e.charCodeAt(s+1)],l=gi[e.charCodeAt(s+2)],d=gi[e.charCodeAt(s+3)],h[i++]=a<<2|o>>4,h[i++]=(o&15)<<4|l>>2,h[i++]=(l&3)<<6|d&63;return c},kp=typeof ArrayBuffer=="function",Cc=(e,t)=>{if(typeof e!="string")return{type:"message",data:Du(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:Cp(e.substring(1),t)}:$a[r]?e.length>1?{type:$a[r],data:e.substring(1)}:{type:$a[r]}:tc},Cp=(e,t)=>{if(kp){const r=_p(e);return Du(r,t)}else return{base64:!0,data:e}},Du=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Lu="",Ap=(e,t)=>{const r=e.length,s=new Array(r);let i=0;e.forEach((a,o)=>{kc(a,!1,l=>{s[o]=l,++i===r&&t(s.join(Lu))})})},Ip=(e,t)=>{const r=e.split(Lu),s=[];for(let i=0;i<r.length;i++){const a=Cc(r[i],t);if(s.push(a),a.type==="error")break}return s};function Np(){return new TransformStream({transform(e,t){Tp(e,r=>{const s=r.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,s)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(s))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(r)})}})}let al;function la(e){return e.reduce((t,r)=>t+r.length,0)}function ca(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let s=0;for(let i=0;i<t;i++)r[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function Fp(e,t){al||(al=new TextDecoder);const r=[];let s=0,i=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(s===0){if(la(r)<1)break;const d=ca(r,1);a=(d[0]&128)===128,i=d[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(la(r)<2)break;const d=ca(r,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),s=3}else if(s===2){if(la(r)<8)break;const d=ca(r,8),c=new DataView(d.buffer,d.byteOffset,d.length),h=c.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(tc);break}i=h*Math.pow(2,32)+c.getUint32(4),s=3}else{if(la(r)<i)break;const d=ca(r,i);l.enqueue(Cc(a?d:al.decode(d),t)),s=0}if(i===0||i>e){l.enqueue(tc);break}}}})}const Ou=4;function Dt(e){if(e)return Rp(e)}function Rp(e){for(var t in Dt.prototype)e[t]=Dt.prototype[t];return e}Dt.prototype.on=Dt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Dt.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Dt.prototype.off=Dt.prototype.removeListener=Dt.prototype.removeAllListeners=Dt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var s,i=0;i<r.length;i++)if(s=r[i],s===t||s.fn===t){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Dt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,i=r.length;s<i;++s)r[s].apply(this,t)}return this};Dt.prototype.emitReserved=Dt.prototype.emit;Dt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Dt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Bo=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Dr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Pp="arraybuffer";function Bu(e,...t){return t.reduce((r,s)=>(e.hasOwnProperty(s)&&(r[s]=e[s]),r),{})}const Dp=Dr.setTimeout,Lp=Dr.clearTimeout;function Mo(e,t){t.useNativeTimers?(e.setTimeoutFn=Dp.bind(Dr),e.clearTimeoutFn=Lp.bind(Dr)):(e.setTimeoutFn=Dr.setTimeout.bind(Dr),e.clearTimeoutFn=Dr.clearTimeout.bind(Dr))}const Op=1.33;function Bp(e){return typeof e=="string"?Mp(e):Math.ceil((e.byteLength||e.size)*Op)}function Mp(e){let t=0,r=0;for(let s=0,i=e.length;s<i;s++)t=e.charCodeAt(s),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}function Mu(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function $p(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function Up(e){let t={},r=e.split("&");for(let s=0,i=r.length;s<i;s++){let a=r[s].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class zp extends Error{constructor(t,r,s){super(t),this.description=r,this.context=s,this.type="TransportError"}}class Ac extends Dt{constructor(t){super(),this.writable=!1,Mo(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,s){return super.emitReserved("error",new zp(t,r,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Cc(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=$p(t);return r.length?"?"+r:""}}class qp extends Ac{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||r()})),this.writable||(s++,this.once("drain",function(){--s||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Ip(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Ap(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Mu()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let $u=!1;try{$u=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Wp=$u;function Hp(){}class Vp extends qp{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let s=location.port;s||(s=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,r){const s=this.request({method:"POST",data:t});s.on("success",r),s.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,s)=>{this.onError("xhr poll error",r,s)}),this.pollXhr=t}}let Us=class Ua extends Dt{constructor(t,r,s){super(),this.createRequest=t,Mo(this,s),this._opts=s,this._method=s.method||"GET",this._uri=r,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const r=Bu(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(r);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Ua.requestsCount++,Ua.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Hp,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ua.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Us.requestsCount=0;Us.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Td);else if(typeof addEventListener=="function"){const e="onpagehide"in Dr?"pagehide":"unload";addEventListener(e,Td,!1)}}function Td(){for(let e in Us.requests)Us.requests.hasOwnProperty(e)&&Us.requests[e].abort()}const Gp=function(){const e=Uu({xdomain:!1});return e&&e.responseType!==null}();class Yp extends Vp{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=Gp&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Us(Uu,this.uri(),t)}}function Uu(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Wp))return new XMLHttpRequest}catch{}if(!t)try{return new Dr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const zu=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Kp extends Ac{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,s=zu?{}:Bu(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;kc(s,this.supportsBinary,a=>{try{this.doWrite(s,a)}catch{}i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Mu()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const ol=Dr.WebSocket||Dr.MozWebSocket;class Xp extends Kp{createSocket(t,r,s){return zu?new ol(t,r,s):r?new ol(t,r):new ol(t)}doWrite(t,r){this.ws.send(r)}}class Qp extends Ac{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=Fp(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(r).getReader(),i=Np();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{s.read().then(({done:l,value:d})=>{l||(this.onPacket(d),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const s=t[r],i=r===t.length-1;this._writer.write(s).then(()=>{i&&Bo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Jp={websocket:Xp,webtransport:Qp,polling:Yp},Zp=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,em=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function rc(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),s=e.indexOf("]");r!=-1&&s!=-1&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));let i=Zp.exec(e||""),a={},o=14;for(;o--;)a[em[o]]=i[o]||"";return r!=-1&&s!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=tm(a,a.path),a.queryKey=rm(a,a.query),a}function tm(e,t){const r=/\/{2,9}/g,s=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function rm(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,a){i&&(r[i]=a)}),r}const nc=typeof addEventListener=="function"&&typeof removeEventListener=="function",za=[];nc&&addEventListener("offline",()=>{za.forEach(e=>e())},!1);class zn extends Dt{constructor(t,r){if(super(),this.binaryType=Pp,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const s=rc(t);r.hostname=s.host,r.secure=s.protocol==="https"||s.protocol==="wss",r.port=s.port,s.query&&(r.query=s.query)}else r.host&&(r.hostname=rc(r.host).host);Mo(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(s=>{const i=s.prototype.name;this.transports.push(i),this._transportsByName[i]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Up(this.opts.query)),nc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},za.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Ou,r.transport=t,this.id&&(r.sid=this.id);const s=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&zn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",zn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(r+=Bp(i)),s>0&&r>this._maxPayload)return this.writeBuffer.slice(0,s);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Bo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,s){return this._sendPacket("message",t,r,s),this}send(t,r,s){return this._sendPacket("message",t,r,s),this}_sendPacket(t,r,s,i){if(typeof r=="function"&&(i=r,r=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const a={type:t,data:r,options:s};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},s=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(zn.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),nc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=za.indexOf(this._offlineEventListener);s!==-1&&za.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}zn.protocol=Ou;class nm extends zn{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),s=!1;zn.priorWebsocketSuccess=!1;const i=()=>{s||(r.send([{type:"ping",data:"probe"}]),r.once("packet",x=>{if(!s)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;zn.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function a(){s||(s=!0,h(),r.close(),r=null)}const o=x=>{const u=new Error("probe error: "+x);u.transport=r.name,a(),this.emitReserved("upgradeError",u)};function l(){o("transport closed")}function d(){o("socket closed")}function c(x){r&&x.name!==r.name&&a()}const h=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",l),this.off("close",d),this.off("upgrading",c)};r.once("open",i),r.once("error",o),r.once("close",l),this.once("close",d),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&r.push(t[s]);return r}}let sm=class extends nm{constructor(t,r={}){const s=typeof t=="object"?t:r;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(i=>Jp[i]).filter(i=>!!i)),super(t,s)}};function im(e,t="",r){let s=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),s=rc(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const a=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+a+":"+s.port+t,s.href=s.protocol+"://"+a+(r&&r.port===s.port?"":":"+s.port),s}const am=typeof ArrayBuffer=="function",om=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,qu=Object.prototype.toString,lm=typeof Blob=="function"||typeof Blob<"u"&&qu.call(Blob)==="[object BlobConstructor]",cm=typeof File=="function"||typeof File<"u"&&qu.call(File)==="[object FileConstructor]";function Ic(e){return am&&(e instanceof ArrayBuffer||om(e))||lm&&e instanceof Blob||cm&&e instanceof File}function qa(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,s=e.length;r<s;r++)if(qa(e[r]))return!0;return!1}if(Ic(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return qa(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&qa(e[r]))return!0;return!1}function dm(e){const t=[],r=e.data,s=e;return s.data=sc(r,t),s.attachments=t.length,{packet:s,buffers:t}}function sc(e,t){if(!e)return e;if(Ic(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=sc(e[s],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=sc(e[s],t));return r}return e}function hm(e,t){return e.data=ic(e.data,t),delete e.attachments,e}function ic(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=ic(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=ic(e[r],t));return e}const um=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],fm=5;var Ye;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Ye||(Ye={}));class xm{constructor(t){this.replacer=t}encode(t){return(t.type===Ye.EVENT||t.type===Ye.ACK)&&qa(t)?this.encodeAsBinary({type:t.type===Ye.EVENT?Ye.BINARY_EVENT:Ye.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===Ye.BINARY_EVENT||t.type===Ye.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=dm(t),s=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(s),i}}function _d(e){return Object.prototype.toString.call(e)==="[object Object]"}class Nc extends Dt{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const s=r.type===Ye.BINARY_EVENT;s||r.type===Ye.BINARY_ACK?(r.type=s?Ye.EVENT:Ye.ACK,this.reconstructor=new pm(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Ic(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const s={type:Number(t.charAt(0))};if(Ye[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Ye.BINARY_EVENT||s.type===Ye.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(a,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););s.nsp=t.substring(a,r)}else s.nsp="/";const i=t.charAt(r+1);if(i!==""&&Number(i)==i){const a=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}s.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Nc.isPayloadValid(s.type,a))s.data=a;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case Ye.CONNECT:return _d(r);case Ye.DISCONNECT:return r===void 0;case Ye.CONNECT_ERROR:return typeof r=="string"||_d(r);case Ye.EVENT:case Ye.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&um.indexOf(r[0])===-1);case Ye.ACK:case Ye.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class pm{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=hm(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const mm=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Nc,Encoder:xm,get PacketType(){return Ye},protocol:fm},Symbol.toStringTag,{value:"Module"}));function qr(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const gm=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Wu extends Dt{constructor(t,r,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[qr(t,"open",this.onopen.bind(this)),qr(t,"packet",this.onpacket.bind(this)),qr(t,"error",this.onerror.bind(this)),qr(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var s,i,a;if(gm.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Ye.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,x=r.pop();this._registerAckCallback(h,x),o.id=h}const l=(i=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(d?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((s,i)=>{const a=(o,l)=>o?i(o):s(l);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...a)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ye.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ye.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ye.EVENT:case Ye.BINARY_EVENT:this.onevent(t);break;case Ye.ACK:case Ye.BINARY_ACK:this.onack(t);break;case Ye.DISCONNECT:this.ondisconnect();break;case Ye.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const s of r)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let s=!1;return function(...i){s||(s=!0,r.packet({type:Ye.ACK,id:t,data:i}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ye.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let s=0;s<r.length;s++)if(t===r[s])return r.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const s of r)s.apply(this,t.data)}}}function Zs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Zs.prototype.reset=function(){this.attempts=0};Zs.prototype.setMin=function(e){this.ms=e};Zs.prototype.setMax=function(e){this.max=e};Zs.prototype.setJitter=function(e){this.jitter=e};class ac extends Dt{constructor(t,r){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Mo(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((s=r.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Zs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const i=r.parser||mm;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new sm(this.uri,this.opts);const r=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=qr(r,"open",function(){s.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=qr(r,"error",a);if(this._timeout!==!1){const l=this._timeout,d=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(qr(t,"ping",this.onping.bind(this)),qr(t,"data",this.ondata.bind(this)),qr(t,"error",this.onerror.bind(this)),qr(t,"close",this.onclose.bind(this)),qr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Bo(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new Wu(this,t,r),this.nsps[t]=s),s}_destroy(t){const r=Object.keys(this.nsps);for(const s of r)if(this.nsps[s].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let s=0;s<r.length;s++)this.engine.write(r[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},r);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const li={};function Wa(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=im(e,t.path||"/socket.io"),s=r.source,i=r.id,a=r.path,o=li[i]&&a in li[i].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let d;return l?d=new ac(s,t):(li[i]||(li[i]=new ac(s,t)),d=li[i]),r.query&&!t.query&&(t.query=r.queryKey),d.socket(r.path,t)}Object.assign(Wa,{Manager:ac,Socket:Wu,io:Wa,connect:Wa});const ym=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",sn=ym?"https://aakardata.in/api":"http://localhost:5000/api",vm="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class bm{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(t);r?this.init(r,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(r=>{this.triggerEvent("notification",r)})}}init(t,r=!1){var s;if(!((s=this.socket)!=null&&s.connected&&this.lastToken===t&&this.isExhibitor===r)){this.isExhibitor=r,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const i=sn.replace("/api",""),a=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Wa(i,{auth:{token:a,type:r?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(i){console.error("Error initializing notification socket:",i),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r)}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(s=>s!==r))}triggerEvent(t,r){this.listeners[t]&&this.listeners[t].forEach(s=>{try{s(r)}catch(i){console.error(`Error in notification ${t} listener:`,i)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",r={limit:1,page:1,unreadOnly:!0},s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const a=await Tr.get(t,{baseURL:sn,params:r,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success?(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,r=10,s=!1){try{const i=this.isExhibitor?"notifications/exhibitor":"notifications/admin",a={page:t,limit:r,unreadOnly:s},o=this.isExhibitor?"exhibitor_token":"token",l=localStorage.getItem(o);if(!l)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await Tr.get(i,{baseURL:sn,params:a,headers:{Authorization:`Bearer ${l}`}})).data}catch(i){return console.error("Error fetching notifications:",i),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const r=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,s=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(s);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const a=await Tr.put(r,{},{baseURL:sn,headers:{Authorization:`Bearer ${i}`}});return a.data&&a.data.success&&(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),a.data}catch(r){throw console.error("Error marking notification as read:",r),r}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",r=this.isExhibitor?"exhibitor_token":"token",s=localStorage.getItem(r);if(!s)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const i=await Tr.put(t,{},{baseURL:sn,headers:{Authorization:`Bearer ${s}`}});return i.data&&i.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),i.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const r=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,s=await Tr.delete(r,{baseURL:sn,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(s.data.success)return s.data.data.unreadCount!==void 0&&(this.unreadCount=s.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),s.data;throw new Error("Failed to delete notification")}catch(r){throw console.error("Error deleting notification:",r),r}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",r=await Tr.delete(t,{baseURL:sn,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(r.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),r.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const pt=new bm;var Pt=(e=>(e.NEW_LEAD="New Lead",e.FOLLOWUP_DUE="Follow-up Due",e.STATUS_CHANGE="Status Changed",e.ASSIGNMENT="Lead Assigned",e.NEW_BOOKING="NEW_BOOKING",e.BOOKING_CONFIRMED="BOOKING_CONFIRMED",e.BOOKING_CANCELLED="BOOKING_CANCELLED",e.PAYMENT_RECEIVED="PAYMENT_RECEIVED",e.INVOICE_GENERATED="INVOICE_GENERATED",e.EXHIBITION_UPDATE="EXHIBITION_UPDATE",e.SYSTEM_MESSAGE="SYSTEM_MESSAGE",e.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",e.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",e))(Pt||{}),Bn=(e=>(e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW",e))(Bn||{}),oc=(e=>(e.READ="Read",e.UNREAD="Unread",e))(oc||{}),Hu={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(Os,function(){return function(r,s,i){r=r||{};var a=s.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(c,h,x,u){return a.fromToBase(c,h,x,u)}i.en.relativeTime=o,a.fromToBase=function(c,h,x,u,p){for(var g,f,m,v=x.$locale().relativeTime||o,w=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=w.length,y=0;y<_;y+=1){var b=w[y];b.d&&(g=u?i(c).diff(x,b.d,!0):x.diff(c,b.d,!0));var E=(r.rounding||Math.round)(Math.abs(g));if(m=g>0,E<=b.r||!b.r){E<=1&&y>0&&(b=w[y-1]);var j=v[b.l];p&&(E=p(""+E)),f=typeof j=="string"?j.replace("%d",E):j(E,h,b.l,m);break}}if(h)return f;var S=m?v.future:v.past;return typeof S=="function"?S(f):S.replace("%s",f)},a.to=function(c,h){return l(c,h,this,!0)},a.from=function(c,h){return l(c,h,this)};var d=function(c){return c.$u?i.utc():i()};a.toNow=function(c){return this.to(d(this),c)},a.fromNow=function(c){return this.from(d(this),c)}}})})(Hu);var wm=Hu.exports;const jm=gx(wm);et.extend(jm);const kd=e=>{switch(e){case Bn.HIGH:return"#f5222d";case Bn.MEDIUM:return"#faad14";case Bn.LOW:return"#52c41a";default:return"#1677ff"}},Sm=e=>et(e).fromNow(),Em=e=>et(e).format("YYYY-MM-DD HH:mm"),Tm=e=>e.filter(t=>t.isRead===!1).length,_m=e=>{if(!e.entityId||!e.entityType)return"/notifications";switch(e.entityType){case"lead":return`/leads/${e.entityId}`;case"followup":return`/followups/${e.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${e.entityId}`;case"Exhibition":return`/exhibition/${e.entityId}`;case"Exhibitor":return`/exhibitors?id=${e.entityId}`;default:return"/notifications"}},{Text:Cd,Paragraph:km}=Le,Vu=({notification:e,onView:t,onMarkAsRead:r,onDelete:s})=>{const i=()=>{switch(e.type){case Pt.NEW_LEAD:return n.jsx(Ni,{style:{color:"#1677ff"}});case Pt.FOLLOWUP_DUE:return n.jsx(Vt,{style:{color:"#faad14"}});case Pt.STATUS_CHANGE:return n.jsx(yx,{style:{color:"#722ed1"}});case Pt.ASSIGNMENT:return n.jsx(at,{style:{color:"#52c41a"}});default:return n.jsx(gc,{style:{color:"#1677ff"}})}},a=()=>{e.isRead||r(e),t(e)},o=l=>{l.stopPropagation(),s(e)};return n.jsx(an.Item,{onClick:a,className:e.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:e.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[n.jsx(ct,{title:"Delete notification",children:n.jsx(te,{type:"text",danger:!0,icon:n.jsx(ar,{}),onClick:o,"aria-label":"Delete notification"})})],children:n.jsx(an.Item.Meta,{avatar:n.jsx(xr,{dot:!e.isRead,color:kd(e.priority),children:n.jsx(Br,{icon:i(),size:"large",style:{backgroundColor:"white",border:`1px solid ${kd(e.priority)}`}})}),title:n.jsxs(ue,{children:[n.jsx(Cd,{strong:!0,children:e.title}),!e.isRead&&n.jsx(Se,{color:"blue",children:"New"})]}),description:n.jsxs("div",{children:[n.jsx(km,{ellipsis:{rows:2},style:{marginBottom:4},children:e.message}),n.jsx(ct,{title:Em(e.createdAt),children:n.jsx(Cd,{type:"secondary",style:{fontSize:12},children:Sm(e.createdAt)})})]})})})},{Title:Cm,Text:Mk}=Le,Am=e=>{switch(e){case"NEW_BOOKING":return Pt.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return Pt.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return Pt.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return Pt.NEW_LEAD;default:return Pt.STATUS_CHANGE}},Im=e=>{switch(e){case"HIGH":return Bn.HIGH;case"MEDIUM":return Bn.MEDIUM;case"LOW":return Bn.LOW;default:return Bn.MEDIUM}},Nm=({isExhibitor:e=!1})=>{const t=Je(),[r,s]=k.useState([]),[i,a]=k.useState(!1),[o,l]=k.useState(!1),[d,c]=k.useState(0),[h,x]=k.useState(!1),[u,p]=k.useState("all"),g=k.useRef(null),{isAuthenticated:f,user:m}=Me(D=>D.auth),{isAuthenticated:v}=Me(D=>D.exhibitorAuth||{isAuthenticated:!1}),w=e?v:f,[_,y]=k.useState(!1);k.useEffect(()=>{if(w){const D=e?"exhibitor_token":"token",M=localStorage.getItem(D);if(M){pt.init(M,e),pt.subscribeToNotifications();const J=U=>{c(U),U>0&&!o&&(x(!0),setTimeout(()=>{x(!1)},2e3))},ne=U=>{s(B=>[U,...B])},Z=()=>{y(!0),b()},R=()=>{y(!1)};return pt.addEventListener("unreadCount",J),pt.addEventListener("notification",ne),pt.addEventListener("connected",Z),pt.addEventListener("disconnected",R),b(),()=>{pt.removeEventListener("unreadCount",J),pt.removeEventListener("notification",ne),pt.removeEventListener("connected",Z),pt.removeEventListener("disconnected",R),pt.unsubscribeFromNotifications()}}else console.error(`No ${e?"exhibitor":"admin"} token found in localStorage`)}},[w,e]);const b=async()=>{if(w){a(!0);try{const D=await pt.getNotifications(1,10);D.success&&(s(D.data.notifications),c(D.data.unreadCount))}catch(D){console.error("Error fetching notifications:",D)}finally{a(!1)}}},E=D=>{l(D),D&&(g.current&&g.current.classList.remove("bell-animate"),b())},j=async D=>{if(D.isRead||await S(D),l(!1),D.entityId&&D.entityType){let M="";switch(D.entityType){case"Booking":M=e?`/exhibitor/bookings/${D.entityId}`:"/bookings";break;case"Invoice":M=e?`/exhibitor/invoice/${D.entityId}`:`/invoice/${D.entityId}`;break;case"Exhibition":M=`/exhibition/${D.entityId}`;break;case"Exhibitor":M=`/exhibitors?id=${D.entityId}`;break;default:M=""}t(M||"/notifications")}else t("/notifications")},S=async D=>{try{await pt.markAsRead(D._id),s(r.map(M=>M._id===D._id?{...M,isRead:!0}:M))}catch(M){console.error("Error marking notification as read:",M)}},C=async D=>{try{await pt.deleteNotification(D._id),s(r.filter(M=>M._id!==D._id)),D.isRead||c(M=>Math.max(0,M-1))}catch(M){console.error("Error deleting notification:",M)}},T=()=>{l(!1),t("/notifications")},A=async()=>{try{await pt.markAllAsRead(),s(r.map(D=>({...D,isRead:!0}))),c(0)}catch(D){console.error("Error marking all notifications as read:",D)}},I=async()=>{try{await pt.deleteAllNotifications(),s([]),c(0)}catch(D){console.error("Error deleting all notifications:",D)}},P=()=>u==="unread"?r.filter(D=>!D.isRead):r.slice(0,10),N=D=>{p(D)},q=D=>{var M;return{_id:D._id,recipient:D.recipient,recipientType:D.recipientType||"admin",title:D.title,message:D.message,type:Am(D.type),priority:Im(D.priority),isRead:D.isRead,readAt:D.readAt,entityId:D.entityId,entityType:D.entityType,data:D.data,createdAt:D.createdAt,updatedAt:D.updatedAt||D.createdAt,id:D._id,userId:D.recipient,source:(M=D.data)==null?void 0:M.source,status:D.isRead?oc.READ:oc.UNREAD}},L=n.jsxs("div",{className:"notification-dropdown",children:[n.jsxs("div",{className:"notification-header",children:[n.jsx(Cm,{level:5,style:{margin:0},children:"Notifications"}),n.jsxs(ue,{children:[n.jsx(te,{type:"text",size:"small",icon:n.jsx(Xs,{}),onClick:b,loading:i,className:"header-btn",title:"Refresh notifications"}),n.jsx(te,{type:"text",size:"small",icon:n.jsx(yc,{}),onClick:A,disabled:d===0,className:"header-btn",title:"Mark all as read"}),n.jsx(te,{type:"text",size:"small",danger:!0,icon:n.jsx(ar,{}),onClick:I,disabled:r.length===0,className:"header-btn",title:"Clear all notifications"}),n.jsx(te,{type:"text",size:"small",icon:n.jsx(Fi,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),n.jsx(te,{type:"text",size:"small",icon:n.jsx(Xr,{}),onClick:()=>l(!1),className:"header-btn",title:"Close"})]})]}),n.jsx(Gt,{activeKey:u,onChange:N,size:"small",className:"notification-tabs",items:[{key:"all",label:n.jsx("span",{children:"All"})},{key:"unread",label:n.jsxs("span",{className:"tab-label",children:["Unread",n.jsx(xr,{count:d,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),n.jsx("div",{className:"notification-list",children:n.jsx(Qr,{spinning:i,children:P().length===0?n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:u==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):n.jsx(an,{dataSource:P(),renderItem:D=>n.jsx(Vu,{notification:q(D),onView:()=>j(D),onMarkAsRead:()=>S(D),onDelete:C})})})}),n.jsx(nt,{style:{margin:"0"}}),n.jsx("div",{className:"notification-footer",children:n.jsx(te,{type:"link",onClick:T,children:"View All Notifications"})})]});return n.jsx("div",{ref:g,className:`bell-container ${h?"bell-animate":""}`,children:n.jsx(Vn,{overlay:L,trigger:["click"],open:o,onOpenChange:E,placement:"bottomRight",getPopupContainer:D=>D.parentNode,overlayClassName:"notification-dropdown-overlay",children:n.jsx(xr,{count:d,offset:[-2,10],size:"small",children:n.jsx(gc,{className:"notification-bell-icon"})})})})};class Fm{async getSettings(){return(await Ee.get("/settings")).data}async updateSettings(t){return(await Ee.put("/settings",t)).data}async uploadLogo(t){const r=new FormData;return r.append("file",t),(await Ee.post("/settings/upload/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Fc=new Fm,Rm={settings:null,loading:!1,error:null},bi=Qe("settings/fetchSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Fc.getSettings()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch settings")}}),wi=Qe("settings/updateSettings",async(e,{rejectWithValue:t})=>{var r,s;try{return await Fc.updateSettings(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to update settings")}}),Ha=Qe("settings/uploadLogo",async(e,{dispatch:t,rejectWithValue:r})=>{var s,i;try{const a=await Fc.uploadLogo(e);return a.path&&await t(wi({logo:a.path})),a}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to upload logo")}}),Pm=gr({name:"settings",initialState:Rm,reducers:{},extraReducers:e=>{e.addCase(bi.pending,t=>{t.loading=!0,t.error=null}).addCase(bi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(bi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(wi.pending,t=>{t.loading=!0,t.error=null}).addCase(wi.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(wi.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ha.pending,t=>{t.loading=!0,t.error=null}).addCase(Ha.fulfilled,t=>{t.loading=!1}).addCase(Ha.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),Dm=Pm.reducer,Lm=()=>{const{user:e}=Me(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access")||s.includes("manage_all"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,`${a}`,`${o}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Header:Om,Sider:Bm,Content:Mm}=kt,$m=ve.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,Um=ve.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,zm=ve.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;ve.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const St=({children:e})=>{const[t,r]=k.useState(!1),s=Je(),i=it(),a=In(),o=Me(b=>b.auth.user),{settings:l}=Me(b=>b.settings),[d,c]=k.useState("/logo.png"),[h,x]=k.useState(!1),{hasPermission:u}=Lm(),p=k.useCallback(async()=>{try{x(!0),await i(Ma()).unwrap()}catch{}finally{x(!1)}},[i]);k.useEffect(()=>{const b=setInterval(()=>{p()},3e5);return()=>clearInterval(b)},[p]),k.useEffect(()=>{p()},[a.pathname,p]),k.useEffect(()=>{},[o,u]),k.useEffect(()=>{i(bi())},[i]);const g=[{key:"dashboard",icon:n.jsx(co,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>s("/dashboard")},{key:"exhibition",icon:n.jsx(Ro,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>s("/exhibition")},{key:"stalls",icon:n.jsx(yr,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>s("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>s("/stall-types")}]},{key:"bookings",icon:n.jsx(vt,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>s("/bookings")},{key:"amenities",icon:n.jsx(vx,{}),label:"Amenities",requiredPermission:"view_amenities",onClick:()=>s("/amenities")},{key:"invoices",icon:n.jsx(_n,{}),label:"Invoices",requiredPermission:"view_invoices",onClick:()=>s("/invoices")},{key:"exhibitors",icon:n.jsx(vc,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>s("/exhibitors")},{key:"index",icon:n.jsx(at,{}),label:"Users",requiredPermission:"users_view",onClick:()=>s("/index")},{key:"roles",icon:n.jsx(bx,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>s("/roles")},{key:"settings",icon:n.jsx(Fi,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>s("/settings")}],f=b=>b.filter(E=>{if(E.requiredPermission&&!u(E.requiredPermission))return!1;if(E.children){const j=f(E.children);if(j.length===0)return!1;E.children=j}return!0}),m=f(g),v=b=>b.map(E=>{const{requiredPermission:j,...S}=E;return S.children&&(S.children=v(S.children)),S}),w=v(m);k.useEffect(()=>{const b={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",amenities:"view_amenities",invoices:"view_invoices",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},E=a.pathname.substring(1)||"dashboard",j=b[E];if(j&&!u(j)){const S=m.length>0?m[0]:null;S?s(`/${S.key}`):(i(wd()),s("/login"))}},[a.pathname,u,m,s,i]),k.useEffect(()=>{const b=localStorage.getItem("cachedLogoUrl"),E=localStorage.getItem("logoTimestamp"),j=new Date().getTime();if(b&&E&&j-parseInt(E)<36e5)c(b);else if(l!=null&&l.logo){const S=`${Ee.defaults.baseURL}/public/logo`;c(S),localStorage.setItem("cachedLogoUrl",S),localStorage.setItem("logoTimestamp",j.toString());const C=new Image;C.src=S}},[l]);const _=[{key:"profile",label:"Profile",icon:n.jsx(at,{}),onClick:()=>s("/account")},{key:"settings",label:"Settings",icon:n.jsx(Fi,{}),onClick:()=>s("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(lo,{}),onClick:()=>{i(wd()),s("/login")}}],y=()=>{const b=a.pathname.substring(1);return b.charAt(0).toUpperCase()+b.slice(1)};return n.jsxs(kt,{style:{minHeight:"100vh"},children:[n.jsxs(Bm,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsx($m,{children:n.jsx(Um,{children:n.jsx(zm,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})}),n.jsx(or,{mode:"inline",selectedKeys:[a.pathname.substring(1)||"dashboard"],items:w,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(kt,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Om,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(te,{type:"text",icon:t?n.jsx(xu,{}):n.jsx(pu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:y()})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("div",{style:{marginRight:20},children:n.jsx(Nm,{isExhibitor:!1})}),n.jsx(Vn,{menu:{items:_},placement:"bottomRight",children:n.jsxs(ue,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Br,{size:"small",icon:n.jsx(at,{}),style:{backgroundColor:"#5046e5"}}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.username)||"User"})]})})]})]}),n.jsx(Mm,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},Ad=localStorage.getItem("exhibitor_token"),qm=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,Wm={isAuthenticated:!!Ad,exhibitor:qm,token:Ad,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},Gu=gr({name:"exhibitorAuth",initialState:Wm,reducers:{setExhibitorCredentials:(e,t)=>{e.exhibitor=t.payload.exhibitor,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:e=>{e.exhibitor=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(e,t)=>{e.showLoginModal=!0,e.showForgotPasswordModal=!1,e.loginContext=t.payload||null},hideLoginModal:e=>{e.showLoginModal=!1,e.loginContext=null},showForgotPasswordModal:e=>{e.showForgotPasswordModal=!0,e.showLoginModal=!1},hideForgotPasswordModal:e=>{e.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:lc,exhibitorLogout:Yu,showLoginModal:cs,hideLoginModal:da,showForgotPasswordModal:Hm,hideForgotPasswordModal:ll}=Gu.actions,Vm=Gu.reducer,{Header:Gm,Sider:Ym,Content:Km}=kt,js=({children:e})=>{var x;const[t,r]=k.useState(!1),s=Je(),i=it(),a=In(),o=Me(u=>u.exhibitorAuth.exhibitor),l=()=>{const u=a.pathname;return u.includes("/exhibitor/dashboard")?"dashboard":u.includes("/exhibitor/bookings")?"bookings":u.includes("/exhibitor/profile")?"profile":u.includes("/exhibitions")?"exhibitions":u.includes("/exhibitor/support")?"help":"dashboard"},d=[{key:"dashboard",icon:n.jsx(co,{}),label:"Dashboard",onClick:()=>s("/exhibitor/dashboard")},{key:"bookings",icon:n.jsx(yr,{}),label:"My Bookings",onClick:()=>s("/exhibitor/bookings")},{key:"profile",icon:n.jsx(at,{}),label:"My Profile",onClick:()=>s("/exhibitor/profile")},{key:"exhibitions",icon:n.jsx(_n,{}),label:"Exhibitions",onClick:()=>s("/exhibitions")},{key:"help",icon:n.jsx(wx,{}),label:"Help & Support",onClick:()=>s("/exhibitor/support")}],c=[{key:"profile",label:"My Profile",icon:n.jsx(at,{}),onClick:()=>s("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:n.jsx(yr,{}),onClick:()=>s("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(lo,{}),onClick:()=>{i(Yu()),s("/")}}],h=()=>{const u=a.pathname.replace("/exhibitor/","");return u==="dashboard"?"Dashboard":u.startsWith("bookings")?u.includes("/")?"Booking Details":"My Bookings":u==="profile"?"My Profile":u==="support"?"Help & Support":u.charAt(0).toUpperCase()+u.slice(1)};return n.jsxs(kt,{style:{minHeight:"100vh"},children:[n.jsxs(Ym,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[n.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&n.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),n.jsx(or,{mode:"inline",selectedKeys:[l()],items:d,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(kt,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(Gm,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(te,{type:"text",icon:t?n.jsx(xu,{}):n.jsx(pu,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:h()})]}),n.jsx(Vn,{menu:{items:c},placement:"bottomRight",children:n.jsxs(ue,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Br,{size:"small",style:{backgroundColor:"#5046e5"},children:((x=o==null?void 0:o.companyName)==null?void 0:x.charAt(0).toUpperCase())||"E"}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.companyName)||"Exhibitor"})]})})]}),n.jsx(Km,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},{Title:Ku,Text:ci,Paragraph:Xm}=Le,Ki=Yn`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,Qm=Yn`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,Jm=Yn`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Rc=Yn`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,Xu=Yn`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,Zm=Yn`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,eg=Yn`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,tg=Yn`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,rg=ve.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,ng=ve.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${Qm} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,sg=ve.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${e=>.1+e.index%3*.05}), transparent);
  left: ${e=>20+e.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${e=>e.isHovered?Zm:eg} ${e=>1.5+e.index*.2}s ease-out;
  animation-delay: ${e=>e.index*.1}s;
  animation-fill-mode: forwards;
`,ig=ve.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${Jm} 0.8s ease-out forwards;
`,ag=ve.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,og=ve.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${tg} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Rc} 2s ease-in-out infinite;
  }
`,lg=ve.span`
  margin-left: 10px;
  animation: ${Ki} 0.5s ease-out;
`,cg=ve.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,dg=ve.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,hg=ve.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${Ki} 0.8s ease-out forwards;
`,ug=ve.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,fg=ve.img`
  width: 140px;
  height: auto;
  animation: ${Xu} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;ve.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const xg=ve.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${Ki} 0.8s ease-out forwards;
`,pg=ve.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,mg=ve(Ku)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,gg=ve(Xm)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,yg=ve.div`
  width: 100%;
  max-width: 400px;
  animation: ${Ki} 0.6s ease-out;
`,vg=ve(he)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,bg=ve(he.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,wg=ve(te)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Rc} 0.5s ease-in-out;
  }
`,jg=ve.div`
  margin-bottom: 2rem;
  text-align: center;
`,ha=ve(H.Item)`
  margin-bottom: 24px;
`,Sg=ve.div`
  margin-top: 8px;
`,Eg=ve.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,Tg=ve(Jl)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,_g=ve.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${Ki} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Rc} 0.5s ease-in-out;
  }
`,Id=()=>n.jsxs(ag,{children:[n.jsxs(og,{viewBox:"0 0 50 50",children:[n.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),n.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),n.jsx(lg,{children:"Signing in..."})]}),kg=ve.div`
  position: absolute;
  width: ${e=>e.size}px;
  height: ${e=>e.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${Xu} ${e=>e.duration}s ease-in-out infinite;
  animation-delay: ${e=>e.delay}s;
  top: ${e=>e.top}%;
  left: ${e=>e.left}%;
  z-index: 1;
`,Cg=e=>{if(!e)return 0;const t=e.length>=8,r=/[A-Z]/.test(e),s=/[a-z]/.test(e),i=/\d/.test(e),a=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e),o=[t,r,s,i,a];return o.filter(d=>d).length/o.length*100},Ag=e=>e<30?"#ff4d4f":e<60?"#faad14":e<80?"#1890ff":"#52c41a",Ig=e=>e<30?"Weak":e<60?"Fair":e<80?"Good":"Strong",Ng=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],Fg=()=>{const e=Je(),t=it(),[r,s]=k.useState(null),[i,a]=k.useState(!1),[o,l]=k.useState(!1),[d,c]=k.useState(""),[h,x]=k.useState(!1),u=Me(D=>D.auth.isAuthenticated),p=k.useRef(null),[g,f]=k.useState({x:0,y:0}),[m,v]=k.useState(!1),[w,_]=k.useState(!1),[y]=H.useForm(),[b,E]=k.useState("/logo.png"),[j,S]=k.useState("EXHIBITION MANAGER");k.useEffect(()=>{const D=localStorage.getItem("cachedLogoUrl"),M=localStorage.getItem("logoTimestamp"),J=new Date().getTime();if(D&&M&&J-parseInt(M)<36e5)E(D);else{const ne=`${Ee.defaults.baseURL}/public/logo`;E(ne),localStorage.setItem("cachedLogoUrl",ne),localStorage.setItem("logoTimestamp",J.toString());const Z=new Image;Z.src=ne}fetch(`${Ee.defaults.baseURL}/public/site-info`).then(ne=>ne.json()).then(ne=>{ne.siteName&&S(ne.siteName)}).catch(ne=>{console.error("Error fetching site info:",ne)})},[]),k.useEffect(()=>{const D=localStorage.getItem("rememberedUser");if(D)try{const M=JSON.parse(D);y.setFieldsValue({username:M.username,password:M.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[y]),k.useEffect(()=>{const D=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(D)},[]),k.useEffect(()=>{u&&e("/dashboard")},[u,e]),k.useEffect(()=>{const D=M=>{if(p.current){const J=p.current.getBoundingClientRect(),ne=M.clientX-J.left,Z=M.clientY-J.top;ne>=0&&ne<=J.width&&Z>=0&&Z<=J.height&&f({x:ne,y:Z})}};return window.addEventListener("mousemove",D),()=>{window.removeEventListener("mousemove",D)}},[]);const C=async D=>{var M;try{s(null),a(!0);const J=await po.login({username:D.username,password:D.password}),{user:ne,token:Z}=J.data;if(!ne||!Z)throw new Error("Invalid response from server");D.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:D.username,password:D.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),l(!0),setTimeout(()=>{t(Nu({user:ne,token:Z})),be.success("Login successful!"),e("/dashboard")},1200)}catch(J){console.error("Login Error:",J),console.error("Response Data:",(M=J.response)==null?void 0:M.data);let ne="Authentication Error",Z="Invalid username or password.";if(J.response&&typeof J.response=="object"){const{status:R,data:U}=J.response;R===401?(ne="Invalid Credentials",Z="The username or password you entered is incorrect."):R===403?(ne="Access Denied",Z="You do not have permission to access this resource."):R===400?(ne="Invalid Request",Z="Please check your input and try again."):R===500&&(ne="Server Error",Z="A server error occurred. Please try again later."),U&&typeof U=="object"&&U.message&&(Z=U.message)}else J.request?(ne="Connection Error",Z="Unable to connect to the server. Please check your internet connection."):J.message&&(Z=J.message);s({title:ne,message:Z})}finally{a(!1)}},T=Cg(d),A=Ag(T),I=Ig(T),P=localStorage.getItem("rememberUser")==="true";if(u)return n.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[n.jsx(Id,{}),n.jsx(ci,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const N=D=>{const M=[];for(let J=0;J<D;J++){const ne=Math.random()*20+8,Z=Math.random()*3,R=Math.random()*10+6,U=Math.random()*100,B=Math.random()*100;M.push(n.jsx(kg,{size:ne,delay:Z,duration:R,top:U,left:B,style:{transform:`translate(${g.x/50*(J%5-2)}px, ${g.y/50*(J%5-2)}px)`,opacity:w?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},J))}return M},q=D=>{const M=[];for(let J=0;J<D;J++)M.push(n.jsx(sg,{index:J,isHovered:w},J));return M},L=D=>{_(D)};return n.jsxs(rg,{style:{opacity:m?1:0,transition:"opacity 0.3s ease-out"},children:[o&&n.jsx(_g,{children:n.jsx(bc,{})}),n.jsxs(ng,{onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),children:[n.jsx(hg,{children:n.jsx(ug,{children:n.jsx(fg,{src:b,alt:"Exhibition Manager Logo",onError:()=>E("/logo.png")})})}),n.jsxs(cg,{ref:p,children:[N(12),q(8)]}),n.jsxs(dg,{children:[n.jsx(xg,{children:n.jsx(pg,{children:j})}),n.jsx(mg,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),n.jsx(gg,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),n.jsx(ig,{children:n.jsxs(yg,{children:[n.jsxs(jg,{children:[n.jsx(Ku,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),n.jsx(ci,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),r&&n.jsx(_t,{message:r.title,description:r.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:n.jsx(te,{size:"small",type:"text",onClick:()=>s(null),children:"Dismiss"})}),n.jsxs(H,{form:y,name:"login",initialValues:{remember:P},onFinish:C,layout:"vertical",children:[n.jsx(ha,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:n.jsx(vg,{prefix:n.jsx(at,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:i,autoComplete:"username"})}),n.jsx(ha,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:h&&n.jsxs(Sg,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[n.jsx(ci,{type:"secondary",children:"Password Strength:"}),n.jsx(ci,{strong:!0,style:{color:A},children:I})]}),n.jsx(Yr,{percent:T,showInfo:!1,strokeColor:A,size:"small"}),n.jsx("div",{style:{marginTop:"8px"},children:n.jsx(ct,{title:n.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:Ng.map((D,M)=>n.jsx("li",{children:D},M))}),children:n.jsxs(ci,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx(Jr,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:n.jsx(bg,{prefix:n.jsx(jn,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:i,autoComplete:"current-password",onChange:D=>c(D.target.value),onFocus:()=>x(!0),onBlur:()=>x(!1)})}),n.jsx(Eg,{children:n.jsx(ha,{name:"remember",valuePropName:"checked",noStyle:!0,children:n.jsx(Tg,{children:"Remember me"})})}),n.jsx(ha,{children:i?n.jsx(Id,{}):n.jsx(wg,{type:"primary",htmlType:"submit",block:!0,className:o?"success":"",children:"Sign in"})})]})]})})]})},Qu={getDashboardStats:async()=>{try{const t=(await Ee.get("/users")).data||[],s=(await Ee.get("/bookings")).data||[],a=(await Ee.get("/exhibitions")).data||[],o=s.filter(c=>c.status==="confirmed"||c.status==="approved").reduce((c,h)=>c+(h.amount||0),0),l=[...s].sort((c,h)=>new Date(h.createdAt).getTime()-new Date(c.createdAt).getTime()).slice(0,5),d=[...t].sort((c,h)=>new Date(h.createdAt||0).getTime()-new Date(c.createdAt||0).getTime()).slice(0,5);return{userCount:t.length,bookingCount:s.length,totalRevenue:o,exhibitionCount:a.length,recentBookings:l,recentUsers:d}}catch(e){return console.error("Error fetching dashboard stats:",e),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:e,recentUsers:t}=await Qu.getDashboardStats();return[...e.map(s=>({id:s._id,type:"booking",title:`New booking ${s._id.substring(0,8)}`,timestamp:s.createdAt,data:s})),...t.map(s=>({id:s._id,type:"user",title:`User ${s.username||"unknown"}`,timestamp:s.createdAt,data:s}))].sort((s,i)=>new Date(i.timestamp).getTime()-new Date(s.timestamp).getTime())}catch(e){return console.error("Error fetching recent activities:",e),[]}}},{Title:Rg,Text:sr}=Le,Pg=({title:e,value:t,icon:r,color:s,gradient:i,loading:a})=>n.jsxs(de,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:i,border:"none",overflow:"hidden",position:"relative"},children:[n.jsx("div",{className:"stat-card-background"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[n.jsx(sr,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:e}),n.jsx(sr,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:a?n.jsx(Qr,{size:"small"}):t})]}),n.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:r})]})]}),Dg=()=>{const[e,t]=k.useState(!0),[r,s]=k.useState(0),[i,a]=k.useState(0),[o,l]=k.useState(0),[d,c]=k.useState(0),[h,x]=k.useState([]),[u,p]=k.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});k.useEffect(()=>{(async()=>{t(!0);try{const m=await Qu.getDashboardStats();s(m.userCount),a(m.bookingCount),l(m.totalRevenue),c(m.exhibitionCount);const v=[];m.recentBookings.slice(0,3).forEach(w=>{v.push({id:w._id,icon:n.jsx(ho,{}),color:"#2563EB",text:n.jsxs(sr,{children:["New booking ",n.jsxs(sr,{strong:!0,children:["#",w._id.substring(0,8)]})," received"]}),timestamp:new Date(w.createdAt).toLocaleString()})}),m.recentUsers.slice(0,2).forEach(w=>{v.push({id:w._id,icon:n.jsx(at,{}),color:"#7C3AED",text:n.jsxs(sr,{children:["User ",n.jsxs(sr,{strong:!0,children:["'",w.username,"'"]})," ",w.createdAt?"registered":"active"]}),timestamp:w.createdAt?new Date(w.createdAt).toLocaleString():"Recently"})}),v.sort((w,_)=>new Date(_.timestamp).getTime()-new Date(w.timestamp).getTime()),x(v)}catch(m){console.error("Error fetching dashboard data:",m)}finally{t(!1)}})()},[]);const g=[{title:"Total Users",value:r,icon:n.jsx(at,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:i,icon:n.jsx(ho,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`₹${o.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:n.jsx(uo,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:d,icon:n.jsx(jx,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx(Rg,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),n.jsx(Ce,{gutter:[24,24],children:g.map((f,m)=>n.jsx(K,{xs:24,sm:12,lg:6,children:n.jsx(Pg,{...f,loading:e})},m))}),n.jsxs(Ce,{gutter:[24,24],style:{marginTop:"24px"},children:[n.jsx(K,{xs:24,lg:12,children:n.jsx(de,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:e,children:h.length>0?n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:h.map(f=>n.jsxs("div",{className:"activity-item",children:[xt.cloneElement(f.icon,{style:{color:f.color}}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[f.text,n.jsx(sr,{type:"secondary",style:{fontSize:"12px"},children:f.timestamp})]})]},f.id))}):n.jsx(sr,{type:"secondary",children:"No recent activity found"})})}),n.jsx(K,{xs:24,lg:12,children:n.jsx(de,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator online"}),n.jsxs(sr,{children:["Server Status: ",n.jsx(sr,{strong:!0,type:"success",children:u.server})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator connected"}),n.jsxs(sr,{children:["Database Status: ",n.jsx(sr,{strong:!0,type:"success",children:u.database})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator backup"}),n.jsxs(sr,{children:["Last Backup: ",n.jsx(sr,{strong:!0,children:u.lastBackup})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator normal"}),n.jsxs(sr,{children:["System Load: ",n.jsx(sr,{strong:!0,children:u.systemLoad})]})]})]})})})]})]})},Ar={getExhibitions:()=>Qn.get("/public/exhibitions"),getExhibition:e=>Qn.get(`/public/exhibitions/${e}`),getLayout:e=>Qn.get(`/public/exhibitions/${e}/layout`),getStallDetails:(e,t)=>Qn.get(`/public/exhibitions/${e}/stalls/${t}`),bookStall:(e,t,r)=>Qn.post(`/public/exhibitions/${e}/stalls/${t}/book`,r),bookMultipleStalls:(e,t)=>Qn.post(`/public/exhibitions/${e}/stalls/book-multiple`,t),searchExhibitors:e=>Qn.get("/public/exhibitors/search",{params:{query:e}}),exhibitorBookStalls:e=>Ee.post(`/exhibitor-bookings/${e.exhibitionId}`,e),getExhibitorBookings:()=>Ee.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:e=>Ee.get(`/exhibitor-bookings/${e}`),cancelExhibitorBooking:e=>Ee.patch(`/exhibitor-bookings/${e}/cancel`),getExhibitorBookingInvoice:e=>Ee.get(`/exhibitor-bookings/${e}/invoice`)},{Title:Lg,Text:gn,Paragraph:$k}=Le,Og=()=>{const[e,t]=k.useState([]),[r,s]=k.useState(!0),[i,a]=k.useState(null),[o,l]=k.useState([]),[d,c]=k.useState(!0),h=Me(y=>y.exhibitorAuth.exhibitor),x=Je();k.useEffect(()=>{u(),p()},[]);const u=async()=>{try{s(!0),a(null);const y=await Ar.getExhibitorBookings();t(y.data||[])}catch(y){console.error("Failed to fetch bookings:",y),a("Unable to load your bookings at this time. Please try again later.")}finally{s(!1)}},p=async()=>{try{c(!0);const y=await Ar.getExhibitions(),b=et(),E=(y.data||[]).filter(j=>j.isActive&&et(j.endDate).isAfter(b)).slice(0,3);l(E)}catch(y){console.error("Failed to fetch upcoming exhibitions:",y)}finally{c(!1)}},g=e.filter(y=>y.status==="approved").length,f=e.filter(y=>y.status==="pending").length;e.filter(y=>y.status==="rejected").length;const m=e.filter(y=>y.status==="confirmed").length,v=y=>{switch(y){case"approved":return n.jsxs(Se,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Se,{color:"warning",children:[n.jsx(Vt,{})," Pending"]});case"rejected":return n.jsxs(Se,{color:"error",children:[n.jsx(Xr,{})," Rejected"]});case"confirmed":return n.jsxs(Se,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsxs(Se,{color:"default",children:[n.jsx(Xr,{})," Cancelled"]});default:return n.jsx(Se,{children:"Unknown"})}},w=y=>{x(`/exhibitor/invoice/${y}`)},_=(y,b)=>y.status===b;return n.jsxs("div",{children:[n.jsxs(Lg,{level:2,children:["Welcome, ",(h==null?void 0:h.companyName)||"Exhibitor"]}),n.jsx(gn,{type:"secondary",children:"Here's an overview of your exhibition activities"}),i&&n.jsx(_t,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),f>0&&n.jsx(_t,{message:"Pending Approvals",description:`You have ${f} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(te,{size:"small",type:"primary",onClick:()=>x("/exhibitor/bookings"),children:"View Bookings"})}),n.jsxs(Ce,{gutter:[24,24],style:{marginTop:24},children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Total Bookings",value:r?"-":e.length,prefix:n.jsx(yr,{}),loading:r})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Confirmed",value:r?"-":m,valueStyle:{color:"#1890ff"},prefix:n.jsx(vt,{}),loading:r})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Approved",value:r?"-":g,valueStyle:{color:"#3f8600"},prefix:n.jsx(vt,{}),loading:r})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Pending",value:r?"-":f,valueStyle:{color:"#faad14"},prefix:n.jsx(Vt,{}),loading:r})})})]}),n.jsx(de,{title:"Recent Bookings",extra:n.jsx(Cr,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:r,children:r?n.jsx(on,{active:!0,paragraph:{rows:3}}):e.length>0?n.jsx(an,{dataSource:e.slice(0,5),renderItem:y=>{var b,E,j,S,C;return n.jsxs(an.Item,{actions:[n.jsx(te,{type:"link",onClick:()=>x(`/exhibitor/bookings/${y._id}`),children:"View Details"},"view"),_(y,"approved")||_(y,"confirmed")?n.jsx(te,{type:"link",icon:n.jsx(mu,{}),onClick:()=>w(y._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[n.jsx(an.Item.Meta,{title:n.jsxs("div",{children:[n.jsx(gn,{strong:!0,children:((b=y.exhibitionId)==null?void 0:b.name)||"Exhibition"}),n.jsxs(gn,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((E=y.stallIds)==null?void 0:E.map(T=>T.number).join(", "))||"N/A"]})]}),description:n.jsxs(ue,{direction:"vertical",size:1,children:[n.jsxs("div",{children:[n.jsxs(gn,{children:["Booked on: ",et(y.createdAt).format("MMM D, YYYY")]}),n.jsx(nt,{type:"vertical"}),n.jsxs(gn,{children:["Amount: ₹",((j=y.amount)==null?void 0:j.toLocaleString())||"N/A"]})]}),n.jsx("div",{children:n.jsxs(gn,{children:["Exhibition date: ",et((S=y.exhibitionId)==null?void 0:S.startDate).format("MMM D")," - ",et((C=y.exhibitionId)==null?void 0:C.endDate).format("MMM D, YYYY")]})})]})}),v(y.status)]})}}):n.jsx(mt,{description:"No bookings found",image:mt.PRESENTED_IMAGE_SIMPLE})}),n.jsx(de,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:d,extra:n.jsx(Cr,{to:"/exhibitions",children:"View All"}),children:d?n.jsx(on,{active:!0,paragraph:{rows:3}}):o.length>0?n.jsx(an,{dataSource:o,renderItem:y=>n.jsx(an.Item,{actions:[n.jsx(te,{type:"primary",onClick:()=>x(`/exhibitions/${y._id}/layout`),children:"Book Stall"},"book")],children:n.jsx(an.Item.Meta,{title:y.name,description:n.jsxs(ue,{direction:"vertical",size:1,children:[n.jsx(gn,{children:y.venue}),n.jsxs(gn,{type:"secondary",children:[et(y.startDate).format("MMM D")," - ",et(y.endDate).format("MMM D, YYYY")]})]})})})}):n.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[n.jsx(_n,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),n.jsxs("div",{children:[n.jsx(gn,{children:"No upcoming exhibitions at the moment"}),n.jsx("div",{style:{marginTop:16},children:n.jsx(Cr,{to:"/exhibitions",children:n.jsx(te,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),n.jsx(Ce,{gutter:[24,24],style:{marginTop:24},children:n.jsx(K,{span:24,children:n.jsx(de,{title:"Quick Actions",children:n.jsxs(Ce,{gutter:[16,16],children:[n.jsx(K,{xs:24,sm:12,md:8,lg:6,children:n.jsx(te,{type:"primary",icon:n.jsx(yr,{}),block:!0,onClick:()=>x("/exhibitions"),children:"Book New Stall"})}),n.jsx(K,{xs:24,sm:12,md:8,lg:6,children:n.jsx(te,{icon:n.jsx(_n,{}),block:!0,onClick:()=>x("/exhibitor/bookings"),children:"View All Bookings"})}),n.jsx(K,{xs:24,sm:12,md:8,lg:6,children:n.jsx(te,{icon:n.jsx(uo,{}),block:!0,onClick:()=>x("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),n.jsx(K,{xs:24,sm:12,md:8,lg:6,children:n.jsx(te,{icon:n.jsx(at,{}),block:!0,onClick:()=>x("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},{Title:Bg,Text:Pn}=Le,{Option:Uk}=Pe,{TabPane:Ss}=Gt,{confirm:Mg}=Ve,{Search:$g}=he,Ug=()=>{const[e,t]=k.useState([]),[r,s]=k.useState(!0),[i,a]=k.useState(null),[o,l]=k.useState(""),[d,c]=k.useState("all"),h=Je(),x=In();k.useEffect(()=>{u()},[]),k.useEffect(()=>{const A=new URLSearchParams(x.search).get("status");A&&c(A)},[x]);const u=async()=>{try{s(!0),a(null);const T=await Ar.getExhibitorBookings();t(T.data||[])}catch(T){console.error("Error fetching bookings:",T),a("Failed to load bookings. Please try again.")}finally{s(!1)}},p=T=>{Mg({title:"Are you sure you want to cancel this booking?",icon:n.jsx(Qs,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await Ar.cancelExhibitorBooking(T),be.success("Booking cancelled successfully"),u()}catch(A){console.error("Error cancelling booking:",A),be.error("Failed to cancel booking")}}})},g=T=>{switch(T){case"approved":return n.jsxs(Se,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Se,{color:"warning",children:[n.jsx(Vt,{})," Pending"]});case"rejected":return n.jsxs(Se,{color:"error",children:[n.jsx(Xr,{})," Rejected"]});case"confirmed":return n.jsxs(Se,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsxs(Se,{color:"default",children:[n.jsx(Xr,{})," Cancelled"]});default:return n.jsx(Se,{children:"Unknown"})}},f=T=>{switch(T){case"paid":return n.jsxs(Se,{color:"success",children:[n.jsx(uo,{})," Paid"]});case"pending":return n.jsxs(Se,{color:"warning",children:[n.jsx(Vt,{})," Pending"]});case"refunded":return n.jsxs(Se,{color:"default",children:[n.jsx(uo,{})," Refunded"]});default:return n.jsx(Se,{children:"Unknown"})}},m=async T=>{try{h(`/exhibitor/invoice/${T}`)}catch(A){console.error("Error navigating to invoice:",A),be.error("Failed to access invoice. Please try again.")}},v=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(T,A)=>{var I,P;return n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx(Pn,{strong:!0,children:((I=A.exhibitionId)==null?void 0:I.name)||"N/A"}),n.jsx(Pn,{type:"secondary",style:{fontSize:"12px"},children:((P=A.exhibitionId)==null?void 0:P.venue)||"N/A"})]})},sorter:(T,A)=>{var I,P;return(((I=T.exhibitionId)==null?void 0:I.name)||"").localeCompare(((P=A.exhibitionId)==null?void 0:P.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:T=>n.jsx(ue,{direction:"vertical",size:4,children:(T==null?void 0:T.map(A=>n.jsx(Se,{children:A.number},A._id)))||"N/A"})},{title:"Type",key:"stallType",render:(T,A)=>{var I;return n.jsx(ue,{direction:"vertical",size:4,children:((I=A.stallIds)==null?void 0:I.map(P=>{var N;return(N=P.stallTypeId)!=null&&N.name?n.jsx(Se,{color:"blue",children:P.stallTypeId.name},P._id):n.jsx(Pn,{type:"secondary",children:"N/A"},P._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(T,A)=>{var I;return n.jsx(ue,{direction:"vertical",size:4,children:((I=A.stallIds)==null?void 0:I.map(P=>n.jsxs(Pn,{children:[P.dimensions.width,"m x ",P.dimensions.height,"m"]},P._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(T,A)=>{var I,P;return n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsxs(Pn,{children:[n.jsx(Hr,{style:{marginRight:4}}),et((I=A.exhibitionId)==null?void 0:I.startDate).format("MMM D")," - ",et((P=A.exhibitionId)==null?void 0:P.endDate).format("MMM D, YYYY")]}),n.jsxs(Pn,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",et(A.createdAt).format("MMM D, YYYY")]})]})},sorter:(T,A)=>et(T.createdAt).unix()-et(A.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:T=>n.jsxs(Pn,{strong:!0,children:["₹",T.toLocaleString()]}),sorter:(T,A)=>T.amount-A.amount},{title:"Status",key:"status",dataIndex:"status",render:(T,A)=>T==="rejected"&&A.rejectionReason?n.jsxs(ct,{title:A.rejectionReason,children:[g(T),n.jsx(Jr,{style:{marginLeft:4,color:"#ff4d4f"}})]}):g(T),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(T,A)=>A.status===T},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:T=>f(T),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(T,A)=>A.paymentStatus===T},{title:"Actions",key:"actions",render:(T,A)=>n.jsxs(ue,{children:[n.jsx(te,{type:"link",icon:n.jsx(dn,{}),onClick:()=>h(`/exhibitor/bookings/${A._id}`),children:"Details"}),(A.status==="approved"||A.status==="confirmed")&&n.jsx(te,{type:"link",icon:n.jsx(mu,{}),onClick:()=>m(A._id),children:"Invoice"}),A.status==="pending"&&n.jsx(te,{type:"link",danger:!0,onClick:()=>p(A._id),children:"Cancel"})]})}],w=T=>{l(T)},_=e.filter(T=>{var P,N;const A=(((P=T.exhibitionId)==null?void 0:P.name)||"").toLowerCase().includes(o.toLowerCase())||T.stallIds.some(q=>q.number.toLowerCase().includes(o.toLowerCase()))||(((N=T.exhibitionId)==null?void 0:N.venue)||"").toLowerCase().includes(o.toLowerCase())||(T.customerName||"").toLowerCase().includes(o.toLowerCase()),I=d==="all"||T.status===d;return A&&I}),y=()=>e.length,b=()=>e.filter(T=>T.status==="pending").length,E=()=>e.filter(T=>T.status==="approved").length,j=()=>e.filter(T=>T.status==="confirmed").length,S=()=>e.filter(T=>T.status==="rejected").length,C=()=>e.filter(T=>T.status==="cancelled").length;return n.jsxs("div",{children:[n.jsx(Bg,{level:2,children:"My Bookings"}),n.jsx(Pn,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),i&&n.jsx(_t,{message:"Error",description:i,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(te,{type:"primary",onClick:u,children:"Retry"})}),n.jsxs(de,{style:{marginTop:24},children:[n.jsxs(Ce,{gutter:[16,16],style:{marginBottom:16},children:[n.jsx(K,{flex:"auto",children:n.jsx($g,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:w,onChange:T=>l(T.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),n.jsx(K,{children:n.jsx(te,{icon:n.jsx(Xs,{}),onClick:u,children:"Refresh"})})]}),n.jsxs(Gt,{defaultActiveKey:d,onChange:T=>c(T),children:[n.jsx(Ss,{tab:`All Bookings (${y()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):_.length>0?n.jsx(tt,{columns:v,dataSource:_,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):n.jsx(mt,{description:o?"No bookings match your search criteria":"No bookings found",image:mt.PRESENTED_IMAGE_SIMPLE})},"all"),n.jsx(Ss,{tab:`Pending (${b()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(T=>T.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),n.jsx(Ss,{tab:`Approved (${E()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(T=>T.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),n.jsx(Ss,{tab:`Confirmed (${j()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(T=>T.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),n.jsx(Ss,{tab:`Rejected (${S()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(T=>T.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),n.jsx(Ss,{tab:`Cancelled (${C()})`,children:r?n.jsx(on,{active:!0,paragraph:{rows:5}}):n.jsx(tt,{columns:v,dataSource:e.filter(T=>T.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(mt,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:Nd,Text:cl}=Le,zg=()=>{var x,u,p,g,f,m,v,w,_,y,b,E,j;const{id:e}=Fr(),t=Je(),[r,s]=k.useState(null),[i,a]=k.useState(!0);k.useEffect(()=>{o()},[e]);const o=async()=>{try{a(!0);const S=await Ar.getExhibitorBooking(e||"");s(S.data)}catch(S){console.error("Error fetching booking details:",S),be.error("Failed to load booking details")}finally{a(!1)}},l=async()=>{try{t(`/exhibitor/invoice/${e}`)}catch(S){console.error("Error fetching invoice:",S),be.error("Failed to retrieve invoice")}},d=S=>{switch(S){case"approved":return n.jsxs(Se,{color:"success",children:[n.jsx(vt,{})," Approved"]});case"pending":return n.jsxs(Se,{color:"warning",children:[n.jsx(Vt,{})," Pending"]});case"rejected":return n.jsx(Se,{color:"error",children:"Rejected"});case"confirmed":return n.jsxs(Se,{color:"blue",children:[n.jsx(vt,{})," Confirmed"]});case"cancelled":return n.jsx(Se,{color:"default",children:"Cancelled"});default:return n.jsx(Se,{children:"Unknown"})}},c=S=>{switch(S){case"paid":return n.jsx(Se,{color:"success",children:"Paid"});case"pending":return n.jsx(Se,{color:"warning",children:"Pending"});case"refunded":return n.jsx(Se,{color:"default",children:"Refunded"});default:return n.jsx(Se,{children:"Unknown"})}},h=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:S=>`${S.dimensions.width}m × ${S.dimensions.height}m`},{title:"Size",key:"size",render:S=>`${S.dimensions.width*S.dimensions.height} m²`},{title:"Rate per m²",dataIndex:"ratePerSqm",key:"ratePerSqm",render:S=>`₹${S.toLocaleString()}`},{title:"Amount",key:"amount",render:(S,C,T)=>{var I;const A=(I=r.calculations)==null?void 0:I.stalls[T];return A?`₹${A.baseAmount.toLocaleString()}`:"N/A"}}];return i?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:n.jsx(Qr,{size:"large"})}):r?n.jsxs("div",{style:{padding:"20px"},children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(r.status)&&n.jsx(te,{type:"primary",icon:n.jsx(_n,{}),onClick:l,children:"View Invoice"})]}),n.jsxs(de,{title:"Booking Details",style:{marginBottom:20},children:[n.jsxs(We,{bordered:!0,column:{xs:1,sm:2,md:3},children:[n.jsx(We.Item,{label:"Booking ID",children:r._id}),n.jsx(We.Item,{label:"Exhibition",children:((x=r.exhibitionId)==null?void 0:x.name)||"N/A"}),n.jsx(We.Item,{label:"Venue",children:((u=r.exhibitionId)==null?void 0:u.venue)||"N/A"}),n.jsx(We.Item,{label:"Booking Date",children:et(r.createdAt).format("MMM D, YYYY")}),n.jsxs(We.Item,{label:"Exhibition Dates",children:[et((p=r.exhibitionId)==null?void 0:p.startDate).format("MMM D, YYYY")," -",et((g=r.exhibitionId)==null?void 0:g.endDate).format("MMM D, YYYY")]}),n.jsx(We.Item,{label:"Status",children:d(r.status)}),n.jsx(We.Item,{label:"Payment Status",children:c(r.paymentStatus||"pending")}),n.jsxs(We.Item,{label:"Total Amount",children:["₹",((f=r.amount)==null?void 0:f.toLocaleString())||"N/A"]})]}),r.rejectionReason&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Nd,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),n.jsx(cl,{children:r.rejectionReason})]})]}),n.jsx(de,{title:"Stall Details",style:{marginBottom:20},children:n.jsx(tt,{dataSource:r.stallIds||[],columns:h,rowKey:"_id",pagination:!1})}),n.jsx(de,{title:"Calculation Summary",children:n.jsx(Ce,{gutter:[16,16],children:n.jsx(K,{span:24,children:n.jsxs(We,{bordered:!0,column:1,children:[n.jsxs(We.Item,{label:"Base Amount",children:["₹",((m=r.calculations)==null?void 0:m.totalBaseAmount.toLocaleString())||"N/A"]}),((v=r.calculations)==null?void 0:v.totalDiscountAmount)>0&&n.jsxs(We.Item,{label:"Discount",children:["- ₹",((w=r.calculations)==null?void 0:w.totalDiscountAmount.toLocaleString())||"N/A"]}),((_=r.calculations)==null?void 0:_.totalDiscountAmount)>0&&n.jsxs(We.Item,{label:"Amount After Discount",children:["₹",((y=r.calculations)==null?void 0:y.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(E=(b=r.calculations)==null?void 0:b.taxes)==null?void 0:E.map(S=>n.jsxs(We.Item,{label:`${S.name} (${S.rate}%)`,children:["+ ₹",S.amount.toLocaleString()||"N/A"]},S.name)),n.jsx(We.Item,{label:"Total Amount",children:n.jsxs(cl,{strong:!0,style:{fontSize:"16px"},children:["₹",((j=r.amount)==null?void 0:j.toLocaleString())||"N/A"]})})]})})})}),n.jsx(de,{title:"Customer Information",style:{marginTop:20},children:n.jsxs(We,{bordered:!0,column:{xs:1,sm:2},children:[n.jsx(We.Item,{label:"Company Name",children:r.companyName}),n.jsx(We.Item,{label:"Contact Person",children:r.customerName}),n.jsx(We.Item,{label:"Email",children:r.customerEmail}),n.jsx(We.Item,{label:"Phone",children:r.customerPhone})]})})]}):n.jsx(de,{children:n.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[n.jsx(Nd,{level:3,children:"Booking Not Found"}),n.jsx(cl,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),n.jsx("div",{style:{marginTop:20},children:n.jsx(te,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},cc=Tr.create({baseURL:sn}),Es=Tr.create({baseURL:sn});cc.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const ts=Tr.create({baseURL:sn});ts.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const ir={sendRegistrationOTP:async e=>await Es.post("/exhibitors/send-otp",{email:e}),verifyOTP:async e=>await Es.post("/exhibitors/verify-otp",e),register:async e=>await Es.post("/exhibitors/register",e),login:async e=>await Es.post("/exhibitors/login",e),requestPasswordReset:async e=>await Es.post("/exhibitors/forgot-password",e),resetPassword:async e=>await Es.post("/exhibitors/reset-password",e),getProfile:async()=>await cc.get("/exhibitors/profile"),updateProfile:async e=>await cc.put("/exhibitors/profile",e),getExhibitors:async()=>await ts.get("/exhibitors/admin/exhibitors"),getExhibitor:async e=>await ts.get(`/exhibitors/admin/exhibitors/${e}`),createExhibitor:async e=>await ts.post("/exhibitors/admin/exhibitors",e),updateStatus:async(e,t,r)=>await ts.put(`/exhibitors/admin/exhibitors/${e}/status`,{status:t,rejectionReason:r}),updateExhibitor:async(e,t)=>await ts.put(`/exhibitors/admin/exhibitors/${e}`,t),deleteExhibitor:async e=>await ts.delete(`/exhibitors/admin/exhibitors/${e}`)},{Title:Fd,Text:Rd}=Le,{TabPane:Pd}=Gt,qg=()=>{var d;const[e]=H.useForm(),[t,r]=k.useState(!1),[s,i]=k.useState(!1),a=it(),o=Me(c=>c.exhibitorAuth.exhibitor);k.useEffect(()=>{(async()=>{try{i(!0);const h=await ir.getProfile();h.data&&a(lc({exhibitor:h.data,token:(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||""}))}catch{be.error("Failed to fetch exhibitor profile")}finally{i(!1)}})()},[a]),k.useEffect(()=>{o&&e.setFieldsValue({companyName:o.companyName||"",contactPerson:o.contactPerson||"",email:o.email||"",phone:o.phone||"",address:o.address||"",website:o.website||"",description:o.description||"",panNumber:o.panNumber||"",gstNumber:o.gstNumber||"",city:o.city||"",state:o.state||"",pinCode:o.pinCode||""})},[o,e]);const l=async c=>{try{r(!0);const h=await ir.updateProfile(c),x=(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||"";a(lc({exhibitor:{...o,...c},token:x})),be.success("Profile updated successfully")}catch{be.error("Failed to update profile")}finally{r(!1)}};return n.jsxs("div",{children:[n.jsx(Fd,{level:2,children:"My Profile"}),n.jsx(Rd,{type:"secondary",children:"Manage your exhibitor profile information"}),n.jsx(de,{style:{marginTop:24},loading:s,children:n.jsxs(Gt,{defaultActiveKey:"profile",children:[n.jsx(Pd,{tab:"Profile Information",children:n.jsxs(Ce,{gutter:32,children:[n.jsx(K,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Br,{size:100,icon:n.jsx(at,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((d=o==null?void 0:o.companyName)==null?void 0:d.charAt(0).toUpperCase())||"E"}),n.jsx(Fd,{level:4,children:o==null?void 0:o.companyName}),n.jsx(Rd,{type:"secondary",children:o==null?void 0:o.email})]})}),n.jsx(K,{span:18,children:n.jsxs(H,{form:e,layout:"vertical",onFinish:l,initialValues:{companyName:(o==null?void 0:o.companyName)||"",contactPerson:(o==null?void 0:o.contactPerson)||"",email:(o==null?void 0:o.email)||"",phone:(o==null?void 0:o.phone)||"",address:(o==null?void 0:o.address)||"",website:(o==null?void 0:o.website)||"",description:(o==null?void 0:o.description)||"",panNumber:(o==null?void 0:o.panNumber)||"",gstNumber:(o==null?void 0:o.gstNumber)||"",city:(o==null?void 0:o.city)||"",state:(o==null?void 0:o.state)||"",pinCode:(o==null?void 0:o.pinCode)||""},children:[n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:n.jsx(he,{prefix:n.jsx(wc,{}),placeholder:"Company Name"})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:n.jsx(he,{prefix:n.jsx(at,{}),placeholder:"Contact Person"})})})]}),n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(un,{}),placeholder:"Email",disabled:!0})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:n.jsx(he,{prefix:n.jsx(jc,{}),placeholder:"Phone Number"})})})]}),n.jsx(H.Item,{name:"address",label:"Address",children:n.jsx(he.TextArea,{rows:2,placeholder:"Company Address"})}),n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:8,children:n.jsx(H.Item,{name:"city",label:"City",children:n.jsx(he,{placeholder:"City"})})}),n.jsx(K,{span:8,children:n.jsx(H.Item,{name:"state",label:"State",children:n.jsx(he,{placeholder:"State"})})}),n.jsx(K,{span:8,children:n.jsx(H.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(he,{placeholder:"PIN Code",maxLength:6})})})]}),n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(he,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(he,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),n.jsx(H.Item,{name:"website",label:"Website",children:n.jsx(he,{placeholder:"https://www.yourcompany.com"})}),n.jsx(H.Item,{name:"description",label:"Company Description",children:n.jsx(he.TextArea,{rows:4,placeholder:"Brief description of your company"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",loading:t,icon:n.jsx(fs,{}),children:"Save Changes"})})]})})]})},"profile"),n.jsx(Pd,{tab:"Change Password",children:n.jsxs(H,{layout:"vertical",onFinish:c=>{be.success("Password updated successfully")},children:[n.jsx(H.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(he.Password,{placeholder:"Current Password"})}),n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:c})=>({validator(h,x){return!x||c("newPassword")===x?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{placeholder:"Confirm New Password"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})};var Wg=class extends Error{constructor(t){super(t[0].message);dd(this,"issues");this.name="SchemaError",this.issues=t}},Ju=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(Ju||{});function Dd(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var Ld=Li;function Zu(e,t){if(e===t||!(Ld(e)&&Ld(t)||Array.isArray(e)&&Array.isArray(t)))return t;const r=Object.keys(t),s=Object.keys(e);let i=r.length===s.length;const a=Array.isArray(t)?[]:{};for(const o of r)a[o]=Zu(e[o],t[o]),i&&(i=e[o]===a[o]);return i?e:a}function zs(e){let t=0;for(const r in e)t++;return t}var Od=e=>[].concat(...e);function Hg(e){return new RegExp("(^|:)//").test(e)}function Vg(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function mo(e){return e!=null}function Gg(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var Yg=e=>e.replace(/\/$/,""),Kg=e=>e.replace(/^\//,"");function Xg(e,t){if(!e)return t;if(!t)return e;if(Hg(t))return t;const r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=Yg(e),t=Kg(t),`${e}${r}${t}`}function Qg(e,t,r){return e.has(t)?e.get(t):e.set(t,r).get(t)}var Bd=(...e)=>fetch(...e),Jg=e=>e.status>=200&&e.status<=299,Zg=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function Md(e){if(!Li(e))return e;const t={...e};for(const[r,s]of Object.entries(t))s===void 0&&delete t[r];return t}function Pc({baseUrl:e,prepareHeaders:t=x=>x,fetchFn:r=Bd,paramsSerializer:s,isJsonContentType:i=Zg,jsonContentType:a="application/json",jsonReplacer:o,timeout:l,responseHandler:d,validateStatus:c,...h}={}){return typeof fetch>"u"&&r===Bd&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(u,p,g)=>{const{getState:f,extra:m,endpoint:v,forced:w,type:_}=p;let y,{url:b,headers:E=new Headers(h.headers),params:j=void 0,responseHandler:S=d??"json",validateStatus:C=c??Jg,timeout:T=l,...A}=typeof u=="string"?{url:u}:u,I,P=p.signal;T&&(I=new AbortController,p.signal.addEventListener("abort",I.abort),P=I.signal);let N={...h,signal:P,...A};E=new Headers(Md(E)),N.headers=await t(E,{getState:f,arg:u,extra:m,endpoint:v,forced:w,type:_,extraOptions:g})||E;const q=B=>typeof B=="object"&&(Li(B)||Array.isArray(B)||typeof B.toJSON=="function");if(!N.headers.has("content-type")&&q(N.body)&&N.headers.set("content-type",a),q(N.body)&&i(N.headers)&&(N.body=JSON.stringify(N.body,o)),j){const B=~b.indexOf("?")?"&":"?",F=s?s(j):new URLSearchParams(Md(j));b+=B+F}b=Xg(e,b);const L=new Request(b,N);y={request:new Request(b,N)};let M,J=!1,ne=I&&setTimeout(()=>{J=!0,I.abort()},T);try{M=await r(L)}catch(B){return{error:{status:J?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(B)},meta:y}}finally{ne&&clearTimeout(ne),I==null||I.signal.removeEventListener("abort",I.abort)}const Z=M.clone();y.response=Z;let R,U="";try{let B;if(await Promise.all([x(M,S).then(F=>R=F,F=>B=F),Z.text().then(F=>U=F,()=>{})]),B)throw B}catch(B){return{error:{status:"PARSING_ERROR",originalStatus:M.status,data:U,error:String(B)},meta:y}}return C(M,R)?{data:R,meta:y}:{error:{status:M.status,data:R},meta:y}};async function x(u,p){if(typeof p=="function")return p(u);if(p==="content-type"&&(p=i(u.headers)?"json":"text"),p==="json"){const g=await u.text();return g.length?JSON.parse(g):null}return u.text()}}var $d=class{constructor(e,t=void 0){this.value=e,this.meta=t}},Dc=Js("__rtkq/focused"),ef=Js("__rtkq/unfocused"),Lc=Js("__rtkq/online"),tf=Js("__rtkq/offline");function $o(e){return e.type==="query"}function e1(e){return e.type==="mutation"}function Uo(e){return e.type==="infinitequery"}function go(e){return $o(e)||Uo(e)}function Oc(e,t,r,s,i,a){return t1(e)?e(t,r,s,i).filter(mo).map(dc).map(a):Array.isArray(e)?e.map(dc).map(a):[]}function t1(e){return typeof e=="function"}function dc(e){return typeof e=="string"?{type:e}:e}function r1(e,t){return e.catch(t)}var Bi=Symbol("forceQueryFn"),hc=e=>typeof e[Bi]=="function";function n1({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:r,mutationThunk:s,api:i,context:a}){const o=new Map,l=new Map,{unsubscribeQueryResult:d,removeMutationResult:c,updateSubscriptionOptions:h}=i.internalActions;return{buildInitiateQuery:m,buildInitiateInfiniteQuery:v,buildInitiateMutation:w,getRunningQueryThunk:x,getRunningMutationThunk:u,getRunningQueriesThunk:p,getRunningMutationsThunk:g};function x(_,y){return b=>{var S;const E=a.endpointDefinitions[_],j=e({queryArgs:y,endpointDefinition:E,endpointName:_});return(S=o.get(b))==null?void 0:S[j]}}function u(_,y){return b=>{var E;return(E=l.get(b))==null?void 0:E[y]}}function p(){return _=>Object.values(o.get(_)||{}).filter(mo)}function g(){return _=>Object.values(l.get(_)||{}).filter(mo)}function f(_,y){const b=(E,{subscribe:j=!0,forceRefetch:S,subscriptionOptions:C,[Bi]:T,...A}={})=>(I,P)=>{var V;const N=e({queryArgs:E,endpointDefinition:y,endpointName:_});let q;const L={...A,type:"query",subscribe:j,forceRefetch:S,subscriptionOptions:C,endpointName:_,originalArgs:E,queryCacheKey:N,[Bi]:T};if($o(y))q=t(L);else{const{direction:se,initialPageParam:xe}=A;q=r({...L,direction:se,initialPageParam:xe})}const D=i.endpoints[_].select(E),M=I(q),J=D(P()),{requestId:ne,abort:Z}=M,R=J.requestId!==ne,U=(V=o.get(I))==null?void 0:V[N],B=()=>D(P()),F=Object.assign(T?M.then(B):R&&!U?Promise.resolve(J):Promise.all([U,M]).then(B),{arg:E,requestId:ne,subscriptionOptions:C,queryCacheKey:N,abort:Z,async unwrap(){const se=await F;if(se.isError)throw se.error;return se.data},refetch:()=>I(b(E,{subscribe:!1,forceRefetch:!0})),unsubscribe(){j&&I(d({queryCacheKey:N,requestId:ne}))},updateSubscriptionOptions(se){F.subscriptionOptions=se,I(h({endpointName:_,requestId:ne,queryCacheKey:N,options:se}))}});if(!U&&!R&&!T){const se=Qg(o,I,{});se[N]=F,F.then(()=>{delete se[N],zs(se)||o.delete(I)})}return F};return b}function m(_,y){return f(_,y)}function v(_,y){return f(_,y)}function w(_){return(y,{track:b=!0,fixedCacheKey:E}={})=>(j,S)=>{const C=s({type:"mutation",endpointName:_,originalArgs:y,track:b,fixedCacheKey:E}),T=j(C),{requestId:A,abort:I,unwrap:P}=T,N=r1(T.unwrap().then(M=>({data:M})),M=>({error:M})),q=()=>{j(c({requestId:A,fixedCacheKey:E}))},L=Object.assign(N,{arg:T.arg,requestId:A,abort:I,unwrap:P,reset:q}),D=l.get(j)||{};return l.set(j,D),D[A]=L,L.then(()=>{delete D[A],zs(D)||l.delete(j)}),E&&(D[E]=L,L.then(()=>{D[E]===L&&(delete D[E],zs(D)||l.delete(j))})),L}}}var rf=class extends Wg{constructor(e,t,r,s){super(e),this.value=t,this.schemaName=r,this._bqMeta=s}};async function Jn(e,t,r,s){const i=await e["~standard"].validate(t);if(i.issues)throw new rf(i.issues,t,r,s);return i.value}function s1(e){return e}var di=(e={})=>({...e,[Eu]:!0});function i1({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:s,api:i,assertTagType:a,selectors:o,onSchemaFailure:l,catchSchemaFailure:d,skipSchemaValidation:c}){const h=(A,I,P,N)=>(q,L)=>{const D=r[A],M=s({queryArgs:I,endpointDefinition:D,endpointName:A});if(q(i.internalActions.queryResultPatched({queryCacheKey:M,patches:P})),!N)return;const J=i.endpoints[A].select(I)(L()),ne=Oc(D.providesTags,J.data,void 0,I,{},a);q(i.internalActions.updateProvidedBy([{queryCacheKey:M,providedTags:ne}]))};function x(A,I,P=0){const N=[I,...A];return P&&N.length>P?N.slice(0,-1):N}function u(A,I,P=0){const N=[...A,I];return P&&N.length>P?N.slice(1):N}const p=(A,I,P,N=!0)=>(q,L)=>{const M=i.endpoints[A].select(I)(L()),J={patches:[],inversePatches:[],undo:()=>q(i.util.patchQueryData(A,I,J.inversePatches,N))};if(M.status==="uninitialized")return J;let ne;if("data"in M)if(rp(M.data)){const[Z,R,U]=_u(M.data,P);J.patches.push(...R),J.inversePatches.push(...U),ne=Z}else ne=P(M.data),J.patches.push({op:"replace",path:[],value:ne}),J.inversePatches.push({op:"replace",path:[],value:M.data});return J.patches.length===0||q(i.util.patchQueryData(A,I,J.patches,N)),J},g=(A,I,P)=>N=>N(i.endpoints[A].initiate(I,{subscribe:!1,forceRefetch:!0,[Bi]:()=>({data:P})})),f=(A,I)=>A.query&&A[I]?A[I]:s1,m=async(A,{signal:I,abort:P,rejectWithValue:N,fulfillWithValue:q,dispatch:L,getState:D,extra:M})=>{var R,U;const J=r[A.endpointName],{metaSchema:ne,skipSchemaValidation:Z=c}=J;try{let B=f(J,"transformResponse");const F={signal:I,abort:P,dispatch:L,getState:D,extra:M,endpoint:A.endpointName,type:A.type,forced:A.type==="query"?v(A,D()):void 0,queryCacheKey:A.type==="query"?A.queryCacheKey:void 0},V=A.type==="query"?A[Bi]:void 0;let se;const xe=async(Q,ee,ce,Ie)=>{if(ee==null&&Q.pages.length)return Promise.resolve({data:Q});const re={queryArg:A.originalArgs,pageParam:ee},_e=await me(re),Ne=Ie?x:u;return{data:{pages:Ne(Q.pages,_e.data,ce),pageParams:Ne(Q.pageParams,ee,ce)},meta:_e.meta}};async function me(Q){let ee;const{extraOptions:ce,argSchema:Ie,rawResponseSchema:re,responseSchema:_e}=J;if(Ie&&!Z&&(Q=await Jn(Ie,Q,"argSchema",{})),V?ee=V():J.query?ee=await t(J.query(Q),F,ce):ee=await J.queryFn(Q,F,ce,ze=>t(ze,F,ce)),typeof process<"u",ee.error)throw new $d(ee.error,ee.meta);let{data:Ne}=ee;re&&!Z&&(Ne=await Jn(re,ee.data,"rawResponseSchema",ee.meta));let ye=await B(Ne,ee.meta,Q);return _e&&!Z&&(ye=await Jn(_e,ye,"responseSchema",ee.meta)),{...ee,data:ye}}if(A.type==="query"&&"infiniteQueryOptions"in J){const{infiniteQueryOptions:Q}=J,{maxPages:ee=1/0}=Q;let ce;const Ie={pages:[],pageParams:[]},re=(R=o.selectQueryEntry(D(),A.queryCacheKey))==null?void 0:R.data,Ne=v(A,D())&&!A.direction||!re?Ie:re;if("direction"in A&&A.direction&&Ne.pages.length){const ye=A.direction==="backward",qe=(ye?nf:uc)(Q,Ne);ce=await xe(Ne,qe,ee,ye)}else{const{initialPageParam:ye=Q.initialPageParam}=A,ze=(re==null?void 0:re.pageParams)??[],qe=ze[0]??ye,Ft=ze.length;ce=await xe(Ne,qe,ee),V&&(ce={data:ce.data.pages[0]});for(let tr=1;tr<Ft;tr++){const dr=uc(Q,ce.data);ce=await xe(ce.data,dr,ee)}}se=ce}else se=await me(A.originalArgs);return ne&&!Z&&se.meta&&(se.meta=await Jn(ne,se.meta,"metaSchema",se.meta)),q(se.data,di({fulfilledTimeStamp:Date.now(),baseQueryMeta:se.meta}))}catch(B){let F=B;if(F instanceof $d){let V=f(J,"transformErrorResponse");const{rawErrorResponseSchema:se,errorResponseSchema:xe}=J;let{value:me,meta:Q}=F;try{se&&!Z&&(me=await Jn(se,me,"rawErrorResponseSchema",Q)),ne&&!Z&&(Q=await Jn(ne,Q,"metaSchema",Q));let ee=await V(me,Q,A.originalArgs);return xe&&!Z&&(ee=await Jn(xe,ee,"errorResponseSchema",Q)),N(ee,di({baseQueryMeta:Q}))}catch(ee){F=ee}}try{if(F instanceof rf){const V={endpoint:A.endpointName,arg:A.originalArgs,type:A.type,queryCacheKey:A.type==="query"?A.queryCacheKey:void 0};(U=J.onSchemaFailure)==null||U.call(J,F,V),l==null||l(F,V);const{catchSchemaFailure:se=d}=J;if(se)return N(se(F,V),di({baseQueryMeta:F._bqMeta}))}}catch(V){F=V}throw console.error(F),F}};function v(A,I){const P=o.selectQueryEntry(I,A.queryCacheKey),N=o.selectConfig(I).refetchOnMountOrArgChange,q=P==null?void 0:P.fulfilledTimeStamp,L=A.forceRefetch??(A.subscribe&&N);return L?L===!0||(Number(new Date)-Number(q))/1e3>=L:!1}const w=()=>Qe(`${e}/executeQuery`,m,{getPendingMeta({arg:I}){const P=r[I.endpointName];return di({startedTimeStamp:Date.now(),...Uo(P)?{direction:I.direction}:{}})},condition(I,{getState:P}){var Z;const N=P(),q=o.selectQueryEntry(N,I.queryCacheKey),L=q==null?void 0:q.fulfilledTimeStamp,D=I.originalArgs,M=q==null?void 0:q.originalArgs,J=r[I.endpointName],ne=I.direction;return hc(I)?!0:(q==null?void 0:q.status)==="pending"?!1:v(I,N)||$o(J)&&((Z=J==null?void 0:J.forceRefetch)!=null&&Z.call(J,{currentArg:D,previousArg:M,endpointState:q,state:N}))?!0:!(L&&!ne)},dispatchConditionRejection:!0}),_=w(),y=w(),b=Qe(`${e}/executeMutation`,m,{getPendingMeta(){return di({startedTimeStamp:Date.now()})}}),E=A=>"force"in A,j=A=>"ifOlderThan"in A,S=(A,I,P)=>(N,q)=>{const L=E(P)&&P.force,D=j(P)&&P.ifOlderThan,M=(ne=!0)=>{const Z={forceRefetch:ne,isPrefetch:!0};return i.endpoints[A].initiate(I,Z)},J=i.endpoints[A].select(I)(q());if(L)N(M());else if(D){const ne=J==null?void 0:J.fulfilledTimeStamp;if(!ne){N(M());return}(Number(new Date)-Number(new Date(ne)))/1e3>=D&&N(M())}else N(M(!1))};function C(A){return I=>{var P,N;return((N=(P=I==null?void 0:I.meta)==null?void 0:P.arg)==null?void 0:N.endpointName)===A}}function T(A,I){return{matchPending:rl(Tu(A),C(I)),matchFulfilled:rl(ls(A),C(I)),matchRejected:rl(_c(A),C(I))}}return{queryThunk:_,mutationThunk:b,infiniteQueryThunk:y,prefetch:S,updateQueryData:p,upsertQueryData:g,patchQueryData:h,buildMatchThunkActions:T}}function uc(e,{pages:t,pageParams:r}){const s=t.length-1;return e.getNextPageParam(t[s],t,r[s],r)}function nf(e,{pages:t,pageParams:r}){var s;return(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r)}function sf(e,t,r,s){return Oc(r[e.meta.arg.endpointName][t],ls(e)?e.payload:void 0,Tc(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,s)}function ua(e,t,r){const s=e[t];s&&r(s)}function Mi(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function Ud(e,t,r){const s=e[Mi(t)];s&&r(s)}var fa={};function a1({reducerPath:e,queryThunk:t,mutationThunk:r,serializeQueryArgs:s,context:{endpointDefinitions:i,apiUid:a,extractRehydrationInfo:o,hasRehydrationInfo:l},assertTagType:d,config:c}){const h=Js(`${e}/resetApiState`);function x(C,T,A,I){var P;C[P=T.queryCacheKey]??(C[P]={status:"uninitialized",endpointName:T.endpointName}),ua(C,T.queryCacheKey,N=>{N.status="pending",N.requestId=A&&N.requestId?N.requestId:I.requestId,T.originalArgs!==void 0&&(N.originalArgs=T.originalArgs),N.startedTimeStamp=I.startedTimeStamp;const q=i[I.arg.endpointName];Uo(q)&&"direction"in T&&(N.direction=T.direction)})}function u(C,T,A,I){ua(C,T.arg.queryCacheKey,P=>{if(P.requestId!==T.requestId&&!I)return;const{merge:N}=i[T.arg.endpointName];if(P.status="fulfilled",N)if(P.data!==void 0){const{fulfilledTimeStamp:q,arg:L,baseQueryMeta:D,requestId:M}=T;let J=Ec(P.data,ne=>N(ne,A,{arg:L.originalArgs,baseQueryMeta:D,fulfilledTimeStamp:q,requestId:M}));P.data=J}else P.data=A;else P.data=i[T.arg.endpointName].structuralSharing??!0?Zu(sp(P.data)?ip(P.data):P.data,A):A;delete P.error,P.fulfilledTimeStamp=T.fulfilledTimeStamp})}const p=gr({name:`${e}/queries`,initialState:fa,reducers:{removeQueryResult:{reducer(C,{payload:{queryCacheKey:T}}){delete C[T]},prepare:oi()},cacheEntriesUpserted:{reducer(C,T){for(const A of T.payload){const{queryDescription:I,value:P}=A;x(C,I,!0,{arg:I,requestId:T.meta.requestId,startedTimeStamp:T.meta.timestamp}),u(C,{arg:I,requestId:T.meta.requestId,fulfilledTimeStamp:T.meta.timestamp,baseQueryMeta:{}},P,!0)}},prepare:C=>({payload:C.map(I=>{const{endpointName:P,arg:N,value:q}=I,L=i[P];return{queryDescription:{type:"query",endpointName:P,originalArgs:I.arg,queryCacheKey:s({queryArgs:N,endpointDefinition:L,endpointName:P})},value:q}}),meta:{[Eu]:!0,requestId:wu(),timestamp:Date.now()}})},queryResultPatched:{reducer(C,{payload:{queryCacheKey:T,patches:A}}){ua(C,T,I=>{I.data=gd(I.data,A.concat())})},prepare:oi()}},extraReducers(C){C.addCase(t.pending,(T,{meta:A,meta:{arg:I}})=>{const P=hc(I);x(T,I,P,A)}).addCase(t.fulfilled,(T,{meta:A,payload:I})=>{const P=hc(A.arg);u(T,A,I,P)}).addCase(t.rejected,(T,{meta:{condition:A,arg:I,requestId:P},error:N,payload:q})=>{ua(T,I.queryCacheKey,L=>{if(!A){if(L.requestId!==P)return;L.status="rejected",L.error=q??N}})}).addMatcher(l,(T,A)=>{const{queries:I}=o(A);for(const[P,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&(T[P]=N)})}}),g=gr({name:`${e}/mutations`,initialState:fa,reducers:{removeMutationResult:{reducer(C,{payload:T}){const A=Mi(T);A in C&&delete C[A]},prepare:oi()}},extraReducers(C){C.addCase(r.pending,(T,{meta:A,meta:{requestId:I,arg:P,startedTimeStamp:N}})=>{P.track&&(T[Mi(A)]={requestId:I,status:"pending",endpointName:P.endpointName,startedTimeStamp:N})}).addCase(r.fulfilled,(T,{payload:A,meta:I})=>{I.arg.track&&Ud(T,I,P=>{P.requestId===I.requestId&&(P.status="fulfilled",P.data=A,P.fulfilledTimeStamp=I.fulfilledTimeStamp)})}).addCase(r.rejected,(T,{payload:A,error:I,meta:P})=>{P.arg.track&&Ud(T,P,N=>{N.requestId===P.requestId&&(N.status="rejected",N.error=A??I)})}).addMatcher(l,(T,A)=>{const{mutations:I}=o(A);for(const[P,N]of Object.entries(I))((N==null?void 0:N.status)==="fulfilled"||(N==null?void 0:N.status)==="rejected")&&P!==(N==null?void 0:N.requestId)&&(T[P]=N)})}}),f={tags:{},keys:{}},m=gr({name:`${e}/invalidation`,initialState:f,reducers:{updateProvidedBy:{reducer(C,T){var A,I,P;for(const{queryCacheKey:N,providedTags:q}of T.payload){v(C,N);for(const{type:L,id:D}of q){const M=(I=(A=C.tags)[L]??(A[L]={}))[P=D||"__internal_without_id"]??(I[P]=[]);M.includes(N)||M.push(N)}C.keys[N]=q}},prepare:oi()}},extraReducers(C){C.addCase(p.actions.removeQueryResult,(T,{payload:{queryCacheKey:A}})=>{v(T,A)}).addMatcher(l,(T,A)=>{var P,N,q;const{provided:I}=o(A);for(const[L,D]of Object.entries(I))for(const[M,J]of Object.entries(D)){const ne=(N=(P=T.tags)[L]??(P[L]={}))[q=M||"__internal_without_id"]??(N[q]=[]);for(const Z of J)ne.includes(Z)||ne.push(Z)}}).addMatcher(fo(ls(t),Tc(t)),(T,A)=>{w(T,[A])}).addMatcher(p.actions.cacheEntriesUpserted.match,(T,A)=>{const I=A.payload.map(({queryDescription:P,value:N})=>({type:"UNKNOWN",payload:N,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:P}}));w(T,I)})}});function v(C,T){var I;const A=C.keys[T]??[];for(const P of A){const N=P.type,q=P.id??"__internal_without_id",L=(I=C.tags[N])==null?void 0:I[q];L&&(C.tags[N][q]=L.filter(D=>D!==T))}delete C.keys[T]}function w(C,T){const A=T.map(I=>{const P=sf(I,"providesTags",i,d),{queryCacheKey:N}=I.meta.arg;return{queryCacheKey:N,providedTags:P}});m.caseReducers.updateProvidedBy(C,m.actions.updateProvidedBy(A))}const _=gr({name:`${e}/subscriptions`,initialState:fa,reducers:{updateSubscriptionOptions(C,T){},unsubscribeQueryResult(C,T){},internal_getRTKQSubscriptions(){}}}),y=gr({name:`${e}/internalSubscriptions`,initialState:fa,reducers:{subscriptionsUpdated:{reducer(C,T){return gd(C,T.payload)},prepare:oi()}}}),b=gr({name:`${e}/config`,initialState:{online:Gg(),focused:Vg(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(C,{payload:T}){C.middlewareRegistered=C.middlewareRegistered==="conflict"||a!==T?"conflict":!0}},extraReducers:C=>{C.addCase(Lc,T=>{T.online=!0}).addCase(tf,T=>{T.online=!1}).addCase(Dc,T=>{T.focused=!0}).addCase(ef,T=>{T.focused=!1}).addMatcher(l,T=>({...T}))}}),E=tp({queries:p.reducer,mutations:g.reducer,provided:m.reducer,subscriptions:y.reducer,config:b.reducer}),j=(C,T)=>E(h.match(T)?void 0:C,T),S={...b.actions,...p.actions,..._.actions,...y.actions,...g.actions,...m.actions,resetApiState:h};return{reducer:j,actions:S}}var zr=Symbol.for("RTKQ/skipToken"),af={status:"uninitialized"},zd=Ec(af,()=>{}),qd=Ec(af,()=>{});function o1({serializeQueryArgs:e,reducerPath:t,createSelector:r}){const s=_=>zd,i=_=>qd;return{buildQuerySelector:u,buildInfiniteQuerySelector:p,buildMutationSelector:g,selectInvalidatedBy:f,selectCachedArgsForQuery:m,selectApiState:o,selectQueries:l,selectMutations:c,selectQueryEntry:d,selectConfig:h};function a(_){return{..._,...Dd(_.status)}}function o(_){return _[t]}function l(_){var y;return(y=o(_))==null?void 0:y.queries}function d(_,y){var b;return(b=l(_))==null?void 0:b[y]}function c(_){var y;return(y=o(_))==null?void 0:y.mutations}function h(_){var y;return(y=o(_))==null?void 0:y.config}function x(_,y,b){return E=>{if(E===zr)return r(s,b);const j=e({queryArgs:E,endpointDefinition:y,endpointName:_});return r(C=>d(C,j)??zd,b)}}function u(_,y){return x(_,y,a)}function p(_,y){const{infiniteQueryOptions:b}=y;function E(j){const S={...j,...Dd(j.status)},{isLoading:C,isError:T,direction:A}=S,I=A==="forward",P=A==="backward";return{...S,hasNextPage:v(b,S.data),hasPreviousPage:w(b,S.data),isFetchingNextPage:C&&I,isFetchingPreviousPage:C&&P,isFetchNextPageError:T&&I,isFetchPreviousPageError:T&&P}}return x(_,y,E)}function g(){return _=>{let y;return typeof _=="object"?y=Mi(_)??zr:y=_,r(y===zr?i:j=>{var S,C;return((C=(S=o(j))==null?void 0:S.mutations)==null?void 0:C[y])??qd},a)}}function f(_,y){const b=_[t],E=new Set;for(const j of y.filter(mo).map(dc)){const S=b.provided.tags[j.type];if(!S)continue;let C=(j.id!==void 0?S[j.id]:Od(Object.values(S)))??[];for(const T of C)E.add(T)}return Od(Array.from(E.values()).map(j=>{const S=b.queries[j];return S?[{queryCacheKey:j,endpointName:S.endpointName,originalArgs:S.originalArgs}]:[]}))}function m(_,y){return Object.values(l(_)).filter(b=>(b==null?void 0:b.endpointName)===y&&b.status!=="uninitialized").map(b=>b.originalArgs)}function v(_,y){return y?uc(_,y)!=null:!1}function w(_,y){return!y||!_.getPreviousPageParam?!1:nf(_,y)!=null}}var Ts=WeakMap?new WeakMap:void 0,yo=({endpointName:e,queryArgs:t})=>{let r="";const s=Ts==null?void 0:Ts.get(t);if(typeof s=="string")r=s;else{const i=JSON.stringify(t,(a,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=Li(o)?Object.keys(o).sort().reduce((l,d)=>(l[d]=o[d],l),{}):o,o));Li(t)&&(Ts==null||Ts.set(t,i)),r=i}return`${e}(${r})`};function of(...e){return function(r){const s=md(c=>{var h;return(h=r.extractRehydrationInfo)==null?void 0:h.call(r,c,{reducerPath:r.reducerPath??"api"})}),i={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:s,serializeQueryArgs(c){let h=yo;if("serializeQueryArgs"in c.endpointDefinition){const x=c.endpointDefinition.serializeQueryArgs;h=u=>{const p=x(u);return typeof p=="string"?p:yo({...u,queryArgs:p})}}else r.serializeQueryArgs&&(h=r.serializeQueryArgs);return h(c)},tagTypes:[...r.tagTypes||[]]},a={endpointDefinitions:{},batch(c){c()},apiUid:wu(),extractRehydrationInfo:s,hasRehydrationInfo:md(c=>s(c)!=null)},o={injectEndpoints:d,enhanceEndpoints({addTagTypes:c,endpoints:h}){if(c)for(const x of c)i.tagTypes.includes(x)||i.tagTypes.push(x);if(h)for(const[x,u]of Object.entries(h))typeof u=="function"?u(a.endpointDefinitions[x]):Object.assign(a.endpointDefinitions[x]||{},u);return o}},l=e.map(c=>c.init(o,i,a));function d(c){const h=c.endpoints({query:x=>({...x,type:"query"}),mutation:x=>({...x,type:"mutation"}),infiniteQuery:x=>({...x,type:"infinitequery"})});for(const[x,u]of Object.entries(h)){if(c.overrideExisting!==!0&&x in a.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(ju(39));continue}a.endpointDefinitions[x]=u;for(const p of l)p.injectEndpoint(x,u)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function yn(e,...t){return Object.assign(e,...t)}var l1=({api:e,queryThunk:t,internalState:r})=>{const s=`${e.reducerPath}/subscriptions`;let i=null,a=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:l}=e.internalActions,d=(p,g)=>{var m,v,w;if(o.match(g)){const{queryCacheKey:_,requestId:y,options:b}=g.payload;return(m=p==null?void 0:p[_])!=null&&m[y]&&(p[_][y]=b),!0}if(l.match(g)){const{queryCacheKey:_,requestId:y}=g.payload;return p[_]&&delete p[_][y],!0}if(e.internalActions.removeQueryResult.match(g))return delete p[g.payload.queryCacheKey],!0;if(t.pending.match(g)){const{meta:{arg:_,requestId:y}}=g,b=p[v=_.queryCacheKey]??(p[v]={});return b[`${y}_running`]={},_.subscribe&&(b[y]=_.subscriptionOptions??b[y]??{}),!0}let f=!1;if(t.fulfilled.match(g)||t.rejected.match(g)){const _=p[g.meta.arg.queryCacheKey]||{},y=`${g.meta.requestId}_running`;f||(f=!!_[y]),delete _[y]}if(t.rejected.match(g)){const{meta:{condition:_,arg:y,requestId:b}}=g;if(_&&y.subscribe){const E=p[w=y.queryCacheKey]??(p[w]={});E[b]=y.subscriptionOptions??E[b]??{},f=!0}}return f},c=()=>r.currentSubscriptions,u={getSubscriptions:c,getSubscriptionCount:p=>{const f=c()[p]??{};return zs(f)},isRequestSubscribed:(p,g)=>{var m;const f=c();return!!((m=f==null?void 0:f[p])!=null&&m[g])}};return(p,g)=>{if(i||(i=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(p))return i=r.currentSubscriptions={},a=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(p))return[!1,u];const f=d(r.currentSubscriptions,p);let m=!0;if(f){a||(a=setTimeout(()=>{const _=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,y]=_u(i,()=>_);g.next(e.internalActions.subscriptionsUpdated(y)),i=_,a=null},500));const v=typeof p.type=="string"&&!!p.type.startsWith(s),w=t.rejected.match(p)&&p.meta.condition&&!!p.meta.arg.subscribe;m=!v&&!w}return[m,!1]}};function c1(e){for(const t in e)return!1;return!0}var d1=2147483647/1e3-1,h1=({reducerPath:e,api:t,queryThunk:r,context:s,internalState:i,selectors:{selectQueryEntry:a,selectConfig:o}})=>{const{removeQueryResult:l,unsubscribeQueryResult:d,cacheEntriesUpserted:c}=t.internalActions,h=fo(d.match,r.fulfilled,r.rejected,c.match);function x(m){const v=i.currentSubscriptions[m];return!!v&&!c1(v)}const u={},p=(m,v,w)=>{const _=v.getState(),y=o(_);if(h(m)){let b;if(c.match(m))b=m.payload.map(E=>E.queryDescription.queryCacheKey);else{const{queryCacheKey:E}=d.match(m)?m.payload:m.meta.arg;b=[E]}g(b,v,y)}if(t.util.resetApiState.match(m))for(const[b,E]of Object.entries(u))E&&clearTimeout(E),delete u[b];if(s.hasRehydrationInfo(m)){const{queries:b}=s.extractRehydrationInfo(m);g(Object.keys(b),v,y)}};function g(m,v,w){const _=v.getState();for(const y of m){const b=a(_,y);f(y,b==null?void 0:b.endpointName,v,w)}}function f(m,v,w,_){const y=s.endpointDefinitions[v],b=(y==null?void 0:y.keepUnusedDataFor)??_.keepUnusedDataFor;if(b===1/0)return;const E=Math.max(0,Math.min(b,d1));if(!x(m)){const j=u[m];j&&clearTimeout(j),u[m]=setTimeout(()=>{x(m)||w.dispatch(l({queryCacheKey:m})),delete u[m]},E*1e3)}}return p},Wd=new Error("Promise never resolved before cacheEntryRemoved."),u1=({api:e,reducerPath:t,context:r,queryThunk:s,mutationThunk:i,internalState:a,selectors:{selectQueryEntry:o,selectApiState:l}})=>{const d=yd(s),c=yd(i),h=ls(s,i),x={};function u(v,w,_){const y=x[v];y!=null&&y.valueResolved&&(y.valueResolved({data:w,meta:_}),delete y.valueResolved)}function p(v){const w=x[v];w&&(delete x[v],w.cacheEntryRemoved())}const g=(v,w,_)=>{const y=f(v);function b(E,j,S,C){const T=o(_,j),A=o(w.getState(),j);!T&&A&&m(E,C,j,w,S)}if(s.pending.match(v))b(v.meta.arg.endpointName,y,v.meta.requestId,v.meta.arg.originalArgs);else if(e.internalActions.cacheEntriesUpserted.match(v))for(const{queryDescription:E,value:j}of v.payload){const{endpointName:S,originalArgs:C,queryCacheKey:T}=E;b(S,T,v.meta.requestId,C),u(T,j,{})}else if(i.pending.match(v))w.getState()[t].mutations[y]&&m(v.meta.arg.endpointName,v.meta.arg.originalArgs,y,w,v.meta.requestId);else if(h(v))u(y,v.payload,v.meta.baseQueryMeta);else if(e.internalActions.removeQueryResult.match(v)||e.internalActions.removeMutationResult.match(v))p(y);else if(e.util.resetApiState.match(v))for(const E of Object.keys(x))p(E)};function f(v){return d(v)?v.meta.arg.queryCacheKey:c(v)?v.meta.arg.fixedCacheKey??v.meta.requestId:e.internalActions.removeQueryResult.match(v)?v.payload.queryCacheKey:e.internalActions.removeMutationResult.match(v)?Mi(v.payload):""}function m(v,w,_,y,b){const E=r.endpointDefinitions[v],j=E==null?void 0:E.onCacheEntryAdded;if(!j)return;const S={},C=new Promise(q=>{S.cacheEntryRemoved=q}),T=Promise.race([new Promise(q=>{S.valueResolved=q}),C.then(()=>{throw Wd})]);T.catch(()=>{}),x[_]=S;const A=e.endpoints[v].select(go(E)?w:_),I=y.dispatch((q,L,D)=>D),P={...y,getCacheEntry:()=>A(y.getState()),requestId:b,extra:I,updateCachedData:go(E)?q=>y.dispatch(e.util.updateQueryData(v,w,q)):void 0,cacheDataLoaded:T,cacheEntryRemoved:C},N=j(w,P);Promise.resolve(N).catch(q=>{if(q!==Wd)throw q})}return g},f1=({api:e,context:{apiUid:t},reducerPath:r})=>(s,i)=>{e.util.resetApiState.match(s)&&i.dispatch(e.internalActions.middlewareRegistered(t))},x1=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:s,queryThunk:i,api:a,assertTagType:o,refetchQuery:l,internalState:d})=>{const{removeQueryResult:c}=a.internalActions,h=fo(ls(s),Tc(s)),x=fo(ls(s,i),_c(s,i));let u=[];const p=(m,v)=>{h(m)?f(sf(m,"invalidatesTags",r,o),v):x(m)?f([],v):a.util.invalidateTags.match(m)&&f(Oc(m.payload,void 0,void 0,void 0,void 0,o),v)};function g(m){var _;const{queries:v,mutations:w}=m;for(const y of[v,w])for(const b in y)if(((_=y[b])==null?void 0:_.status)==="pending")return!0;return!1}function f(m,v){const w=v.getState(),_=w[e];if(u.push(...m),_.config.invalidationBehavior==="delayed"&&g(_))return;const y=u;if(u=[],y.length===0)return;const b=a.util.selectInvalidatedBy(w,y);t.batch(()=>{const E=Array.from(b.values());for(const{queryCacheKey:j}of E){const S=_.queries[j],C=d.currentSubscriptions[j]??{};S&&(zs(C)===0?v.dispatch(c({queryCacheKey:j})):S.status!=="uninitialized"&&v.dispatch(l(S)))}})}return p},p1=({reducerPath:e,queryThunk:t,api:r,refetchQuery:s,internalState:i})=>{const a={},o=(u,p)=>{(r.internalActions.updateSubscriptionOptions.match(u)||r.internalActions.unsubscribeQueryResult.match(u))&&d(u.payload,p),(t.pending.match(u)||t.rejected.match(u)&&u.meta.condition)&&d(u.meta.arg,p),(t.fulfilled.match(u)||t.rejected.match(u)&&!u.meta.condition)&&l(u.meta.arg,p),r.util.resetApiState.match(u)&&h()};function l({queryCacheKey:u},p){const g=p.getState()[e],f=g.queries[u],m=i.currentSubscriptions[u];if(!f||f.status==="uninitialized")return;const{lowestPollingInterval:v,skipPollingIfUnfocused:w}=x(m);if(!Number.isFinite(v))return;const _=a[u];_!=null&&_.timeout&&(clearTimeout(_.timeout),_.timeout=void 0);const y=Date.now()+v;a[u]={nextPollTimestamp:y,pollingInterval:v,timeout:setTimeout(()=>{(g.config.focused||!w)&&p.dispatch(s(f)),l({queryCacheKey:u},p)},v)}}function d({queryCacheKey:u},p){const f=p.getState()[e].queries[u],m=i.currentSubscriptions[u];if(!f||f.status==="uninitialized")return;const{lowestPollingInterval:v}=x(m);if(!Number.isFinite(v)){c(u);return}const w=a[u],_=Date.now()+v;(!w||_<w.nextPollTimestamp)&&l({queryCacheKey:u},p)}function c(u){const p=a[u];p!=null&&p.timeout&&clearTimeout(p.timeout),delete a[u]}function h(){for(const u of Object.keys(a))c(u)}function x(u={}){let p=!1,g=Number.POSITIVE_INFINITY;for(let f in u)u[f].pollingInterval&&(g=Math.min(u[f].pollingInterval,g),p=u[f].skipPollingIfUnfocused||p);return{lowestPollingInterval:g,skipPollingIfUnfocused:p}}return o},m1=({api:e,context:t,queryThunk:r,mutationThunk:s})=>{const i=Tu(r,s),a=_c(r,s),o=ls(r,s),l={};return(c,h)=>{var x,u;if(i(c)){const{requestId:p,arg:{endpointName:g,originalArgs:f}}=c.meta,m=t.endpointDefinitions[g],v=m==null?void 0:m.onQueryStarted;if(v){const w={},_=new Promise((j,S)=>{w.resolve=j,w.reject=S});_.catch(()=>{}),l[p]=w;const y=e.endpoints[g].select(go(m)?f:p),b=h.dispatch((j,S,C)=>C),E={...h,getCacheEntry:()=>y(h.getState()),requestId:p,extra:b,updateCachedData:go(m)?j=>h.dispatch(e.util.updateQueryData(g,f,j)):void 0,queryFulfilled:_};v(f,E)}}else if(o(c)){const{requestId:p,baseQueryMeta:g}=c.meta;(x=l[p])==null||x.resolve({data:c.payload,meta:g}),delete l[p]}else if(a(c)){const{requestId:p,rejectedWithValue:g,baseQueryMeta:f}=c.meta;(u=l[p])==null||u.reject({error:c.payload??c.error,isUnhandledError:!g,meta:f}),delete l[p]}}},g1=({reducerPath:e,context:t,api:r,refetchQuery:s,internalState:i})=>{const{removeQueryResult:a}=r.internalActions,o=(d,c)=>{Dc.match(d)&&l(c,"refetchOnFocus"),Lc.match(d)&&l(c,"refetchOnReconnect")};function l(d,c){const h=d.getState()[e],x=h.queries,u=i.currentSubscriptions;t.batch(()=>{for(const p of Object.keys(u)){const g=x[p],f=u[p];if(!f||!g)continue;(Object.values(f).some(v=>v[c]===!0)||Object.values(f).every(v=>v[c]===void 0)&&h.config[c])&&(zs(f)===0?d.dispatch(a({queryCacheKey:p})):g.status!=="uninitialized"&&d.dispatch(s(g)))}})}return o};function y1(e){const{reducerPath:t,queryThunk:r,api:s,context:i}=e,{apiUid:a}=i,o={invalidateTags:Js(`${t}/invalidateTags`)},l=x=>x.type.startsWith(`${t}/`),d=[f1,h1,x1,p1,u1,m1];return{middleware:x=>{let u=!1;const g={...e,internalState:{currentSubscriptions:{}},refetchQuery:h,isThisApiSliceAction:l},f=d.map(w=>w(g)),m=l1(g),v=g1(g);return w=>_=>{if(!np(_))return w(_);u||(u=!0,x.dispatch(s.internalActions.middlewareRegistered(a)));const y={...x,next:w},b=x.getState(),[E,j]=m(_,y,b);let S;if(E?S=w(_):S=j,x.getState()[t]&&(v(_,y,b),l(_)||i.hasRehydrationInfo(_)))for(const C of f)C(_,y,b);return S}},actions:o};function h(x){return e.api.endpoints[x.endpointName].initiate(x.originalArgs,{subscribe:!1,forceRefetch:!0})}}var Hd=Symbol(),lf=({createSelector:e=Su}={})=>({name:Hd,init(t,{baseQuery:r,tagTypes:s,reducerPath:i,serializeQueryArgs:a,keepUnusedDataFor:o,refetchOnMountOrArgChange:l,refetchOnFocus:d,refetchOnReconnect:c,invalidationBehavior:h,onSchemaFailure:x,catchSchemaFailure:u,skipSchemaValidation:p},g){ep();const f=F=>F;Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Lc,onOffline:tf,onFocus:Dc,onFocusLost:ef},util:{}});const m=o1({serializeQueryArgs:a,reducerPath:i,createSelector:e}),{selectInvalidatedBy:v,selectCachedArgsForQuery:w,buildQuerySelector:_,buildInfiniteQuerySelector:y,buildMutationSelector:b}=m;yn(t.util,{selectInvalidatedBy:v,selectCachedArgsForQuery:w});const{queryThunk:E,infiniteQueryThunk:j,mutationThunk:S,patchQueryData:C,updateQueryData:T,upsertQueryData:A,prefetch:I,buildMatchThunkActions:P}=i1({baseQuery:r,reducerPath:i,context:g,api:t,serializeQueryArgs:a,assertTagType:f,selectors:m,onSchemaFailure:x,catchSchemaFailure:u,skipSchemaValidation:p}),{reducer:N,actions:q}=a1({context:g,queryThunk:E,mutationThunk:S,serializeQueryArgs:a,reducerPath:i,assertTagType:f,config:{refetchOnFocus:d,refetchOnReconnect:c,refetchOnMountOrArgChange:l,keepUnusedDataFor:o,reducerPath:i,invalidationBehavior:h}});yn(t.util,{patchQueryData:C,updateQueryData:T,upsertQueryData:A,prefetch:I,resetApiState:q.resetApiState,upsertQueryEntries:q.cacheEntriesUpserted}),yn(t.internalActions,q);const{middleware:L,actions:D}=y1({reducerPath:i,context:g,queryThunk:E,mutationThunk:S,infiniteQueryThunk:j,api:t,assertTagType:f,selectors:m});yn(t.util,D),yn(t,{reducer:N,middleware:L});const{buildInitiateQuery:M,buildInitiateInfiniteQuery:J,buildInitiateMutation:ne,getRunningMutationThunk:Z,getRunningMutationsThunk:R,getRunningQueriesThunk:U,getRunningQueryThunk:B}=n1({queryThunk:E,mutationThunk:S,infiniteQueryThunk:j,api:t,serializeQueryArgs:a,context:g});return yn(t.util,{getRunningMutationThunk:Z,getRunningMutationsThunk:R,getRunningQueryThunk:B,getRunningQueriesThunk:U}),{name:Hd,injectEndpoint(F,V){var me;const xe=(me=t.endpoints)[F]??(me[F]={});$o(V)&&yn(xe,{name:F,select:_(F,V),initiate:M(F,V)},P(E,F)),e1(V)&&yn(xe,{name:F,select:b(),initiate:ne(F)},P(S,F)),Uo(V)&&yn(xe,{name:F,select:y(F,V),initiate:J(F,V)},P(E,F))}}}});lf();function xa(e){return e.replace(e[0],e[0].toUpperCase())}function v1(e){return e.type==="query"}function b1(e){return e.type==="mutation"}function cf(e){return e.type==="infinitequery"}function hi(e,...t){return Object.assign(e,...t)}var dl=Symbol();function hl(e,t,r,s){const i=k.useMemo(()=>({queryArgs:e,serialized:typeof e=="object"?t({queryArgs:e,endpointDefinition:r,endpointName:s}):e}),[e,t,r,s]),a=k.useRef(i);return k.useEffect(()=>{a.current.serialized!==i.serialized&&(a.current=i)},[i]),a.current.serialized===i.serialized?a.current.queryArgs:e}function pa(e){const t=k.useRef(e);return k.useEffect(()=>{vi(t.current,e)||(t.current=e)},[e]),vi(t.current,e)?t.current:e}var w1=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",j1=w1(),S1=()=>typeof navigator<"u"&&navigator.product==="ReactNative",E1=S1(),T1=()=>j1||E1?k.useLayoutEffect:k.useEffect,_1=T1(),Vd=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:Ju.pending}:e;function ul(e,...t){const r={};return t.forEach(s=>{r[s]=e[s]}),r}var fl=["data","status","isLoading","isSuccess","isError","error"];function k1({api:e,moduleOptions:{batch:t,hooks:{useDispatch:r,useSelector:s,useStore:i},unstable__sideEffectsInRender:a,createSelector:o},serializeQueryArgs:l,context:d}){const c=a?y=>y():k.useEffect;return{buildQueryHooks:v,buildInfiniteQueryHooks:w,buildMutationHook:_,usePrefetch:u};function h(y,b,E){if(b!=null&&b.endpointName&&y.isUninitialized){const{endpointName:I}=b,P=d.endpointDefinitions[I];E!==zr&&l({queryArgs:b.originalArgs,endpointDefinition:P,endpointName:I})===l({queryArgs:E,endpointDefinition:P,endpointName:I})&&(b=void 0)}let j=y.isSuccess?y.data:b==null?void 0:b.data;j===void 0&&(j=y.data);const S=j!==void 0,C=y.isLoading,T=(!b||b.isLoading||b.isUninitialized)&&!S&&C,A=y.isSuccess||S&&(C&&!(b!=null&&b.isError)||y.isUninitialized);return{...y,data:j,currentData:y.data,isFetching:C,isLoading:T,isSuccess:A}}function x(y,b,E){if(b!=null&&b.endpointName&&y.isUninitialized){const{endpointName:I}=b,P=d.endpointDefinitions[I];E!==zr&&l({queryArgs:b.originalArgs,endpointDefinition:P,endpointName:I})===l({queryArgs:E,endpointDefinition:P,endpointName:I})&&(b=void 0)}let j=y.isSuccess?y.data:b==null?void 0:b.data;j===void 0&&(j=y.data);const S=j!==void 0,C=y.isLoading,T=(!b||b.isLoading||b.isUninitialized)&&!S&&C,A=y.isSuccess||C&&S;return{...y,data:j,currentData:y.data,isFetching:C,isLoading:T,isSuccess:A}}function u(y,b){const E=r(),j=pa(b);return k.useCallback((S,C)=>E(e.util.prefetch(y,S,{...j,...C})),[y,E,j])}function p(y,b,{refetchOnReconnect:E,refetchOnFocus:j,refetchOnMountOrArgChange:S,skip:C=!1,pollingInterval:T=0,skipPollingIfUnfocused:A=!1,...I}={}){const{initiate:P}=e.endpoints[y],N=r(),q=k.useRef(void 0);if(!q.current){const F=N(e.internalActions.internal_getRTKQSubscriptions());q.current=F}const L=hl(C?zr:b,yo,d.endpointDefinitions[y],y),D=pa({refetchOnReconnect:E,refetchOnFocus:j,pollingInterval:T,skipPollingIfUnfocused:A}),M=I.initialPageParam,J=pa(M),ne=k.useRef(void 0);let{queryCacheKey:Z,requestId:R}=ne.current||{},U=!1;Z&&R&&(U=q.current.isRequestSubscribed(Z,R));const B=!U&&ne.current!==void 0;return c(()=>{B&&(ne.current=void 0)},[B]),c(()=>{var se;const F=ne.current;if(L===zr){F==null||F.unsubscribe(),ne.current=void 0;return}const V=(se=ne.current)==null?void 0:se.subscriptionOptions;if(!F||F.arg!==L){F==null||F.unsubscribe();const xe=N(P(L,{subscriptionOptions:D,forceRefetch:S,...cf(d.endpointDefinitions[y])?{initialPageParam:J}:{}}));ne.current=xe}else D!==V&&F.updateSubscriptionOptions(D)},[N,P,S,L,D,B,J,y]),[ne,N,P,D]}function g(y,b){return(j,{skip:S=!1,selectFromResult:C}={})=>{const{select:T}=e.endpoints[y],A=hl(S?zr:j,l,d.endpointDefinitions[y],y),I=k.useRef(void 0),P=k.useMemo(()=>o([T(A),(M,J)=>J,M=>A],b,{memoizeOptions:{resultEqualityCheck:vi}}),[T,A]),N=k.useMemo(()=>C?o([P],C,{devModeChecks:{identityFunctionCheck:"never"}}):P,[P,C]),q=s(M=>N(M,I.current),vi),L=i(),D=P(L.getState(),I.current);return _1(()=>{I.current=D},[D]),q}}function f(y){k.useEffect(()=>()=>{var b,E;(E=(b=y.current)==null?void 0:b.unsubscribe)==null||E.call(b),y.current=void 0},[y])}function m(y){if(!y.current)throw new Error(ju(38));return y.current.refetch()}function v(y){const b=(S,C={})=>{const[T]=p(y,S,C);return f(T),k.useMemo(()=>({refetch:()=>m(T)}),[T])},E=({refetchOnReconnect:S,refetchOnFocus:C,pollingInterval:T=0,skipPollingIfUnfocused:A=!1}={})=>{const{initiate:I}=e.endpoints[y],P=r(),[N,q]=k.useState(dl),L=k.useRef(void 0),D=pa({refetchOnReconnect:S,refetchOnFocus:C,pollingInterval:T,skipPollingIfUnfocused:A});c(()=>{var R,U;const Z=(R=L.current)==null?void 0:R.subscriptionOptions;D!==Z&&((U=L.current)==null||U.updateSubscriptionOptions(D))},[D]);const M=k.useRef(D);c(()=>{M.current=D},[D]);const J=k.useCallback(function(Z,R=!1){let U;return t(()=>{var B;(B=L.current)==null||B.unsubscribe(),L.current=U=P(I(Z,{subscriptionOptions:M.current,forceRefetch:!R})),q(Z)}),U},[P,I]),ne=k.useCallback(()=>{var Z,R;(Z=L.current)!=null&&Z.queryCacheKey&&P(e.internalActions.removeQueryResult({queryCacheKey:(R=L.current)==null?void 0:R.queryCacheKey}))},[P]);return k.useEffect(()=>()=>{var Z;(Z=L==null?void 0:L.current)==null||Z.unsubscribe()},[]),k.useEffect(()=>{N!==dl&&!L.current&&J(N,!0)},[N,J]),k.useMemo(()=>[J,N,{reset:ne}],[J,N,ne])},j=g(y,h);return{useQueryState:j,useQuerySubscription:b,useLazyQuerySubscription:E,useLazyQuery(S){const[C,T,{reset:A}]=E(S),I=j(T,{...S,skip:T===dl}),P=k.useMemo(()=>({lastArg:T}),[T]);return k.useMemo(()=>[C,{...I,reset:A},P],[C,I,A,P])},useQuery(S,C){const T=b(S,C),A=j(S,{selectFromResult:S===zr||C!=null&&C.skip?void 0:Vd,...C}),I=ul(A,...fl);return k.useDebugValue(I),k.useMemo(()=>({...A,...T}),[A,T])}}}function w(y){const b=(j,S={})=>{const[C,T,A,I]=p(y,j,S),P=k.useRef(I);c(()=>{P.current=I},[I]);const N=k.useCallback(function(D,M){let J;return t(()=>{var ne;(ne=C.current)==null||ne.unsubscribe(),C.current=J=T(A(D,{subscriptionOptions:P.current,direction:M}))}),J},[C,T,A]);f(C);const q=hl(S.skip?zr:j,yo,d.endpointDefinitions[y],y),L=k.useCallback(()=>m(C),[C]);return k.useMemo(()=>({trigger:N,refetch:L,fetchNextPage:()=>N(q,"forward"),fetchPreviousPage:()=>N(q,"backward")}),[L,N,q])},E=g(y,x);return{useInfiniteQueryState:E,useInfiniteQuerySubscription:b,useInfiniteQuery(j,S){const{refetch:C,fetchNextPage:T,fetchPreviousPage:A}=b(j,S),I=E(j,{selectFromResult:j===zr||S!=null&&S.skip?void 0:Vd,...S}),P=ul(I,...fl,"hasNextPage","hasPreviousPage");return k.useDebugValue(P),k.useMemo(()=>({...I,fetchNextPage:T,fetchPreviousPage:A,refetch:C}),[I,T,A,C])}}}function _(y){return({selectFromResult:b,fixedCacheKey:E}={})=>{const{select:j,initiate:S}=e.endpoints[y],C=r(),[T,A]=k.useState();k.useEffect(()=>()=>{T!=null&&T.arg.fixedCacheKey||T==null||T.reset()},[T]);const I=k.useCallback(function(Z){const R=C(S(Z,{fixedCacheKey:E}));return A(R),R},[C,S,E]),{requestId:P}=T||{},N=k.useMemo(()=>j({fixedCacheKey:E,requestId:T==null?void 0:T.requestId}),[E,T,j]),q=k.useMemo(()=>b?o([N],b):N,[b,N]),L=s(q,vi),D=E==null?T==null?void 0:T.arg.originalArgs:void 0,M=k.useCallback(()=>{t(()=>{T&&A(void 0),E&&C(e.internalActions.removeMutationResult({requestId:P,fixedCacheKey:E}))})},[C,E,T,P]),J=ul(L,...fl,"endpointName");k.useDebugValue(J);const ne=k.useMemo(()=>({...L,originalArgs:D,reset:M}),[L,D,M]);return k.useMemo(()=>[I,ne],[I,ne])}}}var C1=Symbol(),A1=({batch:e=ap,hooks:t={useDispatch:it,useSelector:Me,useStore:op},createSelector:r=Su,unstable__sideEffectsInRender:s=!1,...i}={})=>({name:C1,init(a,{serializeQueryArgs:o},l){const d=a,{buildQueryHooks:c,buildInfiniteQueryHooks:h,buildMutationHook:x,usePrefetch:u}=k1({api:a,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:s,createSelector:r},serializeQueryArgs:o,context:l});return hi(d,{usePrefetch:u}),hi(l,{batch:e}),{injectEndpoint(p,g){if(v1(g)){const{useQuery:f,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:w,useQuerySubscription:_}=c(p);hi(d.endpoints[p],{useQuery:f,useLazyQuery:m,useLazyQuerySubscription:v,useQueryState:w,useQuerySubscription:_}),a[`use${xa(p)}Query`]=f,a[`useLazy${xa(p)}Query`]=m}if(b1(g)){const f=x(p);hi(d.endpoints[p],{useMutation:f}),a[`use${xa(p)}Mutation`]=f}else if(cf(g)){const{useInfiniteQuery:f,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}=h(p);hi(d.endpoints[p],{useInfiniteQuery:f,useInfiniteQuerySubscription:m,useInfiniteQueryState:v}),a[`use${xa(p)}InfiniteQuery`]=f}}}}}),Bc=of(lf(),A1());const I1="/api",Va=Bc({reducerPath:"exhibitorInvoiceApi",baseQuery:Pc({baseUrl:I1,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("exhibitor_token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["ExhibitorInvoice"],endpoints:e=>({getExhibitorInvoice:e.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,r,s)=>[{type:"ExhibitorInvoice",id:s}]}),downloadExhibitorInvoice:e.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:r})})})}),{useGetExhibitorInvoiceQuery:N1,useDownloadExhibitorInvoiceMutation:F1,useShareViaEmailMutation:R1,useShareViaWhatsAppMutation:P1}=Va,df=({booking:e})=>{var T,A,I;const[t,r]=k.useState(null),[s,i]=k.useState(!0),a=Me(P=>P.settings.settings);k.useEffect(()=>{(async()=>{i(!0);try{if(e.exhibitionId.headerLogo){const N=e.exhibitionId.headerLogo;r(`${Ee.defaults.baseURL}/public/uploads/${N}`),console.log("Using exhibition header logo:",N)}else if(a!=null&&a.logo){const N=a.logo;r(`${Ee.defaults.baseURL}/public/uploads/${N}`),console.log("Using global settings logo:",N)}else{const N=`${Ee.defaults.baseURL}/public/logo`;r(N),console.log("Using public logo endpoint:",N)}}catch(N){console.error("Error loading logo:",N),r(null)}finally{i(!1)}})()},[e.exhibitionId.headerLogo,a==null?void 0:a.logo]);const o=()=>{const P=new Date(e.exhibitionId.startDate||""),N=new Date(e.exhibitionId.endDate||""),q={};let L=new Date(P);for(;L<=N;){const M=L.toLocaleString("default",{month:"short",year:"numeric"});q[M]||(q[M]=[]),q[M].push(L.getDate().toString().padStart(2,"0")),L=new Date(L),L.setDate(L.getDate()+1)}const D=Object.entries(q).map(([M,J])=>`${J.join(", ")} ${M}`);return`${e.exhibitionId.name||"ABSE"} (${D.join(" & ")})`},l=P=>{const N=new Date(P);return{date:N.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:N.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},d=e.stallIds.map((P,N)=>{var M;const q=P,L=P.dimensions.width*P.dimensions.height,D=L*P.ratePerSqm;return{key:P._id,sn:N+1,stallNo:P.number,stallType:((M=q.stallTypeId)==null?void 0:M.name)||"Standard",dimensions:`${P.dimensions.width}x${P.dimensions.height}m`,area:L.toFixed(0),rate:P.ratePerSqm.toFixed(0),amount:D}}),c=d.reduce((P,N)=>P+N.amount,0),h=e.calculations,x=((T=h.stalls[0])==null?void 0:T.discount)!==void 0&&((A=h.stalls[0])==null?void 0:A.discount)!==null,u=x?(I=h.stalls[0])==null?void 0:I.discount:null,p=(u==null?void 0:u.type)||"percentage",g=(u==null?void 0:u.value)||0;let f=0;x&&g>0&&(p==="percentage"?f=Math.round(c*g/100*100)/100:p==="fixed"&&(f=Math.min(g,c)));const m=c-f,v=h.taxes.find(P=>P.name.includes("GST")),w=v?v.rate:18,_=Math.round(m*w/100*100)/100,y=m+_,b=c,E=f,j=m,S=_,C=y;return n.jsx("div",{className:"invoice-container",children:n.jsxs("div",{className:"proforma-invoice",children:[n.jsxs("div",{className:"header-section",children:[n.jsx("div",{className:"logo-cell",children:s?n.jsx("div",{className:"logo-loading",children:"Loading..."}):t?n.jsx("img",{src:t,alt:e.exhibitionId.companyName,className:"logo-image",onError:()=>r(null)}):e.exhibitionId.companyName}),n.jsxs("div",{className:"title-company",children:[n.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),n.jsx("div",{className:"company-cell",children:e.exhibitionId.companyName})]})]}),n.jsxs("div",{className:"bill-to-section",children:[n.jsx("div",{className:"bill-to-cell",children:"Bill To"}),n.jsxs("div",{className:"bill-to-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Company Name"}),n.jsx("div",{className:"value-cell",children:e.companyName}),n.jsx("div",{className:"date-label-cell",children:"Date"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).date})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Phone No."}),n.jsx("div",{className:"value-cell",children:e.customerPhone}),n.jsx("div",{className:"date-label-cell",children:"Time"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).time})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"GST No."}),n.jsx("div",{className:"value-cell",children:e.customerGSTIN}),n.jsx("div",{className:"date-label-cell",children:"Invoice No"}),n.jsx("div",{className:"date-value-cell",children:e.invoiceNumber})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Address"}),n.jsx("div",{className:"value-cell",children:e.customerAddress})]})]})]}),n.jsxs("div",{className:"expo-venue-section",children:[n.jsxs("div",{className:"expo-column",children:[n.jsx("div",{className:"heading",children:"Expo Name"}),n.jsx("div",{className:"content",children:o()})]}),n.jsxs("div",{className:"venue-column",children:[n.jsx("div",{className:"heading",children:"Venue"}),n.jsx("div",{className:"content",children:e.exhibitionId.venue})]})]}),n.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),n.jsxs("div",{className:"stall-table",children:[n.jsxs("div",{className:"stall-header",children:[n.jsx("div",{className:"stall-header-cell",children:"S/N"}),n.jsx("div",{className:"stall-header-cell",children:"Stall No."}),n.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),n.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),n.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),d.map(P=>n.jsxs("div",{className:"stall-row",children:[n.jsx("div",{className:"stall-cell",children:P.sn}),n.jsx("div",{className:"stall-cell",children:P.stallNo}),n.jsx("div",{className:"stall-cell",children:P.stallType}),n.jsx("div",{className:"stall-cell",children:P.dimensions}),n.jsx("div",{className:"stall-cell",children:P.area}),n.jsx("div",{className:"stall-cell",children:Number(P.rate).toLocaleString("en-IN")}),n.jsx("div",{className:"stall-cell",children:P.amount.toLocaleString("en-IN")})]},P.key))]}),n.jsx("div",{className:"section-header",children:"Calculation Summary"}),n.jsxs("div",{className:"calc-table",children:[n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",b.toLocaleString("en-IN")]})]}),x&&E>0&&n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:p==="percentage"?`Discount (${g}%)`:`Discount (Fixed ₹${g.toLocaleString("en-IN")})`}),n.jsxs("div",{className:"calc-value",children:["-₹",E.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:x&&E>0?"Amount after Discount":"Net Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",j.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsxs("div",{className:"calc-label",children:["GST (",w,"%)"]}),n.jsxs("div",{className:"calc-value",children:["₹",S.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row total-row",children:[n.jsx("div",{className:"calc-label",children:"Total Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",C.toLocaleString("en-IN")]})]})]}),n.jsxs("div",{className:"details-section",children:[n.jsxs("div",{className:"bank-details",children:[n.jsx("div",{className:"details-header",children:"Bank Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Bank Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Account No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccount})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccountName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Branch"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankBranch})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"IFSC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankIFSC})]})]}),n.jsxs("div",{className:"company-details",children:[n.jsx("div",{className:"details-header",children:"Company Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"CIN No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyCIN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Pan No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyPAN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"SAC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companySAC})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"GST No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyGST})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Email"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyEmail})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Website"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyWebsite})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Address"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyAddress})]})]})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"PI Instruction"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),n.jsx("div",{className:"signature-section",children:n.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},{Title:D1,Text:L1}=Le,O1=()=>{var E,j,S,C,T,A,I,P,N,q,L,D,M,J,ne,Z,R,U,B;const{id:e}=Fr(),{data:t,isLoading:r,error:s}=N1(e||""),[i]=F1(),[a]=R1(),[o]=P1(),[l,d]=k.useState(!1),[c,h]=k.useState(!1),[x]=H.useForm(),[u]=H.useForm(),[p,g]=k.useState(0),[f,m]=k.useState(!1),v=async()=>{if(e)try{m(!0),g(0),be.loading({content:"Preparing invoice...",key:"download"});const V=(()=>{let se=0;const xe=setInterval(()=>{se+=5,se<=90?(g(se),se%25===0&&be.loading({content:`Downloading: ${se}% complete`,key:"download"})):clearInterval(xe)},200);return xe})();try{const se=await i(e).unwrap();clearInterval(V),g(100),be.loading({content:"Finalizing download...",key:"download"});const xe=URL.createObjectURL(se),me=document.createElement("a");me.href=xe,me.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||e||"download"}.pdf`,document.body.appendChild(me),me.click(),document.body.removeChild(me),URL.revokeObjectURL(xe),be.success({content:"Invoice downloaded successfully",key:"download"})}catch(se){throw clearInterval(V),se}}catch(F){console.error("Error downloading PDF:",F),be.error({content:"Failed to download invoice",key:"download"})}finally{m(!1),setTimeout(()=>g(0),500)}},w=()=>{d(!0)},_=()=>{h(!0)},y=async F=>{try{await a({bookingId:e||"",email:F.email,message:F.message}).unwrap(),be.success(`Invoice sent to ${F.email}`),d(!1),x.resetFields()}catch(V){console.error("Error sending email:",V),be.error("Failed to send email")}},b=async F=>{try{await o({bookingId:e||"",phoneNumber:F.phoneNumber}).unwrap();const V=F.phoneNumber.replace(/\D/g,""),se=encodeURIComponent(F.message);window.open(`https://wa.me/${V}?text=${se}`,"_blank"),h(!1),u.resetFields()}catch(V){console.error("Error opening WhatsApp:",V),be.error("Failed to open WhatsApp")}};return r?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:n.jsx(Qr,{size:"large"})}):s||!t?n.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[n.jsx(D1,{level:3,children:"Invoice Not Found"}),n.jsx(L1,{children:"The requested invoice could not be loaded. Please try again later."})]}):n.jsxs(n.Fragment,{children:[n.jsxs(de,{title:"Invoice Details",style:{margin:"20px"},children:[n.jsx(Ce,{gutter:[16,24],children:n.jsx(K,{span:24,children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(te,{icon:n.jsx(Po,{}),onClick:v,loading:f&&p<100,disabled:f&&p>=100,children:"Download PDF"}),n.jsx(te,{icon:n.jsx(un,{}),onClick:w,disabled:f,children:"Share via Email"}),n.jsx(te,{icon:n.jsx(gu,{}),onClick:_,disabled:f,children:"Share via WhatsApp"})]}),f&&n.jsx(Yr,{percent:p,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),n.jsx(nt,{}),n.jsx(df,{booking:{...t.bookingId,customerGSTIN:(E=t.bookingId)!=null&&E.customerGSTIN||((j=t.bookingId)==null?void 0:j.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(S=t.bookingId)!=null&&S.customerAddress||((C=t.bookingId)==null?void 0:C.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((T=t.bookingId.exhibitionId)==null?void 0:T.companyName)||"",bankName:((A=t.bookingId.exhibitionId)==null?void 0:A.bankName)||"",bankAccount:((I=t.bookingId.exhibitionId)==null?void 0:I.bankAccount)||"",bankAccountName:((P=t.bookingId.exhibitionId)==null?void 0:P.bankAccountName)||"",bankBranch:((N=t.bookingId.exhibitionId)==null?void 0:N.bankBranch)||"",bankIFSC:((q=t.bookingId.exhibitionId)==null?void 0:q.bankIFSC)||"",companyCIN:((L=t.bookingId.exhibitionId)==null?void 0:L.companyCIN)||"",companyPAN:((D=t.bookingId.exhibitionId)==null?void 0:D.companyPAN)||"",companySAC:((M=t.bookingId.exhibitionId)==null?void 0:M.companySAC)||"",companyGST:((J=t.bookingId.exhibitionId)==null?void 0:J.companyGST)||"",companyEmail:((ne=t.bookingId.exhibitionId)==null?void 0:ne.companyEmail)||"",companyWebsite:((Z=t.bookingId.exhibitionId)==null?void 0:Z.companyWebsite)||"",companyAddress:((R=t.bookingId.exhibitionId)==null?void 0:R.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((B=(U=t.bookingId.calculations)==null?void 0:U.stalls)==null?void 0:B.map(F=>({...F,discount:F.discount?{...F.discount,type:F.discount.type||"percentage",value:F.discount.value}:void 0})))||[]}}})]}),n.jsx(Ve,{title:"Share Invoice via Email",visible:l,onCancel:()=>d(!1),footer:null,children:n.jsxs(H,{form:x,layout:"vertical",onFinish:y,children:[n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(he,{placeholder:"example@example.com"})}),n.jsx(H.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(he.TextArea,{rows:4})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ve,{title:"Share Invoice via WhatsApp",visible:c,onCancel:()=>h(!1),footer:null,children:n.jsxs(H,{form:u,layout:"vertical",onFinish:b,children:[n.jsx(H.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:n.jsx(he,{placeholder:"+1234567890"})}),n.jsx(H.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(he.TextArea,{rows:4})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},{Title:Gd,Text:Yd}=Le,{TabPane:Kd}=Gt,B1=()=>{var f;const{notification:e}=Yt.useApp(),[t]=H.useForm(),[r]=H.useForm(),[s,i]=k.useState(!1),[a,o]=k.useState(!1),[l,d]=k.useState(!1),[c,h]=k.useState(null),x=it(),u=Me(m=>m.auth.user);k.useEffect(()=>{(async()=>{try{d(!0);const v=await po.getProfile();v.data&&x(Nu({user:v.data,token:localStorage.getItem("token")||""}))}catch{be.error("Failed to fetch profile")}finally{d(!1)}})()},[x]);const p=async m=>{var v,w;try{h(null),o(!0),await po.changePassword({currentPassword:m.currentPassword,newPassword:m.newPassword}),e.success({message:"Success",description:"Password has been changed successfully"}),r.resetFields()}catch(_){h(((w=(v=_.response)==null?void 0:v.data)==null?void 0:w.message)||"Failed to change password. Please try again.")}finally{o(!1)}},g=()=>u!=null&&u.role?typeof u.role=="string"?u.role:typeof u.role=="object"&&"name"in u.role?u.role.name:"User":"User";return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ce,{gutter:[24,24],align:"middle",children:n.jsxs(K,{flex:"auto",children:[n.jsx(Gd,{level:4,children:"My Account"}),n.jsx(Yd,{type:"secondary",children:"Manage your account settings and change your password"})]})})}),n.jsx(de,{loading:l,children:n.jsxs(Gt,{defaultActiveKey:"account",children:[n.jsx(Kd,{tab:"Account Information",children:n.jsxs(Ce,{gutter:32,children:[n.jsx(K,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Br,{size:100,icon:n.jsx(at,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((f=u==null?void 0:u.username)==null?void 0:f.charAt(0).toUpperCase())||"U"}),n.jsx(Gd,{level:4,children:u==null?void 0:u.username}),n.jsx(Yd,{type:"secondary",children:g()})]})}),n.jsx(K,{span:18,children:n.jsx(H,{layout:"vertical",initialValues:{username:u==null?void 0:u.username,email:u==null?void 0:u.email},disabled:!0,children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter your username"}],children:n.jsx(he,{prefix:n.jsx(at,{}),placeholder:"Username"})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(un,{}),placeholder:"Email Address"})})})]})})})]})},"account"),n.jsxs(Kd,{tab:"Change Password",children:[c&&n.jsx(_t,{message:"Error",description:c,type:"error",showIcon:!0,style:{marginBottom:24}}),n.jsxs(H,{form:r,layout:"vertical",onFinish:p,children:[n.jsx(H.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Current Password"})}),n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:8,message:"Password must be at least 8 characters"}],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:m})=>({validator(v,w){return!w||m("newPassword")===w?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Confirm New Password"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",loading:a,icon:n.jsx(fs,{}),children:"Update Password"})})]})]},"password")]})})]})},{Option:_s}=Pe,{Title:M1,Text:$1}=Le,U1=()=>{const e=it(),{message:t}=Yt.useApp(),[r]=H.useForm(),{settings:s,loading:i}=Me(u=>u.settings),[a,o]=k.useState([]),[l,d]=k.useState(0);k.useEffect(()=>{e(bi())},[e]),k.useEffect(()=>{if(s&&(r.setFieldsValue({siteName:s.siteName,adminEmail:s.adminEmail,language:s.language,timezone:s.timezone,emailNotifications:s.emailNotifications,footerText:s.footerText}),s.logo)){const u=f=>{const m=localStorage.getItem("token");return{url:`${Ee.defaults.baseURL}/uploads/${f}`,token:m}},{url:p,token:g}=u(s.logo);fetch(p,{headers:{authorization:`Bearer ${g}`}}).then(f=>f.blob()).then(f=>{var v;const m=URL.createObjectURL(f);o([{uid:"-1",name:((v=s.logo)==null?void 0:v.split("/").pop())||"logo",status:"done",url:m,thumbUrl:m,type:f.type,response:{path:s.logo}}])}).catch(()=>{o([])})}},[s,r]);const c=u=>{e(wi(u)).unwrap().then(()=>t.success("Settings updated successfully")).catch(p=>t.error(`Failed to update settings: ${p}`))},h={name:"file",action:`${Ee.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:a,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(u){const{status:p,name:g,response:f,uid:m}=u.file;if(p==="uploading"){o([...u.fileList]);return}if(p==="done"&&f){d(0);const v=localStorage.getItem("token"),w=`${Ee.defaults.baseURL}/uploads/${f.path}`;fetch(w,{headers:{authorization:`Bearer ${v}`}}).then(_=>_.blob()).then(_=>{const y=URL.createObjectURL(_);o([{uid:u.file.uid,name:g,status:"done",url:y,thumbUrl:y,type:_.type,response:f}]),t.success(`${g} uploaded successfully`),r.setFieldValue("logo",f.path)}).catch(()=>{t.error(`${g} preview failed to load`),o([])})}else p==="error"?(t.error(`${g} upload failed.`),o([]),d(0)):p==="removed"&&(o([]),r.setFieldValue("logo",null),d(0))},onRemove(){return o([]),r.setFieldValue("logo",null),d(0),!0},customRequest:async({file:u,onSuccess:p,onError:g,onProgress:f})=>{try{e(Ha(u)).unwrap().then(m=>{p&&p(m)}).catch(m=>{g&&g(new Error(m))})}catch(m){g&&g(m)}}},x=n.jsx("div",{children:l>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Yr,{type:"circle",percent:l,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsx(Ce,{gutter:[24,24],align:"middle",children:n.jsx(K,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(M1,{level:4,style:{margin:0},children:"Settings"}),n.jsx($1,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),n.jsx(de,{className:"info-card",children:n.jsxs(H,{form:r,layout:"vertical",onFinish:c,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[n.jsxs(Ce,{gutter:24,children:[n.jsxs(K,{span:12,children:[n.jsx(H.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:n.jsx(he,{})}),n.jsx(H.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:n.jsx(he,{})}),n.jsx(H.Item,{label:"Language",name:"language",children:n.jsxs(Pe,{children:[n.jsx(_s,{value:"en",children:"English"}),n.jsx(_s,{value:"es",children:"Spanish"}),n.jsx(_s,{value:"fr",children:"French"})]})}),n.jsx(H.Item,{label:"Timezone",name:"timezone",children:n.jsxs(Pe,{children:[n.jsx(_s,{value:"UTC",children:"UTC"}),n.jsx(_s,{value:"EST",children:"EST"}),n.jsx(_s,{value:"PST",children:"PST"})]})}),n.jsx(H.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:n.jsx(Ir,{})})]}),n.jsxs(K,{span:12,children:[n.jsxs(H.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Ri,{...h,children:a.length<1&&x}),a.length>0&&l>0&&n.jsx(Yr,{percent:l,status:"active",style:{marginTop:8}})]}),n.jsx(H.Item,{label:"Footer Text",name:"footerText",children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),n.jsx(H.Item,{children:n.jsxs(ue,{children:[n.jsx(te,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:i,children:"Save Settings"}),n.jsx(te,{onClick:()=>r.resetFields(),icon:n.jsx(Sx,{}),children:"Reset"})]})})]})})]})},z1=async()=>{try{return(await Ee.get("/roles")).data}catch(e){throw console.error("Error fetching roles:",e),e}},q1=async e=>{try{return(await Ee.get(`/roles/${e}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},W1=async e=>{try{return(await Ee.post("/roles",e)).data}catch(t){throw console.error("Error creating role:",t),t}},H1=async(e,t)=>{try{return(await Ee.put(`/roles/${e}`,t)).data}catch(r){throw console.error("Error updating role:",r),r}},V1=async e=>{try{await Ee.delete(`/roles/${e}`)}catch(t){throw console.error("Error deleting role:",t),t}},G1={roles:[],role:null,loading:!1,error:null},qs=Qe("roles/fetchRoles",async(e,{rejectWithValue:t})=>{var r,s;try{return await z1()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch roles")}}),xl=Qe("roles/fetchRoleById",async(e,{rejectWithValue:t})=>{var r,s;try{return await q1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch role")}}),Ga=Qe("roles/addRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await W1(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create role")}}),Ya=Qe("roles/modifyRole",async({id:e,roleData:t},{rejectWithValue:r})=>{var s,i;try{return await H1(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update role")}}),Ka=Qe("roles/removeRole",async(e,{rejectWithValue:t})=>{var r,s;try{return await V1(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete role")}}),hf=gr({name:"roles",initialState:G1,reducers:{clearRoleError:e=>{e.error=null},setSelectedRole:(e,t)=>{e.role=t.payload}},extraReducers:e=>{e.addCase(qs.pending,t=>{t.loading=!0,t.error=null}).addCase(qs.fulfilled,(t,r)=>{t.loading=!1,t.roles=r.payload}).addCase(qs.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(xl.pending,t=>{t.loading=!0,t.error=null}).addCase(xl.fulfilled,(t,r)=>{t.loading=!1,t.role=r.payload}).addCase(xl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ga.pending,t=>{t.loading=!0,t.error=null}).addCase(Ga.fulfilled,(t,r)=>{t.loading=!1,t.roles.push(r.payload)}).addCase(Ga.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ya.pending,t=>{t.loading=!0,t.error=null}).addCase(Ya.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.roles.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.roles[s]=r.payload),((i=t.role)==null?void 0:i._id)===r.payload._id&&(t.role=r.payload)}).addCase(Ya.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ka.pending,t=>{t.loading=!0,t.error=null}).addCase(Ka.fulfilled,(t,r)=>{var s;t.loading=!1,t.roles=t.roles.filter(i=>i._id!==r.payload),((s=t.role)==null?void 0:s._id)===r.payload&&(t.role=null)}).addCase(Ka.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearRoleError:zk,setSelectedRole:qk}=hf.actions,Y1=hf.reducer,{Text:Xd}=Le,K1=[{key:"dashboard_view",label:"View Dashboard",group:"Dashboard"},{key:"dashboard_manage",label:"Manage Dashboard",group:"Dashboard"},{key:"users_view",label:"View Users",group:"Users"},{key:"users_create",label:"Create Users",group:"Users"},{key:"users_edit",label:"Edit Users",group:"Users"},{key:"users_delete",label:"Delete Users",group:"Users"},{key:"roles_view",label:"View Roles",group:"Roles"},{key:"roles_create",label:"Create Roles",group:"Roles"},{key:"roles_edit",label:"Edit Roles",group:"Roles"},{key:"roles_delete",label:"Delete Roles",group:"Roles"},{key:"exhibitions_view",label:"View Exhibitions",group:"Exhibitions"},{key:"exhibitions_create",label:"Create Exhibitions",group:"Exhibitions"},{key:"exhibitions_edit",label:"Edit Exhibitions",group:"Exhibitions"},{key:"exhibitions_delete",label:"Delete Exhibitions",group:"Exhibitions"},{key:"bookings_view",label:"View Bookings",group:"Bookings"},{key:"bookings_create",label:"Create Bookings",group:"Bookings"},{key:"bookings_edit",label:"Edit Bookings",group:"Bookings"},{key:"bookings_delete",label:"Delete Bookings",group:"Bookings"},{key:"exhibitors_view",label:"View Exhibitors",group:"Exhibitors"},{key:"exhibitors_create",label:"Create Exhibitors",group:"Exhibitors"},{key:"exhibitors_edit",label:"Edit Exhibitors",group:"Exhibitors"},{key:"exhibitors_delete",label:"Delete Exhibitors",group:"Exhibitors"},{key:"settings_view",label:"View Settings",group:"Settings"},{key:"settings_edit",label:"Edit Settings",group:"Settings"}],pl=K1.reduce((e,t)=>(e[t.group]||(e[t.group]=[]),e[t.group].push({key:t.key,label:t.label}),e),{}),X1=({visible:e,onCancel:t,onSave:r,role:s,loading:i})=>{const[a]=H.useForm(),o=!!s,[l,d]=k.useState([]);k.useEffect(()=>{if(e)if(s){const g=s.permissions||[];a.setFieldsValue({name:s.name,description:s.description,permissions:g}),d(g)}else a.resetFields(),d([])},[e,s,a]);const c=()=>{a.setFieldsValue({permissions:l}),a.validateFields().then(g=>{r(g)})},h=g=>{const f=pl[g].map(m=>m.key);return f.length>0&&f.every(m=>l.includes(m))},x=(g,f)=>{let m;f?m=[...l,g]:m=l.filter(v=>v!==g),d(m)},u=(g,f)=>{const m=pl[g].map(w=>w.key);let v;if(f){const w=m.filter(_=>!l.includes(_));v=[...l,...w]}else v=l.filter(w=>!m.includes(w));d(v)},p=g=>l.includes(g);return n.jsx(Ve,{title:o?"Edit Role":"Add New Role",open:e,onCancel:t,width:700,footer:[n.jsx(te,{onClick:t,children:"Cancel"},"cancel"),n.jsx(te,{type:"primary",loading:i,onClick:c,children:o?"Update":"Create"},"submit")],children:n.jsxs(H,{form:a,layout:"vertical",initialValues:{name:"",description:"",permissions:[]},children:[n.jsx(H.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:n.jsx(he,{placeholder:"e.g., Administrator, Editor, Viewer"})}),n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please provide a description"}],children:n.jsx(he.TextArea,{placeholder:"Describe the purpose of this role",rows:3})}),n.jsx(nt,{plain:!0,children:"Permissions"}),n.jsx(H.Item,{name:"permissions",hidden:!0,children:n.jsx(he,{})}),n.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"0 8px"},children:Object.entries(pl).map(([g,f])=>n.jsx(de,{size:"small",title:n.jsxs(ue,{children:[n.jsx(Xd,{strong:!0,children:g}),n.jsx(Jl,{checked:h(g),onChange:m=>u(g,m.target.checked),children:"Select All"})]}),style:{marginBottom:16},children:n.jsx(Ce,{gutter:[16,12],children:f.map(m=>n.jsx(K,{span:12,children:n.jsx(Jl,{checked:p(m.key),onChange:v=>x(m.key,v.target.checked),children:n.jsx(Xd,{children:m.label})})},m.key))})},g))})]})})},zo=()=>{const{user:e}=Me(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const s=e.role.permissions;if(s.includes(r)||s.includes("*")||s.includes("all")||s.includes("admin")||s.includes("superadmin")||s.includes("full_access"))return!0;const i=r.split("_");if(i.length===2){const a=i[0],o=i[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(s.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(s=>t(s)),hasAllPermissions:r=>r.every(s=>t(s))}},{Title:ma,Paragraph:Qd,Text:ks}=Le,{confirm:Q1}=Ve;function ml({allowed:e}){return e?n.jsx(bc,{className:"text-success",style:{color:"#52c41a",fontSize:16}}):n.jsx(Ex,{className:"text-danger",style:{color:"#f5222d",fontSize:16}})}function J1(){const{message:e,notification:t}=Yt.useApp(),r=it(),{roles:s,loading:i,error:a}=Me(j=>j.role),[o,l]=k.useState(""),[d,c]=k.useState(!1),[h,x]=k.useState(null),{hasPermission:u}=zo();k.useEffect(()=>{r(qs())},[r]),k.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]);const p=()=>{x(null),c(!0)},g=j=>{x(j),c(!0)},f=j=>{h?r(Ya({id:h._id,roleData:j})).unwrap().then(()=>{c(!1),e.success("Role updated successfully")}).catch(S=>{e.error(`Failed to update role: ${S.message}`)}):r(Ga(j)).unwrap().then(()=>{c(!1),e.success("Role created successfully")}).catch(S=>{e.error(`Failed to create role: ${S.message}`)})},m=j=>{Q1({title:"Are you sure you want to delete this role?",icon:n.jsx(Qs,{}),content:`This will permanently delete the ${j.name} role. This action cannot be undone.`,okText:"Yes, delete it",okType:"danger",cancelText:"Cancel",onOk(){r(Ka(j._id)).unwrap().then(()=>{e.success(`${j.name} role deleted successfully`)}).catch(S=>{e.error(`Failed to delete role: ${S.message}`)})}})},v=[{title:"Role",dataIndex:"name",key:"name",render:(j,S)=>n.jsxs(ue,{children:[n.jsx(Br,{style:{backgroundColor:b(S.name)},children:j.charAt(0).toUpperCase()}),n.jsx(ks,{strong:!0,children:j})]})},{title:"Description",dataIndex:"description",key:"description",render:j=>n.jsx(ks,{type:"secondary",children:j})},{title:"Read",key:"read",align:"center",render:(j,S)=>n.jsx(ml,{allowed:w(S)})},{title:"Write",key:"write",align:"center",render:(j,S)=>n.jsx(ml,{allowed:_(S)})},{title:"Delete",key:"delete",align:"center",render:(j,S)=>n.jsx(ml,{allowed:y(S)})},{title:"Actions",key:"actions",align:"right",render:(j,S)=>n.jsxs(ue,{children:[u("roles_edit")&&n.jsx(ct,{title:S.name==="Administrator"?"Administrator role cannot be edited":"Edit role",children:n.jsx(te,{type:"primary",shape:"circle",icon:n.jsx(as,{}),size:"small",onClick:()=>g(S),disabled:S.name==="Administrator"})}),u("roles_delete")&&n.jsx(ct,{title:"Delete role",children:n.jsx(te,{danger:!0,shape:"circle",icon:n.jsx(ar,{}),size:"small",onClick:()=>m(S),disabled:S.name==="Administrator"})})]})}],w=j=>j.permissions.some(S=>S.endsWith("_view")),_=j=>j.permissions.some(S=>S.endsWith("_create")||S.endsWith("_edit")),y=j=>j.permissions.some(S=>S.endsWith("_delete")),b=j=>{const S=["#1677ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2","#eb2f96"];let C=0;for(let T=0;T<j.length;T++)C=j.charCodeAt(T)+((C<<5)-C);return S[Math.abs(C)%S.length]},E=s.filter(j=>j.name.toLowerCase().includes(o.toLowerCase())||j.description.toLowerCase().includes(o.toLowerCase()));return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(ma,{level:2,children:"Roles & Permissions"}),n.jsx(Qd,{children:"Manage role-based access control and permissions for your users."})]}),n.jsxs(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},loading:i&&s.length===0,children:[n.jsxs(Ce,{gutter:16,style:{marginBottom:16},children:[n.jsx(K,{span:16,children:n.jsx(he,{placeholder:"Search roles...",allowClear:!0,value:o,onChange:j=>l(j.target.value),prefix:n.jsx(ks,{type:"secondary",style:{fontSize:16},children:"🔍"})})}),n.jsx(K,{span:8,style:{textAlign:"right"},children:u("roles_create")&&n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),style:{borderRadius:6},onClick:p,children:"Add Role"})})]}),n.jsx(tt,{columns:v,dataSource:E,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(j,S)=>`Showing ${S[0]}-${S[1]} of ${j} roles`},style:{marginTop:8},loading:i&&s.length>0})]}),n.jsx(de,{title:n.jsx(ma,{level:4,style:{margin:0},children:"Role Management Tips"}),style:{marginTop:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[n.jsxs(ue,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ma,{level:5,children:"Best Practices"}),n.jsxs("ul",{style:{paddingLeft:20},children:[n.jsx("li",{children:n.jsx(ks,{children:"Follow the principle of least privilege"})}),n.jsx("li",{children:n.jsx(ks,{children:"Regularly audit user roles"})}),n.jsx("li",{children:n.jsx(ks,{children:"Document role responsibilities"})})]})]}),n.jsxs(ue,{direction:"vertical",style:{flex:1,minWidth:250},children:[n.jsx(ma,{level:5,children:"Role Inheritance"}),n.jsx(Qd,{children:"Higher-level roles automatically include permissions from lower-level roles to ensure consistency."})]})]})}),n.jsx(X1,{visible:d,onCancel:()=>c(!1),onSave:f,role:h,loading:i})]})}const Z1=async()=>{try{return(await Ee.get("/users")).data}catch(e){throw console.error("Error fetching users:",e),e}},ey=async e=>{try{return(await Ee.get(`/users/${e}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},ty=async e=>{try{return(await Ee.post("/users",e)).data}catch(t){throw console.error("Error creating user:",t),t}},ry=async(e,t)=>{try{return(await Ee.put(`/users/${e}`,t)).data}catch(r){throw console.error("Error updating user:",r),r}},ny=async e=>{try{await Ee.delete(`/users/${e}`)}catch(t){throw console.error("Error deleting user:",t),t}},sy={users:[],selectedUser:null,loading:!1,error:null},ss=Qe("users/fetchUsers",async(e,{rejectWithValue:t})=>{var r,s;try{return await Z1()}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch users")}}),gl=Qe("users/fetchUserById",async(e,{rejectWithValue:t})=>{var r,s;try{return await ey(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch user")}}),Xa=Qe("users/addUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await ty(e)}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create user")}}),Qa=Qe("users/modifyUser",async({id:e,userData:t},{rejectWithValue:r})=>{var s,i;try{return await ry(e,t)}catch(a){return r(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update user")}}),Ja=Qe("users/removeUser",async(e,{rejectWithValue:t})=>{var r,s;try{return await ny(e),e}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete user")}}),uf=gr({name:"users",initialState:sy,reducers:{clearUserError:e=>{e.error=null},setSelectedUser:(e,t)=>{e.selectedUser=t.payload}},extraReducers:e=>{e.addCase(ss.pending,t=>{t.loading=!0,t.error=null}).addCase(ss.fulfilled,(t,r)=>{t.loading=!1,t.users=r.payload}).addCase(ss.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(gl.pending,t=>{t.loading=!0,t.error=null}).addCase(gl.fulfilled,(t,r)=>{t.loading=!1,t.selectedUser=r.payload}).addCase(gl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Xa.pending,t=>{t.loading=!0,t.error=null}).addCase(Xa.fulfilled,(t,r)=>{t.loading=!1,t.users.push(r.payload)}).addCase(Xa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Qa.pending,t=>{t.loading=!0,t.error=null}).addCase(Qa.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.users.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.users[s]=r.payload),((i=t.selectedUser)==null?void 0:i._id)===r.payload._id&&(t.selectedUser=r.payload)}).addCase(Qa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ja.pending,t=>{t.loading=!0,t.error=null}).addCase(Ja.fulfilled,(t,r)=>{var s;t.loading=!1,t.users=t.users.filter(i=>i._id!==r.payload),((s=t.selectedUser)==null?void 0:s._id)===r.payload&&(t.selectedUser=null)}).addCase(Ja.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearUserError:Wk,setSelectedUser:ga}=uf.actions,iy=uf.reducer,{Text:ay}=Le,oy=({visible:e,user:t,onClose:r})=>{if(!t)return null;const s=i=>typeof i=="string"?i:i&&typeof i=="object"&&i.name?i.name:"Unknown";return n.jsxs(Ve,{title:"User Details",open:e,onCancel:r,footer:null,width:600,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:20},children:[n.jsx(Br,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#1677ff"}}),n.jsxs("div",{style:{marginLeft:20},children:[n.jsx(ay,{style:{fontSize:20,fontWeight:"bold"},children:t.name||t.username}),n.jsxs("div",{children:[n.jsx(Se,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"}),n.jsx(Se,{color:"blue",children:s(t.role)})]})]})]}),n.jsx(nt,{}),n.jsxs(We,{bordered:!0,column:1,children:[n.jsx(We.Item,{label:"Username",children:t.username}),n.jsx(We.Item,{label:"Email",children:t.email}),n.jsx(We.Item,{label:"Role",children:s(t.role)}),n.jsx(We.Item,{label:"Status",children:n.jsx(Se,{color:t.isActive?"success":"default",children:t.isActive?"Active":"Inactive"})}),n.jsx(We.Item,{label:"Created At",children:new Date(t.createdAt).toLocaleString()}),n.jsx(We.Item,{label:"Updated At",children:new Date(t.updatedAt).toLocaleString()})]})]})},{Option:ya}=Pe,{Text:ly}=Le,cy=({visible:e,user:t,onClose:r,onSuccess:s})=>{const{message:i}=Yt.useApp(),[a]=H.useForm(),o=it(),{roles:l,loading:d}=Me(x=>x.role),{loading:c}=Me(x=>x.user);k.useEffect(()=>{e&&t&&a.setFieldsValue({username:t.username,name:t.name||"",email:t.email,role:typeof t.role=="object"?t.role._id:t.role,isActive:t.isActive})},[e,t,a]),k.useEffect(()=>{e&&o(qs())},[e,o]);const h=async()=>{if(t)try{const x=await a.validateFields(),u={username:x.username,name:x.name,email:x.email,role:x.role,isActive:x.isActive};x.password&&x.password.trim()!==""&&(u.password=x.password),o(Qa({id:t._id,userData:u})).unwrap().then(()=>{i.success("User updated successfully"),s(),r()}).catch(p=>{i.error(`Failed to update user: ${p}`)})}catch(x){console.error("Validation error:",x)}};return t?n.jsx(Ve,{title:"Edit User",open:e,onCancel:r,width:600,footer:[n.jsx(te,{onClick:r,children:"Cancel"},"cancel"),n.jsx(te,{type:"primary",loading:c,onClick:h,children:"Update User"},"submit")],children:n.jsxs(H,{form:a,layout:"vertical",children:[n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(he,{placeholder:"Username"})}),n.jsx(H.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter a name"}],children:n.jsx(he,{placeholder:"Full name"})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter an email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Email address"})}),n.jsx(nt,{children:n.jsx(ly,{type:"secondary",children:"Change Password (Optional)"})}),n.jsx(H.Item,{name:"password",label:"New Password",extra:"Leave blank to keep the current password",rules:[{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"New password (optional)"})}),n.jsx(nt,{}),n.jsx(H.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Pe,{loading:d,children:l.length>0?l.map(x=>n.jsx(ya,{value:x._id,children:x.name},x._id)):n.jsxs(n.Fragment,{children:[n.jsx(ya,{value:"admin",children:"Admin"}),n.jsx(ya,{value:"manager",children:"Manager"}),n.jsx(ya,{value:"agent",children:"Agent"})]})})}),n.jsx(H.Item,{name:"isActive",label:"Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}):null},{Option:va}=Pe,{Text:Hk}=Le,dy=({visible:e,onClose:t,onSuccess:r})=>{const{message:s}=Yt.useApp(),[i]=H.useForm(),a=it(),{roles:o,loading:l}=Me(h=>h.role),{loading:d}=Me(h=>h.user);k.useEffect(()=>{e&&a(qs())},[e,a]),k.useEffect(()=>{e&&i.resetFields()},[e,i]);const c=async()=>{try{const h=await i.validateFields(),x={username:h.username,name:h.name,email:h.email,password:h.password,role:h.role,isActive:h.status};a(Xa(x)).unwrap().then(u=>{s.success("User created successfully"),i.resetFields(),r(),t()}).catch(u=>{s.error(`Failed to create user: ${u}`)})}catch(h){console.error("Validation error:",h)}};return n.jsx(Ve,{title:"Create New User",open:e,onCancel:t,width:600,footer:[n.jsx(te,{onClick:t,children:"Cancel"},"cancel"),n.jsx(te,{type:"primary",loading:d,onClick:c,children:"Create User"},"submit")],children:n.jsxs(H,{form:i,layout:"vertical",requiredMark:!1,children:[n.jsx(H.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter a username"}],children:n.jsx(he,{placeholder:"Username"})}),n.jsx(H.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter the user name"}],children:n.jsx(he,{placeholder:"Full name"})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Email address"})}),n.jsx(H.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(he.Password,{placeholder:"Enter password"})}),n.jsx(nt,{}),n.jsx(H.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:n.jsx(Pe,{placeholder:"Select role",loading:l,children:o.length>0?o.map(h=>n.jsx(va,{value:h._id,children:h.name},h._id)):n.jsxs(n.Fragment,{children:[n.jsx(va,{value:"admin",children:"Admin"}),n.jsx(va,{value:"manager",children:"Manager"}),n.jsx(va,{value:"agent",children:"Agent"})]})})}),n.jsx(H.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})},{Title:hy,Paragraph:uy,Text:ui}=Le,{TabPane:yl}=Gt,{confirm:fy}=Ve;function xy(){const{message:e,notification:t}=Yt.useApp(),r=it(),{users:s,loading:i,error:a,selectedUser:o}=Me(I=>I.user),[l,d]=k.useState(""),[c,h]=k.useState("all"),[x,u]=k.useState(!1),[p,g]=k.useState(!1),[f,m]=k.useState(!1),{hasPermission:v}=zo();k.useEffect(()=>{r(ss())},[r]),k.useEffect(()=>{a&&t.error({message:"Error",description:a})},[a,t]),k.useEffect(()=>{o||(u(!1),g(!1))},[o]);const w=(I,P)=>{fy({title:"Are you sure you want to delete this user?",icon:n.jsx(Qs,{}),content:`This will permanently delete ${P}'s account. This action cannot be undone.`,okText:"Yes, delete",okType:"danger",cancelText:"Cancel",onOk:()=>{r(Ja(I)).unwrap().then(()=>{e.success(`${P} has been deleted successfully.`)}).catch(N=>{e.error(`Failed to delete user: ${N}`)})}})},_=I=>{r(ga(I)),u(!0)},y=I=>{r(ga(I)),g(!0)},b=()=>{m(!0)},E=[{title:"User",key:"user",render:(I,P)=>n.jsxs(ue,{children:[n.jsx(Br,{icon:n.jsx(at,{}),size:"large"}),n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx(ui,{strong:!0,children:P.name||P.username}),n.jsx(ui,{type:"secondary",style:{fontSize:"12px"},children:P.email})]})]})},{title:"Role",dataIndex:"role",key:"role",render:I=>{const P=C(I);let N=P.toLowerCase()==="admin"||P.toLowerCase()==="administrator"?"#1677ff":P.toLowerCase()==="manager"?"#52c41a":"#faad14";return n.jsx(Se,{color:N,style:{fontWeight:500,borderRadius:"4px"},children:P.toUpperCase()})},filters:[{text:"Admin",value:"admin"},{text:"Manager",value:"manager"},{text:"Agent",value:"agent"}],onFilter:(I,P)=>C(P.role).toLowerCase().indexOf(I.toLowerCase())===0},{title:"Status",key:"status",render:(I,P)=>n.jsx(ue,{children:P.isActive?n.jsx(xr,{status:"success",text:n.jsx(ui,{style:{color:"#52c41a"},children:"Active"})}):n.jsx(xr,{status:"default",text:n.jsx(ui,{type:"secondary",children:"Inactive"})})}),filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(I,P)=>P.isActive===I},{title:"Last Active",key:"lastLogin",render:(I,P)=>n.jsxs(ue,{children:[n.jsx(Vt,{style:{color:"#8c8c8c"}}),n.jsx(ui,{type:"secondary",children:P.lastLogin||"Never"})]})},{title:"Action",key:"action",render:(I,P)=>n.jsxs(ue,{size:"small",children:[v("users_view")&&n.jsx(ct,{title:"View details",children:n.jsx(te,{type:"text",icon:n.jsx(dn,{}),size:"small",onClick:()=>_(P)})}),v("users_edit")&&n.jsx(ct,{title:"Edit user",children:n.jsx(te,{type:"text",icon:n.jsx(as,{}),size:"small",onClick:()=>y(P)})}),v("users_delete")&&n.jsx(ct,{title:"Delete user",children:n.jsx(te,{type:"text",danger:!0,icon:n.jsx(ar,{}),size:"small",onClick:()=>w(P._id,P.name||P.username)})})]})}],j=I=>I.isActive?"active":"inactive",S=s.filter(I=>(c==="all"||c==="active"&&j(I)==="active"||c==="inactive"&&j(I)==="inactive")&&Object.values(I).some(P=>typeof P=="string"&&P.toLowerCase().includes(l.toLowerCase()))),C=I=>typeof I=="string"?I:I&&typeof I=="object"&&I.name?I.name:"Unknown",T={admin:s.filter(I=>{const P=C(I.role).toLowerCase();return P==="admin"||P==="administrator"}).length,manager:s.filter(I=>C(I.role).toLowerCase()==="manager").length,agent:s.filter(I=>C(I.role).toLowerCase()==="agent").length},A={active:s.filter(I=>I.isActive).length,inactive:s.filter(I=>!I.isActive).length};return n.jsxs("div",{style:{padding:"12px 0"},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx(hy,{level:2,children:"User Management"}),n.jsx(uy,{children:"Manage user accounts, permissions, and access control."})]}),n.jsxs(Ce,{gutter:[16,16],style:{marginBottom:24},children:[n.jsx(K,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Total Users",value:s.length,prefix:n.jsx(at,{}),valueStyle:{color:"#1677ff"},loading:i})})}),n.jsx(K,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Active Users",value:A.active,prefix:n.jsx(bc,{}),valueStyle:{color:"#52c41a"},loading:i})})}),n.jsx(K,{xs:24,sm:8,children:n.jsx(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsx(Xe,{title:"Admin Users",value:T.admin,prefix:n.jsx(at,{}),valueStyle:{color:"#faad14"},loading:i})})})]}),n.jsx(de,{style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:n.jsxs(Ce,{gutter:[16,16],justify:"space-between",align:"middle",children:[n.jsx(K,{xs:24,md:12,children:n.jsx(he,{placeholder:"Search users...",prefix:n.jsx(kn,{style:{color:"rgba(0,0,0,.45)"}}),onChange:I=>d(I.target.value),allowClear:!0,size:"middle"})}),n.jsx(K,{xs:24,md:12,style:{textAlign:"right"},children:n.jsxs(ue,{wrap:!0,children:[n.jsx(ct,{title:"Refresh data",children:n.jsx(te,{icon:i?n.jsx(Tx,{}):n.jsx(kn,{}),onClick:()=>r(ss()),disabled:i,children:"Refresh"})}),n.jsx(te,{type:"primary",icon:n.jsx(Ni,{}),onClick:b,children:"Add User"})]})})]})}),n.jsxs(de,{style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.09)"},children:[n.jsxs(Gt,{defaultActiveKey:"all",onChange:h,tabBarStyle:{marginBottom:24},children:[n.jsx(yl,{tab:`All Users (${s.length})`},"all"),n.jsx(yl,{tab:`Active (${A.active})`},"active"),n.jsx(yl,{tab:`Inactive (${A.inactive})`},"inactive")]}),n.jsx(tt,{columns:E,dataSource:S,rowKey:"_id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:(I,P)=>`${P[0]}-${P[1]} of ${I} users`},loading:i})]}),n.jsx(oy,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:x,onClose:()=>r(ga(null))}),n.jsx(cy,{user:s.find(I=>I._id===(o==null?void 0:o._id))||null,visible:p,onClose:()=>r(ga(null)),onSuccess:()=>r(ss())}),n.jsx(dy,{visible:f,onClose:()=>m(!1),onSuccess:()=>r(ss())})]})}const{Title:Vk,Text:ba,Paragraph:fi}=Le,py=({settings:e,onSave:t,loading:r})=>{const[s]=H.useForm();xt.useEffect(()=>{s.setFieldsValue(e)},[e,s]);const i=a=>{t(a)};return n.jsxs(de,{title:n.jsxs(ue,{children:[n.jsx(un,{}),n.jsx("span",{children:"Email Notifications"})]}),style:{marginBottom:24},children:[n.jsx(fi,{children:"Configure which notifications you want to receive via email. Email notifications will be sent to your registered email address."}),n.jsx(_t,{message:"Email Notifications",description:"Email notifications help you stay updated even when you're not logged into the system.",type:"info",showIcon:!0,style:{marginBottom:24}}),n.jsxs(H,{form:s,layout:"vertical",initialValues:e,onFinish:i,children:[n.jsxs(Ce,{gutter:[24,16],children:[n.jsxs(K,{span:24,children:[n.jsx(H.Item,{name:"newLeads",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"New Lead Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive email when new leads are created or assigned to you"})]}),n.jsxs(K,{span:24,children:[n.jsx(H.Item,{name:"followUpReminders",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Follow-up Reminders"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive reminders for upcoming follow-ups"})]}),n.jsxs(K,{span:24,children:[n.jsx(H.Item,{name:"statusChanges",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Status Change Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when lead statuses are updated"})]}),n.jsxs(K,{span:24,children:[n.jsx(H.Item,{name:"leadAssignments",valuePropName:"checked",label:n.jsx(ba,{strong:!0,children:"Lead Assignment Notifications"}),children:n.jsx(Ir,{})}),n.jsx(fi,{type:"secondary",style:{marginTop:-16,marginBottom:16},children:"Receive notifications when leads are assigned to you"})]})]}),n.jsx(nt,{}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",icon:n.jsx(fs,{}),loading:r,children:"Save Email Preferences"})})]})]})},vl=e=>{switch(e){case"NEW_BOOKING":return Pt.NEW_BOOKING;case"BOOKING_CONFIRMED":return Pt.BOOKING_CONFIRMED;case"BOOKING_CANCELLED":return Pt.BOOKING_CANCELLED;case"PAYMENT_RECEIVED":return Pt.PAYMENT_RECEIVED;case"INVOICE_GENERATED":return Pt.INVOICE_GENERATED;case"EXHIBITION_UPDATE":return Pt.EXHIBITION_UPDATE;case"SYSTEM_MESSAGE":return Pt.SYSTEM_MESSAGE;case"EXHIBITOR_MESSAGE":return Pt.EXHIBITOR_MESSAGE;case"EXHIBITOR_REGISTERED":return Pt.EXHIBITOR_REGISTERED;default:return Pt.SYSTEM_MESSAGE}},{Title:my,Text:Gk,Paragraph:Jd}=Le,{Search:gy}=he,{TabPane:Zd}=Gt,yy=()=>{const e=Je();Fr();const[t,r]=k.useState([]),[s,i]=k.useState([]),[a,o]=k.useState(!1),[l,d]=k.useState(""),[c,h]=k.useState("ALL"),[x,u]=k.useState("ALL"),[p,g]=k.useState({newLeads:!0,followUpReminders:!0,statusChanges:!1,leadAssignments:!0}),[f,m]=k.useState(!1),[v,w]=k.useState("all");k.useEffect(()=>{const q=localStorage.getItem("token");q&&pt.init(q,!1),_(),pt.subscribeToNotifications();const L=M=>{const J={...M,type:vl(M.type)};r(ne=>ne.some(Z=>Z._id===M._id)?ne:[J,...ne])},D=M=>{if(M.newNotifications&&M.newNotifications.length>0){const J=M.newNotifications.map(ne=>({...ne,type:vl(ne.type)}));r(ne=>[...J.filter(R=>!ne.some(U=>U._id===R._id)),...ne])}};return pt.addEventListener("notification",L),pt.addEventListener("notification_update",D),()=>{pt.removeEventListener("notification",L),pt.removeEventListener("notification_update",D)}},[]),k.useEffect(()=>{y()},[t,l,c,x,v]),k.useEffect(()=>{_();const N=()=>{t.length===0&&_()};return window.addEventListener("focus",N),()=>{window.removeEventListener("focus",N)}},[t.length]);const _=async()=>{o(!0);try{const N=await pt.getNotifications(1,50);if(N.success){const q=N.data.notifications.map(L=>({...L,type:vl(L.type)}));r(q)}}catch{mn.error({message:"Failed to fetch notifications",description:"There was an error loading your notifications. Please try again later."})}finally{o(!1)}},y=()=>{let N=t;if(v==="unread"&&(N=N.filter(q=>q.isRead===!1)),l){const q=l.toLowerCase();N=N.filter(L=>L.title.toLowerCase().includes(q)||L.message.toLowerCase().includes(q))}c!=="ALL"&&(N=N.filter(q=>q.type===c)),x!=="ALL"&&(N=N.filter(q=>q.source===x)),i(N)},b=N=>{w(N)},E=N=>{d(N)},j=()=>{d(""),h("ALL"),u("ALL"),w("all")},S=N=>{const q=_m(N);e(q)},C=async N=>{try{await pt.markAsRead(N._id);const q=t.map(L=>L._id===N._id?{...L,isRead:!0,readAt:new Date().toISOString()}:L);r(q)}catch{mn.error({message:"Failed to mark notification as read",description:"There was an error updating the notification status. Please try again later."})}},T=async N=>{try{await pt.deleteNotification(N._id);const q=t.filter(L=>L._id!==N._id);r(q),mn.success({message:"Notification deleted",description:"The notification has been deleted successfully."})}catch{mn.error({message:"Failed to delete notification",description:"There was an error deleting the notification. Please try again later."})}},A=async()=>{try{await pt.markAllAsRead();const N=t.map(q=>({...q,isRead:!0,readAt:new Date().toISOString()}));r(N),mn.success({message:"All notifications marked as read",description:"All notifications have been marked as read successfully."})}catch{mn.error({message:"Failed to mark all notifications as read",description:"There was an error updating the notification status. Please try again later."})}},I=async()=>{try{await pt.deleteAllNotifications(),r([]),mn.success({message:"All notifications cleared",description:"All notifications have been deleted successfully."})}catch{mn.error({message:"Failed to clear notifications",description:"There was an error deleting the notifications. Please try again later."})}},P=N=>{m(!0),setTimeout(()=>{g(N),m(!1),mn.success({message:"Settings saved",description:"Your email notification settings have been updated successfully."})},1e3)};return n.jsx("div",{className:"notifications-page",children:n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,children:n.jsx(de,{children:n.jsxs(Ce,{justify:"space-between",align:"middle",children:[n.jsxs(K,{children:[n.jsx(my,{level:4,children:n.jsxs(ue,{children:[n.jsx(gc,{}),"Notifications ",t.length>0?`(${t.length})`:""]})}),n.jsx(Jd,{children:"Stay updated with all your lead activities and follow-ups"})]}),n.jsx(K,{children:n.jsxs(ue,{children:[n.jsx(ct,{title:"Refresh notifications",children:n.jsx(te,{icon:n.jsx(Xs,{}),onClick:_,loading:a,children:"Refresh"})}),n.jsx(te,{type:"primary",icon:n.jsx(yc,{}),onClick:A,disabled:t.filter(N=>!N.isRead).length===0,children:"Mark All as Read"}),n.jsx(te,{type:"primary",danger:!0,icon:n.jsx(ar,{}),onClick:I,disabled:t.length===0,children:"Clear All"})]})})]})})}),n.jsx(K,{xs:24,lg:16,children:n.jsxs(de,{className:"notifications-list-card",style:{marginBottom:24},children:[n.jsxs(Gt,{activeKey:v,onChange:b,tabBarExtraContent:n.jsx(ue,{children:n.jsx(xr,{count:Tm(t),offset:[-5,0],children:n.jsx("span",{style:{padding:"0 8px"},children:"Unread"})})}),children:[n.jsx(Zd,{tab:"All Notifications"},"all"),n.jsx(Zd,{tab:"Unread"},"unread")]}),n.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[n.jsx(gy,{placeholder:"Search notifications...",onSearch:E,style:{width:300},allowClear:!0}),n.jsx(ue,{children:n.jsx(te,{icon:n.jsx(Gi,{}),onClick:j,disabled:l===""&&c==="ALL"&&x==="ALL",children:"Reset Filters"})})]}),n.jsx(an,{dataSource:s,renderItem:N=>n.jsx(Vu,{notification:N,onView:S,onMarkAsRead:C,onDelete:T}),pagination:{pageSize:10,showTotal:(N,q)=>`${q[0]}-${q[1]} of ${N} notifications`},rowKey:"_id",loading:a,locale:{emptyText:n.jsx(mt,{description:n.jsx("span",{children:"No notifications found"})})}})]})}),n.jsxs(K,{xs:24,lg:8,children:[n.jsx(py,{settings:p,onSave:P,loading:f}),n.jsx(de,{title:n.jsxs(ue,{children:[n.jsx(Fi,{}),n.jsx("span",{children:"Notification Tips"})]}),children:n.jsx(Jd,{children:n.jsxs("ul",{children:[n.jsx("li",{children:"Notifications help you stay informed about important lead activities"}),n.jsx("li",{children:"Use email notifications for critical updates when you're away"}),n.jsx("li",{children:"Click on a notification to see more details or take action"}),n.jsx("li",{children:"Mark notifications as read to keep your inbox organized"})]})})})]})]})})};class Xi extends xt.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t;return this.state.hasError?n.jsx(Di,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[n.jsx(te,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),n.jsx(te,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}}const Mt=e=>{var r,s;const t=((s=(r=e.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred";throw new Error(t)},gt={getExhibitions:async()=>{try{return await Ee.get("/exhibitions")}catch(e){return Mt(e)}},getActiveExhibitions:async()=>{try{return await Ee.get("/exhibitions/active")}catch(e){return Mt(e)}},getExhibition:async e=>{try{return await Ee.get(`/exhibitions/${e}`)}catch(t){return Mt(t)}},createExhibition:async e=>{try{return await Ee.post("/exhibitions",e)}catch(t){return Mt(t)}},updateExhibition:async(e,t)=>{try{return await Ee.put(`/exhibitions/${e}`,t)}catch(r){return Mt(r)}},deleteExhibition:async e=>{try{return await Ee.delete(`/exhibitions/${e}`)}catch(t){return Mt(t)}},getHalls:async e=>{try{return await Ee.get(`/exhibitions/${e}/halls`)}catch(t){return Mt(t)}},createHall:async(e,t)=>{try{const{_id:r,id:s,createdAt:i,updatedAt:a,...o}=t;return console.log("Creating hall with data:",{exhibitionId:e,data:o}),(await Ee.post(`/exhibitions/${e}/halls`,o)).data}catch(r){throw console.error("Error creating hall:",r),r}},updateHall:async(e,t,r)=>{try{const{_id:s,id:i,createdAt:a,updatedAt:o,...l}=r;console.log("Updating hall with data:",{exhibitionId:e,hallId:t,data:l});const d=await Ee.put(`/exhibitions/${e}/halls/${t}`,l);return console.log("Hall updated:",d.data),d}catch(s){return console.error("Error updating hall:",s),Mt(s)}},deleteHall:async(e,t)=>{var r,s,i;try{if(!e||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:e,hallId:t});const a=await Ee.delete(`/exhibitions/${e}/halls/${t}`);if(!a.data)throw new Error("No response received from server");return a}catch(a){throw console.error("Error deleting hall:",a),((r=a.response)==null?void 0:r.status)===401?new Error("Unauthorized. Please log in again."):((s=a.response)==null?void 0:s.status)===403?new Error("You do not have permission to delete halls."):((i=a.response)==null?void 0:i.status)===404?new Error("Hall not found."):a}},saveLayout:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(r){return Mt(r)}},getLayout:async e=>{try{if(!e)throw new Error("Exhibition ID is required");return await Ee.get(`/exhibitions/${e}/layout`)}catch(t){return Mt(t)}},getStalls:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await Ee.get(`/exhibitions/${e}/stalls`,{params:{hallId:t}})}catch(r){return Mt(r)}},createStall:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await Ee.post(`/exhibitions/${e}/stalls`,t)}catch(r){return Mt(r)}},updateStall:async(e,t,r)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:e,stallId:t,data:r});const s=await Ee.put(`/exhibitions/${e}/stalls/${t}`,r);return console.log("Stall update response:",s),s}catch(s){return console.error("Error updating stall:",s),Mt(s)}},deleteStall:async(e,t)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");return await Ee.delete(`/exhibitions/${e}/stalls/${t}`)}catch(r){return Mt(r)}},getFixtures:async(e,t)=>{try{const r=`/exhibitions/${e}/fixtures`,s=t?{type:t}:void 0;return await Ee.get(r,{params:s})}catch(r){return Mt(r)}},getFixture:async(e,t)=>{try{return await Ee.get(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Mt(r)}},createFixture:async(e,t)=>{try{return await Ee.post(`/exhibitions/${e}/fixtures`,t)}catch(r){return Mt(r)}},updateFixture:async(e,t,r)=>{try{return await Ee.put(`/exhibitions/${e}/fixtures/${t}`,r)}catch(s){return Mt(s)}},deleteFixture:async(e,t)=>{try{return await Ee.delete(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return Mt(r)}}},vy={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},Lr=Qe("exhibition/fetchExhibitions",async(e,{rejectWithValue:t})=>{try{return(await gt.getExhibitions()).data.map(i=>({...i,id:i._id||i.id})).filter(i=>i.id)}catch(r){return t(r.message)}}),Or=Qe("exhibition/fetchExhibition",async(e,{rejectWithValue:t})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getExhibition(e)).data}catch(r){return t(r.message)}}),Za=Qe("exhibition/createExhibition",async(e,{rejectWithValue:t})=>{try{return(await gt.createExhibition(e)).data}catch(r){return t(r.message)}}),eo=Qe("exhibition/updateExhibition",async({id:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.updateExhibition(e,t)).data}catch(s){return r(s.message)}}),hn=Qe("exhibition/fetchHalls",async(e,{rejectWithValue:t})=>{var r;try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getHalls(e)).data}catch(s){return((r=s.response)==null?void 0:r.status)===404?[]:t(s.message)}}),cn=Qe("exhibition/fetchStalls",async({exhibitionId:e,hallId:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getStalls(e,t)).data}catch(s){return r(s.message)}}),ji=Qe("exhibition/deleteExhibition",async(e,{rejectWithValue:t})=>{try{return await gt.deleteExhibition(e),e}catch(r){return t(r.message)}}),Si=Qe("exhibition/fetchFixtures",async({exhibitionId:e,type:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.getFixtures(e,t)).data}catch(s){return r(s.message)}}),to=Qe("exhibition/createFixture",async({exhibitionId:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await gt.createFixture(e,t)).data}catch(s){return r(s.message)}}),ro=Qe("exhibition/updateFixture",async({exhibitionId:e,id:t,data:r},{rejectWithValue:s})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await gt.updateFixture(e,t,r)).data}catch(i){return s(i.message)}}),no=Qe("exhibition/deleteFixture",async({exhibitionId:e,id:t},{rejectWithValue:r})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return await gt.deleteFixture(e,t),t}catch(s){return r(s.message)}}),ff=gr({name:"exhibition",initialState:vy,reducers:{clearCurrentExhibition:e=>{e.currentExhibition=null,e.halls=[],e.stalls=[],e.fixtures=[],e.error=null},clearError:e=>{e.error=null},clearStalls:e=>{e.stalls=[]},clearFixtures:e=>{e.fixtures=[]}},extraReducers:e=>{e.addCase(Lr.pending,t=>{t.loading=!0,t.error=null}).addCase(Lr.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=r.payload}).addCase(Lr.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Or.pending,t=>{t.loading=!0,t.error=null}).addCase(Or.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload}).addCase(Or.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Za.pending,t=>{t.loading=!0,t.error=null}).addCase(Za.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions.push(r.payload)}).addCase(Za.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(eo.pending,t=>{t.loading=!0,t.error=null}).addCase(eo.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload;const s=t.exhibitions.findIndex(i=>i.id===r.payload.id);s!==-1&&(t.exhibitions[s]=r.payload)}).addCase(eo.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(hn.pending,t=>{t.loading=!0,t.error=null}).addCase(hn.fulfilled,(t,r)=>{t.loading=!1,t.halls=r.payload}).addCase(hn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(cn.pending,t=>{t.loading=!0,t.error=null}).addCase(cn.fulfilled,(t,r)=>{t.loading=!1;const s=r.payload.map(i=>{var a;return{...i,id:i._id||i.id,_id:i._id||i.id,stallTypeId:typeof i.stallTypeId=="string"?i.stallTypeId:(a=i.stallTypeId)==null?void 0:a._id,stallType:i.stallType||{name:"N/A",description:null}}});r.meta.arg.hallId,t.stalls=s}).addCase(cn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ji.pending,t=>{t.loading=!0,t.error=null}).addCase(ji.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(s=>(s._id||s.id)!==r.payload)}).addCase(ji.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Si.pending,t=>{t.loading=!0,t.error=null}).addCase(Si.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=r.payload.map(s=>({...s,id:s._id||s.id,_id:s._id||s.id}))}).addCase(Si.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(to.pending,t=>{t.loading=!0,t.error=null}).addCase(to.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id};t.fixtures.push(s)}).addCase(to.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ro.pending,t=>{t.loading=!0,t.error=null}).addCase(ro.fulfilled,(t,r)=>{t.loading=!1;const s={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id},i=t.fixtures.findIndex(a=>a.id===s.id||a._id===s._id);i!==-1&&(t.fixtures[i]=s)}).addCase(ro.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(no.pending,t=>{t.loading=!0,t.error=null}).addCase(no.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=t.fixtures.filter(s=>s.id!==r.payload&&s._id!==r.payload)}).addCase(no.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearCurrentExhibition:Yk,clearError:Kk,clearStalls:Xk,clearFixtures:Qk}=ff.actions,by=ff.reducer,Lt=(e,t)=>{if(!e)return"";let s=`/exhibition/${e.slug||e._id||e.id}`;return t&&(s+=`/${t}`),s},qo=(e,t)=>e?`/exhibitions/${e.slug||e._id||e.id}`:"",{Title:wy,Text:Zn}=Le,{RangePicker:jy}=xs,Sy=()=>{const{message:e,modal:t}=Yt.useApp(),r=Je(),s=it(),{exhibitions:i,loading:a}=Me(N=>N.exhibition),[o,l]=k.useState([]),[d,c]=k.useState(!1),[h,x]=k.useState(!1),[u,p]=k.useState({status:[],dateRange:null,search:"",activeStatus:null}),[g,f]=k.useState("all"),{hasPermission:m}=zo();k.useEffect(()=>{s(Lr())},[s]);const v=k.useMemo(()=>{const N=i.length,q=i.filter(J=>J.status==="published").length,L=i.filter(J=>new Date(J.startDate)>new Date).length,D=i.filter(J=>J.status==="completed").length,M=i.filter(J=>J.isActive).length;return{total:N,active:q,upcoming:L,completed:D,activeCount:M}},[i]),w=async N=>{const q=N._id||N.id;try{c(!0),await s(ji(q)).unwrap(),e.success("Exhibition deleted successfully")}catch(L){e.error(L.message||"Failed to delete exhibition")}finally{c(!1)}},_=async()=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(ar,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsxs("strong",{children:[o.length," selected exhibitions"]}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(te,{onClick:()=>Ve.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(te,{danger:!0,type:"primary",onClick:async()=>{try{c(!0),await Promise.all(o.map(N=>s(ji(N._id||N.id)).unwrap())),e.success(`Successfully deleted ${o.length} exhibitions`),l([])}catch(N){e.error(N.message||"Failed to delete some exhibitions")}finally{c(!1),Ve.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},y=async(N,q)=>{try{x(!0);const L=N._id||N.id;await gt.updateExhibition(L,{status:q});const D=i.map(M=>(M._id||M.id)===L?{...M,status:q}:M);s(Lr.fulfilled(D,"",void 0)),e.success("Status updated successfully")}catch{e.error("Failed to update status"),s(Lr())}finally{x(!1)}},b=async(N,q)=>{try{x(!0);const L=N._id||N.id;await gt.updateExhibition(L,{isActive:q});const D=i.map(M=>(M._id||M.id)===L?{...M,isActive:q}:M);s(Lr.fulfilled(D,"",void 0)),e.success(`Exhibition ${q?"activated":"deactivated"} successfully`)}catch{e.error("Failed to update active status"),s(Lr())}finally{x(!1)}},E=(N,q)=>{const L=N._id||N.id;q==="/layout"?r(Lt(N,"layout"),{state:{exhibitionId:L}}):r(Lt(N)+q,{state:{exhibitionId:L}})},j=N=>{switch(N.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},S=(N,q)=>{const L=j(N);return n.jsxs(ue,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[n.jsx(Se,{color:L,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:N}),!q&&n.jsx(Se,{color:"red",style:{margin:0},children:"Inactive"})]})},C=N=>{const q=new Date,L=new Date(N.startDate),D=new Date(N.endDate);if(q<L)return 0;if(q>D)return 100;const M=D.getTime()-L.getTime(),J=q.getTime()-L.getTime();return Math.round(J/M*100)},T=N=>{t.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(ar,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",n.jsx("strong",{children:N.name}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(te,{onClick:()=>Ve.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(te,{danger:!0,type:"primary",onClick:()=>{w(N),Ve.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},A=N=>[{key:"view",label:"View Details",icon:n.jsx(dn,{}),onClick:()=>E(N,"")},{key:"edit",label:"Edit Exhibition",icon:n.jsx(as,{}),onClick:()=>E(N,"/edit")},{key:"layout",label:"Manage Layout",icon:n.jsx(ps,{}),onClick:()=>E(N,"/layout")},{type:"divider"},...N.status==="published"?[{key:"public-view",label:"Public View",icon:n.jsx(dn,{}),onClick:()=>window.open(qo(N),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:n.jsx(Gi,{}),children:[{key:"draft",label:n.jsxs(ue,{children:[n.jsx(Se,{color:"#faad14",style:{margin:0},children:"Draft"}),n.jsx("span",{children:"Set as Draft"})]}),icon:n.jsx(_n,{}),onClick:()=>y(N,"draft"),disabled:N.status==="draft"||h},{key:"published",label:n.jsxs(ue,{children:[n.jsx(Se,{color:"#52c41a",style:{margin:0},children:"Published"}),n.jsx("span",{children:"Publish"})]}),icon:n.jsx(vt,{}),onClick:()=>y(N,"published"),disabled:N.status==="published"||h},{key:"completed",label:n.jsxs(ue,{children:[n.jsx(Se,{color:"#1890ff",style:{margin:0},children:"Completed"}),n.jsx("span",{children:"Mark as Completed"})]}),icon:n.jsx(Vt,{}),onClick:()=>y(N,"completed"),disabled:N.status==="completed"||h}]},{key:"active-status",label:n.jsxs(ue,{children:[N.isActive?n.jsx(Se,{color:"red",style:{margin:0},children:"Deactivate"}):n.jsx(Se,{color:"#52c41a",style:{margin:0},children:"Activate"}),n.jsx("span",{children:N.isActive?"Deactivate":"Activate"})]}),icon:n.jsx(hd,{}),onClick:()=>b(N,!N.isActive),disabled:h},{type:"divider"},{key:"delete",label:"Delete",icon:n.jsx(ar,{}),danger:!0,onClick:()=>T(N)}],I=k.useMemo(()=>i.filter(N=>{if(u.search&&!N.name.toLowerCase().includes(u.search.toLowerCase())||u.status.length>0&&!u.status.includes(N.status)||u.activeStatus!==null&&N.isActive!==u.activeStatus)return!1;if(u.dateRange){const[q,L]=u.dateRange,D=new Date(N.startDate),M=new Date(N.endDate);if(D<new Date(q)||M>new Date(L))return!1}switch(g){case"active":return N.status==="published";case"upcoming":return new Date(N.startDate)>new Date;case"completed":return N.status==="completed";default:return!0}}),[i,u,g]),P=[{title:"Exhibition Details",key:"details",render:(N,q)=>n.jsx(Zn,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>E(q,""),children:q.name})},{title:"Status",key:"status",width:180,align:"center",render:(N,q)=>S(q.status,q.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(N,q)=>q.status===N},{title:"Start Date",key:"startDate",width:130,render:(N,q)=>n.jsx(Zn,{children:et(q.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(N,q)=>n.jsx(Zn,{children:et(q.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(N,q)=>n.jsx(Zn,{children:et(q.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(N,q)=>n.jsx(Yr,{percent:C(q),size:"small",status:q.status==="completed"?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(N,q)=>n.jsxs(ue,{size:"middle",children:[m("exhibitions_view")&&n.jsx(ct,{title:"View Details",children:n.jsx(te,{type:"text",icon:n.jsx(dn,{}),onClick:()=>E(q,"")})}),m("exhibitions_edit")&&n.jsx(ct,{title:"Edit Exhibition",children:n.jsx(te,{type:"text",icon:n.jsx(as,{}),onClick:()=>E(q,"/edit")})}),m("exhibitions_delete")&&n.jsx(Vn,{menu:{items:A(q)},trigger:["click"],placement:"bottomRight",children:n.jsx(te,{type:"text",icon:n.jsx(Sc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ce,{gutter:[24,24],align:"middle",children:[n.jsx(K,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(wy,{level:4,style:{margin:0},children:"Exhibitions"}),n.jsx(Zn,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),n.jsx(K,{children:n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),onClick:()=>r("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),n.jsxs(Ce,{gutter:[24,24],style:{marginBottom:"24px"},children:[n.jsx(K,{xs:24,sm:12,md:6,lg:4,children:n.jsx(de,{children:n.jsx(Xe,{title:"Total Exhibitions",value:v.total,prefix:n.jsx(_n,{})})})}),n.jsx(K,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Xe,{title:"Published Exhibitions",value:v.active,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Xe,{title:"Upcoming Exhibitions",value:v.upcoming,prefix:n.jsx(Vt,{style:{color:"#1890ff"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Xe,{title:"Completed Exhibitions",value:v.completed,prefix:n.jsx(vt,{style:{color:"#8c8c8c"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,lg:5,children:n.jsx(de,{children:n.jsx(Xe,{title:"Active Status",value:v.activeCount,prefix:n.jsx(hd,{style:{color:"#52c41a"}})})})})]}),n.jsx(de,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:n.jsxs(ue,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ce,{gutter:[16,16],align:"middle",children:[n.jsx(K,{flex:"auto",children:n.jsxs(ue,{size:"middle",wrap:!0,children:[n.jsx(he,{placeholder:"Search exhibitions",prefix:n.jsx(kn,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:u.search,onChange:N=>p(q=>({...q,search:N.target.value})),allowClear:!0}),n.jsx(Pe,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:u.status,onChange:N=>p(q=>({...q,status:N})),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),n.jsxs(Pe,{placeholder:"Active Status",style:{width:"150px"},value:u.activeStatus,onChange:N=>p(q=>({...q,activeStatus:N})),allowClear:!0,children:[n.jsx(Pe.Option,{value:!0,children:"Active"}),n.jsx(Pe.Option,{value:!1,children:"Inactive"})]}),n.jsx(jy,{onChange:N=>p(q=>{var L,D;return{...q,dateRange:N?[((L=N[0])==null?void 0:L.toISOString())||"",((D=N[1])==null?void 0:D.toISOString())||""]:null}})})]})}),n.jsx(K,{children:n.jsx(_x,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:g,onChange:N=>f(N)})})]}),o.length>0&&n.jsx(Ce,{children:n.jsxs(ue,{children:[n.jsxs(Zn,{children:["Selected ",o.length," items"]}),n.jsx(te,{danger:!0,onClick:_,children:"Delete Selected"})]})})]})}),n.jsx(de,{className:"info-card",styles:{body:{padding:0}},children:n.jsx(tt,{columns:P,dataSource:I.map(N=>({...N,key:N._id||N.id})),rowKey:N=>N._id||N.id,loading:a||d||h,rowSelection:{selectedRowKeys:o.map(N=>N._id||N.id),onChange:(N,q)=>l(q),selections:[tt.SELECTION_ALL,tt.SELECTION_NONE]},footer:()=>o.length>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[n.jsxs(Zn,{children:["Selected ",n.jsx("strong",{children:o.length})," ",o.length===1?"exhibition":"exhibitions"]}),n.jsx(te,{danger:!0,onClick:_,icon:n.jsx(ar,{}),loading:d,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:N=>`Total ${N} items`,style:{marginTop:"16px"}}})})]})},Ms={getStallTypes:async()=>Ee.get("/stall-types"),createStallType:async e=>Ee.post("/stall-types",e),updateStallType:async(e,t)=>Ee.put(`/stall-types/${e}`,t),deleteStallType:async e=>Ee.delete(`/stall-types/${e}`)},{RangePicker:Ey}=xs,{Title:vn,Text:bn}=Le,eh=({value:e="",onChange:t})=>{const r=xt.useRef(null),[s]=xt.useState(e);return n.jsx(fp,{apiKey:vm,onInit:(i,a)=>{r.current=a},value:e,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:i=>{i.on("init",()=>{i.undoManager.clear(),i.undoManager.add()}),i.on("change",()=>{i.undoManager.add()})}},onEditorChange:i=>{t==null||t(i)}})},Ty=({form:e})=>{const[t,r]=k.useState([]),[s,i]=k.useState(!1);return k.useEffect(()=>{(async()=>{try{i(!0);const o=await Ms.getStallTypes();r(o.data.filter(l=>l.status==="active"))}catch(o){console.error("Failed to fetch stall types:",o)}finally{i(!1)}})()},[]),n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(de,{className:"settings-card",children:[n.jsx(vn,{level:4,children:"Basic Information"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),n.jsxs(Ce,{gutter:24,children:[n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:n.jsx(he,{placeholder:"Enter exhibition name"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:n.jsx(he.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:n.jsx(he,{placeholder:"Enter invoice prefix (default: INV)"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:n.jsx(Ey,{style:{width:"100%"}})})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(vn,{level:4,children:"Company Details"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),n.jsxs(Ce,{gutter:24,children:[n.jsxs(K,{span:12,children:[n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{placeholder:"Enter company name"})}),n.jsx(H.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:n.jsx(he,{placeholder:"Enter contact number"})}),n.jsx(H.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{placeholder:"Enter email address"})}),n.jsx(H.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter company address"})}),n.jsx(H.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:n.jsx(eh,{})})]}),n.jsxs(K,{span:12,children:[n.jsx(H.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:n.jsx(he,{placeholder:"Enter PAN number"})}),n.jsx(H.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:n.jsx(he,{placeholder:"Enter GST number"})}),n.jsx(H.Item,{name:"companySAC",label:"SAC Code No.",children:n.jsx(he,{placeholder:"Enter SAC code number"})}),n.jsx(H.Item,{name:"companyCIN",label:"CIN No.",children:n.jsx(he,{placeholder:"Enter CIN number"})}),n.jsx(H.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:n.jsx(he,{placeholder:"Enter website URL"})}),n.jsx(H.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:n.jsx(eh,{})})]})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(vn,{level:4,children:"Bank Details"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),n.jsxs(Ce,{gutter:24,children:[n.jsxs(K,{span:12,children:[n.jsx(H.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:n.jsx(he,{placeholder:"Enter bank name"})}),n.jsx(H.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:n.jsx(he,{placeholder:"Enter branch name"})}),n.jsx(H.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:n.jsx(he,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),n.jsxs(K,{span:12,children:[n.jsx(H.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:n.jsx(he,{placeholder:"Enter account name"})}),n.jsx(H.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:n.jsx(he,{placeholder:"Enter account number"})})]})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(vn,{level:4,children:"Stall Rates & Pricing"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(vn,{level:5,children:"Stall Type Rates"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),n.jsx(H.List,{name:"stallRates",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Pe,{loading:s,placeholder:"Select stall type",style:{width:200},children:t.map(x=>n.jsx(Pe.Option,{value:x._id,children:x.name},x._id))})}),n.jsx(H.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:n.jsx(yt,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"₹",formatter:x=>`${x}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:x=>{const u=x?Number(x.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(u)?0:u}})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Stall Type Rate"})})]})})]}),n.jsxs("div",{style:{marginBottom:"32px"},children:[n.jsx(vn,{level:5,children:"Tax Configuration"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),n.jsx(H.List,{name:"taxConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:n.jsx(he,{placeholder:"Tax name",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:n.jsx(yt,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:x=>`${x}%`,parser:x=>{const u=x?Number(x.replace("%","")):0;return isNaN(u)?0:Math.min(u,100)}})}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Tax"})})]})})]}),n.jsxs("div",{children:[n.jsx(vn,{level:5,children:"Admin Discount Configuration"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),n.jsx(H.List,{name:"discountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(he,{placeholder:"Discount",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Pe,{style:{width:150},children:[n.jsx(Pe.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Pe.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),n.jsx(H.Item,{noStyle:!0,shouldUpdate:(x,u)=>{var p,g,f,m;return((g=(p=x==null?void 0:x.discountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(f=u==null?void 0:u.discountConfig)==null?void 0:f[c])==null?void 0:m.type)},children:({getFieldValue:x})=>{const u=x(["discountConfig",c,"type"]);return n.jsx(H.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(yt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`₹${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[₹%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Admin Discount"})})]})})]}),n.jsxs("div",{style:{marginTop:"24px"},children:[n.jsx(vn,{level:5,children:"Public Discount Configuration"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),n.jsx(H.List,{name:"publicDiscountConfig",children:(a,{add:o,remove:l})=>n.jsxs(n.Fragment,{children:[a.map(({key:d,name:c,...h})=>n.jsxs(ue,{style:{display:"flex",marginBottom:8},align:"baseline",children:[n.jsx(H.Item,{...h,name:[c,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:n.jsx(he,{placeholder:"Discount",style:{width:150}})}),n.jsx(H.Item,{...h,name:[c,"type"],rules:[{required:!0,message:"Please select type"}],children:n.jsxs(Pe,{style:{width:150},children:[n.jsx(Pe.Option,{value:"percentage",children:"Percentage (%)"}),n.jsx(Pe.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),n.jsx(H.Item,{noStyle:!0,shouldUpdate:(x,u)=>{var p,g,f,m;return((g=(p=x==null?void 0:x.publicDiscountConfig)==null?void 0:p[c])==null?void 0:g.type)!==((m=(f=u==null?void 0:u.publicDiscountConfig)==null?void 0:f[c])==null?void 0:m.type)},children:({getFieldValue:x})=>{const u=x(["publicDiscountConfig",c,"type"]);return n.jsx(H.Item,{...h,name:[c,"value"],rules:[{required:!0,message:`Please enter ${u==="percentage"?"percentage":"amount"}`}],children:n.jsx(yt,{min:0,max:u==="percentage"?100:void 0,placeholder:u==="percentage"?"Percentage":"Amount",style:{width:150},formatter:p=>u==="percentage"?`${p}%`:`₹${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>{const g=p?Number(p.replace(/[₹%,]/g,"")):0;return isNaN(g)?0:g}})})}}),n.jsx(H.Item,{...h,name:[c,"isActive"],valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(ns,{onClick:()=>l(c)})]},d)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>o(),block:!0,icon:n.jsx(fr,{}),children:"Add Public Discount"})})]})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(vn,{level:4,children:"Status Settings"}),n.jsx(bn,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),n.jsxs(Ce,{gutter:24,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{children:[n.jsx(Pe.Option,{value:"draft",children:"Draft"}),n.jsx(Pe.Option,{value:"published",children:"Published"}),n.jsx(Pe.Option,{value:"completed",children:"Completed"})]})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:th,Text:bl}=Le,_y=({form:e})=>{const{message:t}=Yt.useApp(),[r,s]=k.useState([]),[i,a]=k.useState([]),[o,l]=k.useState(0),[d,c]=k.useState({}),h=f=>{const m=localStorage.getItem("token");return{url:`${Ee.defaults.baseURL}/uploads/${f}`,token:m}};k.useEffect(()=>{const f=e.getFieldValue("headerLogo");if(f){const{url:m,token:v}=h(f);fetch(m,{headers:{authorization:`Bearer ${v}`}}).then(w=>w.blob()).then(w=>{const _=URL.createObjectURL(w);s([{uid:"-1",name:f.split("/").pop()||"logo",status:"done",url:_,thumbUrl:_,type:w.type,response:{path:f}}])}).catch(()=>{s([])})}},[e]),k.useEffect(()=>{const f=e.getFieldValue("sponsorLogos")||[];f.length>0&&Promise.all(f.map(async(m,v)=>{const{url:w,token:_}=h(m);try{const b=await(await fetch(w,{headers:{authorization:`Bearer ${_}`}})).blob(),E=URL.createObjectURL(b);return{uid:`-${v+1}`,name:m.split("/").pop()||`sponsor-${v+1}`,status:"done",url:E,thumbUrl:E,type:b.type,response:{path:m}}}catch{return null}})).then(m=>{a(m.filter(Boolean))})},[e]);const x={name:"file",action:`${Ee.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(f){const{status:m,name:v,response:w,uid:_}=f.file;if(m==="uploading"){s([...f.fileList]);return}if(m==="done"&&w){const{url:y,token:b}=h(w.path);l(0),fetch(y,{headers:{authorization:`Bearer ${b}`}}).then(E=>E.blob()).then(E=>{const j=URL.createObjectURL(E);s([{uid:f.file.uid,name:v,status:"done",url:j,thumbUrl:j,type:E.type,response:w}]),t.success(`${v} uploaded successfully`),e.setFieldValue("headerLogo",w.path),w.thumbnail&&e.setFieldValue("headerLogoThumbnail",w.thumbnail)}).catch(()=>{t.error(`${v} preview failed to load`),s([])})}else m==="error"?(t.error(`${v} upload failed.`),s([]),l(0)):m==="removed"&&(s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0))},customRequest:async f=>{const{onProgress:m,onSuccess:v,onError:w,file:_,action:y,headers:b}=f;try{const E=new FormData;E.append("file",_);const j=new XMLHttpRequest;j.open("POST",y||"",!0),b&&Object.keys(b).forEach(S=>{j.setRequestHeader(S,b[S])}),j.upload.onprogress=S=>{S.lengthComputable&&m&&(m({percent:S.loaded/S.total*100}),l(Math.round(S.loaded/S.total*100)))},j.onload=()=>{if(j.status>=200&&j.status<300)try{const S=JSON.parse(j.response);v==null||v(S,_),l(0)}catch(S){w==null||w(S)}else w==null||w(new Error("Upload failed"))},j.onerror=()=>{l(0),w==null||w(new Error("Upload request failed"))},j.send(E)}catch(E){l(0),w==null||w(E)}},onRemove(){return s([]),e.setFieldValue("headerLogo",null),e.setFieldValue("headerLogoThumbnail",null),l(0),!0},onPreview:async f=>{if(!f.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${f.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},u={name:"file",action:`${Ee.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:i,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(f){const{status:m,name:v,response:w,uid:_}=f.file;if(m==="uploading"){a([...f.fileList]);return}if(m==="done"&&w&&w.paths&&w.paths.length>0){c(j=>{const S={...j};return delete S[_],S});const y=w.paths[0],{url:b,token:E}=h(y);fetch(b,{headers:{authorization:`Bearer ${E}`}}).then(j=>j.blob()).then(j=>{const S=URL.createObjectURL(j),C=[...i],T=C.findIndex(P=>P.uid===f.file.uid),A={uid:f.file.uid,name:v,status:"done",url:S,thumbUrl:S,type:j.type,response:{path:y}};T>-1?C[T]=A:C.push(A),a(C),t.success(`${v} uploaded successfully`);const I=C.filter(P=>{var N;return P.status==="done"&&((N=P.response)==null?void 0:N.path)}).map(P=>P.response.path);if(e.setFieldValue("sponsorLogos",I),w.thumbnails&&w.thumbnails.length>0){const P=e.getFieldValue("sponsorLogoThumbnails")||[];e.setFieldValue("sponsorLogoThumbnails",[...P,...w.thumbnails])}}).catch(()=>{t.error(`${v} preview failed to load`),a(j=>j.filter(S=>S.uid!==f.file.uid))})}else m==="error"?(t.error(`${v} upload failed.`),a(y=>y.filter(b=>b.uid!==f.file.uid)),c(y=>{const b={...y};return delete b[_],b})):m==="removed"&&c(y=>{const b={...y};return delete b[_],b})},customRequest:async f=>{const{onProgress:m,onSuccess:v,onError:w,file:_,action:y,headers:b}=f,E=typeof _=="object"&&"uid"in _?_.uid:String(Date.now());try{const j=new FormData;j.append("file",_);const S=new XMLHttpRequest;S.open("POST",y||"",!0),b&&Object.keys(b).forEach(C=>{S.setRequestHeader(C,b[C])}),S.upload.onprogress=C=>{if(C.lengthComputable&&m){const T=C.loaded/C.total*100;m({percent:T}),c(A=>({...A,[E]:Math.round(T)}))}},S.onload=()=>{if(S.status>=200&&S.status<300)try{const C=JSON.parse(S.response);v==null||v(C,_),c(T=>{const A={...T};return delete A[E],A})}catch(C){w==null||w(C)}else w==null||w(new Error("Upload failed"))},S.onerror=()=>{c(C=>{const T={...C};return delete T[E],T}),w==null||w(new Error("Upload request failed"))},S.send(j)}catch(j){c(S=>{const C={...S};return delete C[E],C}),w==null||w(j)}},onRemove(f){var _;const m=i.filter(y=>y.uid!==f.uid);a(m);const v=m.filter(y=>{var b;return y.status==="done"&&((b=y.response)==null?void 0:b.path)}).map(y=>y.response.path);e.setFieldValue("sponsorLogos",v);const w=e.getFieldValue("sponsorLogoThumbnails")||[];if(w.length>0&&(_=f.response)!=null&&_.path){const y=f.response.path.split("/"),b=y[y.length-1],E=w.filter(j=>!j.includes(b));e.setFieldValue("sponsorLogoThumbnails",E)}return c(y=>{const b={...y};return delete b[f.uid],b}),!0},onPreview:async f=>{if(!f.url)return;const m=window.open("");m&&(m.document.write(`
          <img src="${f.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),m.document.head.innerHTML="<title>Image Preview</title>")}},p=n.jsx("div",{children:o>0?n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(Yr,{type:"circle",percent:o,width:80}),n.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),g=n.jsxs("div",{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return n.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:n.jsxs(de,{className:"settings-card",children:[n.jsx(th,{level:4,children:"Header Settings"}),n.jsx(bl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),n.jsxs(Ce,{gutter:24,children:[n.jsx(K,{span:24,children:n.jsxs(H.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[n.jsx(Ri,{...x,children:r.length<1&&p}),r.length>0&&o>0&&n.jsx(Yr,{percent:o,status:"active",style:{marginTop:8}})]})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:n.jsx(he,{placeholder:"Enter a title for your exhibition header"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:n.jsx(he,{placeholder:"Enter a subtitle (optional)"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:n.jsx(he.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),n.jsxs(K,{span:24,children:[n.jsx(nt,{}),n.jsx(th,{level:5,children:"Sponsor Logos"}),n.jsx(bl,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),n.jsxs(H.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[n.jsx(Ri,{...u,children:g}),Object.entries(d).map(([f,m])=>{var v;return n.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[n.jsxs(bl,{style:{marginRight:10,width:150},ellipsis:!0,children:[((v=i.find(w=>w.uid===f))==null?void 0:v.name)||"File",":"]}),n.jsx(Yr,{percent:m,status:"active",style:{flex:1}})]},f)})]})]})]})]})})},{Title:rh,Text:nh}=Le,ky=({form:e})=>{const{message:t}=Yt.useApp(),[r,s]=k.useState([]),i=o=>{const l=localStorage.getItem("token");return{url:`${Ee.defaults.baseURL}/uploads/${o}`,token:l}};k.useEffect(()=>{const o=e.getFieldValue("footerLogo");if(o){const{url:l,token:d}=i(o);fetch(l,{headers:{authorization:`Bearer ${d}`}}).then(c=>c.blob()).then(c=>{const h=URL.createObjectURL(c);s([{uid:"-1",name:o.split("/").pop()||"logo",status:"done",url:h,thumbUrl:h,type:c.type,response:{path:o}}])}).catch(()=>{s([])})}},[e]);const a={name:"file",action:`${Ee.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:r,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(o){const{status:l,name:d,response:c}=o.file;if(l==="uploading"){s([...o.fileList]);return}if(l==="done"&&c){const{url:h,token:x}=i(c.path);fetch(h,{headers:{authorization:`Bearer ${x}`}}).then(u=>u.blob()).then(u=>{const p=URL.createObjectURL(u);s([{uid:o.file.uid,name:d,status:"done",url:p,thumbUrl:p,type:u.type,response:c}]),t.success(`${d} uploaded successfully`),e.setFieldValue("footerLogo",c.path)}).catch(()=>{t.error(`${d} preview failed to load`),s([])})}else l==="error"?(t.error(`${d} upload failed.`),s([])):l==="removed"&&(s([]),e.setFieldValue("footerLogo",null))},onRemove(){return s([]),e.setFieldValue("footerLogo",null),!0},onPreview:async o=>{if(!o.url)return;const l=window.open("");l&&(l.document.write(`
          <img src="${o.url}" style="max-width: 100%; height: auto;" 
               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"
          />
        `),l.document.head.innerHTML="<title>Image Preview</title>")}};return n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(de,{className:"settings-card",children:[n.jsx(rh,{level:4,children:"Footer Content"}),n.jsx(nh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),n.jsxs(Ce,{gutter:24,children:[n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:n.jsx(Ri,{...a,children:r.length<1&&n.jsxs("div",{children:[n.jsx(Pi,{}),n.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter contact email"})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:n.jsx(he,{placeholder:"Enter contact phone number"})})})]})]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(rh,{level:4,children:"Footer Links"}),n.jsx(nh,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),n.jsx(H.List,{name:"footerLinks",children:(o,{add:l,remove:d})=>n.jsxs(n.Fragment,{children:[o.map(({key:c,name:h,...x})=>n.jsxs(Ce,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(K,{span:11,children:n.jsx(H.Item,{...x,name:[h,"label"],rules:[{required:!0,message:"Please enter link label"}],children:n.jsx(he,{placeholder:"Link Label"})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{...x,name:[h,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:n.jsx(he,{placeholder:"URL (e.g., https://example.com)"})})}),n.jsx(K,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(ns,{onClick:()=>d(h)})})]},c)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>l(),block:!0,icon:n.jsx(fr,{}),children:"Add Footer Link"})})]})})]})]})},{Title:wl,Text:jl}=Le,{TabPane:sh}=Gt,Cy=({form:e})=>n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[n.jsxs(Gt,{defaultActiveKey:"basic",type:"card",children:[n.jsx(sh,{tab:"Basic Amenities",children:n.jsxs(de,{className:"settings-card",children:[n.jsx(wl,{level:4,children:"Basic Amenities"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),n.jsx(H.List,{name:"basicAmenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ce,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(K,{span:5,children:n.jsx(H.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Pe,{placeholder:"Select type",children:[n.jsx(Pe.Option,{value:"facility",children:"Facility"}),n.jsx(Pe.Option,{value:"service",children:"Service"}),n.jsx(Pe.Option,{value:"equipment",children:"Equipment"}),n.jsx(Pe.Option,{value:"other",children:"Other"})]})})}),n.jsx(K,{span:6,children:n.jsx(H.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter name (e.g. Tables)"})})}),n.jsx(K,{span:6,children:n.jsx(H.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(he.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(K,{span:3,children:n.jsx(H.Item,{...o,name:[a,"perSqm"],label:n.jsxs(ue,{children:["Per sqm",n.jsx(ct,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:n.jsx(Jr,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"9",min:1})})}),n.jsx(K,{span:3,children:n.jsx(H.Item,{...o,name:[a,"quantity"],label:n.jsxs(ue,{children:["Quantity",n.jsx(ct,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:n.jsx(Jr,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"1",min:1})})}),n.jsx(K,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:n.jsx(ns,{onClick:()=>s(a)})})]},i)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>r({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:n.jsx(fr,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),n.jsx(sh,{tab:"Extra Amenities",children:n.jsxs(de,{className:"settings-card",children:[n.jsx(wl,{level:4,children:"Extra Amenities"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),n.jsx(H.List,{name:"amenities",children:(t,{add:r,remove:s})=>n.jsxs(n.Fragment,{children:[t.map(({key:i,name:a,...o})=>n.jsxs(Ce,{gutter:16,style:{marginBottom:"16px"},children:[n.jsx(K,{span:5,children:n.jsx(H.Item,{...o,name:[a,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:n.jsxs(Pe,{placeholder:"Select type",children:[n.jsx(Pe.Option,{value:"facility",children:"Facility"}),n.jsx(Pe.Option,{value:"service",children:"Service"}),n.jsx(Pe.Option,{value:"equipment",children:"Equipment"}),n.jsx(Pe.Option,{value:"other",children:"Other"})]})})}),n.jsx(K,{span:6,children:n.jsx(H.Item,{...o,name:[a,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:n.jsx(he,{placeholder:"Enter name (e.g. Power)"})})}),n.jsx(K,{span:8,children:n.jsx(H.Item,{...o,name:[a,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:n.jsx(he.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),n.jsx(K,{span:4,children:n.jsx(H.Item,{...o,name:[a,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:n.jsx(yt,{style:{width:"100%"},placeholder:"Enter rate",prefix:"₹",min:0,formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>{const d=l?Number(l.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(d)?0:d}})})}),n.jsx(K,{span:1,style:{display:"flex",alignItems:"center"},children:n.jsx(ns,{onClick:()=>s(a)})})]},i)),n.jsx(H.Item,{children:n.jsx(te,{type:"dashed",onClick:()=>r({type:"service"}),block:!0,icon:n.jsx(fr,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),n.jsxs(de,{className:"settings-card",style:{marginTop:"24px"},children:[n.jsx(wl,{level:4,children:"Special Requirements"}),n.jsx(jl,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),n.jsx(Ce,{gutter:24,children:n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:n.jsx(he.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),xf=({initialValues:e,onSubmit:t,submitText:r="Submit"})=>{const[s]=H.useForm(),i=o=>{t(o)},a=[{key:"general",label:"General",children:n.jsx(Ty,{form:s})},{key:"header",label:"Header",children:n.jsx(_y,{form:s})},{key:"footer",label:"Footer",children:n.jsx(ky,{form:s})},{key:"amenities",label:"Amenities",children:n.jsx(Cy,{form:s})}];return n.jsx(H,{form:s,layout:"vertical",initialValues:e,onFinish:i,style:{height:"100%"},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[n.jsx("div",{style:{flex:1,marginBottom:"24px"},children:n.jsx(Gt,{defaultActiveKey:"general",items:a,type:"card"})}),n.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:n.jsx(te,{type:"primary",htmlType:"submit",children:r})})]})})},Ay=()=>{const e=Je(),t=it(),r=async s=>{var i,a;try{const[o,l]=s.dateRange,d={name:s.name,description:s.description,venue:s.venue,startDate:o.toISOString(),endDate:l.toISOString(),status:s.status||"draft",isActive:s.isActive??!0,invoicePrefix:s.invoicePrefix,stallRates:s.stallRates||[],dimensions:{width:100,height:100},taxConfig:s.taxConfig||[],discountConfig:s.discountConfig||[],publicDiscountConfig:s.publicDiscountConfig||[],companyName:s.companyName,companyContactNo:s.companyContactNo,companyEmail:s.companyEmail,companyAddress:s.companyAddress,companyWebsite:s.companyWebsite,companyPAN:s.companyPAN,companyGST:s.companyGST,companySAC:s.companySAC,companyCIN:s.companyCIN,termsAndConditions:s.termsAndConditions,piInstructions:s.piInstructions,bankName:s.bankName,bankBranch:s.bankBranch,bankIFSC:s.bankIFSC,bankAccountName:s.bankAccountName,bankAccount:s.bankAccount,headerTitle:s.headerTitle,headerSubtitle:s.headerSubtitle,headerDescription:s.headerDescription,headerLogo:s.headerLogo,sponsorLogos:s.sponsorLogos||[],footerText:s.footerText,footerLogo:s.footerLogo,contactEmail:s.contactEmail,contactPhone:s.contactPhone,footerLinks:s.footerLinks||[],amenities:((i=s.amenities)==null?void 0:i.map(x=>({type:x.type,name:x.name,description:x.description,rate:x.rate})))||[],basicAmenities:((a=s.basicAmenities)==null?void 0:a.map(x=>({type:x.type,name:x.name,description:x.description,perSqm:x.perSqm,quantity:x.quantity})))||[],specialRequirements:s.specialRequirements},c=await t(Za(d)).unwrap();be.success("Exhibition created successfully");const h=c._id||c.id;h?e(Lt({_id:h,id:h,name:d.name}),{state:{exhibitionId:h}}):(be.error("Exhibition ID not found in response"),e("/exhibition"))}catch(o){be.error(o.message||"Failed to create exhibition"),console.error("Error creating exhibition:",o)}};return n.jsx(de,{title:"Create New Exhibition",children:n.jsx(xf,{onSubmit:r,submitText:"Create Exhibition"})})},{Title:ih,Text:nr,Paragraph:Sl}=Le,El=()=>{const e=Je();return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>e("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Iy=()=>{const{id:e}=Fr(),t=Je(),r=it(),{currentExhibition:s,halls:i,stalls:a,loading:o}=Me(f=>f.exhibition),[l,d]=k.useState(0);k.useEffect(()=>{e&&(r(Or(e)),r(hn(e)),r(cn({exhibitionId:e})))},[e,r]),k.useEffect(()=>{s&&h()},[s]);const c=()=>{if(!s)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const f=i.length||0;let m=a.length||0,v=a.filter(w=>w.status==="booked"||w.status==="reserved").length;return m===0&&(s.stalls&&s.stalls.length>0?(m=s.stalls.length,v=s.stalls.filter(w=>w.status==="booked"||w.status==="reserved").length):(m=s.stallCount||0,v=s.bookedStallCount||0)),{hallCount:f,stallCount:m,bookedStallCount:v,availableStallCount:m-v}},h=()=>{if(!s)return 0;const f=new Date,m=new Date(s.startDate),v=new Date(s.endDate);if(f<m)return d(0);if(f>v)return d(100);const w=v.getTime()-m.getTime(),_=f.getTime()-m.getTime();d(Math.round(_/w*100))},x=f=>{switch(f.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},u=()=>{if(!s)return{text:"",count:0,isPast:!1};const f=new Date,m=new Date(s.startDate),v=new Date(s.endDate);return f>v?{text:"Ended",count:Math.ceil((f.getTime()-v.getTime())/864e5),isPast:!0}:f>=m&&f<=v?{text:"Days Remaining",count:Math.ceil((v.getTime()-f.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((m.getTime()-f.getTime())/(1e3*60*60*24)),isPast:!1}},p=f=>{t(Lt(s,f))};if(o)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(El,{}),n.jsx(de,{children:n.jsx(on,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!s)return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(El,{}),n.jsx(de,{children:n.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[n.jsx(Jr,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),n.jsx(ih,{level:4,children:"Exhibition not found"}),n.jsx(Sl,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const g=u();return n.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[n.jsx(El,{}),n.jsx(de,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:n.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:n.jsxs(Ce,{gutter:[24,24],align:"middle",children:[n.jsxs(K,{xs:24,md:16,children:[n.jsx(ih,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:s.name}),n.jsx(Sl,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:s.description}),n.jsxs(ue,{split:n.jsx(nt,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[n.jsxs(ue,{children:[n.jsx(Hr,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsxs(nr,{style:{color:"rgba(255,255,255,0.8)"},children:[et(s.startDate).format("MMM D, YYYY")," - ",et(s.endDate).format("MMM D, YYYY")]})]}),s.venue&&n.jsxs(ue,{children:[n.jsx(os,{style:{color:"rgba(255,255,255,0.8)"}}),n.jsx(nr,{style:{color:"rgba(255,255,255,0.8)"},children:s.venue})]})]})]}),n.jsx(K,{xs:24,md:8,children:n.jsxs(de,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[n.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:x(s.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:s.status.toUpperCase()}),n.jsx(Xe,{title:g.text,value:g.count,suffix:"days",valueStyle:{color:g.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:n.jsx(Vt,{})}),n.jsx(nt,{style:{margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"8px"},children:n.jsx(nr,{type:"secondary",children:"Exhibition Progress"})}),n.jsx(Yr,{percent:l,status:l===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),n.jsxs(Ce,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(K,{xs:24,sm:8,children:n.jsx(te,{type:"primary",icon:n.jsx(ps,{}),onClick:()=>p(`${e}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),n.jsx(K,{xs:24,sm:8,children:n.jsx(te,{icon:n.jsx(as,{}),onClick:()=>p(`${e}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),n.jsx(K,{xs:24,sm:8,children:n.jsx(te,{icon:n.jsx(dn,{}),onClick:()=>window.open(qo(s),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:s.status!=="published",children:"View Public Page"})})]}),n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,lg:16,children:n.jsxs(de,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[n.jsxs(Ce,{gutter:[24,24],children:[n.jsxs(K,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),n.jsx(nr,{strong:!0,style:{fontSize:"16px"},children:et(s.startDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),n.jsx(nr,{strong:!0,style:{fontSize:"16px"},children:et(s.endDate).format("MMMM D, YYYY")})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),n.jsx(nr,{strong:!0,style:{fontSize:"16px"},children:et(s.createdAt).format("MMMM D, YYYY")})]})]}),n.jsxs(K,{xs:24,sm:12,children:[n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),n.jsx(Se,{color:x(s.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.status.toUpperCase()})]}),n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),n.jsx(Se,{color:s.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:s.isActive?"ACTIVE":"INACTIVE"})]}),s.venue&&n.jsxs("div",{style:{marginBottom:"24px"},children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),n.jsx(nr,{strong:!0,style:{fontSize:"16px"},children:s.venue})]})]})]}),n.jsx(nt,{}),n.jsxs("div",{children:[n.jsx(nr,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),n.jsx(Sl,{children:s.description||"No description provided."})]})]})}),n.jsxs(K,{xs:24,lg:8,children:[n.jsx(de,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:n.jsxs(Ce,{gutter:[16,24],children:[n.jsx(K,{span:12,children:n.jsx(Xe,{title:"Halls",value:c().hallCount,prefix:n.jsx(ms,{})})}),n.jsx(K,{span:12,children:n.jsx(Xe,{title:"Stalls",value:c().stallCount,prefix:n.jsx(yr,{})})}),n.jsx(K,{span:12,children:n.jsx(Xe,{title:"Booked Stalls",value:c().bookedStallCount,prefix:n.jsx(vt,{})})}),n.jsx(K,{span:12,children:n.jsx(Xe,{title:"Available Stalls",value:c().availableStallCount,prefix:n.jsx(kx,{})})})]})}),n.jsx(de,{title:"Created By",style:{borderRadius:"12px"},children:s.createdBy?n.jsxs(ue,{children:[n.jsx(Br,{icon:n.jsx(at,{})}),n.jsx(nr,{children:s.createdByName||"Administrator"})]}):n.jsx(nr,{type:"secondary",children:"Information not available"})})]})]})]})},Ny=()=>{var p;const{message:e}=Yt.useApp(),{id:t}=Fr(),s=(p=In().state)==null?void 0:p.exhibitionId,i=Je(),a=it(),{currentExhibition:o,loading:l,error:d}=Me(g=>g.exhibition),[c,h]=k.useState(!1);k.useEffect(()=>{(async()=>{if(!s){e.error("Exhibition ID not found"),i("/exhibition");return}try{await a(Or(s)).unwrap()}catch(f){e.error(f.message||"Failed to fetch exhibition"),i("/exhibition")}finally{h(!0)}})()},[s,a,e,i]),k.useEffect(()=>{d&&e.error(d)},[d,e]);const x=async g=>{var f,m;if(!(!s||!o))try{const[v,w]=g.dateRange,_={name:g.name,description:g.description,venue:g.venue,startDate:v.toISOString(),endDate:w.toISOString(),status:g.status,isActive:g.isActive,invoicePrefix:g.invoicePrefix,stallRates:g.stallRates||[],dimensions:o.dimensions,taxConfig:g.taxConfig||[],discountConfig:g.discountConfig||[],publicDiscountConfig:g.publicDiscountConfig||[],companyName:g.companyName,companyContactNo:g.companyContactNo,companyEmail:g.companyEmail,companyAddress:g.companyAddress,companyWebsite:g.companyWebsite,companyPAN:g.companyPAN,companyGST:g.companyGST,companySAC:g.companySAC,companyCIN:g.companyCIN,termsAndConditions:g.termsAndConditions,piInstructions:g.piInstructions,bankName:g.bankName,bankBranch:g.bankBranch,bankIFSC:g.bankIFSC,bankAccountName:g.bankAccountName,bankAccount:g.bankAccount,headerTitle:g.headerTitle,headerSubtitle:g.headerSubtitle,headerDescription:g.headerDescription,headerLogo:g.headerLogo,sponsorLogos:g.sponsorLogos||[],footerText:g.footerText,footerLogo:g.footerLogo,contactEmail:g.contactEmail,contactPhone:g.contactPhone,footerLinks:g.footerLinks||[],amenities:((f=g.amenities)==null?void 0:f.map(y=>({type:y.type,name:y.name,description:y.description,rate:y.rate})))||[],basicAmenities:((m=g.basicAmenities)==null?void 0:m.map(y=>({type:y.type,name:y.name,description:y.description,perSqm:y.perSqm,quantity:y.quantity})))||[],specialRequirements:g.specialRequirements};await a(eo({id:s,data:_})).unwrap(),e.success("Exhibition updated successfully"),i(Lt(o),{state:{exhibitionId:s}})}catch(v){e.error(v.message||"Failed to update exhibition")}};if(!c)return n.jsx(de,{loading:!0});if(!s)return n.jsx(Do,{to:"/exhibition",replace:!0});if(l||!o)return n.jsx(de,{loading:!0});const u={name:o.name,description:o.description,venue:o.venue,dateRange:[et(o.startDate),et(o.endDate)],status:o.status,isActive:o.isActive,invoicePrefix:o.invoicePrefix,stallRates:o.stallRates||[],taxConfig:o.taxConfig||[],discountConfig:o.discountConfig||[],publicDiscountConfig:o.publicDiscountConfig||[],companyName:o.companyName,companyContactNo:o.companyContactNo,companyEmail:o.companyEmail,companyAddress:o.companyAddress,companyWebsite:o.companyWebsite,companyPAN:o.companyPAN,companyGST:o.companyGST,companySAC:o.companySAC,companyCIN:o.companyCIN,termsAndConditions:o.termsAndConditions,piInstructions:o.piInstructions,bankName:o.bankName,bankBranch:o.bankBranch,bankIFSC:o.bankIFSC,bankAccountName:o.bankAccountName,bankAccount:o.bankAccount,headerTitle:o.headerTitle,headerSubtitle:o.headerSubtitle,headerDescription:o.headerDescription,headerLogo:o.headerLogo,sponsorLogos:o.sponsorLogos||[],footerText:o.footerText,footerLogo:o.footerLogo,contactEmail:o.contactEmail,contactPhone:o.contactPhone,footerLinks:o.footerLinks||[],amenities:o.amenities||[],basicAmenities:o.basicAmenities||[],specialRequirements:o.specialRequirements};return n.jsx(de,{title:"Edit Exhibition",extra:n.jsx("a",{onClick:()=>i(Lt(o),{state:{exhibitionId:s}}),children:"Back to Details"}),children:n.jsx(xf,{initialValues:u,onSubmit:x,submitText:"Update Exhibition"})})},ah=({width:e,height:t,scale:r=1,position:s={x:0,y:0},isSelected:i=!1,onSelect:a=()=>{},onChange:o=()=>{},children:l,isEditable:d=!0})=>{const c=x=>{d&&(a(),x.cancelBubble=!0)},h=xt.useMemo(()=>{const x=[];for(let p=0;p<=e;p+=5)x.push(n.jsx(xo,{points:[p,0,p,t],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`v${p}`));for(let p=0;p<=t;p+=5)x.push(n.jsx(xo,{points:[0,p,e,p],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`h${p}`));return x},[e,t,r]);return n.jsxs(Ys,{x:s.x,y:s.y,width:e,height:t,onClick:c,children:[n.jsx(Lo,{width:e,height:t,fill:"#ffffff",stroke:i&&d?"#1890ff":"#d9d9d9",strokeWidth:i&&d?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/r,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/r}),n.jsx(Ys,{children:h}),n.jsx(Oi,{text:`${e}m × ${t}m`,fontSize:14/r,fill:"#666666",x:5,y:5}),l]})},Fy=({visible:e,width:t,height:r,onCancel:s,onSubmit:i})=>{const[a]=H.useForm();xt.useEffect(()=>{e&&a.setFieldsValue({width:t,height:r})},[e,t,r,a]);const o=()=>{a.validateFields().then(l=>{i(l),a.resetFields()})};return n.jsx(Ve,{title:"Edit Exhibition Space",open:e,onCancel:()=>{a.resetFields(),s()},onOk:o,destroyOnClose:!0,children:n.jsxs(H,{form:a,layout:"vertical",initialValues:{width:t,height:r},children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},pf=({hall:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isStallMode:d=!1})=>{const c=xt.useRef(null),h=xt.useRef(null),x=xt.useMemo(()=>{const v=[],{width:w,height:_}=e.dimensions,y=1;for(let b=0;b<=w;b+=y)v.push(n.jsx(xo,{points:[b,0,b,_],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`v${b}`));for(let b=0;b<=_;b+=y)v.push(n.jsx(xo,{points:[0,b,w,b],stroke:"#ddd",strokeWidth:1/i,dash:[2/i,2/i],listening:!1},`h${b}`));return v},[e.dimensions.width,e.dimensions.height,i]);xt.useEffect(()=>{var v;t&&h.current&&c.current&&(h.current.nodes([c.current]),(v=h.current.getLayer())==null||v.batchDraw())},[t]);const u=v=>{v.cancelBubble=!0;const w=v.target,_=w.x(),y=w.y(),b=Math.max(0,Math.min(_,o-e.dimensions.width)),E=Math.max(0,Math.min(y,l-e.dimensions.height));w.x(Math.round(b)),w.y(Math.round(E))},p=v=>{v.cancelBubble=!0;const w=v.target,_=Math.max(0,Math.min(w.x(),o-e.dimensions.width)),y=Math.max(0,Math.min(w.y(),l-e.dimensions.height));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{...e.dimensions,x:Math.round(_),y:Math.round(y)}})},g=v=>{v.cancelBubble=!0},f=v=>{if(!c.current)return;const w=c.current,_=w.scaleX(),y=w.scaleY();w.scaleX(1),w.scaleY(1);const b=Math.round(w.width()*_),E=Math.round(w.height()*y),j=w.x(),S=w.y(),C=Math.max(0,Math.min(j,o-b)),T=Math.max(0,Math.min(S,l-E));s==null||s({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{x:C,y:T,width:Math.max(5,Math.min(b,o-C)),height:Math.max(5,Math.min(E,l-T))}})},m=v=>{v.cancelBubble=!0,r==null||r(e)};return n.jsxs(Ys,{ref:c,x:e.dimensions.x,y:e.dimensions.y,width:e.dimensions.width,height:e.dimensions.height,draggable:!d&&!!s,onClick:m,onTap:m,onDragStart:g,onDragMove:u,onDragEnd:p,onTransformEnd:f,children:[n.jsx(Lo,{width:e.dimensions.width,height:e.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/i:1/i,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}),n.jsx(Ys,{children:x}),n.jsx(Oi,{text:e.name,fontSize:14/i,fill:"#000000",width:e.dimensions.width,align:"center",y:e.dimensions.height/2-7/i})]})},Ry=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},mf=({fixture:e,isSelected:t=!1,onSelect:r,onChange:s,scale:i=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isEditable:d=!0})=>{const c=xt.useRef(null),h=xt.useRef(null),[x,u]=k.useState("");k.useEffect(()=>{if(e.icon){const y=Ry(e.icon);u(y)}else u("")},[e.icon]);const[p]=xp(x);xt.useEffect(()=>{var y;t&&h.current&&c.current&&(h.current.nodes([c.current]),(y=h.current.getLayer())==null||y.batchDraw())},[t]);const g=y=>{y.cancelBubble=!0},f=y=>{y.cancelBubble=!0;const b=y.target,E=b.x(),j=b.y(),S=Math.max(0,Math.min(E,o-e.dimensions.width)),C=Math.max(0,Math.min(j,l-e.dimensions.height));b.x(Math.round(S)),b.y(Math.round(C))},m=y=>{y.cancelBubble=!0;const b=y.target,E=b.x(),j=b.y(),S=Math.max(0,Math.min(E,o-e.dimensions.width)),C=Math.max(0,Math.min(j,l-e.dimensions.height)),T=e._id||e.id;s==null||s({...e,_id:T,id:T,exhibitionId:e.exhibitionId,position:{x:Math.round(S),y:Math.round(C)}})},v=y=>{if(!c.current)return;const b=c.current,E=b.scaleX(),j=b.scaleY(),S=b.rotation();b.scaleX(1),b.scaleY(1);const C=Math.round(e.dimensions.width*E),T=Math.round(e.dimensions.height*j),A=b.x(),I=b.y(),P=Math.max(0,Math.min(A,o-C)),N=Math.max(0,Math.min(I,l-T)),q=e._id||e.id;s==null||s({...e,_id:q,id:q,exhibitionId:e.exhibitionId,position:{x:P,y:N},dimensions:{width:Math.max(.5,Math.min(C,o-P)),height:Math.max(.5,Math.min(T,l-N))},rotation:S})},w=y=>{y.cancelBubble=!0,r==null||r(e)},_=()=>{const y=e.borderColor||(t?"#1890ff":"#d9d9d9"),b=e.borderRadius!==void 0?e.borderRadius/i:3/i;return p?n.jsx(mp,{image:p,width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#ffffff",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:b,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5}):n.jsx(Lo,{width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#f0f2f5",stroke:y,strokeWidth:t?2/i:1/i,cornerRadius:b,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/i,shadowOffset:{x:2/i,y:2/i},shadowOpacity:.5})};return n.jsxs(n.Fragment,{children:[n.jsxs(Ys,{ref:c,x:e.position.x,y:e.position.y,width:e.dimensions.width,height:e.dimensions.height,rotation:e.rotation||0,draggable:d&&!!s,onClick:w,onTap:w,onDragStart:g,onDragMove:f,onDragEnd:m,onTransformEnd:v,children:[_(),e.name&&e.showName!==!1&&n.jsx(Oi,{text:e.name,fontSize:12/i,fill:"#000000",width:e.dimensions.width,align:"center",y:-16/i})]}),t&&d&&n.jsx(pp,{ref:h,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(y,b)=>b.width<.5||b.height<.5?y:b})]})},Py=({visible:e,x:t,y:r,onExhibitionClick:s,onHallClick:i,onStallClick:a,onFixtureClick:o,onClose:l})=>{if(!e)return null;const d=[{key:"exhibition",icon:n.jsx(ps,{}),label:"Exhibition Space",onClick:()=>{s(),l()}},{key:"hall",icon:n.jsx(ms,{}),label:"Add Hall",onClick:()=>{i(),l()}}];return a&&d.push({key:"stall",icon:n.jsx(yr,{}),label:"Add Stall",onClick:()=>{a(),l()}}),o&&d.push({key:"fixture",icon:n.jsx(Ro,{}),label:"Add Fixture",onClick:()=>{o(),l()}}),n.jsx("div",{style:{position:"fixed",top:r,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:n.jsx(or,{items:d})})},Dy=({stall:e,isSelected:t=!1,onSelect:r,onChange:s,hallWidth:i=0,hallHeight:a=0,hallX:o=0,hallY:l=0,scale:d=1,isDragging:c=!1})=>{const h=k.useRef(null),[x,u]=k.useState(!1),[p,g]=k.useState(!1),[f,m]=k.useState(!1);k.useEffect(()=>{m(window.innerWidth<768);const q=()=>{m(window.innerWidth<768)};return window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]),k.useEffect(()=>{if(x&&!c)g(!0);else if(c)g(!1);else{const q=setTimeout(()=>{g(!1)},100);return()=>clearTimeout(q)}},[x,c]),k.useEffect(()=>{if(x&&h.current&&!c){if(f&&!t)return;h.current.getStage()&&h.current.moveToTop()}},[x,t,f,c]);const v=t||e.isSelected,w=k.useCallback(q=>{switch(q){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),_=k.useCallback(q=>{switch(q){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),y=k.useCallback(q=>{q.cancelBubble=!0;const L=q.target,D=L.x()-o,M=L.y()-l,J=Math.max(0,Math.min(D,i-e.dimensions.width)),ne=Math.max(0,Math.min(M,a-e.dimensions.height));L.x(Math.round(J+o)),L.y(Math.round(ne+l))},[o,l,i,a,e.dimensions.width,e.dimensions.height]),b=k.useCallback(q=>{if(q.cancelBubble=!0,!s)return;const L=q.target,D=L.x()-o,M=L.y()-l,J=Math.max(0,Math.min(D,i-e.dimensions.width)),ne=Math.max(0,Math.min(M,a-e.dimensions.height));s({...e,id:e.id||e._id,_id:e._id||e.id,dimensions:{...e.dimensions,x:Math.round(J),y:Math.round(ne)}})},[s,o,l,i,a,e]),E=k.useCallback(q=>{q.cancelBubble=!0},[]),j=k.useCallback(q=>{q.cancelBubble=!0,r&&!c&&r()},[r,c]),S=k.useCallback(()=>{f&&!v||c||u(!0)},[f,v,c]),C=k.useCallback(()=>{u(!1)},[]),T={x:0,y:0,width:10,height:10},A=e.dimensions||T,I=e.typeName||"Standard";e.ratePerSqm*A.width*A.height;const P=0,N=k.useMemo(()=>e.status!=="available"&&e.companyName?`${I} - ${A.width}×${A.height}m - ${e.companyName}`:`${I} - ${A.width}×${A.height}m`,[I,A.width,A.height,e.status,e.companyName]);return n.jsxs(Ys,{ref:h,x:A.x+o,y:A.y+l,width:A.width,height:A.height,draggable:!!s,onClick:j,onTap:j,onDragStart:E,onDragMove:y,onDragEnd:b,opacity:e.status==="available"?1:.7,cursor:e.status==="available"?"pointer":"default",onMouseEnter:S,onMouseLeave:C,listening:c?!1:!f||e.status==="available",transformsEnabled:c||f?"position":"all",children:[n.jsx(Lo,{width:A.width,height:A.height,fill:v?"rgba(24, 144, 255, 0.1)":_(e.status),stroke:v?"#1890ff":w(e.status),strokeWidth:v?2/d:1/d,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:c?0:f?2:3,shadowOffset:{x:1,y:1},shadowOpacity:c?0:.3,rotation:P,perfectDrawEnabled:!c,transformsEnabled:c?"position":"all",cornerRadius:.05}),n.jsx(Oi,{text:e.number,fontSize:Math.min(A.width,A.height)*.25,fill:"#000000",width:A.width,height:A.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!c,fontStyle:"bold",listening:!1}),v&&!c&&n.jsx(gp,{x:A.width-2,y:2,radius:Math.min(.8,A.width*.05),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/d,transformsEnabled:"position",listening:!1}),p&&!c&&n.jsxs(yp,{x:A.width/2,y:0,opacity:1,listening:!1,children:[n.jsx(vp,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),n.jsx(Oi,{text:N,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(N.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},Mc=k.memo(Dy),Qi=({width:e,height:t,exhibitionWidth:r=100,exhibitionHeight:s=100,halls:i=[],stalls:a=[],fixtures:o=[],selectedHall:l=null,selectedFixture:d=null,onSelectHall:c=()=>{},onSelectFixture:h=()=>{},onHallChange:x=()=>{},onFixtureChange:u=()=>{},onExhibitionChange:p=()=>{},onAddHall:g=()=>{},onAddStall:f=()=>{},onAddFixture:m=()=>{},children:v,isStallMode:w=!1,isFixtureMode:_=!1,isPublicView:y=!1})=>{const b=k.useRef(null),E=k.useRef(null),j=k.useRef(null),[S,C]=k.useState(1),[T,A]=k.useState({x:0,y:0}),[I,P]=k.useState(!1),[N,q]=k.useState(!1),[L,D]=k.useState({visible:!1,x:0,y:0}),[M,J]=k.useState(!1),[ne,Z]=k.useState(!1),[R,U]=k.useState(!1),[B,F]=k.useState(void 0);k.useEffect(()=>{const Fe=()=>{U(window.innerWidth<768)};return Fe(),window.addEventListener("resize",Fe),()=>{window.removeEventListener("resize",Fe)}},[]);const V=k.useCallback(Fe=>{if(Fe.evt.preventDefault(),!b.current)return;const $e=b.current,Ke=S,Oe=$e.getPointerPosition(),Be={x:(Oe.x-$e.x())/Ke,y:(Oe.y-$e.y())/Ke},ut=1.15,Ct=Fe.evt.deltaY<0?Ke*ut:Ke/ut,jr=Math.min(Math.max(.1,Ct),20),Rn={x:Oe.x-Be.x*jr,y:Oe.y-Be.y*jr};C(jr),A(Rn)},[S]),se=k.useCallback(()=>{if(!b.current)return;const Fe=b.current,$e=Math.min(S*1.15,20),Ke=Fe.width()/2,Oe=Fe.height()/2,Be={x:(Ke-T.x)/S,y:(Oe-T.y)/S},ut={x:Ke-Be.x*$e,y:Oe-Be.y*$e};C($e),A(ut)},[S,T]),xe=k.useCallback(()=>{if(!b.current)return;const Fe=b.current,$e=Math.max(S/1.15,.1),Ke=Fe.width()/2,Oe=Fe.height()/2,Be={x:(Ke-T.x)/S,y:(Oe-T.y)/S},ut={x:Ke-Be.x*$e,y:Oe-Be.y*$e};C($e),A(ut)},[S,T]),me=k.useCallback(Fe=>{Fe?(F(nl.pixelRatio),nl.pixelRatio=R?.8:1):B&&(nl.pixelRatio=B)},[B,R]),Q=k.useCallback(Fe=>{if(Fe.target===b.current&&(D({...L,visible:!1}),q(!0),me(!0),E.current)){if(y){const $e=R?{x:-10,y:-10,width:e+20,height:t+20}:void 0;E.current.cache($e)}if(E.current.hitGraphEnabled(!1),y&&b.current){const $e=b.current.container();$e.style.cursor="grabbing",$e.classList.add("dragging"),b.current.batchDraw(),E.current.getChildren().forEach(Oe=>{if(Oe.shadowForStrokeEnabled&&(Oe._savedShadowForStroke=Oe.shadowForStrokeEnabled(),Oe.shadowForStrokeEnabled(!1)),Oe.perfectDrawEnabled&&(Oe._savedPerfectDraw=Oe.perfectDrawEnabled(),Oe.perfectDrawEnabled(!1)),Oe.cache&&!Oe.isCached&&Oe.width&&Oe.height){Oe._dragCached=!0;try{R?Oe.cache({offset:10,pixelRatio:.8}):Oe.cache()}catch{Oe._dragCached=!1}}})}}},[L,y,me,R,e,t]),ee=k.useCallback(Fe=>{if(y&&Fe.target===b.current){if(Fe.evt&&Fe.evt._dragSkipUpdate)return;if(Fe.evt&&(Fe.evt._dragSkipUpdate=!0),b.current&&E.current){const $e=R?.85:.7;Math.random()>$e&&b.current.batchDraw()}return}Fe.target===b.current&&R&&E.current&&(Fe.cancelBubble=!0)},[R,y]),ce=k.useCallback(Fe=>{if(Fe.target===b.current){if(A({x:Fe.target.x(),y:Fe.target.y()}),me(!1),E.current&&(E.current.hitGraphEnabled(!0),y&&E.current.clearCache(),y&&b.current)){const $e=b.current.container();$e.style.cursor="",$e.classList.remove("dragging"),E.current.getChildren().forEach(Oe=>{Oe._savedShadowForStroke!==void 0&&(Oe.shadowForStrokeEnabled(Oe._savedShadowForStroke),delete Oe._savedShadowForStroke),Oe._savedPerfectDraw!==void 0&&(Oe.perfectDrawEnabled(Oe._savedPerfectDraw),delete Oe._savedPerfectDraw),Oe._dragCached&&(Oe.clearCache(),delete Oe._dragCached)})}setTimeout(()=>{b.current&&b.current.batchDraw()},50),q(!1)}},[y,me]),Ie=k.useCallback(()=>{P(!0),document.body.style.cursor=N?"grabbing":"grab"},[N]),re=k.useCallback(()=>{P(!1),document.body.style.cursor="default"},[]),_e=Fe=>{var Ke,Oe,Be;const $e=Fe.target.getClassName();if($e==="Stage"||$e==="Layer"){D({...L,visible:!1});return}if($e==="Group"||$e==="Rect"){c(null),h(null);const ut=(Ke=b.current)==null?void 0:Ke.getPointerPosition();if(ut&&Ne(ut)){const{x:Ct,y:jr}=ut,{x:Rn,y:sa}=((Oe=b.current)==null?void 0:Oe.position())||{x:0,y:0},{x:ia,y:aa}=((Be=b.current)==null?void 0:Be.scale())||{x:1,y:1},Jo=(Ct-Rn)/ia,Zo=(jr-sa)/aa;D({x:Jo,y:Zo,visible:!0})}else D({...L,visible:!1})}else D({...L,visible:!1})},Ne=Fe=>{if(!r||!s||!b.current)return!1;const{x:$e,y:Ke}=Fe,{x:Oe,y:Be}=b.current.position(),{x:ut}=b.current.scale(),Ct={x:($e-Oe)/ut,y:(Ke-Be)/ut};return Ct.x>=0&&Ct.x<=r&&Ct.y>=0&&Ct.y<=s},ye=k.useCallback(()=>{c(null),h(null),J(!0),Z(!0),D({...L,visible:!1})},[c,h,L]),ze=k.useCallback(Fe=>{p(Fe),Z(!1)},[p]),qe=()=>{J(!0),Z(!0),D({...L,visible:!1})},Ft=()=>{g(),D({...L,visible:!1})},tr=()=>{f(),D({...L,visible:!1})};k.useEffect(()=>{if(e>0&&t>0&&r>0&&s>0){const Fe=w?20:40,$e=e-Fe*2,Ke=t-Fe*2,Oe=$e/r,Be=Ke/s,Ct=Math.min(Oe,Be),jr=(e-r*Ct)/2,Rn=(t-s*Ct)/2;C(Ct),A({x:jr,y:Rn}),b.current&&b.current.batchDraw()}},[e,t,r,s,w]);const dr=xt.Children.map(v,Fe=>xt.isValidElement(Fe)?xt.cloneElement(Fe,{scale:S,position:T}):Fe),Fn=n.jsx(ah,{width:r,height:s,scale:S,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return e<=0||t<=0||r<=0||s<=0?n.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:I?N?"grabbing":"grab":"default"},children:[n.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:n.jsxs(ue,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[n.jsx(te,{icon:n.jsx(Cx,{}),onClick:xe,disabled:S<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),n.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(S*100),"%"]}),n.jsx(te,{icon:n.jsx(Ax,{}),onClick:se,disabled:S>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),n.jsxs(bp,{ref:b,width:e,height:t,onClick:_e,draggable:!0,onDragStart:Q,onDragMove:ee,onDragEnd:ce,onMouseEnter:Ie,onMouseLeave:re,onWheel:V,x:T.x,y:T.y,scaleX:S,scaleY:S,perfectDrawEnabled:!N&&!y,hitGraphEnabled:!N,pixelRatio:N?R?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:y?R?5:3:0,children:[y&&n.jsx(wp,{ref:j,listening:!1,children:Fn}),n.jsxs(jp,{ref:E,imageSmoothingEnabled:!N||!y,children:[!y&&n.jsx(ah,{width:r,height:s,scale:S,position:{x:0,y:0},isSelected:M,onSelect:_?void 0:ye,onChange:w||_?void 0:p,isEditable:!w&&!_}),i.map(Fe=>n.jsx(pf,{hall:Fe,isSelected:(l==null?void 0:l.id)===Fe.id,onSelect:()=>c(Fe),onChange:w||_?void 0:x,scale:S,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isStallMode:w||_},Fe._id||Fe.id)),a.map(Fe=>{const $e=Fe._id||Fe.id,Ke=i.find(Oe=>Oe.id===Fe.hallId||Oe._id===Fe.hallId);return Ke?n.jsx(Mc,{stall:{...Fe,_id:$e,id:$e},hallX:Ke.dimensions.x,hallY:Ke.dimensions.y,hallWidth:Ke.dimensions.width,hallHeight:Ke.dimensions.height,scale:S,isDragging:N&&y},$e):null}),o.map(Fe=>{const $e=Fe._id||Fe.id,Oe=((d==null?void 0:d._id)||(d==null?void 0:d.id))===$e;return n.jsx(mf,{fixture:{...Fe,_id:$e,id:$e},isSelected:Oe,onSelect:()=>h(Fe),onChange:_?u:void 0,scale:S,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:s,isEditable:_},$e)}),dr]})]}),n.jsx(Py,{visible:L.visible,x:L.x,y:L.y,onExhibitionClick:qe,onHallClick:Ft,onStallClick:tr,onClose:()=>D({...L,visible:!1})}),n.jsx(Fy,{visible:ne,width:r,height:s,onCancel:()=>Z(!1),onSubmit:ze})]})},Ly=({visible:e,hall:t,exhibitionWidth:r,exhibitionHeight:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=H.useForm();xt.useEffect(()=>{e&&(t?l.setFieldsValue({name:t.name,width:t.dimensions.width,height:t.dimensions.height}):l.setFieldsValue({name:"",width:Math.min(10,r),height:Math.min(10,s)}))},[e,t,r,s,l]);const d=async()=>{var u,p;const h=await l.validateFields(),x=t?{...t,_id:t._id,id:t.id||t._id,name:h.name,dimensions:{x:((u=t.dimensions)==null?void 0:u.x)||0,y:((p=t.dimensions)==null?void 0:p.y)||0,width:h.width,height:h.height},exhibitionId:t.exhibitionId}:{name:h.name,dimensions:{x:0,y:0,width:h.width,height:h.height}};a(x),l.resetFields()},c=()=>{t&&o&&Ve.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${t.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>o(t)})};return n.jsx(Ve,{title:t?"Edit Hall":"Add New Hall",open:e,onCancel:()=>{l.resetFields(),i()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:n.jsxs(H,{form:l,layout:"vertical",style:{marginTop:"16px"},children:[n.jsx(H.Item,{name:"name",label:n.jsxs("span",{style:{color:"#000"},children:["Hall Name ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:n.jsx(he,{placeholder:"Enter hall name"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[n.jsx(H.Item,{name:"width",label:n.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:r,message:`Width cannot exceed ${r} meters`}],children:n.jsx(yt,{min:5,max:r,style:{width:"100%"},placeholder:"Enter width"})}),n.jsx(H.Item,{name:"height",label:n.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",n.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:s,message:`Height cannot exceed ${s} meters`}],children:n.jsx(yt,{min:5,max:s,style:{width:"100%"},placeholder:"Enter height"})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[n.jsx(ue,{children:t&&o&&n.jsx(te,{className:"delete-button",icon:n.jsx(ar,{}),onClick:c,children:"Delete Hall"})}),n.jsxs(ue,{children:[n.jsx(te,{onClick:()=>{l.resetFields(),i()},children:"Cancel"}),n.jsx(te,{type:"primary",onClick:d,className:"update-button",children:t?"Update Hall":"Create Hall"})]})]})]})})},{Title:Oy}=Le,By=({visible:e,stall:t,hall:r,exhibition:s,onCancel:i,onSubmit:a,onDelete:o})=>{const[l]=H.useForm(),[d,c]=k.useState([]),[h,x]=k.useState(!1),u=(v,w,_,y,b)=>{const j=[..._].sort((C,T)=>{const A=Math.floor(C.dimensions.y/5),I=Math.floor(T.dimensions.y/5);return A===I?C.dimensions.x-T.dimensions.x:C.dimensions.y-T.dimensions.y}),S=(C,T)=>C+v>y||T+w>b?!1:!j.some(A=>{const I=A.dimensions.x,P=A.dimensions.y,N=A.dimensions.width,q=A.dimensions.height,L=1;return!(C+v+L<=I||C>=I+N+L||T+w+L<=P||T>=P+q+L)});for(const C of j){const T=C.dimensions.x+C.dimensions.width+1,A=C.dimensions.y;if(S(T,A))return{x:T,y:A};const I=C.dimensions.x,P=C.dimensions.y+C.dimensions.height+1;if(S(I,P))return{x:I,y:P}}for(let C=0;C<b;C+=5)for(let T=0;T<y;T+=5)if(S(T,C))return{x:T,y:C};return{x:0,y:0}};k.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const v={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",v),l.setFieldsValue(v)}else r&&!l.getFieldValue("status")&&l.setFieldsValue({status:"available",width:Math.min(20,r.dimensions.width/4),height:Math.min(20,r.dimensions.height/4),ratePerSqm:0})},[t,r,l]),k.useEffect(()=>{e&&(async()=>{var w;try{x(!0);const _=await Ms.getStallTypes();console.log("Fetched stall types:",_.data);const y=((w=s.stallRates)==null?void 0:w.map(E=>E.stallTypeId))||[];console.log("Configured stall type IDs:",y);const b=_.data.filter(E=>E.status==="active"&&E._id&&y.includes(E._id));console.log("Filtered stall types:",b),c(b)}catch(_){console.error("Failed to fetch stall types:",_)}finally{x(!1)}})()},[e,s.stallRates]);const p=v=>{var _;console.log("Stall type changed to:",v);const w=(_=s.stallRates)==null?void 0:_.find(y=>y.stallTypeId===v);console.log("Found stall rate:",w),w&&l.setFieldsValue({ratePerSqm:w.rate})},g=()=>{l.resetFields(),i()},f=()=>{if(console.log("Hall data:",r),!r||!r._id&&!r.id){be.error("Invalid hall selected. Please try again.");return}l.validateFields().then(v=>{var b;const w=r._id||r.id;if(!w){be.error("Hall ID is missing. Please select a hall again.");return}const _=t?{x:t.dimensions.x,y:t.dimensions.y}:u(v.width,v.height,((b=s.stalls)==null?void 0:b.filter(E=>E.hallId===w))||[],r.dimensions.width,r.dimensions.height),y={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:v.number,stallTypeId:v.stallTypeId,dimensions:{x:_.x,y:_.y,width:v.width,height:v.height},ratePerSqm:v.ratePerSqm,status:v.status,hallId:w};console.log("Submitting stall data:",y),a(y)})},m=v=>{switch(v){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return n.jsx(n.Fragment,{children:n.jsx(Ve,{title:n.jsxs(ue,{children:[n.jsx(yr,{style:{fontSize:"20px"}}),n.jsx(Oy,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:e,onCancel:g,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[n.jsxs(ue,{size:"middle",children:[t&&o&&n.jsx(te,{danger:!0,icon:n.jsx(ar,{}),onClick:()=>o(t),children:"Delete"}),n.jsx(te,{onClick:g,children:"Cancel"}),n.jsx(te,{type:"primary",onClick:f,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:n.jsxs(H,{form:l,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[n.jsx(H.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:n.jsx(he,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),n.jsx(H.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(Pe,{loading:h,placeholder:"Select stall type",size:"large",onChange:p,children:d.map(v=>n.jsx(Pe.Option,{value:v._id,children:v.name},v._id))})}),n.jsx(nt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),n.jsxs(ue,{style:{width:"100%",gap:"16px"},children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:n.jsx(yt,{min:1,max:(r==null?void 0:r.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:n.jsx(yt,{min:1,max:(r==null?void 0:r.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),n.jsx(nt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),n.jsx(H.Item,{name:"ratePerSqm",label:"Rate per sq.m (₹)",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:n.jsx(yt,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"₹",disabled:!0,formatter:v=>`${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>{const w=v?Number(v.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(w)?0:w}})}),n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[n.jsx(Pe.Option,{value:"available",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("available")}}),"Available"]})}),n.jsx(Pe.Option,{value:"booked",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("booked")}}),"Booked"]})}),n.jsx(Pe.Option,{value:"reserved",children:n.jsxs(ue,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:m("reserved")}}),"Reserved"]})})]})})]})})})},oh=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const s=localStorage.getItem("token");return s?`${t}/api/uploads/${r}?token=${s}`:""},My=({name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIcons:o,borderColor:l=null,borderRadius:d=0})=>{k.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:e,type:t,color:r,rotation:s,showName:i,iconUrl:a,defaultIconAvailable:!!o[t],borderColor:l,borderRadius:d})},[e,t,r,s,i,a,o,l,d]);const c=o[t]||"📦";return n.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[n.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${d||4}px`,backgroundColor:r||"#f0f0f0",transform:`rotate(${s}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:l?`1px solid ${l}`:"1px solid rgba(0,0,0,0.05)"},children:a?n.jsx("img",{src:a,alt:e,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):n.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:c})}),i&&n.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:e}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[n.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),n.jsx("span",{children:"•"}),n.jsx("span",{children:r}),s>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:[s,"°"]})]}),l&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Border: ",l]})]}),d>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Radius: ",d,"px"]})]})]})]})},{Text:$y}=Le,Tl=({activeKey:e,form:t,fixture:r,exhibitionWidth:s,exhibitionHeight:i,selectedType:a,showName:o,iconFileList:l,fixtureTypes:d,fixtureIcons:c,defaultColors:h,defaultDimensions:x,colorPresets:u,uploadProps:p,iconPreviewVisible:g=!1,previewImage:f="",onTypeChange:m,onColorChange:v,onShowNameChange:w,onIconPreviewCancel:_=()=>{}})=>{switch(e){case"basic":return y();case"position":return b();case"appearance":return E();default:return y()}function y(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(H.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:n.jsx(he,{placeholder:"Enter fixture name",prefix:n.jsx(Jr,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(H.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:n.jsx(Ir,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:j=>{w(j),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),n.jsx(H.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:n.jsx(Pe,{placeholder:"Select fixture type",onChange:m,options:d.map(j=>({...j,label:n.jsxs(ue,{children:[n.jsx("span",{style:{fontSize:16},children:c[j.value]}),n.jsx("span",{children:j.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function b(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(de,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:0,max:s,step:.1,precision:1,placeholder:"X position"})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"Y position"})})})]})}),n.jsx(de,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:n.jsx(yt,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),n.jsx(de,{size:"small",title:n.jsxs("span",{children:[n.jsx(Ix,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsx(H.Item,{name:"rotation",noStyle:!0,children:n.jsx(yu,{min:0,max:360,marks:{0:"0°",90:"90°",180:"180°",270:"270°",360:"360°"},tooltip:{formatter:j=>`${j}°`},style:{marginTop:10},keyboard:!1})})})]})}function E(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(H.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(j,S)=>{try{return S?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:n.jsx(ud,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,onChange:v,style:{width:"100%"}})}),n.jsx(H.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:n.jsx(ud,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:u,style:{width:"100%"}})}),n.jsx(H.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:n.jsx(yt,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),n.jsxs(de,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[n.jsx("div",{style:{marginBottom:0},children:n.jsx(Ri,{...p,children:l.length<1&&n.jsxs("div",{children:[n.jsx(Nx,{style:{fontSize:20}}),n.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),n.jsx($y,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),n.jsx(H.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:n.jsx(he,{placeholder:"https://example.com/icon.png",prefix:n.jsx(Fx,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(Ve,{open:g,title:"Icon Preview",footer:null,onCancel:_,children:n.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:f})})]})}},Uy=e=>[{key:"basic",label:n.jsxs("span",{children:[n.jsx(ms,{}),"Basic Info"]}),children:n.jsx(Tl,{...e,activeKey:"basic"})},{key:"position",label:n.jsxs("span",{children:[n.jsx(os,{}),"Position"]}),children:n.jsx(Tl,{...e,activeKey:"position"})},{key:"appearance",label:n.jsxs("span",{children:[n.jsx(Pi,{}),"Appearance"]}),children:n.jsx(Tl,{...e,activeKey:"appearance"})}],{Text:Jk,Title:Zk}=Le,{TabPane:e4}=Gt,zy=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],wa={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},Dn={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},_l={sofa:"🛋️",chair:"🪑",table:"🪟",desk:"🖥️",plant:"🪴",entrance:"🚪",exit:"🚪",info:"ℹ️",restroom:"🚻",food:"🍽️",custom:"📦"},qy=({visible:e,fixture:t,onCancel:r,onSubmit:s,onDelete:i,exhibitionWidth:a,exhibitionHeight:o})=>{const[l]=H.useForm(),[d,c]=k.useState(!1),[h,x]=k.useState(""),[u,p]=k.useState("basic"),[g,f]=k.useState(""),[m,v]=k.useState([]),[w,_]=k.useState(!1),[y,b]=k.useState(""),{message:E}=Yt.useApp(),[j,S]=k.useState("#f0f0f0"),[C,T]=k.useState("New Fixture"),[A,I]=k.useState("chair"),[P,N]=k.useState(0),[q,L]=k.useState(!0),[D,M]=k.useState(null),[J,ne]=k.useState(0);k.useEffect(()=>{if(e)if(t){const re=se(t.color),_e=Dn[t.type]||"#f0f0f0",Ne=re||_e;console.log("Setting up fixture colors:",{original:t.color,normalized:re,fallback:_e,final:Ne}),S(Ne),T(t.name),I(t.type),N(t.rotation||0),x(t.type),L(t.showName!==!1),M(t.borderColor||null),ne(t.borderRadius||0)}else{const re="chair",_e=Dn[re];S(_e),T("New Fixture"),I(re),N(0),x(re),L(!0),M(null),ne(0)}},[e,t]),k.useEffect(()=>{if(e&&l){if(t){const re=se(t.color),_e=Dn[t.type]||"#f0f0f0",Ne=re||_e;l.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:Ne,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const ye=t.icon?oh(t.icon):"";f(ye),t.icon?v([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:ye,thumbUrl:ye}]):v([])}else{const re="chair",_e=Dn[re];l.setFieldsValue({name:"New Fixture",type:re,position:{x:Math.floor(a/2),y:Math.floor(o/2)},dimensions:wa[re],rotation:0,color:_e,icon:"",showName:!0,borderColor:null,borderRadius:0}),f(""),v([])}p("basic")}},[e,t,l,a,o]);const Z=()=>{if(l&&e)try{const re=l.getFieldsValue(!0);if(re.name&&T(re.name),re.type&&I(re.type),re.rotation!==void 0&&N(re.rotation),re.color){const _e=se(re.color);_e&&S(_e)}if(re.showName!==void 0&&L(re.showName),re.borderColor!==void 0){const _e=re.borderColor?se(re.borderColor):null;M(_e)}re.borderRadius!==void 0&&ne(re.borderRadius)}catch(re){console.log("Error updating preview",re)}};k.useEffect(()=>{if(l&&e)return l.getFieldsValue,Z(),()=>{}},[l,e]);const R=re=>{if(x(re),I(re),!t){const _e=Dn[re]||Dn.custom;l.setFieldsValue({dimensions:wa[re]||wa.custom,color:_e}),S(_e)}},U=re=>{const _e=se(re);l.setFieldValue("color",_e),S(_e);const Ne=Object.entries(Dn).find(([ye,ze])=>ze.toLowerCase()===_e.toLowerCase());Ne&&!t&&(l.setFieldValue("type",Ne[0]),x(Ne[0]),I(Ne[0]))},B=()=>(console.log("Rendering fixture preview with:",{name:C,type:A,color:j,rotation:P,showName:q,iconUrl:g,borderColor:D,borderRadius:J}),n.jsx(My,{name:C,type:A,color:j,rotation:P,showName:q,iconUrl:g,defaultIcons:_l,borderColor:D,borderRadius:J})),F=({file:re,fileList:_e})=>{var Ne;if(re.status==="uploading"&&v(_e),re.status==="done"){E.success(`${re.name} uploaded successfully`);let ze=(((Ne=re.response)==null?void 0:Ne.url)||"").replace(/^\/api\/uploads\//,"");ze&&!ze.startsWith("fixtures/")&&(ze=`fixtures/${ze.replace(/^\//,"")}`),console.log("Icon path stored in form:",ze),l.setFieldValue("icon",ze);const qe=oh(ze);console.log("Using direct backend URL:",qe),f(qe);const Ft=re.name.toLowerCase().endsWith(".svg"),tr=_e.map(dr=>dr.uid===re.uid?{...dr,url:qe,thumbUrl:qe,type:Ft?"image/svg+xml":dr.type}:dr);v(tr),console.log("Form values after icon upload:",l.getFieldsValue(!0))}re.status==="error"&&(E.error(`${re.name} upload failed.`),v(_e.filter(ye=>ye.uid!==re.uid)))},V={name:"file",action:`${Ee.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:m,onChange:F,onPreview:re=>{b(re.url||re.thumbUrl||""),_(!0)},onRemove:()=>(f(""),v([]),l.setFieldValue("icon",""),console.log("Form values after icon removal:",l.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:n.jsx(ar,{style:{color:"#ff4d4f"}})}},se=re=>{try{if(!re)return"#f0f0f0";if(typeof re=="object"&&re!==null){if(typeof re.toHexString=="function")return re.toHexString();if(re.rgb||re.hex)return re.hex||`rgb(${re.rgb.r},${re.rgb.g},${re.rgb.b})`}if(typeof re=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(re))return re;if(/^([0-9A-F]{3}){1,2}$/i.test(re))return`#${re}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(re))return re}return"#f0f0f0"}catch(_e){return console.error("Error normalizing color:",_e),"#f0f0f0"}},xe=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],me=xt.useCallback(()=>{t&&i&&i(t)},[t,i]),Q=re=>{p(re),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},ee=Uy({form:l,fixture:t,exhibitionWidth:a,exhibitionHeight:o,selectedType:h,showName:q,iconFileList:m,fixtureTypes:zy,fixtureIcons:_l,defaultColors:Dn,defaultDimensions:wa,colorPresets:xe,uploadProps:V,iconPreviewVisible:w,previewImage:y,onTypeChange:R,onColorChange:U,onShowNameChange:re=>L(re),onIconPreviewCancel:()=>_(!1),activeKey:u}),ce=async()=>{try{c(!0);const re=await l.validateFields();T(re.name),I(re.type),N(re.rotation||0),S(se(re.color)),L(re.showName),M(re.borderColor?se(re.borderColor):null),ne(re.borderRadius||0);let _e="";re.icon?_e=Ie(re.icon):t!=null&&t.icon&&(_e=t.icon),console.log("Form values being submitted:",{name:re.name,type:re.type,color:re.color,icon:re.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:_e,showName:re.showName,borderColor:re.borderColor,borderRadius:re.borderRadius});const Ne=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",ye=re.color?se(re.color):(t==null?void 0:t.color)||"#f0f0f0",ze=re.borderColor?se(re.borderColor):null,qe={...t,id:Ne,_id:Ne,name:re.name,type:re.type,position:re.position,dimensions:re.dimensions,rotation:re.rotation,color:ye,icon:_e,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:ze,borderRadius:re.borderRadius||0};Ne&&(qe.showName=re.showName),console.log("Submitting fixture with icon path:",_e),console.log("Color being submitted:",ye),await s(qe),r()}catch(re){console.error("Fixture submission failed:",re),E.error("Failed to save fixture. Please check the form and try again.")}finally{c(!1)}},Ie=re=>{if(!re||typeof re!="string")return"";if(re.startsWith("fixtures/")&&!re.includes("?")&&!re.includes("http"))return re;let _e=re.replace(/^\/api\/uploads\//,"");if(_e=_e.replace(/^\//,""),_e.includes("?")||_e.includes("http")){const Ne=_e.split("?")[0].split("/").pop()||"";if(Ne)return`fixtures/${Ne}`}return _e&&!_e.startsWith("fixtures/")?`fixtures/${_e}`:_e};return n.jsxs(Ve,{title:n.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[n.jsx("span",{style:{fontSize:24,marginRight:8},children:t?_l[t.type]:"🪑"}),n.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:e,onCancel:r,confirmLoading:d,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx("div",{children:t&&i&&n.jsx(te,{danger:!0,icon:n.jsx(ar,{}),onClick:me,style:{borderRadius:"6px"},children:"Delete"})}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx(te,{onClick:r,icon:n.jsx(Rx,{}),style:{borderRadius:"6px"},children:"Cancel"}),n.jsx(te,{type:"primary",onClick:ce,icon:n.jsx(fs,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),B(),n.jsx(H,{form:l,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:Z,children:n.jsx(Gt,{activeKey:u,onChange:Q,items:ee,tabBarStyle:{marginBottom:16},centered:!0})})]})},Wy=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=Me(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Hy=()=>{var g;const{id:e}=Fr(),t=In(),r=Je(),s=it(),i=((g=t.state)==null?void 0:g.exhibitionId)||e,{currentExhibition:a}=Me(f=>f.exhibition),o=k.useRef(null),[l,d]=k.useState({width:100,height:100}),[c,h]=k.useState({width:0,height:0}),[x]=H.useForm();k.useEffect(()=>{if(!i){be.error("Exhibition ID not found"),r("/exhibition");return}s(Or(i))},[i,s,r]),k.useEffect(()=>{a!=null&&a.dimensions&&(d(a.dimensions),x.setFieldsValue(a.dimensions))},[a,x]),k.useEffect(()=>{const f=()=>{o.current&&h({width:o.current.clientWidth,height:o.current.clientHeight})};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const u=async()=>{try{const f=await x.validateFields();await gt.updateExhibition(i,{dimensions:f}),be.success("Exhibition space saved successfully"),await s(Or(i)).unwrap(),r(Lt(a,"layout"),{state:{exhibitionId:i}})}catch{be.error("Failed to save exhibition space")}},p=f=>{d(m=>({...m,...f})),x.setFieldsValue(f)};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Wy,{exhibitionId:i}),n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("span",{children:"Exhibition Space Setup"}),n.jsx(te,{type:"primary",icon:n.jsx(fs,{}),onClick:u,children:"Save and Continue"})]}),children:n.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[n.jsx("div",{style:{flex:"0 0 300px"},children:n.jsxs(H,{form:x,layout:"vertical",initialValues:l,children:[n.jsx(H.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},onChange:f=>p({width:f||10})})}),n.jsx(H.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(yt,{min:10,max:1e3,style:{width:"100%"},onChange:f=>p({height:f||10})})})]})}),n.jsx("div",{ref:o,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:n.jsx(Xi,{children:n.jsx(Qi,{width:c.width,height:c.height,exhibitionWidth:l.width,exhibitionHeight:l.height,onExhibitionChange:p})})})]})})]})},Vy=({exhibitionId:e})=>{const t=Je(),{currentExhibition:r}=Me(s=>s.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>t(Lt(r),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Gy=()=>{var l,d,c,h,x;const{id:e}=Fr(),t=In(),r=Je(),s=it(),i=((l=t.state)==null?void 0:l.exhibitionId)||e,{currentExhibition:a,halls:o}=Me(u=>u.exhibition);return k.useEffect(()=>{i&&(s(Or(i)),s(hn(i)))},[i,s]),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Vy,{exhibitionId:i}),n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(ps,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),n.jsx(te,{type:"primary",onClick:()=>r(Lt(a,"space"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(K,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(ms,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),n.jsx(te,{type:"primary",disabled:!((d=a==null?void 0:a.dimensions)!=null&&d.width)||!((c=a==null?void 0:a.dimensions)!=null&&c.height),onClick:()=>r(Lt(a,"halls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(K,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(yr,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),n.jsx(te,{type:"primary",disabled:!o.length,onClick:()=>r(Lt(a,"stalls"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),n.jsx(K,{xs:24,sm:12,md:8,children:n.jsxs(de,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[n.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:n.jsx(Ro,{style:{fontSize:"48px",color:"#1890ff"}})}),n.jsx(de.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),n.jsx(te,{type:"primary",disabled:!((h=a==null?void 0:a.dimensions)!=null&&h.width)||!((x=a==null?void 0:a.dimensions)!=null&&x.height),onClick:()=>r(Lt(a,"fixtures"),{state:{exhibitionId:i}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})},Yy=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=Me(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Ky=()=>{var b,E,j;const{id:e}=Fr(),t=In(),r=Je(),s=it(),i=((b=t.state)==null?void 0:b.exhibitionId)||e,{currentExhibition:a,halls:o}=Me(S=>S.exhibition),l=k.useRef(null),[d,c]=be.useMessage(),[h,x]=k.useState(!1),[u,p]=k.useState(null),[g,f]=k.useState({width:0,height:0});k.useEffect(()=>{const S=()=>{if(l.current){const{clientWidth:T,clientHeight:A}=l.current;f({width:Math.max(T||400,400),height:Math.max(A||400,400)})}};S();const C=new ResizeObserver(S);return l.current&&C.observe(l.current),window.addEventListener("resize",S),()=>{C.disconnect(),window.removeEventListener("resize",S)}},[]),k.useEffect(()=>{if(!i){d.error("Exhibition ID not found"),r("/exhibition");return}s(Or(i))},[i,s,r,d]),k.useEffect(()=>{var S,C;if(a){if(!((S=a.dimensions)!=null&&S.width)||!((C=a.dimensions)!=null&&C.height)){d.info("Please set up exhibition space first"),r(Lt(a,"space"),{state:{exhibitionId:i}});return}s(hn(i))}},[a,i,s,r,d]);const m=()=>{p(null),x(!0)},v=S=>{p(S),x(!!S)},w=async S=>{var C;try{S.id?(await gt.updateHall(i,S.id,S),d.success("Hall updated successfully"),x(!1)):(await gt.createHall(i,S),d.success("Hall created successfully"),x(!1)),s(hn(i))}catch(T){console.error("Hall operation failed:",T),((C=T.response)==null?void 0:C.status)===409?d.warning({content:T.response.data.message,duration:6,style:{marginTop:"20vh"}}):(d.error(T.message||"Failed to save hall"),x(!1))}},_=async S=>{var C,T;try{const A=S._id||S.id;if(!A)throw new Error("Hall ID is required");await gt.deleteHall(i,A),d.success("Hall deleted successfully"),x(!1),p(null),s(hn(i))}catch(A){console.error("Failed to delete hall:",A),d.error(((T=(C=A.response)==null?void 0:C.data)==null?void 0:T.message)||"Failed to delete hall")}},y=async()=>{try{await gt.saveLayout(i,o),d.success("Layout saved successfully")}catch{d.error("Failed to save layout")}};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(Yy,{exhibitionId:i}),c,n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(ue,{children:[n.jsx("span",{children:"Hall Management"}),n.jsx(te,{icon:n.jsx(vu,{}),onClick:()=>r(Lt(a,"space"),{state:{exhibitionId:i}}),children:"Back to Space Setup"})]}),n.jsxs(ue,{children:[n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),onClick:m,children:"Add Hall"}),n.jsx(te,{type:"primary",icon:n.jsx(fs,{}),onClick:y,disabled:!o.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:n.jsx("div",{ref:l,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Xi,{children:g.width>0&&g.height>0&&(a==null?void 0:a.dimensions)&&n.jsx(Qi,{width:g.width,height:g.height,exhibitionWidth:a.dimensions.width,exhibitionHeight:a.dimensions.height,halls:o,selectedHall:u,onSelectHall:v,onHallChange:w,onAddHall:m})})})}),n.jsx(Ly,{visible:h,hall:u,onCancel:()=>x(!1),onSubmit:w,onDelete:_,exhibitionWidth:((E=a==null?void 0:a.dimensions)==null?void 0:E.width)||100,exhibitionHeight:((j=a==null?void 0:a.dimensions)==null?void 0:j.height)||100})]})},Xy=ve(Ve)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,Qy=ve.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Ei=ve.div`
  padding: 24px 32px 32px;
`,Jy=ve.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,Zy=ve.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;ve.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;ve.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;ve.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;ve.div`
  border: 1px solid ${e=>e.selected?"#4b47b9":"#e6e6f0"};
  background: ${e=>e.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${e=>e.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${e=>e.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${e=>e.selected?"#4b47b9":"white"};
    border: 2px solid ${e=>e.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const ev=ve(de)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;ve(te)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;ve.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;ve(de)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;ve(he)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const kl=ve(te)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;ve(We)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;ve.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;ve(Yi)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;ve.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;ve.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;ve.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;ve.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;ve.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px × 3) + (16px × 2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;ve(de)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const lh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],exhibition:i})=>{const[a,o]=k.useState([]);k.useEffect(()=>{let p=[...(e.getFieldValue("selectedStalls")||[]).map(g=>String(g))];if(r){const g=String(r);p.some(f=>f===g)||p.push(g)}s.length>0&&s.forEach(g=>{const f=String(g);p.some(m=>m===f)||p.push(f)}),console.log("StallDetailsStep - Initial stalls after normalization:",p),e.setFieldsValue({selectedStalls:p}),o(p)},[e,r,s]),k.useEffect(()=>{if(a.length>0){const x=e.getFieldValue("selectedStalls")||[],u=new Set(x.map(f=>String(f))),p=new Set(a.map(f=>String(f)));let g=u.size!==p.size;if(!g){for(const f of p)if(!u.has(f)){g=!0;break}}if(g){console.log("Syncing form with selected stalls:",a);const f=a.map(m=>String(m));e.setFieldsValue({selectedStalls:f}),e.validateFields(["selectedStalls"]).catch(m=>{})}}},[a,e]);const l=k.useMemo(()=>!t||t.length===0?[]:t.filter(x=>a.includes(x.id)),[t,a]),d=k.useMemo(()=>{var y,b,E;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const x=t.filter(j=>a.includes(j.id)),u=x.reduce((j,S)=>j+(S.price||S.ratePerSqm*S.dimensions.width*S.dimensions.height),0),g=(((y=i==null?void 0:i.publicDiscountConfig)==null?void 0:y.filter(j=>j.isActive))||[]).map(j=>{const S=j.type==="percentage"?u*(Math.min(Math.max(0,j.value),100)/100):Math.min(j.value,u);return{name:j.name,type:j.type,value:j.value,amount:S}}),f=g.reduce((j,S)=>j+S.amount,0),m=u-f,v=((E=(b=i==null?void 0:i.taxConfig)==null?void 0:b.filter(j=>j.isActive))==null?void 0:E.map(j=>({name:j.name,rate:j.rate,amount:m*(j.rate/100)})))||[],w=v.reduce((j,S)=>j+S.amount,0),_=m+w;return{baseAmount:u,discounts:g,totalDiscountAmount:f,amountAfterDiscount:m,taxes:v,totalTaxAmount:w,total:_,selectedStallNumbers:x.map(j=>`${j.number||j.stallNumber||`Stall ${j.id}`} (${j.hallName||`Hall ${j.hallId||1}`})`).join(", ")}},[t,a,i==null?void 0:i.taxConfig,i==null?void 0:i.publicDiscountConfig]),c=x=>{const u=String(x);if(a.some(g=>String(g)===u)){const g=a.filter(f=>String(f)!==u);o(g),e.setFieldsValue({selectedStalls:g}),be.info("Stall removed from selection")}},h=x=>`₹${x.toLocaleString("en-IN")}`;return n.jsxs(Ei,{children:[n.jsx(Jy,{children:"Your Selected Stalls"}),n.jsx(Zy,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),n.jsx(H.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:n.jsx(Pe,{mode:"multiple"})}),l.length>0?n.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:n.jsx(tt,{dataSource:l.map(x=>({...x,key:x.id,price:x.price||x.ratePerSqm*x.dimensions.width*x.dimensions.height,area:x.dimensions.width*x.dimensions.height,dimensions:`${x.dimensions.width}m × ${x.dimensions.height}m`,size:`${x.dimensions.width}m × ${x.dimensions.height}m`,stallType:x.stallType||{name:x.typeName||x.type||"Standard"},type:x.typeName||x.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(x,u)=>n.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",x||u.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(x,u)=>n.jsx(Se,{color:"blue",style:{borderRadius:"4px"},children:x||`Hall ${u.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(x,u)=>{var g;const p=((g=u.stallType)==null?void 0:g.name)||u.type||"Standard";return n.jsx(Se,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:p})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(x,u)=>n.jsxs(ue,{direction:"vertical",size:0,children:[n.jsx("span",{style:{fontWeight:500},children:x}),n.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[u.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(x,u)=>n.jsxs("span",{style:{color:"#555"},children:["₹",(u.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:x=>n.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:h(x)})},{title:"",key:"action",width:70,align:"center",render:(x,u)=>n.jsx(ct,{title:"Remove from selection",children:n.jsx(te,{type:"text",danger:!0,icon:n.jsx(ar,{}),onClick:()=>c(u.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):n.jsx(mt,{description:"No stalls selected yet. Please select stalls from the layout.",image:mt.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),a.length>0&&n.jsxs(ev,{title:n.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Selected Stalls"}),n.jsxs("div",{className:"value",children:[a.length," stall(s) selected"]})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Stall Numbers"}),n.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:d.selectedStallNumbers})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Base Amount"}),n.jsx("div",{className:"value",children:h(d.baseAmount)})]}),d.discounts.map((x,u)=>n.jsxs("div",{className:"summary-row discount",children:[n.jsxs("div",{className:"label",children:[x.name,x.type==="percentage"?` (${x.value}%)`:""]}),n.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",h(x.amount)]})]},`discount-${u}`)),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Amount after Discount"}),n.jsx("div",{className:"value",style:{fontWeight:500},children:h(d.amountAfterDiscount)})]}),d.taxes.map((x,u)=>n.jsxs("div",{className:"summary-row",children:[n.jsxs("div",{className:"label",children:[x.name," (",x.rate,"%)"]}),n.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",h(x.amount)]})]},`tax-${u}`)),n.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[n.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),n.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:h(d.total)})]})]})]})},{Title:tv,Paragraph:ch,Text:wn}=Le,{Panel:t4}=Px,{Option:rv}=Pe,dh=({form:e,formValues:t,selectedStallIds:r=[],exhibition:s,stallDetails:i=[]})=>{const a=e.getFieldValue("selectedStalls")||r||[],[o,l]=k.useState(e.getFieldValue("amenities")||[]),[d,c]=k.useState({}),h=k.useMemo(()=>i!=null&&i.length?i.filter(E=>a.includes(E.id)):[],[i,a]),x=k.useMemo(()=>h.reduce((E,j)=>E+j.dimensions.width*j.dimensions.height,0),[h]),u=(s==null?void 0:s.basicAmenities)&&s.basicAmenities.length>0,p=(s==null?void 0:s.amenities)&&s.amenities.length>0,g=k.useMemo(()=>!u||x===0?[]:((s==null?void 0:s.basicAmenities)||[]).map(E=>{const j=Math.floor(x/E.perSqm)*E.quantity;return{...E,calculatedQuantity:j>0?j:0,key:E._id||E.id}}),[s,u,x]),f=E=>{const j={...d};E.forEach(S=>{o.includes(S)||(j[S]=1)}),Object.keys(j).forEach(S=>{E.includes(S)||delete j[S]}),c(j),l(E)},m=E=>(E._id||E.id||"").toString(),v=(E,j)=>{c(S=>({...S,[E]:j}))};xt.useEffect(()=>{const E=o.map(j=>({id:j,quantity:d[j]||1}));e.setFieldsValue({amenities:E})},[o,d,e]);const w=E=>`₹${E.toLocaleString("en-IN")}`,_=k.useMemo(()=>p?((s==null?void 0:s.amenities)||[]).filter(E=>o.includes(m(E))).map(E=>({...E,key:m(E),quantity:d[m(E)]||1})):[],[s,p,o,d]),y=[{title:"Name",dataIndex:"name",key:"name",render:(E,j)=>n.jsxs(ue,{children:[n.jsx(wn,{strong:!0,children:E}),n.jsx(Se,{color:"blue",children:j.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:E=>n.jsxs(Se,{color:"green",children:[E," ",E===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(E,j)=>n.jsx(ct,{title:j.description,children:n.jsxs(wn,{type:"secondary",children:[n.jsx(Jr,{style:{marginRight:5}}),"1 ",j.quantity>1?`set of ${j.quantity}`:"unit"," per ",E," sqm"]})})}],b=[{title:"Name",dataIndex:"name",key:"name",render:(E,j)=>n.jsxs(ue,{align:"center",children:[n.jsx(wn,{strong:!0,children:E}),n.jsx(Se,{color:"blue",children:j.type}),n.jsx(wn,{type:"secondary",style:{fontSize:"13px"},children:j.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:E=>n.jsx(wn,{strong:!0,style:{color:"#1890ff"},children:w(E)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(E,j)=>n.jsx(yt,{min:1,value:d[j.key]||1,onChange:S=>v(j.key,S||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,render:(E,j)=>{const S=d[j.key]||1,C=j.rate*S;return n.jsx(wn,{strong:!0,style:{color:"#1890ff"},children:w(C)})}}];return n.jsxs(Ei,{children:[n.jsx(tv,{level:4,children:"Stall Amenities"}),n.jsx(ch,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),n.jsx(de,{title:`Selected Stalls: ${a.length}`,style:{marginBottom:24},children:a.length>0?n.jsxs(ch,{children:["You've selected ",a.length," stall(s) with a total area of ",x," sq. meters."]}):n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),n.jsx(de,{title:n.jsxs(ue,{children:[n.jsx(xr,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:a.length===0?n.jsx(_t,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):u?n.jsx(tt,{dataSource:g.filter(E=>E.calculatedQuantity>0),columns:y,pagination:!1,size:"small",locale:{emptyText:n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):n.jsx(mt,{image:n.jsx(fd,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),n.jsx(nt,{}),n.jsx(de,{title:"Additional Amenities (Extra Charges)",children:p?n.jsxs("div",{children:[n.jsx(H.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:n.jsx(Pe,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:o,onChange:f,optionLabelProp:"label",children:((s==null?void 0:s.amenities)||[]).map(E=>n.jsxs(rv,{value:m(E),label:`${E.name} (${w(E.rate)})`,children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(ue,{children:[n.jsx(wn,{strong:!0,children:E.name}),n.jsx(Se,{color:"blue",children:E.type})]}),n.jsx(wn,{style:{color:"#1890ff"},children:w(E.rate)})]}),n.jsx("div",{children:n.jsx(wn,{type:"secondary",children:E.description})})]},m(E)))})}),_.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(nt,{orientation:"left",children:"Selected Amenities"}),n.jsx(tt,{dataSource:_,columns:b,pagination:!1,size:"small"})]})]}):n.jsx(mt,{image:n.jsx(fd,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),n.jsx(H.Item,{name:"amenities",hidden:!0,children:n.jsx("input",{type:"hidden"})}),n.jsx(H.Item,{name:"selectedStalls",hidden:!0,children:n.jsx("input",{type:"hidden"})})]})},{Title:Cl,Paragraph:hh,Text:At}=Le,uh=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:s=[],selectedStalls:i=[],exhibition:a,onPrev:o,onFinish:l,loading:d=!1,formValues:c={}})=>{const[h,x]=k.useState([]),u=k.useMemo(()=>{const b=(e.getFieldValue("selectedStalls")||[]).map(j=>String(j));if(console.log("ReviewStep - Form has selectedStalls:",b),console.log("ReviewStep - Props selectedStallIds:",s),console.log("ReviewStep - Props selectedStalls:",i),b.length>0)return b;const E=[];if(r){const j=String(r);E.push(j)}return s&&s.length&&s.forEach(j=>{const S=String(j);E.includes(S)||E.push(S)}),i&&i.length&&i.forEach(j=>{const S=String(j);E.includes(S)||E.push(S)}),console.log("ReviewStep - Final consolidated stall IDs:",E),E},[e,r,s,i]);k.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",u),console.log("ReviewStep - Available stall details:",t),t&&t.length&&u.length){const y=t.filter(E=>u.includes(String(E.id)));console.log("ReviewStep - Matched stalls:",y.length);const b=y.map(E=>({key:E.id,id:E.id,number:E.number||E.stallNumber||`Stall ${E.id}`,hallName:E.hallName||`Hall ${E.hallId}`,size:`${E.dimensions.width}m × ${E.dimensions.height}m`,area:E.dimensions.width*E.dimensions.height,rate:E.ratePerSqm,price:E.price||E.ratePerSqm*E.dimensions.width*E.dimensions.height,type:E.typeName||E.type||"Standard"}));x(b)}},[t,u]);const p=k.useMemo(()=>{var D,M,J,ne;const y=h.reduce((Z,R)=>Z+R.price,0),b=h.reduce((Z,R)=>Z+(R.area||0),0),E=((D=a==null?void 0:a.basicAmenities)==null?void 0:D.map(Z=>{const R=Math.floor(b/Z.perSqm)*Z.quantity;return{...Z,calculatedQuantity:R>0?R:0}}))||[],j=e.getFieldValue("amenities")||[];console.log("ReviewStep - Selected amenities with quantities:",j);let S=0;const C=j.map(Z=>{var F;const R=Z.id,U=Z.quantity||1,B=(F=a==null?void 0:a.amenities)==null?void 0:F.find(V=>V.id===R||V._id===R);if(B){const V=(B.rate||0)*U;return S+=V,{name:B.name,rate:B.rate,type:B.type,description:B.description,quantity:U,total:V}}return null}).filter(Boolean);console.log("ReviewStep - Processed amenity items:",C);const A=(((M=a==null?void 0:a.publicDiscountConfig)==null?void 0:M.filter(Z=>Z.isActive))||[]).map(Z=>{const R=Z.type==="percentage"?y*(Math.min(Math.max(0,Z.value),100)/100):Math.min(Z.value,y);return{name:Z.name,type:Z.type,value:Z.value,amount:R}}),I=A.reduce((Z,R)=>Z+R.amount,0),P=y-I,N=P,q=((ne=(J=a==null?void 0:a.taxConfig)==null?void 0:J.filter(Z=>Z.isActive))==null?void 0:ne.map(Z=>({name:Z.name,rate:Z.rate,amount:N*(Z.rate/100)})))||[],L=q.reduce((Z,R)=>Z+R.amount,0);return{baseAmount:y,basicAmenities:E,totalStallArea:b,amenities:C,amenitiesTotal:S,discounts:A,totalDiscountAmount:I,amountAfterDiscount:P,subtotal:N,taxes:q,totalTaxAmount:L,total:N+L,stallCount:h.length}},[h,e,a]);k.useEffect(()=>{var b;const y=((b=a==null?void 0:a.publicDiscountConfig)==null?void 0:b.filter(E=>E.isActive))||[];if(y.length>0){const E=y[0];console.log("Setting discountId in form to:",E),e.setFieldsValue({discountId:{name:E.name,type:E.type,value:E.value}})}},[a,e]);const g=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:y=>n.jsx(Se,{color:"purple",children:y})},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:y=>`${y} sqm`},{title:"Rate",dataIndex:"rate",key:"rate",render:y=>`₹${y}/sqm`},{title:"Price",dataIndex:"price",key:"price",render:y=>`₹${y.toLocaleString()}`}],f=y=>`₹${y.toLocaleString("en-IN")}`,m=c.customerName||e.getFieldValue("customerName"),v=c.customerPhone||e.getFieldValue("customerPhone"),w=c.email||e.getFieldValue("email"),_=c.companyName||e.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:m,companyName:_,customerPhone:v,customerEmail:w,formValues:c,formFieldValues:{customerName:e.getFieldValue("customerName"),companyName:e.getFieldValue("companyName"),customerPhone:e.getFieldValue("customerPhone"),email:e.getFieldValue("email")}}),d?n.jsx(Ei,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:n.jsx(Qr,{size:"large",tip:"Processing your booking..."})}):u.length===0?n.jsxs(Ei,{children:[n.jsx(_t,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),n.jsx("div",{style:{marginTop:24,textAlign:"right"},children:n.jsx(te,{onClick:o,children:"Back to Stall Selection"})})]}):n.jsxs(Ei,{children:[n.jsx(H.Item,{name:"discountId",hidden:!0,children:n.jsx(he,{})}),n.jsx(Cl,{level:4,children:"Booking Summary"}),n.jsx(hh,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),n.jsx(de,{title:"Exhibitor Information",style:{marginBottom:24},children:n.jsxs(We,{column:2,children:[n.jsx(We.Item,{label:"Name",children:m||"Not provided"}),n.jsx(We.Item,{label:"Company",children:_||"Not provided"}),n.jsx(We.Item,{label:"Phone",children:v||"Not provided"}),n.jsx(We.Item,{label:"Email",children:w||"Not provided"})]})}),n.jsxs(de,{title:"Selected Stalls",className:"review-card",size:"small",children:[n.jsx(tt,{dataSource:h,columns:g,pagination:!1,size:"small",style:{marginBottom:16}}),n.jsxs(At,{strong:!0,children:["Total Base Amount: ",f(p.baseAmount)]})]}),p.basicAmenities&&p.basicAmenities.length>0&&n.jsxs(de,{title:n.jsxs(ue,{children:[n.jsx(xr,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[n.jsxs(hh,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",p.totalStallArea," sqm."]}),n.jsx(tt,{dataSource:p.basicAmenities.filter(y=>y.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,b)=>n.jsxs(ue,{children:[n.jsx(At,{strong:!0,children:y}),n.jsx(Se,{color:"blue",children:b.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:y=>n.jsxs(Se,{color:"green",children:[y," ",y===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(y,b)=>n.jsxs(At,{type:"secondary",children:[n.jsx(Jr,{style:{marginRight:5}}),"1 ",b.quantity>1?`set of ${b.quantity}`:"unit"," per ",y," sqm"]})},{title:"Status",key:"status",width:100,align:"right",render:()=>n.jsx(At,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:n.jsx(_t,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),p.amenities&&p.amenities.length>0&&n.jsxs(de,{title:"Selected Amenities",style:{marginBottom:24},children:[n.jsx(tt,{dataSource:p.amenities.map((y,b)=>({...y,key:b})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(y,b)=>n.jsxs(ue,{children:[n.jsx(At,{strong:!0,children:y}),n.jsx(Se,{color:"blue",children:b.type})]})},{title:"Description",dataIndex:"description",key:"description",render:y=>n.jsx(At,{type:"secondary",style:{fontSize:"13px"},children:y||"No description provided"})},{title:"Rate",dataIndex:"rate",key:"rate",width:110,align:"right",render:y=>n.jsx(At,{strong:!0,style:{color:"#1890ff"},children:f(y)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:90,align:"center",render:y=>n.jsx(Se,{color:"green",children:y})},{title:"Total",dataIndex:"total",key:"total",width:110,align:"right",render:y=>n.jsx(At,{strong:!0,style:{color:"#1890ff"},children:f(y)})}],pagination:!1,size:"small"}),n.jsx(nt,{}),n.jsx("div",{style:{textAlign:"right"},children:n.jsxs(At,{strong:!0,children:["Amenities Total: ",f(p.amenitiesTotal)]})})]}),n.jsxs(de,{title:"Price Calculation",style:{marginBottom:24},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{children:"Base Amount:"}),n.jsx(At,{children:f(p.baseAmount)})]}),p.discounts.length>0&&n.jsxs(n.Fragment,{children:[p.discounts.map((y,b)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(At,{children:[y.name," (",y.type==="percentage"?`${y.value}%`:f(y.value),"):"]}),n.jsxs(At,{type:"danger",children:["- ",f(y.amount)]})]},b)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{children:"Amount after Discount:"}),n.jsx(At,{children:f(p.amountAfterDiscount)})]})]}),p.amenitiesTotal>0&&n.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[n.jsx(At,{type:"secondary",children:"Selected Amenities (for information only):"}),n.jsx(At,{type:"secondary",children:f(p.amenitiesTotal)})]}),n.jsx(At,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{strong:!0,children:"Subtotal:"}),n.jsx(At,{strong:!0,children:f(p.subtotal)})]}),p.taxes.length>0&&n.jsx(n.Fragment,{children:p.taxes.map((y,b)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(At,{children:[y.name," (",y.rate,"%):"]}),n.jsx(At,{children:f(y.amount)})]},b))}),n.jsx(nt,{}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Cl,{level:5,children:"Total:"}),n.jsx(Cl,{level:5,children:f(p.total)})]})]})]})},{confirm:nv}=Ve,sv=({visible:e,stallDetails:t,selectedStallId:r,selectedStallIds:s,loading:i,exhibition:a,onCancel:o,onSubmit:l})=>{const[d]=H.useForm(),[c,h]=k.useState(0),[x]=k.useState(3),[u,p]=k.useState({}),[g,f]=k.useState(!1),[m,v]=k.useState(!1),w=Me(A=>A.exhibitorAuth.exhibitor);k.useEffect(()=>{if(e){h(0),f(!1),p({}),d.resetFields();const A=s.map(N=>String(N));r&&A.push(String(r));const I=[...new Set(A)],P={selectedStalls:I,exhibitionId:a==null?void 0:a._id};w&&(P.customerName=w.contactPerson||"",P.companyName=w.companyName||"",P.email=w.email||"",P.customerPhone=w.phone||""),d.setFieldsValue(P),p(P),console.log("Booking form initialized with stalls:",I),console.log("Exhibitor profile data:",w)}},[e,d,r,s,a,w]);const _=()=>{f(!0)},y=()=>{g?nv({title:"Discard changes?",icon:n.jsx(Qs,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){o()}}):o()},b=()=>{v(!0),d.validateFields().then(A=>{const I={...u,...A},P={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...I,...P};p(N),console.log("Step completed, saving form values:",N),console.log("Selected stalls are:",N.selectedStalls||[]),console.log("Exhibitor info:",P),h(c+1),v(!1)}).catch(A=>{v(!1),console.error("Form validation failed:",A),be.error("Please complete all required fields")})},E=()=>{h(c-1)},j=()=>{d.validateFields().then(A=>{const I={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},P={...u,...A,...I};console.log("Submitting booking with values:",P),l(P)}).catch(A=>{console.error("Form validation failed:",A),be.error("Please complete all required fields")})},S=["Stall Details","Amenities","Review"],C=[{title:"Stall Details",icon:n.jsx(Dx,{}),content:n.jsx(lh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a})},{title:"Amenities",icon:n.jsx(ms,{}),content:n.jsx(dh,{form:d,stallDetails:t,selectedStallIds:d.getFieldValue("selectedStalls")||[],exhibition:a,formValues:u})},{title:"Review",icon:n.jsx(vt,{}),content:n.jsx(uh,{form:d,formValues:u,loading:i,exhibition:a,selectedStalls:d.getFieldValue("selectedStalls")||[],selectedStallIds:d.getFieldValue("selectedStalls")||[],stallDetails:t})}];k.useEffect(()=>{const A=d.getFieldValue("selectedStalls");console.log(`Step ${c} - Form has selectedStalls:`,A)},[c,d]);const T=A=>{const I=d.getFieldValue("selectedStalls")||[],P={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},N={...u,...P};switch(console.log(`Rendering step ${A} with:`,{selectedStalls:I,exhibitorInfo:P}),A){case 0:return n.jsx(lh,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:s,exhibition:a});case 1:return n.jsx(dh,{form:d,stallDetails:t,selectedStallIds:I,exhibition:a,formValues:N});case 2:return n.jsx(uh,{form:d,formValues:N,loading:i,exhibition:a,selectedStalls:I,selectedStallIds:I,stallDetails:t,onPrev:E,onFinish:j});default:return null}};return n.jsx(Xy,{title:`Book Exhibition Stall - ${S[c]}`,open:e,onCancel:y,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[c>0&&n.jsx(kl,{onClick:E,disabled:m||i,size:"large",children:"Back"}),n.jsx("div",{children:c<x-1?n.jsx(kl,{type:"primary",onClick:b,loading:m,disabled:i,size:"large",children:"Next"}):n.jsx(kl,{type:"primary",onClick:j,loading:i,disabled:m,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:n.jsxs(Qr,{spinning:i||m,tip:i?"Processing your booking...":"Validating...",children:[n.jsx(Qy,{children:C.map((A,I)=>n.jsxs("div",{className:`step-item ${c===I?"active":""} ${c>I?"completed":""}`,onClick:()=>c>I?h(I):null,style:{cursor:c>I?"pointer":"default"},children:[n.jsx("span",{className:"step-icon",children:c>I?n.jsx(yc,{}):I+1}),A.title]},I))}),n.jsx(H,{form:d,layout:"vertical",preserve:!0,onFieldsChange:_,children:T(c)},`form-step-${c}`)]})})},{Step:Al}=Yi,{Text:iv}=Le,av=({loginModalVisible:e,registerModalVisible:t,setRegisterModalVisible:r,setExhibitorCredentials:s,onForgotPassword:i})=>{const a=it(),o=Me(Z=>Z.exhibitorAuth),[l,d]=k.useState(!1),[c,h]=k.useState(null),[x]=H.useForm(),[u]=H.useForm(),[p]=H.useForm(),[g,f]=k.useState(0),[m,v]=k.useState(""),[w,_]=k.useState(!1),[y,b]=k.useState(!1),[E,j]=k.useState(0),[S,C]=k.useState({companyName:"",contactPerson:""}),T=k.useRef(null),A=async Z=>{var R,U,B,F,V,se,xe,me,Q;try{h(null),d(!0);const ee=await ir.login(Z),{exhibitor:ce,token:Ie}=ee.data;if(!ce||!Ie)throw new Error("Invalid response from server");s({exhibitor:ce,token:Ie}),a(da()),x.resetFields(),be.success("Login successful!")}catch(ee){if(((R=ee.response)==null?void 0:R.status)===403){const ce=(B=(U=ee.response)==null?void 0:U.data)==null?void 0:B.status;if(ce==="pending")h("Your account is pending approval. You will be able to log in after admin approval.");else if(ce==="rejected"){const Ie=(V=(F=ee.response)==null?void 0:F.data)==null?void 0:V.rejectionReason;h(Ie?`Your registration has been rejected. Reason: ${Ie}`:"Your registration has been rejected. Please contact the administrator for more details.")}else h(((xe=(se=ee.response)==null?void 0:se.data)==null?void 0:xe.message)||"Access denied. Please contact administrator.")}else h(((Q=(me=ee.response)==null?void 0:me.data)==null?void 0:Q.message)||"Login failed. Please try again.")}finally{d(!1)}},I=async()=>{var Z,R;try{const U=await u.validateFields(["email","companyName","contactPerson"]);d(!0),h(null),v(U.email),C({companyName:U.companyName,contactPerson:U.contactPerson}),await ir.sendRegistrationOTP(U.email),_(!0),be.success("OTP sent to your email address"),j(60),P(),f(1)}catch(U){if(U.name==="ValidationError")return;const B=((R=(Z=U.response)==null?void 0:Z.data)==null?void 0:R.message)||"Failed to send OTP. Please try again.";h(B),be.error(B)}finally{d(!1)}},P=()=>{T.current&&clearInterval(T.current),T.current=setInterval(()=>{j(Z=>Z<=1?(T.current&&clearInterval(T.current),0):Z-1)},1e3)},N=async()=>{var Z,R;try{d(!0),h(null),await ir.sendRegistrationOTP(m),be.success("New OTP sent to your email address"),j(60),P()}catch(U){const B=((R=(Z=U.response)==null?void 0:Z.data)==null?void 0:R.message)||"Failed to resend OTP. Please try again.";h(B),be.error(B)}finally{d(!1)}},q=async Z=>{var R,U;try{d(!0),h(null);const B={email:m,otp:Z.otp};await ir.verifyOTP(B),b(!0),be.success("Email verified successfully"),T.current&&clearInterval(T.current),f(2)}catch(B){const F=((U=(R=B.response)==null?void 0:R.data)==null?void 0:U.message)||"Invalid OTP. Please try again.";h(F),be.error(F)}finally{d(!1)}},L=()=>{_(!1),b(!1),v(""),j(0),f(0),C({companyName:"",contactPerson:""}),T.current&&clearInterval(T.current),p.resetFields()},D=async Z=>{var R,U,B;try{if(h(null),d(!0),!y){h("Email verification required");return}const{confirmPassword:F,...V}=Z,se={...V,email:m,companyName:S.companyName,contactPerson:S.contactPerson};console.log("Sending registration data:",se);const xe=await ir.register(se);be.success("Registration successful! You can log in and book a stall only after admin approval."),r(!1),u.resetFields(),L(),setTimeout(()=>{a(cs(void 0))},500)}catch(F){console.error("Registration error:",F),console.error("Response data:",(R=F.response)==null?void 0:R.data);const V=((B=(U=F.response)==null?void 0:U.data)==null?void 0:B.message)||"Registration failed. Please try again.";h(V),be.error(V)}finally{d(!1)}};xt.useEffect(()=>()=>{T.current&&clearInterval(T.current)},[]);const M=()=>{r(!1),h(null),u.resetFields(),L()},J=()=>{a(da()),r(!0),x.resetFields()},ne=()=>{r(!1),a(cs(void 0)),u.resetFields()};return n.jsxs(n.Fragment,{children:[n.jsxs(Ve,{title:"Exhibitor Login",open:e,onCancel:()=>{a(da()),h(null),x.resetFields()},footer:null,width:400,children:[o.loginContext==="stall-booking"&&n.jsx(_t,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),c&&n.jsx(_t,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:x,name:"exhibitor_login_modal",onFinish:A,layout:"vertical",children:[n.jsx(H.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(he,{prefix:n.jsx(un,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(H.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsxs(H.Item,{children:[n.jsx("div",{style:{textAlign:"right",marginBottom:10},children:n.jsx(te,{type:"link",onClick:()=>{a(da()),i()},style:{padding:0},children:"Forgot password?"})}),n.jsx(te,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Login"})]})]}),n.jsx(nt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),n.jsx(te,{type:"default",block:!0,onClick:J,children:"Register as Exhibitor"})]}),n.jsxs(Ve,{title:"Exhibitor Registration",open:t,onCancel:M,footer:null,width:500,children:[n.jsxs(Yi,{current:g,style:{marginBottom:24},children:[n.jsx(Al,{title:"Basic Info"}),n.jsx(Al,{title:"Verify Email"}),n.jsx(Al,{title:"Complete"})]}),c&&n.jsx(_t,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),g===0&&n.jsxs(n.Fragment,{children:[n.jsx(_t,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:u,name:"exhibitor_register_step1",layout:"vertical",children:[n.jsx(H.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:n.jsx(he,{prefix:n.jsx(wc,{}),placeholder:"Company Name",size:"large",disabled:l})}),n.jsx(H.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:n.jsx(he,{prefix:n.jsx(at,{}),placeholder:"Contact Person",size:"large",disabled:l})}),n.jsx(H.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(he,{prefix:n.jsx(un,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",onClick:I,block:!0,size:"large",loading:l,children:"Continue & Verify Email"})})]}),n.jsx(nt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),n.jsx(te,{type:"default",block:!0,onClick:ne,children:"Login"})]}),g===1&&n.jsxs(n.Fragment,{children:[n.jsx(_t,{message:"Email Verification",description:`We've sent a verification code to ${m}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:p,name:"verify_otp",onFinish:q,layout:"vertical",children:[n.jsx(H.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:n.jsx(he,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:l})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Verify & Continue"})})]}),n.jsxs(Ce,{justify:"space-between",align:"middle",style:{marginTop:16},children:[n.jsx(K,{children:n.jsx(te,{type:"link",disabled:E>0||l,onClick:N,children:"Resend Code"})}),n.jsx(K,{children:E>0&&n.jsxs(iv,{type:"secondary",children:["Resend in ",E,"s"]})})]}),n.jsx(nt,{}),n.jsx(te,{type:"default",block:!0,onClick:()=>f(0),children:"Back"})]}),g===2&&n.jsxs(n.Fragment,{children:[n.jsx(_t,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),n.jsxs(H,{form:u,name:"exhibitor_register_step2",onFinish:D,layout:"vertical",children:[n.jsx(H.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:n.jsx(he,{prefix:n.jsx(jc,{}),placeholder:"Phone Number",size:"large",disabled:l})}),n.jsx(H.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:n.jsx(he.TextArea,{placeholder:"Address",rows:3,disabled:l})}),n.jsx(H.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsx(H.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:Z})=>({validator(R,U){return!U||Z("password")===U?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Confirm Password",size:"large",disabled:l})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Complete Registration"})})]})]})]})]})},{Step:r4}=Yi,{Text:n4}=Le,ov=({visible:e})=>{const t=it(),[r,s]=k.useState(!1),[i,a]=k.useState(null),[o,l]=k.useState(0),[d,c]=k.useState(""),[h,x]=k.useState(!1),[u,p]=k.useState(0),g=H.useForm()[0],f=H.useForm()[0],m=H.useForm()[0],v=k.useRef(null),w=async T=>{var A,I;try{s(!0),a(null);const P=await ir.requestPasswordReset(T);c(T.email),x(!0),l(1),be.success("Password reset code sent to your email"),p(60),_()}catch(P){const N=((I=(A=P.response)==null?void 0:A.data)==null?void 0:I.message)||"Failed to send password reset code. Please try again.";a(N)}finally{s(!1)}},_=()=>{v.current&&clearInterval(v.current),v.current=setInterval(()=>{p(T=>T<=1?(v.current&&clearInterval(v.current),0):T-1)},1e3)},y=async()=>{var T,A;try{s(!0),a(null),await ir.requestPasswordReset({email:d}),be.success("New password reset code sent to your email"),p(60),_()}catch(I){const P=((A=(T=I.response)==null?void 0:T.data)==null?void 0:A.message)||"Failed to resend password reset code. Please try again.";a(P)}finally{s(!1)}},b=async T=>{var A,I;try{s(!0),a(null),l(2),v.current&&clearInterval(v.current)}catch(P){const N=((I=(A=P.response)==null?void 0:A.data)==null?void 0:I.message)||"Invalid code. Please try again.";a(N)}finally{s(!1)}},E=async T=>{var A,I;try{s(!0),a(null);const P=f.getFieldValue("otp"),N={email:d,otp:P,newPassword:T.newPassword};await ir.resetPassword(N),be.success("Password reset successful. You can now log in with your new password."),j(),t(ll()),t(cs())}catch(P){const N=((I=(A=P.response)==null?void 0:A.data)==null?void 0:I.message)||"Failed to reset password. Please try again.";a(N)}finally{s(!1)}},j=()=>{l(0),c(""),x(!1),p(0),v.current&&clearInterval(v.current),g.resetFields(),f.resetFields(),m.resetFields()},S=()=>{j(),t(ll())},C=()=>{j(),t(ll()),t(cs())};return xt.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),n.jsxs(Ve,{title:"Forgot Password",open:e,onCancel:S,footer:null,width:400,children:[i&&n.jsx(_t,{message:i,type:"error",style:{marginBottom:16}}),n.jsx(Yi,{current:o,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),o===0&&n.jsxs(H,{form:g,onFinish:w,layout:"vertical",children:[n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{prefix:n.jsx(un,{}),placeholder:"Email"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Send Reset Code"})}),n.jsx(nt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),n.jsx(te,{type:"link",onClick:C,block:!0,children:"Back to Login"})]}),o===1&&n.jsxs(H,{form:f,onFinish:b,layout:"vertical",children:[n.jsxs("p",{children:["We've sent a verification code to ",n.jsx("strong",{children:d}),". Please check your email and enter the code below."]}),n.jsx(H.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:n.jsx(he,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Verify Code"})}),n.jsx("div",{style:{textAlign:"center",marginTop:8},children:u>0?n.jsxs(Le.Text,{type:"secondary",children:["Resend code in ",u,"s"]}):n.jsx(te,{type:"link",onClick:y,disabled:r,children:"Resend Code"})}),n.jsx(nt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),n.jsx(te,{type:"link",onClick:()=>{l(0),v.current&&(clearInterval(v.current),p(0))},block:!0,children:"Change Email"})]}),o===2&&n.jsxs(H,{form:m,onFinish:E,layout:"vertical",children:[n.jsx(H.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"New Password"})}),n.jsx(H.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:T})=>({validator(A,I){return!I||T("newPassword")===I?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(he.Password,{prefix:n.jsx(jn,{}),placeholder:"Confirm Password"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Reset Password"})})]})]})},{Header:lv}=kt,cv=ve(lv)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,dv=ve.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,hv=ve.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,uv=ve.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,fv=ve.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,fh=ve(Br)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,xh=ve(or)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,xv=ve(or)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,pv=ve(te)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,mv=ve.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,gv=ve(Cr)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,ja=ve(te)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,yv=ve.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,vv=ve.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,Vr=()=>{var S;const e=Je(),t=it(),[r,s]=k.useState(!1),[i,a]=k.useState(!1),[o,l]=k.useState(!1),[d,c]=k.useState("/logo.png"),[h,x]=k.useState("Exhibition Manager"),u=Me(C=>C.exhibitorAuth),{exhibitor:p,isAuthenticated:g,showLoginModal:f,showForgotPasswordModal:m}=u;k.useEffect(()=>{const C=localStorage.getItem("cachedLogoUrl"),T=localStorage.getItem("logoTimestamp"),A=new Date().getTime();if(C&&T&&A-parseInt(T)<36e5)c(C);else{const I=`${Ee.defaults.baseURL}/public/logo`;c(I),localStorage.setItem("cachedLogoUrl",I),localStorage.setItem("logoTimestamp",A.toString());const P=new Image;P.src=I}fetch(`${Ee.defaults.baseURL}/public/site-info`).then(I=>I.json()).then(I=>{I.siteName&&x(I.siteName)}).catch(I=>{console.error("Error fetching site info:",I)})},[]),k.useEffect(()=>(be.config({top:84,duration:3,maxCount:1}),()=>{be.destroy()}),[]);const v=()=>{t(Yu()),be.success("Successfully logged out"),e("/"),s(!1),a(!1)},w=()=>{t(cs(void 0)),s(!1),a(!1)},_=()=>{l(!0),s(!1),a(!1)},y=()=>{t(Hm())},b=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],E=n.jsx(xh,{items:[{key:"exhibitor-login",icon:n.jsx(xd,{}),label:n.jsx("a",{onClick:w,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:n.jsx(Ni,{}),label:n.jsx("a",{onClick:_,children:"Register as Exhibitor"})}]}),j=n.jsx(xh,{items:[{key:"exhibitor-dashboard",icon:n.jsx(co,{}),label:n.jsx(Cr,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:n.jsx(at,{}),label:n.jsx(Cr,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:n.jsx(yr,{}),label:n.jsx(Cr,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:n.jsx(lo,{}),label:n.jsx("a",{onClick:v,children:"Logout"})}]});return n.jsxs(n.Fragment,{children:[n.jsx(cv,{children:n.jsxs(dv,{children:[n.jsx(hv,{children:n.jsx(Cr,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:n.jsx(uv,{children:n.jsx(fv,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})})}),n.jsx(xv,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:b.map(C=>({key:C.key,label:n.jsx(Cr,{to:C.path,children:C.label})}))}),n.jsx(yv,{children:n.jsx(Vn,{overlay:u.isAuthenticated?j:E,trigger:["click"],placement:"bottomRight",open:r,onOpenChange:s,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:u.isAuthenticated?n.jsxs(ue,{style:{cursor:"pointer"},children:[n.jsx(vv,{children:((S=u.exhibitor)==null?void 0:S.companyName)||"Exhibitor"}),n.jsx(fh,{icon:n.jsx(at,{}),size:"large"})]}):n.jsx(fh,{icon:n.jsx(at,{}),size:"large"})})}),n.jsx(pv,{icon:n.jsx(Lx,{}),onClick:()=>a(!0)})]})}),n.jsx(mv,{children:n.jsxs(Ox,{title:"Exhibition Management System",placement:"right",onClose:()=>a(!1),open:i,width:280,closeIcon:n.jsx("span",{style:{fontSize:"16px"},children:"×"}),children:[n.jsx("div",{style:{marginBottom:24},children:b.map(C=>n.jsx(gv,{to:C.path,onClick:()=>a(!1),children:C.label},C.key))}),n.jsx("div",{style:{marginTop:40},children:u.isAuthenticated?n.jsxs(n.Fragment,{children:[n.jsx(ja,{type:"primary",icon:n.jsx(co,{}),onClick:()=>{e("/exhibitor/dashboard"),a(!1)},children:"Dashboard"}),n.jsx(ja,{type:"default",icon:n.jsx(lo,{}),onClick:v,children:"Logout"})]}):n.jsxs(n.Fragment,{children:[n.jsx(ja,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:n.jsx(xd,{}),onClick:()=>{w(),a(!1)},children:"Exhibitor Login"}),n.jsx(ja,{type:"default",icon:n.jsx(Ni,{}),onClick:()=>{_(),a(!1)},children:"Register as Exhibitor"})]})})]})}),n.jsx(av,{loginModalVisible:f,registerModalVisible:o,setRegisterModalVisible:l,setExhibitorCredentials:C=>t(lc(C)),onForgotPassword:y}),n.jsx(ov,{visible:m})]})},{Content:Sa}=kt,{Title:s4}=Le,bv=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/"))return`${Ee.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${Ee.defaults.baseURL}/${s}?token=${r}`:`${Ee.defaults.baseURL}/${s}`},wv=()=>{var M,J,ne,Z;const{id:e}=Fr(),t=Je(),r=it(),[s,i]=k.useState(null),[a,o]=k.useState(null),[l,d]=k.useState(null),[c,h]=k.useState([]),[x,u]=k.useState(!1),[p,g]=k.useState(!0),[f,m]=k.useState(null),[v,w]=k.useState(!1),[_,y]=k.useState(null),b=k.useRef(null),[E,j]=k.useState({width:800,height:600}),[S,C]=k.useState(!1),[T]=H.useForm(),{isAuthenticated:A}=Me(R=>R.exhibitorAuth);k.useEffect(()=>{const R=()=>{C(window.innerWidth<768)};return R(),window.addEventListener("resize",R),()=>{window.removeEventListener("resize",R)}},[]);const I=k.useCallback(R=>R.status==="booked"||R.status==="reserved",[]),P=k.useCallback(()=>{if(b.current){const{clientWidth:R,clientHeight:U}=b.current,B=S?320:800,F=S?480:600,V=Math.max(R||B,B),se=Math.max(U||F,F);(Math.abs(V-E.width)>5||Math.abs(se-E.height)>5)&&j({width:V,height:se})}},[E.width,E.height,S]);k.useEffect(()=>{let R=null;const U=()=>{R===null&&(R=window.setTimeout(()=>{R=null,P()},S?100:50))};P();const B=new ResizeObserver(U);return b.current&&B.observe(b.current),window.addEventListener("resize",U),()=>{R!==null&&window.clearTimeout(R),B.disconnect(),window.removeEventListener("resize",U)}},[P,S]),k.useEffect(()=>{(async()=>{try{if(!e){m("Exhibition ID is missing"),g(!1);return}g(!0),m(null);const U=await Ar.getLayout(e);i(U.data)}catch(U){m(U.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",U)}finally{g(!1)}})()},[e]),k.useEffect(()=>{s&&P()},[s]),k.useEffect(()=>{A&&s&&(d(null),h([]),P(),be.info("You can now select stalls to book.",3))},[A]);const N=k.useCallback(async R=>{if(I(R)){be.info(`This stall (${R.stallNumber}) is already booked.`);return}if(!A){r(cs("stall-booking"));return}const B=R._id||R.id;h(F=>F.includes(B)?(be.info(`Stall ${R.stallNumber} removed from selection`),F.filter(V=>V!==B)):(be.success(`Stall ${R.stallNumber} added to selection`),[...F,B]))},[I,A,r]),q=async R=>{try{w(!0),console.log("Booking data before submission:",R),console.log("Amenities data:",{basicAmenities:R.basicAmenities,extraAmenities:R.amenities});const U=T.getFieldValue("amenities");console.log("Form amenities field value:",U);const B={...R,exhibitionId:s==null?void 0:s.exhibition._id,stallIds:R.selectedStalls,basicAmenities:R.basicAmenities||[],extraAmenities:R.amenities||[]};if(console.log("Final booking data being sent:",B),console.log("Final amenities data being sent:",{basicAmenities:B.basicAmenities,extraAmenities:B.extraAmenities}),A){const F=await Ar.exhibitorBookStalls(B);console.log("Booking response:",F.data),be.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const F=await Ar.bookMultipleStalls(e,B);console.log("Booking response:",F.data),be.success("Your booking request has been submitted successfully!")}if(u(!1),h([]),e)try{const F=await Ar.getLayout(e);i(F.data)}catch(F){console.error("Error refreshing layout data:",F)}}catch(U){console.error("Error booking stall",U),be.error("Failed to book stall. Please try again.")}finally{w(!1)}},L=async()=>{var R;try{if(!s)return;w(!0);let U=null;if(l){const F=s.layout.find(V=>V.stalls.some(se=>se.id===l));F?U=F.stalls.find(V=>V.id===l)||null:console.error("Selected stall not found in any hall")}const B=s.layout.flatMap(F=>F.stalls.map(V=>({...V,hallId:F.id,hallName:F.name}))).filter(F=>F.status==="available");if(c.length===0&&l===null&&B.length===0){be.error("No stalls are available for booking");return}if(!s.exhibition.basicAmenities)try{const F=await Ar.getExhibition(e||"");(R=F==null?void 0:F.data)!=null&&R.basicAmenities&&i({...s,exhibition:{...s.exhibition,basicAmenities:F.data.basicAmenities}})}catch(F){console.error("Error fetching exhibition details with amenities:",F)}y(B),u(!0)}catch(U){console.error("Error opening booking modal:",U),be.error("Failed to open booking form")}finally{w(!1)}};k.useCallback(R=>{R.cancelBubble=!0},[]);const D=k.useMemo(()=>{var R;return s?{halls:s.layout.map(U=>n.jsx(pf,{hall:{...U,exhibitionId:e||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},U.id)),stalls:s.layout.flatMap(U=>U.stalls.map(B=>{var F,V,se,xe,me,Q,ee,ce;return n.jsx(Mc,{stall:{...B,hallId:U.id,hallName:U.name,isSelected:c.includes(B.id),stallTypeId:"default",number:B.stallNumber,typeName:B.type||"Standard",ratePerSqm:B.price||0,rotation:0,dimensions:{x:((F=B.position)==null?void 0:F.x)||0,y:((V=B.position)==null?void 0:V.y)||0,width:((se=B.dimensions)==null?void 0:se.width)||0,height:((xe=B.dimensions)==null?void 0:xe.height)||0},status:B.status==="maintenance"?"booked":B.status},isSelected:l===B.id||c.includes(B.id),onSelect:B.status==="available"?()=>N(B):void 0,hallWidth:((me=U.dimensions)==null?void 0:me.width)||0,hallHeight:((Q=U.dimensions)==null?void 0:Q.height)||0,hallX:((ee=U.dimensions)==null?void 0:ee.x)||0,hallY:((ce=U.dimensions)==null?void 0:ce.y)||0},B.id)})),fixtures:(R=s.fixtures)==null?void 0:R.map(U=>{var B,F;return n.jsx(mf,{fixture:{...U,id:U.id||U._id,_id:U._id||U.id,exhibitionId:e||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((B=s.exhibition.dimensions)==null?void 0:B.width)||0,exhibitionHeight:((F=s.exhibition.dimensions)==null?void 0:F.height)||0},U.id||U._id)})}:null},[s,e,l,c,N]);return p?n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Qr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):f||!s?n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"error",title:"Failed to load exhibition layout",subTitle:f||"The exhibition layout couldn't be loaded.",extra:[n.jsx(te,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((M=s.exhibition.dimensions)!=null&&M.width)||!((J=s.exhibition.dimensions)!=null&&J.height)?n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Sa,{style:{paddingTop:"64px"},children:n.jsx(de,{children:n.jsx(Di,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsxs(Sa,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[S&&n.jsx("div",{style:{height:"16px",width:"100%"}}),n.jsxs(de,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:S?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:S?"5px":"24px"},children:[n.jsxs(Ce,{gutter:[24,24],style:{marginBottom:S?16:32},children:[n.jsx(K,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:S?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:S?"column":"row",alignItems:S?"flex-start":"center",gap:S?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:S?"center":"flex-start",width:S?"100%":"auto"},children:s.exhibition.headerLogo?n.jsx(bu,{src:bv(s.exhibition.headerLogo),alt:`${s.exhibition.name} logo`,style:{maxHeight:S?70:90,maxWidth:S?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:S?200:250,height:S?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:n.jsx(Qr,{size:"small"})})}):n.jsx("div",{style:{width:S?70:90,height:S?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:n.jsx(Hr,{style:{fontSize:S?24:32,color:"#aaa"}})})}),!S&&n.jsx(nt,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),n.jsxs("div",{style:{flex:1,width:S?"100%":"auto"},children:[n.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:S?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.exhibition.name}),n.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:S?"13px":"14px"},children:[n.jsx(Hr,{style:{fontSize:S?"14px":"16px",color:"#1890ff"}}),n.jsxs("span",{children:[new Date(s.exhibition.startDate).toLocaleDateString()," -",new Date(s.exhibition.endDate).toLocaleDateString()]})]}),n.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:S?"13px":"14px"},children:[n.jsx(Jr,{style:{fontSize:S?"14px":"16px",color:"#1890ff"}}),n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:S?"nowrap":"normal",maxWidth:S?"260px":"none"},children:s.exhibition.venue})]})]})]})}),n.jsx(K,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:S?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{marginBottom:"16px",fontSize:S?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),n.jsxs("div",{style:{display:"flex",flexDirection:S?"column":"row",justifyContent:"center",alignItems:"center",gap:S?"10px":"16px",width:"100%"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:S?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"success"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:S?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"processing",color:"#1890ff"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:S?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(xr,{status:"warning"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),n.jsxs("div",{ref:b,style:{width:"100%",height:S?"70vh":"80vh",minHeight:S?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[n.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Base canvas optimization */
                .konvajs-content {
                  will-change: transform;
                  transform: translateZ(0);
                  backface-visibility: hidden;
                  transition: filter 0.2s ease-out;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Canvas optimization for all canvases */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                  transition: filter 0.15s linear;
                }
                
                /* Dragging state - apply blur effect with better control */
                .public-canvas-container .konvajs-content.dragging {
                  filter: blur(1px);
                }
                
                /* Mobile-specific blur - slightly stronger */
                @media (max-width: 768px) {
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(1.5px);
                  }
                }
                
                /* Performance optimizations for dragging */
                .public-canvas-container .konvajs-content:active canvas {
                  image-rendering: optimizeSpeed;
                }
                
                /* Touch device optimizations */
                @media (pointer: coarse) {
                  .public-canvas-container .konvajs-content:active {
                    touch-action: none;
                  }
                  
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(2px); /* Stronger blur for touch devices */
                  }
                }
                
                /* Animation smoothing to reduce flickering */
                .public-canvas-container .konvajs-content canvas {
                  will-change: filter;
                  transform: translateZ(0);
                }
                
                /* Low-end device optimizations */
                @media (max-width: 480px), 
                       (resolution: 150dpi),
                       (any-pointer: coarse) {
                  .public-canvas-container .konvajs-content:active canvas {
                    image-rendering: optimizeSpeed;
                  }
                }
              `}),n.jsxs(Qi,{width:E.width,height:E.height,exhibitionWidth:((ne=s==null?void 0:s.exhibition.dimensions)==null?void 0:ne.width)||0,exhibitionHeight:((Z=s==null?void 0:s.exhibition.dimensions)==null?void 0:Z.height)||0,halls:(s==null?void 0:s.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[D==null?void 0:D.halls,D==null?void 0:D.stalls,D==null?void 0:D.fixtures]})]})]})]}),c.length>0&&n.jsx(Bx,{offsetBottom:20,children:n.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:n.jsxs(te,{type:"primary",size:"large",icon:n.jsx(ho,{}),onClick:L,loading:v,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",c.length,")"]})})}),n.jsx(sv,{visible:x,stallDetails:_,selectedStallId:l,selectedStallIds:c,loading:v,exhibition:s==null?void 0:s.exhibition,onCancel:()=>{u(!1)},onSubmit:q})]})},jv=xt.memo(wv),{Content:Il}=kt,{Title:Nl,Text:es,Paragraph:ph}=Le,Fl=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/")||t.includes("sponsors/"))return`${Ee.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),s=`uploads/${t}`;return r?`${Ee.defaults.baseURL}/${s}?token=${r}`:`${Ee.defaults.baseURL}/${s}`},Sv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},Ea=e=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Ev=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);if(r<s){const a=s.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} until start`,count:o,isPast:!1}}else if(r>i){const a=r.getTime()-i.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} since end`,count:o,isPast:!0}}else{const a=i.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} remaining`,count:o,isPast:!1}}},Tv=()=>{const{id:e}=Fr(),t=Je(),[r,s]=k.useState(null),[i,a]=k.useState(!0),[o,l]=k.useState(null),[d,c]=k.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(k.useEffect(()=>{(async()=>{try{if(!e){l("Exhibition ID is missing");return}a(!0),l(null);const g=await Ar.getExhibition(e);if(s(g.data),g.data.headerBackground){const f=Fl(g.data.headerBackground);c(f);const m=new window.Image;m.src=f}else if(g.data.headerLogo){const f=Fl(g.data.headerLogo),m=new window.Image;m.src=f}}catch(g){console.error("Error fetching exhibition:",g),l(g.message||"Error fetching exhibition")}finally{a(!1)}})()},[e]),i)return n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Il,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Qr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(o||!r)return n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Il,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"404",title:"Exhibition not found",subTitle:o||"The exhibition you're looking for doesn't exist or has been removed.",extra:n.jsx(te,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:h,color:x}=Sv(r.startDate,r.endDate),u=Ev(r.startDate,r.endDate);return n.jsxs(kt,{className:"exhibition-details-layout",children:[n.jsx(Vr,{}),n.jsxs(Il,{className:"exhibition-content",children:[n.jsx("div",{className:"breadcrumb-container",children:n.jsx(Mx,{items:[{title:n.jsx(Cr,{to:"/",children:n.jsx(wc,{})})},{title:n.jsx(Cr,{to:"/exhibitions",children:"Exhibitions"})},{title:r.name}]})}),n.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${d}')`},children:n.jsx("div",{className:"hero-overlay",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("div",{className:"hero-main",children:[n.jsx(Nl,{level:1,className:"exhibition-title",children:r.name}),n.jsxs(ue,{size:24,className:"exhibition-meta",children:[n.jsxs("div",{className:"meta-item",children:[n.jsx(Hr,{}),n.jsxs(es,{children:[Ea(r.startDate)," - ",Ea(r.endDate)]})]}),r.venue&&n.jsxs("div",{className:"meta-item",children:[n.jsx(os,{}),n.jsx(es,{children:r.venue})]}),n.jsxs("div",{className:"meta-item",children:[n.jsx(Vt,{}),n.jsxs(es,{children:[u.text,": ",n.jsx("strong",{children:u.count})]})]})]})]}),n.jsxs("div",{className:"hero-actions",children:[n.jsx(te,{type:"primary",size:"large",icon:n.jsx(ps,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),n.jsx(te,{size:"large",icon:n.jsx(yr,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button book-button",children:"Book a Stall"}),u.isPast?null:n.jsx(te,{size:"large",icon:n.jsx(vc,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),n.jsx("div",{className:"stats-container",children:n.jsxs(Ce,{gutter:[16,16],className:"stats-row",children:[n.jsx(K,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon duration-icon",children:n.jsx(Hr,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:Math.ceil((new Date(r.endDate).getTime()-new Date(r.startDate).getTime())/(1e3*60*60*24))}),n.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),n.jsx(K,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon countdown-icon",children:n.jsx(Vt,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:u.count}),n.jsx("div",{className:"stat-label",children:u.text})]})]})}),n.jsx(K,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:x+"20",color:x},children:n.jsx(Jr,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value status-value",style:{color:x},children:h}),n.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),r.sponsorLogos&&r.sponsorLogos.length>0&&n.jsxs("div",{className:"sponsors-section",children:[n.jsx("div",{className:"sponsors-header",children:n.jsx(es,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),n.jsx("div",{className:"sponsors-container",children:r.sponsorLogos.map((p,g)=>n.jsx("div",{className:"sponsor-logo-wrapper",children:n.jsx("div",{className:"sponsor-logo",children:n.jsx("img",{src:Fl(p),alt:`Sponsor ${g+1}`,className:"sponsor-logo-img",onError:f=>{f.target.src="/placeholder-logo.png"}})})},g))})]}),n.jsx("div",{className:"exhibition-details-container",children:n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,lg:16,children:n.jsxs(de,{className:"details-card about-card",bordered:!1,children:[n.jsx(Nl,{level:3,className:"section-title",children:"About This Exhibition"}),n.jsx(ph,{className:"main-description",children:r.description}),r.headerDescription&&n.jsx(ph,{className:"extended-description",children:r.headerDescription}),r.headerSubtitle&&n.jsxs("div",{className:"subtitle-section",children:[n.jsx(Nl,{level:4,children:r.headerSubtitle}),n.jsx(nt,{})]})]})}),n.jsx(K,{xs:24,lg:8,children:n.jsx(ue,{direction:"vertical",style:{width:"100%"},size:24,children:n.jsx(de,{title:"Key Information",className:"details-card info-card",bordered:!1,children:n.jsxs("div",{className:"info-grid",children:[n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon start-icon",children:n.jsx(Hr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"Start Date"}),n.jsx("div",{className:"info-value",children:Ea(r.startDate)})]})]}),n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon end-icon",children:n.jsx(Hr,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"End Date"}),n.jsx("div",{className:"info-value",children:Ea(r.endDate)})]})]}),r.venue&&n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon venue-icon",children:n.jsx(os,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(es,{type:"secondary",className:"info-label",children:"Venue"}),n.jsx("div",{className:"info-value",children:r.venue})]})]})]})})})})]})})]}),n.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Footer:_v}=kt,{Title:kv,Paragraph:Cv,Text:Av}=Le,Iv=ve(_v)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Nv=ve.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Ta=ve(kv)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Fv=ve.div`
  margin-bottom: 20px;
`,Rv=ve.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,Zr=ve(Cr)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,Rl=ve.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,Pl=ve.div`
  margin-right: 10px;
  color: #4158D0;
`,_a=ve.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Pv=ve(he)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,Dv=ve(te)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Lv=ve(Av)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Ov=ve(nt)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,gf=()=>{const[e,t]=k.useState("/logo.png"),[r,s]=k.useState("Exhibition Manager"),i=new Date().getFullYear();return k.useEffect(()=>{const a=`${Ee.defaults.baseURL}/public/logo`;t(a),fetch(`${Ee.defaults.baseURL}/public/site-info`).then(o=>o.json()).then(o=>{o.siteName&&s(o.siteName)}).catch(o=>{console.error("Error fetching site info:",o)})},[]),n.jsx(Iv,{children:n.jsxs(Nv,{children:[n.jsxs(Ce,{gutter:[48,40],children:[n.jsxs(K,{xs:24,sm:24,md:8,lg:7,children:[n.jsx(Fv,{children:n.jsx(Cr,{to:"/",children:n.jsx(Rv,{src:e,alt:r,onError:()=>t("/logo.png")})})}),n.jsx(Cv,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),n.jsxs(ue,{children:[n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx($x,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Ux,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(zx,{})}),n.jsx(_a,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(qx,{})})]})]}),n.jsxs(K,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(Ta,{level:4,children:"Quick Links"}),n.jsx(Zr,{to:"/exhibitions",children:"Exhibitions"}),n.jsx(Zr,{to:"/about",children:"About Us"}),n.jsx(Zr,{to:"/contact",children:"Contact Us"}),n.jsx(Zr,{to:"/privacy-policy",children:"Privacy Policy"}),n.jsx(Zr,{to:"/terms",children:"Terms & Conditions"})]}),n.jsxs(K,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(Ta,{level:4,children:"For Exhibitors"}),n.jsx(Zr,{to:"/exhibitor/login",children:"Login"}),n.jsx(Zr,{to:"/exhibitor/register",children:"Register"}),n.jsx(Zr,{to:"/exhibitor/dashboard",children:"Dashboard"}),n.jsx(Zr,{to:"/exhibitor/bookings",children:"My Bookings"}),n.jsx(Zr,{to:"/faq",children:"FAQ"})]}),n.jsxs(K,{xs:24,sm:24,md:6,lg:7,children:[n.jsx(Ta,{level:4,children:"Contact Us"}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(os,{})}),n.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(jc,{})}),n.jsx("div",{children:"+91 98765 43210"})]}),n.jsxs(Rl,{children:[n.jsx(Pl,{children:n.jsx(un,{})}),n.jsx("div",{children:"info@exhibitionmanager.com"})]}),n.jsxs("div",{style:{marginTop:24},children:[n.jsx(Ta,{level:4,children:"Newsletter"}),n.jsx(H,{children:n.jsxs(ue.Compact,{style:{width:"100%"},children:[n.jsx(Pv,{placeholder:"Your email address"}),n.jsx(Dv,{type:"primary",icon:n.jsx(Wx,{}),children:"Subscribe"})]})})]})]})]}),n.jsx(Ov,{}),n.jsxs(Lv,{children:["© ",i," ",r,". All rights reserved."]})]})})},{Title:mh,Text:Dl,Paragraph:gh}=Le,{Content:Ll}=kt,Bv=(e,t)=>{const r=new Date,s=new Date(e),i=new Date(t);return r<s?{status:"Upcoming",color:"#722ED1"}:r>i?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},yh=e=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Mv=e=>{const t=new Date,s=new Date(e).getTime()-t.getTime();return Math.ceil(s/(1e3*60*60*24))},vh=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e,r=t.includes("logos/")?t:`logos/${t}`;return`${Ee.defaults.baseURL}/public/images/${r}`},$v=()=>{const e=Je(),[t,r]=k.useState([]),[s,i]=k.useState(!0),[a,o]=k.useState(null),[l,d]=k.useState({});return k.useEffect(()=>{(async()=>{try{i(!0),o(null);const h=await Ar.getExhibitions();r(h.data);const x={};h.data.forEach(u=>{if(u.headerLogo){const p=vh(u.headerLogo),g=new window.Image;g.onload=()=>{x[u._id]=!0,d(f=>({...f,[u._id]:!0}))},g.onerror=()=>{console.warn(`Failed to preload image: ${p}`),x[u._id]=!1,d(f=>({...f,[u._id]:!1}))},g.src=p}})}catch(h){o(h.message||"Failed to fetch exhibitions")}finally{i(!1)}})()},[]),s?n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Ll,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Qr,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):a?n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Ll,{style:{paddingTop:"64px"},children:n.jsx(Di,{status:"error",title:"Failed to load exhibitions",subTitle:a,extra:[n.jsx(te,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsx(Ll,{style:{paddingTop:"64px",background:"#f5f5f5"},children:n.jsxs("div",{style:{padding:"80px 16px"},children:[n.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[n.jsx(mh,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),n.jsx(gh,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?n.jsx(Ce,{gutter:[24,24],children:t.map(c=>{const{status:h,color:x}=Bv(c.startDate,c.endDate),u=Mv(c.startDate),p=c.headerLogo?vh(c.headerLogo):void 0;return n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(de,{hoverable:!0,onClick:()=>e(qo(c)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[n.jsx(xr.Ribbon,{text:h,color:x,style:{right:"-1px",top:"10px",zIndex:2}}),n.jsxs("div",{className:"exhibition-card-container",children:[n.jsx("div",{className:"exhibition-card-logo-container",children:p&&n.jsx("div",{className:"exhibition-logo",children:n.jsx(bu,{src:p,alt:`${c.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:n.jsx(Qr,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsxs("div",{className:"exhibition-card-content",children:[n.jsx("div",{className:"exhibition-title",children:n.jsx(mh,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:c.name})}),n.jsx(gh,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:c.description}),n.jsxs("div",{className:"exhibition-card-details",children:[n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Hr,{style:{color:"#722ED1"}}),n.jsx(ct,{title:"Exhibition Date Range",children:n.jsxs(Dl,{style:{fontSize:14},children:[yh(c.startDate)," - ",yh(c.endDate)]})})]}),c.venue&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(os,{style:{color:"#F5222D"}}),n.jsx(ct,{title:"Venue",children:n.jsx(Dl,{style:{fontSize:14},ellipsis:!0,children:c.venue})})]}),h==="Upcoming"&&u>0&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Vt,{style:{color:"#1890FF"}}),n.jsx(ct,{title:"Time Remaining",children:n.jsxs(Dl,{style:{fontSize:14},children:["Starts in ",u," day",u!==1?"s":""]})})]})]}),n.jsx("div",{className:"exhibition-card-footer",children:n.jsxs(te,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",n.jsx(Zl,{})]})})]})]})]})},c._id)})}):n.jsx(mt,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:mt.PRESENTED_IMAGE_SIMPLE})]})}),n.jsx(gf,{}),n.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})},Uv=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=Me(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},zv=()=>{var q,L,D;const{message:e}=Yt.useApp(),{id:t}=Fr(),r=In(),s=Je(),i=it(),[a,o]=lp(),l=((q=r.state)==null?void 0:q.exhibitionId)||t,{currentExhibition:d,halls:c,stalls:h,loading:x}=Me(M=>M.exhibition),u=k.useRef(null),[p,g]=k.useState(!1),[f,m]=k.useState(null),[v,w]=k.useState(null),[_,y]=k.useState({width:0,height:0}),[b,E]=k.useState(!1);k.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibitions");return}},[l,s,e]),k.useEffect(()=>{if(!l){e.error("Exhibition ID not found"),s("/exhibition");return}(async()=>{try{await i(Or(l)).unwrap(),await i(hn(l)).unwrap(),E(!0)}catch{e.error("Failed to load data")}})()},[l,i,s]),k.useEffect(()=>{var M,J;!b||!d||(!((M=d.dimensions)!=null&&M.width)||!((J=d.dimensions)!=null&&J.height))&&(e.info("Please set up exhibition space first"),s(Lt(d,"space"),{state:{exhibitionId:l}}))},[d,l,s,b]),k.useEffect(()=>{!b||x||c.length===0&&(e.info("Please create halls first"),s(Lt(d,"halls"),{state:{exhibitionId:l}}))},[c,l,s,x,b]),k.useEffect(()=>{b&&d&&c.length>0&&(async()=>{try{const J=c.map(ne=>i(cn({exhibitionId:l,hallId:ne.id})).unwrap());await Promise.all(J)}catch(J){console.error("Error fetching stalls:",J),e.error("Failed to load stalls")}})()},[d,l,c,i,b]);const j=h.filter(M=>M.hallId===((f==null?void 0:f.id)||(f==null?void 0:f._id)));k.useEffect(()=>{if(!b||c.length===0)return;const M=a.get("hallId");if(M){const J=c.find(ne=>ne.id===M||ne._id===M);if(J)m(J);else if(c.length>0){m(c[0]);const ne=c[0].id||c[0]._id;ne&&o({hallId:ne.toString()})}}else if(c.length>0){m(c[0]);const J=c[0].id||c[0]._id;J&&o({hallId:J.toString()})}},[c,a,b,o]),k.useEffect(()=>{const M=()=>{if(u.current){const{clientWidth:ne,clientHeight:Z}=u.current;y({width:Math.max(ne||400,400),height:Math.max(Z||400,400)})}};M();const J=new ResizeObserver(M);return u.current&&J.observe(u.current),window.addEventListener("resize",M),()=>{J.disconnect(),window.removeEventListener("resize",M)}},[]);const S=()=>{if(!f){e.warning("Please select a hall first");return}w(null),g(!0)},C=M=>{if(m(M),w(null),M){const J=M.id||M._id;o(J?{hallId:J.toString()}:{})}else o({})},T=M=>{var ne;const J=M?{...M,id:M.id||M._id,_id:M._id||M.id,stallTypeId:typeof M.stallTypeId=="string"?M.stallTypeId:((ne=M.stallTypeId)==null?void 0:ne._id)||M.stallTypeId,stallType:M.stallType}:null;console.log("Selected stall data:",J),w(J),g(!!J)},A=async M=>{var J,ne;try{if(!(f!=null&&f.id)&&!(f!=null&&f._id)){e.error("No hall selected");return}const Z=f.id,R=f._id||f.id;if(M.hallId&&M.hallId!==R){e.error("Cannot move stall to a different hall");return}if(console.log("Submitting stall data:",M),M.id||M._id){const U={...M,id:M.id,_id:M._id,hallId:R,stallTypeId:M.stallTypeId};console.log("Update data:",U);const B=M.id||M._id;if(!B)throw new Error("Stall ID is missing");await gt.updateStall(l,B,U),e.success("Stall updated successfully")}else{const{id:U,_id:B,...F}=M,V={...F,hallId:R,stallTypeId:M.stallTypeId};console.log("Creating new stall with data:",V),await gt.createStall(l,V),e.success("Stall created successfully")}g(!1),i(cn({exhibitionId:l,hallId:Z}))}catch(Z){console.error("Error saving stall:",Z),e.error(((ne=(J=Z.response)==null?void 0:J.data)==null?void 0:ne.message)||"Failed to save stall")}},I=async M=>{var J,ne;try{if(!l){e.error("Exhibition ID not found");return}const Z=f;if(!Z){e.error("No hall selected");return}const R=Z.id||Z._id;if(!R){e.error("Invalid hall ID");return}await gt.deleteStall(l,M),g(!1),w(null),await i(cn({exhibitionId:l,hallId:R})).unwrap(),e.success("Stall deleted successfully")}catch(Z){console.error("Error deleting stall:",Z),e.error(((ne=(J=Z.response)==null?void 0:J.data)==null?void 0:ne.message)||"Failed to delete stall")}},P=async M=>{var R,U;if(!l){e.error("Exhibition ID not found");return}const J=M.id||M._id;if(!J){console.error("Stall data:",M),e.error("Stall ID not found");return}if(!(f!=null&&f.id)&&!(f!=null&&f._id)){e.error("No hall selected");return}const ne=f.id,Z=f._id||f.id;try{await gt.updateStall(l,J,{...M,id:J,hallId:Z}),i(cn({exhibitionId:l,hallId:ne}))}catch(B){console.error("Stall update error:",B),e.error(((U=(R=B.response)==null?void 0:R.data)==null?void 0:U.message)||"Failed to update stall position")}},N=()=>{g(!1),w(null)};return n.jsx(Xi,{children:n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[n.jsx("div",{style:{padding:"24px 24px 0"},children:n.jsx(Uv,{exhibitionId:l})}),n.jsx(de,{title:"Stall Manager",extra:n.jsxs(ue,{children:[n.jsx(te,{icon:n.jsx(vu,{}),onClick:()=>s(`/exhibition/${l}`,{state:{exhibitionId:l}}),children:"Back to Exhibition"}),n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),onClick:S,disabled:!f,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:n.jsx("div",{ref:u,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:d&&n.jsx(Qi,{width:_.width,height:_.height,exhibitionWidth:((L=d.dimensions)==null?void 0:L.width)||100,exhibitionHeight:((D=d.dimensions)==null?void 0:D.height)||100,halls:c,selectedHall:f,onSelectHall:C,isStallMode:!0,children:f&&j.map(M=>n.jsx(Mc,{stall:M,isSelected:(v==null?void 0:v.id)===M.id||(v==null?void 0:v._id)===M._id,onSelect:()=>T(M),onChange:P,hallWidth:f.dimensions.width,hallHeight:f.dimensions.height,hallX:f.dimensions.x,hallY:f.dimensions.y},M.id||M._id))})})}),d&&n.jsx(By,{visible:p,stall:v,hall:f,exhibition:d,onCancel:N,onSubmit:A,onDelete:v?()=>I(v.id||v._id):void 0})]})})},qv=({exhibitionId:e,destination:t="layout",label:r="Back to Layout"})=>{const s=Je(),{currentExhibition:i}=Me(a=>a.exhibition);return n.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>s(Lt(i,t),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:n.jsx("span",{style:{marginLeft:8},children:r})}),n.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},Wv=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],Hv=()=>{var A,I,P;const{message:e}=Yt.useApp(),{id:t}=Fr(),r=In(),s=Je(),i=it(),a=((A=r.state)==null?void 0:A.exhibitionId)||t,{currentExhibition:o,fixtures:l,halls:d,stalls:c,loading:h}=Me(N=>N.exhibition),x=k.useRef(null),[u,p]=k.useState(!1),[g,f]=k.useState(null),[m,v]=k.useState({width:0,height:0}),[w,_]=k.useState("all"),[y,b]=k.useState([]);k.useEffect(()=>{if(!a){e.error("Exhibition ID not found"),s("/exhibitions");return}},[a,s,e]),k.useEffect(()=>{(async()=>{try{await i(Or(a)).unwrap(),await i(Si({exhibitionId:a})).unwrap(),await i(hn(a)).unwrap(),await i(cn({exhibitionId:a})).unwrap()}catch{e.error("Failed to load data")}})()},[a,i,e]),k.useEffect(()=>{b(w==="all"?l:l.filter(N=>N.type===w))},[l,w]),k.useEffect(()=>{const N=()=>{if(x.current){const{clientWidth:L,clientHeight:D}=x.current;v({width:Math.max(L||400,400),height:Math.max(D||400,400)})}};N();const q=new ResizeObserver(N);return x.current&&q.observe(x.current),window.addEventListener("resize",N),()=>{q.disconnect(),window.removeEventListener("resize",N)}},[]);const E=()=>{f(null),p(!0)},j=N=>{f(N),p(!!N)},S=async N=>{try{N.id||N._id?(await i(ro({exhibitionId:a,id:N.id||N._id||"",data:N})).unwrap(),e.success("Fixture updated successfully")):(await i(to({exhibitionId:a,data:N})).unwrap(),e.success("Fixture created successfully")),await i(Si({exhibitionId:a})).unwrap(),p(!1)}catch(q){console.error("Failed to save fixture:",q),e.error(q.message||"Failed to save fixture")}},C=async N=>{try{const q=N.id||N._id;if(!q)throw new Error("Fixture ID is required");await i(no({exhibitionId:a,id:q})).unwrap(),e.success("Fixture deleted successfully"),p(!1),f(null)}catch(q){console.error("Failed to delete fixture:",q),e.error(q.message||"Failed to delete fixture")}},T=N=>{_(N)};return n.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[n.jsx(qv,{exhibitionId:a}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(ue,{children:n.jsx("span",{children:"Fixture Management"})}),n.jsxs(ue,{children:[n.jsx(Pe,{style:{width:180},value:w,onChange:T,options:Wv}),n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),onClick:E,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[n.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),n.jsx("div",{ref:x,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:n.jsx(Xi,{children:m.width>0&&m.height>0&&(o==null?void 0:o.dimensions)&&n.jsx(Qi,{width:m.width,height:m.height,exhibitionWidth:o.dimensions.width,exhibitionHeight:o.dimensions.height,halls:d,stalls:c,fixtures:y,selectedFixture:g,onSelectFixture:j,onFixtureChange:S,onAddFixture:E,isFixtureMode:!0})})})]}),n.jsx(qy,{visible:u,fixture:g,onCancel:()=>p(!1),onSubmit:S,onDelete:C,exhibitionWidth:((I=o==null?void 0:o.dimensions)==null?void 0:I.width)||100,exhibitionHeight:((P=o==null?void 0:o.dimensions)==null?void 0:P.height)||100})]})},{Title:Vv,Text:Gv}=Le,{Option:Cs}=Pe,Yv=()=>{const e=Je(),t=it(),{stalls:r,loading:s}=Me(L=>L.exhibition),[i,a]=k.useState([]),[o,l]=k.useState([]),[d,c]=k.useState(null),[h,x]=k.useState(null),[u,p]=k.useState(!1),g=xt.useMemo(()=>Math.max(...r.map(L=>L.ratePerSqm*L.dimensions.width*L.dimensions.height),1e6),[r]),f=xt.useMemo(()=>{const L=Math.pow(10,Math.floor(Math.log10(g)));return Math.ceil(g/L)*L},[g]),[m,v]=k.useState(""),[w,_]=k.useState(null),[y,b]=k.useState([0,f]),[E,j]=k.useState("number"),[S,C]=k.useState("ascend"),T=L=>{c(L),x(null),t({type:"exhibition/clearStalls"})},A=L=>{x(L),t(d&&L?cn({exhibitionId:d,hallId:L}):{type:"exhibition/clearStalls"})};k.useEffect(()=>{(async()=>{try{p(!0),console.log("Fetching exhibitions...");const D=await gt.getActiveExhibitions();console.log("Exhibitions response:",D.data),a(D.data)}catch(D){console.error("Failed to fetch exhibitions:",D)}finally{p(!1)}})()},[]),k.useEffect(()=>{d?(async()=>{try{p(!0),console.log("Fetching halls for exhibition:",d);const D=await gt.getHalls(d);console.log("Halls response:",D.data),l(D.data)}catch(D){console.error("Failed to fetch halls:",D)}finally{p(!1)}})():l([])},[d]);const I=xt.useMemo(()=>{console.log("Filtering stalls from Redux:",r);const L=r.filter(D=>{const M=!m||D.number.toLowerCase().includes(m.toLowerCase()),J=!w||D.status===w,ne=!h||D.hallId===h,Z=D.ratePerSqm*D.dimensions.width*D.dimensions.height,R=Z>=y[0]&&Z<=y[1];return M&&J&&ne&&R}).sort((D,M)=>E==="number"?S==="ascend"?D.number.localeCompare(M.number):M.number.localeCompare(D.number):0);return console.log("Filtered stalls:",L),L},[r,m,w,h,y,E,S]),P=L=>{switch(L){case"available":return"success";case"booked":return"warning";case"reserved":return"processing";case"sold":return"error";default:return"default"}},q=(L=>{const D=L.reduce((M,J)=>{var ne,Z;return(ne=J==null?void 0:J.dimensions)!=null&&ne.width&&((Z=J==null?void 0:J.dimensions)!=null&&Z.height)?M+J.dimensions.width*J.dimensions.height:M},0);return{totalStalls:L.length,totalSize:D}})(I);return n.jsx("div",{className:"dashboard-container",children:n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{span:24,children:n.jsxs(ue,{direction:"vertical",size:4,style:{width:"100%"},children:[n.jsx(Vv,{level:4,style:{margin:0},children:"Stalls"}),n.jsx(Gv,{type:"secondary",children:"Manage your exhibition stalls"})]})}),n.jsx(K,{span:24,children:n.jsxs(Ce,{gutter:[16,16],align:"middle",children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(Pe,{style:{width:"100%"},placeholder:"Select Exhibition",value:d,onChange:T,allowClear:!0,children:i.map(L=>n.jsx(Cs,{value:L._id||L.id,children:L.name},L._id||L.id))})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(Pe,{style:{width:"100%"},placeholder:"Select Hall",value:h,onChange:A,disabled:!d||o.length===0,allowClear:!0,children:o.map(L=>n.jsx(Cs,{value:L._id||L.id,children:L.name},L._id||L.id))})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(he,{placeholder:"Search by stall number",prefix:n.jsx(kn,{}),value:m,onChange:L=>v(L.target.value),allowClear:!0})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsxs(Pe,{style:{width:"100%"},placeholder:"Filter by status",value:w,onChange:_,allowClear:!0,children:[n.jsx(Cs,{value:"available",children:"Available"}),n.jsx(Cs,{value:"booked",children:"Booked"}),n.jsx(Cs,{value:"reserved",children:"Reserved"}),n.jsx(Cs,{value:"sold",children:"Sold"})]})})]})}),n.jsx(K,{span:24,children:n.jsx(de,{size:"small",children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{xs:12,sm:12,md:6,children:n.jsx(Xe,{title:"Total Stalls",value:q.totalStalls,prefix:n.jsx(Hx,{})})}),n.jsx(K,{xs:12,sm:12,md:6,children:n.jsx(Xe,{title:"Total Area",value:q.totalSize,suffix:"sqm",prefix:n.jsx(ps,{}),precision:2})})]})})}),n.jsx(K,{span:24,children:n.jsx(de,{size:"small",title:"Price Range Filter",children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:24,style:{marginBottom:16},children:n.jsxs(ue,{children:[n.jsx(te,{size:"small",onClick:()=>b([0,5e5]),children:"Under ₹5L"}),n.jsx(te,{size:"small",onClick:()=>b([5e5,1e6]),children:"₹5L - ₹10L"}),n.jsx(te,{size:"small",onClick:()=>b([1e6,2e6]),children:"₹10L - ₹20L"}),n.jsx(te,{size:"small",onClick:()=>b([2e6,f]),children:"Above ₹20L"}),n.jsx(te,{size:"small",onClick:()=>b([0,f]),children:"All"})]})}),n.jsx(K,{span:16,children:n.jsx(yu,{range:!0,min:0,max:f,value:y,onChange:L=>b(L),step:Math.max(1e3,Math.floor(f/1e3)),tooltip:{formatter:L=>`₹${(L||0).toLocaleString()}`}})}),n.jsx(K,{span:4,children:n.jsx(yt,{style:{width:"100%"},min:0,max:y[1],value:y[0],onChange:L=>b([L||0,y[1]]),formatter:L=>`₹ ${L}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:L=>L?Number(L.replace(/[^\d.-]/g,"")):0,step:1e3})}),n.jsx(K,{span:4,children:n.jsx(yt,{style:{width:"100%"},min:y[0],max:f,value:y[1],onChange:L=>b([y[0],L||f]),formatter:L=>`₹ ${L}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:L=>L?Number(L.replace(/[^\d.-]/g,"")):0,step:1e3})})]})})}),n.jsx(K,{span:24,children:n.jsx(tt,{columns:[{title:"Stall Number",dataIndex:"number",key:"number",sorter:(L,D)=>L.number.localeCompare(D.number),defaultSortOrder:"ascend"},{title:"Type",dataIndex:["stallType","name"],key:"type",render:(L,D)=>{var M;return((M=D.stallType)==null?void 0:M.name)||"N/A"}},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"ratePerSqm",render:L=>L?`₹${L.toLocaleString()}`:"N/A",sorter:(L,D)=>(L.ratePerSqm||0)-(D.ratePerSqm||0)},{title:"Area (sqm)",key:"area",render:(L,D)=>{var M,J;return(M=D==null?void 0:D.dimensions)!=null&&M.width&&((J=D==null?void 0:D.dimensions)!=null&&J.height)?`${D.dimensions.width*D.dimensions.height} sqm`:"N/A"},sorter:(L,D)=>{var ne,Z,R,U;const M=(((ne=L.dimensions)==null?void 0:ne.width)||0)*(((Z=L.dimensions)==null?void 0:Z.height)||0),J=(((R=D.dimensions)==null?void 0:R.width)||0)*(((U=D.dimensions)==null?void 0:U.height)||0);return M-J}},{title:"Dimensions",key:"dimensions",render:(L,D)=>{var M,J;return(M=D==null?void 0:D.dimensions)!=null&&M.width&&((J=D==null?void 0:D.dimensions)!=null&&J.height)?`${D.dimensions.width}m × ${D.dimensions.height}m`:"N/A"}},{title:"Total Price",key:"totalPrice",render:(L,D)=>{var M,J;return(M=D==null?void 0:D.dimensions)!=null&&M.width&&((J=D==null?void 0:D.dimensions)!=null&&J.height)&&D.ratePerSqm?`₹${(D.ratePerSqm*D.dimensions.width*D.dimensions.height).toLocaleString()}`:"N/A"},sorter:(L,D)=>{var ne,Z,R,U;const M=(L.ratePerSqm||0)*(((ne=L.dimensions)==null?void 0:ne.width)||0)*(((Z=L.dimensions)==null?void 0:Z.height)||0),J=(D.ratePerSqm||0)*(((R=D.dimensions)==null?void 0:R.width)||0)*(((U=D.dimensions)==null?void 0:U.height)||0);return M-J}},{title:"Status",dataIndex:"status",key:"status",render:L=>n.jsx(Se,{color:P(L),style:{textTransform:"capitalize"},children:L||"N/A"}),filters:[{text:"Available",value:"available"},{text:"Booked",value:"booked"},{text:"Reserved",value:"reserved"},{text:"Sold",value:"sold"}],onFilter:(L,D)=>D.status===L},{title:"Actions",key:"actions",render:(L,D)=>n.jsxs(ue,{children:[n.jsx("a",{onClick:()=>e(`/stall/edit/${D._id||D.id}`),children:"Edit"}),n.jsx("a",{onClick:()=>e(`/stall/view/${D._id||D.id}`),children:"View"})]})}],dataSource:I,rowKey:L=>L._id||L.id,loading:u||s,pagination:{total:I.length,pageSize:10,showSizeChanger:!0,showTotal:L=>`Total ${L} stalls`},onChange:(L,D,M)=>{M.field&&(j(M.field),C(M.order))}})})]})})})},{Title:Kv,Text:Xv}=Le,{TextArea:Qv}=he,{Search:Jv}=he,{Option:bh}=Pe,Zv=()=>{Je();const{message:e}=Yt.useApp(),[t,r]=k.useState(!1),[s]=H.useForm(),[i,a]=k.useState(!1),[o,l]=k.useState([]),[d,c]=k.useState(!1),[h,x]=k.useState(null);k.useEffect(()=>{u()},[]),k.useEffect(()=>{var w;if(console.log("Modal visibility changed:",t),console.log("Editing stall type:",h),t&&h){const _=((w=h.features)==null?void 0:w.map(y=>y.feature).join(", "))||"";console.log("Setting form values:",{name:h.name,description:h.description,features:_,status:h.status}),setTimeout(()=>{s.setFieldsValue({name:h.name,description:h.description,features:_,status:h.status})},0)}else t&&(s.resetFields(),s.setFieldsValue({status:"active"}))},[h,s,t]);const u=async()=>{try{c(!0);const w=await Ms.getStallTypes();l(w.data)}catch(w){e.error("Failed to fetch stall types: "+w.message)}finally{c(!1)}},p=async w=>{try{a(!0),console.log("Form values:",w);const _={name:w.name,description:w.description,status:w.status,features:w.features?w.features.split(",").map(y=>({feature:y.trim()})):[]};console.log("Submitting data:",_),h?(await Ms.updateStallType(h._id,_),e.success("Stall type updated successfully")):(await Ms.createStallType(_),e.success("Stall type created successfully")),r(!1),x(null),s.resetFields(),u()}catch(_){e.error(`Failed to ${h?"update":"create"} stall type: `+_.message)}finally{a(!1)}},g=w=>{console.log("Editing stall type:",w),x(w),r(!0)},f=async w=>{try{await Ms.deleteStallType(w._id),e.success("Stall type deleted successfully"),u()}catch(_){e.error("Failed to delete stall type: "+_.message)}},m=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(w,_)=>w.name.localeCompare(_.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:w=>n.jsx(ue,{wrap:!0,children:w==null?void 0:w.map(({feature:_})=>n.jsx(Se,{children:_},_))})},{title:"Status",dataIndex:"status",key:"status",render:w=>n.jsx(Se,{color:w==="active"?"success":"default",children:w.toUpperCase()})},{title:"Actions",key:"actions",render:(w,_)=>n.jsxs(ue,{children:[n.jsx(te,{type:"link",onClick:()=>g(_),children:"Edit"}),n.jsx(te,{type:"link",danger:!0,onClick:()=>f(_),children:"Delete"})]})}],v=()=>{r(!1),x(null),s.resetFields()};return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ce,{justify:"space-between",align:"middle",children:[n.jsx(K,{children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(Kv,{level:4,style:{margin:0},children:"Stall Types"}),n.jsx(Xv,{type:"secondary",children:"Manage your stall types and configurations"})]})}),n.jsx(K,{children:n.jsxs(ue,{children:[n.jsx(Jv,{placeholder:"Search stall types",style:{width:200},onSearch:w=>console.log(w)}),n.jsx(te,{type:"primary",icon:n.jsx(fr,{}),onClick:()=>r(!0),children:"Add Stall Type"})]})})]})}),n.jsx(de,{className:"info-card",children:n.jsx(tt,{columns:m,dataSource:o,rowKey:w=>w._id,loading:d})}),n.jsx(Ve,{title:h?"Edit Stall Type":"Add Stall Type",open:t,onCancel:v,footer:null,destroyOnClose:!1,children:n.jsxs(H,{form:s,layout:"vertical",onFinish:p,initialValues:{status:"active"},preserve:!0,children:[n.jsx(H.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:n.jsx(he,{placeholder:"e.g., 1 Side Open"})}),n.jsx(H.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:n.jsx(Qv,{rows:4,placeholder:"Enter description"})}),n.jsx(H.Item,{name:"features",label:"Features",children:n.jsx(he,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),n.jsx(H.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(Pe,{children:[n.jsx(bh,{value:"active",children:"Active"}),n.jsx(bh,{value:"inactive",children:"Inactive"})]})}),n.jsx(H.Item,{children:n.jsxs(te,{type:"primary",htmlType:"submit",loading:i,block:!0,children:[h?"Update":"Create"," Stall Type"]})})]})})]})},eb={bookings:[],currentBooking:null,loading:!1,error:null},Mn=Qe("booking/fetchBookings",async()=>(await Ee.get("/bookings")).data),Ol=Qe("booking/fetchBooking",async e=>(await Ee.get(`/bookings/${e}`)).data),so=Qe("booking/createBooking",async e=>(await Ee.post("/bookings",e)).data),io=Qe("booking/updateStatus",async({id:e,status:t,rejectionReason:r})=>(await Ee.patch(`/bookings/${e}`,{status:t,...r&&{rejectionReason:r}})).data),Bl=Qe("booking/updatePaymentStatus",async({id:e,paymentStatus:t,paymentDetails:r})=>(await Ee.patch(`/bookings/${e}/payment`,{paymentStatus:t,paymentDetails:r})).data),ao=Qe("booking/deleteBooking",async e=>(await Ee.delete(`/bookings/${e}`),e)),yf=gr({name:"booking",initialState:eb,reducers:{clearCurrentBooking:e=>{e.currentBooking=null},clearBookingError:e=>{e.error=null}},extraReducers:e=>{e.addCase(Mn.pending,t=>{t.loading=!0,t.error=null}).addCase(Mn.fulfilled,(t,r)=>{t.loading=!1,t.bookings=r.payload}).addCase(Mn.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch bookings"}).addCase(Ol.pending,t=>{t.loading=!0,t.error=null}).addCase(Ol.fulfilled,(t,r)=>{t.loading=!1,t.currentBooking=r.payload}).addCase(Ol.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch booking"}).addCase(so.pending,t=>{t.loading=!0,t.error=null}).addCase(so.fulfilled,(t,r)=>{t.loading=!1,t.bookings.unshift(r.payload),t.currentBooking=r.payload}).addCase(so.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to create booking"}).addCase(io.pending,t=>{t.loading=!0,t.error=null}).addCase(io.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(io.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update booking status"}).addCase(Bl.pending,t=>{t.loading=!0,t.error=null}).addCase(Bl.fulfilled,(t,r)=>{var i;t.loading=!1;const s=t.bookings.findIndex(a=>a._id===r.payload._id);s!==-1&&(t.bookings[s]=r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(Bl.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update payment status"}).addCase(ao.pending,t=>{t.loading=!0,t.error=null}).addCase(ao.fulfilled,(t,r)=>{var s;t.loading=!1,t.bookings=t.bookings.filter(i=>i._id!==r.payload),((s=t.currentBooking)==null?void 0:s._id)===r.payload&&(t.currentBooking=null)}).addCase(ao.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:i4,clearBookingError:a4}=yf.actions,tb=yf.reducer,rb="/api",oo=Bc({reducerPath:"invoiceApi",baseQuery:Pc({baseUrl:rb,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["Invoice"],endpoints:e=>({getInvoices:e.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:e.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,r,s)=>[{type:"Invoice",id:s}]}),downloadInvoice:e.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:r})})})}),{useGetInvoicesQuery:vf,useGetInvoiceQuery:nb,useShareViaEmailMutation:sb}=oo,ib=({bookings:e})=>{const r={total:e.length,pending:e.filter(i=>i.status==="pending").length,approved:e.filter(i=>i.status==="approved").length,rejected:e.filter(i=>i.status==="rejected").length,confirmed:e.filter(i=>i.status==="confirmed").length,cancelled:e.filter(i=>i.status==="cancelled").length,totalRevenue:e.filter(i=>i.status==="confirmed"||i.status==="approved").reduce((i,a)=>i+a.amount,0),totalActiveBookings:e.filter(i=>i.status==="confirmed"||i.status==="approved").length,totalDeclinedBookings:e.filter(i=>i.status==="cancelled"||i.status==="rejected").length};return n.jsxs(n.Fragment,{children:[n.jsxs(Ce,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Total Bookings",value:r.total,prefix:n.jsx(Gi,{})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Pending Bookings",value:r.pending,prefix:n.jsx(Vt,{style:{color:"#faad14"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Approved Bookings",value:r.approved,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Confirmed Bookings",value:r.confirmed,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})})]}),n.jsxs(Ce,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Rejected Bookings",value:r.rejected,prefix:n.jsx(Xr,{style:{color:"#f5222d"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Cancelled Bookings",value:r.cancelled,prefix:n.jsx(Xr,{style:{color:"#f5222d"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Total Revenue",value:r.totalRevenue,prefix:"₹",precision:2})})}),n.jsx(K,{xs:24,sm:12,md:6})]})]})},{RangePicker:ab}=xs,ob=({filters:e,exhibitions:t,onFilterChange:r,onRefresh:s})=>n.jsx(de,{style:{marginBottom:"24px"},children:n.jsxs(ue,{wrap:!0,children:[n.jsx(he,{placeholder:"Search by company name",prefix:n.jsx(kn,{}),value:e.search,onChange:i=>r({...e,search:i.target.value}),style:{width:200},allowClear:!0}),n.jsx(Pe,{placeholder:"Filter by exhibition",value:e.exhibition,onChange:i=>r({...e,exhibition:i}),style:{minWidth:200},allowClear:!0,options:t.map(i=>({label:i.name,value:i._id}))}),n.jsx(Pe,{mode:"multiple",placeholder:"Filter by status",value:e.status,onChange:i=>r({...e,status:i}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),n.jsx(ab,{onChange:i=>{var a,o;return r({...e,dateRange:i?[((a=i[0])==null?void 0:a.toISOString())||"",((o=i[1])==null?void 0:o.toISOString())||""]:null})}}),n.jsx(te,{icon:n.jsx(Xs,{}),onClick:s,children:"Refresh"})]})}),{Title:lb,Text:Et}=Le,{RangePicker:o4}=xs,cb=()=>{const e=it(),{bookings:t,loading:r}=Me(L=>L.booking),{exhibitions:s}=Me(L=>L.exhibition),[i,a]=k.useState(null),[o,l]=k.useState(!1),[d,c]=k.useState({search:"",status:[],dateRange:null,exhibition:null}),h=Je(),{data:x,isLoading:u,error:p,refetch:g}=vf({page:1,limit:100}),[f,m]=k.useState(!1),[v,w]=k.useState("pending"),[_,y]=k.useState(""),[b,E]=k.useState(!1),{hasPermission:j}=zo();k.useEffect(()=>{e(Mn())},[e]),k.useEffect(()=>{e(Lr())},[e]),k.useEffect(()=>{t.length>0&&[...new Set(t.map(D=>D.exhibitionId._id))].forEach(D=>{e(Or(D))})},[t,e]);const S=async(L,D,M)=>{try{E(!0),await e(io({id:L,status:D,...M&&{rejectionReason:M}})).unwrap(),be.success(`Booking ${D} successfully`),e(Mn()),D==="approved"&&setTimeout(async()=>{await g()},1e3),l(!1),m(!1),a(null)}catch{be.error("Failed to update booking status")}finally{E(!1)}},C=async L=>{try{await e(ao(L)).unwrap(),be.success("Booking deleted successfully"),e(Mn())}catch(D){be.error((D==null?void 0:D.message)||"Failed to delete booking")}},T=L=>{c(L)},A=t.filter(L=>{var D;if(d.search&&!((D=L.companyName)!=null&&D.toLowerCase().includes(d.search.toLowerCase()))||d.status.length>0&&!d.status.includes(L.status)||d.exhibition&&L.exhibitionId._id!==d.exhibition)return!1;if(d.dateRange){const[M,J]=d.dateRange,ne=new Date(L.createdAt);if(ne<new Date(M)||ne>new Date(J))return!1}return!0}),I=(L,D)=>{const M=new Date(D).getFullYear(),J=t.find(F=>F._id===L);if(!J)return`--/${M}/--`;const R=(t.filter(F=>F.exhibitionId._id===J.exhibitionId._id).sort((F,V)=>new Date(F.createdAt).getTime()-new Date(V.createdAt).getTime()).findIndex(F=>F._id===L)+1).toString().padStart(2,"0"),U=s.find(F=>F._id===J.exhibitionId._id);return`${(U==null?void 0:U.invoicePrefix)||J.exhibitionId.invoicePrefix||"BK"}/${M}/${R}`},P=L=>{if(u)return console.log("Loading invoices..."),null;if(p)return console.error("Error loading invoices:",p),null;if(!x)return console.log("No invoices available"),null;const D=x.data||[];console.log("Looking for invoice with booking ID:",L);const M=D.find(J=>J.bookingId&&typeof J.bookingId=="object"&&J.bookingId._id===L);return console.log("Found invoice:",M),M==null?void 0:M._id},N=async L=>{if(u){be.loading("Loading invoice data...");return}let D=P(L._id);if(D)h(`/invoice/${D}`);else{const M="invoice-loading";if(be.loading({content:"Checking for invoice...",key:M}),await g(),D=P(L._id),D){be.success({content:"Invoice found!",key:M,duration:1}),h(`/invoice/${D}`);return}const J=new Date(L.createdAt),ne=new Date(Date.now()-30*60*1e3);if(J>ne||L.status==="approved"){be.info({content:"Invoice is still being generated. Checking again in a moment...",key:M});let R=0;const U=5,B=[2e3,3e3,5e3,8e3,1e4],F=async()=>{R++,await g();const V=P(L._id);if(V)be.success({content:"Invoice is ready!",key:M,duration:1}),h(`/invoice/${V}`);else if(R<U){const se=B[R]||5e3,xe=se/1e3;be.info({content:`Attempt ${R}/${U}: Invoice not ready yet. Trying again in ${xe} seconds...`,key:M}),setTimeout(F,se)}else be.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:M})};setTimeout(F,B[0])}else be.error({content:"No invoice found for this booking. Please contact support if this persists.",key:M})}},q=[{title:"Booking Number",dataIndex:"_id",key:"_id",fixed:"left",width:200,render:(L,D)=>n.jsx(te,{type:"link",onClick:()=>{a(t.find(M=>M._id===L)||null),l(!0)},children:I(L,D.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(L,D)=>D.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:L=>L||"N/A"},{title:"Stalls",key:"stalls",width:150,render:(L,D)=>D.stallIds.map(M=>M.number).join(", ")},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:L=>`₹${L.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(L,D)=>{const M=D.calculations.totalDiscountAmount;if(!M||M===0)return"-";const J=D.calculations.stalls.filter(Z=>Z.discount).map(Z=>Z.discount);if(J.length===0)return"-";const ne=J[0];return n.jsx(ct,{title:n.jsx("div",{children:J.map((Z,R)=>n.jsxs("div",{children:[Z==null?void 0:Z.name,": ",(Z==null?void 0:Z.type)==="percentage"?`${Z==null?void 0:Z.value}%`:`₹${Z==null?void 0:Z.value}`,n.jsx("br",{}),"Amount: ₹",Z==null?void 0:Z.amount.toLocaleString()]},R))}),children:n.jsxs(Se,{color:"red",children:["-₹",M.toLocaleString(),(ne==null?void 0:ne.type)==="percentage"&&` (${ne.value}%)`,J.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:L=>`₹${L.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:L=>n.jsx(Se,{color:L==="confirmed"?"success":L==="approved"?"blue":L==="pending"?"warning":L==="rejected"?"error":"default",children:L.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:L=>et(L).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(L,D)=>n.jsxs(ue,{children:[n.jsx(ct,{title:"View Details",children:n.jsx(te,{icon:n.jsx(dn,{}),onClick:()=>{a(D),l(!0)}})}),n.jsx(Vn,{overlay:n.jsxs(or,{children:[D.status!=="cancelled"&&j("view_bookings")&&n.jsx(or.Item,{icon:n.jsx(_n,{}),disabled:u,onClick:()=>N(D),children:"View Invoice"},"invoice"),n.jsx(or.Item,{icon:n.jsx(vt,{}),onClick:()=>{a(D),w(D.status),y(D.rejectionReason||""),m(!0)},children:"Update Status"},"updateStatus"),j("bookings_delete")&&n.jsx(or.Item,{icon:n.jsx(ar,{}),danger:!0,onClick:()=>{Ve.confirm({title:"Delete Booking",content:"Are you sure you want to delete this booking? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>C(D._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(te,{icon:n.jsx(Sc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ce,{gutter:[24,24],align:"middle",children:[n.jsx(K,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(lb,{level:4,style:{margin:0},children:"Stall Bookings"}),n.jsx(Et,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),n.jsx(K,{children:n.jsx(te,{type:"primary",size:"large",icon:n.jsx(fr,{}),onClick:()=>h("/bookings/create"),children:"Create Booking"})})]})}),n.jsx(ib,{bookings:t}),n.jsx(ob,{filters:d,exhibitions:s,onFilterChange:T,onRefresh:()=>e(Mn())}),n.jsx(de,{className:"info-card",styles:{body:{padding:0,overflow:"auto"}},children:n.jsx(tt,{columns:q,dataSource:A,loading:r,rowKey:"_id",scroll:{x:1500},pagination:{total:A.length,pageSize:10,showSizeChanger:!0,showTotal:L=>`Total ${L} items`,position:["bottomRight"]}})}),n.jsx(Ve,{title:"Booking Details",open:o,onCancel:()=>{l(!1),a(null)},footer:[n.jsx(te,{type:"primary",disabled:!i,onClick:()=>{i&&(w(i.status),y(i.rejectionReason||""),m(!0))},children:"Update Status"},"updateStatus"),n.jsx(te,{onClick:()=>{l(!1),a(null)},children:"Close"},"close")],width:800,children:i&&n.jsxs(ue,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(We,{bordered:!0,column:2,children:[n.jsxs(We.Item,{label:"Booking Number",span:2,children:[I(i._id,i.createdAt),n.jsxs(Et,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",i._id,")"]})]}),n.jsx(We.Item,{label:"Exhibition",span:2,children:i.exhibitionId.name}),n.jsxs(We.Item,{label:"Status",span:2,children:[n.jsx(Se,{color:i.status==="confirmed"?"success":i.status==="approved"?"blue":i.status==="pending"?"warning":i.status==="rejected"?"error":"default",children:i.status.toUpperCase()}),i.rejectionReason&&n.jsxs("div",{style:{marginTop:8},children:[n.jsx(Et,{type:"secondary",children:"Rejection Reason:"}),n.jsx("br",{}),n.jsx(Et,{children:i.rejectionReason})]})]}),n.jsx(We.Item,{label:"Customer Name",children:i.customerName}),n.jsx(We.Item,{label:"Customer Email",children:i.customerEmail}),n.jsx(We.Item,{label:"Customer Phone",children:i.customerPhone}),n.jsx(We.Item,{label:"Company Name",children:i.companyName})]}),n.jsx(de,{title:"Stall Details",size:"small",children:n.jsx(tt,{dataSource:i.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:L=>n.jsxs(Se,{color:"blue",children:[L.dimensions.width,"x",L.dimensions.height,"m"]})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:L=>`₹${L.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:L=>{const D=i.calculations.stalls.find(M=>M.stallId===L._id);return D?`₹${D.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:L=>{const D=i.calculations.stalls.find(M=>M.stallId===L._id);return D!=null&&D.discount?n.jsxs(Se,{color:"red",children:["-₹",D.discount.amount.toLocaleString(),D.discount.type==="percentage"&&` (${D.discount.value}%)`]}):"-"}}]})}),n.jsx(de,{title:"Financial Summary",size:"small",children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},size:"small",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Et,{children:"Total Base Amount:"}),n.jsxs(Et,{children:["₹",i.calculations.totalBaseAmount.toLocaleString()]})]}),i.calculations.totalDiscountAmount>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Et,{children:"Total Discount:"}),n.jsxs(Et,{type:"danger",children:["-₹",i.calculations.totalDiscountAmount.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Et,{children:"Amount after Discount:"}),n.jsxs(Et,{children:["₹",i.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),n.jsx(nt,{style:{margin:"8px 0"}}),i.calculations.taxes.map(L=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Et,{children:[L.name," (",L.rate,"%):"]}),n.jsxs(Et,{children:["₹",L.amount.toLocaleString()]})]},L.name)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(Et,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(Et,{strong:!0,children:["₹",i.amount.toLocaleString()]})]})]})})]})}),n.jsx(Ve,{title:"Update Booking Status",open:f,onCancel:()=>{m(!1),y("")},footer:null,width:600,children:i&&n.jsxs("div",{children:[n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(_n,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:n.jsxs(Ce,{gutter:[16,8],children:[n.jsx(K,{span:8,children:n.jsx(Et,{strong:!0,children:"Booking Number:"})}),n.jsx(K,{span:16,children:n.jsx(Et,{children:I(i._id,i.createdAt)})}),n.jsx(K,{span:8,children:n.jsx(Et,{strong:!0,children:"Company:"})}),n.jsx(K,{span:16,children:n.jsx(Et,{children:i.companyName})}),n.jsx(K,{span:8,children:n.jsx(Et,{strong:!0,children:"Exhibition:"})}),n.jsx(K,{span:16,children:n.jsx(Et,{children:i.exhibitionId.name})}),n.jsx(K,{span:8,children:n.jsx(Et,{strong:!0,children:"Current Status:"})}),n.jsx(K,{span:16,children:n.jsx(Se,{color:i.status==="confirmed"?"success":i.status==="approved"?"blue":i.status==="pending"?"warning":i.status==="rejected"?"error":"default",children:i.status.toUpperCase()})})]})}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Qs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Et,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(mr.Group,{value:v,onChange:L=>w(L.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[n.jsx(mr.Button,{value:"pending",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Vt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(mr.Button,{value:"approved",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(vt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(mr.Button,{value:"rejected",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Xr,{style:{color:"#f5222d"}}),"Rejected"]})}),n.jsx(mr.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(vt,{style:{color:"#1890ff"}}),"Confirmed"]})}),n.jsx(mr.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:n.jsxs(ue,{children:[n.jsx(Xr,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),v==="rejected"&&n.jsx("div",{children:n.jsx(H.Item,{label:n.jsx(Et,{strong:!0,children:"Rejection Reason:"}),required:v==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:n.jsx(he.TextArea,{rows:4,value:_,onChange:L=>y(L.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),v==="approved"&&n.jsx(_t,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),v==="confirmed"&&n.jsx(_t,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),v==="cancelled"&&n.jsx(_t,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),v==="pending"&&n.jsx(_t,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(te,{onClick:()=>{m(!1),y("")},children:"Cancel"}),n.jsx(te,{type:"primary",onClick:()=>{if(v==="rejected"&&!_.trim()){be.error("Rejection reason is required when rejecting a booking");return}S(i._id,v,v==="rejected"?_:void 0)},loading:b,disabled:v==="rejected"&&!_.trim(),children:"Update Status"})]})]})]})})]})},db={exhibitors:[],loading:!1,error:null},ln=Qe("exhibitors/fetchAll",async(e,{rejectWithValue:t})=>{var r,s;try{return(await ir.getExhibitors()).data}catch(i){return t(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch exhibitors")}}),hb=gr({name:"exhibitor",initialState:db,reducers:{},extraReducers:e=>{e.addCase(ln.pending,t=>{t.loading=!0,t.error=null}).addCase(ln.fulfilled,(t,r)=>{t.exhibitors=r.payload,t.loading=!1}).addCase(ln.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),ub=hb.reducer,{Title:fb,Text:en}=Le,xb=()=>{var se,xe,me;const[e]=H.useForm(),[t]=H.useForm(),[r,s]=k.useState(!1),[i,a]=k.useState([]),[o,l]=k.useState(!1),[d,c]=k.useState([]),[h,x]=k.useState(null),[u,p]=k.useState(),[g,f]=k.useState([]),[m,v]=k.useState({}),[w,_]=k.useState([]),[y,b]=k.useState(0),E=Je(),j=it(),{loading:S}=Me(Q=>Q.booking),{exhibitions:C=[],loading:T}=Me(Q=>Q.exhibition),{exhibitors:A=[],loading:I}=Me(Q=>Q.exhibitor),{isAuthenticated:P}=Me(Q=>Q.auth);k.useEffect(()=>{if(!P){be.error("Please login to create a booking"),E("/login");return}j(Lr()),j(ln())},[j,P,E]);const N=async Q=>{try{l(!0),e.setFieldValue("stallIds",[]),e.setFieldValue("discountId",void 0),e.setFieldValue("extraAmenities",[]),c([]),f([]),_([]),b(0);const ee=await gt.getExhibition(Q);x(ee.data);const Ie=(await gt.getStalls(Q)).data.filter(re=>re.status==="available");a(Ie)}catch(ee){console.error("Failed to fetch exhibition data:",ee),be.error("Failed to fetch exhibition data")}finally{l(!1)}},q=Q=>Math.round(Q.ratePerSqm*Q.dimensions.width*Q.dimensions.height*100)/100,L=Q=>{var Ie;const ee=i.filter(re=>{const _e=re._id||re.id;return _e&&Q.includes(_e)});c(ee);const ce=ee.reduce((re,_e)=>re+_e.dimensions.width*_e.dimensions.height,0);if(b(ce),(Ie=h==null?void 0:h.basicAmenities)!=null&&Ie.length){const re=h.basicAmenities.map(_e=>{const Ne=Math.floor(ce/_e.perSqm)*_e.quantity;return{..._e,calculatedQuantity:Ne>0?Ne:0,key:_e._id||_e.id}});_(re)}},D=(Q,ee,ce)=>{if(!(ce!=null&&ce.isActive))return 0;let Ie=0;if(ce.type==="percentage")Ie=Q*(Math.max(0,Math.min(100,ce.value))/100);else{const re=Q/ee*ce.value;Ie=Math.min(re,Q)}return Math.round(Ie*100)/100},M=async Q=>{var ee,ce;try{const Ie=A.find(Be=>Be._id===Q.exhibitorId);if(!Ie)throw new Error("Selected exhibitor not found");const[re,_e,Ne]=Q.discountId?Q.discountId.split("-"):[],ye=(ee=h==null?void 0:h.discountConfig)==null?void 0:ee.find(Be=>`${Be.name}-${Be.value}-${Be.type}`===Q.discountId),ze=d.map(Be=>{const ut=Be._id||Be.id;if(!ut)throw new Error(`Invalid stall ID for stall number ${Be.number}`);return{stall:Be,stallId:ut,baseAmount:q(Be)}}),qe=ze.reduce((Be,{baseAmount:ut})=>Be+ut,0),Ft=ze.map(({stall:Be,stallId:ut,baseAmount:Ct})=>{const jr=ye?D(Ct,qe,ye):0;return{stallId:ut,number:Be.number,baseAmount:Ct,discount:ye?{name:ye.name,type:ye.type,value:ye.value,amount:jr}:void 0,amountAfterDiscount:Math.round((Ct-jr)*100)/100}}),tr=Ft.reduce((Be,ut)=>{var Ct;return Be+(((Ct=ut.discount)==null?void 0:Ct.amount)||0)},0),dr=Math.round((qe-tr)*100)/100,Fn=((ce=h==null?void 0:h.taxConfig)==null?void 0:ce.filter(Be=>Be.isActive).map(Be=>({name:Be.name,rate:Be.rate,amount:Math.round(dr*Be.rate/100*100)/100})))||[],Fe=Fn.reduce((Be,ut)=>Be+ut.amount,0),$e=Math.round((dr+Fe)*100)/100,Ke={exhibitionId:Q.exhibitionId,exhibitorId:Q.exhibitorId,stallIds:Ft.map(Be=>Be.stallId),customerName:Ie.contactPerson,customerEmail:Ie.email,customerPhone:Ie.phone,customerAddress:Ie.address||"N/A",customerGSTIN:Ie.gstNumber||"N/A",customerPAN:Ie.panNumber||"N/A",companyName:Ie.companyName,discount:ye?{name:ye.name,type:ye.type,value:ye.value}:void 0,amount:$e,calculations:{stalls:Ft,totalBaseAmount:qe,totalDiscountAmount:tr,totalAmountAfterDiscount:dr,taxes:Fn,totalTaxAmount:Fe,totalAmount:$e}};w.length&&(Ke.basicAmenities=w.filter(Be=>Be.calculatedQuantity>0).map(Be=>({name:Be.name,type:Be.type,perSqm:Be.perSqm,quantity:Be.quantity,calculatedQuantity:Be.calculatedQuantity,description:Be.description}))),g.length&&(Ke.extraAmenities=B());const Oe=await j(so(Ke)).unwrap();Oe&&Oe.invoiceId?(be.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{E(`/invoice/${Oe.invoiceId}`)},2e3)):(be.success("Booking created successfully"),E("/bookings")),Oe&&Oe.warning&&be.warning(Oe.warning)}catch(Ie){console.error("Error creating booking:",Ie),be.error("Failed to create booking")}},J=async Q=>{try{const ee=await ir.createExhibitor(Q);be.success("Exhibitor added successfully"),j(ln()),e.setFieldsValue({exhibitorId:ee.data._id}),s(!1),t.resetFields()}catch(ee){const ce=(ee==null?void 0:ee.message)||"Failed to add exhibitor";be.error(ce),ce==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},ne=C.map(Q=>({label:Q.name,value:Q._id||Q.id})),Z=A.map(Q=>({label:Q.companyName,value:Q._id}));i.map(Q=>({label:`Stall ${Q.number} (${Q.dimensions.width}m × ${Q.dimensions.height}m = ${(Q.dimensions.width*Q.dimensions.height).toFixed(2)} sqm) - ₹${Q.ratePerSqm.toLocaleString()}/sq.m`,value:Q._id||Q.id}));const R=Q=>{p(Q),e.setFieldValue("discountId",Q)},U=()=>{var ye,ze;const Q=d.reduce((qe,Ft)=>qe+q(Ft),0),ee=(ye=h==null?void 0:h.discountConfig)==null?void 0:ye.find(qe=>`${qe.name}-${qe.value}-${qe.type}`===u&&qe.isActive),ce=ee?ee.type==="percentage"?Math.round(Q*ee.value/100*100)/100:Math.min(ee.value,Q):0,Ie=Math.round((Q-ce)*100)/100,re=((ze=h==null?void 0:h.taxConfig)==null?void 0:ze.filter(qe=>qe.isActive).map(qe=>({name:qe.name,rate:qe.rate,amount:Math.round(Ie*qe.rate/100*100)/100})))||[],_e=re.reduce((qe,Ft)=>qe+Ft.amount,0),Ne=Math.round((Ie+_e)*100)/100;return{baseAmount:Q,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:Ie,taxes:re,totalTaxAmount:_e,totalAmount:Ne}},B=()=>{var Q;return(Q=h==null?void 0:h.amenities)!=null&&Q.length?h.amenities.filter(ee=>{const ce=ee._id||ee.id;return ce&&g.includes(ce.toString())}).map(ee=>{const ce=(ee._id||ee.id).toString();return{id:ce,name:ee.name,type:ee.type,rate:ee.rate,description:ee.description,quantity:m[ce]||1}}):[]},F=Q=>{const ee={...m};Q.forEach(ce=>{g.includes(ce)||(ee[ce]=1)}),Object.keys(ee).forEach(ce=>{Q.includes(ce)||delete ee[ce]}),v(ee),f(Q)},V=(Q,ee)=>{v(ce=>({...ce,[Q]:ee}))};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{span:24,children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(fb,{level:2,style:{margin:0},children:"Create Booking"}),n.jsx(Le.Text,{type:"secondary",children:"Create a new stall booking"})]})}),n.jsx(K,{span:24,children:n.jsx(de,{children:n.jsx(H,{form:e,layout:"vertical",onFinish:M,style:{maxWidth:800},children:n.jsxs(Ce,{gutter:16,children:[n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:n.jsx(Pe,{placeholder:"Select exhibition",loading:T,options:ne,onChange:N})})}),n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"exhibitorId",label:n.jsxs(ue,{children:[n.jsx("span",{children:"Exhibitor"}),n.jsx(te,{type:"link",icon:n.jsx(fr,{}),onClick:()=>s(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:n.jsx(Pe,{showSearch:!0,placeholder:"Select exhibitor",loading:I,options:Z,filterOption:(Q,ee)=>{var ce;return(((ce=ee==null?void 0:ee.label)==null?void 0:ce.toString())??"").toLowerCase().includes(Q.toLowerCase())}})})}),n.jsx(K,{span:24,children:n.jsx(H.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:n.jsx(Pe,{mode:"multiple",placeholder:o?"Loading stalls...":"Select stalls",loading:o,onChange:L,options:i.map(Q=>({label:`Stall ${Q.number} (${Q.dimensions.width}m × ${Q.dimensions.height}m = ${(Q.dimensions.width*Q.dimensions.height).toFixed(2)} sqm) - ₹${Q.ratePerSqm.toLocaleString()}/sq.m`,value:Q._id||Q.id}))})})}),d.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(K,{span:24,children:n.jsx(de,{title:"Selected Stalls Summary",size:"small",children:n.jsx(tt,{dataSource:d.map(Q=>({...Q,key:Q._id||Q.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(Q,ee)=>{var ce,Ie;return((ce=ee.stallType)==null?void 0:ce.name)||(typeof ee.stallTypeId=="object"?(Ie=ee.stallTypeId)==null?void 0:Ie.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(Q,ee)=>`${ee.dimensions.width}m × ${ee.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(Q,ee)=>(ee.dimensions.width*ee.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:Q=>`₹${Q.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(Q,ee)=>`₹${q(ee).toLocaleString()}`}],summary:()=>{const Q=d.reduce((ee,ce)=>ee+q(ce),0);return n.jsxs(tt.Summary.Row,{children:[n.jsx(tt.Summary.Cell,{index:0,colSpan:5,children:n.jsx("strong",{children:"Total Base Amount"})}),n.jsx(tt.Summary.Cell,{index:1,children:n.jsxs("strong",{children:["₹",Q.toLocaleString()]})})]},"summary")}})})}),n.jsx(K,{span:24,children:n.jsx(de,{title:"Stall Amenities",size:"small",children:n.jsxs(Ce,{gutter:[16,24],children:[n.jsxs(K,{span:24,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Le.Title,{level:5,style:{margin:0},children:n.jsxs(ue,{children:[n.jsx("span",{children:"Included Basic Amenities"}),n.jsx(Se,{color:"green",children:"Based on stall area"})]})}),n.jsxs(Le.Text,{type:"secondary",children:["The following amenities are included based on your total stall area of ",y.toFixed(2)," sqm."]})]}),(se=h==null?void 0:h.basicAmenities)!=null&&se.length?n.jsx(tt,{dataSource:w.filter(Q=>Q.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(Q,ee)=>n.jsxs(ue,{children:[n.jsx(Le.Text,{strong:!0,children:Q}),n.jsx(Se,{color:"blue",children:ee.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:Q=>n.jsxs(Se,{color:"green",children:[Q," ",Q===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(Q,ee)=>n.jsx(ct,{title:ee.description,children:n.jsxs(Le.Text,{type:"secondary",children:[n.jsx(Jr,{style:{marginRight:5}}),"1 ",ee.quantity>1?`set of ${ee.quantity}`:"unit"," per ",Q," sqm"]})})},{title:"Status",key:"status",width:100,align:"right",render:()=>n.jsx(Le.Text,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:n.jsx(Le.Text,{children:"No basic amenities qualify based on the selected stall area."})}}):n.jsx(Le.Text,{type:"secondary",children:"No basic amenities have been configured for this exhibition."})]}),n.jsxs(K,{span:24,children:[n.jsx(nt,{style:{margin:"12px 0 24px"}}),n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Le.Title,{level:5,style:{margin:0},children:n.jsxs(ue,{children:[n.jsx("span",{children:"Additional Amenities"}),n.jsx(Se,{color:"blue",children:"Optional"})]})}),n.jsx(Le.Text,{type:"secondary",children:"Select any additional amenities for the booking."})]}),(xe=h==null?void 0:h.amenities)!=null&&xe.length?n.jsxs(n.Fragment,{children:[n.jsx(H.Item,{name:"extraAmenities",label:"Select Additional Amenities",children:n.jsx(Pe,{mode:"multiple",placeholder:"Select amenities",style:{width:"100%"},onChange:F,optionLabelProp:"label",options:h.amenities.map(Q=>({label:`${Q.name} (${Q.rate?`₹${Q.rate.toLocaleString()}`:"N/A"})`,value:Q._id||Q.id,key:Q._id||Q.id}))})}),g.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Le.Text,{strong:!0,children:"Selected Amenities:"}),n.jsx(tt,{dataSource:B(),columns:[{title:"Name",dataIndex:"name",key:"name",render:(Q,ee)=>n.jsxs(ue,{align:"center",children:[n.jsx(Le.Text,{strong:!0,children:Q}),n.jsx(Se,{color:"blue",children:ee.type}),n.jsx(Le.Text,{type:"secondary",style:{fontSize:"13px"},children:ee.description||""})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:Q=>n.jsxs(Le.Text,{strong:!0,style:{color:"#1890ff"},children:["₹",Q.toLocaleString("en-IN")]})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(Q,ee)=>n.jsx(yt,{min:1,value:m[ee.id]||1,onChange:ce=>V(ee.id,ce||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,align:"right",render:(Q,ee)=>{const ce=m[ee.id]||1,Ie=ee.rate*ce;return n.jsxs(Le.Text,{strong:!0,style:{color:"#1890ff"},children:["₹",Ie.toLocaleString("en-IN")]})}}],pagination:!1,size:"small"})]})]}):n.jsx(Le.Text,{type:"secondary",children:"No additional amenities have been configured for this exhibition."})]})]})})}),n.jsx(K,{span:24,children:n.jsxs(de,{title:"Price Calculations",size:"small",children:[n.jsx(Ce,{gutter:[16,16],children:n.jsx(K,{span:12,children:n.jsx(H.Item,{name:"discountId",label:"Available Discounts",children:n.jsx(Pe,{placeholder:"Select discount",allowClear:!0,onChange:R,options:(me=h==null?void 0:h.discountConfig)==null?void 0:me.map(Q=>({label:`${Q.name} (${Q.type==="percentage"?Q.value+"%":"₹"+Q.value})${Q.isActive?"":" - Inactive"}`,value:`${Q.name}-${Q.value}-${Q.type}`,disabled:!Q.isActive}))})})})}),n.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:n.jsx(ue,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:Q,selectedDiscount:ee,discountAmount:ce,amountAfterDiscount:Ie,taxes:re,totalAmount:_e}=U();return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(en,{children:"Total Base Amount:"}),n.jsxs(en,{children:["₹",Q.toLocaleString()]})]}),ee&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(en,{children:["Discount (",ee.type==="percentage"?`${ee.value}%`:`₹${ee.value.toLocaleString()}`,"):"]}),n.jsxs(en,{type:"danger",children:["-₹",ce.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(en,{children:"Amount after Discount:"}),n.jsxs(en,{children:["₹",Ie.toLocaleString()]})]}),n.jsx(nt,{style:{margin:"8px 0"}}),re.map(Ne=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(en,{children:[Ne.name," (",Ne.rate,"%):"]}),n.jsxs(en,{children:["₹",Ne.amount.toLocaleString()]})]},`tax-${Ne.name}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(en,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(en,{strong:!0,children:["₹",_e.toLocaleString()]})]})]})})()})})]})})]}),n.jsx(K,{span:24,children:n.jsx(H.Item,{children:n.jsxs(ue,{children:[n.jsx(te,{type:"primary",htmlType:"submit",loading:S,children:"Create Booking"}),n.jsx(te,{onClick:()=>E("/bookings"),children:"Cancel"})]})})})]})})})})]}),n.jsx(Ve,{title:n.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:r,onCancel:()=>{s(!1),t.resetFields()},width:800,footer:n.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[n.jsx(te,{onClick:()=>{s(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),n.jsx(te,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:n.jsx(H,{form:t,layout:"vertical",onFinish:J,requiredMark:!1,children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(he.TextArea,{rows:3})}),n.jsx(H.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"status",label:"Status",initialValue:"active",children:n.jsxs(Pe,{children:[n.jsx(Pe.Option,{value:"active",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),n.jsx(Pe.Option,{value:"inactive",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(he,{placeholder:"ABCDE1234F"})}),n.jsx(H.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(he,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})},pb=()=>{const{id:e}=Fr(),t=Je(),{data:r,isLoading:s}=nb(e||""),[i,a]=k.useState(!1),[o,l]=k.useState(!1),[d]=H.useForm(),[c,h]=k.useState(0),[x,u]=k.useState(!1),p=async()=>{if(e)try{u(!0),h(0),be.loading({content:"Preparing invoice...",key:"download"});const m=await Cu(`/invoices/${e}/download?force=false`,!1,_=>{const y=_.total,b=_.loaded;if(y){const E=Math.round(b*100/y);h(E),E%25===0&&be.loading({content:`Downloading: ${E}% complete`,key:"download"})}}),v=window.URL.createObjectURL(new Blob([m.data])),w=document.createElement("a");w.href=v,w.setAttribute("download",`invoice-${e}.pdf`),document.body.appendChild(w),w.click(),w.remove(),window.URL.revokeObjectURL(v),be.success({content:"Invoice downloaded successfully",key:"download"})}catch(m){console.error("Download error:",m),be.error({content:"Failed to download invoice",key:"download"})}finally{u(!1),h(0)}},g=async m=>{try{await Ee.post(`/invoices/${e}/share/email`,m),be.success("Invoice shared via email successfully"),a(!1),d.resetFields()}catch(v){console.error("Email sharing error:",v),be.error("Failed to share invoice via email")}},f=async m=>{try{await Ee.post(`/invoices/${e}/share/whatsapp`,m),be.success("Invoice shared via WhatsApp successfully"),l(!1),d.resetFields()}catch(v){console.error("WhatsApp sharing error:",v),be.error("Failed to share invoice via WhatsApp")}};return s||!r?n.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",r),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(de,{title:"Invoice Details",extra:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(te,{icon:n.jsx(Gn,{}),onClick:()=>t(-1),disabled:x,children:"Back"}),n.jsx(te,{type:"primary",icon:n.jsx(Po,{}),onClick:p,loading:x&&c<100,disabled:x&&c>=100,children:"Download"}),n.jsx(te,{icon:n.jsx(un,{}),onClick:()=>a(!0),disabled:x,children:"Share via Email"}),n.jsx(te,{icon:n.jsx(gu,{}),onClick:()=>l(!0),disabled:x,children:"Share via WhatsApp"})]}),x&&n.jsx(Yr,{percent:c,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:n.jsx(df,{booking:{...r.bookingId,customerGSTIN:r.bookingId.customerGSTIN||"",invoiceNumber:r.invoiceNumber,exhibitionId:{...r.bookingId.exhibitionId,companyName:r.bookingId.exhibitionId.companyName||"Company Name",bankName:r.bookingId.exhibitionId.bankName||"",bankAccount:r.bookingId.exhibitionId.bankAccount||"",bankAccountName:r.bookingId.exhibitionId.bankAccountName||"",bankBranch:r.bookingId.exhibitionId.bankBranch||"",bankIFSC:r.bookingId.exhibitionId.bankIFSC||"",companyCIN:r.bookingId.exhibitionId.companyCIN||"",companyPAN:r.bookingId.exhibitionId.companyPAN||"",companySAC:r.bookingId.exhibitionId.companySAC||"",companyGST:r.bookingId.exhibitionId.companyGST||"",companyEmail:r.bookingId.exhibitionId.companyEmail||"",companyWebsite:r.bookingId.exhibitionId.companyWebsite||"",companyAddress:r.bookingId.exhibitionId.companyAddress||"",headerLogo:r.bookingId.exhibitionId.headerLogo||void 0},calculations:{...r.bookingId.calculations,stalls:r.bookingId.calculations.stalls.map(m=>({discount:m.discount?{...m.discount,type:m.discount.type||"percentage",value:m.discount.value}:void 0}))}}})}),n.jsx(Ve,{title:"Share Invoice via Email",open:i,onCancel:()=>a(!1),footer:null,children:n.jsxs(H,{form:d,onFinish:g,layout:"vertical",children:[n.jsx(H.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(he,{placeholder:"Enter email address"})}),n.jsx(H.Item,{name:"message",label:"Message (Optional)",children:n.jsx(he.TextArea,{placeholder:"Enter optional message"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(Ve,{title:"Share Invoice via WhatsApp",open:o,onCancel:()=>l(!1),footer:null,children:n.jsxs(H,{form:d,onFinish:f,layout:"vertical",children:[n.jsx(H.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:n.jsx(he,{placeholder:"Enter phone number with country code"})}),n.jsx(H.Item,{children:n.jsx(te,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:mb,Text:As}=Le,{Option:ka}=Pe,{RangePicker:gb}=xs,yb=()=>{var Q;const e=Je(),t=it(),[r,s]=k.useState(1),[i,a]=k.useState(10),[o,l]=k.useState(""),[d,c]=k.useState(null),[h,x]=k.useState(null),[u,p]=k.useState(null),[g,f]=k.useState(!1),[m,v]=k.useState(null),[w,_]=k.useState(""),[y,b]=k.useState(""),[E,j]=k.useState("createdAt"),[S,C]=k.useState("descend"),[T,A]=be.useMessage(),[I,P]=k.useState(null),[N,q]=k.useState(0),{exhibitions:L,loading:D}=Me(ee=>ee.exhibition);k.useEffect(()=>{t(Lr())},[t]);const{data:M,isLoading:J,refetch:ne}=vf({page:r,limit:i}),[Z,{isLoading:R}]=sb(),U=xt.useMemo(()=>M!=null&&M.data?M.data.filter(ee=>{const ce=o.toLowerCase(),Ie=o===""||ee.invoiceNumber&&ee.invoiceNumber.toLowerCase().includes(ce)||ee._id.toLowerCase().includes(ce)||ee.bookingId.customerName&&ee.bookingId.customerName.toLowerCase().includes(ce)||ee.bookingId.companyName&&ee.bookingId.companyName.toLowerCase().includes(ce),re=!d||ee.status===d,_e=!h||ee.bookingId.exhibitionId&&ee.bookingId.exhibitionId._id===h;let Ne=!0;if(u&&u[0]&&u[1]){const ye=et(ee.createdAt);Ne=ye.isAfter(u[0])&&ye.isBefore(u[1])}return Ie&&re&&_e&&Ne}):[],[M,o,d,h,u]),B=async ee=>{try{P(ee),q(0),T.loading({content:"Preparing invoice...",key:ee});const ce=await Cu(`/invoices/${ee}/download?force=false`,!1,_e=>{const Ne=_e.total,ye=_e.loaded;if(Ne){const ze=Math.round(ye*100/Ne);q(ze),ze%25===0&&T.loading({content:`Downloading: ${ze}% complete`,key:ee})}}),Ie=window.URL.createObjectURL(new Blob([ce.data])),re=document.createElement("a");re.href=Ie,re.setAttribute("download",`invoice-${ee}.pdf`),document.body.appendChild(re),re.click(),re.remove(),window.URL.revokeObjectURL(Ie),T.success({content:"Invoice downloaded successfully",key:ee})}catch(ce){console.error("Download error:",ce),T.error({content:"Failed to download invoice",key:ee})}finally{P(null),q(0)}},F=async()=>{if(!(!m||!w))try{T.loading({content:"Sending email...",key:"email"}),await Z({id:m,email:w,message:y||void 0}).unwrap(),T.success({content:"Invoice sent via email successfully",key:"email"}),f(!1),_(""),b(""),v(null)}catch(ee){console.error("Email error:",ee),T.error({content:"Failed to send invoice via email",key:"email"})}},V=ee=>{v(ee),f(!0)},se=()=>{l(""),c(null),x(null),p(null)},xe=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:E==="invoiceNumber"?S:null,render:(ee,ce)=>n.jsx("a",{onClick:()=>e(`/invoice/${ce._id}`),children:ee||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:E==="companyName"?S:null,render:ee=>ee||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:E==="exhibitionName"?S:null,render:(ee,ce)=>n.jsx("a",{onClick:()=>e(`/exhibition/${ce.bookingId.exhibitionId._id}`),children:ee})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:E==="amount"?S:null,render:ee=>`₹${ee.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:E==="status"?S:null,render:ee=>n.jsx(Se,{color:ee==="paid"?"green":ee==="pending"?"gold":ee==="cancelled"?"red":"blue",children:ee.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:E==="dueDate"?S:null,render:ee=>ee?et(ee).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:E==="createdAt"?S:null,render:ee=>et(ee).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(ee,ce)=>n.jsxs(ue,{direction:"vertical",size:"small",style:{width:"100%"},children:[n.jsxs(ue,{children:[n.jsx(ct,{title:"View Invoice",children:n.jsx(te,{type:"text",icon:n.jsx(dn,{}),onClick:()=>e(`/invoice/${ce._id}`)})}),n.jsx(ct,{title:"Download",children:n.jsx(te,{type:"text",icon:n.jsx(Po,{}),onClick:()=>B(ce._id),loading:I===ce._id&&N<100,disabled:I!==null&&I!==ce._id})}),n.jsx(ct,{title:"Email",children:n.jsx(te,{type:"text",icon:n.jsx(un,{}),onClick:()=>V(ce._id),disabled:I!==null})})]}),I===ce._id&&n.jsx(Yr,{percent:N,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],me=(ee,ce,Ie)=>{Ie&&Ie.field&&(j(Ie.field),C(Ie.order||"descend"))};return n.jsxs(Yt,{children:[A,n.jsxs("div",{className:"invoice-list-container",children:[n.jsx(de,{children:n.jsxs(ue,{direction:"vertical",style:{width:"100%"},size:"large",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(mb,{level:2,style:{margin:0},children:"Invoices"}),n.jsx(ue,{children:n.jsx(ct,{title:"Refresh",children:n.jsx(te,{icon:n.jsx(Xs,{}),onClick:()=>ne(),loading:J})})})]}),n.jsx(de,{size:"small",title:n.jsxs(ue,{children:[n.jsx(Gi,{})," Filters"]}),children:n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[n.jsxs("div",{style:{minWidth:"200px",flex:1},children:[n.jsx(As,{strong:!0,children:"Search"}),n.jsx(he,{placeholder:"Search by invoice #, company...",value:o,onChange:ee=>l(ee.target.value),prefix:n.jsx(kn,{}),allowClear:!0})]}),n.jsxs("div",{style:{minWidth:"150px"},children:[n.jsx(As,{strong:!0,children:"Status"}),n.jsxs(Pe,{style:{width:"100%"},placeholder:"Filter by status",value:d,onChange:c,allowClear:!0,children:[n.jsx(ka,{value:"pending",children:"Pending"}),n.jsx(ka,{value:"paid",children:"Paid"}),n.jsx(ka,{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{style:{minWidth:"200px"},children:[n.jsx(As,{strong:!0,children:"Exhibition"}),n.jsx(Pe,{style:{width:"100%"},placeholder:"Filter by exhibition",value:h,onChange:x,loading:D,allowClear:!0,children:L.map(ee=>n.jsx(ka,{value:ee._id||ee.id,children:ee.name},ee._id||ee.id))})]}),n.jsxs("div",{style:{minWidth:"300px"},children:[n.jsx(As,{strong:!0,children:"Date Range"}),n.jsx(gb,{style:{width:"100%"},value:u,onChange:p})]}),n.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:n.jsx(te,{icon:n.jsx(Vx,{}),onClick:se,children:"Clear Filters"})})]})}),n.jsx(tt,{columns:xe,dataSource:U,rowKey:"_id",loading:J,pagination:{current:r,pageSize:i,total:((Q=M==null?void 0:M.pagination)==null?void 0:Q.total)||0,onChange:(ee,ce)=>{s(ee),ce&&a(ce)},showSizeChanger:!0,showTotal:ee=>`Total ${ee} invoices`},onChange:me})]})}),n.jsxs(Ve,{title:"Send Invoice via Email",open:g,onCancel:()=>f(!1),onOk:F,okText:"Send",confirmLoading:R,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(As,{strong:!0,children:"Email Address"}),n.jsx(he,{placeholder:"Enter recipient email",value:w,onChange:ee=>_(ee.target.value),style:{width:"100%"}})]}),n.jsxs("div",{children:[n.jsx(As,{strong:!0,children:"Message (Optional)"}),n.jsx(he.TextArea,{placeholder:"Enter optional message",value:y,onChange:ee=>b(ee.target.value),rows:4})]})]})]})]})},{Title:Ut,Paragraph:$t,Text:Ca}=Le,{Content:vb}=kt,bb=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;return t.includes("logos/")||t.includes("sponsors/")?`${Ee.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},wb=ve(vb)`
  padding-top: 64px;
`,jb=ve.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,Sb=ve.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,Eb=ve.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,Is=ve(de)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Tb=ve(de)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,xi=ve(Ut)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Ns=ve.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,Aa=ve.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,wh=ve.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,_b=ve(Se)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,jh=ve(te)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,pi=ve.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;ve.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const kb=()=>{const e=Je(),t=it(),[r,s]=k.useState([]),[i,a]=k.useState(!0);k.useEffect(()=>{(async()=>{try{a(!0);const h=await Ar.getExhibitions();s(h.data.slice(0,4))}catch(h){console.error("Failed to fetch exhibitions:",h)}finally{a(!1)}})()},[]);const o=c=>{const h={year:"numeric",month:"short",day:"numeric"};return new Date(c).toLocaleDateString(void 0,h)},l=(c,h)=>{const x=new Date,u=new Date(c),p=new Date(h);return x<u?{status:"Upcoming",color:"#722ED1"}:x>p?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},d=()=>{t(cs(void 0))};return n.jsxs(kt,{children:[n.jsx(Vr,{}),n.jsxs(wb,{children:[n.jsxs(jb,{children:[n.jsx(Sb,{}),n.jsx(Eb,{children:n.jsxs(Ce,{gutter:[48,48],align:"middle",children:[n.jsxs(K,{xs:24,lg:14,children:[n.jsx(Ut,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),n.jsx($t,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),n.jsx(ue,{size:16,wrap:!0,children:n.jsx(jh,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Zl,{}),children:"Explore Exhibitions"})})]}),n.jsx(K,{xs:24,lg:10,children:n.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:c=>{const h=c.target;h.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",h.onerror=()=>{h.style.height="300px",h.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",h.onerror=null;const x=h.parentElement;if(x){const u=document.createElement("div");u.style.position="absolute",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)",u.style.color="white",u.style.fontSize="18px",u.style.fontWeight="bold",u.style.textAlign="center",u.textContent="Exhibition Venue",x.appendChild(u)}}}})})]})})]}),n.jsx(pi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"Featured Exhibitions"}),i?n.jsx(Ce,{gutter:[24,24],children:[1,2,3,4].map(c=>n.jsx(K,{xs:24,sm:12,lg:6,children:n.jsx(de,{style:{borderRadius:"12px"},children:n.jsx(on,{active:!0,avatar:!0,paragraph:{rows:3}})})},c))}):r.length>0?n.jsx(Ce,{gutter:[24,24],children:r.map((c,h)=>{const{status:x,color:u}=l(c.startDate,c.endDate);return n.jsx(K,{xs:24,sm:12,lg:6,children:n.jsxs(Tb,{onClick:()=>e(qo(c)),cover:n.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[n.jsx("img",{alt:c.name,src:c.headerLogo?bb(c.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0.95)"}}),n.jsx(Se,{color:u,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:x}),h===0&&n.jsx(_b,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[n.jsx(Ut,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:c.name}),n.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[n.jsx(Hr,{style:{color:"#4158D0"}}),n.jsxs(Ca,{type:"secondary",style:{fontSize:13},children:[o(c.startDate)," - ",o(c.endDate)]})]}),c.venue&&n.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(os,{style:{color:"#C850C0"}}),n.jsx(Ca,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:c.venue})]}),n.jsx(te,{type:"link",style:{padding:0,height:"auto"},icon:n.jsx(Zl,{}),children:"View Details"})]})},c._id)})}):n.jsx("div",{style:{textAlign:"center",padding:40},children:n.jsx($t,{children:"No exhibitions available at the moment. Check back soon!"})}),n.jsx("div",{style:{textAlign:"center",marginTop:40},children:n.jsx(te,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Gx,{}),children:"View All Exhibitions"})})]})}),n.jsx(pi,{className:"how-it-works",children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"How to Book Stall"}),n.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:n.jsx($t,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),n.jsxs("div",{className:"booking-steps",children:[n.jsx("div",{className:"step-indicator",children:n.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(c=>n.jsxs("div",{className:"step-dot-container",children:[n.jsx("div",{className:"step-dot",children:c}),n.jsx("div",{className:"step-label",children:`Step ${c}`})]},c)),n.jsx("div",{className:"step-progress-line"})]})}),n.jsxs(Ce,{gutter:[24,24],style:{marginTop:40},children:[n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx(at,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Register"}),n.jsx($t,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Approval"}),n.jsx($t,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx(yr,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Login & Book Stall"}),n.jsx($t,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"4"}),n.jsx("div",{className:"step-icon",children:n.jsx(Vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Goes to Reserved"}),n.jsx($t,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"5"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Final Approval"}),n.jsx($t,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"6"}),n.jsx("div",{className:"step-icon",children:n.jsx(vt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Becomes Booked"}),n.jsx($t,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),n.jsx(K,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"7"}),n.jsx("div",{className:"step-icon",children:n.jsx(pd,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Make Payment in 3 Days"}),n.jsx($t,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),n.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),n.jsx("div",{style:{textAlign:"center",marginTop:60},children:n.jsx(jh,{type:"primary",size:"large",onClick:d,icon:n.jsx(at,{}),children:"Register as Exhibitor"})})]})}),n.jsx(pi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(xi,{level:2,children:"Why Choose Us"}),n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:n.jsx(ps,{})}),n.jsx(Ut,{level:4,children:"Interactive Layouts"}),n.jsx($t,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:n.jsx(yr,{})}),n.jsx(Ut,{level:4,children:"Real-time Availability"}),n.jsx($t,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:n.jsx(pd,{})}),n.jsx(Ut,{level:4,children:"Secure Payments"}),n.jsx($t,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:n.jsx(vc,{})}),n.jsx(Ut,{level:4,children:"Exhibitor Dashboard"}),n.jsx($t,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:n.jsx(Hr,{})}),n.jsx(Ut,{level:4,children:"Schedule Management"}),n.jsx($t,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),n.jsx(K,{xs:24,sm:12,lg:8,children:n.jsxs(Is,{children:[n.jsx(Ns,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:n.jsx(vt,{})}),n.jsx(Ut,{level:4,children:"Support & Assistance"}),n.jsx($t,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),n.jsx(pi,{className:"gray-bg",children:n.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:n.jsxs(Ce,{gutter:[48,48],children:[n.jsxs(K,{xs:24,lg:12,children:[n.jsx(xi,{level:2,children:"Our Impact"}),n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),n.jsx(K,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),n.jsx(K,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),n.jsx(K,{xs:12,children:n.jsx(Aa,{children:n.jsx(Xe,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),n.jsxs(K,{xs:24,lg:12,children:[n.jsx(xi,{level:2,children:"What Exhibitors Say"}),n.jsxs(Yx,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[n.jsx("div",{children:n.jsxs(wh,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Br,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#4158D0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Sarah Johnson"}),n.jsx(Ca,{type:"secondary",children:"Tech Innovations Inc."})]})]}),n.jsx($t,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),n.jsx("div",{children:n.jsxs(wh,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Br,{size:64,icon:n.jsx(at,{}),style:{backgroundColor:"#C850C0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Michael Chen"}),n.jsx(Ca,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),n.jsx($t,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),n.jsx(pi,{style:{padding:"60px 0"},children:n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[n.jsx(Ut,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),n.jsx($t,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),n.jsxs(ue,{size:16,wrap:!0,style:{justifyContent:"center"},children:[n.jsx(te,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>e("/exhibitions"),icon:n.jsx(yr,{}),children:"Browse Exhibitions"}),n.jsx(te,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:d,icon:n.jsx(at,{}),children:"Register as Exhibitor"})]})]})})]}),n.jsx(gf,{})]})},{Title:Cb,Text:Ze,Paragraph:Ab}=Le,{Option:Ia}=Pe,{TextArea:Sh,Search:Ib}=he,{RangePicker:Nb}=xs,Fb=()=>{const e=it(),{exhibitors:t,loading:r}=Me(F=>F.exhibitor),[s,i]=k.useState(null),[a,o]=k.useState(!1),[l,d]=k.useState(!1),[c,h]=k.useState(!1),[x,u]=k.useState("approved"),[p,g]=k.useState(""),[f,m]=k.useState(!1),[v,w]=k.useState(!1),[_,y]=k.useState(!1),[b,E]=k.useState(""),[j,S]=k.useState([]),[C]=H.useForm(),[T,A]=k.useState([]);T.length>0;const[I,P]=k.useState({total:0,pending:0,approved:0,rejected:0});k.useEffect(()=>{e(ln())},[e]),k.useEffect(()=>{if(t!=null&&t.length){S(t);const F={total:t.length,pending:t.filter(V=>V.status==="pending").length,approved:t.filter(V=>V.status==="approved").length,rejected:t.filter(V=>V.status==="rejected").length};P(F)}},[t]),k.useEffect(()=>{s&&l&&C.setFieldsValue({companyName:s.companyName,contactPerson:s.contactPerson,email:s.email,phone:s.phone,address:s.address||"",website:s.website||"",description:s.description||"",isActive:s.isActive})},[s,l,C]);const N=F=>{switch(F){case"approved":return n.jsx(Se,{color:"success",children:"Approved"});case"pending":return n.jsx(Se,{color:"warning",children:"Pending"});case"rejected":return n.jsx(Se,{color:"error",children:"Rejected"});default:return n.jsx(Se,{children:"Unknown"})}},q=async()=>{var F,V;if(s)try{m(!0),await ir.updateStatus(s._id,x,x==="rejected"?p:void 0),be.success(`Exhibitor status updated to ${x}`),o(!1),e(ln())}catch(se){be.error(((V=(F=se.response)==null?void 0:F.data)==null?void 0:V.message)||"Failed to update exhibitor status")}finally{m(!1)}},L=async F=>{var V,se;if(s)try{w(!0),await ir.updateExhibitor(s._id,F),be.success("Exhibitor details updated successfully"),d(!1),e(ln())}catch(xe){be.error(((se=(V=xe.response)==null?void 0:V.data)==null?void 0:se.message)||"Failed to update exhibitor details")}finally{w(!1)}},D=async F=>{var V,se;try{y(!0),await ir.deleteExhibitor(F),be.success("Exhibitor deleted successfully"),e(ln())}catch(xe){be.error(((se=(V=xe.response)==null?void 0:V.data)==null?void 0:se.message)||"Failed to delete exhibitor")}finally{y(!1)}},M=F=>{if(E(F),!F){S(t);return}const V=F.toLowerCase(),se=t.filter(xe=>xe.companyName.toLowerCase().includes(V)||xe.contactPerson.toLowerCase().includes(V)||xe.email.toLowerCase().includes(V)||xe.phone.toLowerCase().includes(V));S(se)},J=F=>{if(F==="all"){S(t);return}const V=t.filter(se=>se.status===F);S(V)},ne=F=>{if(!F||F.length!==2){S(t);return}const V=F[0].startOf("day").toISOString(),se=F[1].endOf("day").toISOString(),xe=t.filter(me=>{const Q=new Date(me.createdAt).toISOString();return Q>=V&&Q<=se});S(xe)},Z=()=>{const F=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],V=j.map(ee=>[ee.companyName,ee.contactPerson,ee.email,ee.phone,ee.status,ee.isActive?"Yes":"No",new Date(ee.createdAt).toLocaleDateString(),ee.address||"",ee.website||""]);V.unshift(F);const se=V.map(ee=>ee.map(ce=>typeof ce=="string"&&(ce.includes(",")||ce.includes('"')||ce.includes(`
`))?`"${ce.replace(/"/g,'""')}"`:ce).join(",")).join(`
`),xe=new Blob([se],{type:"text/csv;charset=utf-8;"}),me=URL.createObjectURL(xe),Q=document.createElement("a");Q.setAttribute("href",me),Q.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),Q.style.visibility="hidden",document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),be.success("Exhibitor data exported successfully")},R=()=>{Ve.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${T.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{y(!0);const F=T.map(V=>ir.deleteExhibitor(V.toString()));await Promise.all(F),be.success(`${T.length} exhibitors deleted successfully`),A([]),e(ln())}catch{be.error("Failed to delete some exhibitors")}finally{y(!1)}}})},U={selectedRowKeys:T,onChange:F=>{A(F)}},B=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(F,V)=>F.companyName.localeCompare(V.companyName),filterDropdown:({setSelectedKeys:F,selectedKeys:V,confirm:se,clearFilters:xe})=>n.jsxs("div",{style:{padding:8},children:[n.jsx(he,{placeholder:"Search company or contact",value:V[0],onChange:me=>F(me.target.value?[me.target.value]:[]),onPressEnter:()=>se(),style:{width:188,marginBottom:8,display:"block"}}),n.jsxs(ue,{children:[n.jsx(te,{type:"primary",onClick:()=>se(),icon:n.jsx(kn,{}),size:"small",style:{width:90},children:"Filter"}),n.jsx(te,{onClick:()=>{xe&&xe(),se()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:F=>n.jsx(kn,{style:{color:F?"#1890ff":void 0}}),onFilter:(F,V)=>{const se=String(F).toLowerCase();return V.companyName.toLowerCase().includes(se)||V.contactPerson.toLowerCase().includes(se)},render:(F,V)=>n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:"bold"},children:F}),n.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",V.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(F,V)=>n.jsxs("div",{children:[n.jsx("div",{children:F}),n.jsx("div",{style:{fontSize:"12px"},children:V.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(F,V)=>V.status===F,render:F=>N(F)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(F,V)=>V.isActive===F,render:F=>n.jsx(Se,{color:F?"green":"red",children:F?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(F,V)=>new Date(F.createdAt).getTime()-new Date(V.createdAt).getTime(),render:F=>n.jsx(ct,{title:new Date(F).toLocaleString(),children:new Date(F).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:F=>F?n.jsx("a",{href:F,target:"_blank",rel:"noopener noreferrer",children:F.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(F,V)=>n.jsxs(ue,{children:[n.jsx(ct,{title:"View Details",children:n.jsx(te,{icon:n.jsx(dn,{}),onClick:()=>{i(V),h(!0)}})}),n.jsx(te,{type:"primary",onClick:()=>{i(V),u(V.status),g(V.rejectionReason||""),o(!0)},children:"Update Status"}),n.jsx(Vn,{overlay:n.jsxs(or,{children:[n.jsx(or.Item,{icon:n.jsx(as,{}),onClick:()=>{i(V),d(!0)},children:"Edit"},"edit"),n.jsx(or.Item,{icon:n.jsx(ar,{}),danger:!0,onClick:se=>{se.domEvent.stopPropagation(),Ve.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>D(V._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(te,{icon:n.jsx(Sc,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(Ce,{gutter:[24,24],align:"middle",children:[n.jsx(K,{flex:"auto",children:n.jsxs(ue,{direction:"vertical",size:4,children:[n.jsx(Cb,{level:4,style:{margin:0},children:"Exhibitors"}),n.jsx(Ze,{type:"secondary",children:"Manage exhibitors and their information"})]})}),n.jsx(K,{children:n.jsx(te,{type:"primary",icon:n.jsx(Ni,{}),onClick:()=>d(!0),size:"large",children:"Add Exhibitor"})})]})}),n.jsxs(Ce,{gutter:[16,24],style:{marginBottom:"24px"},children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Total Exhibitors",value:I.total,prefix:n.jsx(at,{})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Pending",value:I.pending,prefix:n.jsx(Vt,{style:{color:"#faad14"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Approved",value:I.approved,prefix:n.jsx(vt,{style:{color:"#52c41a"}})})})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsx(de,{children:n.jsx(Xe,{title:"Rejected",value:I.rejected,prefix:n.jsx(Xr,{style:{color:"#ff4d4f"}})})})})]}),n.jsx(de,{className:"info-card",style:{marginBottom:"24px"},children:n.jsxs(ue,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(Ce,{gutter:[16,16],align:"middle",children:[n.jsx(K,{xs:24,sm:8,md:6,lg:4,children:n.jsx(Ib,{placeholder:"Search exhibitors",allowClear:!0,onSearch:M,style:{width:"100%"}})}),n.jsx(K,{xs:24,sm:8,md:6,lg:4,children:n.jsxs(Pe,{placeholder:"Filter by status",style:{width:"100%"},onChange:J,allowClear:!0,children:[n.jsx(Ia,{value:"all",children:"All Status"}),n.jsx(Ia,{value:"pending",children:"Pending"}),n.jsx(Ia,{value:"approved",children:"Approved"}),n.jsx(Ia,{value:"rejected",children:"Rejected"})]})}),n.jsx(K,{xs:24,sm:8,md:6,lg:6,children:n.jsx(Nb,{style:{width:"100%"},onChange:ne})})]}),T.length>0&&n.jsx(Ce,{children:n.jsxs(ue,{children:[n.jsxs(Ze,{children:["Selected ",T.length," items"]}),n.jsx(te,{danger:!0,onClick:R,children:"Delete Selected"}),n.jsx(te,{type:"primary",onClick:Z,children:"Export Selected"})]})})]})}),n.jsx(de,{className:"info-card",children:n.jsx(tt,{rowSelection:U,dataSource:j,columns:B,rowKey:"_id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(F,V)=>`${V[0]}-${V[1]} of ${F} items`},scroll:{x:1500}})}),n.jsx(Ve,{title:"Exhibitor Details",open:c,onCancel:()=>h(!1),footer:[n.jsx(te,{onClick:()=>h(!1),children:"Close"},"close")],width:600,children:s&&n.jsx("div",{children:n.jsxs(Ce,{gutter:[16,16],children:[n.jsx(K,{span:24,children:n.jsx(de,{title:"Company Information",children:n.jsxs(Ce,{gutter:[16,8],children:[n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Company Name:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.companyName})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Contact Person:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.contactPerson})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Email:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.email})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Phone:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.phone})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Status:"})}),n.jsx(K,{span:12,children:N(s.status)}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Active:"})}),n.jsx(K,{span:12,children:n.jsx(xr,{status:s.isActive?"success":"error",text:s.isActive?"Yes":"No"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Registration Date:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:new Date(s.createdAt).toLocaleString()})})]})})}),n.jsx(K,{span:24,children:n.jsxs(de,{title:"Additional Information",children:[n.jsxs(Ce,{gutter:[16,8],children:[n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Website:"})}),n.jsx(K,{span:12,children:s.website?n.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",children:s.website}):"Not provided"}),s.status==="rejected"&&n.jsxs(n.Fragment,{children:[n.jsx(K,{span:12,children:n.jsx(Ze,{strong:!0,children:"Rejection Reason:"})}),n.jsx(K,{span:12,children:n.jsx(Ze,{type:"danger",children:s.rejectionReason||"No reason provided"})})]})]}),s.description&&n.jsxs(n.Fragment,{children:[n.jsx(nt,{}),n.jsx(Ze,{strong:!0,children:"Description:"}),n.jsx(Ab,{style:{marginTop:8},children:s.description})]})]})})]})})}),n.jsx(Ve,{title:"Update Exhibitor Status",open:a,onCancel:()=>o(!1),footer:null,width:600,children:s&&n.jsxs("div",{children:[n.jsx(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(at,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:n.jsxs(Ce,{gutter:[16,8],children:[n.jsx(K,{span:8,children:n.jsx(Ze,{strong:!0,children:"Company:"})}),n.jsx(K,{span:16,children:n.jsx(Ze,{children:s.companyName})}),n.jsx(K,{span:8,children:n.jsx(Ze,{strong:!0,children:"Contact Person:"})}),n.jsx(K,{span:16,children:n.jsx(Ze,{children:s.contactPerson})}),n.jsx(K,{span:8,children:n.jsx(Ze,{strong:!0,children:"Email:"})}),n.jsx(K,{span:16,children:n.jsx(Ze,{children:s.email})}),n.jsx(K,{span:8,children:n.jsx(Ze,{strong:!0,children:"Address:"})}),n.jsx(K,{span:16,children:n.jsx(Ze,{children:s.address||"Not provided"})}),n.jsx(K,{span:8,children:n.jsx(Ze,{strong:!0,children:"Current Status:"})}),n.jsx(K,{span:16,children:N(s.status)})]})}),n.jsxs(de,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Qs,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Ze,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(mr.Group,{value:x,onChange:F=>u(F.target.value),buttonStyle:"solid",children:[n.jsx(mr.Button,{value:"pending",children:n.jsxs(ue,{children:[n.jsx(Vt,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(mr.Button,{value:"approved",children:n.jsxs(ue,{children:[n.jsx(vt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(mr.Button,{value:"rejected",children:n.jsxs(ue,{children:[n.jsx(Xr,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),x==="rejected"&&n.jsx("div",{children:n.jsx(H.Item,{label:n.jsx(Ze,{strong:!0,children:"Rejection Reason:"}),required:x==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:n.jsx(Sh,{rows:4,value:p,onChange:F=>g(F.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),x==="approved"&&n.jsx(_t,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),x==="pending"&&n.jsx(_t,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(te,{onClick:()=>o(!1),children:"Cancel"}),n.jsx(te,{type:"primary",onClick:q,loading:f,disabled:x==="rejected"&&!p.trim(),children:"Update Status"})]})]})]})}),n.jsx(Ve,{title:"Edit Exhibitor Details",open:l,onCancel:()=>d(!1),footer:null,width:600,children:n.jsxs(H,{form:C,layout:"vertical",onFinish:L,children:[n.jsx(H.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:n.jsx(he,{})}),n.jsx(H.Item,{name:"address",label:"Address",children:n.jsx(he,{})}),n.jsx(H.Item,{name:"website",label:"Website",children:n.jsx(he,{})}),n.jsx(H.Item,{name:"description",label:"Description",children:n.jsx(Sh,{rows:4})}),n.jsx(H.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Ir,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(H.Item,{children:n.jsxs(ue,{children:[n.jsx(te,{type:"primary",htmlType:"submit",loading:v,children:"Save Changes"}),n.jsx(te,{onClick:()=>d(!1),children:"Cancel"})]})})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vo={};vo.version="0.18.5";var bf=1252,Rb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wf=function(e){Rb.indexOf(e)!=-1&&(bf=e)};function Pb(){wf(1252)}var $i=function(e){wf(e)};function Db(){$i(1200),Pb()}var Na=function(t){return String.fromCharCode(t)},Eh=function(t){return String.fromCharCode(t)},Th,$n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ui(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,i=e.charCodeAt(c++),l=(s&15)<<2|i>>6,d=i&63,isNaN(s)?l=d=64:isNaN(i)&&(d=64),t+=$n.charAt(a)+$n.charAt(o)+$n.charAt(l)+$n.charAt(d);return t}function Cn(e){var t="",r=0,s=0,i=0,a=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=$n.indexOf(e.charAt(c++)),o=$n.indexOf(e.charAt(c++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=$n.indexOf(e.charAt(c++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),d=$n.indexOf(e.charAt(c++)),i=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Nn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ds(e){return st?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _h(e){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Wr=function(t){return st?Nn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wo(e){if(typeof ArrayBuffer>"u")return Wr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Ji(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Lb(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Qt=st?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Nn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Ob(e){for(var t=[],r=0,s=e.length+250,i=ds(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>s&&(t.push(i.slice(0,r)),r=0,i=ds(65535),s=65530)}return t.push(i.slice(0,r)),Qt(t)}var Ti=/\u0000/g,Fa=/[\u0001-\u0006]/g;function Ws(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gr(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}function $c(e,t){var r=""+e;return r.length>=t?r:It(" ",t-r.length)+r}function bo(e,t){var r=""+e;return r.length>=t?r:r+It(" ",t-r.length)}function Bb(e,t){var r=""+Math.round(e);return r.length>=t?r:It("0",t-r.length)+r}function Mb(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}var kh=Math.pow(2,32);function Fs(e,t){if(e>kh||e<-kh)return Bb(e,t);var r=Math.round(e);return Mb(r,t)}function wo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ch=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ml=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $b(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ah={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ub={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jo(e,t,r){for(var s=e<0?-1:1,i=e*s,a=0,o=1,l=0,d=1,c=0,h=0,x=Math.floor(i);c<t&&(x=Math.floor(i),l=x*o+a,h=x*c+d,!(i-x<5e-8));)i=1/(i-x),a=o,o=l,d=c,c=h;if(h>t&&(c>t?(h=d,l=a):(h=c,l=o)),!r)return[0,s*l,h];var u=Math.floor(s*l/h);return[u,s*l-u*h,h]}function Ra(e,t,r){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),a=0,o=[],l={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],a=d.getDay(),s<60&&(a=(a+6)%7),r&&(a=Yb(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var jf=new Date(1899,11,31,0,0,0),zb=jf.getTime(),qb=new Date(1900,2,1,0,0,0);function Sf(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=qb&&(r+=24*60*60*1e3),(r-(zb+(e.getTimezoneOffset()-jf.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Uc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hb(e){var t=e<0?12:11,r=Uc(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Vb(e){var t=Uc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Hb(e):t===10?r=e.toFixed(10).substr(0,12):r=Vb(e),Uc(Wb(r.toUpperCase()))}function fc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qn(14,Sf(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Yb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Kb(e,t,r,s){var i="",a=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return Ml[r.m-1][1];case 5:return Ml[r.m-1][0];default:return Ml[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return Ch[r.q][0];default:return Ch[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gr(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=Gr(a,2+s),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var h=c>0?Gr(d,c):"";return h}function Un(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Ef=/%/g;function Xb(e,t,r){var s=t.replace(Ef,""),i=t.length-s.length;return Sn(e,s,r*Math.pow(10,2*i))+It("%",i)}function Qb(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Sn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Tf(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Tf(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var _f=/# (\?+)( ?)\/( ?)(\d+)/;function Jb(e,t,r){var s=parseInt(e[4],10),i=Math.round(t*s),a=Math.floor(i/s),o=i-a*s,l=s;return r+(a===0?"":""+a)+" "+(o===0?It(" ",e[1].length+1+e[4].length):$c(o,e[1].length)+e[2]+"/"+e[3]+Gr(l,e[4].length))}function Zb(e,t,r){return r+(t===0?"":""+t)+It(" ",e[1].length+2+e[4].length)}var kf=/^#*0*\.([0#]+)/,Cf=/\).*[0#]/,Af=/\(###\) ###\\?-####/;function hr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ih(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Nh(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function ew(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function tw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cf)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rr("n",s,r):"("+Rr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Qb(e,t,r);if(t.indexOf("%")!==-1)return Xb(e,t,r);if(t.indexOf("E")!==-1)return Tf(t,r);if(t.charCodeAt(0)===36)return"$"+Rr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Fs(d,t.length);if(t.match(/^[#?]+$/))return i=Fs(r,0),i==="0"&&(i=""),i.length>t.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(_f))return Jb(a,d,c);if(t.match(/^#+0+$/))return c+Fs(d,t.length-t.indexOf("0"));if(a=t.match(kf))return i=Ih(r,a[1].length).replace(/^([^\.]+)$/,"$1."+hr(a[1])).replace(/\.$/,"."+hr(a[1])).replace(/\.(\d*)$/,function(g,f){return"."+f+It("0",hr(a[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Ih(d,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(Fs(d,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rr(e,t,-r):Un(""+(Math.floor(r)+ew(r,a[1].length)))+"."+Gr(Nh(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Rr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ws(Rr(e,t.replace(/[\\-]/g,""),r)),o=0,Ws(Ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Af))return i=Rr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=jo(d,Math.pow(10,o)-1,!1),i=""+c,h=Sn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=bo(l[2],o),h.length<a[4].length&&(h=hr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=jo(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?$c(l[1],o)+a[2]+"/"+a[3]+bo(l[2],o):It(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Fs(r,0),t.length<=i.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,u=t.length-i.length-x;return hr(t.substr(0,x)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Nh(r,a[1].length),r<0?"-"+Rr(e,t,-r):Un(tw(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gr(0,3-g.length):"")+g})+"."+Gr(o,a[1].length);switch(t){case"###,##0.00":return Rr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Un(Fs(d,0));return p!=="0"?c+p:"";case"###,###.00":return Rr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function rw(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Sn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function nw(e,t,r){var s=t.replace(Ef,""),i=t.length-s.length;return Sn(e,s,r*Math.pow(10,2*i))+It("%",i)}function If(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+If(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(s+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,h){return d+c+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function rn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cf)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rn("n",s,r):"("+rn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rw(e,t,r);if(t.indexOf("%")!==-1)return nw(e,t,r);if(t.indexOf("E")!==-1)return If(t,r);if(t.charCodeAt(0)===36)return"$"+rn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Gr(d,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(_f))return Zb(a,d,c);if(t.match(/^#+0+$/))return c+Gr(d,t.length-t.indexOf("0"));if(a=t.match(kf))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hr(a[1])).replace(/\.$/,"."+hr(a[1])),i=i.replace(/\.(\d*)$/,function(g,f){return"."+f+It("0",hr(a[1]).length-f.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Un(""+d);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rn(e,t,-r):Un(""+r)+"."+It("0",a[1].length);if(a=t.match(/^#,#*,#0/))return rn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ws(rn(e,t.replace(/[\\-]/g,""),r)),o=0,Ws(Ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(Af))return i=rn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=jo(d,Math.pow(10,o)-1,!1),i=""+c,h=Sn("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=bo(l[2],o),h.length<a[4].length&&(h=hr(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=jo(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?$c(l[1],o)+a[2]+"/"+a[3]+bo(l[2],o):It(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,u=t.length-i.length-x;return hr(t.substr(0,x)+i+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+rn(e,t,-r):Un(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gr(0,3-g.length):"")+g})+"."+Gr(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Un(""+d);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return rn(e,t.slice(0,t.lastIndexOf(".")),r)+hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Sn(e,t,r){return(r|0)===r?rn(e,t,r):Rr(e,t,r)}function sw(e){for(var t=[],r=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(i,s-i),i=s+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Nf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ff(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":wo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(Nf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function iw(e,t,r,s){for(var i=[],a="",o=0,l="",d="t",c,h,x,u="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!wo(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(x=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(x);i[i.length]={t:"t",v:a},++o;break;case"\\":var p=e.charAt(++o),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Ra(t,r,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ra(t,r),c==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),i[i.length]={t:l,v:a},d=l;break;case"A":case"a":case"上":var f={t:l,v:l};if(c==null&&(c=Ra(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(f.v=c.H>=12?"P":"A"),f.t="T",u="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(f.v=c.H>=12?"PM":"AM"),f.t="T",o+=5,u="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(f.v=c.H>=12?"下午":"上午"),f.t="T",o+=5,u="h"):(f.t="t",++o),c==null&&f.t==="T")return"";i[i.length]=f,d=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Nf)){if(c==null&&(c=Ra(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},d=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ff(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var m=0,v=0,w;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=u,d="h",m<1&&(m=1);break;case"s":(w=i[o].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[o].v.match(/[Hh]/)&&(m=1),m<2&&i[o].v.match(/[Mm]/)&&(m=2),m<3&&i[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",y;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Kb(i[o].t.charCodeAt(0),i[o].v,c,v),i[o].t="t";break;case"n":case"?":for(y=o+1;i[y]!=null&&((l=i[y].t)==="?"||l==="D"||(l===" "||l==="t")&&i[y+1]!=null&&(i[y+1].t==="?"||i[y+1].t==="t"&&i[y+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[y].v==="/"||i[y].v===" "&&i[y+1]!=null&&i[y+1].t=="?"));)i[o].v+=i[y].v,i[y]={v:"",t:";"},++y;_+=i[o].v,o=y-1;break;case"G":i[o].t="t",i[o].v=fc(t,r);break}var b="",E,j;if(_.length>0){_.charCodeAt(0)==40?(E=t<0&&_.charCodeAt(0)===45?-t:t,j=Sn("n",_,E)):(E=t<0&&s>1?-t:t,j=Sn("n",_,E),E<0&&i[0]&&i[0].t=="t"&&(j=j.substr(1),i[0].v="-"+i[0].v)),y=j.length-1;var S=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){S=o;break}var C=i.length;if(S===i.length&&j.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(y>=i[o].v.length-1?(y-=i[o].v.length,i[o].v=j.substr(y+1,i[o].v.length)):y<0?i[o].v="":(i[o].v=j.substr(0,y+1),y=-1),i[o].t="t",C=o);y>=0&&C<i.length&&(i[C].v=j.substr(0,y+1)+i[C].v)}else if(S!==i.length&&j.indexOf("E")===-1){for(y=j.indexOf(".")-1,o=S;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===S?i[o].v.indexOf(".")-1:i[o].v.length-1,b=i[o].v.substr(h+1);h>=0;--h)y>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(b=j.charAt(y--)+b);i[o].v=b,i[o].t="t",C=o}for(y>=0&&C<i.length&&(i[C].v=j.substr(0,y+1)+i[C].v),y=j.indexOf(".")+1,o=S;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==S)){for(h=i[o].v.indexOf(".")>-1&&o===S?i[o].v.indexOf(".")+1:0,b=i[o].v.substr(0,h);h<i[o].v.length;++h)y<j.length&&(b+=j.charAt(y++));i[o].v=b,i[o].t="t",C=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(E=s>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Sn(i[o].t,i[o].v,E),i[o].t="t");var T="";for(o=0;o!==i.length;++o)i[o]!=null&&(T+=i[o].v);return T}var Fh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Rh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function aw(e,t){var r=sw(e),s=r.length,i=r[s-1].indexOf("@");if(s<4&&i>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Fh),l=r[1].match(Fh);return Rh(t,o)?[s,r[0]]:Rh(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,a]}function qn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Nt)[e],s==null&&(s=r.table&&r.table[Ah[e]]||Nt[Ah[e]]),s==null&&(s=Ub[e]||"General");break}if(wo(s,0))return fc(t,r);t instanceof Date&&(t=Sf(t,r.date1904));var i=aw(s,t);if(wo(i[1]))return fc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return iw(i[1],t,r,i[0])}function Rf(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Nt[r]==null){t<0&&(t=r);continue}if(Nt[r]==e){t=r;break}}t<0&&(t=391)}return Nt[t]=e,t}function Ho(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Rf(e[t],t)}function Vo(){Nt=$b()}var Pf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ow(e){var t=typeof e=="number"?Nt[e]:e;return t=t.replace(Pf,"(\\d+)"),new RegExp("^"+t+"$")}function lw(e,t,r){var s=-1,i=-1,a=-1,o=-1,l=-1,d=-1;(t.match(Pf)||[]).forEach(function(x,u){var p=parseInt(r[u+1],10);switch(x.toLowerCase().charAt(0)){case"y":s=p;break;case"d":a=p;break;case"h":o=p;break;case"s":d=p;break;case"m":o>=0?l=p:i=p;break}}),d>=0&&l==-1&&i>=0&&(l=i,i=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:s==-1&&i==-1&&a==-1?h:c+"T"+h}var cw=function(){var e={};e.version="1.2.0";function t(){for(var j=0,S=new Array(256),C=0;C!=256;++C)j=C,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,S[C]=j;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function s(j){var S=0,C=0,T=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)A[T]=j[T];for(T=0;T!=256;++T)for(C=j[T],S=256+T;S<4096;S+=256)C=A[S]=C>>>8^j[C&255];var I=[];for(T=1;T!=16;++T)I[T-1]=typeof Int32Array<"u"?A.subarray(T*256,T*256+256):A.slice(T*256,T*256+256);return I}var i=s(r),a=i[0],o=i[1],l=i[2],d=i[3],c=i[4],h=i[5],x=i[6],u=i[7],p=i[8],g=i[9],f=i[10],m=i[11],v=i[12],w=i[13],_=i[14];function y(j,S){for(var C=S^-1,T=0,A=j.length;T<A;)C=C>>>8^r[(C^j.charCodeAt(T++))&255];return~C}function b(j,S){for(var C=S^-1,T=j.length-15,A=0;A<T;)C=_[j[A++]^C&255]^w[j[A++]^C>>8&255]^v[j[A++]^C>>16&255]^m[j[A++]^C>>>24]^f[j[A++]]^g[j[A++]]^p[j[A++]]^u[j[A++]]^x[j[A++]]^h[j[A++]]^c[j[A++]]^d[j[A++]]^l[j[A++]]^o[j[A++]]^a[j[A++]]^r[j[A++]];for(T+=15;A<T;)C=C>>>8^r[(C^j[A++])&255];return~C}function E(j,S){for(var C=S^-1,T=0,A=j.length,I=0,P=0;T<A;)I=j.charCodeAt(T++),I<128?C=C>>>8^r[(C^I)&255]:I<2048?(C=C>>>8^r[(C^(192|I>>6&31))&255],C=C>>>8^r[(C^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,P=j.charCodeAt(T++)&1023,C=C>>>8^r[(C^(240|I>>8&7))&255],C=C>>>8^r[(C^(128|I>>2&63))&255],C=C>>>8^r[(C^(128|P>>6&15|(I&3)<<4))&255],C=C>>>8^r[(C^(128|P&63))&255]):(C=C>>>8^r[(C^(224|I>>12&15))&255],C=C>>>8^r[(C^(128|I>>6&63))&255],C=C>>>8^r[(C^(128|I&63))&255]);return~C}return e.table=r,e.bstr=y,e.buf=b,e.str=E,e}(),ft=function(){var t={};t.version="1.2.1";function r(O,G){for(var z=O.split("/"),W=G.split("/"),Y=0,X=0,ae=Math.min(z.length,W.length);Y<ae;++Y){if(X=z[Y].length-W[Y].length)return X;if(z[Y]!=W[Y])return z[Y]<W[Y]?-1:1}return z.length-W.length}function s(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:s(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(0,G+1)}function i(O){if(O.charAt(O.length-1)=="/")return i(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(G+1)}function a(O,G){typeof G=="string"&&(G=new Date(G));var z=G.getHours();z=z<<6|G.getMinutes(),z=z<<5|G.getSeconds()>>>1,O.write_shift(2,z);var W=G.getFullYear()-1980;W=W<<4|G.getMonth()+1,W=W<<5|G.getDate(),O.write_shift(2,W)}function o(O){var G=O.read_shift(2)&65535,z=O.read_shift(2)&65535,W=new Date,Y=z&31;z>>>=5;var X=z&15;z>>>=4,W.setMilliseconds(0),W.setFullYear(z+1980),W.setMonth(X-1),W.setDate(Y);var ae=G&31;G>>>=5;var pe=G&63;return G>>>=6,W.setHours(G),W.setMinutes(pe),W.setSeconds(ae<<1),W}function l(O){Er(O,0);for(var G={},z=0;O.l<=O.length-4;){var W=O.read_shift(2),Y=O.read_shift(2),X=O.l+Y,ae={};switch(W){case 21589:z=O.read_shift(1),z&1&&(ae.mtime=O.read_shift(4)),Y>5&&(z&2&&(ae.atime=O.read_shift(4)),z&4&&(ae.ctime=O.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}O.l=X,G[W]=ae}return G}var d;function c(){return d||(d={})}function h(O,G){if(O[0]==80&&O[1]==75)return cd(O,G);if((O[0]|32)==109&&(O[1]|32)==105)return lx(O,G);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var z=3,W=512,Y=0,X=0,ae=0,pe=0,ie=0,oe=[],le=O.slice(0,512);Er(le,0);var we=x(le);switch(z=we[0],z){case 3:W=512;break;case 4:W=4096;break;case 0:if(we[1]==0)return cd(O,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}W!==512&&(le=O.slice(0,W),Er(le,28));var Ae=O.slice(0,W);u(le,z);var De=le.read_shift(4,"i");if(z===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),pe=le.read_shift(4,"i"),Y=le.read_shift(4,"i"),ie=le.read_shift(4,"i"),X=le.read_shift(4,"i");for(var je=-1,Re=0;Re<109&&(je=le.read_shift(4,"i"),!(je<0));++Re)oe[Re]=je;var Ue=p(O,W);m(ie,X,Ue,W,oe);var wt=w(Ue,ae,oe,W);wt[ae].name="!Directory",Y>0&&pe!==P&&(wt[pe].name="!MiniFAT"),wt[oe[0]].name="!FAT",wt.fat_addrs=oe,wt.ssz=W;var jt={},rr=[],si=[],ii=[];_(ae,wt,Ue,rr,Y,jt,si,pe),g(si,ii,rr),rr.shift();var ai={FileIndex:si,FullPaths:ii};return G&&G.raw&&(ai.raw={header:Ae,sectors:Ue}),ai}function x(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(N,"Header Signature: "),O.l+=16;var G=O.read_shift(2,"u");return[O.read_shift(2,"u"),G]}function u(O,G){var z=9;switch(O.l+=2,z=O.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function p(O,G){for(var z=Math.ceil(O.length/G)-1,W=[],Y=1;Y<z;++Y)W[Y-1]=O.slice(Y*G,(Y+1)*G);return W[z-1]=O.slice(z*G),W}function g(O,G,z){for(var W=0,Y=0,X=0,ae=0,pe=0,ie=z.length,oe=[],le=[];W<ie;++W)oe[W]=le[W]=W,G[W]=z[W];for(;pe<le.length;++pe)W=le[pe],Y=O[W].L,X=O[W].R,ae=O[W].C,oe[W]===W&&(Y!==-1&&oe[Y]!==Y&&(oe[W]=oe[Y]),X!==-1&&oe[X]!==X&&(oe[W]=oe[X])),ae!==-1&&(oe[ae]=W),Y!==-1&&W!=oe[W]&&(oe[Y]=oe[W],le.lastIndexOf(Y)<pe&&le.push(Y)),X!==-1&&W!=oe[W]&&(oe[X]=oe[W],le.lastIndexOf(X)<pe&&le.push(X));for(W=1;W<ie;++W)oe[W]===W&&(X!==-1&&oe[X]!==X?oe[W]=oe[X]:Y!==-1&&oe[Y]!==Y&&(oe[W]=oe[Y]));for(W=1;W<ie;++W)if(O[W].type!==0){if(pe=W,pe!=oe[pe])do pe=oe[pe],G[W]=G[pe]+"/"+G[W];while(pe!==0&&oe[pe]!==-1&&pe!=oe[pe]);oe[W]=-1}for(G[0]+="/",W=1;W<ie;++W)O[W].type!==2&&(G[W]+="/")}function f(O,G,z){for(var W=O.start,Y=O.size,X=[],ae=W;z&&Y>0&&ae>=0;)X.push(G.slice(ae*I,ae*I+I)),Y-=I,ae=rs(z,ae*4);return X.length===0?fe(0):Qt(X).slice(0,O.size)}function m(O,G,z,W,Y){var X=P;if(O===P){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ae=z[O],pe=(W>>>2)-1;if(!ae)return;for(var ie=0;ie<pe&&(X=rs(ae,ie*4))!==P;++ie)Y.push(X);m(rs(ae,W-4),G-1,z,W,Y)}}function v(O,G,z,W,Y){var X=[],ae=[];Y||(Y=[]);var pe=W-1,ie=0,oe=0;for(ie=G;ie>=0;){Y[ie]=!0,X[X.length]=ie,ae.push(O[ie]);var le=z[Math.floor(ie*4/W)];if(oe=ie*4&pe,W<4+oe)throw new Error("FAT boundary crossed: "+ie+" 4 "+W);if(!O[le])break;ie=rs(O[le],oe)}return{nodes:X,data:Uh([ae])}}function w(O,G,z,W){var Y=O.length,X=[],ae=[],pe=[],ie=[],oe=W-1,le=0,we=0,Ae=0,De=0;for(le=0;le<Y;++le)if(pe=[],Ae=le+G,Ae>=Y&&(Ae-=Y),!ae[Ae]){ie=[];var je=[];for(we=Ae;we>=0;){je[we]=!0,ae[we]=!0,pe[pe.length]=we,ie.push(O[we]);var Re=z[Math.floor(we*4/W)];if(De=we*4&oe,W<4+De)throw new Error("FAT boundary crossed: "+we+" 4 "+W);if(!O[Re]||(we=rs(O[Re],De),je[we]))break}X[Ae]={nodes:pe,data:Uh([ie])}}return X}function _(O,G,z,W,Y,X,ae,pe){for(var ie=0,oe=W.length?2:0,le=G[O].data,we=0,Ae=0,De;we<le.length;we+=128){var je=le.slice(we,we+128);Er(je,64),Ae=je.read_shift(2),De=Vc(je,0,Ae-oe),W.push(De);var Re={name:De,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},Ue=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);Ue!==0&&(Re.ct=y(je,je.l-8));var wt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);wt!==0&&(Re.mt=y(je,je.l-8)),Re.start=je.read_shift(4,"i"),Re.size=je.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=P,Re.name=""),Re.type===5?(ie=Re.start,Y>0&&ie!==P&&(G[ie].name="!StreamData")):Re.size>=4096?(Re.storage="fat",G[Re.start]===void 0&&(G[Re.start]=v(z,Re.start,G.fat_addrs,G.ssz)),G[Re.start].name=Re.name,Re.content=G[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:ie!==P&&Re.start!==P&&G[ie]&&(Re.content=f(Re,G[ie].data,(G[pe]||{}).data))),Re.content&&Er(Re.content,0),X[De]=Re,ae.push(Re)}}function y(O,G){return new Date((kr(O,G+4)/1e7*Math.pow(2,32)+kr(O,G)/1e7-11644473600)*1e3)}function b(O,G){return c(),h(d.readFileSync(O),G)}function E(O,G){var z=G&&G.type;switch(z||st&&Buffer.isBuffer(O)&&(z="buffer"),z||"base64"){case"file":return b(O,G);case"base64":return h(Wr(Cn(O)),G);case"binary":return h(Wr(O),G)}return h(O,G)}function j(O,G){var z=G||{},W=z.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=W+"/",O.FileIndex[0]={name:W,type:5}),z.CLSID&&(O.FileIndex[0].clsid=z.CLSID),S(O)}function S(O){var G="Sh33tJ5";if(!ft.find(O,"/"+G)){var z=fe(4);z[0]=55,z[1]=z[3]=50,z[2]=54,O.FileIndex.push({name:G,type:2,content:z,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+G),C(O)}}function C(O,G){j(O);for(var z=!1,W=!1,Y=O.FullPaths.length-1;Y>=0;--Y){var X=O.FileIndex[Y];switch(X.type){case 0:W?z=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(X.R*X.L*X.C)&&(z=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!G)){var ae=new Date(1987,1,19),pe=0,ie=Object.create?Object.create(null):{},oe=[];for(Y=0;Y<O.FullPaths.length;++Y)ie[O.FullPaths[Y]]=!0,O.FileIndex[Y].type!==0&&oe.push([O.FullPaths[Y],O.FileIndex[Y]]);for(Y=0;Y<oe.length;++Y){var le=s(oe[Y][0]);W=ie[le],W||(oe.push([le,{name:i(le).replace("/",""),type:1,clsid:L,ct:ae,mt:ae,content:null}]),ie[le]=!0)}for(oe.sort(function(De,je){return r(De[0],je[0])}),O.FullPaths=[],O.FileIndex=[],Y=0;Y<oe.length;++Y)O.FullPaths[Y]=oe[Y][0],O.FileIndex[Y]=oe[Y][1];for(Y=0;Y<oe.length;++Y){var we=O.FileIndex[Y],Ae=O.FullPaths[Y];if(we.name=i(Ae).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||L,Y===0)we.C=oe.length>1?1:-1,we.size=0,we.type=5;else if(Ae.slice(-1)=="/"){for(pe=Y+1;pe<oe.length&&s(O.FullPaths[pe])!=Ae;++pe);for(we.C=pe>=oe.length?-1:pe,pe=Y+1;pe<oe.length&&s(O.FullPaths[pe])!=s(Ae);++pe);we.R=pe>=oe.length?-1:pe,we.type=1}else s(O.FullPaths[Y+1]||"")==s(Ae)&&(we.R=Y+1),we.type=2}}}function T(O,G){var z=G||{};if(z.fileType=="mad")return cx(O,z);switch(C(O),z.fileType){case"zip":return rx(O,z)}var W=function(De){for(var je=0,Re=0,Ue=0;Ue<De.FileIndex.length;++Ue){var wt=De.FileIndex[Ue];if(wt.content){var jt=wt.content.length;jt>0&&(jt<4096?je+=jt+63>>6:Re+=jt+511>>9)}}for(var rr=De.FullPaths.length+3>>2,si=je+7>>3,ii=je+127>>7,ai=si+Re+rr+ii,Xn=ai+127>>7,tl=Xn<=109?0:Math.ceil((Xn-109)/127);ai+Xn+tl+127>>7>Xn;)tl=++Xn<=109?0:Math.ceil((Xn-109)/127);var pn=[1,tl,Xn,ii,rr,Re,je,0];return De.FileIndex[0].size=je<<6,pn[7]=(De.FileIndex[0].start=pn[0]+pn[1]+pn[2]+pn[3]+pn[4]+pn[5])+(pn[6]+7>>3),pn}(O),Y=fe(W[7]<<9),X=0,ae=0;{for(X=0;X<8;++X)Y.write_shift(1,q[X]);for(X=0;X<8;++X)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),X=0;X<3;++X)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,W[2]),Y.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:P),Y.write_shift(4,W[3]),Y.write_shift(-4,W[1]?W[0]-1:P),Y.write_shift(4,W[1]),X=0;X<109;++X)Y.write_shift(-4,X<W[2]?W[1]+X:-1)}if(W[1])for(ae=0;ae<W[1];++ae){for(;X<236+ae*127;++X)Y.write_shift(-4,X<W[2]?W[1]+X:-1);Y.write_shift(-4,ae===W[1]-1?P:ae+1)}var pe=function(De){for(ae+=De;X<ae-1;++X)Y.write_shift(-4,X+1);De&&(++X,Y.write_shift(-4,P))};for(ae=X=0,ae+=W[1];X<ae;++X)Y.write_shift(-4,D.DIFSECT);for(ae+=W[2];X<ae;++X)Y.write_shift(-4,D.FATSECT);pe(W[3]),pe(W[4]);for(var ie=0,oe=0,le=O.FileIndex[0];ie<O.FileIndex.length;++ie)le=O.FileIndex[ie],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ae,pe(oe+511>>9)));for(pe(W[6]+7>>3);Y.l&511;)Y.write_shift(-4,D.ENDOFCHAIN);for(ae=X=0,ie=0;ie<O.FileIndex.length;++ie)le=O.FileIndex[ie],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ae,pe(oe+63>>6)));for(;Y.l&511;)Y.write_shift(-4,D.ENDOFCHAIN);for(X=0;X<W[4]<<2;++X){var we=O.FullPaths[X];if(!we||we.length===0){for(ie=0;ie<17;++ie)Y.write_shift(4,0);for(ie=0;ie<3;++ie)Y.write_shift(4,-1);for(ie=0;ie<12;++ie)Y.write_shift(4,0);continue}le=O.FileIndex[X],X===0&&(le.start=le.size?le.start-1:P);var Ae=X===0&&z.root||le.name;if(oe=2*(Ae.length+1),Y.write_shift(64,Ae,"utf16le"),Y.write_shift(2,oe),Y.write_shift(1,le.type),Y.write_shift(1,le.color),Y.write_shift(-4,le.L),Y.write_shift(-4,le.R),Y.write_shift(-4,le.C),le.clsid)Y.write_shift(16,le.clsid,"hex");else for(ie=0;ie<4;++ie)Y.write_shift(4,0);Y.write_shift(4,le.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,le.start),Y.write_shift(4,le.size),Y.write_shift(4,0)}for(X=1;X<O.FileIndex.length;++X)if(le=O.FileIndex[X],le.size>=4096)if(Y.l=le.start+1<<9,st&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+511&-512;else{for(ie=0;ie<le.size;++ie)Y.write_shift(1,le.content[ie]);for(;ie&511;++ie)Y.write_shift(1,0)}for(X=1;X<O.FileIndex.length;++X)if(le=O.FileIndex[X],le.size>0&&le.size<4096)if(st&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+63&-64;else{for(ie=0;ie<le.size;++ie)Y.write_shift(1,le.content[ie]);for(;ie&63;++ie)Y.write_shift(1,0)}if(st)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function A(O,G){var z=O.FullPaths.map(function(ie){return ie.toUpperCase()}),W=z.map(function(ie){var oe=ie.split("/");return oe[oe.length-(ie.slice(-1)=="/"?2:1)]}),Y=!1;G.charCodeAt(0)===47?(Y=!0,G=z[0].slice(0,-1)+G):Y=G.indexOf("/")!==-1;var X=G.toUpperCase(),ae=Y===!0?z.indexOf(X):W.indexOf(X);if(ae!==-1)return O.FileIndex[ae];var pe=!X.match(Fa);for(X=X.replace(Ti,""),pe&&(X=X.replace(Fa,"!")),ae=0;ae<z.length;++ae)if((pe?z[ae].replace(Fa,"!"):z[ae]).replace(Ti,"")==X||(pe?W[ae].replace(Fa,"!"):W[ae]).replace(Ti,"")==X)return O.FileIndex[ae];return null}var I=64,P=-2,N="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",D={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:N,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(O,G,z){c();var W=T(O,z);d.writeFileSync(G,W)}function J(O){for(var G=new Array(O.length),z=0;z<O.length;++z)G[z]=String.fromCharCode(O[z]);return G.join("")}function ne(O,G){var z=T(O,G);switch(G&&G.type||"buffer"){case"file":return c(),d.writeFileSync(G.filename,z),z;case"binary":return typeof z=="string"?z:J(z);case"base64":return Ui(typeof z=="string"?z:J(z));case"buffer":if(st)return Buffer.isBuffer(z)?z:Nn(z);case"array":return typeof z=="string"?Wr(z):z}return z}var Z;function R(O){try{var G=O.InflateRaw,z=new G;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)Z=O;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function U(O,G){if(!Z)return od(O,G);var z=Z.InflateRaw,W=new z,Y=W._processChunk(O.slice(O.l),W._finishFlushFlag);return O.l+=W.bytesRead,Y}function B(O){return Z?Z.deflateRawSync(O):Ct(O)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(O){var G=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(G>>16|G>>8|G)&255}for(var me=typeof Uint8Array<"u",Q=me?new Uint8Array(256):[],ee=0;ee<256;++ee)Q[ee]=xe(ee);function ce(O,G){var z=Q[O&255];return G<=8?z>>>8-G:(z=z<<8|Q[O>>8&255],G<=16?z>>>16-G:(z=z<<8|Q[O>>16&255],z>>>24-G))}function Ie(O,G){var z=G&7,W=G>>>3;return(O[W]|(z<=6?0:O[W+1]<<8))>>>z&3}function re(O,G){var z=G&7,W=G>>>3;return(O[W]|(z<=5?0:O[W+1]<<8))>>>z&7}function _e(O,G){var z=G&7,W=G>>>3;return(O[W]|(z<=4?0:O[W+1]<<8))>>>z&15}function Ne(O,G){var z=G&7,W=G>>>3;return(O[W]|(z<=3?0:O[W+1]<<8))>>>z&31}function ye(O,G){var z=G&7,W=G>>>3;return(O[W]|(z<=1?0:O[W+1]<<8))>>>z&127}function ze(O,G,z){var W=G&7,Y=G>>>3,X=(1<<z)-1,ae=O[Y]>>>W;return z<8-W||(ae|=O[Y+1]<<8-W,z<16-W)||(ae|=O[Y+2]<<16-W,z<24-W)||(ae|=O[Y+3]<<24-W),ae&X}function qe(O,G,z){var W=G&7,Y=G>>>3;return W<=5?O[Y]|=(z&7)<<W:(O[Y]|=z<<W&255,O[Y+1]=(z&7)>>8-W),G+3}function Ft(O,G,z){var W=G&7,Y=G>>>3;return z=(z&1)<<W,O[Y]|=z,G+1}function tr(O,G,z){var W=G&7,Y=G>>>3;return z<<=W,O[Y]|=z&255,z>>>=8,O[Y+1]=z,G+8}function dr(O,G,z){var W=G&7,Y=G>>>3;return z<<=W,O[Y]|=z&255,z>>>=8,O[Y+1]=z&255,O[Y+2]=z>>>8,G+16}function Fn(O,G){var z=O.length,W=2*z>G?2*z:G+5,Y=0;if(z>=G)return O;if(st){var X=_h(W);if(O.copy)O.copy(X);else for(;Y<O.length;++Y)X[Y]=O[Y];return X}else if(me){var ae=new Uint8Array(W);if(ae.set)ae.set(O);else for(;Y<z;++Y)ae[Y]=O[Y];return ae}return O.length=W,O}function Fe(O){for(var G=new Array(O),z=0;z<O;++z)G[z]=0;return G}function $e(O,G,z){var W=1,Y=0,X=0,ae=0,pe=0,ie=O.length,oe=me?new Uint16Array(32):Fe(32);for(X=0;X<32;++X)oe[X]=0;for(X=ie;X<z;++X)O[X]=0;ie=O.length;var le=me?new Uint16Array(ie):Fe(ie);for(X=0;X<ie;++X)oe[Y=O[X]]++,W<Y&&(W=Y),le[X]=0;for(oe[0]=0,X=1;X<=W;++X)oe[X+16]=pe=pe+oe[X-1]<<1;for(X=0;X<ie;++X)pe=O[X],pe!=0&&(le[X]=oe[pe+16]++);var we=0;for(X=0;X<ie;++X)if(we=O[X],we!=0)for(pe=ce(le[X],W)>>W-we,ae=(1<<W+4-we)-1;ae>=0;--ae)G[pe|ae<<we]=we&15|X<<4;return W}var Ke=me?new Uint16Array(512):Fe(512),Oe=me?new Uint16Array(32):Fe(32);if(!me){for(var Be=0;Be<512;++Be)Ke[Be]=0;for(Be=0;Be<32;++Be)Oe[Be]=0}(function(){for(var O=[],G=0;G<32;G++)O.push(5);$e(O,Oe,32);var z=[];for(G=0;G<=143;G++)z.push(8);for(;G<=255;G++)z.push(9);for(;G<=279;G++)z.push(7);for(;G<=287;G++)z.push(8);$e(z,Ke,288)})();var ut=function(){for(var G=me?new Uint8Array(32768):[],z=0,W=0;z<se.length-1;++z)for(;W<se[z+1];++W)G[W]=z;for(;W<32768;++W)G[W]=29;var Y=me?new Uint8Array(259):[];for(z=0,W=0;z<V.length-1;++z)for(;W<V[z+1];++W)Y[W]=z;function X(pe,ie){for(var oe=0;oe<pe.length;){var le=Math.min(65535,pe.length-oe),we=oe+le==pe.length;for(ie.write_shift(1,+we),ie.write_shift(2,le),ie.write_shift(2,~le&65535);le-- >0;)ie[ie.l++]=pe[oe++]}return ie.l}function ae(pe,ie){for(var oe=0,le=0,we=me?new Uint16Array(32768):[];le<pe.length;){var Ae=Math.min(65535,pe.length-le);if(Ae<10){for(oe=qe(ie,oe,+(le+Ae==pe.length)),oe&7&&(oe+=8-(oe&7)),ie.l=oe/8|0,ie.write_shift(2,Ae),ie.write_shift(2,~Ae&65535);Ae-- >0;)ie[ie.l++]=pe[le++];oe=ie.l*8;continue}oe=qe(ie,oe,+(le+Ae==pe.length)+2);for(var De=0;Ae-- >0;){var je=pe[le];De=(De<<5^je)&32767;var Re=-1,Ue=0;if((Re=we[De])&&(Re|=le&-32768,Re>le&&(Re-=32768),Re<le))for(;pe[Re+Ue]==pe[le+Ue]&&Ue<250;)++Ue;if(Ue>2){je=Y[Ue],je<=22?oe=tr(ie,oe,Q[je+1]>>1)-1:(tr(ie,oe,3),oe+=5,tr(ie,oe,Q[je-23]>>5),oe+=3);var wt=je<8?0:je-4>>2;wt>0&&(dr(ie,oe,Ue-V[je]),oe+=wt),je=G[le-Re],oe=tr(ie,oe,Q[je]>>3),oe-=3;var jt=je<4?0:je-2>>1;jt>0&&(dr(ie,oe,le-Re-se[je]),oe+=jt);for(var rr=0;rr<Ue;++rr)we[De]=le&32767,De=(De<<5^pe[le])&32767,++le;Ae-=Ue-1}else je<=143?je=je+48:oe=Ft(ie,oe,1),oe=tr(ie,oe,Q[je]),we[De]=le&32767,++le}oe=tr(ie,oe,0)-1}return ie.l=(oe+7)/8|0,ie.l}return function(ie,oe){return ie.length<8?X(ie,oe):ae(ie,oe)}}();function Ct(O){var G=fe(50+Math.floor(O.length*1.1)),z=ut(O,G);return G.slice(0,z)}var jr=me?new Uint16Array(32768):Fe(32768),Rn=me?new Uint16Array(32768):Fe(32768),sa=me?new Uint16Array(128):Fe(128),ia=1,aa=1;function Jo(O,G){var z=Ne(O,G)+257;G+=5;var W=Ne(O,G)+1;G+=5;var Y=_e(O,G)+4;G+=4;for(var X=0,ae=me?new Uint8Array(19):Fe(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,oe=me?new Uint8Array(8):Fe(8),le=me?new Uint8Array(8):Fe(8),we=ae.length,Ae=0;Ae<Y;++Ae)ae[F[Ae]]=X=re(O,G),ie<X&&(ie=X),oe[X]++,G+=3;var De=0;for(oe[0]=0,Ae=1;Ae<=ie;++Ae)le[Ae]=De=De+oe[Ae-1]<<1;for(Ae=0;Ae<we;++Ae)(De=ae[Ae])!=0&&(pe[Ae]=le[De]++);var je=0;for(Ae=0;Ae<we;++Ae)if(je=ae[Ae],je!=0){De=Q[pe[Ae]]>>8-je;for(var Re=(1<<7-je)-1;Re>=0;--Re)sa[De|Re<<je]=je&7|Ae<<3}var Ue=[];for(ie=1;Ue.length<z+W;)switch(De=sa[ye(O,G)],G+=De&7,De>>>=3){case 16:for(X=3+Ie(O,G),G+=2,De=Ue[Ue.length-1];X-- >0;)Ue.push(De);break;case 17:for(X=3+re(O,G),G+=3;X-- >0;)Ue.push(0);break;case 18:for(X=11+ye(O,G),G+=7;X-- >0;)Ue.push(0);break;default:Ue.push(De),ie<De&&(ie=De);break}var wt=Ue.slice(0,z),jt=Ue.slice(z);for(Ae=z;Ae<286;++Ae)wt[Ae]=0;for(Ae=W;Ae<30;++Ae)jt[Ae]=0;return ia=$e(wt,jr,286),aa=$e(jt,Rn,30),G}function Zo(O,G){if(O[0]==3&&!(O[1]&3))return[ds(G),2];for(var z=0,W=0,Y=_h(G||1<<18),X=0,ae=Y.length>>>0,pe=0,ie=0;!(W&1);){if(W=re(O,z),z+=3,W>>>1)W>>1==1?(pe=9,ie=5):(z=Jo(O,z),pe=ia,ie=aa);else{z&7&&(z+=8-(z&7));var oe=O[z>>>3]|O[(z>>>3)+1]<<8;if(z+=32,oe>0)for(!G&&ae<X+oe&&(Y=Fn(Y,X+oe),ae=Y.length);oe-- >0;)Y[X++]=O[z>>>3],z+=8;continue}for(;;){!G&&ae<X+32767&&(Y=Fn(Y,X+32767),ae=Y.length);var le=ze(O,z,pe),we=W>>>1==1?Ke[le]:jr[le];if(z+=we&15,we>>>=4,!(we>>>8&255))Y[X++]=we;else{if(we==256)break;we-=257;var Ae=we<8?0:we-4>>2;Ae>5&&(Ae=0);var De=X+V[we];Ae>0&&(De+=ze(O,z,Ae),z+=Ae),le=ze(O,z,ie),we=W>>>1==1?Oe[le]:Rn[le],z+=we&15,we>>>=4;var je=we<4?0:we-2>>1,Re=se[we];for(je>0&&(Re+=ze(O,z,je),z+=je),!G&&ae<De&&(Y=Fn(Y,De+100),ae=Y.length);X<De;)Y[X]=Y[X-Re],++X}}}return G?[Y,z+7>>>3]:[Y.slice(0,X),z+7>>>3]}function od(O,G){var z=O.slice(O.l||0),W=Zo(z,G);return O.l+=W[1],W[0]}function ld(O,G){if(O)typeof console<"u"&&console.error(G);else throw new Error(G)}function cd(O,G){var z=O;Er(z,0);var W=[],Y=[],X={FileIndex:W,FullPaths:Y};j(X,{root:G.root});for(var ae=z.length-4;(z[ae]!=80||z[ae+1]!=75||z[ae+2]!=5||z[ae+3]!=6)&&ae>=0;)--ae;z.l=ae+4,z.l+=4;var pe=z.read_shift(2);z.l+=6;var ie=z.read_shift(4);for(z.l=ie,ae=0;ae<pe;++ae){z.l+=20;var oe=z.read_shift(4),le=z.read_shift(4),we=z.read_shift(2),Ae=z.read_shift(2),De=z.read_shift(2);z.l+=8;var je=z.read_shift(4),Re=l(z.slice(z.l+we,z.l+we+Ae));z.l+=we+Ae+De;var Ue=z.l;z.l=je+4,tx(z,oe,le,X,Re),z.l=Ue}return X}function tx(O,G,z,W,Y){O.l+=2;var X=O.read_shift(2),ae=O.read_shift(2),pe=o(O);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ie=O.read_shift(4),oe=O.read_shift(4),le=O.read_shift(4),we=O.read_shift(2),Ae=O.read_shift(2),De="",je=0;je<we;++je)De+=String.fromCharCode(O[O.l++]);if(Ae){var Re=l(O.slice(O.l,O.l+Ae));(Re[21589]||{}).mt&&(pe=Re[21589].mt),((Y||{})[21589]||{}).mt&&(pe=Y[21589].mt)}O.l+=Ae;var Ue=O.slice(O.l,O.l+oe);switch(ae){case 8:Ue=U(O,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var wt=!1;X&8&&(ie=O.read_shift(4),ie==134695760&&(ie=O.read_shift(4),wt=!0),oe=O.read_shift(4),le=O.read_shift(4)),oe!=G&&ld(wt,"Bad compressed size: "+G+" != "+oe),le!=z&&ld(wt,"Bad uncompressed size: "+z+" != "+le),el(W,De,Ue,{unsafe:!0,mt:pe})}function rx(O,G){var z=G||{},W=[],Y=[],X=fe(1),ae=z.compression?8:0,pe=0,ie=0,oe=0,le=0,we=0,Ae=O.FullPaths[0],De=Ae,je=O.FileIndex[0],Re=[],Ue=0;for(ie=1;ie<O.FullPaths.length;++ie)if(De=O.FullPaths[ie].slice(Ae.length),je=O.FileIndex[ie],!(!je.size||!je.content||De=="Sh33tJ5")){var wt=le,jt=fe(De.length);for(oe=0;oe<De.length;++oe)jt.write_shift(1,De.charCodeAt(oe)&127);jt=jt.slice(0,jt.l),Re[we]=cw.buf(je.content,0);var rr=je.content;ae==8&&(rr=B(rr)),X=fe(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,pe),X.write_shift(2,ae),je.mt?a(X,je.mt):X.write_shift(4,0),X.write_shift(-4,Re[we]),X.write_shift(4,rr.length),X.write_shift(4,je.content.length),X.write_shift(2,jt.length),X.write_shift(2,0),le+=X.length,W.push(X),le+=jt.length,W.push(jt),le+=rr.length,W.push(rr),X=fe(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,pe),X.write_shift(2,ae),X.write_shift(4,0),X.write_shift(-4,Re[we]),X.write_shift(4,rr.length),X.write_shift(4,je.content.length),X.write_shift(2,jt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,wt),Ue+=X.l,Y.push(X),Ue+=jt.length,Y.push(jt),++we}return X=fe(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,we),X.write_shift(2,we),X.write_shift(4,Ue),X.write_shift(4,le),X.write_shift(2,0),Qt([Qt(W),Qt(Y),X])}var oa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nx(O,G){if(O.ctype)return O.ctype;var z=O.name||"",W=z.match(/\.([^\.]+)$/);return W&&oa[W[1]]||G&&(W=(z=G).match(/[\.\\]([^\.\\])+$/),W&&oa[W[1]])?oa[W[1]]:"application/octet-stream"}function sx(O){for(var G=Ui(O),z=[],W=0;W<G.length;W+=76)z.push(G.slice(W,W+76));return z.join(`\r
`)+`\r
`}function ix(O){var G=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],W=G.split(`\r
`),Y=0;Y<W.length;++Y){var X=W[Y];if(X.length==0){z.push("");continue}for(var ae=0;ae<X.length;){var pe=76,ie=X.slice(ae,ae+pe);ie.charAt(pe-1)=="="?pe--:ie.charAt(pe-2)=="="?pe-=2:ie.charAt(pe-3)=="="&&(pe-=3),ie=X.slice(ae,ae+pe),ae+=pe,ae<X.length&&(ie+="="),z.push(ie)}}return z.join(`\r
`)}function ax(O){for(var G=[],z=0;z<O.length;++z){for(var W=O[z];z<=O.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+O[++z];G.push(W)}for(var Y=0;Y<G.length;++Y)G[Y]=G[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Wr(G.join(`\r
`))}function ox(O,G,z){for(var W="",Y="",X="",ae,pe=0;pe<10;++pe){var ie=G[pe];if(!ie||ie.match(/^\s*$/))break;var oe=ie.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":W=oe[2].trim();break;case"content-type":X=oe[2].trim();break;case"content-transfer-encoding":Y=oe[2].trim();break}}switch(++pe,Y.toLowerCase()){case"base64":ae=Wr(Cn(G.slice(pe).join("")));break;case"quoted-printable":ae=ax(G.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var le=el(O,W.slice(z.length),ae,{unsafe:!0});X&&(le.ctype=X)}function lx(O,G){if(J(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=G&&G.root||"",W=(st&&Buffer.isBuffer(O)?O.toString("binary"):J(O)).split(`\r
`),Y=0,X="";for(Y=0;Y<W.length;++Y)if(X=W[Y],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),z||(z=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),X.slice(0,z.length)!=z););var ae=(W[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var pe="--"+(ae[1]||""),ie=[],oe=[],le={FileIndex:ie,FullPaths:oe};j(le);var we,Ae=0;for(Y=0;Y<W.length;++Y){var De=W[Y];De!==pe&&De!==pe+"--"||(Ae++&&ox(le,W.slice(we,Y),z),we=Y)}return le}function cx(O,G){var z=G||{},W=z.boundary||"SheetJS";W="------="+W;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],X=O.FullPaths[0],ae=X,pe=O.FileIndex[0],ie=1;ie<O.FullPaths.length;++ie)if(ae=O.FullPaths[ie].slice(X.length),pe=O.FileIndex[ie],!(!pe.size||!pe.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var oe=pe.content,le=st&&Buffer.isBuffer(oe)?oe.toString("binary"):J(oe),we=0,Ae=Math.min(1024,le.length),De=0,je=0;je<=Ae;++je)(De=le.charCodeAt(je))>=32&&De<128&&++we;var Re=we>=Ae*4/5;Y.push(W),Y.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ae),Y.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),Y.push("Content-Type: "+nx(pe,ae)),Y.push(""),Y.push(Re?ix(le):sx(le))}return Y.push(W+`--\r
`),Y.join(`\r
`)}function dx(O){var G={};return j(G,O),G}function el(O,G,z,W){var Y=W&&W.unsafe;Y||j(O);var X=!Y&&ft.find(O,G);if(!X){var ae=O.FullPaths[0];G.slice(0,ae.length)==ae?ae=G:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+G).replace("//","/")),X={name:i(G),type:2},O.FileIndex.push(X),O.FullPaths.push(ae),Y||ft.utils.cfb_gc(O)}return X.content=z,X.size=z?z.length:0,W&&(W.CLSID&&(X.clsid=W.CLSID),W.mt&&(X.mt=W.mt),W.ct&&(X.ct=W.ct)),X}function hx(O,G){j(O);var z=ft.find(O,G);if(z){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==z)return O.FileIndex.splice(W,1),O.FullPaths.splice(W,1),!0}return!1}function ux(O,G,z){j(O);var W=ft.find(O,G);if(W){for(var Y=0;Y<O.FileIndex.length;++Y)if(O.FileIndex[Y]==W)return O.FileIndex[Y].name=i(z),O.FullPaths[Y]=z,!0}return!1}function fx(O){C(O,!0)}return t.find=A,t.read=E,t.parse=h,t.write=ne,t.writeFile=M,t.utils={cfb_new:dx,cfb_add:el,cfb_del:hx,cfb_mov:ux,cfb_gc:fx,ReadShift:ki,CheckField:Jf,prep_blob:Er,bconcat:Qt,use_zlib:R,_deflateRaw:Ct,_inflateRaw:od,consts:D},t}();function dw(e){return typeof e=="string"?Wo(e):Array.isArray(e)?Lb(e):e}function Zi(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?qi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([dw(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Ji(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function er(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Ph(e,t){for(var r=[],s=er(e),i=0;i!==s.length;++i)r[e[s[i]][t]]==null&&(r[e[s[i]][t]]=s[i]);return r}function zc(e){for(var t=[],r=er(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Go(e){for(var t=[],r=er(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function hw(e){for(var t=[],r=er(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var So=new Date(1899,11,30,0,0,0);function br(e,t){var r=e.getTime(),s=So.getTime()+(e.getTimezoneOffset()-So.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var Df=new Date,uw=So.getTime()+(Df.getTimezoneOffset()-So.getTimezoneOffset())*6e4,Dh=Df.getTimezoneOffset();function Lf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+uw),t.getTimezoneOffset()!==Dh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Dh)*6e4),t}var Lh=new Date("2017-02-19T19:06:09.000Z"),Of=isNaN(Lh.getFullYear())?new Date("2/19/17"):Lh,fw=Of.getFullYear()==2017;function pr(e,t){var r=new Date(e);if(fw)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Of.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Yo(e,t){if(st&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function wr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=wr(e[r]));return t}function It(e,t){for(var r="";r.length<t;)r+=e;return r}function En(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(s)))?t/r:t}var xw=["january","february","march","april","may","june","july","august","september","october","november","december"];function zi(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&xw.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(i>0||a>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function He(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return st?s=Nn(r):s=Ob(r),ft.utils.cfb_add(e,t,s)}ft.utils.cfb_add(e,t,r)}else e.file(t,r)}function qc(){return ft.utils.cfb_new()}var Bt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Wc=zc(pw),Hc=/[&<>'"]/g,mw=/[\u0000-\u0008\u000b-\u001f]/g;function dt(e){var t=e+"";return t.replace(Hc,function(r){return Wc[r]}).replace(mw,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Oh(e){return dt(e).replace(/ /g,"_x0020_")}var Bf=/[\u0000-\u001f]/g;function gw(e){var t=e+"";return t.replace(Hc,function(r){return Wc[r]}).replace(/\n/g,"<br/>").replace(Bf,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function yw(e){var t=e+"";return t.replace(Hc,function(r){return Wc[r]}).replace(Bf,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function vw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function bw(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $l(e){for(var t="",r=0,s=0,i=0,a=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Bh(e){var t=ds(2*e.length),r,s,i=1,a=0,o=0,l;for(s=0;s<e.length;s+=i)i=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Mh(e){return Nn(e,"binary").toString("utf8")}var Pa="foo bar bazâð£",_i=st&&(Mh(Pa)==$l(Pa)&&Mh||Bh(Pa)==$l(Pa)&&Bh)||$l,qi=st?function(e){return Nn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,i=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},ww=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),Mf=/(^\s|\s$|\n)/;function Jt(e,t){return"<"+e+(t.match(Mf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Wi(e){return er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Te(e,t,r){return"<"+e+(r!=null?Wi(r):"")+(t!=null?(t.match(Mf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function jw(e,t){switch(typeof e){case"string":var r=Te("vt:lpwstr",dt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",dt(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",xc(e));throw new Error("Unable to serialize "+e)}var qt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_r={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Sw(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return s==2047?i==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),r*Math.pow(2,s-52)*i)}function Ew(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=s?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|s}var $h=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,a=e[0][s].length;i<a;i+=r)t.push.apply(t,e[0][s].slice(i,i+r));return t},Uh=st?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Nn(t)})):$h(e)}:$h,zh=function(e,t,r){for(var s=[],i=t;i<r;i+=2)s.push(String.fromCharCode(yi(e,i)));return s.join("").replace(Ti,"")},Vc=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ti,""):zh(e,t,r)}:zh,qh=function(e,t,r){for(var s=[],i=t;i<t+r;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},$f=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qh(e,t,r)}:qh,Wh=function(e,t,r){for(var s=[],i=t;i<r;i++)s.push(String.fromCharCode(Bs(e,i)));return s.join("")},ea=st?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):Wh(t,r,s)}:Wh,Uf=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},zf=Uf,qf=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},Wf=qf,Hf=function(e,t){var r=2*kr(e,t);return r>0?ea(e,t+4,t+4+r-1):""},Vf=Hf,Gf=function(t,r){var s=kr(t,r);return s>0?Vc(t,r+4,r+4+s):""},Yf=Gf,Kf=function(e,t){var r=kr(e,t);return r>0?ea(e,t+4,t+4+r):""},Xf=Kf,Qf=function(e,t){return Sw(e,t)},Eo=Qf,Gc=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};st&&(zf=function(t,r){if(!Buffer.isBuffer(t))return Uf(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Wf=function(t,r){if(!Buffer.isBuffer(t))return qf(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},Vf=function(t,r){if(!Buffer.isBuffer(t))return Hf(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},Yf=function(t,r){if(!Buffer.isBuffer(t))return Gf(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},Xf=function(t,r){if(!Buffer.isBuffer(t))return Kf(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Eo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Qf(t,r)},Gc=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bs=function(e,t){return e[t]},yi=function(e,t){return e[t+1]*256+e[t]},Tw=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},rs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},_w=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ki(e,t){var r="",s,i,a=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,st&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(yi(this,c)),c+=2;e*=2;break;case"utf8":r=ea(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Vc(this,this.l,this.l+e);break;case"wstr":return ki.call(this,e,"dbcs");case"lpstr-ansi":r=zf(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":r=Wf(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":r=Vf(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),r=Yf(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),r=Xf(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Bs(this,this.l+e++))!==0;)a.push(Na(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=yi(this,this.l+e))!==0;)a.push(Na(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Bs(this,c),this.l=c+1,l=ki.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Na(yi(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Bs(this,c),this.l=c+1,l=ki.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Na(Bs(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return s=Bs(this,this.l),this.l++,s;case 2:return s=(t==="i"?Tw:yi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?rs:_w)(this,this.l),this.l+=4,s):(i=kr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Eo(this,this.l):i=Eo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=$f(this,this.l,e);break}}return this.l+=e,r}var kw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Cw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Aw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Iw(e,t,r){var s=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Aw(this,t.charCodeAt(i),this.l+2*i);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;s=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,kw(this,t,this.l);break;case 8:if(s=8,r==="f"){Ew(this,t,this.l);break}case 16:break;case-4:s=4,Cw(this,t,this.l);break}return this.l+=s,this}function Jf(e,t){var r=$f(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Er(e,t){e.l=t,e.read_shift=ki,e.chk=Jf,e.write_shift=Iw}function xn(e,t){e.l+=t}function fe(e){var t=ds(e);return Er(t,0),t}function vr(){var e=[],t=st?256:2048,r=function(c){var h=fe(c);return Er(h,0),h},s=r(t),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},a=function(c){return s&&c<s.length-s.l?s:(i(),s=r(Math.max(c+1,t)))},o=function(){return i(),Qt(e)},l=function(c){i(),s=c,s.l==null&&(s.l=s.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ge(e,t,r,s){var i=+t,a;if(!isNaN(i)){s||(s=S_[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,s>=128&&++a,s>=16384&&++a,s>=2097152&&++a;var o=e.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Gc(r)&&e.push(r)}}function Ci(e,t,r){var s=wr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Hh(e,t,r){var s=wr(e);return s.s=Ci(s.s,t.s,r),s.e=Ci(s.e,t.s,r),s}function Ai(e,t){if(e.cRel&&e.c<0)for(e=wr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=wr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=Rw(r)),!e.rRel&&e.rRel!=null&&(r=Nw(r)),r}function Ul(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+lr(e.s.c)+":"+(e.e.cRel?"":"$")+lr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zt(e.s.r)+":"+(e.e.rRel?"":"$")+Zt(e.e.r):Ai(e.s,t.biff)+":"+Ai(e.e,t.biff)}function Yc(e){return parseInt(Fw(e),10)-1}function Zt(e){return""+(e+1)}function Nw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Fw(e){return e.replace(/\$(\d+)$/,"$1")}function Kc(e){for(var t=Pw(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function lr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Rw(e){return e.replace(/^([A-Z])/,"$$$1")}function Pw(e){return e.replace(/^\$([A-Z])/,"$1")}function Dw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wt(e){for(var t=0,r=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Nr(e){var t=e.indexOf(":");return t==-1?{s:Wt(e),e:Wt(e)}:{s:Wt(e.slice(0,t)),e:Wt(e.slice(t+1))}}function Ot(e,t){return typeof t>"u"||typeof t=="number"?Ot(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,i=0,a=e.length;for(r=0;s<a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.s.c=--r,r=0;s<a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;if(t.s.r=--r,s===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=a&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)r=26*r+i;for(t.e.c=--r,r=0;s!=a&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)r=10*r+i;return t.e.r=--r,t}function Vh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qn(e.z,r?br(t):t)}catch{}try{return e.w=qn((e.XF||{}).numFmtId||(r?14:0),r?br(t):t)}catch{return""+t}}function An(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ta[e.v]||e.v:t==null?Vh(e,e.v):Vh(e,t))}function gs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function Zf(e,t,r){var s=r||{},i=e?Array.isArray(e):s.dense,a=e||(i?[]:{}),o=0,l=0;if(a&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Wt(s.origin):s.origin;o=d.r,l=d.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=bt(a["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),o==-1&&(c.e.r=o=h.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[x].length;++u)if(!(typeof t[x][u]>"u")){var p={v:t[x][u]},g=o+x,f=l+u;if(c.s.r>g&&(c.s.r=g),c.s.c>f&&(c.s.c=f),c.e.r<g&&(c.e.r=g),c.e.c<f&&(c.e.c=f),t[x][u]&&typeof t[x][u]=="object"&&!Array.isArray(t[x][u])&&!(t[x][u]instanceof Date))p=t[x][u];else if(Array.isArray(p.v)&&(p.f=t[x][u][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(s.nullError)p.t="e",p.v=0;else if(s.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=s.dateNF||Nt[14],s.cellDates?(p.t="d",p.w=qn(p.z,br(p.v))):(p.t="n",p.v=br(p.v),p.w=qn(p.z,p.v))):p.t="s";if(i)a[g]||(a[g]=[]),a[g][f]&&a[g][f].z&&(p.z=a[g][f].z),a[g][f]=p;else{var m=ht({c:f,r:g});a[m]&&a[m].z&&(p.z=a[m].z),a[m]=p}}}return c.s.c<1e7&&(a["!ref"]=Ot(c)),a}function ti(e,t){return Zf(null,e,t)}function Lw(e){return e.read_shift(4,"i")}function Kr(e,t){return t||(t=fe(4)),t.write_shift(4,e),t}function cr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ht(e,t){var r=!1;return t==null&&(r=!0,t=fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Ow(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Bw(e,t){return t||(t=fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Xc(e,t){var r=e.l,s=e.read_shift(1),i=cr(e),a=[],o={t:i,h:i};if(s&1){for(var l=e.read_shift(4),d=0;d!=l;++d)a.push(Ow(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Mw(e,t){var r=!1;return t==null&&(r=!0,t=fe(15+4*e.t.length)),t.write_shift(1,0),Ht(e.t,t),r?t.slice(0,t.l):t}var $w=Xc;function Uw(e,t){var r=!1;return t==null&&(r=!0,t=fe(23+4*e.t.length)),t.write_shift(1,1),Ht(e.t,t),t.write_shift(4,1),Bw({},t),r?t.slice(0,t.l):t}function Mr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ys(e,t){return t==null&&(t=fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bs(e,t){return t==null&&(t=fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var zw=cr,e0=Ht;function Qc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function To(e,t){var r=!1;return t==null&&(r=!0,t=fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var qw=cr,pc=Qc,Jc=To;function t0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var i=s===0?Eo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):rs(t,0)>>2;return r?i/100:i}function r0(e,t){t==null&&(t=fe(4));var r=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function n0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Ww(e,t){return t||(t=fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ws=n0,ri=Ww;function ni(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hs(e,t){return(t||fe(8)).write_shift(8,e,"f")}function Hw(e){var t={},r=e.read_shift(1),s=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=i;var c=e2[i];c&&(t.rgb=nu(c));break;case 2:t.rgb=nu([o,l,d]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function _o(e,t){if(t||(t=fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function Vw(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Gw(e,t){t||(t=fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var s0=2,Sr=3,Da=11,ko=19,La=64,Yw=65,Kw=71,Xw=4108,Qw=4126,Xt=80,Gh={1:{n:"CodePage",t:s0},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:Sr},5:{n:"LineCount",t:Sr},6:{n:"ParagraphCount",t:Sr},7:{n:"SlideCount",t:Sr},8:{n:"NoteCount",t:Sr},9:{n:"HiddenCount",t:Sr},10:{n:"MultimediaClipCount",t:Sr},11:{n:"ScaleCrop",t:Da},12:{n:"HeadingPairs",t:Xw},13:{n:"TitlesOfParts",t:Qw},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:Da},17:{n:"CharacterCount",t:Sr},19:{n:"SharedDoc",t:Da},22:{n:"HyperlinksChanged",t:Da},23:{n:"AppVersion",t:Sr,p:"version"},24:{n:"DigSig",t:Yw},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:ko},2147483651:{n:"Behavior",t:ko},1919054434:{}},Yh={1:{n:"CodePage",t:s0},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:La},11:{n:"LastPrinted",t:La},12:{n:"CreatedDate",t:La},13:{n:"ModifiedDate",t:La},14:{n:"PageCount",t:Sr},15:{n:"WordCount",t:Sr},16:{n:"CharCount",t:Sr},17:{n:"Thumbnail",t:Kw},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:Sr},255:{},2147483648:{n:"Locale",t:ko},2147483651:{n:"Behavior",t:ko},1919054434:{}};function Jw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Zw=Jw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e2=wr(Zw),ta={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},t2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Oa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function i0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function a0(e,t){var r=hw(t2),s=[],i;s[s.length]=Bt,s[s.length]=Te("Types",null,{xmlns:qt.CT,"xmlns:xsd":qt.xsd,"xmlns:xsi":qt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Te("Default",null,{Extension:d[0],ContentType:d[1]})}));var a=function(d){e[d]&&e[d].length>0&&(i=e[d][0],s[s.length]=Te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Oa[d][t.bookType]||Oa[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){s[s.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Oa[d][t.bookType]||Oa[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){s[s.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function o0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Hs(e){var t=[Bt,Te("Relationships",null,{xmlns:qt.RELS})];return er(e["!id"]).forEach(function(r){t[t.length]=Te("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function lt(e,t,r,s,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=s,i.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function r2(e){var t=[Bt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Kh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function n2(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function s2(e){var t=[Bt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Kh(e[r][0],e[r][1])),t.push(n2("",e[r][0]));return t.push(Kh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function l0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vo.version+"</meta:generator></office:meta></office:document-meta>"}var is=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function zl(e,t,r,s,i){i[e]!=null||t==null||t===""||(i[e]=t,t=dt(t),s[s.length]=r?Te(e,t,r):Jt(e,t))}function c0(e,t){var r=t||{},s=[Bt,Te("cp:coreProperties",null,{"xmlns:cp":qt.CORE_PROPS,"xmlns:dc":qt.dc,"xmlns:dcterms":qt.dcterms,"xmlns:dcmitype":qt.dcmitype,"xmlns:xsi":qt.xsi})],i={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&zl("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:xc(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&zl("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:xc(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var a=0;a!=is.length;++a){var o=is[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&zl(o[0],l,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Vs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],d0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function h0(e){var t=[],r=Te;return e||(e={}),e.Application="SheetJS",t[t.length]=Bt,t[t.length]=Te("Properties",null,{xmlns:qt.EXT_PROPS,"xmlns:vt":qt.vt}),Vs.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=dt(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(s[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+dt(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function u0(e){var t=[Bt,Te("Properties",null,{xmlns:qt.CUST_PROPS,"xmlns:vt":qt.vt})];if(!e)return t.join("");var r=1;return er(e).forEach(function(i){++r,t[t.length]=Te("property",jw(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Xh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function i2(e,t){var r=[];return er(Xh).map(function(s){for(var i=0;i<is.length;++i)if(is[i][1]==s)return is[i];for(i=0;i<Vs.length;++i)if(Vs[i][1]==s)return Vs[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Jt(Xh[s[1]]||s[1],i))}}),Te("DocumentProperties",r.join(""),{xmlns:_r.o})}function a2(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&er(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<is.length;++o)if(a==is[o][1])return;for(o=0;o<Vs.length;++o)if(a==Vs[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),i.push(Te(Oh(a),l,{"dt:dt":d}))}}),t&&er(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Te(Oh(a),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+_r.o+'">'+i.join("")+"</"+s+">"}function o2(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),i=(r-s)/Math.pow(2,32);s*=1e7,i*=1e7;var a=s/Math.pow(2,32)|0;a>0&&(s=s%Math.pow(2,32),i+=a);var o=fe(8);return o.write_shift(4,s),o.write_shift(4,i),o}function Qh(e,t){var r=fe(4),s=fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=fe(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=o2(t);break;case 31:case 80:for(s=fe(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qt([r,s])}var f0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function l2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Jh(e,t,r){var s=fe(8),i=[],a=[],o=8,l=0,d=fe(8),c=fe(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),a.push(d),i.push(c),o+=8+d.length,!t){c=fe(8),c.write_shift(4,0),i.unshift(c);var h=[fe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var x=e[l][0];for(d=fe(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);h.push(d)}d=Qt(h),a.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(f0.indexOf(e[l][0])>-1||d0.indexOf(e[l][0])>-1)&&e[l][1]!=null){var u=e[l][1],p=0;if(t){p=+t[e[l][0]];var g=r[p];if(g.p=="version"&&typeof u=="string"){var f=u.split(".");u=(+f[0]<<16)+(+f[1]||0)}d=Qh(g.t,u)}else{var m=l2(u);m==-1&&(m=31,u=String(u)),d=Qh(m,u)}a.push(d),c=fe(8),c.write_shift(4,t?p:2+l),i.push(c),o+=8+d.length}var v=8*(a.length+1);for(l=0;l<a.length;++l)i[l].write_shift(4,v),v+=a[l].length;return s.write_shift(4,o),s.write_shift(4,a.length),Qt([s].concat(i).concat(a))}function Zh(e,t,r,s,i,a){var o=fe(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ft.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var d=Jh(e,r,s);if(l.push(d),i){var c=Jh(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+d.length),l.push(c)}return Qt(l)}function c2(e,t){t||(t=fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function d2(e,t){return e.read_shift(t)===1}function ur(e,t){return t||(t=fe(2)),t.write_shift(2,+!!e),t}function x0(e){return e.read_shift(2,"u")}function Pr(e,t){return t||(t=fe(2)),t.write_shift(2,e),t}function p0(e,t,r){return r||(r=fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function m0(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=s?e.read_shift(s,i):"";return o}function h2(e){var t=e.t||"",r=fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=fe(2*t.length);s.write_shift(2*t.length,t,"utf16le");var i=[r,s];return Qt(i)}function u2(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function f2(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):u2(e,s,r)}function x2(e,t,r){if(r.biff>5)return f2(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function g0(e,t,r){return r||(r=fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function eu(e,t){t||(t=fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function p2(e){var t=fe(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),a=i>-1?31:23;switch(s.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)s=s.slice(1),eu(s,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?s.slice(0,i):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&eu(i>-1?s.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function us(e,t,r,s){return s||(s=fe(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function m2(e,t,r){var s=r.biff>8?4:2,i=e.read_shift(s),a=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[i,a,o]}function g2(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:t},e:{c:i,r}}}function y0(e,t){return t||(t=fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Zc(e,t,r){var s=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=fe(i);return a.write_shift(2,s),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function y2(e,t){var r=!t||t.biff==8,s=fe(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function v2(e,t){var r=!t||t.biff>=8?2:1,s=fe(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function b2(e,t){var r=fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=h2(e[i]);var a=Qt([r].concat(s));return a.parts=[r.length].concat(s.map(function(o){return o.length})),a}function w2(){var e=fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function j2(e){var t=fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function S2(e,t){var r=e.name||"Arial",s=t&&t.biff==5,i=s?15+r.length:16+2*r.length,a=fe(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),a}function E2(e,t,r,s){var i=fe(10);return us(e,t,s,i),i.write_shift(4,r),i}function T2(e,t,r,s,i){var a=!i||i.biff==8,o=fe(8+ +a+(1+a)*r.length);return us(e,t,s,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function _2(e,t,r,s){var i=r&&r.biff==5;s||(s=fe(i?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(i?1:2,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=s.length>s.l?s.slice(0,s.l):s;return a.l==null&&(a.l=a.length),a}function k2(e,t){var r=t.biff==8||!t.biff?4:2,s=fe(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function tu(e,t,r,s){var i=r&&r.biff==5;s||(s=fe(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),s.write_shift(4,a),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function C2(e){var t=fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function A2(e,t,r,s,i,a){var o=fe(8);return us(e,t,s,o),p0(r,a,o),o}function I2(e,t,r,s){var i=fe(14);return us(e,t,s,i),hs(r,i),i}function N2(e,t,r){if(r.biff<8)return F2(e,t,r);for(var s=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)s.push(m2(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function F2(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=m0(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function R2(e){var t=fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)y0(e[r],t);return t}function P2(e){var t=fe(24),r=Wt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(s[i],16));return Qt([t,p2(e[1])])}function D2(e){var t=e[1].Tooltip,r=fe(10+2*(t.length+1));r.write_shift(2,2048);var s=Wt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function L2(e){return e||(e=fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function O2(e,t,r){if(!r.cellStyles)return xn(e,t);var s=r&&r.biff>=12?4:2,i=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var c={s:i,e:a,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function B2(e,t){var r=fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function M2(e){for(var t=fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function $2(e,t,r){var s=fe(15);return na(s,e,t),s.write_shift(8,r,"f"),s}function U2(e,t,r){var s=fe(9);return na(s,e,t),s.write_shift(2,r),s}var z2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],h=ds(1);switch(d.type){case"base64":h=Wr(Cn(l));break;case"binary":h=Wr(l);break;case"buffer":case"array":h=l;break}Er(h,0);var x=h.read_shift(1),u=!!(x&136),p=!1,g=!1;switch(x){case 2:break;case 3:break;case 48:p=!0,u=!0;break;case 49:p=!0,u=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var f=0,m=521;x==2&&(f=h.read_shift(2)),h.l+=3,x!=2&&(f=h.read_shift(4)),f>1048576&&(f=1e6),x!=2&&(m=h.read_shift(2));var v=h.read_shift(2),w=d.codepage||1252;x!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(w=e[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var _=[],y={},b=Math.min(h.length,x==2?521:m-10-(p?264:0)),E=g?32:11;h.l<b&&h[h.l]!=13;)switch(y={},y.name=Th.utils.decode(w,h.slice(h.l,h.l+E)).replace(/[\u0000\r\n].*$/g,""),h.l+=E,y.type=String.fromCharCode(h.read_shift(1)),x!=2&&!g&&(y.offset=h.read_shift(4)),y.len=h.read_shift(1),x==2&&(y.offset=h.read_shift(2)),y.dec=h.read_shift(1),y.name.length&&_.push(y),x!=2&&(h.l+=g?13:14),y.type){case"B":(!p||y.len!=8)&&d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(h[h.l]!==13&&(h.l=m-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=m;var j=0,S=0;for(c[0]=[],S=0;S!=_.length;++S)c[0][S]=_[S].name;for(;f-- >0;){if(h[h.l]===42){h.l+=v;continue}for(++h.l,c[++j]=[],S=0,S=0;S!=_.length;++S){var C=h.slice(h.l,h.l+_[S].len);h.l+=_[S].len,Er(C,0);var T=Th.utils.decode(w,C);switch(_[S].type){case"C":T.trim().length&&(c[j][S]=T.replace(/\s+$/,""));break;case"D":T.length===8?c[j][S]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):c[j][S]=T;break;case"F":c[j][S]=parseFloat(T.trim());break;case"+":case"I":c[j][S]=g?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":c[j][S]=!0;break;case"N":case"F":c[j][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));c[j][S]="##MEMO##"+(g?parseInt(T.trim(),10):C.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(c[j][S]=+T||0);break;case"@":c[j][S]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":c[j][S]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":c[j][S]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[j][S]=-C.read_shift(-8,"f");break;case"B":if(p&&_[S].len==8){c[j][S]=C.read_shift(8,"f");break}case"G":case"P":C.l+=_[S].len;break;case"0":if(_[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[S].type)}}}if(x!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=_,c}function s(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var h=ti(r(l,c),c);return h["!cols"]=c.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete c.DBF,h}function i(l,d){try{return gs(s(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&$i(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=vr(),x=Fo(l,{header:1,raw:!0,cellDates:!0}),u=x[0],p=x.slice(1),g=l["!cols"]||[],f=0,m=0,v=0,w=1;for(f=0;f<u.length;++f){if(((g[f]||{}).DBF||{}).name){u[f]=g[f].DBF.name,++v;continue}if(u[f]!=null){if(++v,typeof u[f]=="number"&&(u[f]=u[f].toString(10)),typeof u[f]!="string")throw new Error("DBF Invalid column name "+u[f]+" |"+typeof u[f]+"|");if(u.indexOf(u[f])!==f){for(m=0;m<1024;++m)if(u.indexOf(u[f]+"_"+m)==-1){u[f]+="_"+m;break}}}}var _=bt(l["!ref"]),y=[],b=[],E=[];for(f=0;f<=_.e.c-_.s.c;++f){var j="",S="",C=0,T=[];for(m=0;m<p.length;++m)p[m][f]!=null&&T.push(p[m][f]);if(T.length==0||u[f]==null){y[f]="?";continue}for(m=0;m<T.length;++m){switch(typeof T[m]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=T[m]instanceof Date?"D":"C";break;default:S="C"}C=Math.max(C,String(T[m]).length),j=j&&j!=S?"C":S}C>250&&(C=250),S=((g[f]||{}).DBF||{}).type,S=="C"&&g[f].DBF.len>C&&(C=g[f].DBF.len),j=="B"&&S=="N"&&(j="N",E[f]=g[f].DBF.dec,C=g[f].DBF.len),b[f]=j=="C"||S=="N"?C:a[j]||0,w+=b[f],y[f]=j}var A=h.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*v),A.write_shift(2,w),f=0;f<4;++f)A.write_shift(4,0);for(A.write_shift(4,0|(+t[bf]||3)<<8),f=0,m=0;f<u.length;++f)if(u[f]!=null){var I=h.next(32),P=(u[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,P,"sbcs"),I.write_shift(1,y[f]=="?"?"C":y[f],"sbcs"),I.write_shift(4,m),I.write_shift(1,b[f]||a[y[f]]||0),I.write_shift(1,E[f]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),m+=b[f]||a[y[f]]||0}var N=h.next(264);for(N.write_shift(4,13),f=0;f<65;++f)N.write_shift(4,0);for(f=0;f<p.length;++f){var q=h.next(w);for(q.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(y[m]){case"L":q.write_shift(1,p[f][m]==null?63:p[f][m]?84:70);break;case"B":q.write_shift(8,p[f][m]||0,"f");break;case"N":var L="0";for(typeof p[f][m]=="number"&&(L=p[f][m].toFixed(E[m]||0)),v=0;v<b[m]-L.length;++v)q.write_shift(1,32);q.write_shift(1,L,"sbcs");break;case"D":p[f][m]?(q.write_shift(4,("0000"+p[f][m].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(p[f][m].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+p[f][m].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var D=String(p[f][m]!=null?p[f][m]:"").slice(0,b[m]);for(q.write_shift(1,D,"sbcs"),v=0;v<b[m]-D.length;++v)q.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:s,from_sheet:o}}(),q2=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,p){var g=e[p];return typeof g=="number"?Eh(g):g},s=function(u,p,g){var f=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return f==59?u:Eh(f)};e["|"]=254;function i(u,p){switch(p.type){case"base64":return a(Cn(u),p);case"binary":return a(u,p);case"buffer":return a(st&&Buffer.isBuffer(u)?u.toString("binary"):Ji(u),p);case"array":return a(Yo(u),p)}throw new Error("Unrecognized type "+p.type)}function a(u,p){var g=u.split(/[\n\r]+/),f=-1,m=-1,v=0,w=0,_=[],y=[],b=null,E={},j=[],S=[],C=[],T=0,A;for(+p.codepage>=0&&$i(+p.codepage);v!==g.length;++v){T=0;var I=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),P=I.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),N=P[0],q;if(I.length>0)switch(N){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&y.push(I.slice(3).replace(/;;/g,";"));break;case"C":var L=!1,D=!1,M=!1,J=!1,ne=-1,Z=-1;for(w=1;w<P.length;++w)switch(P[w].charAt(0)){case"A":break;case"X":m=parseInt(P[w].slice(1))-1,D=!0;break;case"Y":for(f=parseInt(P[w].slice(1))-1,D||(m=0),A=_.length;A<=f;++A)_[A]=[];break;case"K":q=P[w].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(En(q))?isNaN(zi(q).getDate())||(q=pr(q)):(q=En(q),b!==null&&Ff(b)&&(q=Lf(q))),L=!0;break;case"E":J=!0;var R=Uj(P[w].slice(1),{r:f,c:m});_[f][m]=[_[f][m],R];break;case"S":M=!0,_[f][m]=[_[f][m],"S5S"];break;case"G":break;case"R":ne=parseInt(P[w].slice(1))-1;break;case"C":Z=parseInt(P[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(L&&(_[f][m]&&_[f][m].length==2?_[f][m][0]=q:_[f][m]=q,b=null),M){if(J)throw new Error("SYLK shared formula cannot have own formula");var U=ne>-1&&_[ne][Z];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[f][m][1]=zj(U[1],{r:f-ne,c:m-Z})}break;case"F":var B=0;for(w=1;w<P.length;++w)switch(P[w].charAt(0)){case"X":m=parseInt(P[w].slice(1))-1,++B;break;case"Y":for(f=parseInt(P[w].slice(1))-1,A=_.length;A<=f;++A)_[A]=[];break;case"M":T=parseInt(P[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=y[parseInt(P[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=P[w].slice(1).split(" "),A=parseInt(C[0],10);A<=parseInt(C[1],10);++A)T=parseInt(C[2],10),S[A-1]=T===0?{hidden:!0}:{wch:T},ed(S[A-1]);break;case"C":m=parseInt(P[w].slice(1))-1,S[m]||(S[m]={});break;case"R":f=parseInt(P[w].slice(1))-1,j[f]||(j[f]={}),T>0?(j[f].hpt=T,j[f].hpx=S0(T)):T===0&&(j[f].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}B<1&&(b=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return j.length>0&&(E["!rows"]=j),S.length>0&&(E["!cols"]=S),p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),[_,E]}function o(u,p){var g=i(u,p),f=g[0],m=g[1],v=ti(f,p);return er(m).forEach(function(w){v[w]=m[w]}),v}function l(u,p){return gs(o(u,p),p)}function d(u,p,g,f){var m="C;Y"+(g+1)+";X"+(f+1)+";K";switch(u.t){case"n":m+=u.v||0,u.f&&!u.F&&(m+=";E"+rd(u.f,{r:g,c:f}));break;case"b":m+=u.v?"TRUE":"FALSE";break;case"e":m+=u.w||u.v;break;case"d":m+='"'+(u.w||u.v)+'"';break;case"s":m+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(u,p){p.forEach(function(g,f){var m="F;W"+(f+1)+" "+(f+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Co(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ao(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function h(u,p){p.forEach(function(g,f){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*Io(g.hpx)+";"),m.length>2&&u.push(m+"R"+(f+1))})}function x(u,p){var g=["ID;PWXL;N;E"],f=[],m=bt(u["!ref"]),v,w=Array.isArray(u),_=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),u["!cols"]&&c(g,u["!cols"]),u["!rows"]&&h(g,u["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var y=m.s.r;y<=m.e.r;++y)for(var b=m.s.c;b<=m.e.c;++b){var E=ht({r:y,c:b});v=w?(u[y]||[])[b]:u[E],!(!v||v.v==null&&(!v.f||v.F))&&f.push(d(v,u,y,b))}return g.join(_)+_+f.join(_)+_+"E"+_}return{to_workbook:l,to_sheet:o,from_sheet:x}}(),W2=function(){function e(a,o){switch(o.type){case"base64":return t(Cn(a),o);case"binary":return t(a,o);case"buffer":return t(st&&Buffer.isBuffer(a)?a.toString("binary"):Ji(a),o);case"array":return t(Yo(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),d=-1,c=-1,h=0,x=[];h!==l.length;++h){if(l[h].trim()==="BOT"){x[++d]=[],c=0;continue}if(!(d<0)){var u=l[h].trim().split(","),p=u[0],g=u[1];++h;for(var f=l[h]||"";(f.match(/["]/g)||[]).length&1&&h<l.length-1;)f+=`
`+l[++h];switch(f=f.trim(),+p){case-1:if(f==="BOT"){x[++d]=[],c=0;continue}else if(f!=="EOD")throw new Error("Unrecognized DIF special command "+f);break;case 0:f==="TRUE"?x[d][c]=!0:f==="FALSE"?x[d][c]=!1:isNaN(En(g))?isNaN(zi(g).getDate())?x[d][c]=g:x[d][c]=pr(g):x[d][c]=En(g),++c;break;case 1:f=f.slice(1,f.length-1),f=f.replace(/""/g,'"'),f&&f.match(/^=".*"$/)&&(f=f.slice(2,-1)),x[d][c++]=f!==""?f:null;break}if(f==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(a,o){return ti(e(a,o),o)}function s(a,o){return gs(r(a,o),o)}var i=function(){var a=function(d,c,h,x,u){d.push(c),d.push(h+","+x),d.push('"'+u.replace(/"/g,'""')+'"')},o=function(d,c,h,x){d.push(c+","+h),d.push(c==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var c=[],h=bt(d["!ref"]),x,u=Array.isArray(d);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,h.e.r-h.s.r+1,""),a(c,"TUPLES",0,h.e.c-h.s.c+1,""),a(c,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){o(c,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var f=ht({r:p,c:g});if(x=u?(d[p]||[])[g]:d[f],!x){o(c,1,0,"");continue}switch(x.t){case"n":var m=x.w;!m&&x.v!=null&&(m=x.v),m==null?x.f&&!x.F?o(c,1,0,"="+x.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=qn(x.z||Nt[14],br(pr(x.v)))),o(c,0,x.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}}();return{to_workbook:s,to_sheet:r,from_sheet:i}}(),v0=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,u){for(var p=x.split(`
`),g=-1,f=-1,m=0,v=[];m!==p.length;++m){var w=p[m].trim().split(":");if(w[0]==="cell"){var _=Wt(w[1]);if(v.length<=_.r)for(g=v.length;g<=_.r;++g)v[g]||(v[g]=[]);switch(g=_.r,f=_.c,w[2]){case"t":v[g][f]=e(w[3]);break;case"v":v[g][f]=+w[3];break;case"vtf":var y=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[g][f]=!!+w[4];break;default:v[g][f]=+w[4];break}w[2]=="vtf"&&(v[g][f]=[v[g][f],y])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function s(x,u){return ti(r(x,u),u)}function i(x,u){return gs(s(x,u),u)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(x){if(!x||!x["!ref"])return"";for(var u=[],p=[],g,f="",m=Nr(x["!ref"]),v=Array.isArray(x),w=m.s.r;w<=m.e.r;++w)for(var _=m.s.c;_<=m.e.c;++_)if(f=ht({r:w,c:_}),g=v?(x[w]||[])[_]:x[f],!(!g||g.v==null||g.t==="z")){switch(p=["cell",f,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var y=br(pr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+y,p[5]=g.w||qn(g.z||Nt[14],y);break;case"e":continue}u.push(p.join(":"))}return u.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(x){return[a,o,l,o,c(x),d].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:h}}(),H2=function(){function e(h,x,u,p,g){g.raw?x[u][p]=h:h===""||(h==="TRUE"?x[u][p]=!0:h==="FALSE"?x[u][p]=!1:isNaN(En(h))?isNaN(zi(h).getDate())?x[u][p]=h:x[u][p]=pr(h):x[u][p]=En(h))}function t(h,x){var u=x||{},p=[];if(!h||h.length===0)return p;for(var g=h.split(/[\r\n]/),f=g.length-1;f>=0&&g[f].length===0;)--f;for(var m=10,v=0,w=0;w<=f;++w)v=g[w].indexOf(" "),v==-1?v=g[w].length:v++,m=Math.max(m,v);for(w=0;w<=f;++w){p[w]=[];var _=0;for(e(g[w].slice(0,m).trim(),p,w,_,u),_=1;_<=(g[w].length-m)/10+1;++_)e(g[w].slice(m+(_-1)*10,m+_*10).trim(),p,w,_,u)}return u.sheetRows&&(p=p.slice(0,u.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(h){for(var x={},u=!1,p=0,g=0;p<h.length;++p)(g=h.charCodeAt(p))==34?u=!u:!u&&g in r&&(x[g]=(x[g]||0)+1);g=[];for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&g.push([x[p],p]);if(!g.length){x=s;for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&g.push([x[p],p])}return g.sort(function(f,m){return f[0]-m[0]||s[f[1]]-s[m[1]]}),r[g.pop()[1]]||44}function a(h,x){var u=x||{},p="",g=u.dense?[]:{},f={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):u&&u.FS?p=u.FS:p=i(h.slice(0,1024));var m=0,v=0,w=0,_=0,y=0,b=p.charCodeAt(0),E=!1,j=0,S=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var C=u.dateNF!=null?ow(u.dateNF):null;function T(){var A=h.slice(_,y),I={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)I.t="z";else if(u.raw)I.t="s",I.v=A;else if(A.trim().length===0)I.t="s",I.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(I.t="s",I.v=A.slice(2,-1).replace(/""/g,'"')):qj(A)?(I.t="n",I.f=A.slice(1)):(I.t="s",I.v=A);else if(A=="TRUE")I.t="b",I.v=!0;else if(A=="FALSE")I.t="b",I.v=!1;else if(!isNaN(w=En(A)))I.t="n",u.cellText!==!1&&(I.w=A),I.v=w;else if(!isNaN(zi(A).getDate())||C&&A.match(C)){I.z=u.dateNF||Nt[14];var P=0;C&&A.match(C)&&(A=lw(A,u.dateNF,A.match(C)||[]),P=1),u.cellDates?(I.t="d",I.v=pr(A,P)):(I.t="n",I.v=br(pr(A,P))),u.cellText!==!1&&(I.w=qn(I.z,I.v instanceof Date?br(I.v):I.v)),u.cellNF||delete I.z}else I.t="s",I.v=A;if(I.t=="z"||(u.dense?(g[m]||(g[m]=[]),g[m][v]=I):g[ht({c:v,r:m})]=I),_=y+1,S=h.charCodeAt(_),f.e.c<v&&(f.e.c=v),f.e.r<m&&(f.e.r=m),j==b)++v;else if(v=0,++m,u.sheetRows&&u.sheetRows<=m)return!0}e:for(;y<h.length;++y)switch(j=h.charCodeAt(y)){case 34:S===34&&(E=!E);break;case b:case 10:case 13:if(!E&&T())break e;break}return y-_>0&&T(),g["!ref"]=Ot(f),g}function o(h,x){return!(x&&x.PRN)||x.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,x):ti(t(h,x),x)}function l(h,x){var u="",p=x.type=="string"?[0,0,0,0]:nk(h,x);switch(x.type){case"base64":u=Cn(h);break;case"binary":u=h;break;case"buffer":x.codepage==65001?u=h.toString("utf8"):(x.codepage,u=st&&Buffer.isBuffer(h)?h.toString("binary"):Ji(h));break;case"array":u=Yo(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+x.type)}return p[0]==239&&p[1]==187&&p[2]==191?u=_i(u.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?u=_i(u):x.type=="binary",u.slice(0,19)=="socialcalc:version:"?v0.to_sheet(x.type=="string"?u:_i(u),x):o(u,x)}function d(h,x){return gs(l(h,x),x)}function c(h){for(var x=[],u=bt(h["!ref"]),p,g=Array.isArray(h),f=u.s.r;f<=u.e.r;++f){for(var m=[],v=u.s.c;v<=u.e.c;++v){var w=ht({r:f,c:v});if(p=g?(h[f]||[])[v]:h[w],!p||p.v==null){m.push("          ");continue}for(var _=(p.w||(An(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";m.push(_+(v===0?" ":""))}x.push(m.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}}(),ru=function(){function e(R,U,B){if(R){Er(R,R.l||0);for(var F=B.Enum||ne;R.l<R.length;){var V=R.read_shift(2),se=F[V]||F[65535],xe=R.read_shift(2),me=R.l+xe,Q=se.f&&se.f(R,xe,B);if(R.l=me,U(Q,se,V))return}}}function t(R,U){switch(U.type){case"base64":return r(Wr(Cn(R)),U);case"binary":return r(Wr(R),U);case"buffer":case"array":return r(R,U)}throw"Unsupported type "+U.type}function r(R,U){if(!R)return R;var B=U||{},F=B.dense?[]:{},V="Sheet1",se="",xe=0,me={},Q=[],ee=[],ce={s:{r:0,c:0},e:{r:0,c:0}},Ie=B.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)B.Enum=ne,e(R,function(ye,ze,qe){switch(qe){case 0:B.vers=ye,ye>=4096&&(B.qpro=!0);break;case 6:ce=ye;break;case 204:ye&&(se=ye);break;case 222:se=ye;break;case 15:case 51:B.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:qe==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=B.dateNF||Nt[14],B.cellDates&&(ye[1].t="d",ye[1].v=Lf(ye[1].v))),B.qpro&&ye[3]>xe&&(F["!ref"]=Ot(ce),me[V]=F,Q.push(V),F=B.dense?[]:{},ce={s:{r:0,c:0},e:{r:0,c:0}},xe=ye[3],V=se||"Sheet"+(xe+1),se="");var Ft=B.dense?(F[ye[0].r]||[])[ye[0].c]:F[ht(ye[0])];if(Ft){Ft.t=ye[1].t,Ft.v=ye[1].v,ye[1].z!=null&&(Ft.z=ye[1].z),ye[1].f!=null&&(Ft.f=ye[1].f);break}B.dense?(F[ye[0].r]||(F[ye[0].r]=[]),F[ye[0].r][ye[0].c]=ye[1]):F[ht(ye[0])]=ye[1];break}},B);else if(R[2]==26||R[2]==14)B.Enum=Z,R[2]==14&&(B.qpro=!0,R.l=0),e(R,function(ye,ze,qe){switch(qe){case 204:V=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>xe&&(F["!ref"]=Ot(ce),me[V]=F,Q.push(V),F=B.dense?[]:{},ce={s:{r:0,c:0},e:{r:0,c:0}},xe=ye[3],V="Sheet"+(xe+1)),Ie>0&&ye[0].r>=Ie)break;B.dense?(F[ye[0].r]||(F[ye[0].r]=[]),F[ye[0].r][ye[0].c]=ye[1]):F[ht(ye[0])]=ye[1],ce.e.c<ye[0].c&&(ce.e.c=ye[0].c),ce.e.r<ye[0].r&&(ce.e.r=ye[0].r);break;case 27:ye[14e3]&&(ee[ye[14e3][0]]=ye[14e3][1]);break;case 1537:ee[ye[0]]=ye[1],ye[0]==xe&&(V=ye[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(F["!ref"]=Ot(ce),me[se||V]=F,Q.push(se||V),!ee.length)return{SheetNames:Q,Sheets:me};for(var re={},_e=[],Ne=0;Ne<ee.length;++Ne)me[Q[Ne]]?(_e.push(ee[Ne]||Q[Ne]),re[ee[Ne]]=me[ee[Ne]]||me[Q[Ne]]):(_e.push(ee[Ne]),re[ee[Ne]]={"!ref":"A1"});return{SheetNames:_e,Sheets:re}}function s(R,U){var B=U||{};if(+B.codepage>=0&&$i(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var F=vr(),V=bt(R["!ref"]),se=Array.isArray(R),xe=[];ke(F,0,a(1030)),ke(F,6,d(V));for(var me=Math.min(V.e.r,8191),Q=V.s.r;Q<=me;++Q)for(var ee=Zt(Q),ce=V.s.c;ce<=V.e.c;++ce){Q===V.s.r&&(xe[ce]=lr(ce));var Ie=xe[ce]+ee,re=se?(R[Q]||[])[ce]:R[Ie];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?ke(F,13,p(Q,ce,re.v)):ke(F,14,f(Q,ce,re.v));else{var _e=An(re);ke(F,15,x(Q,ce,_e.slice(0,239)))}}return ke(F,1),F.end()}function i(R,U){var B=U||{};if(+B.codepage>=0&&$i(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var F=vr();ke(F,0,o(R));for(var V=0,se=0;V<R.SheetNames.length;++V)(R.Sheets[R.SheetNames[V]]||{})["!ref"]&&ke(F,27,J(R.SheetNames[V],se++));var xe=0;for(V=0;V<R.SheetNames.length;++V){var me=R.Sheets[R.SheetNames[V]];if(!(!me||!me["!ref"])){for(var Q=bt(me["!ref"]),ee=Array.isArray(me),ce=[],Ie=Math.min(Q.e.r,8191),re=Q.s.r;re<=Ie;++re)for(var _e=Zt(re),Ne=Q.s.c;Ne<=Q.e.c;++Ne){re===Q.s.r&&(ce[Ne]=lr(Ne));var ye=ce[Ne]+_e,ze=ee?(me[re]||[])[Ne]:me[ye];if(!(!ze||ze.t=="z"))if(ze.t=="n")ke(F,23,T(re,Ne,xe,ze.v));else{var qe=An(ze);ke(F,22,j(re,Ne,xe,qe.slice(0,239)))}}++xe}}return ke(F,1),F.end()}function a(R){var U=fe(2);return U.write_shift(2,R),U}function o(R){var U=fe(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var B=0,F=0,V=0,se=0;se<R.SheetNames.length;++se){var xe=R.SheetNames[se],me=R.Sheets[xe];if(!(!me||!me["!ref"])){++V;var Q=Nr(me["!ref"]);B<Q.e.r&&(B=Q.e.r),F<Q.e.c&&(F=Q.e.c)}}return B>8191&&(B=8191),U.write_shift(2,B),U.write_shift(1,V),U.write_shift(1,F),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(R,U,B){var F={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&B.qpro?(F.s.c=R.read_shift(1),R.l++,F.s.r=R.read_shift(2),F.e.c=R.read_shift(1),R.l++,F.e.r=R.read_shift(2),F):(F.s.c=R.read_shift(2),F.s.r=R.read_shift(2),U==12&&B.qpro&&(R.l+=2),F.e.c=R.read_shift(2),F.e.r=R.read_shift(2),U==12&&B.qpro&&(R.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function d(R){var U=fe(8);return U.write_shift(2,R.s.c),U.write_shift(2,R.s.r),U.write_shift(2,R.e.c),U.write_shift(2,R.e.r),U}function c(R,U,B){var F=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(F[0].c=R.read_shift(1),F[3]=R.read_shift(1),F[0].r=R.read_shift(2),R.l+=2):(F[2]=R.read_shift(1),F[0].c=R.read_shift(2),F[0].r=R.read_shift(2)),F}function h(R,U,B){var F=R.l+U,V=c(R,U,B);if(V[1].t="s",B.vers==20768){R.l++;var se=R.read_shift(1);return V[1].v=R.read_shift(se,"utf8"),V}return B.qpro&&R.l++,V[1].v=R.read_shift(F-R.l,"cstr"),V}function x(R,U,B){var F=fe(7+B.length);F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,R),F.write_shift(1,39);for(var V=0;V<F.length;++V){var se=B.charCodeAt(V);F.write_shift(1,se>=128?95:se)}return F.write_shift(1,0),F}function u(R,U,B){var F=c(R,U,B);return F[1].v=R.read_shift(2,"i"),F}function p(R,U,B){var F=fe(7);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,R),F.write_shift(2,B,"i"),F}function g(R,U,B){var F=c(R,U,B);return F[1].v=R.read_shift(8,"f"),F}function f(R,U,B){var F=fe(13);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,R),F.write_shift(8,B,"f"),F}function m(R,U,B){var F=R.l+U,V=c(R,U,B);if(V[1].v=R.read_shift(8,"f"),B.qpro)R.l=F;else{var se=R.read_shift(2);y(R.slice(R.l,R.l+se),V),R.l+=se}return V}function v(R,U,B){var F=U&32768;return U&=-32769,U=(F?R:0)+(U>=8192?U-16384:U),(F?"":"$")+(B?lr(U):Zt(U))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(R,U){Er(R,0);for(var B=[],F=0,V="",se="",xe="",me="";R.l<R.length;){var Q=R[R.l++];switch(Q){case 0:B.push(R.read_shift(8,"f"));break;case 1:se=v(U[0].c,R.read_shift(2),!0),V=v(U[0].r,R.read_shift(2),!1),B.push(se+V);break;case 2:{var ee=v(U[0].c,R.read_shift(2),!0),ce=v(U[0].r,R.read_shift(2),!1);se=v(U[0].c,R.read_shift(2),!0),V=v(U[0].r,R.read_shift(2),!1),B.push(ee+ce+":"+se+V)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(R.read_shift(2));break;case 6:{for(var Ie="";Q=R[R.l++];)Ie+=String.fromCharCode(Q);B.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:me=B.pop(),xe=B.pop(),B.push(["AND","OR"][Q-20]+"("+xe+","+me+")");break;default:if(Q<32&&_[Q])me=B.pop(),xe=B.pop(),B.push(xe+_[Q]+me);else if(w[Q]){if(F=w[Q][1],F==69&&(F=R[R.l++]),F>B.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+B.join("|")+"|");return}var re=B.slice(-F);B.length-=F,B.push(w[Q][0]+"("+re.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}B.length==1?U[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function b(R){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=R.read_shift(2),U[3]=R[R.l++],U[0].c=R[R.l++],U}function E(R,U){var B=b(R);return B[1].t="s",B[1].v=R.read_shift(U-4,"cstr"),B}function j(R,U,B,F){var V=fe(6+F.length);V.write_shift(2,R),V.write_shift(1,B),V.write_shift(1,U),V.write_shift(1,39);for(var se=0;se<F.length;++se){var xe=F.charCodeAt(se);V.write_shift(1,xe>=128?95:xe)}return V.write_shift(1,0),V}function S(R,U){var B=b(R);B[1].v=R.read_shift(2);var F=B[1].v>>1;if(B[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return B[1].v=F,B}function C(R,U){var B=b(R),F=R.read_shift(4),V=R.read_shift(4),se=R.read_shift(2);if(se==65535)return F===0&&V===3221225472?(B[1].t="e",B[1].v=15):F===0&&V===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var xe=se&32768;return se=(se&32767)-16446,B[1].v=(1-xe*2)*(V*Math.pow(2,se+32)+F*Math.pow(2,se)),B}function T(R,U,B,F){var V=fe(14);if(V.write_shift(2,R),V.write_shift(1,B),V.write_shift(1,U),F==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var se=0,xe=0,me=0,Q=0;return F<0&&(se=1,F=-F),xe=Math.log2(F)|0,F/=Math.pow(2,xe-31),Q=F>>>0,Q&2147483648||(F/=2,++xe,Q=F>>>0),F-=Q,Q|=2147483648,Q>>>=0,F*=Math.pow(2,32),me=F>>>0,V.write_shift(4,me),V.write_shift(4,Q),xe+=16383+(se?32768:0),V.write_shift(2,xe),V}function A(R,U){var B=C(R);return R.l+=U-14,B}function I(R,U){var B=b(R),F=R.read_shift(4);return B[1].v=F>>6,B}function P(R,U){var B=b(R),F=R.read_shift(8,"f");return B[1].v=F,B}function N(R,U){var B=P(R);return R.l+=U-10,B}function q(R,U){return R[R.l+U-1]==0?R.read_shift(U,"cstr"):""}function L(R,U){var B=R[R.l++];B>U-1&&(B=U-1);for(var F="";F.length<B;)F+=String.fromCharCode(R[R.l++]);return F}function D(R,U,B){if(!(!B.qpro||U<21)){var F=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var V=R.read_shift(U-21,"cstr");return[F,V]}}function M(R,U){for(var B={},F=R.l+U;R.l<F;){var V=R.read_shift(2);if(V==14e3){for(B[V]=[0,""],B[V][0]=R.read_shift(2);R[R.l];)B[V][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return B}function J(R,U){var B=fe(5+R.length);B.write_shift(2,14e3),B.write_shift(2,U);for(var F=0;F<R.length;++F){var V=R.charCodeAt(F);B[B.l++]=V>127?95:V}return B[B.l++]=0,B}var ne={0:{n:"BOF",f:x0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:L},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:N},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:D},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:t}}(),V2=/^\s|\s$|[\t\n\r]/;function b0(e,t){if(!t.bookSST)return"";var r=[Bt];r[r.length]=Te("sst",null,{xmlns:ei[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(V2)&&(a+=' xml:space="preserve"'),a+=">"+dt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function G2(e){return[e.read_shift(4),e.read_shift(4)]}function Y2(e,t){return t||(t=fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var K2=Mw;function X2(e){var t=vr();ge(t,159,Y2(e));for(var r=0;r<e.length;++r)ge(t,19,K2(e[r]));return ge(t,160),t.end()}function Q2(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function w0(e){var t=0,r,s=Q2(e),i=s.length+1,a,o,l,d,c;for(r=ds(i),r[0]=s.length,a=1;a!=i;++a)r[a]=s[a-1];for(a=i-1;a>=0;--a)o=r[a],l=t&16384?1:0,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var J2=function(){function e(i,a){switch(a.type){case"base64":return t(Cn(i),a);case"binary":return t(i,a);case"buffer":return t(st&&Buffer.isBuffer(i)?i.toString("binary"):Ji(i),a);case"array":return t(Yo(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},l=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(h,x){Array.isArray(l)&&(l[x]=[]);for(var u=/\\\w+\b/g,p=0,g,f=-1;g=u.exec(h);){switch(g[0]){case"\\cell":var m=h.slice(p,u.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++f,m.length){var v={v:m,t:"s"};Array.isArray(l)?l[x][f]=v:l[ht({r:x,c:f})]=v}break}p=u.lastIndex}f>c.e.c&&(c.e.c=f)}),l["!ref"]=Ot(c),l}function r(i,a){return gs(e(i,a),a)}function s(i){for(var a=["{\\rtf1\\ansi"],o=bt(i["!ref"]),l,d=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){a.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var x=ht({r:c,c:h});l=d?(i[c]||[])[h]:i[x],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(An(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function nu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Z2=6,Tn=Z2;function Co(e){return Math.floor((e+Math.round(128/Tn)/256)*Tn)}function Ao(e){return Math.floor((e-5)/Tn*100+.5)/100}function mc(e){return Math.round((e*Tn+5)/Tn*256)/256}function ed(e){e.width?(e.wpx=Co(e.width),e.wch=Ao(e.wpx),e.MDW=Tn):e.wpx?(e.wch=Ao(e.wpx),e.width=mc(e.wch),e.MDW=Tn):typeof e.wch=="number"&&(e.width=mc(e.wch),e.wpx=Co(e.width),e.MDW=Tn),e.customWidth&&delete e.customWidth}var ej=96,j0=ej;function Io(e){return e*96/j0}function S0(e){return e*j0/96}function tj(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=Te("numFmt",null,{numFmtId:s,formatCode:dt(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function rj(e){var t=[];return t[t.length]=Te("cellXfs",null),e.forEach(function(r){t[t.length]=Te("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function E0(e,t){var r=[Bt,Te("styleSheet",null,{xmlns:ei[0],"xmlns:vt":qt.vt})],s;return e.SSF&&(s=tj(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=rj(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function nj(e,t){var r=e.read_shift(2),s=cr(e);return[r,s]}function sj(e,t,r){r||(r=fe(6+4*t.length)),r.write_shift(2,e),Ht(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function ij(e,t,r){var s={};s.sz=e.read_shift(2)/20;var i=Vw(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var a=e.read_shift(2);switch(a===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=Hw(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=cr(e),s}function aj(e,t){t||(t=fe(25+4*32)),t.write_shift(2,e.sz*20),Gw(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_o(e.color,t);var s=0;return s=2,t.write_shift(1,s),Ht(e.name,t),t.length>t.l?t.slice(0,t.l):t}var oj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ql,lj=xn;function su(e,t){t||(t=fe(4*3+8*7+16*1)),ql||(ql=zc(oj));var r=ql[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(_o({auto:1},t),_o({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function cj(e,t){var r=e.l+t,s=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:i}}function T0(e,t,r){r||(r=fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function mi(e,t){return t||(t=fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var dj=xn;function hj(e,t){return t||(t=fe(51)),t.write_shift(1,0),mi(null,t),mi(null,t),mi(null,t),mi(null,t),mi(null,t),t.length>t.l?t.slice(0,t.l):t}function uj(e,t){return t||(t=fe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),To(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function fj(e,t,r){var s=fe(2052);return s.write_shift(4,e),To(t,s),To(r,s),s.length>s.l?s.slice(0,s.l):s}function xj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&++r}),r!=0&&(ge(e,615,Kr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&ge(e,44,sj(i,t[i]))}),ge(e,616))}}function pj(e){var t=1;ge(e,611,Kr(t)),ge(e,43,aj({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function mj(e){var t=2;ge(e,603,Kr(t)),ge(e,45,su({patternType:"none"})),ge(e,45,su({patternType:"gray125"})),ge(e,604)}function gj(e){var t=1;ge(e,613,Kr(t)),ge(e,46,hj()),ge(e,614)}function yj(e){var t=1;ge(e,626,Kr(t)),ge(e,47,T0({numFmtId:0},65535)),ge(e,627)}function vj(e,t){ge(e,617,Kr(t.length)),t.forEach(function(r){ge(e,47,T0(r,0))}),ge(e,618)}function bj(e){var t=1;ge(e,619,Kr(t)),ge(e,48,uj({xfId:0,name:"Normal"})),ge(e,620)}function wj(e){var t=0;ge(e,505,Kr(t)),ge(e,506)}function jj(e){var t=0;ge(e,508,fj(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function Sj(e,t){var r=vr();return ge(r,278),xj(r,e.SSF),pj(r),mj(r),gj(r),yj(r),vj(r,t.cellXfs),bj(r),wj(r),jj(r),ge(r,279),r.end()}function _0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ej(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:cr(e)}}function Tj(e){var t=fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ht(e.name,t),t.slice(0,t.l)}function _j(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function kj(e){var t=fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Cj(e,t){var r=fe(8+2*t.length);return r.write_shift(4,e),Ht(t,r),r.slice(0,r.l)}function Aj(e){return e.l+=4,e.read_shift(4)!=0}function Ij(e,t){var r=fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Nj(){var e=vr();return ge(e,332),ge(e,334,Kr(1)),ge(e,335,Tj({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,Cj(1,"XLDAPR")),ge(e,52),ge(e,35,Kr(514)),ge(e,4096,Kr(0)),ge(e,4097,Pr(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,Ij(1)),ge(e,51,kj([[1,0]])),ge(e,338),ge(e,333),e.end()}function k0(){var e=[Bt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Fj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var $s=1024;function C0(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Te("xml",null,{"xmlns:v":_r.v,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:mv":_r.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];$s<e*1e3;)$s+=1e3;return t.forEach(function(a){var o=Wt(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Te("v:fill",d,l),h={on:"t",obscured:"t"};++$s,i=i.concat(["<v:shape"+Wi({id:"_x0000_s"+$s,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Te("v:shadow",null,h),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Jt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Jt("x:AutoFill","False"),Jt("x:Row",String(o.r)),Jt("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function A0(e){var t=[Bt,Te("comments",null,{xmlns:ei[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var a=dt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var i=0,a=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(i=r.indexOf(dt(d.a))),a.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(Jt("t",dt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(Jt("t",dt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Rj(e,t,r){var s=[Bt,Te("ThreadedComments",null,{xmlns:qt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=d.id:d.parentId=a,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(Te("threadedComment",Jt("text",o.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function Pj(e){var t=[Bt,Te("personList",null,{xmlns:qt.TCMNT,"xmlns:x":ei[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Dj(e){var t={};t.iauthor=e.read_shift(4);var r=ws(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function Lj(e,t){return t==null&&(t=fe(36)),t.write_shift(4,e[1].iauthor),ri(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Oj=cr;function Bj(e){return Ht(e.slice(0,54))}function Mj(e){var t=vr(),r=[];return ge(t,628),ge(t,630),e.forEach(function(s){s[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ge(t,632,Bj(i.a)))})}),ge(t,631),ge(t,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Wt(s[0]),e:Wt(s[0])};ge(t,635,Lj([a,i])),i.t&&i.t.length>0&&ge(t,637,Uw(i)),ge(t,636),delete i.iauthor})}),ge(t,634),ge(t,629),t.end()}function $j(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ft.utils.cfb_add(e,i,t.FileIndex[s].content)}})}var I0=["xlsb","xlsm","xlam","biff8","xla"],Uj=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,i,a,o){var l=!1,d=!1;a.length==0?d=!0:a.charAt(0)=="["&&(d=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,d?c+=t.r:--c,i+(l?"":"$")+lr(h)+(d?"":"$")+Zt(c)}return function(i,a){return t=a,i.replace(e,r)}}(),td=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rd=function(){return function(t,r){return t.replace(td,function(s,i,a,o,l,d){var c=Kc(o)-(a?0:r.c),h=Yc(d)-(l?0:r.r),x=h==0?"":l?h+1:"["+h+"]",u=c==0?"":a?c+1:"["+c+"]";return i+"R"+x+"C"+u})}}();function zj(e,t){return e.replace(td,function(r,s,i,a,o,l){return s+(i=="$"?i+a:lr(Kc(a)+t.c))+(o=="$"?o+l:Zt(Yc(l)+t.r))})}function qj(e){return e.length!=1}function Rt(e){e.l+=1}function Wn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function N0(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return F0(e);r.biff==12&&(s=4)}var i=e.read_shift(s),a=e.read_shift(s),o=Wn(e),l=Wn(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function F0(e){var t=Wn(e),r=Wn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Wj(e,t,r){if(r.biff<8)return F0(e);var s=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Wn(e),o=Wn(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function R0(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Hj(e);var s=e.read_shift(r&&r.biff==12?4:2),i=Wn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function Hj(e){var t=Wn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Vj(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Gj(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Yj(e);var i=e.read_shift(s>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function Yj(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:s}}function Kj(e,t,r){var s=(e[e.l++]&96)>>5,i=N0(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,i]}function Xj(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=N0(e,a,r);return[s,i,o]}function Qj(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Jj(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[s,i]}function Zj(e,t,r){var s=(e[e.l++]&96)>>5,i=Wj(e,t-1,r);return[s,i]}function eS(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function iu(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function tS(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=s;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function rS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function nS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function sS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iS(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function P0(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function aS(e){return e.read_shift(2),P0(e)}function oS(e){return e.read_shift(2),P0(e)}function lS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=R0(e,0,r);return[s,i]}function cS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=Gj(e,0,r);return[s,i]}function dS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=R0(e,0,r);return[s,i,a]}function hS(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[hE[i],O0[i],s]}function uS(e,t,r){var s=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:fS(e);return[i,(a[0]===0?O0:dE)[a[1]]]}function fS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function xS(e,t,r){e.l+=r&&r.biff==2?3:4}function pS(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function mS(e){return e.l++,ta[e.read_shift(1)]}function gS(e){return e.l++,e.read_shift(2)}function yS(e){return e.l++,e.read_shift(1)!==0}function vS(e){return e.l++,ni(e)}function bS(e,t,r){return e.l++,m0(e,t-1,r)}function wS(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=d2(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ta[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ni(e);break;case 2:r[1]=x2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jS(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=s;++a)i.push((r.biff==12?ws:g2)(e));return i}function SS(e,t,r){var s=0,i=0;r.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--i==0&&(i=256));for(var a=0,o=[];a!=s&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=wS(e,r.biff);return o}function ES(e,t,r){var s=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,a]}function TS(e,t,r){if(r.biff==5)return _S(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[s,i,a]}function _S(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function kS(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function CS(e,t,r){var s=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[s,i]}function AS(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function IS(e,t,r){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[s,i]}var NS=xn,FS=xn,RS=xn;function ra(e,t,r){return e.l+=2,[Vj(e)]}function nd(e){return e.l+=6,[]}var PS=ra,DS=nd,LS=nd,OS=ra;function D0(e){return e.l+=2,[x0(e),e.read_shift(2)&1]}var BS=ra,MS=D0,$S=nd,US=ra,zS=ra,qS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WS(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=qS[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:i,C:a}}function HS(e){return e.l+=2,[e.read_shift(4)]}function VS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function GS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function YS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XS(e){return e.l+=4,[0,0]}var au={1:{n:"PtgExp",f:pS},2:{n:"PtgTbl",f:RS},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:bS},26:{n:"PtgSheet",f:VS},27:{n:"PtgEndSheet",f:GS},28:{n:"PtgErr",f:mS},29:{n:"PtgBool",f:yS},30:{n:"PtgInt",f:gS},31:{n:"PtgNum",f:vS},32:{n:"PtgArray",f:eS},33:{n:"PtgFunc",f:hS},34:{n:"PtgFuncVar",f:uS},35:{n:"PtgName",f:ES},36:{n:"PtgRef",f:lS},37:{n:"PtgArea",f:Kj},38:{n:"PtgMemArea",f:kS},39:{n:"PtgMemErr",f:NS},40:{n:"PtgMemNoMem",f:FS},41:{n:"PtgMemFunc",f:CS},42:{n:"PtgRefErr",f:AS},43:{n:"PtgAreaErr",f:Qj},44:{n:"PtgRefN",f:cS},45:{n:"PtgAreaN",f:Zj},46:{n:"PtgMemAreaN",f:YS},47:{n:"PtgMemNoMemN",f:KS},57:{n:"PtgNameX",f:TS},58:{n:"PtgRef3d",f:dS},59:{n:"PtgArea3d",f:Xj},60:{n:"PtgRefErr3d",f:IS},61:{n:"PtgAreaErr3d",f:Jj},255:{}},QS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JS={1:{n:"PtgElfLel",f:D0},2:{n:"PtgElfRw",f:US},3:{n:"PtgElfCol",f:PS},6:{n:"PtgElfRwV",f:zS},7:{n:"PtgElfColV",f:OS},10:{n:"PtgElfRadical",f:BS},11:{n:"PtgElfRadicalS",f:$S},13:{n:"PtgElfColS",f:DS},15:{n:"PtgElfColSV",f:LS},16:{n:"PtgElfRadicalLel",f:MS},25:{n:"PtgList",f:WS},29:{n:"PtgSxName",f:HS},255:{}},ZS={0:{n:"PtgAttrNoop",f:XS},1:{n:"PtgAttrSemi",f:iS},2:{n:"PtgAttrIf",f:nS},4:{n:"PtgAttrChoose",f:tS},8:{n:"PtgAttrGoto",f:rS},16:{n:"PtgAttrSum",f:xS},32:{n:"PtgAttrBaxcel",f:iu},33:{n:"PtgAttrBaxcel",f:iu},64:{n:"PtgAttrSpace",f:aS},65:{n:"PtgAttrSpaceSemi",f:oS},128:{n:"PtgAttrIfError",f:sS},255:{}};function eE(e,t,r,s){if(s.biff<8)return xn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=SS(e,0,s),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=jS(e,r[o][1],s),a.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(xn(e,t)),a}function tE(e,t,r){for(var s=e.l+t,i,a,o=[];s!=e.l;)t=s-e.l,a=e[e.l],i=au[a]||au[QS[a]],(a===24||a===25)&&(i=(a===24?JS:ZS)[e[e.l+1]]),!i||!i.f?xn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function rE(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],i=[],a=0;a<s.length;++a){var o=s[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var nE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sE(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function L0(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function ou(e,t,r){var s=L0(e,t,r);return s=="#REF"?s:sE(s,r)}function Ks(e,t,r,s,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},l=[],d,c,h,x=0,u=0,p,g="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,w=e[0].length;v<w;++v){var _=e[0][v];switch(_[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=It(" ",e[0][f][1][1]);break;case 1:m=It("\r",e[0][f][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}c=c+m,f=-1}l.push(c+nE[_[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Ci(_[1][1],o,i),l.push(Ai(h,a));break;case"PtgRefN":h=r?Ci(_[1][1],r,i):_[1][1],l.push(Ai(h,a));break;case"PtgRef3d":x=_[1][1],h=Ci(_[1][2],o,i),g=ou(s,x,i),l.push(g+"!"+Ai(h,a));break;case"PtgFunc":case"PtgFuncVar":var y=_[1][0],b=_[1][1];y||(y=0),y&=127;var E=y==0?[]:l.slice(-y);l.length-=y,b==="User"&&(b=E.shift()),l.push(b+"("+E.join(",")+")");break;case"PtgBool":l.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(_[1]);break;case"PtgNum":l.push(String(_[1]));break;case"PtgStr":l.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(_[1]);break;case"PtgAreaN":p=Hh(_[1][1],r?{s:r}:o,i),l.push(Ul(p,i));break;case"PtgArea":p=Hh(_[1][1],o,i),l.push(Ul(p,i));break;case"PtgArea3d":x=_[1][1],p=_[1][2],g=ou(s,x,i),l.push(g+"!"+Ul(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=_[1][2];var j=(s.names||[])[u-1]||(s[0]||[])[u],S=j?j.Name:"SH33TJSNAME"+String(u);S&&S.slice(0,6)=="_xlfn."&&!i.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var C=_[1][1];u=_[1][2];var T;if(i.biff<=5)C<0&&(C=-C),s[C]&&(T=s[C][u]);else{var A="";if(((s[C]||[])[0]||[])[0]==14849||(((s[C]||[])[0]||[])[0]==1025?s[C][u]&&s[C][u].itab>0&&(A=s.SheetNames[s[C][u].itab-1]+"!"):A=s.SheetNames[u-1]+"!"),s[C]&&s[C][u])A+=s[C][u].Name;else if(s[0]&&s[0][u])A+=s[0][u].Name;else{var I=(L0(s,C,i)||"").split(";;");I[u-1]?A=I[u-1]:A+="SH33TJSERRX"}l.push(A);break}T||(T={Name:"SH33TJSERRY"}),l.push(T.Name);break;case"PtgParen":var P="(",N=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:P=It(" ",e[0][f][1][1])+P;break;case 3:P=It("\r",e[0][f][1][1])+P;break;case 4:N=It(" ",e[0][f][1][1])+N;break;case 5:N=It("\r",e[0][f][1][1])+N;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}l.push(P+l.pop()+N);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var q={c:r.c,r:r.r};if(s.sharedf[ht(h)]){var L=s.sharedf[ht(h)];l.push(Ks(L,o,q,s,i))}else{var D=!1;for(d=0;d!=s.arrayf.length;++d)if(c=s.arrayf[d],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){l.push(Ks(c[1],o,q,s,i)),D=!0;break}D||l.push(_[1])}break;case"PtgArray":l.push("{"+rE(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&f>=0&&M.indexOf(e[0][v][0])==-1){_=e[0][f];var J=!0;switch(_[1][0]){case 4:J=!1;case 0:m=It(" ",_[1][1]);break;case 5:J=!1;case 1:m=It("\r",_[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}l.push((J?m:"")+l.pop()+(J?"":m)),f=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function iE(e){if(e==null){var t=fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return hs(e);return hs(0)}function aE(e,t,r,s,i){var a=us(t,r,i),o=iE(e.v),l=fe(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=fe(e.bf.length),h=0;h<e.bf.length;++h)c[h]=e.bf[h];var x=Qt([a,o,l,c]);return x}function Ko(e,t,r){var s=e.read_shift(4),i=tE(e,s,r),a=e.read_shift(4),o=a>0?eE(e,a,i,r):null;return[i,o]}var oE=Ko,Xo=Ko,lE=Ko,cE=Ko,dE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},O0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uE(e){var t="of:="+e.replace(td,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function fE(e){return e.replace(/\./,"!")}var Ii=typeof Map<"u";function sd(e,t,r){var s=0,i=e.length;if(r){if(Ii?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ii?r.get(t):r[t];s<a.length;++s)if(e[a[s]].t===t)return e.Count++,a[s]}}else for(;s<i;++s)if(e[s].t===t)return e.Count++,s;return e[i]={t},e.Count++,e.Unique++,r&&(Ii?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Qo(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Tn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Ao(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=mc(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function B0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Kn(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(s==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Rf(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=s=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===s)return i;return e[a]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function xE(e,t,r){if(e&&e["!ref"]){var s=bt(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pE(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ot(e[r])+'"/>';return t+"</mergeCells>"}function mE(e,t,r,s,i){var a=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}a=!0,o.codeName=qi(dt(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+Te("outlinePr",null,c)}!a&&!l||(i[i.length]=Te("sheetPr",l,o))}var gE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],yE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vE(e){var t={sheet:1};return gE.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),yE.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=w0(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,t)}function bE(e){return B0(e),Te("pageMargins",null,e)}function wE(e,t){for(var r=["<cols>"],s,i=0;i!=t.length;++i)(s=t[i])&&(r[r.length]=Te("col",null,Qo(i,s)));return r[r.length]="</cols>",r.join("")}function jE(e,t,r,s){var i=typeof e.ref=="string"?e.ref:Ot(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Nr(i);o.s.r==o.e.r&&(o.e.r=Nr(t["!ref"]).e.r,i=Ot(o));for(var l=0;l<a.length;++l){var d=a[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Te("autoFilter",null,{ref:i})}function SE(e,t,r,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,i),{})}function EE(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ta[e.v];break;case"d":s&&s.cellDates?i=pr(e.v,-1).toISOString():(e=wr(e),e.t="n",i=""+(e.v=br(pr(e.v)))),typeof e.z>"u"&&(e.z=Nt[14]);break;default:i=e.v;break}var l=Jt("v",dt(i)),d={r:t},c=Kn(s.cellXfs,e,s);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=Jt("v",""+sd(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Te("f",dt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Te("c",l,d)}function TE(e,t,r,s){var i=[],a=[],o=bt(e["!ref"]),l="",d,c="",h=[],x=0,u=0,p=e["!rows"],g=Array.isArray(e),f={r:c},m,v=-1;for(u=o.s.c;u<=o.e.c;++u)h[u]=lr(u);for(x=o.s.r;x<=o.e.r;++x){for(a=[],c=Zt(x),u=o.s.c;u<=o.e.c;++u){d=h[u]+c;var w=g?(e[x]||[])[u]:e[d];w!==void 0&&(l=EE(w,d,e,t))!=null&&a.push(l)}(a.length>0||p&&p[x])&&(f={r:c},p&&p[x]&&(m=p[x],m.hidden&&(f.hidden=1),v=-1,m.hpx?v=Io(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(f.ht=v,f.customHeight=1),m.level&&(f.outlineLevel=m.level)),i[i.length]=Te("row",a.join(""),f))}if(p)for(;x<p.length;++x)p&&p[x]&&(f={r:x+1},m=p[x],m.hidden&&(f.hidden=1),v=-1,m.hpx?v=Io(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(f.ht=v,f.customHeight=1),m.level&&(f.outlineLevel=m.level),i[i.length]=Te("row","",f));return i.join("")}function M0(e,t,r,s){var i=[Bt,Te("worksheet",null,{xmlns:ei[0],"xmlns:r":qt.r})],a=r.SheetNames[e],o=0,l="",d=r.Sheets[a];d==null&&(d={});var c=d["!ref"]||"A1",h=bt(c);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=Ot(h)}s||(s={}),d["!comments"]=[];var x=[];mE(d,r,e,t,i),i[i.length]=Te("dimension",null,{ref:c}),i[i.length]=SE(d,t,e,r),t.sheetFormat&&(i[i.length]=Te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=wE(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=TE(d,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=vE(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=jE(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=pE(d["!merges"]));var u=-1,p,g=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(f){f[1].Target&&(p={ref:f[0]},f[1].Target.charAt(0)!="#"&&(g=lt(s,-1,dt(f[1].Target).replace(/#.*$/,""),rt.HLINK),p["r:id"]="rId"+g),(u=f[1].Target.indexOf("#"))>-1&&(p.location=dt(f[1].Target.slice(u+1))),f[1].Tooltip&&(p.tooltip=dt(f[1].Tooltip)),i[i.length]=Te("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=bE(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Jt("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:c}))),x.length>0&&(g=lt(s,-1,"../drawings/drawing"+(e+1)+".xml",rt.DRAW),i[i.length]=Te("drawing",null,{"r:id":"rId"+g}),d["!drawing"]=x),d["!comments"].length>0&&(g=lt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rt.VML),i[i.length]=Te("legacyDrawing",null,{"r:id":"rId"+g}),d["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function _E(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=s,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function kE(e,t,r){var s=fe(145),i=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var a=320;i.hpx?a=Io(i.hpx)*20:i.hpt&&(a=i.hpt*20),s.write_shift(2,a),s.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,d=s.l;s.l+=4;for(var c={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var x=-1,u=-1,p=h<<10;p<h+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ht(c)];g&&(x<0&&(x=p),u=p)}x<0||(++l,s.write_shift(4,x),s.write_shift(4,u))}var f=s.l;return s.l=d,s.write_shift(4,l),s.l=f,s.length>s.l?s.slice(0,s.l):s}function CE(e,t,r,s){var i=kE(s,r,t);(i.length>17||(t["!rows"]||[])[s])&&ge(e,0,i)}var AE=ws,IE=ri;function NE(){}function FE(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=zw(e),r}function RE(e,t,r){r==null&&(r=fe(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var i=1;i<3;++i)r.write_shift(1,0);return _o({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),e0(e,r),r.slice(0,r.l)}function PE(e){var t=Mr(e);return[t]}function DE(e,t,r){return r==null&&(r=fe(8)),ys(t,r)}function LE(e){var t=vs(e);return[t]}function OE(e,t,r){return r==null&&(r=fe(4)),bs(t,r)}function BE(e){var t=Mr(e),r=e.read_shift(1);return[t,r,"b"]}function ME(e,t,r){return r==null&&(r=fe(9)),ys(t,r),r.write_shift(1,e.v?1:0),r}function $E(e){var t=vs(e),r=e.read_shift(1);return[t,r,"b"]}function UE(e,t,r){return r==null&&(r=fe(5)),bs(t,r),r.write_shift(1,e.v?1:0),r}function zE(e){var t=Mr(e),r=e.read_shift(1);return[t,r,"e"]}function qE(e,t,r){return r==null&&(r=fe(9)),ys(t,r),r.write_shift(1,e.v),r}function WE(e){var t=vs(e),r=e.read_shift(1);return[t,r,"e"]}function HE(e,t,r){return r==null&&(r=fe(8)),bs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function VE(e){var t=Mr(e),r=e.read_shift(4);return[t,r,"s"]}function GE(e,t,r){return r==null&&(r=fe(12)),ys(t,r),r.write_shift(4,t.v),r}function YE(e){var t=vs(e),r=e.read_shift(4);return[t,r,"s"]}function KE(e,t,r){return r==null&&(r=fe(8)),bs(t,r),r.write_shift(4,t.v),r}function XE(e){var t=Mr(e),r=ni(e);return[t,r,"n"]}function QE(e,t,r){return r==null&&(r=fe(16)),ys(t,r),hs(e.v,r),r}function JE(e){var t=vs(e),r=ni(e);return[t,r,"n"]}function ZE(e,t,r){return r==null&&(r=fe(12)),bs(t,r),hs(e.v,r),r}function eT(e){var t=Mr(e),r=t0(e);return[t,r,"n"]}function tT(e,t,r){return r==null&&(r=fe(12)),ys(t,r),r0(e.v,r),r}function rT(e){var t=vs(e),r=t0(e);return[t,r,"n"]}function nT(e,t,r){return r==null&&(r=fe(8)),bs(t,r),r0(e.v,r),r}function sT(e){var t=Mr(e),r=Xc(e);return[t,r,"is"]}function iT(e){var t=Mr(e),r=cr(e);return[t,r,"str"]}function aT(e,t,r){return r==null&&(r=fe(12+4*e.v.length)),ys(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function oT(e){var t=vs(e),r=cr(e);return[t,r,"str"]}function lT(e,t,r){return r==null&&(r=fe(8+4*e.v.length)),bs(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function cT(e,t,r){var s=e.l+t,i=Mr(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function dT(e,t,r){var s=e.l+t,i=Mr(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function hT(e,t,r){var s=e.l+t,i=Mr(e);i.r=r["!row"];var a=ni(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}function uT(e,t,r){var s=e.l+t,i=Mr(e);i.r=r["!row"];var a=cr(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=Xo(e,s-e.l,r);o[3]=Ks(l,null,i,r.supbooks,r)}else e.l=s;return o}var fT=ws,xT=ri;function pT(e,t){return t==null&&(t=fe(4)),t.write_shift(4,e),t}function mT(e,t){var r=e.l+t,s=ws(e),i=Qc(e),a=cr(e),o=cr(e),l=cr(e);e.l=r;var d={rfx:s,relId:i,loc:a,display:l};return o&&(d.Tooltip=o),d}function gT(e,t){var r=fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ri({s:Wt(e[0]),e:Wt(e[0])},r),Jc("rId"+t,r);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return Ht(i||"",r),Ht(e[1].Tooltip||"",r),Ht("",r),r.slice(0,r.l)}function yT(){}function vT(e,t,r){var s=e.l+t,i=n0(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var l=oE(e,s-e.l,r);o[1]=l}else e.l=s;return o}function bT(e,t,r){var s=e.l+t,i=ws(e),a=[i];if(r.cellFormula){var o=cE(e,s-e.l,r);a[1]=o,e.l=s}else e.l=s;return a}function wT(e,t,r){r==null&&(r=fe(18));var s=Qo(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var $0=["left","right","top","bottom","header","footer"];function jT(e){var t={};return $0.forEach(function(r){t[r]=ni(e)}),t}function ST(e,t){return t==null&&(t=fe(6*8)),B0(e),$0.forEach(function(r){hs(e[r],t)}),t}function ET(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function TT(e,t,r){r==null&&(r=fe(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _T(e){var t=fe(24);return t.write_shift(4,4),t.write_shift(4,1),ri(e,t),t}function kT(e,t){return t==null&&(t=fe(16*4+2)),t.write_shift(2,e.password?w0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function CT(){}function AT(){}function IT(e,t,r,s,i,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=wr(t),t.z=t.z||Nt[14],t.v=br(pr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:s};switch(d.s=Kn(i.cellXfs,t,i),t.l&&a["!links"].push([ht(d),t.l]),t.c&&a["!comments"].push([ht(d),t.c]),t.t){case"s":case"str":return i.bookSST?(l=sd(i.Strings,t.v,i.revStrings),d.t="s",d.v=l,o?ge(e,18,KE(t,d)):ge(e,7,GE(t,d))):(d.t="str",o?ge(e,17,lT(t,d)):ge(e,6,aT(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ge(e,13,nT(t,d)):ge(e,2,tT(t,d)):o?ge(e,16,ZE(t,d)):ge(e,5,QE(t,d)),!0;case"b":return d.t="b",o?ge(e,15,UE(t,d)):ge(e,4,ME(t,d)),!0;case"e":return d.t="e",o?ge(e,14,HE(t,d)):ge(e,3,qE(t,d)),!0}return o?ge(e,12,OE(t,d)):ge(e,1,DE(t,d)),!0}function NT(e,t,r,s){var i=bt(t["!ref"]||"A1"),a,o="",l=[];ge(e,145);var d=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=c;++h){o=Zt(h),CE(e,t,i,h);var x=!1;if(h<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){h===i.s.r&&(l[u]=lr(u)),a=l[u]+o;var p=d?(t[h]||[])[u]:t[a];if(!p){x=!1;continue}x=IT(e,p,h,u,s,t,x)}}ge(e,146)}function FT(e,t){!t||!t["!merges"]||(ge(e,177,pT(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,xT(r))}),ge(e,178))}function RT(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,s){r&&ge(e,60,wT(s,r))}),ge(e,391))}function PT(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,_T(bt(t["!ref"]))),ge(e,650))}function DT(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var i=lt(r,-1,s[1].Target.replace(/#.*$/,""),rt.HLINK);ge(e,494,gT(s,i))}}),delete t["!links"]}function LT(e,t,r,s){if(t["!comments"].length>0){var i=lt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);ge(e,551,Jc("rId"+i)),t["!legacy"]=i}}function OT(e,t,r,s){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:Ot(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Nr(a);l.s.r==l.e.r&&(l.e.r=Nr(t["!ref"]).e.r,a=Ot(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+a;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),ge(e,161,ri(bt(a))),ge(e,162)}}function BT(e,t,r){ge(e,133),ge(e,137,TT(t,r)),ge(e,138),ge(e,134)}function MT(e,t){t["!protect"]&&ge(e,535,kT(t["!protect"]))}function $T(e,t,r,s){var i=vr(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=bt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ge(i,129),(r.vbaraw||o["!outline"])&&ge(i,147,RE(l,o["!outline"])),ge(i,148,IE(d)),BT(i,o,r.Workbook),RT(i,o),NT(i,o,e,t),MT(i,o),OT(i,o,r,e),FT(i,o),DT(i,o,s),o["!margins"]&&ge(i,476,ST(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&PT(i,o),LT(i,o,e,s),ge(i,130),i.end()}function UT(e,t){e.l+=10;var r=cr(e);return{name:r}}var zT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function qT(e){return!e.Workbook||!e.Workbook.WBProps?"false":bw(e.Workbook.WBProps.date1904)?"true":"false"}var WT="][*?/\\".split("");function U0(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return WT.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HT(e,t,r){e.forEach(function(s,i){U0(s);for(var a=0;a<i;++a)if(s==e[a])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[i]&&t[i].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function VT(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];HT(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)xE(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function z0(e){var t=[Bt];t[t.length]=Te("workbook",null,{xmlns:ei[0],"xmlns:r":qt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zT.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=Te("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:dt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Te("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=Te("definedName",dt(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function GT(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pc(e),r.name=cr(e),r}function YT(e,t){return t||(t=fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Jc(e.strRelID,t),Ht(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function KT(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?cr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function XT(e,t){t||(t=fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),e0(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function QT(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=qw(e),o=lE(e,0,r),l=Qc(e);e.l=s;var d={Name:a,Ptg:o};return i<268435455&&(d.Sheet=i),l&&(d.Comment=l),d}function JT(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,YT(i))}ge(e,144)}function ZT(e,t){t||(t=fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ht("SheetJS",t),Ht(vo.version,t),Ht(vo.version,t),Ht("7262",t),t.length>t.l?t.slice(0,t.l):t}function e_(e,t){t||(t=fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function t_(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,i=-1,a=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&i==-1?i=s:r[s].Hidden==1&&a==-1&&(a=s);a>i||(ge(e,135),ge(e,158,e_(i)),ge(e,136))}}function r_(e,t){var r=vr();return ge(r,131),ge(r,128,ZT()),ge(r,153,XT(e.Workbook&&e.Workbook.WBProps||null)),t_(r,e),JT(r,e),ge(r,132),r.end()}function n_(e,t,r){return(t.slice(-4)===".bin"?r_:z0)(e)}function s_(e,t,r,s,i){return(t.slice(-4)===".bin"?$T:M0)(e,r,s,i)}function i_(e,t,r){return(t.slice(-4)===".bin"?Sj:E0)(e,r)}function a_(e,t,r){return(t.slice(-4)===".bin"?X2:b0)(e,r)}function o_(e,t,r){return(t.slice(-4)===".bin"?Mj:A0)(e)}function l_(e){return(e.slice(-4)===".bin"?Nj:k0)()}function c_(e,t){var r=[];return e.Props&&r.push(i2(e.Props,t)),e.Custprops&&r.push(a2(e.Props,e.Custprops)),r.join("")}function d_(){return""}function h_(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,i){var a=[];a.push(Te("NumberFormat",null,{"ss:Format":dt(Nt[s.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Te("Style",a.join(""),o))}),Te("Styles",r.join(""))}function q0(e){return Te("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+rd(e.Ref,{r:0,c:0})})}function u_(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var i=t[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(q0(i)))}return Te("Names",r.join(""))}function f_(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,a=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(q0(l)))}return a.join("")}function x_(e,t,r,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)i.push(Te("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(s.Workbook.Sheets[a]&&!s.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Jt("ProtectContents","True")),e["!protect"].objects&&i.push(Jt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Jt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Jt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Jt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Te("WorksheetOptions",i.join(""),{xmlns:_r.x})}function p_(e){return e.map(function(t){var r=vw(t.t||""),s=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",s,{"ss:Author":t.a})}).join("")}function m_(e,t,r,s,i,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+dt(rd(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Wt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=dt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=dt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],h=0;h!=c.length;++h)c[h].s.c!=o.c||c[h].s.r!=o.r||(c[h].e.c>c[h].s.c&&(l["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(l["ss:MergeDown"]=c[h].e.r-c[h].s.r));var x="",u="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":x="Number",u=String(e.v);break;case"b":x="Boolean",u=e.v?"1":"0";break;case"e":x="Error",u=ta[e.v];break;case"d":x="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Nt[14]);break;case"s":x="String",u=yw(e.v||"");break}var p=Kn(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var g=e.v!=null?u:"",f=e.t=="z"?"":'<Data ss:Type="'+x+'">'+g+"</Data>";return(e.c||[]).length>0&&(f+=p_(e.c)),Te("Cell",f,l)}function g_(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=S0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function y_(e,t,r,s){if(!e["!ref"])return"";var i=bt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(m,v){ed(m);var w=!!m.width,_=Qo(v,m),y={"ss:Index":v+1};w&&(y["ss:Width"]=Co(_.width)),m.hidden&&(y["ss:Hidden"]="1"),l.push(Te("Column",null,y))});for(var d=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var h=[g_(c,(e["!rows"]||[])[c])],x=i.s.c;x<=i.e.c;++x){var u=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>x)&&!(a[o].s.r>c)&&!(a[o].e.c<x)&&!(a[o].e.r<c)){(a[o].s.c!=x||a[o].s.r!=c)&&(u=!0);break}if(!u){var p={r:c,c:x},g=ht(p),f=d?(e[c]||[])[x]:e[g];h.push(m_(f,g,e,t,r,s,p))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function v_(e,t,r){var s=[],i=r.SheetNames[e],a=r.Sheets[i],o=a?f_(a,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=a?y_(a,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(x_(a,t,e,r)),s.join("")}function b_(e,t){t||(t={}),e.SSF||(e.SSF=wr(Nt)),e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(c_(e,t)),r.push(d_()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(Te("Worksheet",v_(s,t,e),{"ss:Name":dt(e.SheetNames[s])}));return r[2]=h_(e,t),r[3]=u_(e),Bt+Te("Workbook",r.join(""),{xmlns:_r.ss,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:ss":_r.ss,"xmlns:dt":_r.dt,"xmlns:html":_r.html})}var Wl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function w_(e,t){var r=[],s=[],i=[],a=0,o,l=Ph(Gh,"n"),d=Ph(Yh,"n");if(e.Props)for(o=er(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=er(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?s:i).push([o[a],e.Custprops[o[a]]]);var c=[];for(a=0;a<i.length;++a)f0.indexOf(i[a][0])>-1||d0.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);s.length&&ft.utils.cfb_add(t,"/SummaryInformation",Zh(s,Wl.SI,d,Yh)),(r.length||c.length)&&ft.utils.cfb_add(t,"/DocumentSummaryInformation",Zh(r,Wl.DSI,l,Gh,c.length?c:null,Wl.UDI))}function j_(e,t){var r=t||{},s=ft.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ft.utils.cfb_add(s,i,W0(e,r)),r.biff==8&&(e.Props||e.Custprops)&&w_(e,s),r.biff==8&&e.vbaraw&&$j(s,ft.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var S_={0:{f:_E},1:{f:PE},2:{f:eT},3:{f:zE},4:{f:BE},5:{f:XE},6:{f:iT},7:{f:VE},8:{f:uT},9:{f:hT},10:{f:cT},11:{f:dT},12:{f:LE},13:{f:rT},14:{f:WE},15:{f:$E},16:{f:JE},17:{f:oT},18:{f:YE},19:{f:Xc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:QT},40:{},42:{},43:{f:ij},44:{f:nj},45:{f:lj},46:{f:dj},47:{f:cj},48:{},49:{f:Lw},50:{},51:{f:_j},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O2},62:{f:sT},63:{f:Fj},64:{f:CT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ET},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:FE},148:{f:AE,p:16},151:{f:yT},152:{},153:{f:KT},154:{},155:{},156:{f:GT},157:{},158:{},159:{T:1,f:G2},160:{T:-1},161:{T:1,f:ws},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ej},336:{T:-1},337:{f:Aj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:N2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vT},427:{f:bT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:NE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Oj},633:{T:1},634:{T:-1},635:{T:1,f:Dj},636:{T:-1},637:{f:$w},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ke(e,t,r,s){var i=t;if(!isNaN(i)){var a=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Gc(r)&&e.push(r)}}function E_(e,t,r,s){var i=(r||[]).length||0;if(i<=8224)return ke(e,t,r,i);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,a),h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<i;){for(h=e.next(4),h.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;h.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function na(e,t,r){return e||(e=fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function T_(e,t,r,s){var i=fe(9);return na(i,e,t),p0(r,s||"b",i),i}function __(e,t,r){var s=fe(8+2*r.length);return na(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function k_(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?br(pr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ke(e,2,U2(r,s,i)):ke(e,3,$2(r,s,i));return;case"b":case"e":ke(e,5,T_(r,s,t.v,t.t));return;case"s":case"str":ke(e,4,__(r,s,(t.v||"").slice(0,255)));return}ke(e,1,na(null,r,s))}function C_(e,t,r,s){var i=Array.isArray(t),a=bt(t["!ref"]||"A1"),o,l="",d=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Ot(a)}for(var c=a.s.r;c<=a.e.r;++c){l=Zt(c);for(var h=a.s.c;h<=a.e.c;++h){c===a.s.r&&(d[h]=lr(h)),o=d[h]+l;var x=i?(t[c]||[])[h]:t[o];x&&k_(e,x,c,h)}}}function A_(e,t){for(var r=t||{},s=vr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ke(s,r.biff==4?1033:r.biff==3?521:9,Zc(e,16,r)),C_(s,e.Sheets[e.SheetNames[i]],i,r),ke(s,10),s.end()}function I_(e,t,r){ke(e,49,S2({sz:12,name:"Arial"},r))}function N_(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)t[i]!=null&&ke(e,1054,_2(i,t[i],r))})}function F_(e,t){var r=fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ke(e,2151,r),r=fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),y0(bt(t["!ref"]||"A1"),r),r.write_shift(4,4),ke(e,2152,r)}function R_(e,t){for(var r=0;r<16;++r)ke(e,224,tu({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){ke(e,224,tu(s,0,t))})}function P_(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];ke(e,440,P2(s)),s[1].Tooltip&&ke(e,2048,D2(s))}delete t["!links"]}function D_(e,t){if(t){var r=0;t.forEach(function(s,i){++r<=256&&s&&ke(e,125,B2(Qo(i,s),i))})}}function L_(e,t,r,s,i){var a=16+Kn(i.cellXfs,t,i);if(t.v==null&&!t.bf){ke(e,513,us(r,s,a));return}if(t.bf)ke(e,6,aE(t,r,s,i,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?br(pr(t.v)):t.v;ke(e,515,I2(r,s,o,a));break;case"b":case"e":ke(e,517,A2(r,s,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var l=sd(i.Strings,t.v,i.revStrings);ke(e,253,E2(r,s,l,a))}else ke(e,516,T2(r,s,(t.v||"").slice(0,255),a,i));break;default:ke(e,513,us(r,s,a))}}function O_(e,t,r){var s=vr(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(a),c=t.biff==8,h,x="",u=[],p=bt(a["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}ke(s,2057,Zc(r,16,t)),ke(s,13,Pr(1)),ke(s,12,Pr(100)),ke(s,15,ur(!0)),ke(s,17,ur(!1)),ke(s,16,hs(.001)),ke(s,95,ur(!0)),ke(s,42,ur(!1)),ke(s,43,ur(!1)),ke(s,130,Pr(1)),ke(s,128,C2()),ke(s,131,ur(!1)),ke(s,132,ur(!1)),c&&D_(s,a["!cols"]),ke(s,512,k2(p,t)),c&&(a["!links"]=[]);for(var f=p.s.r;f<=p.e.r;++f){x=Zt(f);for(var m=p.s.c;m<=p.e.c;++m){f===p.s.r&&(u[m]=lr(m)),h=u[m]+x;var v=d?(a[f]||[])[m]:a[h];v&&(L_(s,v,f,m,t),c&&v.l&&a["!links"].push([h,v.l]))}}var w=l.CodeName||l.name||i;return c&&ke(s,574,j2((o.Views||[])[0])),c&&(a["!merges"]||[]).length&&ke(s,229,R2(a["!merges"])),c&&P_(s,a),ke(s,442,g0(w)),c&&F_(s,a),ke(s,10),s.end()}function B_(e,t,r){var s=vr(),i=(e||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,d=r.biff==5;if(ke(s,2057,Zc(e,5,r)),r.bookType=="xla"&&ke(s,135),ke(s,225,l?Pr(1200):null),ke(s,193,c2(2)),d&&ke(s,191),d&&ke(s,192),ke(s,226),ke(s,92,y2("SheetJS",r)),ke(s,66,Pr(l?1200:1252)),l&&ke(s,353,Pr(0)),l&&ke(s,448),ke(s,317,M2(e.SheetNames.length)),l&&e.vbaraw&&ke(s,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";ke(s,442,g0(c))}ke(s,156,Pr(17)),ke(s,25,ur(!1)),ke(s,18,ur(!1)),ke(s,19,Pr(0)),l&&ke(s,431,ur(!1)),l&&ke(s,444,Pr(0)),ke(s,61,w2()),ke(s,64,ur(!1)),ke(s,141,Pr(0)),ke(s,34,ur(qT(e)=="true")),ke(s,14,ur(!0)),l&&ke(s,439,ur(!1)),ke(s,218,Pr(0)),I_(s,e,r),N_(s,e.SSF,r),R_(s,r),l&&ke(s,352,ur(!1));var h=s.end(),x=vr();l&&ke(x,140,L2()),l&&r.Strings&&E_(x,252,b2(r.Strings)),ke(x,10);var u=x.end(),p=vr(),g=0,f=0;for(f=0;f<e.SheetNames.length;++f)g+=(l?12:11)+(l?2:1)*e.SheetNames[f].length;var m=h.length+g+u.length;for(f=0;f<e.SheetNames.length;++f){var v=a[f]||{};ke(p,133,v2({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[f]},r)),m+=t[f].length}var w=p.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var _=[];return h.length&&_.push(h),w.length&&_.push(w),u.length&&_.push(u),Qt(_)}function M_(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=wr(Nt)),e&&e.SSF&&(Vo(),Ho(e.SSF),r.revssf=Go(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,id(r),r.cellXfs=[],Kn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=O_(i,r,e);return s.unshift(B_(e,s,r)),Qt(s)}function W0(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var i=Nr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return M_(e,t);case 4:case 3:case 2:return A_(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function $_(e,t,r,s){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){l=-1;break}l=i[c].e.r-i[c].s.r+1,d=i[c].e.c-i[c].s.c+1;break}if(!(l<0)){var h=ht({r,c:o}),x=s.dense?(e[r]||[])[o]:e[h],u=x&&x.v!=null&&(x.h||gw(x.w||(An(x),x.w)||""))||"",p={};l>1&&(p.rowspan=l),d>1&&(p.colspan=d),s.editable?u='<span contenteditable="true">'+u+"</span>":x&&(p["data-t"]=x&&x.t||"z",x.v!=null&&(p["data-v"]=x.v),x.z!=null&&(p["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+x.l.Target+'">'+u+"</a>")),p.id=(s.id||"sjs")+"-"+h,a.push(Te("td",u,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var U_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',z_="</body></html>";function q_(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function H0(e,t){var r=t||{},s=r.header!=null?r.header:U_,i=r.footer!=null?r.footer:z_,a=[s],o=Nr(e["!ref"]);r.dense=Array.isArray(e),a.push(q_(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push($_(e,o,l,r));return a.push("</table>"+i),a.join("")}function V0(e,t,r){var s=r||{},i=0,a=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var o=typeof s.origin=="string"?Wt(s.origin):s.origin;i=o.r,a=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var h=Nr(e["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var x=[],u=0,p=e["!rows"]||(e["!rows"]=[]),g=0,f=0,m=0,v=0,w=0,_=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&f<d;++g){var y=l[g];if(lu(y)){if(s.display)continue;p[f]={hidden:!0}}var b=y.children;for(m=v=0;m<b.length;++m){var E=b[m];if(!(s.display&&lu(E))){var j=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):ww(E.innerHTML),S=E.getAttribute("data-z")||E.getAttribute("z");for(u=0;u<x.length;++u){var C=x[u];C.s.c==v+a&&C.s.r<f+i&&f+i<=C.e.r&&(v=C.e.c+1-a,u=-1)}_=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||_>1)&&x.push({s:{r:f+i,c:v+a},e:{r:f+i+(w||1)-1,c:v+a+(_||1)-1}});var T={t:"s",v:j},A=E.getAttribute("data-t")||E.getAttribute("t")||"";j!=null&&(j.length==0?T.t=A||"z":s.raw||j.trim().length==0||A=="s"||(j==="TRUE"?T={t:"b",v:!0}:j==="FALSE"?T={t:"b",v:!1}:isNaN(En(j))?isNaN(zi(j).getDate())||(T={t:"d",v:pr(j)},s.cellDates||(T={t:"n",v:br(T.v)}),T.z=s.dateNF||Nt[14]):T={t:"n",v:En(j)})),T.z===void 0&&S!=null&&(T.z=S);var I="",P=E.getElementsByTagName("A");if(P&&P.length)for(var N=0;N<P.length&&!(P[N].hasAttribute("href")&&(I=P[N].getAttribute("href"),I.charAt(0)!="#"));++N);I&&I.charAt(0)!="#"&&(T.l={Target:I}),s.dense?(e[f+i]||(e[f+i]=[]),e[f+i][v+a]=T):e[ht({c:v+a,r:f+i})]=T,c.e.c<v+a&&(c.e.c=v+a),v+=_}}++f}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),c.e.r=Math.max(c.e.r,f-1+i),e["!ref"]=Ot(c),f>=d&&(e["!fullref"]=Ot((c.e.r=l.length-g+f-1+i,c))),e}function G0(e,t){var r=t||{},s=r.dense?[]:{};return V0(s,e,t)}function W_(e,t){return gs(G0(e,t),t)}function lu(e){var t="",r=H_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function H_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var V_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+t}}(),cu=function(){var e=function(a){return dt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(a,o,l){var d=[];d.push('      <table:table table:name="'+dt(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,h=0,x=Nr(a["!ref"]||"A1"),u=a["!merges"]||[],p=0,g=Array.isArray(a);if(a["!cols"])for(h=0;h<=x.e.c;++h)d.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var f="",m=a["!rows"]||[];for(c=0;c<x.s.r;++c)f=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+f+`></table:table-row>
`);for(;c<=x.e.r;++c){for(f=m[c]?' table:style-name="ro'+m[c].ods+'"':"",d.push("        <table:table-row"+f+`>
`),h=0;h<x.s.c;++h)d.push(t);for(;h<=x.e.c;++h){var v=!1,w={},_="";for(p=0;p!=u.length;++p)if(!(u[p].s.c>h)&&!(u[p].s.r>c)&&!(u[p].e.c<h)&&!(u[p].e.r<c)){(u[p].s.c!=h||u[p].s.r!=c)&&(v=!0),w["table:number-columns-spanned"]=u[p].e.c-u[p].s.c+1,w["table:number-rows-spanned"]=u[p].e.r-u[p].s.r+1;break}if(v){d.push(r);continue}var y=ht({r:c,c:h}),b=g?(a[c]||[])[h]:a[y];if(b&&b.f&&(w["table:formula"]=dt(uE(b.f)),b.F&&b.F.slice(0,y.length)==y)){var E=Nr(b.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!b){d.push(t);continue}switch(b.t){case"b":_=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":_=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":_=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":_=b.w||pr(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=pr(b.v).toISOString(),w["table:style-name"]="ce1";break;default:d.push(t);continue}var j=e(_);if(b.l&&b.l.Target){var S=b.l.Target;S=S.charAt(0)=="#"?"#"+fE(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),j=Te("text:a",j,{"xlink:href":S.replace(/&/g,"&amp;")})}d.push("          "+Te("table:table-cell",Te("text:p",j,{}),w)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var x=c["!cols"][h];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ed(x),x.ods=l;var u=c["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),a.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=d;var x=c["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),a.push(`  </style:style>
`),++d}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var d=[Bt],c=Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Wi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+h+`>
`),d.push(l0().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)d.push(s(o.Sheets[o.SheetNames[x]],o,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function Y0(e,t){if(t.bookType=="fods")return cu(e,t);var r=qc(),s="",i=[],a=[];return s="mimetype",He(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",He(r,s,cu(e,t)),i.push([s,"text/xml"]),a.push([s,"ContentFile"]),s="styles.xml",He(r,s,V_(e,t)),i.push([s,"text/xml"]),a.push([s,"StylesFile"]),s="meta.xml",He(r,s,Bt+l0()),i.push([s,"text/xml"]),a.push([s,"MetadataFile"]),s="manifest.rdf",He(r,s,s2(a)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",He(r,s,r2(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function No(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function G_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Wr(qi(e))}function Y_(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Hn(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(i){r.set(i,s),s+=i.length}),r}function K_(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function Hi(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],i=Hi(e,r),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Hi(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(s))}var c={data:l,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Kt(e){var t=[];return e.forEach(function(r,s){r.forEach(function(i){i.data&&(t.push(ot(s*8+i.type)),i.type==2&&t.push(ot(i.data.length)),t.push(i.data))})}),Hn(t)}function $r(e){for(var t,r=[],s=[0];s[0]<e.length;){var i=Hi(e,s),a=zt(e.slice(s[0],s[0]+i));s[0]+=i;var o={id:Gs(a[1][0].data),messages:[]};a[2].forEach(function(l){var d=zt(l.data),c=Gs(d[3][0].data);o.messages.push({meta:d,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=a[3])!=null&&t[0]&&(o.merge=Gs(a[3][0].data)>>>0>0),r.push(o)}return r}function Rs(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:ot(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:ot(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:ot(o.data.length)}],s[2].push({data:Kt(o.meta),type:2})});var a=Kt(s);t.push(ot(a.length)),t.push(a),i.forEach(function(o){return t.push(o)})}),Hn(t)}function X_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Hi(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Hn(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(i.push(i[0].slice(-d)),c-=d;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-d,-d+c))}}var h=Hn(i);if(h.length!=s)throw new Error("Unexpected length: ".concat(h.length," != ").concat(s));return h}function Ur(e){for(var t=[],r=0;r<e.length;){var s=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(X_(s,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Hn(t)}function Ps(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=ot(s),o=a.length;t.push(a),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=s}return Hn(t)}function Hl(e,t){var r=new Uint8Array(32),s=No(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,K_(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,s.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,a,!0),r.slice(0,i)}function Vl(e,t){var r=new Uint8Array(32),s=No(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,s.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,a,!0),r.slice(0,i)}function Ln(e){var t=zt(e);return Hi(t[1][0].data)}function Q_(e,t,r){var s,i,a,o;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Gs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=No(e[7][0].data),h=0,x=[],u=No(e[4][0].data),p=0,g=[],f=0;f<t.length;++f){if(t[f]==null){c.setUint16(f*2,65535,!0),u.setUint16(f*2,65535);continue}c.setUint16(f*2,h,!0),u.setUint16(f*2,p,!0);var m,v;switch(typeof t[f]){case"string":m=Hl({t:"s",v:t[f]},r),v=Vl({t:"s",v:t[f]},r);break;case"number":m=Hl({t:"n",v:t[f]},r),v=Vl({t:"n",v:t[f]},r);break;case"boolean":m=Hl({t:"b",v:t[f]},r),v=Vl({t:"b",v:t[f]},r);break;default:throw new Error("Unsupported value "+t[f])}x.push(m),h+=m.length,g.push(v),p+=v.length,++d}for(e[2][0].data=ot(d);f<e[7][0].data.length/2;++f)c.setUint16(f*2,65535,!0),u.setUint16(f*2,65535,!0);return e[6][0].data=Hn(x),e[3][0].data=Hn(g),d}function J_(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Nr(r["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ot(s)));var a=Fo(r,{range:s,header:1}),o=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(B){typeof B=="string"&&o.push(B)})});var l={},d=[],c=ft.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,B){return[U,c.FullPaths[B]]}).forEach(function(U){var B=U[0],F=U[1];if(B.type==2&&B.name.match(/\.iwa/)){var V=B.content,se=Ur(V),xe=$r(se);xe.forEach(function(me){d.push(me.id),l[me.id]={deps:[],location:F,type:Gs(me.messages[0].meta[1][0].data)}})}}),d.sort(function(U,B){return U-B});var h=d.filter(function(U){return U>1}).map(function(U){return[U,ot(U)]});c.FileIndex.map(function(U,B){return[U,c.FullPaths[B]]}).forEach(function(U){var B=U[0];if(U[1],!!B.name.match(/\.iwa/)){var F=$r(Ur(B.content));F.forEach(function(V){V.messages.forEach(function(se){h.forEach(function(xe){V.messages.some(function(me){return Gs(me.meta[1][0].data)!=11006&&Y_(me.data,xe[1])})&&l[xe[0]].deps.push(V.id)})})})}});for(var x=ft.find(c,l[1].location),u=$r(Ur(x.content)),p,g=0;g<u.length;++g){var f=u[g];f.id==1&&(p=f)}var m=Ln(zt(p.messages[0].data)[1][0].data);for(x=ft.find(c,l[m].location),u=$r(Ur(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);for(m=Ln(zt(p.messages[0].data)[2][0].data),x=ft.find(c,l[m].location),u=$r(Ur(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);for(m=Ln(zt(p.messages[0].data)[2][0].data),x=ft.find(c,l[m].location),u=$r(Ur(x.content)),g=0;g<u.length;++g)f=u[g],f.id==m&&(p=f);var v=zt(p.messages[0].data);{v[6][0].data=ot(s.e.r+1),v[7][0].data=ot(s.e.c+1);var w=Ln(v[46][0].data),_=ft.find(c,l[w].location),y=$r(Ur(_.content));{for(var b=0;b<y.length&&y[b].id!=w;++b);if(y[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=zt(y[b].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var j=0;j<=s.e.c;++j){var S=[];S[1]=S[2]=[{type:0,data:ot(j+420690)}],E[1].push({type:2,data:Kt(S)}),E[2].push({type:0,data:ot(j)}),E[3].push({type:0,data:ot(j)})}E[4]=[],E[5]=[],E[6]=[];for(var C=0;C<=s.e.r;++C)S=[],S[1]=S[2]=[{type:0,data:ot(C+726270)}],E[4].push({type:2,data:Kt(S)}),E[5].push({type:0,data:ot(C)}),E[6].push({type:0,data:ot(C)});y[b].messages[0].data=Kt(E)}_.content=Ps(Rs(y)),_.size=_.content.length,delete v[46];var T=zt(v[4][0].data);{T[7][0].data=ot(s.e.r+1);var A=zt(T[1][0].data),I=Ln(A[2][0].data);_=ft.find(c,l[I].location),y=$r(Ur(_.content));{if(y[0].id!=I)throw"Bad HeaderStorageBucket";var P=zt(y[0].messages[0].data);for(C=0;C<a.length;++C){var N=zt(P[2][0].data);N[1][0].data=ot(C),N[4][0].data=ot(a[C].length),P[2][C]={type:P[2][0].type,data:Kt(N)}}y[0].messages[0].data=Kt(P)}_.content=Ps(Rs(y)),_.size=_.content.length;var q=Ln(T[2][0].data);_=ft.find(c,l[q].location),y=$r(Ur(_.content));{if(y[0].id!=q)throw"Bad HeaderStorageBucket";for(P=zt(y[0].messages[0].data),j=0;j<=s.e.c;++j)N=zt(P[2][0].data),N[1][0].data=ot(j),N[4][0].data=ot(s.e.r+1),P[2][j]={type:P[2][0].type,data:Kt(N)};y[0].messages[0].data=Kt(P)}_.content=Ps(Rs(y)),_.size=_.content.length;var L=Ln(T[4][0].data);(function(){for(var U=ft.find(c,l[L].location),B=$r(Ur(U.content)),F,V=0;V<B.length;++V){var se=B[V];se.id==L&&(F=se)}var xe=zt(F.messages[0].data);{xe[3]=[];var me=[];o.forEach(function(ce,Ie){me[1]=[{type:0,data:ot(Ie)}],me[2]=[{type:0,data:ot(1)}],me[3]=[{type:2,data:G_(ce)}],xe[3].push({type:2,data:Kt(me)})})}F.messages[0].data=Kt(xe);var Q=Rs(B),ee=Ps(Q);U.content=ee,U.size=U.content.length})();var D=zt(T[3][0].data);{var M=D[1][0];delete D[2];var J=zt(M.data);{var ne=Ln(J[2][0].data);(function(){for(var U=ft.find(c,l[ne].location),B=$r(Ur(U.content)),F,V=0;V<B.length;++V){var se=B[V];se.id==ne&&(F=se)}var xe=zt(F.messages[0].data);{delete xe[6],delete D[7];var me=new Uint8Array(xe[5][0].data);xe[5]=[];for(var Q=0,ee=0;ee<=s.e.r;++ee){var ce=zt(me);Q+=Q_(ce,a[ee],o),ce[1][0].data=ot(ee),xe[5].push({data:Kt(ce),type:2})}xe[1]=[{type:0,data:ot(s.e.c+1)}],xe[2]=[{type:0,data:ot(s.e.r+1)}],xe[3]=[{type:0,data:ot(Q)}],xe[4]=[{type:0,data:ot(s.e.r+1)}]}F.messages[0].data=Kt(xe);var Ie=Rs(B),re=Ps(Ie);U.content=re,U.size=U.content.length})()}M.data=Kt(J)}T[3][0].data=Kt(D)}v[4][0].data=Kt(T)}p.messages[0].data=Kt(v);var Z=Rs(u),R=Ps(Z);return x.content=R,x.size=x.content.length,c}function Z_(e){return function(r){for(var s=0;s!=e.length;++s){var i=e[s];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function id(e){Z_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ek(e,t){return t.bookType=="ods"?Y0(e,t):t.bookType=="numbers"?J_(e,t):t.bookType=="xlsb"?tk(e,t):rk(e,t)}function tk(e,t){$s=1024,e&&!e.SSF&&(e.SSF=wr(Nt)),e&&e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ii?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=I0.indexOf(t.bookType)>-1,i=i0();id(t=t||{});var a=qc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",He(a,o,c0(e.Props,t)),i.coreprops.push(o),lt(t.rels,2,o,rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,He(a,o,h0(e.Props)),i.extprops.push(o),lt(t.rels,3,o,rt.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",He(a,o,u0(e.Custprops)),i.custprops.push(o),lt(t.rels,4,o,rt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],u=(x||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,He(a,o,s_(l-1,o,t,e,h)),i.sheets.push(o),lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(x){var p=x["!comments"],g=!1,f="";p&&p.length>0&&(f="xl/comments"+l+"."+r,He(a,f,o_(p,f)),i.comments.push(f),lt(h,-1,"../comments"+l+"."+r,rt.CMNT),g=!0),x["!legacy"]&&g&&He(a,"xl/drawings/vmlDrawing"+l+".vml",C0(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}h["!id"].rId1&&He(a,o0(o),Hs(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,He(a,o,a_(t.Strings,o,t)),i.strs.push(o),lt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),o="xl/workbook."+r,He(a,o,n_(e,o)),i.workbooks.push(o),lt(t.rels,1,o,rt.WB),o="xl/theme/theme1.xml",He(a,o,_0(e.Themes,t)),i.themes.push(o),lt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),o="xl/styles."+r,He(a,o,i_(e,o,t)),i.styles.push(o),lt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",He(a,o,e.vbaraw),i.vba.push(o),lt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),o="xl/metadata."+r,He(a,o,l_(o)),i.metadata.push(o),lt(t.wbrels,-1,"metadata."+r,rt.XLMETA),He(a,"[Content_Types].xml",a0(i,t)),He(a,"_rels/.rels",Hs(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Hs(t.wbrels)),delete t.revssf,delete t.ssf,a}function rk(e,t){$s=1024,e&&!e.SSF&&(e.SSF=wr(Nt)),e&&e.SSF&&(Vo(),Ho(e.SSF),t.revssf=Go(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ii?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=I0.indexOf(t.bookType)>-1,i=i0();id(t=t||{});var a=qc(),o="",l=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",He(a,o,c0(e.Props,t)),i.coreprops.push(o),lt(t.rels,2,o,rt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,He(a,o,h0(e.Props)),i.extprops.push(o),lt(t.rels,3,o,rt.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",He(a,o,u0(e.Custprops)),i.custprops.push(o),lt(t.rels,4,o,rt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var x={"!id":{}},u=e.Sheets[e.SheetNames[l-1]],p=(u||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,He(a,o,M0(l-1,t,e,x)),i.sheets.push(o),lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,rt.WS[0])}if(u){var g=u["!comments"],f=!1,m="";if(g&&g.length>0){var v=!1;g.forEach(function(w){w[1].forEach(function(_){_.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+l+"."+r,He(a,m,Rj(g,h,t)),i.threadedcomments.push(m),lt(x,-1,"../threadedComments/threadedComment"+l+"."+r,rt.TCMNT)),m="xl/comments"+l+"."+r,He(a,m,A0(g)),i.comments.push(m),lt(x,-1,"../comments"+l+"."+r,rt.CMNT),f=!0}u["!legacy"]&&f&&He(a,"xl/drawings/vmlDrawing"+l+".vml",C0(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}x["!id"].rId1&&He(a,o0(o),Hs(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,He(a,o,b0(t.Strings,t)),i.strs.push(o),lt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),o="xl/workbook."+r,He(a,o,z0(e)),i.workbooks.push(o),lt(t.rels,1,o,rt.WB),o="xl/theme/theme1.xml",He(a,o,_0(e.Themes,t)),i.themes.push(o),lt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),o="xl/styles."+r,He(a,o,E0(e,t)),i.styles.push(o),lt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",He(a,o,e.vbaraw),i.vba.push(o),lt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),o="xl/metadata."+r,He(a,o,k0()),i.metadata.push(o),lt(t.wbrels,-1,"metadata."+r,rt.XLMETA),h.length>1&&(o="xl/persons/person.xml",He(a,o,Pj(h)),i.people.push(o),lt(t.wbrels,-1,"persons/person.xml",rt.PEOPLE)),He(a,"[Content_Types].xml",a0(i,t)),He(a,"_rels/.rels",Hs(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",Hs(t.wbrels)),delete t.revssf,delete t.ssf,a}function nk(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function K0(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Zi(t.file,ft.write(e,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ft.write(e,t)}function sk(e,t){var r=wr(t||{}),s=ek(e,r);return ik(s,r)}function ik(e,t){var r={},s=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ft.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Wo(i))}return t.password&&typeof encrypt_agile<"u"?K0(encrypt_agile(i,t.password),t):t.type==="file"?Zi(t.file,i):t.type=="string"?_i(i):i}function ak(e,t){var r=t||{},s=j_(e,r);return K0(s,r)}function nn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Ui(qi(s));case"binary":return qi(s);case"string":return e;case"file":return Zi(t.file,s,"utf8");case"buffer":return st?Nn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):nn(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ok(e,t){switch(t.type){case"base64":return Ui(e);case"binary":return e;case"string":return e;case"file":return Zi(t.file,e,"binary");case"buffer":return st?Nn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ba(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Ui(r):t.type=="string"?_i(r):r;case"file":return Zi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function X0(e,t){Db(),VT(e);var r=wr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=X0(e,r);return r.type="array",Wo(s)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return nn(b_(e,r),r);case"slk":case"sylk":return nn(q2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return nn(H0(e.Sheets[e.SheetNames[i]],r),r);case"txt":return ok(Q0(e.Sheets[e.SheetNames[i]],r),r);case"csv":return nn(ad(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return nn(W2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Ba(z2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return nn(H2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return nn(J2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return nn(v0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return nn(Y0(e,r),r);case"wk1":return Ba(ru.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Ba(ru.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ba(W0(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ak(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return sk(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function lk(e,t,r,s,i,a,o,l){var d=Zt(r),c=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),x=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[r][p]:e[s[p]+d];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[p]!=null&&(u[a[p]]=c);continue}var f=g.v;switch(g.t){case"z":if(f==null)break;continue;case"e":f=f==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(f==null)if(g.t=="e"&&f===null)u[a[p]]=null;else if(c!==void 0)u[a[p]]=c;else if(h&&f===null)u[a[p]]=null;else continue;else u[a[p]]=h&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?f:An(g,f,l);f!=null&&(x=!1)}}return{row:u,isempty:x}}function Fo(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,i=1,a=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},h=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof h){case"string":d=bt(h);break;case"number":d=bt(e["!ref"]),d.s.r=h;break;default:d=h}s>0&&(i=0);var x=Zt(d.s.r),u=[],p=[],g=0,f=0,m=Array.isArray(e),v=d.s.r,w=0,_={};m&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(w=d.s.c;w<=d.e.c;++w)if(!(y[w]||{}).hidden)switch(u[w]=lr(w),r=m?e[v][w]:e[u[w]+x],s){case 1:a[w]=w-d.s.c;break;case 2:a[w]=u[w];break;case 3:a[w]=c.header[w-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=An(r,null,c),f=_[o]||0,!f)_[o]=1;else{do l=o+"_"+f++;while(_[l]);_[o]=f,_[l]=1}a[w]=l}for(v=d.s.r+i;v<=d.e.r;++v)if(!(b[v]||{}).hidden){var E=lk(e,d,v,u,s,a,m,c);(E.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=E.row)}return p.length=g,p}var du=/"/g;function ck(e,t,r,s,i,a,o,l){for(var d=!0,c=[],h="",x=Zt(r),u=t.s.c;u<=t.e.c;++u)if(s[u]){var p=l.dense?(e[r]||[])[u]:e[s[u]+x];if(p==null)h="";else if(p.v!=null){d=!1,h=""+(l.rawNumbers&&p.t=="n"?p.v:An(p,null,l));for(var g=0,f=0;g!==h.length;++g)if((f=h.charCodeAt(g))===i||f===a||f===34||l.forceQuotes){h='"'+h.replace(du,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(d=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(du,'""')+'"')):h="";c.push(h)}return l.blankrows===!1&&d?null:c.join(o)}function ad(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var i=bt(e["!ref"]),a=s.FS!==void 0?s.FS:",",o=a.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,d=l.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),h="",x=[];s.dense=Array.isArray(e);for(var u=s.skipHidden&&e["!cols"]||[],p=s.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(u[g]||{}).hidden||(x[g]=lr(g));for(var f=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||(h=ck(e,i,m,x,o,d,a,s),h!=null&&(s.strip&&(h=h.replace(c,"")),(h||s.blankrows!==!1)&&r.push((f++?l:"")+h)));return delete s.dense,r.join("")}function Q0(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ad(e,t);return r}function dk(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var i=bt(e["!ref"]),a="",o=[],l,d=[],c=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=lr(l);for(var h=i.s.r;h<=i.e.r;++h)for(a=Zt(h),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+a,r=c?(e[h]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function J0(e,t,r){var s=r||{},i=+!s.skipHeader,a=e||{},o=0,l=0;if(a&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?Wt(s.origin):s.origin;o=d.r,l=d.c}var c,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(a["!ref"]){var x=bt(a["!ref"]);h.e.c=Math.max(h.e.c,x.e.c),h.e.r=Math.max(h.e.r,x.e.r),o==-1&&(o=x.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var u=s.header||[],p=0;t.forEach(function(f,m){er(f).forEach(function(v){(p=u.indexOf(v))==-1&&(u[p=u.length]=v);var w=f[v],_="z",y="",b=ht({c:l+p,r:o+m+i});c=Vi(a,b),w&&typeof w=="object"&&!(w instanceof Date)?a[b]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",s.cellDates||(_="n",w=br(w)),y=s.dateNF||Nt[14]):w===null&&s.nullError&&(_="e",w=0),c?(c.t=_,c.v=w,delete c.w,delete c.R,y&&(c.z=y)):a[b]=c={t:_,v:w},y&&(c.z=y))})}),h.e.c=Math.max(h.e.c,l+u.length-1);var g=Zt(o);if(i)for(p=0;p<u.length;++p)a[lr(p+l)+g]={t:"s",v:u[p]};return a["!ref"]=Ot(h),a}function hk(e,t){return J0(null,e,t)}function Vi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Wt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Vi(e,ht(t)):Vi(e,ht({r:t,c:r||0}))}function uk(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fk(){return{SheetNames:[],Sheets:{}}}function xk(e,t,r,s){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(U0(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function pk(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=uk(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function mk(e,t){return e.z=t,e}function Z0(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gk(e,t,r){return Z0(e,"#"+t,r)}function yk(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vk(e,t,r,s){for(var i=typeof t!="string"?t:bt(t),a=typeof t=="string"?t:Ot(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var d=Vi(e,o,l);d.t="n",d.F=a,delete d.v,o==i.s.r&&l==i.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Gl={encode_col:lr,encode_row:Zt,encode_cell:ht,encode_range:Ot,decode_col:Kc,decode_row:Yc,split_cell:Dw,decode_cell:Wt,decode_range:Nr,format_cell:An,sheet_add_aoa:Zf,sheet_add_json:J0,sheet_add_dom:V0,aoa_to_sheet:ti,json_to_sheet:hk,table_to_sheet:G0,table_to_book:W_,sheet_to_csv:ad,sheet_to_txt:Q0,sheet_to_json:Fo,sheet_to_html:H0,sheet_to_formulae:dk,sheet_to_row_object_array:Fo,sheet_get_cell:Vi,book_new:fk,book_append_sheet:xk,book_set_sheet_visibility:pk,cell_set_number_format:mk,cell_set_hyperlink:Z0,cell_set_internal_link:gk,cell_add_comment:yk,sheet_set_array_formula:vk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},ex={exports:{}};(function(e,t){(function(r,s){s()})(Os,function(){function r(c,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function s(c,h,x){var u=new XMLHttpRequest;u.open("GET",c),u.responseType="blob",u.onload=function(){d(u.response,h,x)},u.onerror=function(){console.error("could not download file")},u.send()}function i(c){var h=new XMLHttpRequest;h.open("HEAD",c,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Os=="object"&&Os.global===Os?Os:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,h,x){var u=o.URL||o.webkitURL,p=document.createElement("a");h=h||c.name||"download",p.download=h,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?a(p):i(p.href)?s(c,h,x):a(p,p.target="_blank")):(p.href=u.createObjectURL(c),setTimeout(function(){u.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,h,x){if(h=h||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,x),h);else if(i(c))s(c,h,x);else{var u=document.createElement("a");u.href=c,u.target="_blank",setTimeout(function(){a(u)})}}:function(c,h,x,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof c=="string")return s(c,h,x);var p=c.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||p&&g||l)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var _=m.result;_=f?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=_:location=_,u=null},m.readAsDataURL(c)}else{var v=o.URL||o.webkitURL,w=v.createObjectURL(c);u?u.location=w:location.href=w,u=null,setTimeout(function(){v.revokeObjectURL(w)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})})(ex);var bk=ex.exports;const{Title:wk,Text:Ds}=Le,{Option:tn}=Pe,{RangePicker:jk}=xs,Sk=({exhibitionId:e,exhibitions:t,exhibitionsLoading:r,onExhibitionChange:s,typeFilter:i,setTypeFilter:a,bookingStatusFilter:o,setBookingStatusFilter:l,searchQuery:d,setSearchQuery:c,dateRange:h,setDateRange:x,resetFilters:u})=>{var f,m;const p=v=>{c(v.target.value)},g=v=>{x(v)};return n.jsxs(de,{className:"amenities-filters",children:[n.jsx(wk,{level:5,className:"filter-heading",children:"Filters"}),n.jsxs(Ce,{gutter:[16,16],children:[n.jsx(K,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Exhibition"}),n.jsx(Pe,{placeholder:"Select an exhibition",style:{width:"100%"},loading:r,onChange:s,value:e,children:t.map(v=>n.jsx(tn,{value:v._id,children:v.name},v._id))})]})}),n.jsx(K,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Amenity Type"}),n.jsxs(Pe,{mode:"multiple",placeholder:"Select types",style:{width:"100%"},value:i,onChange:a,maxTagCount:2,children:[n.jsx(tn,{value:"facility",children:"Facility"}),n.jsx(tn,{value:"service",children:"Service"}),n.jsx(tn,{value:"equipment",children:"Equipment"}),n.jsx(tn,{value:"other",children:"Other"})]})]})}),n.jsx(K,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Booking Status"}),n.jsxs(Pe,{mode:"multiple",placeholder:"Select statuses",style:{width:"100%"},value:o,onChange:l,maxTagCount:2,children:[n.jsx(tn,{value:"confirmed",children:"Confirmed"}),n.jsx(tn,{value:"approved",children:"Approved"}),n.jsx(tn,{value:"pending",children:"Pending"}),n.jsx(tn,{value:"rejected",children:"Rejected"}),n.jsx(tn,{value:"cancelled",children:"Cancelled"})]})]})}),n.jsx(K,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Search"}),n.jsx(he,{placeholder:"Search amenities",prefix:n.jsx(kn,{}),value:d,onChange:p,allowClear:!0})]})}),n.jsx(K,{xs:24,md:16,lg:12,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(Ds,{className:"filter-label",children:"Booking Date Range"}),n.jsx(jk,{style:{width:"100%"},onChange:g,value:h})]})}),n.jsx(K,{xs:24,md:8,lg:12,children:n.jsx("div",{className:"filter-group",style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%"},children:n.jsxs(ue,{children:[n.jsx(te,{icon:n.jsx(Xs,{}),onClick:u,children:"Reset"}),n.jsx(te,{type:"primary",icon:n.jsx(Gi,{}),children:"Apply Filters"})]})})})]}),(i.length>0||o.length>0||d||h)&&n.jsxs(n.Fragment,{children:[n.jsx(nt,{className:"filter-divider"}),n.jsxs("div",{children:[n.jsx(Ds,{className:"filter-label",children:"Active Filters:"}),n.jsxs("div",{style:{marginTop:8},children:[i.map(v=>n.jsxs(Se,{closable:!0,onClose:()=>a(i.filter(w=>w!==v)),className:`amenity-tag amenity-tag-${v}`,children:["Type: ",v]},`type-${v}`)),o.map(v=>n.jsxs(Se,{closable:!0,onClose:()=>l(o.filter(w=>w!==v)),color:"blue",children:["Status: ",v]},`status-${v}`)),d&&n.jsxs(Se,{closable:!0,onClose:()=>c(""),color:"purple",children:["Search: ",d]}),h&&n.jsxs(Se,{closable:!0,onClose:()=>x(null),color:"green",children:["Date Range: ",(f=h[0])==null?void 0:f.format("MMM DD, YYYY")," - ",(m=h[1])==null?void 0:m.format("MMM DD, YYYY")]})]})]})]})]})},{Text:l4}=Le,Ek=({basicAmenities:e,extraAmenities:t,bookedStalls:r,calculatedAmenities:s})=>n.jsxs(Ce,{gutter:[24,24],children:[n.jsx(K,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-primary",bordered:!1,children:[n.jsx(Ro,{style:{fontSize:24,color:"#1890ff"}}),n.jsx("div",{className:"stats-value",children:e.length}),n.jsx("div",{className:"stats-label",children:"Basic Amenities"})]})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-secondary",bordered:!1,children:[n.jsx(ms,{style:{fontSize:24,color:"#52c41a"}}),n.jsx("div",{className:"stats-value",children:t.length}),n.jsx("div",{className:"stats-label",children:"Extra Amenities"})]})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-tertiary",bordered:!1,children:[n.jsx(ho,{style:{fontSize:24,color:"#fa8c16"}}),n.jsx("div",{className:"stats-value",children:r}),n.jsx("div",{className:"stats-label",children:"Booked Stalls"})]})}),n.jsx(K,{xs:24,sm:12,md:6,children:n.jsxs(de,{className:"stats-card stats-quaternary",bordered:!1,children:[n.jsx(Kx,{style:{fontSize:24,color:"#722ed1"}}),n.jsx("div",{className:"stats-value",children:s}),n.jsx("div",{className:"stats-label",children:"Calculated Amenities"})]})})]}),{Text:On,Title:hu}=Le,uu=e=>{switch(e){case"facility":return{color:"#e6f7ff",borderColor:"#91d5ff",textColor:"#1890ff"};case"service":return{color:"#f6ffed",borderColor:"#b7eb8f",textColor:"#52c41a"};case"equipment":return{color:"#fff7e6",borderColor:"#ffd591",textColor:"#fa8c16"};default:return{color:"#f9f0ff",borderColor:"#d3adf7",textColor:"#722ed1"}}},Yl=({title:e,amenities:t,loading:r,onExport:s,isDynamicColumns:i=!1,isCalculated:a=!1,exhibitionId:o,amenityViewType:l="all"})=>{const[d,c]=k.useState([]),[h,x]=k.useState([]),[u,p]=k.useState(!1),g=k.useMemo(()=>!a||l==="all"?t:l==="basic"?t.filter(b=>b.hasOwnProperty("calculatedQuantity")||b.hasOwnProperty("perSqm")):l==="extra"?t.filter(b=>b.hasOwnProperty("rate")&&!b.hasOwnProperty("perSqm")):t,[t,a,l]);k.useEffect(()=>{if(!o){x([]),p(!1);return}p(!0),setTimeout(()=>{p(!1)},500)},[o]);const f=()=>{const b=new Map;return g.forEach(E=>{var j,S;if(E.stallId&&E.stallNumber){b.has(E.stallId)||b.set(E.stallId,{key:E.stallId,companyName:E.exhibitorName||"Unknown",stallNumber:E.stallNumber,dimension:E.dimensions?`${E.dimensions.width}x${E.dimensions.height}m`:"-",stallType:E.stallType||"-",area:E.area||((j=E.dimensions)!=null&&j.width&&((S=E.dimensions)!=null&&S.height)?E.dimensions.width*E.dimensions.height:"-"),bookingDate:E.bookingDate?new Date(E.bookingDate).toISOString().slice(0,10):"-",status:E.bookingStatus||"-",amenities:{}});const C=b.get(E.stallId);if(E.hasOwnProperty("calculatedQuantity"))C.amenities[E.name]=E.calculatedQuantity;else if(E.hasOwnProperty("perSqm")){const T=typeof C.area=="number"?C.area:0,A=Math.floor(T/E.perSqm)*E.quantity;C.amenities[E.name]=A>0?A:E.quantity}else E.hasOwnProperty("booked")&&E.booked?C.amenities[E.name]=1:E.hasOwnProperty("rate")&&(C.amenities[E.name]="✓")}}),Array.from(b.values()).filter(E=>Object.keys(E.amenities).length>0)},m=()=>{const b=new Set;return g.forEach(E=>{const j=S=>a?!0:e.toLowerCase().includes("basic")?S.hasOwnProperty("perSqm"):e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra")?S.hasOwnProperty("rate"):!0;E.name&&j(E)&&b.add(E.name)}),Array.from(b)},v=()=>{const b=[{title:"Company Name",dataIndex:"companyName",key:"companyName",fixed:"left",width:180,render:C=>n.jsx(On,{strong:!0,children:C}),sorter:(C,T)=>C.companyName.localeCompare(T.companyName)},{title:"Stall No.",dataIndex:"stallNumber",key:"stallNumber",width:100,render:C=>n.jsx(xr,{status:"success",text:C}),sorter:(C,T)=>C.stallNumber.localeCompare(T.stallNumber)},{title:"Dimension",dataIndex:"dimension",key:"dimension",width:120},{title:"Stall Type",dataIndex:"stallType",key:"stallType",width:120},{title:"Area (SQM)",dataIndex:"area",key:"area",width:100,render:C=>typeof C=="number"?C.toFixed(2):C,sorter:(C,T)=>{const A=typeof C.area=="number"?C.area:0,I=typeof T.area=="number"?T.area:0;return A-I}}],j=m().map(C=>({title:C,dataIndex:["amenities",C],key:C,width:100,render:T=>T==null?"-":T==="✓"?n.jsx(xr,{status:"success"}):n.jsx(On,{strong:!0,children:T}),sorter:(T,A)=>{const I=T.amenities[C]||0,P=A.amenities[C]||0;return I-P}})),S={title:"Actions",key:"actions",width:80,fixed:"right",render:(C,T)=>n.jsx(Vn,{overlay:n.jsxs(or,{children:[n.jsx(or.Item,{icon:n.jsx(dn,{}),children:"View Details"},"view"),n.jsx(or.Item,{icon:n.jsx(as,{}),children:"Edit"},"edit"),n.jsx(or.Item,{icon:n.jsx(Fi,{}),children:"Settings"},"settings")]}),trigger:["click"],children:n.jsx(te,{type:"text",icon:n.jsx(Xx,{})})})};return[...b,...j,S]},w=b=>{c(b)},_=f(),y=b=>n.jsxs("div",{style:{padding:"20px"},children:[n.jsx(hu,{level:5,children:"Stall Details"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:[Object.entries(b).map(([E,j])=>["key","amenities"].includes(E)?null:n.jsxs("div",{style:{marginBottom:"8px"},children:[n.jsxs(On,{type:"secondary",style:{fontSize:"12px"},children:[E.charAt(0).toUpperCase()+E.slice(1).replace(/([A-Z])/g," $1"),":"]}),n.jsx("div",{children:n.jsx(On,{strong:!0,children:j==null?"-":typeof j=="object"?JSON.stringify(j):String(j)})})]},E)),n.jsxs("div",{style:{marginBottom:"8px",gridColumn:"1 / -1"},children:[n.jsx(On,{type:"secondary",style:{fontSize:"12px"},children:"Amenities:"}),n.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},children:Object.entries(b.amenities||{}).map(([E,j])=>n.jsxs(Se,{color:"blue",children:[E,": ",j==="✓"?"Available":j]},E))})]})]})]});return n.jsx(de,{className:"amenities-card",title:n.jsxs(ue,{children:[n.jsx(hu,{level:5,style:{margin:0},children:e}),a&&n.jsxs(n.Fragment,{children:[n.jsx(Se,{color:"green",children:"Calculated"}),l==="basic"&&n.jsx(Se,{color:"blue",children:"Basic Amenities"}),l==="extra"&&n.jsx(Se,{color:"purple",children:"Extra Amenities"}),l==="all"&&n.jsx(Se,{color:"orange",children:"All Amenities"})]})]}),extra:n.jsx(ue,{children:n.jsx(te,{type:"primary",icon:n.jsx(Po,{}),onClick:s,disabled:g.length===0,children:"Export"})}),children:g.length===0?n.jsx(mt,{image:mt.PRESENTED_IMAGE_SIMPLE,description:"No amenities data available"}):e.toLowerCase().includes("basic")&&!a?n.jsx(tt,{dataSource:g.map((b,E)=>({key:b._id||b.id||`basic-${E}`,...b})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(b,E)=>n.jsxs(ue,{children:[n.jsx(On,{strong:!0,children:b}),n.jsx(Se,{color:uu(E.type).textColor,children:E.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Per SQM",dataIndex:"perSqm",key:"perSqm",render:b=>b?`1 per ${b} sqm`:"-"},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:b=>n.jsx(Se,{color:"blue",children:b})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):(e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra"))&&!a?n.jsx(tt,{dataSource:g.map((b,E)=>({key:b._id||b.id||`extra-${E}`,...b})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(b,E)=>n.jsxs(ue,{children:[n.jsx(On,{strong:!0,children:b}),n.jsx(Se,{color:uu(E.type).textColor,children:E.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Rate",dataIndex:"rate",key:"rate",render:b=>n.jsxs(On,{style:{color:"#1890ff"},children:["₹",b.toLocaleString()]})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):_.length===0?n.jsx(_t,{message:"No stall data available",description:"Amenities exist but could not be linked to stalls. Make sure stalls are booked and have amenities assigned.",type:"info",showIcon:!0}):n.jsx(tt,{dataSource:_,columns:v(),loading:r||u,pagination:{pageSize:10},className:"amenities-table",scroll:{x:"max-content"},expandable:{expandedRowKeys:d,onExpandedRowsChange:w,expandedRowRender:y}})})},{Title:Tk,Text:fu}=Le,{TabPane:Kl}=Gt,Xl=(e,t)=>{const r=Gl.json_to_sheet(e),s=Gl.book_new();Gl.book_append_sheet(s,r,"Amenities");const i=X0(s,{bookType:"xlsx",type:"array"}),a=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});bk.saveAs(a,`${t}.xlsx`)},_k=()=>{const e=it(),{message:t}=Yt.useApp(),{exhibitions:r,loading:s}=Me(Z=>Z.exhibition),{bookings:i,loading:a}=Me(Z=>Z.booking),[o,l]=k.useState(null),[d,c]=k.useState([]),[h,x]=k.useState([]),[u,p]=k.useState([]),[g,f]=k.useState([]),[m,v]=k.useState([]),[w,_]=k.useState(""),[y,b]=k.useState(null),[E,j]=k.useState(0),[S,C]=k.useState(0),[T,A]=k.useState("basic"),[I,P]=k.useState("basic");k.useEffect(()=>{e(Lr()),e(Mn())},[e]),k.useEffect(()=>{if(o&&r.length>0){const Z=r.find(R=>R._id===o);if(Z){c(Z.basicAmenities||[]),x(Z.amenities||[]);const R=i.filter(V=>V.exhibitionId._id===o&&["confirmed","approved"].includes(V.status));if(R.length===0){p([]),j(0),C(0);return}const U=R.flatMap(V=>V.stallIds.map(se=>({stallId:se._id,stallNumber:se.number,bookingId:V._id,exhibitorName:V.companyName,bookingDate:V.createdAt,dimensions:se.dimensions,area:se.dimensions.width*se.dimensions.height,status:V.status}))),B=R.flatMap(V=>!V.basicAmenities||V.basicAmenities.length===0?V.stallIds.flatMap(se=>{const xe=se.dimensions.width*se.dimensions.height;return(Z.basicAmenities||[]).map(me=>{const Q=Math.floor(xe/me.perSqm)*me.quantity;return{...me,calculatedQuantity:Q>0?Q:me.quantity,stallId:se._id,stallNumber:se.number,bookingId:V._id,exhibitorId:V.exhibitorId||"",exhibitorName:V.companyName,bookingDate:V.createdAt,dimensions:se.dimensions,area:xe,bookingStatus:V.status}})}):V.basicAmenities.flatMap(se=>V.stallIds.map(xe=>({...se,stallId:xe._id,stallNumber:xe.number,bookingId:V._id,exhibitorId:V.exhibitorId||"",exhibitorName:V.companyName,bookingDate:V.createdAt,dimensions:xe.dimensions,area:xe.dimensions.width*xe.dimensions.height,bookingStatus:V.status})))),F=R.flatMap(V=>!V.extraAmenities||V.extraAmenities.length===0?[]:V.extraAmenities.flatMap(se=>V.stallIds.map(xe=>({...se,booked:!0,stallId:xe._id,stallNumber:xe.number,bookingId:V._id,exhibitorId:V.exhibitorId||"",exhibitorName:V.companyName,bookingDate:V.createdAt,dimensions:xe.dimensions,area:xe.dimensions.width*xe.dimensions.height,bookingStatus:V.status}))));p([...B,...F]),j(U.length),C(B.length+F.length)}}else c([]),x([]),p([]),j(0),C(0)},[o,r,i]);const N=k.useMemo(()=>{let Z=d;if(g.length>0&&(Z=Z.filter(R=>g.includes(R.type))),w){const R=w.toLowerCase();Z=Z.filter(U=>U.name.toLowerCase().includes(R)||U.type.toLowerCase().includes(R)||U.description&&U.description.toLowerCase().includes(R))}return Z},[d,g,w]),q=k.useMemo(()=>{let Z=h;if(g.length>0&&(Z=Z.filter(R=>g.includes(R.type))),w){const R=w.toLowerCase();Z=Z.filter(U=>U.name.toLowerCase().includes(R)||U.type.toLowerCase().includes(R)||U.description&&U.description.toLowerCase().includes(R))}return Z},[h,g,w]),L=k.useMemo(()=>{let Z=u;if(g.length>0&&(Z=Z.filter(R=>g.includes(R.type))),m.length>0&&(Z=Z.filter(R=>m.includes(R.bookingStatus))),w){const R=w.toLowerCase();Z=Z.filter(U=>U.name.toLowerCase().includes(R)||U.type.toLowerCase().includes(R)||U.description&&U.description.toLowerCase().includes(R)||U.stallNumber&&U.stallNumber.toLowerCase().includes(R)||U.exhibitorName&&U.exhibitorName.toLowerCase().includes(R))}if(y&&y[0]&&y[1]){const R=y[0].startOf("day"),U=y[1].endOf("day");Z=Z.filter(B=>{if(!B.bookingDate)return!1;const F=et(B.bookingDate);return F.isAfter(R)&&F.isBefore(U)})}return Z},[u,g,m,w,y]),D=()=>{f([]),v([]),_(""),b(null)},M=()=>{if(N.length===0){t.warning("No basic amenities to export");return}const Z=N.map(B=>({Name:B.name,Type:B.type,Description:B.description||"","Per Sq. Meter":B.perSqm,"Quantity Per Unit":B.quantity,ID:B._id||B.id})),R=r.find(B=>B._id===o),U=`${(R==null?void 0:R.name)||"Exhibition"}_Basic_Amenities`;Xl(Z,U),t.success("Basic amenities exported successfully")},J=()=>{if(q.length===0){t.warning("No extra amenities to export");return}const Z=q.map(B=>({Name:B.name,Type:B.type,Description:B.description||"",Rate:B.rate,ID:B._id||B.id})),R=r.find(B=>B._id===o),U=`${(R==null?void 0:R.name)||"Exhibition"}_Extra_Amenities`;Xl(Z,U),t.success("Extra amenities exported successfully")},ne=()=>{if(L.length===0){t.warning("No calculated amenities to export");return}const Z=L.map(B=>{const F={Name:B.name,Type:B.type,Description:B.description||"","Stall Number":B.stallNumber,Exhibitor:B.exhibitorName,"Booking Status":B.bookingStatus,"Booking Date":B.bookingDate?new Date(B.bookingDate).toLocaleDateString():""};return B.hasOwnProperty("calculatedQuantity")&&(F["Calculated Quantity"]=B.calculatedQuantity,F["Per Sq. Meter"]=B.perSqm,F["Base Quantity"]=B.quantity),B.hasOwnProperty("rate")&&(F.Rate=B.rate,F.Booked=B.booked?"Yes":"No"),F}),R=r.find(B=>B._id===o),U=`${(R==null?void 0:R.name)||"Exhibition"}_Calculated_Amenities`;Xl(Z,U),t.success("Calculated amenities exported successfully")};return n.jsxs("div",{className:"amenities-container",children:[n.jsxs("div",{className:"amenities-header",children:[n.jsx(Tk,{level:4,className:"amenities-title",children:"Amenities Management"}),n.jsx(fu,{type:"secondary",children:"View, filter, and export amenities data. See calculated amenities for booked stalls."})]}),n.jsx(Sk,{exhibitionId:o,exhibitions:r,exhibitionsLoading:s,onExhibitionChange:l,typeFilter:g,setTypeFilter:f,bookingStatusFilter:m,setBookingStatusFilter:v,searchQuery:w,setSearchQuery:_,dateRange:y,setDateRange:b,resetFilters:D}),o&&n.jsx("div",{style:{marginBottom:24},children:n.jsx(Ek,{basicAmenities:d,extraAmenities:h,bookedStalls:E,calculatedAmenities:S})}),o?n.jsxs(Gt,{activeKey:T,onChange:A,className:"amenities-tabs",children:[n.jsx(Kl,{tab:n.jsxs("span",{children:[n.jsx(Qx,{}),"Basic Amenities"]}),children:n.jsx(Yl,{title:"Basic Amenities",amenities:N,loading:s,onExport:M,exhibitionId:o})},"basic"),n.jsx(Kl,{tab:n.jsxs("span",{children:[n.jsx(ms,{}),"Extra Amenities"]}),children:n.jsx(Yl,{title:"Additional Amenities",amenities:q,loading:s,onExport:J,exhibitionId:o})},"extra"),n.jsxs(Kl,{tab:n.jsxs("span",{children:[n.jsx(Jx,{}),"Calculated Amenities"]}),children:[n.jsx(Ce,{gutter:[0,16],children:n.jsx(K,{span:24,children:n.jsx(de,{className:"filter-card",children:n.jsxs(ue,{children:[n.jsx(fu,{strong:!0,children:"View: "}),n.jsxs(mr.Group,{value:I,onChange:Z=>P(Z.target.value),optionType:"button",buttonStyle:"solid",children:[n.jsx(mr.Button,{value:"basic",children:"Basic Amenities"}),n.jsx(mr.Button,{value:"extra",children:"Extra Amenities"}),n.jsx(mr.Button,{value:"all",children:"All Amenities"})]})]})})})}),n.jsx(Yl,{title:"Calculated Amenities",amenities:L,loading:s,onExport:ne,isDynamicColumns:!0,isCalculated:!0,exhibitionId:o,amenityViewType:I})]},"calculated")]}):n.jsx("div",{style:{marginTop:24,textAlign:"center",padding:48,background:"#fff",borderRadius:8},children:n.jsx(mt,{description:"Please select an exhibition to view amenities",image:mt.PRESENTED_IMAGE_SIMPLE})})]})},Tt=({children:e})=>Me(r=>r.auth.isAuthenticated)?e:n.jsx(Do,{to:"/login"}),Ls=({children:e})=>Me(r=>r.exhibitorAuth.isAuthenticated)?e:n.jsx(Do,{to:"/"});function kk(){return n.jsx(Yt,{children:n.jsx(Xi,{children:n.jsx(cp,{children:n.jsxs(dp,{children:[n.jsx(Ge,{path:"/",element:n.jsx(kb,{})}),n.jsx(Ge,{path:"/login",element:n.jsx(Fg,{})}),n.jsx(Ge,{path:"/exhibitions",element:n.jsx($v,{})}),n.jsx(Ge,{path:"/exhibitions/:id",element:n.jsx(Tv,{})}),n.jsx(Ge,{path:"/exhibitions/:id/layout",element:n.jsx(jv,{})}),n.jsx(Ge,{path:"/exhibitor/dashboard",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(Og,{})})})}),n.jsx(Ge,{path:"/exhibitor/profile",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(qg,{})})})}),n.jsx(Ge,{path:"/exhibitor/bookings",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(Ug,{})})})}),n.jsx(Ge,{path:"/exhibitor/bookings/:id",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(zg,{})})})}),n.jsx(Ge,{path:"/exhibitor/support",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx("div",{children:"Help & Support"})})})}),n.jsx(Ge,{path:"/exhibitor/invoice/:id",element:n.jsx(Ls,{children:n.jsx(js,{children:n.jsx(O1,{})})})}),n.jsx(Ge,{path:"/dashboard",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Dg,{})})})}),n.jsx(Ge,{path:"/account",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(B1,{})})})}),n.jsx(Ge,{path:"/exhibition",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Sy,{})})})}),n.jsx(Ge,{path:"/exhibition/create",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Ay,{})})})}),n.jsx(Ge,{path:"/exhibition/:id",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Iy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/space",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Hy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/layout",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Gy,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/halls",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Ky,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/stalls",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(zv,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/fixtures",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Hv,{})})})}),n.jsx(Ge,{path:"/exhibition/:id/edit",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Ny,{})})})}),n.jsx(Ge,{path:"/stall/list",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Yv,{})})})}),n.jsx(Ge,{path:"/stall-types",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Zv,{})})})}),n.jsx(Ge,{path:"/bookings",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(cb,{})})})}),n.jsx(Ge,{path:"/bookings/create",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(xb,{})})})}),n.jsx(Ge,{path:"/amenities",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(_k,{})})})}),n.jsx(Ge,{path:"/invoices",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(yb,{})})})}),n.jsx(Ge,{path:"/invoice/:id",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(pb,{})})})}),n.jsx(Ge,{path:"/index",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(xy,{})})})}),n.jsx(Ge,{path:"/settings",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(U1,{})})})}),n.jsx(Ge,{path:"/roles",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(J1,{})})})}),n.jsx(Ge,{path:"/notifications",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(yy,{})})})}),n.jsx(Ge,{path:"/exhibitors",element:n.jsx(Tt,{children:n.jsx(St,{children:n.jsx(Fb,{})})})}),n.jsx(Ge,{path:"*",element:n.jsx(Do,{to:"/",replace:!0})})]})})})})}const Ql=Bc({reducerPath:"bookingApi",baseQuery:Pc({baseUrl:"/api"}),endpoints:e=>({getBookings:e.query({query:()=>"/bookings"}),getBooking:e.query({query:t=>`/bookings/${t}`}),createBooking:e.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:e.mutation({query:({id:t,status:r})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:r}})})})}),Ck=hp({reducer:{auth:Ep,exhibitorAuth:Vm,exhibition:by,booking:tb,exhibitor:ub,settings:Dm,role:Y1,user:iy,[Ql.reducerPath]:Ql.reducer,[oo.reducerPath]:oo.reducer,[Va.reducerPath]:Va.reducer},middleware:e=>e().concat(Ql.middleware).concat(oo.middleware).concat(Va.middleware)}),Ak={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};ec.createRoot(document.getElementById("root")).render(n.jsx(xt.StrictMode,{children:n.jsx(up,{store:Ck,children:n.jsx(Zx,{theme:Ak,children:n.jsx(Yt,{children:n.jsx(kk,{})})})})}));
