const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Profile-pjpivlBe.js","assets/vendor-Be5M1UDi.js","assets/apis-CU9I9MMq.js","assets/canvas-C-A9eff5.js","assets/Settings-7lKtozgo.js","assets/index-DqlSwRRM.js","assets/index-Ahak6Wm8.js","assets/index-BnI-KQ2-.js","assets/index-CDFsR1o5.js","assets/index-Debrw9F4.js","assets/ExhibitionForm-DawnZYuS.js","assets/editor-DT5Rg6kW.js","assets/index-9A4FFAsW.js","assets/edit-CuRt1fT3.js","assets/index-DxE3Dla6.js","assets/index-Bk-L6djj.js","assets/index-BNW7guJz.js","assets/index-DW8o6y-L.js","assets/index-ykipEumD.js","assets/index-mWyePFbu.js","assets/index-BlrrYI1G.js"])))=>i.map(i=>d[i]);
var Yp=Object.defineProperty;var Xp=(e,t,r)=>t in e?Yp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Sd=(e,t,r)=>Xp(e,typeof t!="symbol"?t+"":t,r);import{r as N,a as Kp,b as Ye,d as gr,c as wi,g as Qp,e as St,T as Ue,L as yn,f as ht,S as ke,h as Ne,B as Br,A as Kn,i as fe,j as En,k as Sh,l as jt,m as Jp,n as br,o as $a,u as tr,p as ut,q as Is,s as jh,t as Ua,v as Kr,w as An,x as Rt,E as xt,D as Tt,y as ni,z as jd,_ as Zp,C as Et,F as hr,G as vc,M as cr,H as Eh,I as _h,J as za,K as Wa,N as bc,O as $r,P as Nt,Q as ex,U as Qn,V as wc,W as tx,X as rx,Y as Re,Z as oe,$ as nx,a0 as ix,a1 as Ct,a2 as Ei,a3 as fo,a4 as or,a5 as Se,a6 as qa,a7 as Va,a8 as sx,a9 as ze,aa as ae,ab as Ae,R as _t,ac as Pt,ad as vn,ae as Th,af as Cr,ag as pt,ah as Ln,ai as Ns,aj as Sc,ak as jc,al as ax,am as ox,an as Ed,ao as lx,ap as cx,aq as dx,ar as ux,as as Ri,at as hx,au as Jl,av as cn,aw as fx,ax as _d,ay as Ec,az as px,aA as ps,aB as Mr,aC as Fs,aD as xx,aE as mx,aF as nt,aG as gx,aH as Ah,aI as yx,aJ as vx,aK as Td,aL as bx,aM as wx,aN as Sx,aO as Rs,aP as jx,aQ as kh,aR as Xe,aS as ft,aT as Ex,aU as Ad,aV as _x,aW as po,aX as Ps,aY as Ch,aZ as Tx,a_ as Ax,a$ as kd,b0 as Ih,b1 as Nh,b2 as xs,b3 as kx,b4 as Li,b5 as Fh,b6 as _c,b7 as Gi,b8 as Ha,b9 as Tc,ba as Jn,bb as Cd,bc as Cx,bd as Rh,be as Yo,bf as Ac,bg as Ph,bh as Ix,bi as Dh,bj as Nx,bk as Id,bl as Fx,bm as Rx,bn as Px,bo as Dx,bp as ss,bq as kc,br as xo,bs as ms,bt as yr,bu as Ds,bv as Oh,bw as Ox,bx as Os,by as Lh,bz as Mh,bA as Bh,bB as Lx,bC as $h,bD as Mx,bE as Bx,bF as $x,bG as Ux,bH as zx,bI as Wx,bJ as He,bK as Cc,bL as qx,bM as Vx,bN as Hx}from"./vendor-Be5M1UDi.js";import{a as Pe,b as bn,p as rn,e as Yi,d as Uh}from"./apis-CU9I9MMq.js";import{L as Ga,G as Pi,R as mo,T as gs,u as Gx,a as Yx,I as Xx,C as Kx,b as Qx,c as Jx,K as Xo,S as Zx,F as em,d as tm}from"./canvas-C-A9eff5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var zh={exports:{}},go={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rm=N,nm=Symbol.for("react.element"),im=Symbol.for("react.fragment"),sm=Object.prototype.hasOwnProperty,am=rm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,om={key:!0,ref:!0,__self:!0,__source:!0};function Wh(e,t,r){var i,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)sm.call(t,i)&&!om.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)s[i]===void 0&&(s[i]=t[i]);return{$$typeof:nm,type:e,key:a,ref:o,props:s,_owner:am.current}}go.Fragment=im;go.jsx=Wh;go.jsxs=Wh;zh.exports=go;var n=zh.exports,Zl={},Nd=Kp;Zl.createRoot=Nd.createRoot,Zl.hydrateRoot=Nd.hydrateRoot;const lm="modulepreload",cm=function(e){return"/"+e},Fd={},rr=function(t,r,i){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(d=>{if(d=cm(d),d in Fd)return;Fd[d]=!0;const c=d.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":lm,c||(f.as="script"),f.crossOrigin="",f.href=d,l&&f.setAttribute("nonce",l),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},qh={login:async e=>await Pe.post("/auth/login",e),getProfile:async()=>await Pe.get("/auth/me"),changePassword:async e=>await Pe.post("/auth/change-password",e)},Rd=localStorage.getItem("token"),Ko=localStorage.getItem("user");let Vh=null;try{Vh=Ko&&Ko!=="undefined"?JSON.parse(Ko):null}catch(e){console.error("Failed to parse user data from localStorage",e),localStorage.removeItem("user")}const dm={isAuthenticated:!!Rd,user:Vh,token:Rd,loading:!1,error:null},Sa=Ye("auth/refreshUser",async(e,{rejectWithValue:t})=>{var r,i;try{return(await qh.getProfile()).data}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to refresh user data")}}),Hh=gr({name:"auth",initialState:dm,reducers:{setCredentials:(e,t)=>{e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("token",t.payload.token),localStorage.setItem("user",JSON.stringify(t.payload.user))},logout:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("user")}},extraReducers:e=>{e.addCase(Sa.pending,t=>{t.loading=!0,t.error=null}).addCase(Sa.fulfilled,(t,r)=>{t.loading=!1,t.user=r.payload,localStorage.setItem("user",JSON.stringify(r.payload))}).addCase(Sa.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{setCredentials:um,logout:Pd}=Hh.actions,hm=Hh.reducer,un=Object.create(null);un.open="0";un.close="1";un.ping="2";un.pong="3";un.message="4";un.upgrade="5";un.noop="6";const ja=Object.create(null);Object.keys(un).forEach(e=>{ja[un[e]]=e});const ec={type:"error",data:"parser error"},Gh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Yh=typeof ArrayBuffer=="function",Xh=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Ic=({type:e,data:t},r,i)=>Gh&&t instanceof Blob?r?i(t):Dd(t,i):Yh&&(t instanceof ArrayBuffer||Xh(t))?r?i(t):Dd(new Blob([t]),i):i(un[e]+(t||"")),Dd=(e,t)=>{const r=new FileReader;return r.onload=function(){const i=r.result.split(",")[1];t("b"+(i||""))},r.readAsDataURL(e)};function Od(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Qo;function fm(e,t){if(Gh&&e.data instanceof Blob)return e.data.arrayBuffer().then(Od).then(t);if(Yh&&(e.data instanceof ArrayBuffer||Xh(e.data)))return t(Od(e.data));Ic(e,!1,r=>{Qo||(Qo=new TextEncoder),t(Qo.encode(r))})}const Ld="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ns=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Ld.length;e++)ns[Ld.charCodeAt(e)]=e;const pm=e=>{let t=e.length*.75,r=e.length,i,s=0,a,o,l,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const c=new ArrayBuffer(t),u=new Uint8Array(c);for(i=0;i<r;i+=4)a=ns[e.charCodeAt(i)],o=ns[e.charCodeAt(i+1)],l=ns[e.charCodeAt(i+2)],d=ns[e.charCodeAt(i+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|d&63;return c},xm=typeof ArrayBuffer=="function",Nc=(e,t)=>{if(typeof e!="string")return{type:"message",data:Kh(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:mm(e.substring(1),t)}:ja[r]?e.length>1?{type:ja[r],data:e.substring(1)}:{type:ja[r]}:ec},mm=(e,t)=>{if(xm){const r=pm(e);return Kh(r,t)}else return{base64:!0,data:e}},Kh=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Qh="",gm=(e,t)=>{const r=e.length,i=new Array(r);let s=0;e.forEach((a,o)=>{Ic(a,!1,l=>{i[o]=l,++s===r&&t(i.join(Qh))})})},ym=(e,t)=>{const r=e.split(Qh),i=[];for(let s=0;s<r.length;s++){const a=Nc(r[s],t);if(i.push(a),a.type==="error")break}return i};function vm(){return new TransformStream({transform(e,t){fm(e,r=>{const i=r.length;let s;if(i<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,i);else if(i<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,i)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(i))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let Jo;function Xs(e){return e.reduce((t,r)=>t+r.length,0)}function Ks(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let i=0;for(let s=0;s<t;s++)r[s]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),r}function bm(e,t){Jo||(Jo=new TextDecoder);const r=[];let i=0,s=-1,a=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(i===0){if(Xs(r)<1)break;const d=Ks(r,1);a=(d[0]&128)===128,s=d[0]&127,s<126?i=3:s===126?i=1:i=2}else if(i===1){if(Xs(r)<2)break;const d=Ks(r,2);s=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),i=3}else if(i===2){if(Xs(r)<8)break;const d=Ks(r,8),c=new DataView(d.buffer,d.byteOffset,d.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){l.enqueue(ec);break}s=u*Math.pow(2,32)+c.getUint32(4),i=3}else{if(Xs(r)<s)break;const d=Ks(r,s);l.enqueue(Nc(a?d:Jo.decode(d),t)),i=0}if(s===0||s>e){l.enqueue(ec);break}}}})}const Jh=4;function Ot(e){if(e)return wm(e)}function wm(e){for(var t in Ot.prototype)e[t]=Ot.prototype[t];return e}Ot.prototype.on=Ot.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ot.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Ot.prototype.off=Ot.prototype.removeListener=Ot.prototype.removeAllListeners=Ot.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var i,s=0;s<r.length;s++)if(i=r[s],i===t||i.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Ot.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(r){r=r.slice(0);for(var i=0,s=r.length;i<s;++i)r[i].apply(this,t)}return this};Ot.prototype.emitReserved=Ot.prototype.emit;Ot.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ot.prototype.hasListeners=function(e){return!!this.listeners(e).length};const yo=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Lr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Sm="arraybuffer";function Zh(e,...t){return t.reduce((r,i)=>(e.hasOwnProperty(i)&&(r[i]=e[i]),r),{})}const jm=Lr.setTimeout,Em=Lr.clearTimeout;function vo(e,t){t.useNativeTimers?(e.setTimeoutFn=jm.bind(Lr),e.clearTimeoutFn=Em.bind(Lr)):(e.setTimeoutFn=Lr.setTimeout.bind(Lr),e.clearTimeoutFn=Lr.clearTimeout.bind(Lr))}const _m=1.33;function Tm(e){return typeof e=="string"?Am(e):Math.ceil((e.byteLength||e.size)*_m)}function Am(e){let t=0,r=0;for(let i=0,s=e.length;i<s;i++)t=e.charCodeAt(i),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(i++,r+=4);return r}function e0(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function km(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function Cm(e){let t={},r=e.split("&");for(let i=0,s=r.length;i<s;i++){let a=r[i].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class Im extends Error{constructor(t,r,i){super(t),this.description=r,this.context=i,this.type="TransportError"}}class Fc extends Ot{constructor(t){super(),this.writable=!1,vo(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,i){return super.emitReserved("error",new Im(t,r,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Nc(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=km(t);return r.length?"?"+r:""}}class Nm extends Fc{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||r()})),this.writable||(i++,this.once("drain",function(){--i||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};ym(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,gm(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=e0()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let t0=!1;try{t0=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Fm=t0;function Rm(){}class Pm extends Nm{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,r){const i=this.request({method:"POST",data:t});i.on("success",r),i.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,i)=>{this.onError("xhr poll error",r,i)}),this.pollXhr=t}}let _i=class Ea extends Ot{constructor(t,r,i){super(),this.createRequest=t,vo(this,i),this._opts=i,this._method=i.method||"GET",this._uri=r,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const r=Zh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(r);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var s;i.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=Ea.requestsCount++,Ea.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Rm,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ea.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};_i.requestsCount=0;_i.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Md);else if(typeof addEventListener=="function"){const e="onpagehide"in Lr?"pagehide":"unload";addEventListener(e,Md,!1)}}function Md(){for(let e in _i.requests)_i.requests.hasOwnProperty(e)&&_i.requests[e].abort()}const Dm=function(){const e=r0({xdomain:!1});return e&&e.responseType!==null}();class Om extends Pm{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=Dm&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new _i(r0,this.uri(),t)}}function r0(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Fm))return new XMLHttpRequest}catch{}if(!t)try{return new Lr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const n0=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Lm extends Fc{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,i=n0?{}:Zh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,i)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const i=t[r],s=r===t.length-1;Ic(i,this.supportsBinary,a=>{try{this.doWrite(i,a)}catch{}s&&yo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=e0()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const Zo=Lr.WebSocket||Lr.MozWebSocket;class Mm extends Lm{createSocket(t,r,i){return n0?new Zo(t,r,i):r?new Zo(t,r):new Zo(t)}doWrite(t,r){this.ws.send(r)}}class Bm extends Fc{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=bm(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(r).getReader(),s=vm();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const a=()=>{i.read().then(({done:l,value:d})=>{l||(this.onPacket(d),a())}).catch(l=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const i=t[r],s=r===t.length-1;this._writer.write(i).then(()=>{s&&yo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const $m={websocket:Mm,webtransport:Bm,polling:Om},Um=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,zm=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function tc(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),i=e.indexOf("]");r!=-1&&i!=-1&&(e=e.substring(0,r)+e.substring(r,i).replace(/:/g,";")+e.substring(i,e.length));let s=Um.exec(e||""),a={},o=14;for(;o--;)a[zm[o]]=s[o]||"";return r!=-1&&i!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=Wm(a,a.path),a.queryKey=qm(a,a.query),a}function Wm(e,t){const r=/\/{2,9}/g,i=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function qm(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,s,a){s&&(r[s]=a)}),r}const rc=typeof addEventListener=="function"&&typeof removeEventListener=="function",_a=[];rc&&addEventListener("offline",()=>{_a.forEach(e=>e())},!1);class On extends Ot{constructor(t,r){if(super(),this.binaryType=Sm,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const i=tc(t);r.hostname=i.host,r.secure=i.protocol==="https"||i.protocol==="wss",r.port=i.port,i.query&&(r.query=i.query)}else r.host&&(r.hostname=tc(r.host).host);vo(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(i=>{const s=i.prototype.name;this.transports.push(s),this._transportsByName[s]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Cm(this.opts.query)),rc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},_a.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Jh,r.transport=t,this.id&&(r.sid=this.id);const i=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&On.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",On.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let i=0;i<this.writeBuffer.length;i++){const s=this.writeBuffer[i].data;if(s&&(r+=Tm(s)),i>0&&r>this._maxPayload)return this.writeBuffer.slice(0,i);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,yo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,i){return this._sendPacket("message",t,r,i),this}send(t,r,i){return this._sendPacket("message",t,r,i),this}_sendPacket(t,r,i,s){if(typeof r=="function"&&(s=r,r=void 0),typeof i=="function"&&(s=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const a={type:t,data:r,options:i};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(On.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),rc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=_a.indexOf(this._offlineEventListener);i!==-1&&_a.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}On.protocol=Jh;class Vm extends On{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),i=!1;On.priorWebsocketSuccess=!1;const s=()=>{i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!i)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;On.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=r.name,this.emitReserved("upgradeError",h)}}))};function a(){i||(i=!0,u(),r.close(),r=null)}const o=f=>{const h=new Error("probe error: "+f);h.transport=r.name,a(),this.emitReserved("upgradeError",h)};function l(){o("transport closed")}function d(){o("socket closed")}function c(f){r&&f.name!==r.name&&a()}const u=()=>{r.removeListener("open",s),r.removeListener("error",o),r.removeListener("close",l),this.off("close",d),this.off("upgrading",c)};r.once("open",s),r.once("error",o),r.once("close",l),this.once("close",d),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&r.push(t[i]);return r}}let Hm=class extends Vm{constructor(t,r={}){const i=typeof t=="object"?t:r;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(s=>$m[s]).filter(s=>!!s)),super(t,i)}};function Gm(e,t="",r){let i=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),i=tc(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const a=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+a+":"+i.port+t,i.href=i.protocol+"://"+a+(r&&r.port===i.port?"":":"+i.port),i}const Ym=typeof ArrayBuffer=="function",Xm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,i0=Object.prototype.toString,Km=typeof Blob=="function"||typeof Blob<"u"&&i0.call(Blob)==="[object BlobConstructor]",Qm=typeof File=="function"||typeof File<"u"&&i0.call(File)==="[object FileConstructor]";function Rc(e){return Ym&&(e instanceof ArrayBuffer||Xm(e))||Km&&e instanceof Blob||Qm&&e instanceof File}function Ta(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,i=e.length;r<i;r++)if(Ta(e[r]))return!0;return!1}if(Rc(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Ta(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Ta(e[r]))return!0;return!1}function Jm(e){const t=[],r=e.data,i=e;return i.data=nc(r,t),i.attachments=t.length,{packet:i,buffers:t}}function nc(e,t){if(!e)return e;if(Rc(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let i=0;i<e.length;i++)r[i]=nc(e[i],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=nc(e[i],t));return r}return e}function Zm(e,t){return e.data=ic(e.data,t),delete e.attachments,e}function ic(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=ic(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=ic(e[r],t));return e}const eg=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],tg=5;var Ge;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Ge||(Ge={}));class rg{constructor(t){this.replacer=t}encode(t){return(t.type===Ge.EVENT||t.type===Ge.ACK)&&Ta(t)?this.encodeAsBinary({type:t.type===Ge.EVENT?Ge.BINARY_EVENT:Ge.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===Ge.BINARY_EVENT||t.type===Ge.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=Jm(t),i=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(i),s}}function Bd(e){return Object.prototype.toString.call(e)==="[object Object]"}class Pc extends Ot{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const i=r.type===Ge.BINARY_EVENT;i||r.type===Ge.BINARY_ACK?(r.type=i?Ge.EVENT:Ge.ACK,this.reconstructor=new ng(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Rc(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const i={type:Number(t.charAt(0))};if(Ge[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===Ge.BINARY_EVENT||i.type===Ge.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(a,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););i.nsp=t.substring(a,r)}else i.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}i.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Pc.isPayloadValid(i.type,a))i.data=a;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case Ge.CONNECT:return Bd(r);case Ge.DISCONNECT:return r===void 0;case Ge.CONNECT_ERROR:return typeof r=="string"||Bd(r);case Ge.EVENT:case Ge.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&eg.indexOf(r[0])===-1);case Ge.ACK:case Ge.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ng{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=Zm(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ig=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Pc,Encoder:rg,get PacketType(){return Ge},protocol:tg},Symbol.toStringTag,{value:"Module"}));function Vr(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const sg=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class s0 extends Ot{constructor(t,r,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Vr(t,"open",this.onopen.bind(this)),Vr(t,"packet",this.onpacket.bind(this)),Vr(t,"error",this.onerror.bind(this)),Vr(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var i,s,a;if(sg.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:Ge.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,f=r.pop();this._registerAckCallback(u,f),o.id=u}const l=(s=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||s===void 0?void 0:s.writable,d=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(d?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var i;const s=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},s),o=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((i,s)=>{const a=(o,l)=>o?s(o):i(l);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...a)=>i!==this._queue[0]?void 0:(s!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ge.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ge.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ge.EVENT:case Ge.BINARY_EVENT:this.onevent(t);break;case Ge.ACK:case Ge.BINARY_ACK:this.onack(t);break;case Ge.DISCONNECT:this.ondisconnect();break;case Ge.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const i of r)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let i=!1;return function(...s){i||(i=!0,r.packet({type:Ge.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ge.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let i=0;i<r.length;i++)if(t===r[i])return r.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let i=0;i<r.length;i++)if(t===r[i])return r.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const i of r)i.apply(this,t.data)}}}function Mi(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Mi.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Mi.prototype.reset=function(){this.attempts=0};Mi.prototype.setMin=function(e){this.ms=e};Mi.prototype.setMax=function(e){this.max=e};Mi.prototype.setJitter=function(e){this.jitter=e};class sc extends Ot{constructor(t,r){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,vo(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((i=r.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Mi({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||ig;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Hm(this.uri,this.opts);const r=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const s=Vr(r,"open",function(){i.onopen(),t&&t()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Vr(r,"error",a);if(this._timeout!==!1){const l=this._timeout,d=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(s),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Vr(t,"ping",this.onping.bind(this)),Vr(t,"data",this.ondata.bind(this)),Vr(t,"error",this.onerror.bind(this)),Vr(t,"close",this.onclose.bind(this)),Vr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){yo(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new s0(this,t,r),this.nsps[t]=i),i}_destroy(t){const r=Object.keys(this.nsps);for(const i of r)if(this.nsps[i].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let i=0;i<r.length;i++)this.engine.write(r[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Xi={};function Aa(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=Gm(e,t.path||"/socket.io"),i=r.source,s=r.id,a=r.path,o=Xi[s]&&a in Xi[s].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let d;return l?d=new sc(i,t):(Xi[s]||(Xi[s]=new sc(i,t)),d=Xi[s]),r.query&&!t.query&&(t.query=r.queryKey),d.socket(r.path,t)}Object.assign(Aa,{Manager:sc,Socket:s0,io:Aa,connect:Aa});const ag=window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1",nn=ag?"https://aakardata.in/api":"http://localhost:5000/api",QA="ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5";class og{constructor(){this.socket=null,this.subscribedToNotifications=!1,this.reconnectTimer=null,this.listeners={},this.unreadCount=0,this.isExhibitor=!1,this.lastToken="",this.handleConnect=()=>{setTimeout(()=>{this.subscribedToNotifications&&this.socket&&this.socket.emit("subscribe_notifications"),this.fetchUnreadCount(),this.triggerEvent("connected",!0)},500)},this.handleDisconnect=t=>{this.triggerEvent("disconnected",t),t!=="io client disconnect"&&t!=="transport close"&&this.scheduleReconnect()},this.handleConnectError=t=>{console.error("Notification socket connection error:",t),this.scheduleReconnect()},this.handleError=t=>{console.error("Notification socket error:",t),this.scheduleReconnect()},this.scheduleReconnect=()=>{this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.refreshAndReconnect(),this.reconnectTimer=null},5e3))},this.refreshAndReconnect=async()=>{try{const t=this.isExhibitor?"exhibitor_token":"token",r=localStorage.getItem(t);r?this.init(r,this.isExhibitor):console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token found for reconnection`)}catch(t){console.error("Error refreshing token for socket reconnection:",t)}},this.handleNewNotification=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("notification",t.notification),this.triggerEvent("unreadCount",this.unreadCount)},this.handleNotificationUpdate=t=>{this.unreadCount=t.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),t.newNotifications&&t.newNotifications.length>0&&t.newNotifications.forEach(r=>{this.triggerEvent("notification",r)})}}init(t,r=!1){var i;if(!((i=this.socket)!=null&&i.connected&&this.lastToken===t&&this.isExhibitor===r)){this.isExhibitor=r,this.lastToken=t,this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null);try{if(!t||typeof t!="string")throw new Error("Invalid token provided for socket connection");const s=nn.replace("/api",""),a=t.startsWith("Bearer ")?t.substring(7):t;this.socket=Aa(s,{auth:{token:a,type:r?"exhibitor":"admin"},forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:3e3,timeout:2e4,autoConnect:!0,transports:["polling","websocket"]}),this.socket.on("connect",this.handleConnect),this.socket.on("disconnect",this.handleDisconnect),this.socket.on("connect_error",this.handleConnectError),this.socket.on("error",this.handleError),this.socket.on("new_notification",this.handleNewNotification),this.socket.on("notification_update",this.handleNotificationUpdate)}catch(s){console.error("Error initializing notification socket:",s),this.scheduleReconnect()}}}subscribeToNotifications(){this.subscribedToNotifications=!0,this.socket&&this.socket.connected&&this.socket.emit("subscribe_notifications")}unsubscribeFromNotifications(){this.subscribedToNotifications=!1,this.socket&&this.socket.connected&&this.socket.emit("unsubscribe_notifications")}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.unreadCount=0,this.subscribedToNotifications=!1}addEventListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r)}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(i=>i!==r))}triggerEvent(t,r){this.listeners[t]&&this.listeners[t].forEach(i=>{try{i(r)}catch(s){console.error(`Error in notification ${t} listener:`,s)}})}getUnreadCount(){return this.unreadCount}async fetchUnreadCount(){try{const t=this.isExhibitor?"notifications/exhibitor":"notifications/admin",r={limit:1,page:1,unreadOnly:!0},i=this.isExhibitor?"exhibitor_token":"token",s=localStorage.getItem(i);if(!s)return console.error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`),0;const a=await bn.get(t,{baseURL:nn,params:r,headers:{Authorization:`Bearer ${s}`}});return a.data&&a.data.success?(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount),this.unreadCount):0}catch(t){return console.error("Error fetching unread count:",t),0}}async getNotifications(t=1,r=10,i=!1){try{const s=this.isExhibitor?"notifications/exhibitor":"notifications/admin",a={page:t,limit:r,unreadOnly:i},o=this.isExhibitor?"exhibitor_token":"token",l=localStorage.getItem(o);if(!l)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);return(await bn.get(s,{baseURL:nn,params:a,headers:{Authorization:`Bearer ${l}`}})).data}catch(s){return console.error("Error fetching notifications:",s),{success:!1,data:{notifications:[],pagination:{total:0,page:1,limit:10,pages:0},unreadCount:0}}}}async markAsRead(t){try{const r=this.isExhibitor?`notifications/exhibitor/mark-read/${t}`:`notifications/admin/mark-read/${t}`,i=this.isExhibitor?"exhibitor_token":"token",s=localStorage.getItem(i);if(!s)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const a=await bn.put(r,{},{baseURL:nn,headers:{Authorization:`Bearer ${s}`}});return a.data&&a.data.success&&(this.unreadCount=a.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),a.data}catch(r){throw console.error("Error marking notification as read:",r),r}}async markAllAsRead(){try{const t=this.isExhibitor?"notifications/exhibitor/mark-all-read":"notifications/admin/mark-all-read",r=this.isExhibitor?"exhibitor_token":"token",i=localStorage.getItem(r);if(!i)throw new Error(`No ${this.isExhibitor?"exhibitor":"admin"} token available for notification requests`);const s=await bn.put(t,{},{baseURL:nn,headers:{Authorization:`Bearer ${i}`}});return s.data&&s.data.success&&(this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount)),s.data}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async deleteNotification(t){try{const r=this.isExhibitor?`notifications/exhibitor/${t}`:`notifications/admin/${t}`,i=await bn.delete(r,{baseURL:nn,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(i.data.success)return i.data.data.unreadCount!==void 0&&(this.unreadCount=i.data.data.unreadCount,this.triggerEvent("unreadCount",this.unreadCount)),i.data;throw new Error("Failed to delete notification")}catch(r){throw console.error("Error deleting notification:",r),r}}async deleteAllNotifications(){try{const t=this.isExhibitor?"notifications/exhibitor/delete-all":"notifications/admin/delete-all",r=await bn.delete(t,{baseURL:nn,headers:{Authorization:`Bearer ${localStorage.getItem(this.isExhibitor?"exhibitor_token":"token")}`}});if(r.data.success)return this.unreadCount=0,this.triggerEvent("unreadCount",this.unreadCount),r.data;throw new Error("Failed to delete all notifications")}catch(t){throw console.error("Error deleting all notifications:",t),t}}}const ir=new og;var on=(e=>(e.NEW_LEAD="New Lead",e.FOLLOWUP_DUE="Follow-up Due",e.STATUS_CHANGE="Status Changed",e.ASSIGNMENT="Lead Assigned",e.NEW_BOOKING="NEW_BOOKING",e.BOOKING_CONFIRMED="BOOKING_CONFIRMED",e.BOOKING_CANCELLED="BOOKING_CANCELLED",e.PAYMENT_RECEIVED="PAYMENT_RECEIVED",e.INVOICE_GENERATED="INVOICE_GENERATED",e.EXHIBITION_UPDATE="EXHIBITION_UPDATE",e.SYSTEM_MESSAGE="SYSTEM_MESSAGE",e.EXHIBITOR_MESSAGE="EXHIBITOR_MESSAGE",e.EXHIBITOR_REGISTERED="EXHIBITOR_REGISTERED",e))(on||{}),Rn=(e=>(e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW",e))(Rn||{}),ac=(e=>(e.READ="Read",e.UNREAD="Unread",e))(ac||{}),a0={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(wi,function(){return function(r,i,s){r=r||{};var a=i.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(c,u,f,h){return a.fromToBase(c,u,f,h)}s.en.relativeTime=o,a.fromToBase=function(c,u,f,h,p){for(var y,x,g,v=f.$locale().relativeTime||o,k=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],T=k.length,m=0;m<T;m+=1){var w=k[m];w.d&&(y=h?s(c).diff(f,w.d,!0):f.diff(c,w.d,!0));var E=(r.rounding||Math.round)(Math.abs(y));if(g=y>0,E<=w.r||!w.r){E<=1&&m>0&&(w=k[m-1]);var b=v[w.l];p&&(E=p(""+E)),x=typeof b=="string"?b.replace("%d",E):b(E,u,w.l,g);break}}if(u)return x;var _=g?v.future:v.past;return typeof _=="function"?_(x):_.replace("%s",x)},a.to=function(c,u){return l(c,u,this,!0)},a.from=function(c,u){return l(c,u,this)};var d=function(c){return c.$u?s.utc():s()};a.toNow=function(c){return this.to(d(this),c)},a.fromNow=function(c){return this.from(d(this),c)}}})})(a0);var lg=a0.exports;const cg=Qp(lg);St.extend(cg);const $d=e=>{switch(e){case Rn.HIGH:return"#f5222d";case Rn.MEDIUM:return"#faad14";case Rn.LOW:return"#52c41a";default:return"#1677ff"}},dg=e=>St(e).fromNow(),ug=e=>St(e).format("YYYY-MM-DD HH:mm"),JA=e=>e.filter(t=>t.isRead===!1).length,ZA=e=>{if(!e.entityId||!e.entityType)return"/notifications";switch(e.entityType){case"lead":return`/leads/${e.entityId}`;case"followup":return`/followups/${e.entityId}`;case"Booking":return"/bookings";case"Invoice":return`/invoice/${e.entityId}`;case"Exhibition":return`/exhibition/${e.entityId}`;case"Exhibitor":return`/exhibitors?id=${e.entityId}`;default:return"/notifications"}},{Text:Ud,Paragraph:hg}=Ue,fg=({notification:e,onView:t,onMarkAsRead:r,onDelete:i})=>{const s=()=>{switch(e.type){case on.NEW_LEAD:return n.jsx($a,{style:{color:"#1677ff"}});case on.FOLLOWUP_DUE:return n.jsx(br,{style:{color:"#faad14"}});case on.STATUS_CHANGE:return n.jsx(Jp,{style:{color:"#722ed1"}});case on.ASSIGNMENT:return n.jsx(jt,{style:{color:"#52c41a"}});default:return n.jsx(Sh,{style:{color:"#1677ff"}})}},a=()=>{e.isRead||r(e),t(e)},o=l=>{l.stopPropagation(),i(e)};return n.jsx(yn.Item,{onClick:a,className:e.isRead?"":"notification-unread",style:{cursor:"pointer",backgroundColor:e.isRead?"transparent":"#f0f5ff",padding:"16px",borderRadius:"4px",transition:"background-color 0.3s"},actions:[n.jsx(ht,{title:"Delete notification",children:n.jsx(fe,{type:"text",danger:!0,icon:n.jsx(En,{}),onClick:o,"aria-label":"Delete notification"})})],children:n.jsx(yn.Item.Meta,{avatar:n.jsx(Br,{dot:!e.isRead,color:$d(e.priority),children:n.jsx(Kn,{icon:s(),size:"large",style:{backgroundColor:"white",border:`1px solid ${$d(e.priority)}`}})}),title:n.jsxs(ke,{children:[n.jsx(Ud,{strong:!0,children:e.title}),!e.isRead&&n.jsx(Ne,{color:"blue",children:"New"})]}),description:n.jsxs("div",{children:[n.jsx(hg,{ellipsis:{rows:2},style:{marginBottom:4},children:e.message}),n.jsx(ht,{title:ug(e.createdAt),children:n.jsx(Ud,{type:"secondary",style:{fontSize:12},children:dg(e.createdAt)})})]})})})},{Title:pg,Text:ek}=Ue,xg=e=>{switch(e){case"NEW_BOOKING":return on.NEW_LEAD;case"BOOKING_CONFIRMED":case"INVOICE_GENERATED":case"PAYMENT_RECEIVED":return on.STATUS_CHANGE;case"EXHIBITOR_MESSAGE":return on.FOLLOWUP_DUE;case"EXHIBITOR_REGISTERED":return on.NEW_LEAD;default:return on.STATUS_CHANGE}},mg=e=>{switch(e){case"HIGH":return Rn.HIGH;case"MEDIUM":return Rn.MEDIUM;case"LOW":return Rn.LOW;default:return Rn.MEDIUM}},gg=({isExhibitor:e=!1})=>{const t=tr(),[r,i]=N.useState([]),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[d,c]=N.useState(0),[u,f]=N.useState(!1),[h,p]=N.useState("all"),y=N.useRef(null),{isAuthenticated:x,user:g}=ut(q=>q.auth),{isAuthenticated:v}=ut(q=>q.exhibitorAuth||{isAuthenticated:!1}),k=e?v:x,[T,m]=N.useState(!1);N.useEffect(()=>{if(k){const q=e?"exhibitor_token":"token",K=localStorage.getItem(q);if(K){ir.init(K,e),ir.subscribeToNotifications();const Q=U=>{c(U),U>0&&!o&&(f(!0),setTimeout(()=>{f(!1)},2e3))},ie=U=>{i(O=>[U,...O])},Z=()=>{m(!0),w()},R=()=>{m(!1)};return ir.addEventListener("unreadCount",Q),ir.addEventListener("notification",ie),ir.addEventListener("connected",Z),ir.addEventListener("disconnected",R),w(),()=>{ir.removeEventListener("unreadCount",Q),ir.removeEventListener("notification",ie),ir.removeEventListener("connected",Z),ir.removeEventListener("disconnected",R),ir.unsubscribeFromNotifications()}}else console.error(`No ${e?"exhibitor":"admin"} token found in localStorage`)}},[k,e]);const w=async()=>{if(k){a(!0);try{const q=await ir.getNotifications(1,10);q.success&&(i(q.data.notifications),c(q.data.unreadCount))}catch(q){console.error("Error fetching notifications:",q)}finally{a(!1)}}},E=q=>{l(q),q&&(y.current&&y.current.classList.remove("bell-animate"),w())},b=async q=>{if(q.isRead||await _(q),l(!1),q.entityId&&q.entityType){let K="";switch(q.entityType){case"Booking":K=e?`/exhibitor/bookings/${q.entityId}`:"/bookings";break;case"Invoice":K=e?`/exhibitor/invoice/${q.entityId}`:`/invoice/${q.entityId}`;break;case"Exhibition":K=`/exhibition/${q.entityId}`;break;case"Exhibitor":K=`/exhibitors?id=${q.entityId}`;break;default:K=""}t(K||"/notifications")}else t("/notifications")},_=async q=>{try{await ir.markAsRead(q._id),i(r.map(K=>K._id===q._id?{...K,isRead:!0}:K))}catch(K){console.error("Error marking notification as read:",K)}},A=async q=>{try{await ir.deleteNotification(q._id),i(r.filter(K=>K._id!==q._id)),q.isRead||c(K=>Math.max(0,K-1))}catch(K){console.error("Error deleting notification:",K)}},S=()=>{l(!1),t("/notifications")},j=async()=>{try{await ir.markAllAsRead(),i(r.map(q=>({...q,isRead:!0}))),c(0)}catch(q){console.error("Error marking all notifications as read:",q)}},C=async()=>{try{await ir.deleteAllNotifications(),i([]),c(0)}catch(q){console.error("Error deleting all notifications:",q)}},P=()=>h==="unread"?r.filter(q=>!q.isRead):r.slice(0,10),M=q=>{p(q)},X=q=>{var K;return{_id:q._id,recipient:q.recipient,recipientType:q.recipientType||"admin",title:q.title,message:q.message,type:xg(q.type),priority:mg(q.priority),isRead:q.isRead,readAt:q.readAt,entityId:q.entityId,entityType:q.entityType,data:q.data,createdAt:q.createdAt,updatedAt:q.updatedAt||q.createdAt,id:q._id,userId:q.recipient,source:(K=q.data)==null?void 0:K.source,status:q.isRead?ac.READ:ac.UNREAD}},ee=n.jsxs("div",{className:"notification-dropdown",children:[n.jsxs("div",{className:"notification-header",children:[n.jsx(pg,{level:5,style:{margin:0},children:"Notifications"}),n.jsxs(ke,{children:[n.jsx(fe,{type:"text",size:"small",icon:n.jsx(Is,{}),onClick:w,loading:s,className:"header-btn",title:"Refresh notifications"}),n.jsx(fe,{type:"text",size:"small",icon:n.jsx(jh,{}),onClick:j,disabled:d===0,className:"header-btn",title:"Mark all as read"}),n.jsx(fe,{type:"text",size:"small",danger:!0,icon:n.jsx(En,{}),onClick:C,disabled:r.length===0,className:"header-btn",title:"Clear all notifications"}),n.jsx(fe,{type:"text",size:"small",icon:n.jsx(Ua,{}),onClick:()=>t("/notifications"),className:"header-btn",title:"Notification Settings"}),n.jsx(fe,{type:"text",size:"small",icon:n.jsx(Kr,{}),onClick:()=>l(!1),className:"header-btn",title:"Close"})]})]}),n.jsx(An,{activeKey:h,onChange:M,size:"small",className:"notification-tabs",items:[{key:"all",label:n.jsx("span",{children:"All"})},{key:"unread",label:n.jsxs("span",{className:"tab-label",children:["Unread",n.jsx(Br,{count:d,size:"small",offset:[5,-3],style:{backgroundColor:"#1677ff"}})]})}]}),n.jsx("div",{className:"notification-list",children:n.jsx(Rt,{spinning:s,children:P().length===0?n.jsx(xt,{image:xt.PRESENTED_IMAGE_SIMPLE,description:h==="unread"?"No unread notifications":"No notifications",style:{padding:"20px 0"}}):n.jsx(yn,{dataSource:P(),renderItem:q=>n.jsx(fg,{notification:X(q),onView:()=>b(q),onMarkAsRead:()=>_(q),onDelete:A})})})}),n.jsx(Tt,{style:{margin:"0"}}),n.jsx("div",{className:"notification-footer",children:n.jsx(fe,{type:"link",onClick:S,children:"View All Notifications"})})]});return n.jsx("div",{ref:y,className:`bell-container ${u?"bell-animate":""}`,children:n.jsx(ni,{overlay:ee,trigger:["click"],open:o,onOpenChange:E,placement:"bottomRight",getPopupContainer:q=>q.parentNode,overlayClassName:"notification-dropdown-overlay",children:n.jsx("div",{className:"bell-trigger",children:n.jsx(Br,{count:d,className:"notification-badge",size:"default",overflowCount:99,children:n.jsx(Sh,{className:"notification-bell-icon"})})})})})};class yg{async getSettings(){return(await Pe.get("/settings")).data}async updateSettings(t){return(await Pe.put("/settings",t)).data}async uploadLogo(t){const r=new FormData;return r.append("file",t),(await Pe.post("/settings/upload/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}}const Dc=new yg,vg={settings:null,loading:!1,error:null},ka=Ye("settings/fetchSettings",async(e,{rejectWithValue:t})=>{var r,i;try{return await Dc.getSettings()}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch settings")}}),Ca=Ye("settings/updateSettings",async(e,{rejectWithValue:t})=>{var r,i;try{return await Dc.updateSettings(e)}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to update settings")}}),el=Ye("settings/uploadLogo",async(e,{dispatch:t,rejectWithValue:r})=>{var i,s;try{const a=await Dc.uploadLogo(e);return a.path&&await t(Ca({logo:a.path})),a}catch(a){return r(((s=(i=a.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to upload logo")}}),bg=gr({name:"settings",initialState:vg,reducers:{},extraReducers:e=>{e.addCase(ka.pending,t=>{t.loading=!0,t.error=null}).addCase(ka.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(ka.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Ca.pending,t=>{t.loading=!0,t.error=null}).addCase(Ca.fulfilled,(t,r)=>{t.settings=r.payload,t.loading=!1}).addCase(Ca.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(el.pending,t=>{t.loading=!0,t.error=null}).addCase(el.fulfilled,t=>{t.loading=!1}).addCase(el.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),wg=bg.reducer;function Sg(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function jg(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Eg=function(){function e(r){var i=this;this._insertTag=function(s){var a;i.tags.length===0?i.insertionPoint?a=i.insertionPoint.nextSibling:i.prepend?a=i.container.firstChild:a=i.before:a=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(s,a),i.tags.push(s)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(i){i.forEach(this._insertTag)},t.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(jg(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var a=Sg(s);try{a.insertRule(i,a.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(i));this.ctr++},t.flush=function(){this.tags.forEach(function(i){var s;return(s=i.parentNode)==null?void 0:s.removeChild(i)}),this.tags=[],this.ctr=0},e}(),sr="-ms-",Ya="-moz-",Ze="-webkit-",o0="comm",Oc="rule",Lc="decl",_g="@import",l0="@keyframes",Tg="@layer",Ag=Math.abs,bo=String.fromCharCode,kg=Object.assign;function Cg(e,t){return Kt(e,0)^45?(((t<<2^Kt(e,0))<<2^Kt(e,1))<<2^Kt(e,2))<<2^Kt(e,3):0}function c0(e){return e.trim()}function Ig(e,t){return(e=t.exec(e))?e[0]:e}function et(e,t,r){return e.replace(t,r)}function oc(e,t){return e.indexOf(t)}function Kt(e,t){return e.charCodeAt(t)|0}function ys(e,t,r){return e.slice(t,r)}function sn(e){return e.length}function Mc(e){return e.length}function Qs(e,t){return t.push(e),e}function Ng(e,t){return e.map(t).join("")}var wo=1,Di=1,d0=0,wr=0,Dt=0,Bi="";function So(e,t,r,i,s,a,o){return{value:e,root:t,parent:r,type:i,props:s,children:a,line:wo,column:Di,length:o,return:""}}function Ki(e,t){return kg(So("",null,null,"",null,null,0),e,{length:-e.length},t)}function Fg(){return Dt}function Rg(){return Dt=wr>0?Kt(Bi,--wr):0,Di--,Dt===10&&(Di=1,wo--),Dt}function Nr(){return Dt=wr<d0?Kt(Bi,wr++):0,Di++,Dt===10&&(Di=1,wo++),Dt}function dn(){return Kt(Bi,wr)}function Ia(){return wr}function Ls(e,t){return ys(Bi,e,t)}function vs(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function u0(e){return wo=Di=1,d0=sn(Bi=e),wr=0,[]}function h0(e){return Bi="",e}function Na(e){return c0(Ls(wr-1,lc(e===91?e+2:e===40?e+1:e)))}function Pg(e){for(;(Dt=dn())&&Dt<33;)Nr();return vs(e)>2||vs(Dt)>3?"":" "}function Dg(e,t){for(;--t&&Nr()&&!(Dt<48||Dt>102||Dt>57&&Dt<65||Dt>70&&Dt<97););return Ls(e,Ia()+(t<6&&dn()==32&&Nr()==32))}function lc(e){for(;Nr();)switch(Dt){case e:return wr;case 34:case 39:e!==34&&e!==39&&lc(Dt);break;case 40:e===41&&lc(e);break;case 92:Nr();break}return wr}function Og(e,t){for(;Nr()&&e+Dt!==57;)if(e+Dt===84&&dn()===47)break;return"/*"+Ls(t,wr-1)+"*"+bo(e===47?e:Nr())}function Lg(e){for(;!vs(dn());)Nr();return Ls(e,wr)}function Mg(e){return h0(Fa("",null,null,null,[""],e=u0(e),0,[0],e))}function Fa(e,t,r,i,s,a,o,l,d){for(var c=0,u=0,f=o,h=0,p=0,y=0,x=1,g=1,v=1,k=0,T="",m=s,w=a,E=i,b=T;g;)switch(y=k,k=Nr()){case 40:if(y!=108&&Kt(b,f-1)==58){oc(b+=et(Na(k),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:b+=Na(k);break;case 9:case 10:case 13:case 32:b+=Pg(y);break;case 92:b+=Dg(Ia()-1,7);continue;case 47:switch(dn()){case 42:case 47:Qs(Bg(Og(Nr(),Ia()),t,r),d);break;default:b+="/"}break;case 123*x:l[c++]=sn(b)*v;case 125*x:case 59:case 0:switch(k){case 0:case 125:g=0;case 59+u:v==-1&&(b=et(b,/\f/g,"")),p>0&&sn(b)-f&&Qs(p>32?Wd(b+";",i,r,f-1):Wd(et(b," ","")+";",i,r,f-2),d);break;case 59:b+=";";default:if(Qs(E=zd(b,t,r,c,u,s,l,T,m=[],w=[],f),a),k===123)if(u===0)Fa(b,t,E,E,m,a,f,l,w);else switch(h===99&&Kt(b,3)===110?100:h){case 100:case 108:case 109:case 115:Fa(e,E,E,i&&Qs(zd(e,E,E,0,0,s,l,T,s,m=[],f),w),s,w,f,l,i?m:w);break;default:Fa(b,E,E,E,[""],w,0,l,w)}}c=u=p=0,x=v=1,T=b="",f=o;break;case 58:f=1+sn(b),p=y;default:if(x<1){if(k==123)--x;else if(k==125&&x++==0&&Rg()==125)continue}switch(b+=bo(k),k*x){case 38:v=u>0?1:(b+="\f",-1);break;case 44:l[c++]=(sn(b)-1)*v,v=1;break;case 64:dn()===45&&(b+=Na(Nr())),h=dn(),u=f=sn(T=b+=Lg(Ia())),k++;break;case 45:y===45&&sn(b)==2&&(x=0)}}return a}function zd(e,t,r,i,s,a,o,l,d,c,u){for(var f=s-1,h=s===0?a:[""],p=Mc(h),y=0,x=0,g=0;y<i;++y)for(var v=0,k=ys(e,f+1,f=Ag(x=o[y])),T=e;v<p;++v)(T=c0(x>0?h[v]+" "+k:et(k,/&\f/g,h[v])))&&(d[g++]=T);return So(e,t,r,s===0?Oc:l,d,c,u)}function Bg(e,t,r){return So(e,t,r,o0,bo(Fg()),ys(e,2,-2),0)}function Wd(e,t,r,i){return So(e,t,r,Lc,ys(e,0,i),ys(e,i+1,-1),i)}function Ti(e,t){for(var r="",i=Mc(e),s=0;s<i;s++)r+=t(e[s],s,e,t)||"";return r}function $g(e,t,r,i){switch(e.type){case Tg:if(e.children.length)break;case _g:case Lc:return e.return=e.return||e.value;case o0:return"";case l0:return e.return=e.value+"{"+Ti(e.children,i)+"}";case Oc:e.value=e.props.join(",")}return sn(r=Ti(e.children,i))?e.return=e.value+"{"+r+"}":""}function Ug(e){var t=Mc(e);return function(r,i,s,a){for(var o="",l=0;l<t;l++)o+=e[l](r,i,s,a)||"";return o}}function zg(e){return function(t){t.root||(t=t.return)&&e(t)}}function f0(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var Wg=function(t,r,i){for(var s=0,a=0;s=a,a=dn(),s===38&&a===12&&(r[i]=1),!vs(a);)Nr();return Ls(t,wr)},qg=function(t,r){var i=-1,s=44;do switch(vs(s)){case 0:s===38&&dn()===12&&(r[i]=1),t[i]+=Wg(wr-1,r,i);break;case 2:t[i]+=Na(s);break;case 4:if(s===44){t[++i]=dn()===58?"&\f":"",r[i]=t[i].length;break}default:t[i]+=bo(s)}while(s=Nr());return t},Vg=function(t,r){return h0(qg(u0(t),r))},qd=new WeakMap,Hg=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,i=t.parent,s=t.column===i.column&&t.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!qd.get(i))&&!s){qd.set(t,!0);for(var a=[],o=Vg(r,a),l=i.props,d=0,c=0;d<o.length;d++)for(var u=0;u<l.length;u++,c++)t.props[c]=a[d]?o[d].replace(/&\f/g,l[u]):l[u]+" "+o[d]}}},Gg=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function p0(e,t){switch(Cg(e,t)){case 5103:return Ze+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ze+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Ze+e+Ya+e+sr+e+e;case 6828:case 4268:return Ze+e+sr+e+e;case 6165:return Ze+e+sr+"flex-"+e+e;case 5187:return Ze+e+et(e,/(\w+).+(:[^]+)/,Ze+"box-$1$2"+sr+"flex-$1$2")+e;case 5443:return Ze+e+sr+"flex-item-"+et(e,/flex-|-self/,"")+e;case 4675:return Ze+e+sr+"flex-line-pack"+et(e,/align-content|flex-|-self/,"")+e;case 5548:return Ze+e+sr+et(e,"shrink","negative")+e;case 5292:return Ze+e+sr+et(e,"basis","preferred-size")+e;case 6060:return Ze+"box-"+et(e,"-grow","")+Ze+e+sr+et(e,"grow","positive")+e;case 4554:return Ze+et(e,/([^-])(transform)/g,"$1"+Ze+"$2")+e;case 6187:return et(et(et(e,/(zoom-|grab)/,Ze+"$1"),/(image-set)/,Ze+"$1"),e,"")+e;case 5495:case 3959:return et(e,/(image-set\([^]*)/,Ze+"$1$`$1");case 4968:return et(et(e,/(.+:)(flex-)?(.*)/,Ze+"box-pack:$3"+sr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ze+e+e;case 4095:case 3583:case 4068:case 2532:return et(e,/(.+)-inline(.+)/,Ze+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(sn(e)-1-t>6)switch(Kt(e,t+1)){case 109:if(Kt(e,t+4)!==45)break;case 102:return et(e,/(.+:)(.+)-([^]+)/,"$1"+Ze+"$2-$3$1"+Ya+(Kt(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~oc(e,"stretch")?p0(et(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Kt(e,t+1)!==115)break;case 6444:switch(Kt(e,sn(e)-3-(~oc(e,"!important")&&10))){case 107:return et(e,":",":"+Ze)+e;case 101:return et(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ze+(Kt(e,14)===45?"inline-":"")+"box$3$1"+Ze+"$2$3$1"+sr+"$2box$3")+e}break;case 5936:switch(Kt(e,t+11)){case 114:return Ze+e+sr+et(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Ze+e+sr+et(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Ze+e+sr+et(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Ze+e+sr+e+e}return e}var Yg=function(t,r,i,s){if(t.length>-1&&!t.return)switch(t.type){case Lc:t.return=p0(t.value,t.length);break;case l0:return Ti([Ki(t,{value:et(t.value,"@","@"+Ze)})],s);case Oc:if(t.length)return Ng(t.props,function(a){switch(Ig(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ti([Ki(t,{props:[et(a,/:(read-\w+)/,":"+Ya+"$1")]})],s);case"::placeholder":return Ti([Ki(t,{props:[et(a,/:(plac\w+)/,":"+Ze+"input-$1")]}),Ki(t,{props:[et(a,/:(plac\w+)/,":"+Ya+"$1")]}),Ki(t,{props:[et(a,/:(plac\w+)/,sr+"input-$1")]})],s)}return""})}},Xg=[Yg],Kg=function(t){var r=t.key;if(r==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(x){var g=x.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(x),x.setAttribute("data-s",""))})}var s=t.stylisPlugins||Xg,a={},o,l=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(x){for(var g=x.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)a[g[v]]=!0;l.push(x)});var d,c=[Hg,Gg];{var u,f=[$g,zg(function(x){u.insert(x)})],h=Ug(c.concat(s,f)),p=function(g){return Ti(Mg(g),h)};d=function(g,v,k,T){u=k,p(g?g+"{"+v.styles+"}":v.styles),T&&(y.inserted[v.name]=!0)}}var y={key:r,sheet:new Eg({key:r,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:d};return y.sheet.hydrate(l),y},x0={exports:{}},lt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gt=typeof Symbol=="function"&&Symbol.for,Bc=Gt?Symbol.for("react.element"):60103,$c=Gt?Symbol.for("react.portal"):60106,jo=Gt?Symbol.for("react.fragment"):60107,Eo=Gt?Symbol.for("react.strict_mode"):60108,_o=Gt?Symbol.for("react.profiler"):60114,To=Gt?Symbol.for("react.provider"):60109,Ao=Gt?Symbol.for("react.context"):60110,Uc=Gt?Symbol.for("react.async_mode"):60111,ko=Gt?Symbol.for("react.concurrent_mode"):60111,Co=Gt?Symbol.for("react.forward_ref"):60112,Io=Gt?Symbol.for("react.suspense"):60113,Qg=Gt?Symbol.for("react.suspense_list"):60120,No=Gt?Symbol.for("react.memo"):60115,Fo=Gt?Symbol.for("react.lazy"):60116,Jg=Gt?Symbol.for("react.block"):60121,Zg=Gt?Symbol.for("react.fundamental"):60117,e1=Gt?Symbol.for("react.responder"):60118,t1=Gt?Symbol.for("react.scope"):60119;function Pr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Bc:switch(e=e.type,e){case Uc:case ko:case jo:case _o:case Eo:case Io:return e;default:switch(e=e&&e.$$typeof,e){case Ao:case Co:case Fo:case No:case To:return e;default:return t}}case $c:return t}}}function m0(e){return Pr(e)===ko}lt.AsyncMode=Uc;lt.ConcurrentMode=ko;lt.ContextConsumer=Ao;lt.ContextProvider=To;lt.Element=Bc;lt.ForwardRef=Co;lt.Fragment=jo;lt.Lazy=Fo;lt.Memo=No;lt.Portal=$c;lt.Profiler=_o;lt.StrictMode=Eo;lt.Suspense=Io;lt.isAsyncMode=function(e){return m0(e)||Pr(e)===Uc};lt.isConcurrentMode=m0;lt.isContextConsumer=function(e){return Pr(e)===Ao};lt.isContextProvider=function(e){return Pr(e)===To};lt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bc};lt.isForwardRef=function(e){return Pr(e)===Co};lt.isFragment=function(e){return Pr(e)===jo};lt.isLazy=function(e){return Pr(e)===Fo};lt.isMemo=function(e){return Pr(e)===No};lt.isPortal=function(e){return Pr(e)===$c};lt.isProfiler=function(e){return Pr(e)===_o};lt.isStrictMode=function(e){return Pr(e)===Eo};lt.isSuspense=function(e){return Pr(e)===Io};lt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===jo||e===ko||e===_o||e===Eo||e===Io||e===Qg||typeof e=="object"&&e!==null&&(e.$$typeof===Fo||e.$$typeof===No||e.$$typeof===To||e.$$typeof===Ao||e.$$typeof===Co||e.$$typeof===Zg||e.$$typeof===e1||e.$$typeof===t1||e.$$typeof===Jg)};lt.typeOf=Pr;x0.exports=lt;var r1=x0.exports,g0=r1,n1={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i1={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y0={};y0[g0.ForwardRef]=n1;y0[g0.Memo]=i1;var s1=!0;function v0(e,t,r){var i="";return r.split(" ").forEach(function(s){e[s]!==void 0?t.push(e[s]+";"):s&&(i+=s+" ")}),i}var zc=function(t,r,i){var s=t.key+"-"+r.name;(i===!1||s1===!1)&&t.registered[s]===void 0&&(t.registered[s]=r.styles)},b0=function(t,r,i){zc(t,r,i);var s=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var a=r;do t.insert(r===a?"."+s:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function a1(e){for(var t=0,r,i=0,s=e.length;s>=4;++i,s-=4)r=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(s){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var o1={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},l1=/[A-Z]|^ms/g,c1=/_EMO_([^_]+?)_([^]*?)_EMO_/g,w0=function(t){return t.charCodeAt(1)===45},Vd=function(t){return t!=null&&typeof t!="boolean"},tl=f0(function(e){return w0(e)?e:e.replace(l1,"-$&").toLowerCase()}),Hd=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(c1,function(i,s,a){return an={name:s,styles:a,next:an},s})}return o1[t]!==1&&!w0(t)&&typeof r=="number"&&r!==0?r+"px":r};function bs(e,t,r){if(r==null)return"";var i=r;if(i.__emotion_styles!==void 0)return i;switch(typeof r){case"boolean":return"";case"object":{var s=r;if(s.anim===1)return an={name:s.name,styles:s.styles,next:an},s.name;var a=r;if(a.styles!==void 0){var o=a.next;if(o!==void 0)for(;o!==void 0;)an={name:o.name,styles:o.styles,next:an},o=o.next;var l=a.styles+";";return l}return d1(e,t,r)}case"function":{if(e!==void 0){var d=an,c=r(e);return an=d,bs(e,t,c)}break}}var u=r;if(t==null)return u;var f=t[u];return f!==void 0?f:u}function d1(e,t,r){var i="";if(Array.isArray(r))for(var s=0;s<r.length;s++)i+=bs(e,t,r[s])+";";else for(var a in r){var o=r[a];if(typeof o!="object"){var l=o;t!=null&&t[l]!==void 0?i+=a+"{"+t[l]+"}":Vd(l)&&(i+=tl(a)+":"+Hd(a,l)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var d=0;d<o.length;d++)Vd(o[d])&&(i+=tl(a)+":"+Hd(a,o[d])+";");else{var c=bs(e,t,o);switch(a){case"animation":case"animationName":{i+=tl(a)+":"+c+";";break}default:i+=a+"{"+c+"}"}}}return i}var Gd=/label:\s*([^\s;{]+)\s*(;|$)/g,an;function Wc(e,t,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,s="";an=void 0;var a=e[0];if(a==null||a.raw===void 0)i=!1,s+=bs(r,t,a);else{var o=a;s+=o[0]}for(var l=1;l<e.length;l++)if(s+=bs(r,t,e[l]),i){var d=a;s+=d[l]}Gd.lastIndex=0;for(var c="",u;(u=Gd.exec(s))!==null;)c+="-"+u[1];var f=a1(s)+c;return{name:f,styles:s,next:an}}var u1=function(t){return t()},h1=jd.useInsertionEffect?jd.useInsertionEffect:!1,S0=h1||u1,j0=N.createContext(typeof HTMLElement<"u"?Kg({key:"css"}):null);j0.Provider;var E0=function(t){return N.forwardRef(function(r,i){var s=N.useContext(j0);return t(r,s,i)})},_0=N.createContext({}),qc={}.hasOwnProperty,cc="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f1=function(t,r){var i={};for(var s in r)qc.call(r,s)&&(i[s]=r[s]);return i[cc]=t,i},p1=function(t){var r=t.cache,i=t.serialized,s=t.isStringTag;return zc(r,i,s),S0(function(){return b0(r,i,s)}),null},x1=E0(function(e,t,r){var i=e.css;typeof i=="string"&&t.registered[i]!==void 0&&(i=t.registered[i]);var s=e[cc],a=[i],o="";typeof e.className=="string"?o=v0(t.registered,a,e.className):e.className!=null&&(o=e.className+" ");var l=Wc(a,void 0,N.useContext(_0));o+=t.key+"-"+l.name;var d={};for(var c in e)qc.call(e,c)&&c!=="css"&&c!==cc&&(d[c]=e[c]);return d.className=o,r&&(d.ref=r),N.createElement(N.Fragment,null,N.createElement(p1,{cache:t,serialized:l,isStringTag:typeof s=="string"}),N.createElement(s,d))}),m1=x1,Yd=function(t,r){var i=arguments;if(r==null||!qc.call(r,"css"))return N.createElement.apply(void 0,i);var s=i.length,a=new Array(s);a[0]=m1,a[1]=f1(t,r);for(var o=2;o<s;o++)a[o]=i[o];return N.createElement.apply(null,a)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(Yd||(Yd={}));function g1(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Wc(t)}function Un(){var e=g1.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var y1=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,v1=f0(function(e){return y1.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),b1=v1,w1=function(t){return t!=="theme"},Xd=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?b1:w1},Kd=function(t,r,i){var s;if(r){var a=r.shouldForwardProp;s=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof s!="function"&&i&&(s=t.__emotion_forwardProp),s},S1=function(t){var r=t.cache,i=t.serialized,s=t.isStringTag;return zc(r,i,s),S0(function(){return b0(r,i,s)}),null},j1=function e(t,r){var i=t.__emotion_real===t,s=i&&t.__emotion_base||t,a,o;r!==void 0&&(a=r.label,o=r.target);var l=Kd(t,r,i),d=l||Xd(s),c=!d("as");return function(){var u=arguments,f=i&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),u[0]==null||u[0].raw===void 0)f.push.apply(f,u);else{var h=u[0];f.push(h[0]);for(var p=u.length,y=1;y<p;y++)f.push(u[y],h[y])}var x=E0(function(g,v,k){var T=c&&g.as||s,m="",w=[],E=g;if(g.theme==null){E={};for(var b in g)E[b]=g[b];E.theme=N.useContext(_0)}typeof g.className=="string"?m=v0(v.registered,w,g.className):g.className!=null&&(m=g.className+" ");var _=Wc(f.concat(w),v.registered,E);m+=v.key+"-"+_.name,o!==void 0&&(m+=" "+o);var A=c&&l===void 0?Xd(T):d,S={};for(var j in g)c&&j==="as"||A(j)&&(S[j]=g[j]);return S.className=m,k&&(S.ref=k),N.createElement(N.Fragment,null,N.createElement(S1,{cache:v,serialized:_,isStringTag:typeof T=="string"}),N.createElement(T,S))});return x.displayName=a!==void 0?a:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",x.defaultProps=t.defaultProps,x.__emotion_real=x,x.__emotion_base=s,x.__emotion_styles=f,x.__emotion_forwardProp=l,Object.defineProperty(x,"toString",{value:function(){return"."+o}}),x.withComponent=function(g,v){var k=e(g,Zp({},r,v,{shouldForwardProp:Kd(x,v,!0)}));return k.apply(void 0,f)},x}},E1=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],be=j1.bind(null);E1.forEach(function(e){be[e]=be(e)});const _1=()=>{const{user:e}=ut(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const i=e.role.permissions;if(i.includes(r)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access")||i.includes("manage_all"))return!0;const s=r.split("_");if(s.length===2){const a=s[0],o=s[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,`${a}`,`${o}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(i.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(i=>t(i)),hasAllPermissions:r=>r.every(i=>t(i))}},{Header:T1,Sider:A1,Content:k1}=Et,C1=be.div`
  height: 65px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #E5E7EB;
  transition: all 0.3s;
`,I1=be.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
`,N1=be.img`
  height: auto;
  width: 100%;
  max-width: 150px;
  max-height: auto;
  object-fit: contain;
`;be.span`
  margin-left: 12px;
  font-size: 18px;
  font-weight: 600;
  color: #111827;
  white-space: nowrap;
  transition: opacity 0.3s, margin-left 0.3s;
`;const bt=({children:e})=>{const[t,r]=N.useState(!1),i=tr(),s=hr(),a=vc(),o=ut(w=>w.auth.user),{settings:l}=ut(w=>w.settings),[d,c]=N.useState("/logo.png"),[u,f]=N.useState(!1),{hasPermission:h}=_1(),p=N.useCallback(async()=>{try{f(!0),await s(Sa()).unwrap()}catch{}finally{f(!1)}},[s]);N.useEffect(()=>{const w=setInterval(()=>{p()},3e5);return()=>clearInterval(w)},[p]),N.useEffect(()=>{p()},[a.pathname,p]),N.useEffect(()=>{},[o,h]),N.useEffect(()=>{s(ka())},[s]);const y=[{key:"dashboard",icon:n.jsx(Wa,{}),label:"Dashboard",requiredPermission:"dashboard_view",onClick:()=>i("/dashboard")},{key:"exhibition",icon:n.jsx(bc,{}),label:"Exhibitions",requiredPermission:"exhibitions_view",onClick:()=>i("/exhibition")},{key:"stalls",icon:n.jsx($r,{}),label:"Stalls",requiredPermission:"view_stalls",children:[{key:"stall/list",label:"Stall List",requiredPermission:"view_stalls",onClick:()=>i("/stall/list")},{key:"stall-types",label:"Stall Types",requiredPermission:"view_stall_types",onClick:()=>i("/stall-types")}]},{key:"bookings",icon:n.jsx(Nt,{}),label:"Stall Bookings",requiredPermission:"view_bookings",onClick:()=>i("/bookings")},{key:"amenities",icon:n.jsx(ex,{}),label:"Amenities",requiredPermission:"view_amenities",onClick:()=>i("/amenities")},{key:"invoices",icon:n.jsx(Qn,{}),label:"Invoices",requiredPermission:"view_invoices",onClick:()=>i("/invoices")},{key:"exhibitors",icon:n.jsx(wc,{}),label:"Exhibitors",requiredPermission:"view_exhibitors",onClick:()=>i("/exhibitors")},{key:"index",icon:n.jsx(jt,{}),label:"Users",requiredPermission:"users_view",onClick:()=>i("/index")},{key:"roles",icon:n.jsx(tx,{}),label:"Roles",requiredPermission:"roles_view",onClick:()=>i("/roles")},{key:"settings",icon:n.jsx(Ua,{}),label:"Settings",requiredPermission:"settings_view",onClick:()=>i("/settings")}],x=w=>w.filter(E=>{if(E.requiredPermission&&!h(E.requiredPermission))return!1;if(E.children){const b=x(E.children);if(b.length===0)return!1;E.children=b}return!0}),g=x(y),v=w=>w.map(E=>{const{requiredPermission:b,..._}=E;return _.children&&(_.children=v(_.children)),_}),k=v(g);N.useEffect(()=>{const w={dashboard:"dashboard_view",exhibition:"exhibitions_view","stall/list":"view_stalls","stall-types":"view_stall_types",bookings:"view_bookings",amenities:"view_amenities",invoices:"view_invoices",exhibitors:"view_exhibitors",index:"users_view",roles:"roles_view",settings:"settings_view"},E=a.pathname.substring(1)||"dashboard",b=w[E];if(b&&!h(b)){const _=g.length>0?g[0]:null;_?i(`/${_.key}`):(s(Pd()),i("/login"))}},[a.pathname,h,g,i,s]),N.useEffect(()=>{const w=localStorage.getItem("cachedLogoUrl"),E=localStorage.getItem("logoTimestamp"),b=new Date().getTime();if(w&&E&&b-parseInt(E)<36e5)c(w);else if(l!=null&&l.logo){const _=`${Pe.defaults.baseURL}/public/logo`;c(_),localStorage.setItem("cachedLogoUrl",_),localStorage.setItem("logoTimestamp",b.toString());const A=new Image;A.src=_}},[l]);const T=[{key:"profile",label:"Profile",icon:n.jsx(jt,{}),onClick:()=>i("/account")},{key:"settings",label:"Settings",icon:n.jsx(Ua,{}),onClick:()=>i("/settings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(za,{}),onClick:()=>{s(Pd()),i("/login")}}],m=()=>{const w=a.pathname.substring(1);return w.charAt(0).toUpperCase()+w.slice(1)};return n.jsxs(Et,{style:{minHeight:"100vh"},children:[n.jsxs(A1,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsx(C1,{children:n.jsx(I1,{children:n.jsx(N1,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})}),n.jsx(cr,{mode:"inline",selectedKeys:[a.pathname.substring(1)||"dashboard"],items:k,style:{border:"none",padding:"16px 0",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Et,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(T1,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(fe,{type:"text",icon:t?n.jsx(Eh,{}):n.jsx(_h,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:m()})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("div",{style:{marginRight:20},children:n.jsx(gg,{isExhibitor:!1})}),n.jsx(ni,{menu:{items:T},placement:"bottomRight",children:n.jsxs(ke,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Kn,{size:"small",icon:n.jsx(jt,{}),style:{backgroundColor:"#5046e5"}}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.username)||"User"})]})})]})]}),n.jsx(k1,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},Qd=localStorage.getItem("exhibitor_token"),F1=localStorage.getItem("exhibitor")?JSON.parse(localStorage.getItem("exhibitor")):null,R1={isAuthenticated:!!Qd,exhibitor:F1,token:Qd,showLoginModal:!1,showForgotPasswordModal:!1,loginContext:null},T0=gr({name:"exhibitorAuth",initialState:R1,reducers:{setExhibitorCredentials:(e,t)=>{e.exhibitor=t.payload.exhibitor,e.token=t.payload.token,e.isAuthenticated=!0,localStorage.setItem("exhibitor_token",t.payload.token),localStorage.setItem("exhibitor",JSON.stringify(t.payload.exhibitor))},exhibitorLogout:e=>{e.exhibitor=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("exhibitor_token"),localStorage.removeItem("exhibitor")},showLoginModal:(e,t)=>{e.showLoginModal=!0,e.showForgotPasswordModal=!1,e.loginContext=t.payload||null},hideLoginModal:e=>{e.showLoginModal=!1,e.loginContext=null},showForgotPasswordModal:e=>{e.showForgotPasswordModal=!0,e.showLoginModal=!1},hideForgotPasswordModal:e=>{e.showForgotPasswordModal=!1}}}),{setExhibitorCredentials:dc,exhibitorLogout:A0,showLoginModal:Zn,hideLoginModal:Js,showForgotPasswordModal:P1,hideForgotPasswordModal:rl}=T0.actions,D1=T0.reducer,{Header:O1,Sider:L1,Content:M1}=Et,ci=({children:e})=>{var f;const[t,r]=N.useState(!1),i=tr(),s=hr(),a=vc(),o=ut(h=>h.exhibitorAuth.exhibitor),l=()=>{const h=a.pathname;return h.includes("/exhibitor/dashboard")?"dashboard":h.includes("/exhibitor/bookings")?"bookings":h.includes("/exhibitor/profile")?"profile":h.includes("/exhibitions")?"exhibitions":h.includes("/exhibitor/support")?"help":"dashboard"},d=[{key:"dashboard",icon:n.jsx(Wa,{}),label:"Dashboard",onClick:()=>i("/exhibitor/dashboard")},{key:"bookings",icon:n.jsx($r,{}),label:"My Bookings",onClick:()=>i("/exhibitor/bookings")},{key:"profile",icon:n.jsx(jt,{}),label:"My Profile",onClick:()=>i("/exhibitor/profile")},{key:"exhibitions",icon:n.jsx(Qn,{}),label:"Exhibitions",onClick:()=>i("/exhibitions")},{key:"help",icon:n.jsx(rx,{}),label:"Help & Support",onClick:()=>i("/exhibitor/support")}],c=[{key:"profile",label:"My Profile",icon:n.jsx(jt,{}),onClick:()=>i("/exhibitor/profile")},{key:"bookings",label:"My Bookings",icon:n.jsx($r,{}),onClick:()=>i("/exhibitor/bookings")},{key:"divider",type:"divider"},{key:"logout",label:"Logout",icon:n.jsx(za,{}),onClick:()=>{s(A0()),i("/")}}],u=()=>{const h=a.pathname.replace("/exhibitor/","");return h==="dashboard"?"Dashboard":h.startsWith("bookings")?h.includes("/")?"Booking Details":"My Bookings":h==="profile"?"My Profile":h==="support"?"Help & Support":h.charAt(0).toUpperCase()+h.slice(1)};return n.jsxs(Et,{style:{minHeight:"100vh"},children:[n.jsxs(L1,{trigger:null,collapsible:!0,collapsed:t,style:{background:"#fff",borderRight:"1px solid #E5E7EB",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",position:"fixed",left:0,top:0,bottom:0,zIndex:100,overflow:"hidden"},width:256,collapsedWidth:80,children:[n.jsxs("div",{style:{height:65,padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"flex-start",borderBottom:"1px solid #E5E7EB"},children:[n.jsx("img",{src:"/logo.svg",alt:"Logo",style:{height:32,width:"auto"}}),!t&&n.jsx("span",{style:{marginLeft:12,fontSize:18,fontWeight:600,color:"#1890ff",whiteSpace:"nowrap"},children:"Exhibitor Portal"})]}),n.jsx(cr,{mode:"inline",selectedKeys:[l()],items:d,style:{border:"none",padding:t?"16px 0":"16px 8px",background:"transparent"},className:"main-nav-menu",inlineCollapsed:t})]}),n.jsxs(Et,{style:{marginLeft:t?80:256,transition:"all 0.2s"},children:[n.jsxs(O1,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 0 0 rgb(0 0 0 / 0.05)",zIndex:99},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx(fe,{type:"text",icon:t?n.jsx(Eh,{}):n.jsx(_h,{}),onClick:()=>r(!t),style:{fontSize:16}}),n.jsx("span",{style:{marginLeft:24,fontSize:20,fontWeight:600,color:"#111827"},children:u()})]}),n.jsx(ni,{menu:{items:c},placement:"bottomRight",children:n.jsxs(ke,{align:"center",style:{cursor:"pointer"},children:[n.jsx(Kn,{size:"small",style:{backgroundColor:"#5046e5"},children:((f=o==null?void 0:o.companyName)==null?void 0:f.charAt(0).toUpperCase())||"E"}),n.jsx("span",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(o==null?void 0:o.companyName)||"Exhibitor"})]})})]}),n.jsx(M1,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:e})]})]})},{Title:k0,Text:Qi,Paragraph:B1}=Ue,Ms=Un`
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
`,$1=Un`
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
`,U1=Un`
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
`,Vc=Un`
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
`,C0=Un`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
`,z1=Un`
  0% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(25deg) translateY(-260px) scaleY(1.2); opacity: 0; }
`,W1=Un`
  0% { transform: rotate(-25deg) translateY(260px) scaleY(1.2); opacity: 0; }
  20% { opacity: 0.5; }
  100% { transform: rotate(0deg) translateY(0) scaleY(1); opacity: 0; }
`,q1=Un`
  0% { stroke-dashoffset: 1000; }
  100% { stroke-dashoffset: 0; }
`,V1=be.div`
  min-height: 100vh;
  display: flex;
  overflow: hidden;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
`,H1=be.div`
  flex: 1;
  background-image: linear-gradient(135deg, rgba(35, 92, 169, 0.85), rgba(13, 71, 161, 0.9)), url('/exhibition-background.jpg');
  background-size: cover;
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 2rem;
  position: relative;
  overflow: hidden;
  animation: ${$1} 0.8s ease-out forwards;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  
  @media (max-width: 768px) {
    min-height: 200px;
  }
`,G1=be.div`
  position: absolute;
  width: 2px;
  height: 600px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, ${e=>.1+e.index%3*.05}), transparent);
  left: ${e=>20+e.index*10}%;
  top: 0;
  z-index: 1;
  opacity: 0;
  transform-origin: top;
  animation: ${e=>e.isHovered?z1:W1} ${e=>1.5+e.index*.2}s ease-out;
  animation-delay: ${e=>e.index*.1}s;
  animation-fill-mode: forwards;
`,Y1=be.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  background-color: #ffffff;
  animation: ${U1} 0.8s ease-out forwards;
`,X1=be.div`
  position: relative;
  width: 100%;
  height: 50px;
  display: flex;
  justify-content: center;
  align-items: center;
`,K1=be.svg`
  width: 40px;
  height: 40px;
  
  .path {
    stroke: #1890ff;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 1000;
    stroke-dashoffset: 0;
    animation: ${q1} 2s linear infinite;
  }
  
  .dot {
    fill: #1890ff;
    animation: ${Vc} 2s ease-in-out infinite;
  }
`,Q1=be.span`
  margin-left: 10px;
  animation: ${Ms} 0.5s ease-out;
`,J1=be.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
`,Z1=be.div`
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 600px;
`,ey=be.div`
  position: absolute;
  top: 25px;
  left: 30px;
  z-index: 10;
  display: flex;
  align-items: center;
  animation: ${Ms} 0.8s ease-out forwards;
`,ty=be.div`
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }
`,ry=be.img`
  width: 140px;
  height: auto;
  animation: ${C0} 6s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
`;be.div({fontSize:"1.25rem",fontWeight:600,marginLeft:"14px",color:"#1a3e72",letterSpacing:"0.5px"});const ny=be.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 2.5rem;
  animation: ${Ms} 0.8s ease-out forwards;
`,iy=be.div`
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  color: #ffffff;
  letter-spacing: 1px;
`,sy=be(k0)`
  color: #ffffff !important;
  font-weight: 400 !important;
  text-align: center;
  margin-top: 0 !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
`,ay=be(B1)`
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 16px;
  line-height: 1.6;
  text-align: center;
  max-width: 500px;
  margin: 1.5rem auto 0;
`,oy=be.div`
  width: 100%;
  max-width: 400px;
  animation: ${Ms} 0.6s ease-out;
`,ly=be(Re)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,cy=be(Re.Password)`
  height: 50px;
  border-radius: 8px;
  border: 1px solid #d9d9d9;
  background-color: #f8f8f8;
  transition: all 0.3s;
  
  &:hover, &:focus {
    background-color: white;
    border-color: #40a9ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    transform: translateY(-2px);
  }
`,dy=be(fe)`
  height: 50px;
  border-radius: 8px;
  font-weight: 600;
  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.045);
  transition: all 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  &.success {
    animation: ${Vc} 0.5s ease-in-out;
  }
`,uy=be.div`
  margin-bottom: 2rem;
  text-align: center;
`,Zs=be(oe.Item)`
  margin-bottom: 24px;
`,hy=be.div`
  margin-top: 8px;
`,fy=be.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,py=be(nx)`
  .ant-checkbox-checked .ant-checkbox-inner {
    background-color: #1890ff;
    border-color: #1890ff;
  }
  
  .ant-checkbox-inner:hover {
    border-color: #1890ff;
  }
  
  .ant-checkbox-wrapper:hover .ant-checkbox-inner {
    border-color: #1890ff;
  }
`,xy=be.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(82, 196, 26, 0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: ${Ms} 0.3s ease-out;
  
  svg {
    font-size: 80px;
    color: #52c41a;
    animation: ${Vc} 0.5s ease-in-out;
  }
`,Jd=()=>n.jsxs(X1,{children:[n.jsxs(K1,{viewBox:"0 0 50 50",children:[n.jsx("path",{className:"path",d:"M10,10 L40,10 L40,40 L10,40 L10,10 Z M10,25 L40,25 M20,10 L20,40 M30,10 L30,40"}),n.jsx("circle",{className:"dot",cx:"15",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"15",r:"2"}),n.jsx("circle",{className:"dot",cx:"15",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"25",cy:"35",r:"2"}),n.jsx("circle",{className:"dot",cx:"35",cy:"35",r:"2"})]}),n.jsx(Q1,{children:"Signing in..."})]}),my=be.div`
  position: absolute;
  width: ${e=>e.size}px;
  height: ${e=>e.size}px;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 50%;
  animation: ${C0} ${e=>e.duration}s ease-in-out infinite;
  animation-delay: ${e=>e.delay}s;
  top: ${e=>e.top}%;
  left: ${e=>e.left}%;
  z-index: 1;
`,gy=e=>{if(!e)return 0;const t=e.length>=8,r=/[A-Z]/.test(e),i=/[a-z]/.test(e),s=/\d/.test(e),a=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(e),o=[t,r,i,s,a];return o.filter(d=>d).length/o.length*100},yy=e=>e<30?"#ff4d4f":e<60?"#faad14":e<80?"#1890ff":"#52c41a",vy=e=>e<30?"Weak":e<60?"Fair":e<80?"Good":"Strong",by=["At least 8 characters long","Contains uppercase letters","Contains lowercase letters","Contains numbers","Contains special characters"],wy=()=>{const e=tr(),t=hr(),[r,i]=N.useState(null),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[d,c]=N.useState(""),[u,f]=N.useState(!1),h=ut(q=>q.auth.isAuthenticated),p=N.useRef(null),[y,x]=N.useState({x:0,y:0}),[g,v]=N.useState(!1),[k,T]=N.useState(!1),[m]=oe.useForm(),[w,E]=N.useState("/logo.png"),[b,_]=N.useState("EXHIBITION MANAGER");N.useEffect(()=>{const q=localStorage.getItem("cachedLogoUrl"),K=localStorage.getItem("logoTimestamp"),Q=new Date().getTime();if(q&&K&&Q-parseInt(K)<36e5)E(q);else{const ie=`${Pe.defaults.baseURL}/public/logo`;E(ie),localStorage.setItem("cachedLogoUrl",ie),localStorage.setItem("logoTimestamp",Q.toString());const Z=new Image;Z.src=ie}fetch(`${Pe.defaults.baseURL}/public/site-info`).then(ie=>ie.json()).then(ie=>{ie.siteName&&_(ie.siteName)}).catch(ie=>{console.error("Error fetching site info:",ie)})},[]),N.useEffect(()=>{const q=localStorage.getItem("rememberedUser");if(q)try{const K=JSON.parse(q);m.setFieldsValue({username:K.username,password:K.password,remember:!0})}catch{localStorage.removeItem("rememberedUser")}},[m]),N.useEffect(()=>{const q=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(q)},[]),N.useEffect(()=>{h&&e("/dashboard")},[h,e]),N.useEffect(()=>{const q=K=>{if(p.current){const Q=p.current.getBoundingClientRect(),ie=K.clientX-Q.left,Z=K.clientY-Q.top;ie>=0&&ie<=Q.width&&Z>=0&&Z<=Q.height&&x({x:ie,y:Z})}};return window.addEventListener("mousemove",q),()=>{window.removeEventListener("mousemove",q)}},[]);const A=async q=>{var K;try{i(null),a(!0);const Q=await qh.login({username:q.username,password:q.password}),{user:ie,token:Z}=Q.data;if(!ie||!Z)throw new Error("Invalid response from server");q.remember?(localStorage.setItem("rememberedUser",JSON.stringify({username:q.username,password:q.password})),localStorage.setItem("rememberUser","true")):(localStorage.removeItem("rememberedUser"),localStorage.removeItem("rememberUser")),l(!0),setTimeout(()=>{t(um({user:ie,token:Z})),Se.success("Login successful!"),e("/dashboard")},1200)}catch(Q){console.error("Login Error:",Q),console.error("Response Data:",(K=Q.response)==null?void 0:K.data);let ie="Authentication Error",Z="Invalid username or password.";if(Q.response&&typeof Q.response=="object"){const{status:R,data:U}=Q.response;R===401?(ie="Invalid Credentials",Z="The username or password you entered is incorrect."):R===403?(ie="Access Denied",Z="You do not have permission to access this resource."):R===400?(ie="Invalid Request",Z="Please check your input and try again."):R===500&&(ie="Server Error",Z="A server error occurred. Please try again later."),U&&typeof U=="object"&&U.message&&(Z=U.message)}else Q.request?(ie="Connection Error",Z="Unable to connect to the server. Please check your internet connection."):Q.message&&(Z=Q.message);i({title:ie,message:Z})}finally{a(!1)}},S=gy(d),j=yy(S),C=vy(S),P=localStorage.getItem("rememberUser")==="true";if(h)return n.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#f0f5ff"},children:[n.jsx(Jd,{}),n.jsx(Qi,{style:{marginTop:16},children:"Redirecting to dashboard..."})]});const M=q=>{const K=[];for(let Q=0;Q<q;Q++){const ie=Math.random()*20+8,Z=Math.random()*3,R=Math.random()*10+6,U=Math.random()*100,O=Math.random()*100;K.push(n.jsx(my,{size:ie,delay:Z,duration:R,top:U,left:O,style:{transform:`translate(${y.x/50*(Q%5-2)}px, ${y.y/50*(Q%5-2)}px)`,opacity:k?0:1,transition:"opacity 0.5s ease-out",backgroundColor:"rgba(255, 255, 255, 0.07)"}},Q))}return K},X=q=>{const K=[];for(let Q=0;Q<q;Q++)K.push(n.jsx(G1,{index:Q,isHovered:k},Q));return K},ee=q=>{T(q)};return n.jsxs(V1,{style:{opacity:g?1:0,transition:"opacity 0.3s ease-out"},children:[o&&n.jsx(xy,{children:n.jsx(ix,{})}),n.jsxs(H1,{onMouseEnter:()=>ee(!0),onMouseLeave:()=>ee(!1),children:[n.jsx(ey,{children:n.jsx(ty,{children:n.jsx(ry,{src:w,alt:"Exhibition Manager Logo",onError:()=>E("/logo.png")})})}),n.jsxs(J1,{ref:p,children:[M(12),X(8)]}),n.jsxs(Z1,{children:[n.jsx(ny,{children:n.jsx(iy,{children:b})}),n.jsx(sy,{level:4,children:"Your complete solution for managing exhibitions, stalls, and exhibitors"}),n.jsx(ay,{children:"Create floor plans, manage exhibitors, handle bookings, and generate invoices - all in one platform."})]})]}),n.jsx(Y1,{children:n.jsxs(oy,{children:[n.jsxs(uy,{children:[n.jsx(k0,{level:2,style:{marginBottom:"0.5rem"},children:"Admin Login"}),n.jsx(Qi,{type:"secondary",children:"Enter your credentials to access the admin dashboard"})]}),r&&n.jsx(Ct,{message:r.title,description:r.message,type:"error",showIcon:!0,style:{marginBottom:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},action:n.jsx(fe,{size:"small",type:"text",onClick:()=>i(null),children:"Dismiss"})}),n.jsxs(oe,{form:m,name:"login",initialValues:{remember:P},onFinish:A,layout:"vertical",children:[n.jsx(Zs,{name:"username",rules:[{required:!0,message:"Please input your username!"}],label:"Username",children:n.jsx(ly,{prefix:n.jsx(jt,{style:{color:"#bfbfbf"}}),placeholder:"Enter your username",disabled:s,autoComplete:"username"})}),n.jsx(Zs,{name:"password",rules:[{required:!0,message:"Please input your password!"}],label:"Password",help:u&&n.jsxs(hy,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[n.jsx(Qi,{type:"secondary",children:"Password Strength:"}),n.jsx(Qi,{strong:!0,style:{color:j},children:C})]}),n.jsx(fo,{percent:S,showInfo:!1,strokeColor:j,size:"small"}),n.jsx("div",{style:{marginTop:"8px"},children:n.jsx(ht,{title:n.jsx("ul",{style:{paddingLeft:"20px",margin:"0"},children:by.map((q,K)=>n.jsx("li",{children:q},K))}),children:n.jsxs(Qi,{type:"secondary",style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx(or,{style:{marginRight:"4px"}}),"Password requirements"]})})})]}),children:n.jsx(cy,{prefix:n.jsx(Ei,{style:{color:"#bfbfbf"}}),placeholder:"Enter your password",disabled:s,autoComplete:"current-password",onChange:q=>c(q.target.value),onFocus:()=>f(!0),onBlur:()=>f(!1)})}),n.jsx(fy,{children:n.jsx(Zs,{name:"remember",valuePropName:"checked",noStyle:!0,children:n.jsx(py,{children:"Remember me"})})}),n.jsx(Zs,{children:s?n.jsx(Jd,{}):n.jsx(dy,{type:"primary",htmlType:"submit",block:!0,className:o?"success":"",children:"Sign in"})})]})]})})]})},I0={getDashboardStats:async()=>{var e;try{const r=(await Pe.get("/users")).data||[],i=await Pe.get("/bookings"),s=((e=i.data)==null?void 0:e.data)||i.data||[],o=(await Pe.get("/exhibitions")).data||[],l=s.filter(u=>u.status==="confirmed"||u.status==="approved").reduce((u,f)=>u+(f.amount||0),0),d=[...s].sort((u,f)=>new Date(f.createdAt).getTime()-new Date(u.createdAt).getTime()).slice(0,5),c=[...r].sort((u,f)=>new Date(f.createdAt||0).getTime()-new Date(u.createdAt||0).getTime()).slice(0,5);return{userCount:r.length,bookingCount:s.length,totalRevenue:l,exhibitionCount:o.length,recentBookings:d,recentUsers:c}}catch(t){return console.error("Error fetching dashboard stats:",t),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:e,recentUsers:t}=await I0.getDashboardStats();return[...e.map(i=>({id:i._id,type:"booking",title:`New booking ${i._id.substring(0,8)}`,timestamp:i.createdAt,data:i})),...t.map(i=>({id:i._id,type:"user",title:`User ${i.username||"unknown"}`,timestamp:i.createdAt,data:i}))].sort((i,s)=>new Date(s.timestamp).getTime()-new Date(i.timestamp).getTime())}catch(e){return console.error("Error fetching recent activities:",e),[]}}},{Title:Sy,Text:ar}=Ue,jy=({title:e,value:t,icon:r,color:i,gradient:s,loading:a})=>n.jsxs(Ae,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:s,border:"none",overflow:"hidden",position:"relative"},children:[n.jsx("div",{className:"stat-card-background"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[n.jsx(ar,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:e}),n.jsx(ar,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:a?n.jsx(Rt,{size:"small"}):t})]}),n.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:r})]})]}),Ey=()=>{const[e,t]=N.useState(!0),[r,i]=N.useState(0),[s,a]=N.useState(0),[o,l]=N.useState(0),[d,c]=N.useState(0),[u,f]=N.useState([]),[h,p]=N.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});N.useEffect(()=>{(async()=>{t(!0);try{const g=await I0.getDashboardStats();i(g.userCount),a(g.bookingCount),l(g.totalRevenue),c(g.exhibitionCount);const v=[];g.recentBookings.slice(0,3).forEach(k=>{v.push({id:k._id,icon:n.jsx(qa,{}),color:"#2563EB",text:n.jsxs(ar,{children:["New booking ",n.jsxs(ar,{strong:!0,children:["#",k._id.substring(0,8)]})," received"]}),timestamp:new Date(k.createdAt).toLocaleString()})}),g.recentUsers.slice(0,2).forEach(k=>{v.push({id:k._id,icon:n.jsx(jt,{}),color:"#7C3AED",text:n.jsxs(ar,{children:["User ",n.jsxs(ar,{strong:!0,children:["'",k.username,"'"]})," ",k.createdAt?"registered":"active"]}),timestamp:k.createdAt?new Date(k.createdAt).toLocaleString():"Recently"})}),v.sort((k,T)=>new Date(T.timestamp).getTime()-new Date(k.timestamp).getTime()),f(v)}catch(g){console.error("Error fetching dashboard data:",g)}finally{t(!1)}})()},[]);const y=[{title:"Total Users",value:r,icon:n.jsx(jt,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:s,icon:n.jsx(qa,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`₹${o.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:n.jsx(Va,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:d,icon:n.jsx(sx,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx(Sy,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),n.jsx(ze,{gutter:[24,24],children:y.map((x,g)=>n.jsx(ae,{xs:24,sm:12,lg:6,children:n.jsx(jy,{...x,loading:e})},g))}),n.jsxs(ze,{gutter:[24,24],style:{marginTop:"24px"},children:[n.jsx(ae,{xs:24,lg:12,children:n.jsx(Ae,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:e,children:u.length>0?n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:u.map(x=>n.jsxs("div",{className:"activity-item",children:[_t.cloneElement(x.icon,{style:{color:x.color}}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[x.text,n.jsx(ar,{type:"secondary",style:{fontSize:"12px"},children:x.timestamp})]})]},x.id))}):n.jsx(ar,{type:"secondary",children:"No recent activity found"})})}),n.jsx(ae,{xs:24,lg:12,children:n.jsx(Ae,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator online"}),n.jsxs(ar,{children:["Server Status: ",n.jsx(ar,{strong:!0,type:"success",children:h.server})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator connected"}),n.jsxs(ar,{children:["Database Status: ",n.jsx(ar,{strong:!0,type:"success",children:h.database})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator backup"}),n.jsxs(ar,{children:["Last Backup: ",n.jsx(ar,{strong:!0,children:h.lastBackup})]})]}),n.jsxs("div",{className:"status-item",children:[n.jsx("div",{className:"status-indicator normal"}),n.jsxs(ar,{children:["System Load: ",n.jsx(ar,{strong:!0,children:h.systemLoad})]})]})]})})})]})]})},Ir={getExhibitions:()=>rn.get("/public/exhibitions"),getExhibition:e=>rn.get(`/public/exhibitions/${e}`),getLayout:e=>rn.get(`/public/exhibitions/${e}/layout`),getStallDetails:(e,t)=>rn.get(`/public/exhibitions/${e}/stalls/${t}`),bookStall:(e,t,r)=>rn.post(`/public/exhibitions/${e}/stalls/${t}/book`,r),bookMultipleStalls:(e,t)=>rn.post(`/public/exhibitions/${e}/stalls/book-multiple`,t),searchExhibitors:e=>rn.get("/public/exhibitors/search",{params:{query:e}}),exhibitorBookStalls:e=>Yi.post(`/exhibitor-bookings/${e.exhibitionId}`,e),getExhibitorBookings:()=>Yi.get("/exhibitor-bookings/my-bookings"),getExhibitorBooking:e=>Yi.get(`/exhibitor-bookings/${e}`),cancelExhibitorBooking:e=>Yi.patch(`/exhibitor-bookings/${e}/cancel`),getExhibitorBookingInvoice:e=>Yi.get(`/exhibitor-bookings/${e}/invoice`)},{Title:_y,Text:pn,Paragraph:tk}=Ue,Ty=()=>{const[e,t]=N.useState([]),[r,i]=N.useState(!0),[s,a]=N.useState(null),[o,l]=N.useState([]),[d,c]=N.useState(!0),u=ut(m=>m.exhibitorAuth.exhibitor),f=tr();N.useEffect(()=>{h(),p()},[]);const h=async()=>{try{i(!0),a(null);const m=await Ir.getExhibitorBookings();t(m.data||[])}catch(m){console.error("Failed to fetch bookings:",m),a("Unable to load your bookings at this time. Please try again later.")}finally{i(!1)}},p=async()=>{try{c(!0);const m=await Ir.getExhibitions(),w=St(),E=(m.data||[]).filter(b=>b.isActive&&St(b.endDate).isAfter(w)).slice(0,3);l(E)}catch(m){console.error("Failed to fetch upcoming exhibitions:",m)}finally{c(!1)}},y=e.filter(m=>m.status==="approved").length,x=e.filter(m=>m.status==="pending").length;e.filter(m=>m.status==="rejected").length;const g=e.filter(m=>m.status==="confirmed").length,v=m=>{switch(m){case"approved":return n.jsxs(Ne,{color:"success",children:[n.jsx(Nt,{})," Approved"]});case"pending":return n.jsxs(Ne,{color:"warning",children:[n.jsx(br,{})," Pending"]});case"rejected":return n.jsxs(Ne,{color:"error",children:[n.jsx(Kr,{})," Rejected"]});case"confirmed":return n.jsxs(Ne,{color:"blue",children:[n.jsx(Nt,{})," Confirmed"]});case"cancelled":return n.jsxs(Ne,{color:"default",children:[n.jsx(Kr,{})," Cancelled"]});default:return n.jsx(Ne,{children:"Unknown"})}},k=m=>{f(`/exhibitor/invoice/${m}`)},T=(m,w)=>m.status===w;return n.jsxs("div",{children:[n.jsxs(_y,{level:2,children:["Welcome, ",(u==null?void 0:u.companyName)||"Exhibitor"]}),n.jsx(pn,{type:"secondary",children:"Here's an overview of your exhibition activities"}),s&&n.jsx(Ct,{message:"Error",description:s,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),x>0&&n.jsx(Ct,{message:"Pending Approvals",description:`You have ${x} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(fe,{size:"small",type:"primary",onClick:()=>f("/exhibitor/bookings"),children:"View Bookings"})}),n.jsxs(ze,{gutter:[24,24],style:{marginTop:24},children:[n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Total Bookings",value:r?"-":e.length,prefix:n.jsx($r,{}),loading:r})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Confirmed",value:r?"-":g,valueStyle:{color:"#1890ff"},prefix:n.jsx(Nt,{}),loading:r})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Approved",value:r?"-":y,valueStyle:{color:"#3f8600"},prefix:n.jsx(Nt,{}),loading:r})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Pending",value:r?"-":x,valueStyle:{color:"#faad14"},prefix:n.jsx(br,{}),loading:r})})})]}),n.jsx(Ae,{title:"Recent Bookings",extra:n.jsx(Cr,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:r,children:r?n.jsx(vn,{active:!0,paragraph:{rows:3}}):e.length>0?n.jsx(yn,{dataSource:e.slice(0,5),renderItem:m=>{var w,E,b,_,A;return n.jsxs(yn.Item,{actions:[n.jsx(fe,{type:"link",onClick:()=>f(`/exhibitor/bookings/${m._id}`),children:"View Details"},"view"),T(m,"approved")||T(m,"confirmed")?n.jsx(fe,{type:"link",icon:n.jsx(Th,{}),onClick:()=>k(m._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[n.jsx(yn.Item.Meta,{title:n.jsxs("div",{children:[n.jsx(pn,{strong:!0,children:((w=m.exhibitionId)==null?void 0:w.name)||"Exhibition"}),n.jsxs(pn,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((E=m.stallIds)==null?void 0:E.map(S=>S.number).join(", "))||"N/A"]})]}),description:n.jsxs(ke,{direction:"vertical",size:1,children:[n.jsxs("div",{children:[n.jsxs(pn,{children:["Booked on: ",St(m.createdAt).format("MMM D, YYYY")]}),n.jsx(Tt,{type:"vertical"}),n.jsxs(pn,{children:["Amount: ₹",((b=m.amount)==null?void 0:b.toLocaleString())||"N/A"]})]}),n.jsx("div",{children:n.jsxs(pn,{children:["Exhibition date: ",St((_=m.exhibitionId)==null?void 0:_.startDate).format("MMM D")," - ",St((A=m.exhibitionId)==null?void 0:A.endDate).format("MMM D, YYYY")]})})]})}),v(m.status)]})}}):n.jsx(xt,{description:"No bookings found",image:xt.PRESENTED_IMAGE_SIMPLE})}),n.jsx(Ae,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:d,extra:n.jsx(Cr,{to:"/exhibitions",children:"View All"}),children:d?n.jsx(vn,{active:!0,paragraph:{rows:3}}):o.length>0?n.jsx(yn,{dataSource:o,renderItem:m=>n.jsx(yn.Item,{actions:[n.jsx(fe,{type:"primary",onClick:()=>f(`/exhibitions/${m._id}/layout`),children:"Book Stall"},"book")],children:n.jsx(yn.Item.Meta,{title:m.name,description:n.jsxs(ke,{direction:"vertical",size:1,children:[n.jsx(pn,{children:m.venue}),n.jsxs(pn,{type:"secondary",children:[St(m.startDate).format("MMM D")," - ",St(m.endDate).format("MMM D, YYYY")]})]})})})}):n.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[n.jsx(Qn,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),n.jsxs("div",{children:[n.jsx(pn,{children:"No upcoming exhibitions at the moment"}),n.jsx("div",{style:{marginTop:16},children:n.jsx(Cr,{to:"/exhibitions",children:n.jsx(fe,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),n.jsx(ze,{gutter:[24,24],style:{marginTop:24},children:n.jsx(ae,{span:24,children:n.jsx(Ae,{title:"Quick Actions",children:n.jsxs(ze,{gutter:[16,16],children:[n.jsx(ae,{xs:24,sm:12,md:8,lg:6,children:n.jsx(fe,{type:"primary",icon:n.jsx($r,{}),block:!0,onClick:()=>f("/exhibitions"),children:"Book New Stall"})}),n.jsx(ae,{xs:24,sm:12,md:8,lg:6,children:n.jsx(fe,{icon:n.jsx(Qn,{}),block:!0,onClick:()=>f("/exhibitor/bookings"),children:"View All Bookings"})}),n.jsx(ae,{xs:24,sm:12,md:8,lg:6,children:n.jsx(fe,{icon:n.jsx(Va,{}),block:!0,onClick:()=>f("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),n.jsx(ae,{xs:24,sm:12,md:8,lg:6,children:n.jsx(fe,{icon:n.jsx(jt,{}),block:!0,onClick:()=>f("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})},uc=bn.create({baseURL:nn}),di=bn.create({baseURL:nn});uc.interceptors.request.use(e=>{const t=localStorage.getItem("exhibitor_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const Hn=bn.create({baseURL:nn});Hn.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const lr={sendRegistrationOTP:async e=>await di.post("/exhibitors/send-otp",{email:e}),verifyOTP:async e=>await di.post("/exhibitors/verify-otp",e),register:async e=>await di.post("/exhibitors/register",e),login:async e=>await di.post("/exhibitors/login",e),requestPasswordReset:async e=>await di.post("/exhibitors/forgot-password",e),resetPassword:async e=>await di.post("/exhibitors/reset-password",e),getProfile:async()=>await uc.get("/exhibitors/profile"),updateProfile:async e=>await uc.put("/exhibitors/profile",e),getExhibitors:async()=>await Hn.get("/exhibitors/admin/exhibitors"),getExhibitor:async e=>await Hn.get(`/exhibitors/admin/exhibitors/${e}`),createExhibitor:async e=>await Hn.post("/exhibitors/admin/exhibitors",e),updateStatus:async(e,t,r)=>await Hn.put(`/exhibitors/admin/exhibitors/${e}/status`,{status:t,rejectionReason:r}),updateExhibitor:async(e,t)=>await Hn.put(`/exhibitors/admin/exhibitors/${e}`,t),deleteExhibitor:async e=>await Hn.delete(`/exhibitors/admin/exhibitors/${e}`)},{Step:nl}=Ns,{Text:Ay}=Ue,ky=({loginModalVisible:e,registerModalVisible:t,setRegisterModalVisible:r,setExhibitorCredentials:i,onForgotPassword:s})=>{const a=hr(),o=ut(Z=>Z.exhibitorAuth),[l,d]=N.useState(!1),[c,u]=N.useState(null),[f]=oe.useForm(),[h]=oe.useForm(),[p]=oe.useForm(),[y,x]=N.useState(0),[g,v]=N.useState(""),[k,T]=N.useState(!1),[m,w]=N.useState(!1),[E,b]=N.useState(0),[_,A]=N.useState({companyName:"",contactPerson:""}),S=N.useRef(null),j=async Z=>{var R,U,O,I,W,J,he,ye,H;try{u(null),d(!0);const Y=await lr.login(Z),{exhibitor:le,token:de}=Y.data;if(!le||!de)throw new Error("Invalid response from server");i({exhibitor:le,token:de}),a(Js()),f.resetFields(),Se.success("Login successful!")}catch(Y){if(((R=Y.response)==null?void 0:R.status)===403){const le=(O=(U=Y.response)==null?void 0:U.data)==null?void 0:O.status;if(le==="pending")u("Your account is pending approval. You will be able to log in after admin approval.");else if(le==="rejected"){const de=(W=(I=Y.response)==null?void 0:I.data)==null?void 0:W.rejectionReason;u(de?`Your registration has been rejected. Reason: ${de}`:"Your registration has been rejected. Please contact the administrator for more details.")}else u(((he=(J=Y.response)==null?void 0:J.data)==null?void 0:he.message)||"Access denied. Please contact administrator.")}else u(((H=(ye=Y.response)==null?void 0:ye.data)==null?void 0:H.message)||"Login failed. Please try again.")}finally{d(!1)}},C=async()=>{var Z,R;try{const U=await h.validateFields(["email","companyName","contactPerson"]);d(!0),u(null),v(U.email),A({companyName:U.companyName,contactPerson:U.contactPerson}),await lr.sendRegistrationOTP(U.email),T(!0),Se.success("OTP sent to your email address"),b(60),P(),x(1)}catch(U){if(U.name==="ValidationError")return;const O=((R=(Z=U.response)==null?void 0:Z.data)==null?void 0:R.message)||"Failed to send OTP. Please try again.";u(O),Se.error(O)}finally{d(!1)}},P=()=>{S.current&&clearInterval(S.current),S.current=setInterval(()=>{b(Z=>Z<=1?(S.current&&clearInterval(S.current),0):Z-1)},1e3)},M=async()=>{var Z,R;try{d(!0),u(null),await lr.sendRegistrationOTP(g),Se.success("New OTP sent to your email address"),b(60),P()}catch(U){const O=((R=(Z=U.response)==null?void 0:Z.data)==null?void 0:R.message)||"Failed to resend OTP. Please try again.";u(O),Se.error(O)}finally{d(!1)}},X=async Z=>{var R,U;try{d(!0),u(null);const O={email:g,otp:Z.otp};await lr.verifyOTP(O),w(!0),Se.success("Email verified successfully"),S.current&&clearInterval(S.current),x(2)}catch(O){const I=((U=(R=O.response)==null?void 0:R.data)==null?void 0:U.message)||"Invalid OTP. Please try again.";u(I),Se.error(I)}finally{d(!1)}},ee=()=>{T(!1),w(!1),v(""),b(0),x(0),A({companyName:"",contactPerson:""}),S.current&&clearInterval(S.current),p.resetFields()},q=async Z=>{var R,U,O;try{if(u(null),d(!0),!m){u("Email verification required");return}const{confirmPassword:I,...W}=Z,J={...W,email:g,companyName:_.companyName,contactPerson:_.contactPerson};console.log("Sending registration data:",J);const he=await lr.register(J);Se.success("Registration successful! You can log in and book a stall only after admin approval."),r(!1),h.resetFields(),ee(),setTimeout(()=>{a(Zn(void 0))},500)}catch(I){console.error("Registration error:",I),console.error("Response data:",(R=I.response)==null?void 0:R.data);const W=((O=(U=I.response)==null?void 0:U.data)==null?void 0:O.message)||"Registration failed. Please try again.";u(W),Se.error(W)}finally{d(!1)}};_t.useEffect(()=>()=>{S.current&&clearInterval(S.current)},[]);const K=()=>{r(!1),u(null),h.resetFields(),ee()},Q=()=>{a(Js()),r(!0),f.resetFields()},ie=()=>{r(!1),a(Zn(void 0)),h.resetFields()};return n.jsxs(n.Fragment,{children:[n.jsxs(pt,{title:"Exhibitor Login",open:e,onCancel:()=>{a(Js()),u(null),f.resetFields()},footer:null,width:400,children:[o.loginContext==="stall-booking"&&n.jsx(Ct,{message:"Login Required for Stall Booking",description:"Please log in to your exhibitor account to select and book stalls for this exhibition.",type:"info",showIcon:!0,style:{marginBottom:16}}),c&&n.jsx(Ct,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),n.jsxs(oe,{form:f,name:"exhibitor_login_modal",onFinish:j,layout:"vertical",children:[n.jsx(oe.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(Re,{prefix:n.jsx(Ln,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(oe.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:n.jsx(Re.Password,{prefix:n.jsx(Ei,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsxs(oe.Item,{children:[n.jsx("div",{style:{textAlign:"right",marginBottom:10},children:n.jsx(fe,{type:"link",onClick:()=>{a(Js()),s()},style:{padding:0},children:"Forgot password?"})}),n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Login"})]})]}),n.jsx(Tt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Don't have an account?"})}),n.jsx(fe,{type:"default",block:!0,onClick:Q,children:"Register as Exhibitor"})]}),n.jsxs(pt,{title:"Exhibitor Registration",open:t,onCancel:K,footer:null,width:500,children:[n.jsxs(Ns,{current:y,style:{marginBottom:24},children:[n.jsx(nl,{title:"Basic Info"}),n.jsx(nl,{title:"Verify Email"}),n.jsx(nl,{title:"Complete"})]}),c&&n.jsx(Ct,{message:c,type:"error",showIcon:!0,style:{marginBottom:16}}),y===0&&n.jsxs(n.Fragment,{children:[n.jsx(Ct,{message:"Email Verification Required",description:"We'll send a one-time password (OTP) to verify your email before completing registration.",type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(oe,{form:h,name:"exhibitor_register_step1",layout:"vertical",children:[n.jsx(oe.Item,{name:"companyName",rules:[{required:!0,message:"Please input your company name!"}],children:n.jsx(Re,{prefix:n.jsx(Sc,{}),placeholder:"Company Name",size:"large",disabled:l})}),n.jsx(oe.Item,{name:"contactPerson",rules:[{required:!0,message:"Please input contact person name!"}],children:n.jsx(Re,{prefix:n.jsx(jt,{}),placeholder:"Contact Person",size:"large",disabled:l})}),n.jsx(oe.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please enter a valid email address!"}],children:n.jsx(Re,{prefix:n.jsx(Ln,{}),placeholder:"Email",size:"large",disabled:l})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",onClick:C,block:!0,size:"large",loading:l,children:"Continue & Verify Email"})})]}),n.jsx(Tt,{children:n.jsx("span",{style:{fontSize:"14px",color:"#888"},children:"Already have an account?"})}),n.jsx(fe,{type:"default",block:!0,onClick:ie,children:"Login"})]}),y===1&&n.jsxs(n.Fragment,{children:[n.jsx(Ct,{message:"Email Verification",description:`We've sent a verification code to ${g}. Please enter it below to continue.`,type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsxs(oe,{form:p,name:"verify_otp",onFinish:X,layout:"vertical",children:[n.jsx(oe.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code!"}],children:n.jsx(Re,{size:"large",placeholder:"Enter OTP",maxLength:6,style:{textAlign:"center",letterSpacing:"8px",fontSize:"20px"},disabled:l})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Verify & Continue"})})]}),n.jsxs(ze,{justify:"space-between",align:"middle",style:{marginTop:16},children:[n.jsx(ae,{children:n.jsx(fe,{type:"link",disabled:E>0||l,onClick:M,children:"Resend Code"})}),n.jsx(ae,{children:E>0&&n.jsxs(Ay,{type:"secondary",children:["Resend in ",E,"s"]})})]}),n.jsx(Tt,{}),n.jsx(fe,{type:"default",block:!0,onClick:()=>x(0),children:"Back"})]}),y===2&&n.jsxs(n.Fragment,{children:[n.jsx(Ct,{message:"Email Verified Successfully",description:"Please complete your registration by providing the remaining details.",type:"success",showIcon:!0,style:{marginBottom:16}}),n.jsxs(oe,{form:h,name:"exhibitor_register_step2",onFinish:q,layout:"vertical",children:[n.jsx(oe.Item,{name:"phone",rules:[{required:!0,message:"Please input your phone number!"}],children:n.jsx(Re,{prefix:n.jsx(jc,{}),placeholder:"Phone Number",size:"large",disabled:l})}),n.jsx(oe.Item,{name:"address",rules:[{required:!0,message:"Please input your address!"}],children:n.jsx(Re.TextArea,{placeholder:"Address",rows:3,disabled:l})}),n.jsx(oe.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:n.jsx(Re.Password,{prefix:n.jsx(Ei,{}),placeholder:"Password",size:"large",disabled:l})}),n.jsx(oe.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},({getFieldValue:Z})=>({validator(R,U){return!U||Z("password")===U?Promise.resolve():Promise.reject(new Error("The two passwords do not match!"))}})],children:n.jsx(Re.Password,{prefix:n.jsx(Ei,{}),placeholder:"Confirm Password",size:"large",disabled:l})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:l,children:"Complete Registration"})})]})]})]})]})},{Step:rk}=Ns,{Text:nk}=Ue,Cy=({visible:e})=>{const t=hr(),[r,i]=N.useState(!1),[s,a]=N.useState(null),[o,l]=N.useState(0),[d,c]=N.useState(""),[u,f]=N.useState(!1),[h,p]=N.useState(0),y=oe.useForm()[0],x=oe.useForm()[0],g=oe.useForm()[0],v=N.useRef(null),k=async S=>{var j,C;try{i(!0),a(null);const P=await lr.requestPasswordReset(S);c(S.email),f(!0),l(1),Se.success("Password reset code sent to your email"),p(60),T()}catch(P){const M=((C=(j=P.response)==null?void 0:j.data)==null?void 0:C.message)||"Failed to send password reset code. Please try again.";a(M)}finally{i(!1)}},T=()=>{v.current&&clearInterval(v.current),v.current=setInterval(()=>{p(S=>S<=1?(v.current&&clearInterval(v.current),0):S-1)},1e3)},m=async()=>{var S,j;try{i(!0),a(null),await lr.requestPasswordReset({email:d}),Se.success("New password reset code sent to your email"),p(60),T()}catch(C){const P=((j=(S=C.response)==null?void 0:S.data)==null?void 0:j.message)||"Failed to resend password reset code. Please try again.";a(P)}finally{i(!1)}},w=async S=>{var j,C;try{i(!0),a(null),l(2),v.current&&clearInterval(v.current)}catch(P){const M=((C=(j=P.response)==null?void 0:j.data)==null?void 0:C.message)||"Invalid code. Please try again.";a(M)}finally{i(!1)}},E=async S=>{var j,C;try{i(!0),a(null);const P=x.getFieldValue("otp"),M={email:d,otp:P,newPassword:S.newPassword};await lr.resetPassword(M),Se.success("Password reset successful. You can now log in with your new password."),b(),t(rl()),t(Zn())}catch(P){const M=((C=(j=P.response)==null?void 0:j.data)==null?void 0:C.message)||"Failed to reset password. Please try again.";a(M)}finally{i(!1)}},b=()=>{l(0),c(""),f(!1),p(0),v.current&&clearInterval(v.current),y.resetFields(),x.resetFields(),g.resetFields()},_=()=>{b(),t(rl())},A=()=>{b(),t(rl()),t(Zn())};return _t.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),n.jsxs(pt,{title:"Forgot Password",open:e,onCancel:_,footer:null,width:400,children:[s&&n.jsx(Ct,{message:s,type:"error",style:{marginBottom:16}}),n.jsx(Ns,{current:o,size:"small",style:{marginBottom:20},items:[{title:"Email"},{title:"Verify"},{title:"Reset"}]}),o===0&&n.jsxs(oe,{form:y,onFinish:k,layout:"vertical",children:[n.jsx(oe.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(Re,{prefix:n.jsx(Ln,{}),placeholder:"Email"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Send Reset Code"})}),n.jsx(Tt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Remember your password?"})}),n.jsx(fe,{type:"link",onClick:A,block:!0,children:"Back to Login"})]}),o===1&&n.jsxs(oe,{form:x,onFinish:w,layout:"vertical",children:[n.jsxs("p",{children:["We've sent a verification code to ",n.jsx("strong",{children:d}),". Please check your email and enter the code below."]}),n.jsx(oe.Item,{name:"otp",rules:[{required:!0,message:"Please enter the verification code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit code"}],children:n.jsx(Re,{placeholder:"Enter 6-digit code",maxLength:6,style:{letterSpacing:"0.5em",textAlign:"center",fontWeight:"bold"}})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Verify Code"})}),n.jsx("div",{style:{textAlign:"center",marginTop:8},children:h>0?n.jsxs(Ue.Text,{type:"secondary",children:["Resend code in ",h,"s"]}):n.jsx(fe,{type:"link",onClick:m,disabled:r,children:"Resend Code"})}),n.jsx(Tt,{style:{margin:"12px 0"},children:n.jsx("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:"Back to beginning"})}),n.jsx(fe,{type:"link",onClick:()=>{l(0),v.current&&(clearInterval(v.current),p(0))},block:!0,children:"Change Email"})]}),o===2&&n.jsxs(oe,{form:g,onFinish:E,layout:"vertical",children:[n.jsx(oe.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],hasFeedback:!0,children:n.jsx(Re.Password,{prefix:n.jsx(Ei,{}),placeholder:"New Password"})}),n.jsx(oe.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:S})=>({validator(j,C){return!C||S("newPassword")===C?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(Re.Password,{prefix:n.jsx(Ei,{}),placeholder:"Confirm Password"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",block:!0,loading:r,children:"Reset Password"})})]})]})},{Header:Iy}=Et,Ny=be(Iy)`
  background: #fff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  width: 100%;
  z-index: 1000;
  
  @media (max-width: 768px) {
    padding: 0 1rem;
  }
`,Fy=be.div`
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  @media (max-width: 768px) {
    justify-content: space-between;
  }
`,Ry=be.div`
  display: flex;
  align-items: center;
  justify-content: center;
  
  @media (max-width: 768px) {
    position: static;
    transform: none;
    justify-content: flex-start;
  }
`,Py=be.div`
  border-radius: 8px;
  padding: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  
  @media (max-width: 768px) {
    padding: 8px;
  }
`,Dy=be.img`
  height: auto;
  width: 100%;
  max-width: 140px;
  max-height: auto;
  object-fit: contain;
  
  @media (max-width: 768px) {
    max-width: 120px;
  }
`,Zd=be(Kn)`
  background-color: #1890ff;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  
  &:hover {
    background-color: #40a9ff;
    border-color: #e6f7ff;
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(24, 144, 255, 0.3);
  }
`,eu=be(cr)`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  
  .ant-dropdown-menu-item {
    padding: 10px 16px;
    transition: all 0.2s;
    
    &:hover {
      background-color: #fafafa;
    }
  }
`,Oy=be(cr)`
  border: none;
  display: flex;
  justify-content: center;
  font-size: 15px;
  
  @media (max-width: 768px) {
    display: none !important;
  }
`,Ly=be(fe)`
  display: none;
  font-size: 18px;
  background: transparent;
  border: none;
  padding: 8px;
  transition: all 0.3s ease;
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
  }
  
  &:hover {
    transform: rotate(90deg);
    color: #4158D0;
  }
  
  &:active {
    transform: scale(0.9) rotate(90deg);
  }
`,My=be.div`
  .ant-drawer-header {
    padding: 16px 24px;
  }
  
  .ant-drawer-title {
    font-size: 16px;
    font-weight: 600;
  }
  
  .ant-drawer-body {
    padding: 24px 16px;
  }
  
  .ant-drawer-content-wrapper {
    max-width: 80%;
  }
`,By=be(Cr)`
  display: block;
  padding: 16px 8px;
  margin-bottom: 8px;
  color: #333;
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  
  &:hover {
    color: #1890ff;
  }
`,ea=be(fe)`
  width: 100%;
  margin-bottom: 12px;
  height: auto;
  padding: 12px 16px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  
  svg {
    margin-right: 10px;
    font-size: 18px;
  }
`,$y=be.div`
  display: flex;
  align-items: center;
  
  @media (max-width: 768px) {
    display: none;
  }
`,Uy=be.span`
  margin-right: 8px;
  display: none;
  
  @media (min-width: 768px) {
    display: inline;
  }
`,Gr=()=>{var _;const e=tr(),t=hr(),[r,i]=N.useState(!1),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[d,c]=N.useState("/logo.png"),[u,f]=N.useState("Exhibition Manager"),h=ut(A=>A.exhibitorAuth),{exhibitor:p,isAuthenticated:y,showLoginModal:x,showForgotPasswordModal:g}=h;N.useEffect(()=>{const A=localStorage.getItem("cachedLogoUrl"),S=localStorage.getItem("logoTimestamp"),j=new Date().getTime();if(A&&S&&j-parseInt(S)<36e5)c(A);else{const C=`${Pe.defaults.baseURL}/public/logo`;c(C),localStorage.setItem("cachedLogoUrl",C),localStorage.setItem("logoTimestamp",j.toString());const P=new Image;P.src=C}fetch(`${Pe.defaults.baseURL}/public/site-info`).then(C=>C.json()).then(C=>{C.siteName&&f(C.siteName)}).catch(C=>{console.error("Error fetching site info:",C)})},[]),N.useEffect(()=>(Se.config({top:84,duration:3,maxCount:1}),()=>{Se.destroy()}),[]);const v=()=>{t(A0()),Se.success("Successfully logged out"),e("/"),i(!1),a(!1)},k=()=>{t(Zn(void 0)),i(!1),a(!1)},T=()=>{l(!0),i(!1),a(!1)},m=()=>{t(P1())},w=[{key:"exhibitions",label:"Exhibitions",path:"/exhibitions"},{key:"about",label:"About",path:"/about"},{key:"contact",label:"Contact",path:"/contact"}],E=n.jsx(eu,{items:[{key:"exhibitor-login",icon:n.jsx(Ed,{}),label:n.jsx("a",{onClick:k,children:"Exhibitor Login"})},{key:"exhibitor-register",icon:n.jsx($a,{}),label:n.jsx("a",{onClick:T,children:"Register as Exhibitor"})}]}),b=n.jsx(eu,{items:[{key:"exhibitor-dashboard",icon:n.jsx(Wa,{}),label:n.jsx(Cr,{to:"/exhibitor/dashboard",children:"Dashboard"})},{key:"exhibitor-profile",icon:n.jsx(jt,{}),label:n.jsx(Cr,{to:"/exhibitor/profile",children:"My Profile"})},{key:"exhibitor-bookings",icon:n.jsx($r,{}),label:n.jsx(Cr,{to:"/exhibitor/bookings",children:"My Bookings"})},{key:"divider",type:"divider"},{key:"exhibitor-logout",icon:n.jsx(za,{}),label:n.jsx("a",{onClick:v,children:"Logout"})}]});return n.jsxs(n.Fragment,{children:[n.jsx(Ny,{children:n.jsxs(Fy,{children:[n.jsx(Ry,{children:n.jsx(Cr,{to:"/",style:{display:"flex",alignItems:"center",textDecoration:"none"},children:n.jsx(Py,{children:n.jsx(Dy,{src:d,alt:"Logo",onError:()=>c("/logo.png")})})})}),n.jsx(Oy,{mode:"horizontal",selectedKeys:[],style:{flex:1,display:"flex",justifyContent:"center"},items:w.map(A=>({key:A.key,label:n.jsx(Cr,{to:A.path,children:A.label})}))}),n.jsx($y,{children:n.jsx(ni,{overlay:h.isAuthenticated?b:E,trigger:["click"],placement:"bottomRight",open:r,onOpenChange:i,overlayStyle:{minWidth:"150px",marginTop:"10px"},children:h.isAuthenticated?n.jsxs(ke,{style:{cursor:"pointer"},children:[n.jsx(Uy,{children:((_=h.exhibitor)==null?void 0:_.companyName)||"Exhibitor"}),n.jsx(Zd,{icon:n.jsx(jt,{}),size:"large"})]}):n.jsx(Zd,{icon:n.jsx(jt,{}),size:"large"})})}),n.jsx(Ly,{icon:n.jsx(ax,{}),onClick:()=>a(!0)})]})}),n.jsx(My,{children:n.jsxs(ox,{title:"Exhibition Management System",placement:"right",onClose:()=>a(!1),open:s,width:280,closeIcon:n.jsx("span",{style:{fontSize:"16px"},children:"×"}),children:[n.jsx("div",{style:{marginBottom:24},children:w.map(A=>n.jsx(By,{to:A.path,onClick:()=>a(!1),children:A.label},A.key))}),n.jsx("div",{style:{marginTop:40},children:h.isAuthenticated?n.jsxs(n.Fragment,{children:[n.jsx(ea,{type:"primary",icon:n.jsx(Wa,{}),onClick:()=>{e("/exhibitor/dashboard"),a(!1)},children:"Dashboard"}),n.jsx(ea,{type:"default",icon:n.jsx(za,{}),onClick:v,children:"Logout"})]}):n.jsxs(n.Fragment,{children:[n.jsx(ea,{type:"primary",style:{background:"#7E57C2",borderColor:"#7E57C2"},icon:n.jsx(Ed,{}),onClick:()=>{k(),a(!1)},children:"Exhibitor Login"}),n.jsx(ea,{type:"default",icon:n.jsx($a,{}),onClick:()=>{T(),a(!1)},children:"Register as Exhibitor"})]})})]})}),n.jsx(ky,{loginModalVisible:x,registerModalVisible:o,setRegisterModalVisible:l,setExhibitorCredentials:A=>t(dc(A)),onForgotPassword:m}),n.jsx(Cy,{visible:g})]})},{Footer:zy}=Et,{Title:Wy,Paragraph:qy,Text:Vy}=Ue,Hy=be(zy)`
  background: linear-gradient(to right, #242a38, #1a1f2c);
  padding: 60px 0 20px;
  color: rgba(255, 255, 255, 0.8);

  @media (max-width: 768px) {
    padding: 40px 0 20px;
  }
`,Gy=be.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,ta=be(Wy)`
  color: white !important;
  font-size: 18px !important;
  margin-bottom: 20px !important;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -8px;
    width: 40px;
    height: 3px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,Yy=be.div`
  margin-bottom: 20px;
`,Xy=be.img`
  height: auto;
  width: 100%;
  max-width: 160px;
  margin-bottom: 16px;
`,Qr=be(Cr)`
  color: rgba(255, 255, 255, 0.8);
  display: block;
  margin-bottom: 12px;
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateX(5px);
  }
`,il=be.div`
  display: flex;
  margin-bottom: 16px;
  align-items: flex-start;
`,sl=be.div`
  margin-right: 10px;
  color: #4158D0;
`,ra=be.a`
  font-size: 24px;
  margin-right: 16px;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
  
  &:hover {
    color: white;
    transform: translateY(-3px);
  }
`,Ky=be(Re)`
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }
  
  &:focus {
    border-color: #4158D0;
    box-shadow: 0 0 0 2px rgba(65, 88, 208, 0.2);
  }
`,Qy=be(fe)`
  background: linear-gradient(90deg, #4158D0, #C850C0);
  border: none;
  
  &:hover {
    opacity: 0.9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
`,Jy=be(Vy)`
  display: block;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
  margin-top: 20px;
  font-size: 14px;
`,Zy=be(Tt)`
  background: rgba(255, 255, 255, 0.1);
  margin: 30px 0;
`,N0=()=>{const[e,t]=N.useState("/logo.png"),[r,i]=N.useState("Exhibition Manager"),s=new Date().getFullYear();return N.useEffect(()=>{const a=`${Pe.defaults.baseURL}/public/logo`;t(a),fetch(`${Pe.defaults.baseURL}/public/site-info`).then(o=>o.json()).then(o=>{o.siteName&&i(o.siteName)}).catch(o=>{console.error("Error fetching site info:",o)})},[]),n.jsx(Hy,{children:n.jsxs(Gy,{children:[n.jsxs(ze,{gutter:[48,40],children:[n.jsxs(ae,{xs:24,sm:24,md:8,lg:7,children:[n.jsx(Yy,{children:n.jsx(Cr,{to:"/",children:n.jsx(Xy,{src:e,alt:r,onError:()=>t("/logo.png")})})}),n.jsx(qy,{style:{color:"rgba(255, 255, 255, 0.7)",marginBottom:24},children:"The premier platform for exhibition stall booking. Connect exhibitors with event organizers and simplify the booking process."}),n.jsxs(ke,{children:[n.jsx(ra,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(lx,{})}),n.jsx(ra,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(cx,{})}),n.jsx(ra,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(dx,{})}),n.jsx(ra,{href:"#",target:"_blank",rel:"noopener noreferrer",children:n.jsx(ux,{})})]})]}),n.jsxs(ae,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(ta,{level:4,children:"Quick Links"}),n.jsx(Qr,{to:"/exhibitions",children:"Exhibitions"}),n.jsx(Qr,{to:"/about",children:"About Us"}),n.jsx(Qr,{to:"/contact",children:"Contact Us"}),n.jsx(Qr,{to:"/privacy-policy",children:"Privacy Policy"}),n.jsx(Qr,{to:"/terms",children:"Terms & Conditions"})]}),n.jsxs(ae,{xs:24,sm:12,md:5,lg:5,children:[n.jsx(ta,{level:4,children:"For Exhibitors"}),n.jsx(Qr,{to:"/exhibitor/login",children:"Login"}),n.jsx(Qr,{to:"/exhibitor/register",children:"Register"}),n.jsx(Qr,{to:"/exhibitor/dashboard",children:"Dashboard"}),n.jsx(Qr,{to:"/exhibitor/bookings",children:"My Bookings"}),n.jsx(Qr,{to:"/faq",children:"FAQ"})]}),n.jsxs(ae,{xs:24,sm:24,md:6,lg:7,children:[n.jsx(ta,{level:4,children:"Contact Us"}),n.jsxs(il,{children:[n.jsx(sl,{children:n.jsx(Ri,{})}),n.jsx("div",{children:"123 Exhibition Street, New Delhi, India"})]}),n.jsxs(il,{children:[n.jsx(sl,{children:n.jsx(jc,{})}),n.jsx("div",{children:"+91 98765 43210"})]}),n.jsxs(il,{children:[n.jsx(sl,{children:n.jsx(Ln,{})}),n.jsx("div",{children:"info@exhibitionmanager.com"})]}),n.jsxs("div",{style:{marginTop:24},children:[n.jsx(ta,{level:4,children:"Newsletter"}),n.jsx(oe,{children:n.jsxs(ke.Compact,{style:{width:"100%"},children:[n.jsx(Ky,{placeholder:"Your email address"}),n.jsx(Qy,{type:"primary",icon:n.jsx(hx,{}),children:"Subscribe"})]})})]})]})]}),n.jsx(Zy,{}),n.jsxs(Jy,{children:["© ",s," ",r,". All rights reserved."]})]})})},ik=(e,t)=>{if(!e)return"";let i=`/exhibition/${e.slug||e._id||e.id}`;return t&&(i+=`/${t}`),i},F0=(e,t)=>e?`/exhibitions/${e.slug||e._id||e.id}`:"",{Title:Ut,Paragraph:Bt,Text:na}=Ue,{Content:ev}=Et,tv=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;return t.includes("logos/")||t.includes("sponsors/")?`${Pe.defaults.baseURL}/public/images/${t}`:"/exhibition-placeholder.jpg"},rv=be(ev)`
  padding-top: 64px;
`,nv=be.div`
  background: linear-gradient(135deg, #4158D0 0%, #C850C0 46%, #FFCC70 100%);
  padding: 80px 0;
  color: white;
  position: relative;
  overflow: hidden;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
`,iv=be.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  z-index: 1;
`,sv=be.div`
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
`,ui=be(Ae)`
  height: 100%;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,av=be(Ae)`
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  margin-bottom: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: none;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,Ji=be(Ut)`
  position: relative;
  display: inline-block;
  margin-bottom: 48px !important;
  
  &:after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 0;
    width: 60px;
    height: 4px;
    border-radius: 2px;
    background: linear-gradient(90deg, #4158D0, #C850C0);
  }
`,hi=be.div`
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin-bottom: 24px;
  font-size: 24px;
  
  & svg {
    font-size: 28px;
  }
`,ia=be.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  height: 100%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  }
`,tu=be.div`
  background: white;
  border-radius: 12px;
  padding: 30px;
  margin: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
`,ov=be(Ne)`
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10;
  font-weight: 500;
  padding: 4px 12px;
  border-radius: 50px;
`,ru=be(fe)`
  height: 50px;
  font-weight: 500;
  border-radius: 8px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  
  &.ant-btn-primary {
    background: linear-gradient(90deg, #4158D0, #C850C0);
    border: none;
    
    &:hover {
      background: linear-gradient(90deg, #3a4ec0, #b745af);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
  
  &.secondary-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #4158D0;
    border: none;
    
    &:hover {
      background: white;
      color: #C850C0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
  }
`,Zi=be.div`
  padding: 80px 0;
  
  @media (max-width: 768px) {
    padding: 60px 0;
  }
  
  &.gray-bg {
    background: #f9fafb;
  }
  
  &.how-it-works {
    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
  }
`;be.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #4158D0, #C850C0);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 16px;
  font-size: 18px;
  flex-shrink: 0;
`;const lv=()=>{const e=tr(),t=hr(),[r,i]=N.useState([]),[s,a]=N.useState(!0);N.useEffect(()=>{(async()=>{try{a(!0);const u=await Ir.getExhibitions();i(u.data.slice(0,4))}catch(u){console.error("Failed to fetch exhibitions:",u)}finally{a(!1)}})()},[]);const o=c=>{const u={year:"numeric",month:"short",day:"numeric"};return new Date(c).toLocaleDateString(void 0,u)},l=(c,u)=>{const f=new Date,h=new Date(c),p=new Date(u);return f<h?{status:"Upcoming",color:"#722ED1"}:f>p?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},d=()=>{t(Zn(void 0))};return n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsxs(rv,{children:[n.jsxs(nv,{children:[n.jsx(iv,{}),n.jsx(sv,{children:n.jsxs(ze,{gutter:[48,48],align:"middle",children:[n.jsxs(ae,{xs:24,lg:14,children:[n.jsx(Ut,{level:1,style:{fontSize:"3.5rem",marginBottom:24,color:"white",fontWeight:700},children:"Book Your Exhibition Space with Ease"}),n.jsx(Bt,{style:{fontSize:"1.2rem",marginBottom:40,color:"rgba(255, 255, 255, 0.9)"},children:"Explore upcoming exhibitions, select your perfect stall, and secure your spot all in one place. Manage your exhibition presence effortlessly."}),n.jsx(ke,{size:16,wrap:!0,children:n.jsx(ru,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(Jl,{}),children:"Explore Exhibitions"})})]}),n.jsx(ae,{xs:24,lg:10,children:n.jsx("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",alt:"Exhibition Space",style:{width:"100%",borderRadius:"12px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.2)",border:"4px solid rgba(255, 255, 255, 0.2)",objectFit:"cover",height:"300px"},onError:c=>{const u=c.target;u.src="https://images.unsplash.com/photo-1559223607-a43f990c43d5?auto=format&fit=crop&q=80&w=1000&ixlib=rb-4.0.3",u.onerror=()=>{u.style.height="300px",u.style.background="linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",u.onerror=null;const f=u.parentElement;if(f){const h=document.createElement("div");h.style.position="absolute",h.style.top="50%",h.style.left="50%",h.style.transform="translate(-50%, -50%)",h.style.color="white",h.style.fontSize="18px",h.style.fontWeight="bold",h.style.textAlign="center",h.textContent="Exhibition Venue",f.appendChild(h)}}}})})]})})]}),n.jsx(Zi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(Ji,{level:2,children:"Featured Exhibitions"}),s?n.jsx(ze,{gutter:[24,24],children:[1,2,3,4].map(c=>n.jsx(ae,{xs:24,sm:12,lg:6,children:n.jsx(Ae,{style:{borderRadius:"12px"},children:n.jsx(vn,{active:!0,avatar:!0,paragraph:{rows:3}})})},c))}):r.length>0?n.jsx(ze,{gutter:[24,24],children:r.map((c,u)=>{const{status:f,color:h}=l(c.startDate,c.endDate);return n.jsx(ae,{xs:24,sm:12,lg:6,children:n.jsxs(av,{onClick:()=>e(F0(c)),cover:n.jsxs("div",{style:{height:200,overflow:"hidden",position:"relative"},children:[n.jsx("img",{alt:c.name,src:c.headerLogo?tv(c.headerLogo):"/exhibition-placeholder.jpg",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0.95)"}}),n.jsx(Ne,{color:h,style:{position:"absolute",top:12,left:12,borderRadius:"50px",padding:"2px 12px"},children:f}),u===0&&n.jsx(ov,{color:"#f50",children:"Featured"})]}),hoverable:!0,children:[n.jsx(Ut,{level:5,ellipsis:{rows:1},style:{marginBottom:8},children:c.name}),n.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[n.jsx(cn,{style:{color:"#4158D0"}}),n.jsxs(na,{type:"secondary",style:{fontSize:13},children:[o(c.startDate)," - ",o(c.endDate)]})]}),c.venue&&n.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(Ri,{style:{color:"#C850C0"}}),n.jsx(na,{type:"secondary",style:{fontSize:13},ellipsis:!0,children:c.venue})]}),n.jsx(fe,{type:"link",style:{padding:0,height:"auto"},icon:n.jsx(Jl,{}),children:"View Details"})]})},c._id)})}):n.jsx("div",{style:{textAlign:"center",padding:40},children:n.jsx(Bt,{children:"No exhibitions available at the moment. Check back soon!"})}),n.jsx("div",{style:{textAlign:"center",marginTop:40},children:n.jsx(fe,{type:"primary",size:"large",onClick:()=>e("/exhibitions"),icon:n.jsx(fx,{}),children:"View All Exhibitions"})})]})}),n.jsx(Zi,{className:"how-it-works",children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(Ji,{level:2,children:"How to Book Stall"}),n.jsx("div",{style:{textAlign:"center",maxWidth:"800px",margin:"0 auto 40px"},children:n.jsx(Bt,{style:{fontSize:"18px",color:"#666",fontWeight:500},children:"Secure your exhibition space in just a few simple steps. Our streamlined booking process makes it easy to showcase your business at premier events."})}),n.jsxs("div",{className:"booking-steps",children:[n.jsx("div",{className:"step-indicator",children:n.jsxs("div",{className:"step-dots",children:[[1,2,3,4,5,6,7].map(c=>n.jsxs("div",{className:"step-dot-container",children:[n.jsx("div",{className:"step-dot",children:c}),n.jsx("div",{className:"step-label",children:`Step ${c}`})]},c)),n.jsx("div",{className:"step-progress-line"})]})}),n.jsxs(ze,{gutter:[24,24],style:{marginTop:40},children:[n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx(jt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Register"}),n.jsx(Bt,{children:"The exhibitor must first register on the platform with company details and contact information."})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx(Nt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Approval"}),n.jsx(Bt,{children:"After registration, the admin will review and approve your account. You'll receive a notification."})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx($r,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Login & Book Stall"}),n.jsx(Bt,{children:"Once approved, log in and select a stall from the interactive layout map."})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"4"}),n.jsx("div",{className:"step-icon",children:n.jsx(br,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Goes to Reserved"}),n.jsx(Bt,{children:'After booking, the stall status changes to "Reserved" and will be temporarily held for you.'})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"5"}),n.jsx("div",{className:"step-icon",children:n.jsx(Nt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Admin Final Approval"}),n.jsx(Bt,{children:"The admin will review your reservation request and approve it based on availability."})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"6"}),n.jsx("div",{className:"step-icon",children:n.jsx(Nt,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Stall Becomes Booked"}),n.jsx(Bt,{children:'After admin approval, the stall status changes to "Booked" and an invoice is generated.'})]})]})}),n.jsx(ae,{xs:24,md:12,lg:8,xl:6,children:n.jsxs("div",{className:"step-card",children:[n.jsxs("div",{className:"step-card-header",children:[n.jsx("div",{className:"step-number",children:"7"}),n.jsx("div",{className:"step-icon",children:n.jsx(_d,{})})]}),n.jsxs("div",{className:"step-card-body",children:[n.jsx(Ut,{level:5,children:"Make Payment in 3 Days"}),n.jsx(Bt,{children:"Complete your payment within 3 days of booking to confirm your stall reservation."})]})]})})]}),n.jsx("style",{children:`
                  .booking-steps {
                    margin-top: 20px;
                  }
                  
                  .step-indicator {
                    margin-bottom: 30px;
                    padding: 0 40px;
                  }
                  
                  .step-dots {
                    display: flex;
                    justify-content: space-between;
                    position: relative;
                    max-width: 800px;
                    margin: 0 auto;
                  }
                  
                  .step-progress-line {
                    position: absolute;
                    top: 25px;
                    left: 50px;
                    right: 50px;
                    height: 3px;
                    background: linear-gradient(90deg, #4158D0, #C850C0);
                    z-index: 0;
                  }
                  
                  .step-dot-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    position: relative;
                    z-index: 1;
                  }
                  
                  .step-dot {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 20px;
                    margin-bottom: 8px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                  }
                  
                  .step-label {
                    font-size: 14px;
                    font-weight: 500;
                    color: #666;
                  }
                  
                  .step-card {
                    background: white;
                    border-radius: 12px;
                    overflow: hidden;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    height: 100%;
                    transition: all 0.3s ease;
                    display: flex;
                    flex-direction: column;
                    border: 1px solid #f0f0f0;
                  }
                  
                  .step-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
                  }
                  
                  .step-card-header {
                    background: linear-gradient(135deg, #f6f9fc 0%, #f1f4f9 100%);
                    padding: 16px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    border-bottom: 1px solid #f0f0f0;
                  }
                  
                  .step-number {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #4158D0, #C850C0);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    font-size: 16px;
                  }
                  
                  .step-icon {
                    width: 36px;
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 20px;
                    color: #4158D0;
                  }
                  
                  .step-card-body {
                    padding: 16px;
                    flex: 1;
                  }
                  
                  .step-card-body h5 {
                    margin-bottom: 8px;
                  }
                  
                  .step-card-body p {
                    margin-bottom: 0;
                    color: #666;
                  }
                  
                  @media (max-width: 768px) {
                    .step-progress-line {
                      display: none;
                    }
                    
                    .step-dots {
                      display: none;
                    }
                  }
                `})]}),n.jsx("div",{style:{textAlign:"center",marginTop:60},children:n.jsx(ru,{type:"primary",size:"large",onClick:d,icon:n.jsx(jt,{}),children:"Register as Exhibitor"})})]})}),n.jsx(Zi,{children:n.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:[n.jsx(Ji,{level:2,children:"Why Choose Us"}),n.jsxs(ze,{gutter:[24,24],children:[n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(65, 88, 208, 0.1)",color:"#4158D0"},children:n.jsx(Ec,{})}),n.jsx(Ut,{level:4,children:"Interactive Layouts"}),n.jsx(Bt,{style:{fontSize:16},children:"Explore detailed exhibition floor plans with interactive maps to find your perfect spot."})]})}),n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(200, 80, 192, 0.1)",color:"#C850C0"},children:n.jsx($r,{})}),n.jsx(Ut,{level:4,children:"Real-time Availability"}),n.jsx(Bt,{style:{fontSize:16},children:"See stall availability in real-time and book instantly without any delays or confusion."})]})}),n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(255, 204, 112, 0.1)",color:"#FFCC70"},children:n.jsx(_d,{})}),n.jsx(Ut,{level:4,children:"Secure Payments"}),n.jsx(Bt,{style:{fontSize:16},children:"Complete your bookings with our secure payment gateway and receive instant confirmation."})]})}),n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(82, 196, 26, 0.1)",color:"#52c41a"},children:n.jsx(wc,{})}),n.jsx(Ut,{level:4,children:"Exhibitor Dashboard"}),n.jsx(Bt,{style:{fontSize:16},children:"Manage all your bookings, payments, and exhibition details through our user-friendly dashboard."})]})}),n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(250, 140, 22, 0.1)",color:"#fa8c16"},children:n.jsx(cn,{})}),n.jsx(Ut,{level:4,children:"Schedule Management"}),n.jsx(Bt,{style:{fontSize:16},children:"Keep track of important dates, setup times, and exhibition schedules all in one place."})]})}),n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(ui,{children:[n.jsx(hi,{style:{background:"rgba(24, 144, 255, 0.1)",color:"#1890ff"},children:n.jsx(Nt,{})}),n.jsx(Ut,{level:4,children:"Support & Assistance"}),n.jsx(Bt,{style:{fontSize:16},children:"Get expert assistance throughout the booking process and during the exhibition."})]})})]})]})}),n.jsx(Zi,{className:"gray-bg",children:n.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 24px"},children:n.jsxs(ze,{gutter:[48,48],children:[n.jsxs(ae,{xs:24,lg:12,children:[n.jsx(Ji,{level:2,children:"Our Impact"}),n.jsxs(ze,{gutter:[24,24],children:[n.jsx(ae,{xs:12,children:n.jsx(ia,{children:n.jsx(Pt,{title:"Exhibitions",value:100,suffix:"+",valueStyle:{color:"#4158D0",fontWeight:"bold"}})})}),n.jsx(ae,{xs:12,children:n.jsx(ia,{children:n.jsx(Pt,{title:"Exhibitors",value:5e3,suffix:"+",valueStyle:{color:"#C850C0",fontWeight:"bold"}})})}),n.jsx(ae,{xs:12,children:n.jsx(ia,{children:n.jsx(Pt,{title:"Stalls Booked",value:12e3,suffix:"+",valueStyle:{color:"#FFCC70",fontWeight:"bold"}})})}),n.jsx(ae,{xs:12,children:n.jsx(ia,{children:n.jsx(Pt,{title:"Cities",value:25,suffix:"+",valueStyle:{color:"#52c41a",fontWeight:"bold"}})})})]})]}),n.jsxs(ae,{xs:24,lg:12,children:[n.jsx(Ji,{level:2,children:"What Exhibitors Say"}),n.jsxs(px,{autoplay:!0,dots:{className:"custom-carousel-dots"},children:[n.jsx("div",{children:n.jsxs(tu,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Kn,{size:64,icon:n.jsx(jt,{}),style:{backgroundColor:"#4158D0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Sarah Johnson"}),n.jsx(na,{type:"secondary",children:"Tech Innovations Inc."})]})]}),n.jsx(Bt,{style:{fontSize:16},children:'"The booking process was seamless! I could view the layout, select my preferred spot, and complete payment all in one go. Will definitely use again for our next exhibition."'})]})}),n.jsx("div",{children:n.jsxs(tu,{children:[n.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[n.jsx(Kn,{size:64,icon:n.jsx(jt,{}),style:{backgroundColor:"#C850C0"}}),n.jsxs("div",{children:[n.jsx(Ut,{level:5,style:{margin:0},children:"Michael Chen"}),n.jsx(na,{type:"secondary",children:"Global Exhibits Ltd"})]})]}),n.jsx(Bt,{style:{fontSize:16},children:'"As a regular exhibitor, this platform has made my life so much easier. I love how I can see all my bookings and manage everything from one dashboard."'})]})})]})]})]})})}),n.jsx(Zi,{style:{padding:"60px 0"},children:n.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"40px 24px",background:"linear-gradient(135deg, #4158D0 0%, #C850C0 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[n.jsx(Ut,{level:2,style:{color:"white",marginBottom:16},children:"Ready to Showcase Your Business?"}),n.jsx(Bt,{style:{fontSize:"1.2rem",marginBottom:32,color:"rgba(255, 255, 255, 0.9)"},children:"Join thousands of successful exhibitors and book your perfect stall today"}),n.jsxs(ke,{size:16,wrap:!0,style:{justifyContent:"center"},children:[n.jsx(fe,{size:"large",style:{height:"50px",background:"white",color:"#4158D0",border:"none",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:()=>e("/exhibitions"),icon:n.jsx($r,{}),children:"Browse Exhibitions"}),n.jsx(fe,{size:"large",style:{height:"50px",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"2px solid white",borderRadius:"8px",fontWeight:500,paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center"},onClick:d,icon:n.jsx(jt,{}),children:"Register as Exhibitor"})]})]})})]}),n.jsx(N0,{})]})};let cv=class extends _t.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Error caught by boundary:",t,r)}render(){var t;return this.state.hasError?n.jsx(ps,{status:"error",title:"Something went wrong",subTitle:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred",extra:[n.jsx(fe,{type:"primary",onClick:()=>window.location.href="/dashboard",children:"Go to Dashboard"},"home"),n.jsx(fe,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")]}):this.props.children}};const nu=({width:e,height:t,scale:r=1,position:i={x:0,y:0},isSelected:s=!1,onSelect:a=()=>{},onChange:o=()=>{},children:l,isEditable:d=!0})=>{const c=f=>{d&&(a(),f.cancelBubble=!0)},u=_t.useMemo(()=>{const f=[];for(let p=0;p<=e;p+=5)f.push(n.jsx(Ga,{points:[p,0,p,t],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`v${p}`));for(let p=0;p<=t;p+=5)f.push(n.jsx(Ga,{points:[0,p,e,p],stroke:"#e8e8e8",strokeWidth:1/r,dash:[5/r]},`h${p}`));return f},[e,t,r]);return n.jsxs(Pi,{x:i.x,y:i.y,width:e,height:t,onClick:c,children:[n.jsx(mo,{width:e,height:t,fill:"#ffffff",stroke:s&&d?"#1890ff":"#d9d9d9",strokeWidth:s&&d?2/r:1/r,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/r,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/r}),n.jsx(Pi,{children:u}),n.jsx(gs,{text:`${e}m × ${t}m`,fontSize:14/r,fill:"#666666",x:5,y:5}),l]})},dv=({visible:e,width:t,height:r,onCancel:i,onSubmit:s})=>{const[a]=oe.useForm();_t.useEffect(()=>{e&&a.setFieldsValue({width:t,height:r})},[e,t,r,a]);const o=()=>{a.validateFields().then(l=>{s(l),a.resetFields()})};return n.jsx(pt,{title:"Edit Exhibition Space",open:e,onCancel:()=>{a.resetFields(),i()},onOk:o,destroyOnClose:!0,children:n.jsxs(oe,{form:a,layout:"vertical",initialValues:{width:t,height:r},children:[n.jsx(oe.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:n.jsx(Mr,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),n.jsx(oe.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:n.jsx(Mr,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},R0=({hall:e,isSelected:t=!1,onSelect:r,onChange:i,scale:s=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isStallMode:d=!1})=>{const c=_t.useRef(null),u=_t.useRef(null),f=_t.useMemo(()=>{const v=[],{width:k,height:T}=e.dimensions,m=1;for(let w=0;w<=k;w+=m)v.push(n.jsx(Ga,{points:[w,0,w,T],stroke:"#ddd",strokeWidth:1/s,dash:[2/s,2/s],listening:!1},`v${w}`));for(let w=0;w<=T;w+=m)v.push(n.jsx(Ga,{points:[0,w,k,w],stroke:"#ddd",strokeWidth:1/s,dash:[2/s,2/s],listening:!1},`h${w}`));return v},[e.dimensions.width,e.dimensions.height,s]);_t.useEffect(()=>{var v;t&&u.current&&c.current&&(u.current.nodes([c.current]),(v=u.current.getLayer())==null||v.batchDraw())},[t]);const h=v=>{v.cancelBubble=!0;const k=v.target,T=k.x(),m=k.y(),w=Math.max(0,Math.min(T,o-e.dimensions.width)),E=Math.max(0,Math.min(m,l-e.dimensions.height));k.x(Math.round(w)),k.y(Math.round(E))},p=v=>{v.cancelBubble=!0;const k=v.target,T=Math.max(0,Math.min(k.x(),o-e.dimensions.width)),m=Math.max(0,Math.min(k.y(),l-e.dimensions.height));i==null||i({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{...e.dimensions,x:Math.round(T),y:Math.round(m)}})},y=v=>{v.cancelBubble=!0},x=v=>{if(!c.current)return;const k=c.current,T=k.scaleX(),m=k.scaleY();k.scaleX(1),k.scaleY(1);const w=Math.round(k.width()*T),E=Math.round(k.height()*m),b=k.x(),_=k.y(),A=Math.max(0,Math.min(b,o-w)),S=Math.max(0,Math.min(_,l-E));i==null||i({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{x:A,y:S,width:Math.max(5,Math.min(w,o-A)),height:Math.max(5,Math.min(E,l-S))}})},g=v=>{v.cancelBubble=!0,r==null||r(e)};return n.jsxs(Pi,{ref:c,x:e.dimensions.x,y:e.dimensions.y,width:e.dimensions.width,height:e.dimensions.height,draggable:!d&&!!i,onClick:g,onTap:g,onDragStart:y,onDragMove:h,onDragEnd:p,onTransformEnd:x,children:[n.jsx(mo,{width:e.dimensions.width,height:e.dimensions.height,fill:"#ffffff",stroke:t?"#1890ff":"#d9d9d9",strokeWidth:t?2/s:1/s,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/s,shadowOffset:{x:2/s,y:2/s},shadowOpacity:.5}),n.jsx(Pi,{children:f}),n.jsx(gs,{text:e.name,fontSize:14/s,fill:"#000000",width:e.dimensions.width,align:"center",y:e.dimensions.height/2-7/s})]})},uv=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${r}?token=${i}`:""},P0=({fixture:e,isSelected:t=!1,onSelect:r,onChange:i,scale:s=1,position:a={x:0,y:0},exhibitionWidth:o=100,exhibitionHeight:l=100,isEditable:d=!0})=>{const c=_t.useRef(null),u=_t.useRef(null),[f,h]=N.useState("");N.useEffect(()=>{if(e.icon){const m=uv(e.icon);h(m)}else h("")},[e.icon]);const[p]=Gx(f);_t.useEffect(()=>{var m;t&&u.current&&c.current&&(u.current.nodes([c.current]),(m=u.current.getLayer())==null||m.batchDraw())},[t]);const y=m=>{m.cancelBubble=!0},x=m=>{m.cancelBubble=!0;const w=m.target,E=w.x(),b=w.y(),_=Math.max(0,Math.min(E,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height));w.x(Math.round(_)),w.y(Math.round(A))},g=m=>{m.cancelBubble=!0;const w=m.target,E=w.x(),b=w.y(),_=Math.max(0,Math.min(E,o-e.dimensions.width)),A=Math.max(0,Math.min(b,l-e.dimensions.height)),S=e._id||e.id;i==null||i({...e,_id:S,id:S,exhibitionId:e.exhibitionId,position:{x:Math.round(_),y:Math.round(A)}})},v=m=>{if(!c.current)return;const w=c.current,E=w.scaleX(),b=w.scaleY(),_=w.rotation();w.scaleX(1),w.scaleY(1);const A=Math.round(e.dimensions.width*E),S=Math.round(e.dimensions.height*b),j=w.x(),C=w.y(),P=Math.max(0,Math.min(j,o-A)),M=Math.max(0,Math.min(C,l-S)),X=e._id||e.id;i==null||i({...e,_id:X,id:X,exhibitionId:e.exhibitionId,position:{x:P,y:M},dimensions:{width:Math.max(.5,Math.min(A,o-P)),height:Math.max(.5,Math.min(S,l-M))},rotation:_})},k=m=>{m.cancelBubble=!0,r==null||r(e)},T=()=>{const m=e.borderColor||(t?"#1890ff":"#d9d9d9"),w=e.borderRadius!==void 0?e.borderRadius/s:3/s;return p?n.jsx(Xx,{image:p,width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#ffffff",stroke:m,strokeWidth:t?2/s:1/s,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/s,shadowOffset:{x:2/s,y:2/s},shadowOpacity:.5}):n.jsx(mo,{width:e.dimensions.width,height:e.dimensions.height,fill:e.color||"#f0f2f5",stroke:m,strokeWidth:t?2/s:1/s,cornerRadius:w,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/s,shadowOffset:{x:2/s,y:2/s},shadowOpacity:.5})};return n.jsxs(n.Fragment,{children:[n.jsxs(Pi,{ref:c,x:e.position.x,y:e.position.y,width:e.dimensions.width,height:e.dimensions.height,rotation:e.rotation||0,draggable:d&&!!i,onClick:k,onTap:k,onDragStart:y,onDragMove:x,onDragEnd:g,onTransformEnd:v,children:[T(),e.name&&e.showName!==!1&&n.jsx(gs,{text:e.name,fontSize:12/s,fill:"#000000",width:e.dimensions.width,align:"center",y:-16/s})]}),t&&d&&n.jsx(Yx,{ref:u,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(m,w)=>w.width<.5||w.height<.5?m:w})]})},hv=({visible:e,x:t,y:r,onExhibitionClick:i,onHallClick:s,onStallClick:a,onFixtureClick:o,onClose:l})=>{if(!e)return null;const d=[{key:"exhibition",icon:n.jsx(Ec,{}),label:"Exhibition Space",onClick:()=>{i(),l()}},{key:"hall",icon:n.jsx(Fs,{}),label:"Add Hall",onClick:()=>{s(),l()}}];return a&&d.push({key:"stall",icon:n.jsx($r,{}),label:"Add Stall",onClick:()=>{a(),l()}}),o&&d.push({key:"fixture",icon:n.jsx(bc,{}),label:"Add Fixture",onClick:()=>{o(),l()}}),n.jsx("div",{style:{position:"fixed",top:r,left:t,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:n.jsx(cr,{items:d})})},fv=({stall:e,isSelected:t=!1,onSelect:r,onChange:i,hallWidth:s=0,hallHeight:a=0,hallX:o=0,hallY:l=0,scale:d=1,isDragging:c=!1})=>{const u=N.useRef(null),[f,h]=N.useState(!1),[p,y]=N.useState(!1),[x,g]=N.useState(!1);N.useEffect(()=>{g(window.innerWidth<768);const X=()=>{g(window.innerWidth<768)};return window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]),N.useEffect(()=>{if(f&&!c)y(!0);else if(c)y(!1);else{const X=setTimeout(()=>{y(!1)},100);return()=>clearTimeout(X)}},[f,c]),N.useEffect(()=>{if(f&&u.current&&!c){if(x&&!t)return;u.current.getStage()&&u.current.moveToTop()}},[f,t,x,c]);const v=t||e.isSelected,k=N.useCallback(X=>{switch(X){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}},[]),T=N.useCallback(X=>{switch(X){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}},[]),m=N.useCallback(X=>{X.cancelBubble=!0;const ee=X.target,q=ee.x()-o,K=ee.y()-l,Q=Math.max(0,Math.min(q,s-e.dimensions.width)),ie=Math.max(0,Math.min(K,a-e.dimensions.height));ee.x(Math.round(Q+o)),ee.y(Math.round(ie+l))},[o,l,s,a,e.dimensions.width,e.dimensions.height]),w=N.useCallback(X=>{if(X.cancelBubble=!0,!i)return;const ee=X.target,q=ee.x()-o,K=ee.y()-l,Q=Math.max(0,Math.min(q,s-e.dimensions.width)),ie=Math.max(0,Math.min(K,a-e.dimensions.height));i({...e,id:e.id||e._id,_id:e._id||e.id,dimensions:{...e.dimensions,x:Math.round(Q),y:Math.round(ie)}})},[i,o,l,s,a,e]),E=N.useCallback(X=>{X.cancelBubble=!0},[]),b=N.useCallback(X=>{X.cancelBubble=!0,r&&!c&&r()},[r,c]),_=N.useCallback(()=>{x&&!v||c||h(!0)},[x,v,c]),A=N.useCallback(()=>{h(!1)},[]),S={x:0,y:0,width:10,height:10},j=e.dimensions||S,C=e.typeName||"Standard";e.ratePerSqm*j.width*j.height;const P=0,M=N.useMemo(()=>e.status!=="available"&&e.companyName?`${C} - ${j.width}×${j.height}m - ${e.companyName}`:`${C} - ${j.width}×${j.height}m`,[C,j.width,j.height,e.status,e.companyName]);return n.jsxs(Pi,{ref:u,x:j.x+o,y:j.y+l,width:j.width,height:j.height,draggable:!!i,onClick:b,onTap:b,onDragStart:E,onDragMove:m,onDragEnd:w,opacity:e.status==="available"?1:.7,cursor:e.status==="available"?"pointer":"default",onMouseEnter:_,onMouseLeave:A,listening:c?!1:!x||e.status==="available",transformsEnabled:c||x?"position":"all",children:[n.jsx(mo,{width:j.width,height:j.height,fill:v?"rgba(24, 144, 255, 0.1)":T(e.status),stroke:v?"#1890ff":k(e.status),strokeWidth:v?2/d:1/d,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:c?0:x?2:3,shadowOffset:{x:1,y:1},shadowOpacity:c?0:.3,rotation:P,perfectDrawEnabled:!c,transformsEnabled:c?"position":"all",cornerRadius:.05}),n.jsx(gs,{text:e.number,fontSize:Math.min(j.width,j.height)*.25,fill:"#000000",width:j.width,height:j.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!c,fontStyle:"bold",listening:!1}),v&&!c&&n.jsx(Kx,{x:j.width-2,y:2,radius:Math.min(.8,j.width*.05),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/d,transformsEnabled:"position",listening:!1}),p&&!c&&n.jsxs(Qx,{x:j.width/2,y:0,opacity:1,listening:!1,children:[n.jsx(Jx,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),n.jsx(gs,{text:M,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(M.length*.7,25),height:3,verticalAlign:"middle",listening:!1})]})]})},D0=N.memo(fv),pv=({width:e,height:t,exhibitionWidth:r=100,exhibitionHeight:i=100,halls:s=[],stalls:a=[],fixtures:o=[],selectedHall:l=null,selectedFixture:d=null,onSelectHall:c=()=>{},onSelectFixture:u=()=>{},onHallChange:f=()=>{},onFixtureChange:h=()=>{},onExhibitionChange:p=()=>{},onAddHall:y=()=>{},onAddStall:x=()=>{},onAddFixture:g=()=>{},children:v,isStallMode:k=!1,isFixtureMode:T=!1,isPublicView:m=!1})=>{const w=N.useRef(null),E=N.useRef(null),b=N.useRef(null),[_,A]=N.useState(1),[S,j]=N.useState({x:0,y:0}),[C,P]=N.useState(!1),[M,X]=N.useState(!1),[ee,q]=N.useState({visible:!1,x:0,y:0}),[K,Q]=N.useState(!1),[ie,Z]=N.useState(!1),[R,U]=N.useState(!1),[O,I]=N.useState(void 0);N.useEffect(()=>{const Ie=()=>{U(window.innerWidth<768)};return Ie(),window.addEventListener("resize",Ie),()=>{window.removeEventListener("resize",Ie)}},[]);const W=N.useCallback(Ie=>{if(Ie.evt.preventDefault(),!w.current)return;const Be=w.current,Ve=_,Le=Be.getPointerPosition(),Oe={x:(Le.x-Be.x())/Ve,y:(Le.y-Be.y())/Ve},Qe=1.15,gt=Ie.evt.deltaY<0?Ve*Qe:Ve/Qe,Er=Math.min(Math.max(.1,gt),20),Cn={x:Le.x-Oe.x*Er,y:Le.y-Oe.y*Er};A(Er),j(Cn)},[_]),J=N.useCallback(()=>{if(!w.current)return;const Ie=w.current,Be=Math.min(_*1.15,20),Ve=Ie.width()/2,Le=Ie.height()/2,Oe={x:(Ve-S.x)/_,y:(Le-S.y)/_},Qe={x:Ve-Oe.x*Be,y:Le-Oe.y*Be};A(Be),j(Qe)},[_,S]),he=N.useCallback(()=>{if(!w.current)return;const Ie=w.current,Be=Math.max(_/1.15,.1),Ve=Ie.width()/2,Le=Ie.height()/2,Oe={x:(Ve-S.x)/_,y:(Le-S.y)/_},Qe={x:Ve-Oe.x*Be,y:Le-Oe.y*Be};A(Be),j(Qe)},[_,S]),ye=N.useCallback(Ie=>{Ie?(I(Xo.pixelRatio),Xo.pixelRatio=R?.8:1):O&&(Xo.pixelRatio=O)},[O,R]),H=N.useCallback(Ie=>{if(Ie.target===w.current&&(q({...ee,visible:!1}),X(!0),ye(!0),E.current)){if(m){const Be=R?{x:-10,y:-10,width:e+20,height:t+20}:void 0;E.current.cache(Be)}if(E.current.hitGraphEnabled(!1),m&&w.current){const Be=w.current.container();Be.style.cursor="grabbing",Be.classList.add("dragging"),w.current.batchDraw(),E.current.getChildren().forEach(Le=>{if(Le.shadowForStrokeEnabled&&(Le._savedShadowForStroke=Le.shadowForStrokeEnabled(),Le.shadowForStrokeEnabled(!1)),Le.perfectDrawEnabled&&(Le._savedPerfectDraw=Le.perfectDrawEnabled(),Le.perfectDrawEnabled(!1)),Le.cache&&!Le.isCached&&Le.width&&Le.height){Le._dragCached=!0;try{R?Le.cache({offset:10,pixelRatio:.8}):Le.cache()}catch{Le._dragCached=!1}}})}}},[ee,m,ye,R,e,t]),Y=N.useCallback(Ie=>{if(m&&Ie.target===w.current){if(Ie.evt&&Ie.evt._dragSkipUpdate)return;if(Ie.evt&&(Ie.evt._dragSkipUpdate=!0),w.current&&E.current){const Be=R?.85:.7;Math.random()>Be&&w.current.batchDraw()}return}Ie.target===w.current&&R&&E.current&&(Ie.cancelBubble=!0)},[R,m]),le=N.useCallback(Ie=>{if(Ie.target===w.current){if(j({x:Ie.target.x(),y:Ie.target.y()}),ye(!1),E.current&&(E.current.hitGraphEnabled(!0),m&&E.current.clearCache(),m&&w.current)){const Be=w.current.container();Be.style.cursor="",Be.classList.remove("dragging"),E.current.getChildren().forEach(Le=>{Le._savedShadowForStroke!==void 0&&(Le.shadowForStrokeEnabled(Le._savedShadowForStroke),delete Le._savedShadowForStroke),Le._savedPerfectDraw!==void 0&&(Le.perfectDrawEnabled(Le._savedPerfectDraw),delete Le._savedPerfectDraw),Le._dragCached&&(Le.clearCache(),delete Le._dragCached)})}setTimeout(()=>{w.current&&w.current.batchDraw()},50),X(!1)}},[m,ye]),de=N.useCallback(()=>{P(!0),document.body.style.cursor=M?"grabbing":"grab"},[M]),G=N.useCallback(()=>{P(!1),document.body.style.cursor="default"},[]),xe=Ie=>{var Ve,Le,Oe;const Be=Ie.target.getClassName();if(Be==="Stage"||Be==="Layer"){q({...ee,visible:!1});return}if(Be==="Group"||Be==="Rect"){c(null),u(null);const Qe=(Ve=w.current)==null?void 0:Ve.getPointerPosition();if(Qe&&ge(Qe)){const{x:gt,y:Er}=Qe,{x:Cn,y:Vs}=((Le=w.current)==null?void 0:Le.position())||{x:0,y:0},{x:Hs,y:Gs}=((Oe=w.current)==null?void 0:Oe.scale())||{x:1,y:1},qo=(gt-Cn)/Hs,Vo=(Er-Vs)/Gs;q({x:qo,y:Vo,visible:!0})}else q({...ee,visible:!1})}else q({...ee,visible:!1})},ge=Ie=>{if(!r||!i||!w.current)return!1;const{x:Be,y:Ve}=Ie,{x:Le,y:Oe}=w.current.position(),{x:Qe}=w.current.scale(),gt={x:(Be-Le)/Qe,y:(Ve-Oe)/Qe};return gt.x>=0&&gt.x<=r&&gt.y>=0&&gt.y<=i},me=N.useCallback(()=>{c(null),u(null),Q(!0),Z(!0),q({...ee,visible:!1})},[c,u,ee]),Te=N.useCallback(Ie=>{p(Ie),Z(!1)},[p]),ue=()=>{Q(!0),Z(!0),q({...ee,visible:!1})},Me=()=>{y(),q({...ee,visible:!1})},$e=()=>{x(),q({...ee,visible:!1})};N.useEffect(()=>{if(e>0&&t>0&&r>0&&i>0){const Ie=k?20:40,Be=e-Ie*2,Ve=t-Ie*2,Le=Be/r,Oe=Ve/i,gt=Math.min(Le,Oe),Er=(e-r*gt)/2,Cn=(t-i*gt)/2;A(gt),j({x:Er,y:Cn}),w.current&&w.current.batchDraw()}},[e,t,r,i,k]);const ct=_t.Children.map(v,Ie=>_t.isValidElement(Ie)?_t.cloneElement(Ie,{scale:_,position:S}):Ie),rt=n.jsx(nu,{width:r,height:i,scale:_,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return e<=0||t<=0||r<=0||i<=0?n.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:C?M?"grabbing":"grab":"default"},children:[n.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:n.jsxs(ke,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[n.jsx(fe,{icon:n.jsx(xx,{}),onClick:he,disabled:_<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),n.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(_*100),"%"]}),n.jsx(fe,{icon:n.jsx(mx,{}),onClick:J,disabled:_>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),n.jsxs(Zx,{ref:w,width:e,height:t,onClick:xe,draggable:!0,onDragStart:H,onDragMove:Y,onDragEnd:le,onMouseEnter:de,onMouseLeave:G,onWheel:W,x:S.x,y:S.y,scaleX:_,scaleY:_,perfectDrawEnabled:!M&&!m,hitGraphEnabled:!M,pixelRatio:M?R?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:m?R?5:3:0,children:[m&&n.jsx(em,{ref:b,listening:!1,children:rt}),n.jsxs(tm,{ref:E,imageSmoothingEnabled:!M||!m,children:[!m&&n.jsx(nu,{width:r,height:i,scale:_,position:{x:0,y:0},isSelected:K,onSelect:T?void 0:me,onChange:k||T?void 0:p,isEditable:!k&&!T}),s.map(Ie=>n.jsx(R0,{hall:Ie,isSelected:(l==null?void 0:l.id)===Ie.id,onSelect:()=>c(Ie),onChange:k||T?void 0:f,scale:_,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:i,isStallMode:k||T},Ie._id||Ie.id)),a.map(Ie=>{const Be=Ie._id||Ie.id,Ve=s.find(Le=>Le.id===Ie.hallId||Le._id===Ie.hallId);return Ve?n.jsx(D0,{stall:{...Ie,_id:Be,id:Be},hallX:Ve.dimensions.x,hallY:Ve.dimensions.y,hallWidth:Ve.dimensions.width,hallHeight:Ve.dimensions.height,scale:_,isDragging:M&&m},Be):null}),o.map(Ie=>{const Be=Ie._id||Ie.id,Le=((d==null?void 0:d._id)||(d==null?void 0:d.id))===Be;return n.jsx(P0,{fixture:{...Ie,_id:Be,id:Be},isSelected:Le,onSelect:()=>u(Ie),onChange:T?h:void 0,scale:_,position:{x:0,y:0},exhibitionWidth:r,exhibitionHeight:i,isEditable:T},Be)}),ct]})]}),n.jsx(hv,{visible:ee.visible,x:ee.x,y:ee.y,onExhibitionClick:ue,onHallClick:Me,onStallClick:$e,onClose:()=>q({...ee,visible:!1})}),n.jsx(dv,{visible:ie,width:r,height:i,onCancel:()=>Z(!1),onSubmit:Te})]})},O0={getStallTypes:async()=>Pe.get("/stall-types"),createStallType:async e=>Pe.post("/stall-types",e),updateStallType:async(e,t)=>Pe.put(`/stall-types/${e}`,t),deleteStallType:async e=>Pe.delete(`/stall-types/${e}`)},xv=Object.freeze(Object.defineProperty({__proto__:null,default:O0},Symbol.toStringTag,{value:"Module"})),{Title:mv}=Ue,ak=({visible:e,stall:t,hall:r,exhibition:i,onCancel:s,onSubmit:a,onDelete:o})=>{const[l]=oe.useForm(),[d,c]=N.useState([]),[u,f]=N.useState(!1),h=(v,k,T,m,w)=>{const b=[...T].sort((A,S)=>{const j=Math.floor(A.dimensions.y/5),C=Math.floor(S.dimensions.y/5);return j===C?A.dimensions.x-S.dimensions.x:A.dimensions.y-S.dimensions.y}),_=(A,S)=>A+v>m||S+k>w?!1:!b.some(j=>{const C=j.dimensions.x,P=j.dimensions.y,M=j.dimensions.width,X=j.dimensions.height,ee=1;return!(A+v+ee<=C||A>=C+M+ee||S+k+ee<=P||S>=P+X+ee)});for(const A of b){const S=A.dimensions.x+A.dimensions.width+1,j=A.dimensions.y;if(_(S,j))return{x:S,y:j};const C=A.dimensions.x,P=A.dimensions.y+A.dimensions.height+1;if(_(C,P))return{x:C,y:P}}for(let A=0;A<w;A+=5)for(let S=0;S<m;S+=5)if(_(S,A))return{x:S,y:A};return{x:0,y:0}};N.useEffect(()=>{if(t){console.log("Setting form values for stall:",t);const v={number:t.number,stallTypeId:t.stallTypeId,width:t.dimensions.width,height:t.dimensions.height,ratePerSqm:t.ratePerSqm,status:t.status};console.log("Form values to set:",v),l.setFieldsValue(v)}else r&&!l.getFieldValue("status")&&l.setFieldsValue({status:"available",width:Math.min(20,r.dimensions.width/4),height:Math.min(20,r.dimensions.height/4),ratePerSqm:0})},[t,r,l]),N.useEffect(()=>{e&&(async()=>{var k;try{f(!0);const T=await O0.getStallTypes();console.log("Fetched stall types:",T.data);const m=((k=i.stallRates)==null?void 0:k.map(E=>E.stallTypeId))||[];console.log("Configured stall type IDs:",m);const w=T.data.filter(E=>E.status==="active"&&E._id&&m.includes(E._id));console.log("Filtered stall types:",w),c(w)}catch(T){console.error("Failed to fetch stall types:",T)}finally{f(!1)}})()},[e,i.stallRates]);const p=v=>{var T;console.log("Stall type changed to:",v);const k=(T=i.stallRates)==null?void 0:T.find(m=>m.stallTypeId===v);console.log("Found stall rate:",k),k&&l.setFieldsValue({ratePerSqm:k.rate})},y=()=>{l.resetFields(),s()},x=()=>{if(console.log("Hall data:",r),!r||!r._id&&!r.id){Se.error("Invalid hall selected. Please try again.");return}l.validateFields().then(v=>{var w;const k=r._id||r.id;if(!k){Se.error("Hall ID is missing. Please select a hall again.");return}const T=t?{x:t.dimensions.x,y:t.dimensions.y}:h(v.width,v.height,((w=i.stalls)==null?void 0:w.filter(E=>E.hallId===k))||[],r.dimensions.width,r.dimensions.height),m={id:t==null?void 0:t.id,_id:t==null?void 0:t._id,number:v.number,stallTypeId:v.stallTypeId,dimensions:{x:T.x,y:T.y,width:v.width,height:v.height},ratePerSqm:v.ratePerSqm,status:v.status,hallId:k};console.log("Submitting stall data:",m),a(m)})},g=v=>{switch(v){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return n.jsx(n.Fragment,{children:n.jsx(pt,{title:n.jsxs(ke,{children:[n.jsx($r,{style:{fontSize:"20px"}}),n.jsx(mv,{level:4,style:{margin:0},children:t?"Edit Stall":"Add Stall"})]}),open:e,onCancel:y,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[n.jsxs(ke,{size:"middle",children:[t&&o&&n.jsx(fe,{danger:!0,icon:n.jsx(En,{}),onClick:()=>o(t),children:"Delete"}),n.jsx(fe,{onClick:y,children:"Cancel"}),n.jsx(fe,{type:"primary",onClick:x,children:t?"Save Changes":"Create"})]},"footer-buttons")],children:n.jsxs(oe,{form:l,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[n.jsx(oe.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:n.jsx(Re,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),n.jsx(oe.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:n.jsx(nt,{loading:u,placeholder:"Select stall type",size:"large",onChange:p,children:d.map(v=>n.jsx(nt.Option,{value:v._id,children:v.name},v._id))})}),n.jsx(Tt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),n.jsxs(ke,{style:{width:"100%",gap:"16px"},children:[n.jsx(oe.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:n.jsx(Mr,{min:1,max:(r==null?void 0:r.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),n.jsx(oe.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(r==null?void 0:r.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:n.jsx(Mr,{min:1,max:(r==null?void 0:r.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),n.jsx(Tt,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),n.jsx(oe.Item,{name:"ratePerSqm",label:"Rate per sq.m (₹)",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:n.jsx(Mr,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"₹",disabled:!0,formatter:v=>`${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:v=>{const k=v?Number(v.replace(/\₹\s?|(,*)/g,"")):0;return isNaN(k)?0:k}})}),n.jsx(oe.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n.jsxs(nt,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[n.jsx(nt.Option,{value:"available",children:n.jsxs(ke,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:g("available")}}),"Available"]})}),n.jsx(nt.Option,{value:"booked",children:n.jsxs(ke,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:g("booked")}}),"Booked"]})}),n.jsx(nt.Option,{value:"reserved",children:n.jsxs(ke,{children:[n.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:g("reserved")}}),"Reserved"]})})]})})]})})})},iu=e=>{if(!e)return"";const t=window.location.origin,r=e.replace(/^\/?(api\/uploads\/)?/,"");if(r.includes("fixtures/"))return`${t}/api/uploads/${r}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${r}?token=${i}`:""},gv=({name:e,type:t,color:r,rotation:i,showName:s,iconUrl:a,defaultIcons:o,borderColor:l=null,borderRadius:d=0})=>{N.useEffect(()=>{console.log("FixturePreview rendering with props:",{name:e,type:t,color:r,rotation:i,showName:s,iconUrl:a,defaultIconAvailable:!!o[t],borderColor:l,borderRadius:d})},[e,t,r,i,s,a,o,l,d]);const c=o[t]||"📦";return n.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[n.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${d||4}px`,backgroundColor:r||"#f0f0f0",transform:`rotate(${i}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:l?`1px solid ${l}`:"1px solid rgba(0,0,0,0.05)"},children:a?n.jsx("img",{src:a,alt:e,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):n.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:c})}),s&&n.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:e}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[n.jsx("span",{children:t.charAt(0).toUpperCase()+t.slice(1)}),n.jsx("span",{children:"•"}),n.jsx("span",{children:r}),i>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:[i,"°"]})]}),l&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Border: ",l]})]}),d>0&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:"•"}),n.jsxs("span",{children:["Radius: ",d,"px"]})]})]})]})},{Text:yv}=Ue,al=({activeKey:e,form:t,fixture:r,exhibitionWidth:i,exhibitionHeight:s,selectedType:a,showName:o,iconFileList:l,fixtureTypes:d,fixtureIcons:c,defaultColors:u,defaultDimensions:f,colorPresets:h,uploadProps:p,iconPreviewVisible:y=!1,previewImage:x="",onTypeChange:g,onColorChange:v,onShowNameChange:k,onIconPreviewCancel:T=()=>{}})=>{switch(e){case"basic":return m();case"position":return w();case"appearance":return E();default:return m()}function m(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(oe.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:n.jsx(Re,{placeholder:"Enter fixture name",prefix:n.jsx(or,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(oe.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:n.jsx(Ah,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:b=>{k(b),console.log("Form values after showName toggle:",t.getFieldsValue(!0))}})}),n.jsx(oe.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:n.jsx(nt,{placeholder:"Select fixture type",onChange:g,options:d.map(b=>({...b,label:n.jsxs(ke,{children:[n.jsx("span",{style:{fontSize:16},children:c[b.value]}),n.jsx("span",{children:b.label})]})})),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}function w(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(Ae,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:n.jsx(Mr,{style:{width:"100%",borderRadius:"8px"},min:0,max:i,step:.1,precision:1,placeholder:"X position"})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:n.jsx(Mr,{style:{width:"100%",borderRadius:"8px"},min:0,max:s,step:.1,precision:1,placeholder:"Y position"})})})]})}),n.jsx(Ae,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:n.jsx(Mr,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:n.jsx(Mr,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),n.jsx(Ae,{size:"small",title:n.jsxs("span",{children:[n.jsx(vx,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:n.jsx(oe.Item,{name:"rotation",noStyle:!0,children:n.jsx(yx,{min:0,max:360,marks:{0:"0°",90:"90°",180:"180°",270:"270°",360:"360°"},tooltip:{formatter:b=>`${b}°`},style:{marginTop:10},keyboard:!1})})})]})}function E(){return n.jsxs("div",{className:"tab-content",children:[n.jsx(oe.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(b,_)=>{try{return _?Promise.resolve():Promise.reject("Please select a color")}catch{return Promise.reject("Please enter a valid color value")}}}],children:n.jsx(Td,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:h,onChange:v,style:{width:"100%"}})}),n.jsx(oe.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:n.jsx(Td,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:h,style:{width:"100%"}})}),n.jsx(oe.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:n.jsx(Mr,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),n.jsxs(Ae,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[n.jsx("div",{style:{marginBottom:0},children:n.jsx(bx,{...p,children:l.length<1&&n.jsxs("div",{children:[n.jsx(wx,{style:{fontSize:20}}),n.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),n.jsx(yv,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),n.jsx(oe.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:n.jsx(Re,{placeholder:"https://example.com/icon.png",prefix:n.jsx(Sx,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),n.jsx(pt,{open:y,title:"Icon Preview",footer:null,onCancel:T,children:n.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:x})})]})}},vv=e=>[{key:"basic",label:n.jsxs("span",{children:[n.jsx(Fs,{}),"Basic Info"]}),children:n.jsx(al,{...e,activeKey:"basic"})},{key:"position",label:n.jsxs("span",{children:[n.jsx(Ri,{}),"Position"]}),children:n.jsx(al,{...e,activeKey:"position"})},{key:"appearance",label:n.jsxs("span",{children:[n.jsx(gx,{}),"Appearance"]}),children:n.jsx(al,{...e,activeKey:"appearance"})}],{Text:ok,Title:lk}=Ue,{TabPane:ck}=An,bv=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],sa={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},In={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},ol={sofa:"🛋️",chair:"🪑",table:"🪟",desk:"🖥️",plant:"🪴",entrance:"🚪",exit:"🚪",info:"ℹ️",restroom:"🚻",food:"🍽️",custom:"📦"},dk=({visible:e,fixture:t,onCancel:r,onSubmit:i,onDelete:s,exhibitionWidth:a,exhibitionHeight:o})=>{const[l]=oe.useForm(),[d,c]=N.useState(!1),[u,f]=N.useState(""),[h,p]=N.useState("basic"),[y,x]=N.useState(""),[g,v]=N.useState([]),[k,T]=N.useState(!1),[m,w]=N.useState(""),{message:E}=Rs.useApp(),[b,_]=N.useState("#f0f0f0"),[A,S]=N.useState("New Fixture"),[j,C]=N.useState("chair"),[P,M]=N.useState(0),[X,ee]=N.useState(!0),[q,K]=N.useState(null),[Q,ie]=N.useState(0);N.useEffect(()=>{if(e)if(t){const G=J(t.color),xe=In[t.type]||"#f0f0f0",ge=G||xe;console.log("Setting up fixture colors:",{original:t.color,normalized:G,fallback:xe,final:ge}),_(ge),S(t.name),C(t.type),M(t.rotation||0),f(t.type),ee(t.showName!==!1),K(t.borderColor||null),ie(t.borderRadius||0)}else{const G="chair",xe=In[G];_(xe),S("New Fixture"),C(G),M(0),f(G),ee(!0),K(null),ie(0)}},[e,t]),N.useEffect(()=>{if(e&&l){if(t){const G=J(t.color),xe=In[t.type]||"#f0f0f0",ge=G||xe;l.setFieldsValue({name:t.name,type:t.type,position:{x:t.position.x,y:t.position.y},dimensions:{width:t.dimensions.width,height:t.dimensions.height},rotation:t.rotation||0,color:ge,icon:t.icon||"",showName:t.showName!==!1,borderColor:t.borderColor||null,borderRadius:t.borderRadius||0});const me=t.icon?iu(t.icon):"";x(me),t.icon?v([{uid:"-1",name:t.icon.split("/").pop()||"icon",status:"done",url:me,thumbUrl:me}]):v([])}else{const G="chair",xe=In[G];l.setFieldsValue({name:"New Fixture",type:G,position:{x:Math.floor(a/2),y:Math.floor(o/2)},dimensions:sa[G],rotation:0,color:xe,icon:"",showName:!0,borderColor:null,borderRadius:0}),x(""),v([])}p("basic")}},[e,t,l,a,o]);const Z=()=>{if(l&&e)try{const G=l.getFieldsValue(!0);if(G.name&&S(G.name),G.type&&C(G.type),G.rotation!==void 0&&M(G.rotation),G.color){const xe=J(G.color);xe&&_(xe)}if(G.showName!==void 0&&ee(G.showName),G.borderColor!==void 0){const xe=G.borderColor?J(G.borderColor):null;K(xe)}G.borderRadius!==void 0&&ie(G.borderRadius)}catch(G){console.log("Error updating preview",G)}};N.useEffect(()=>{if(l&&e)return l.getFieldsValue,Z(),()=>{}},[l,e]);const R=G=>{if(f(G),C(G),!t){const xe=In[G]||In.custom;l.setFieldsValue({dimensions:sa[G]||sa.custom,color:xe}),_(xe)}},U=G=>{const xe=J(G);l.setFieldValue("color",xe),_(xe);const ge=Object.entries(In).find(([me,Te])=>Te.toLowerCase()===xe.toLowerCase());ge&&!t&&(l.setFieldValue("type",ge[0]),f(ge[0]),C(ge[0]))},O=()=>(console.log("Rendering fixture preview with:",{name:A,type:j,color:b,rotation:P,showName:X,iconUrl:y,borderColor:q,borderRadius:Q}),n.jsx(gv,{name:A,type:j,color:b,rotation:P,showName:X,iconUrl:y,defaultIcons:ol,borderColor:q,borderRadius:Q})),I=({file:G,fileList:xe})=>{var ge;if(G.status==="uploading"&&v(xe),G.status==="done"){E.success(`${G.name} uploaded successfully`);let Te=(((ge=G.response)==null?void 0:ge.url)||"").replace(/^\/api\/uploads\//,"");Te&&!Te.startsWith("fixtures/")&&(Te=`fixtures/${Te.replace(/^\//,"")}`),console.log("Icon path stored in form:",Te),l.setFieldValue("icon",Te);const ue=iu(Te);console.log("Using direct backend URL:",ue),x(ue);const Me=G.name.toLowerCase().endsWith(".svg"),$e=xe.map(ct=>ct.uid===G.uid?{...ct,url:ue,thumbUrl:ue,type:Me?"image/svg+xml":ct.type}:ct);v($e),console.log("Form values after icon upload:",l.getFieldsValue(!0))}G.status==="error"&&(E.error(`${G.name} upload failed.`),v(xe.filter(me=>me.uid!==G.uid)))},W={name:"file",action:`${Pe.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:g,onChange:I,onPreview:G=>{w(G.url||G.thumbUrl||""),T(!0)},onRemove:()=>(x(""),v([]),l.setFieldValue("icon",""),console.log("Form values after icon removal:",l.getFieldsValue(!0)),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:n.jsx(En,{style:{color:"#ff4d4f"}})}},J=G=>{try{if(!G)return"#f0f0f0";if(typeof G=="object"&&G!==null){if(typeof G.toHexString=="function")return G.toHexString();if(G.rgb||G.hex)return G.hex||`rgb(${G.rgb.r},${G.rgb.g},${G.rgb.b})`}if(typeof G=="string"){if(/^#([0-9A-F]{3}){1,2}$/i.test(G))return G;if(/^([0-9A-F]{3}){1,2}$/i.test(G))return`#${G}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(G))return G}return"#f0f0f0"}catch(xe){return console.error("Error normalizing color:",xe),"#f0f0f0"}},he=[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],ye=_t.useCallback(()=>{t&&s&&s(t)},[t,s]),H=G=>{p(G),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},Y=vv({form:l,fixture:t,exhibitionWidth:a,exhibitionHeight:o,selectedType:u,showName:X,iconFileList:g,fixtureTypes:bv,fixtureIcons:ol,defaultColors:In,defaultDimensions:sa,colorPresets:he,uploadProps:W,iconPreviewVisible:k,previewImage:m,onTypeChange:R,onColorChange:U,onShowNameChange:G=>ee(G),onIconPreviewCancel:()=>T(!1),activeKey:h}),le=async()=>{try{c(!0);const G=await l.validateFields();S(G.name),C(G.type),M(G.rotation||0),_(J(G.color)),ee(G.showName),K(G.borderColor?J(G.borderColor):null),ie(G.borderRadius||0);let xe="";G.icon?xe=de(G.icon):t!=null&&t.icon&&(xe=t.icon),console.log("Form values being submitted:",{name:G.name,type:G.type,color:G.color,icon:G.icon,originalIcon:t==null?void 0:t.icon,cleanedIcon:xe,showName:G.showName,borderColor:G.borderColor,borderRadius:G.borderRadius});const ge=(t==null?void 0:t._id)||(t==null?void 0:t.id)||"",me=G.color?J(G.color):(t==null?void 0:t.color)||"#f0f0f0",Te=G.borderColor?J(G.borderColor):null,ue={...t,id:ge,_id:ge,name:G.name,type:G.type,position:G.position,dimensions:G.dimensions,rotation:G.rotation,color:me,icon:xe,zIndex:(t==null?void 0:t.zIndex)||1,isActive:(t==null?void 0:t.isActive)!==void 0?t.isActive:!0,borderColor:Te,borderRadius:G.borderRadius||0};ge&&(ue.showName=G.showName),console.log("Submitting fixture with icon path:",xe),console.log("Color being submitted:",me),await i(ue),r()}catch(G){console.error("Fixture submission failed:",G),E.error("Failed to save fixture. Please check the form and try again.")}finally{c(!1)}},de=G=>{if(!G||typeof G!="string")return"";if(G.startsWith("fixtures/")&&!G.includes("?")&&!G.includes("http"))return G;let xe=G.replace(/^\/api\/uploads\//,"");if(xe=xe.replace(/^\//,""),xe.includes("?")||xe.includes("http")){const ge=xe.split("?")[0].split("/").pop()||"";if(ge)return`fixtures/${ge}`}return xe&&!xe.startsWith("fixtures/")?`fixtures/${xe}`:xe};return n.jsxs(pt,{title:n.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[n.jsx("span",{style:{fontSize:24,marginRight:8},children:t?ol[t.type]:"🪑"}),n.jsx("span",{children:t?`Edit ${t.name}`:"Add New Fixture"})]}),open:e,onCancel:r,confirmLoading:d,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx("div",{children:t&&s&&n.jsx(fe,{danger:!0,icon:n.jsx(En,{}),onClick:ye,style:{borderRadius:"6px"},children:"Delete"})}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx(fe,{onClick:r,icon:n.jsx(jx,{}),style:{borderRadius:"6px"},children:"Cancel"}),n.jsx(fe,{type:"primary",onClick:le,icon:n.jsx(kh,{}),style:{borderRadius:"6px"},children:t?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .svg-icon {
          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));
        }
        
        /* Fix for passive event listener warnings */
        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {
          touch-action: none !important;
        }
        
        .ant-slider-rail, .ant-slider-track {
          touch-action: pan-y !important;
        }
        
        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {
          touch-action: manipulation !important;
        }
        
        /* Fix circular references warning */
        .ant-color-picker-trigger-disabled .ant-color-picker-clear {
          display: none;
        }
      `}}),O(),n.jsx(oe,{form:l,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:Z,children:n.jsx(An,{activeKey:h,onChange:H,items:Y,tabBarStyle:{marginBottom:16},centered:!0})})]})},wv=be(pt)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,Sv=be.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,as=be.div`
  padding: 24px 32px 32px;
`,jv=be.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,Ev=be.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;be.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`;be.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`;be.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`;be.div`
  border: 1px solid ${e=>e.selected?"#4b47b9":"#e6e6f0"};
  background: ${e=>e.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${e=>e.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${e=>e.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${e=>e.selected?"#4b47b9":"white"};
    border: 2px solid ${e=>e.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const _v=be(Ae)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;be(fe)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`;be.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`;be(Ae)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`;be(Re)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const ll=be(fe)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;be(Xe)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`;be.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`;be(Ns)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`;be.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`;be.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`;be.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`;be.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`;be.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px × 3) + (16px × 2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`;be(Ae)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const su=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:i=[],exhibition:s})=>{const[a,o]=N.useState([]);N.useEffect(()=>{let p=[...(e.getFieldValue("selectedStalls")||[]).map(y=>String(y))];if(r){const y=String(r);p.some(x=>x===y)||p.push(y)}i.length>0&&i.forEach(y=>{const x=String(y);p.some(g=>g===x)||p.push(x)}),console.log("StallDetailsStep - Initial stalls after normalization:",p),e.setFieldsValue({selectedStalls:p}),o(p)},[e,r,i]),N.useEffect(()=>{if(a.length>0){const f=e.getFieldValue("selectedStalls")||[],h=new Set(f.map(x=>String(x))),p=new Set(a.map(x=>String(x)));let y=h.size!==p.size;if(!y){for(const x of p)if(!h.has(x)){y=!0;break}}if(y){console.log("Syncing form with selected stalls:",a);const x=a.map(g=>String(g));e.setFieldsValue({selectedStalls:x}),e.validateFields(["selectedStalls"]).catch(g=>{})}}},[a,e]);const l=N.useMemo(()=>!t||t.length===0?[]:t.filter(f=>a.includes(f.id)),[t,a]),d=N.useMemo(()=>{var m,w,E;if(!t||t.length===0)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const f=t.filter(b=>a.includes(b.id)),h=f.reduce((b,_)=>b+(_.price||_.ratePerSqm*_.dimensions.width*_.dimensions.height),0),y=(((m=s==null?void 0:s.publicDiscountConfig)==null?void 0:m.filter(b=>b.isActive))||[]).map(b=>{const _=b.type==="percentage"?h*(Math.min(Math.max(0,b.value),100)/100):Math.min(b.value,h);return{name:b.name,type:b.type,value:b.value,amount:_}}),x=y.reduce((b,_)=>b+_.amount,0),g=h-x,v=((E=(w=s==null?void 0:s.taxConfig)==null?void 0:w.filter(b=>b.isActive))==null?void 0:E.map(b=>({name:b.name,rate:b.rate,amount:g*(b.rate/100)})))||[],k=v.reduce((b,_)=>b+_.amount,0),T=g+k;return{baseAmount:h,discounts:y,totalDiscountAmount:x,amountAfterDiscount:g,taxes:v,totalTaxAmount:k,total:T,selectedStallNumbers:f.map(b=>`${b.number||b.stallNumber||`Stall ${b.id}`} (${b.hallName||`Hall ${b.hallId||1}`})`).join(", ")}},[t,a,s==null?void 0:s.taxConfig,s==null?void 0:s.publicDiscountConfig]),c=f=>{const h=String(f);if(a.some(y=>String(y)===h)){const y=a.filter(x=>String(x)!==h);o(y),e.setFieldsValue({selectedStalls:y}),Se.info("Stall removed from selection")}},u=f=>`₹${f.toLocaleString("en-IN")}`;return n.jsxs(as,{children:[n.jsx(jv,{children:"Your Selected Stalls"}),n.jsx(Ev,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),n.jsx(oe.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:n.jsx(nt,{mode:"multiple"})}),l.length>0?n.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:n.jsx(ft,{dataSource:l.map(f=>({...f,key:f.id,price:f.price||f.ratePerSqm*f.dimensions.width*f.dimensions.height,area:f.dimensions.width*f.dimensions.height,dimensions:`${f.dimensions.width}m × ${f.dimensions.height}m`,size:`${f.dimensions.width}m × ${f.dimensions.height}m`,stallType:f.stallType||{name:f.typeName||f.type||"Standard"},type:f.typeName||f.type||"Standard"})),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(f,h)=>n.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",f||h.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(f,h)=>n.jsx(Ne,{color:"blue",style:{borderRadius:"4px"},children:f||`Hall ${h.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(f,h)=>{var y;const p=((y=h.stallType)==null?void 0:y.name)||h.type||"Standard";return n.jsx(Ne,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:p})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(f,h)=>n.jsxs(ke,{direction:"vertical",size:0,children:[n.jsx("span",{style:{fontWeight:500},children:f}),n.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[h.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(f,h)=>n.jsxs("span",{style:{color:"#555"},children:["₹",(h.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:f=>n.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:u(f)})},{title:"",key:"action",width:70,align:"center",render:(f,h)=>n.jsx(ht,{title:"Remove from selection",children:n.jsx(fe,{type:"text",danger:!0,icon:n.jsx(En,{}),onClick:()=>c(h.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):n.jsx(xt,{description:"No stalls selected yet. Please select stalls from the layout.",image:xt.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),a.length>0&&n.jsxs(_v,{title:n.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Selected Stalls"}),n.jsxs("div",{className:"value",children:[a.length," stall(s) selected"]})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Stall Numbers"}),n.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:d.selectedStallNumbers})]}),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Base Amount"}),n.jsx("div",{className:"value",children:u(d.baseAmount)})]}),d.discounts.map((f,h)=>n.jsxs("div",{className:"summary-row discount",children:[n.jsxs("div",{className:"label",children:[f.name,f.type==="percentage"?` (${f.value}%)`:""]}),n.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",u(f.amount)]})]},`discount-${h}`)),n.jsxs("div",{className:"summary-row",children:[n.jsx("div",{className:"label",children:"Amount after Discount"}),n.jsx("div",{className:"value",style:{fontWeight:500},children:u(d.amountAfterDiscount)})]}),d.taxes.map((f,h)=>n.jsxs("div",{className:"summary-row",children:[n.jsxs("div",{className:"label",children:[f.name," (",f.rate,"%)"]}),n.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",u(f.amount)]})]},`tax-${h}`)),n.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[n.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),n.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:u(d.total)})]})]})]})},{Title:Tv,Paragraph:au,Text:xn}=Ue,{Panel:uk}=Ex,{Option:Av}=nt,ou=({form:e,formValues:t,selectedStallIds:r=[],exhibition:i,stallDetails:s=[]})=>{const a=e.getFieldValue("selectedStalls")||r||[],[o,l]=N.useState(e.getFieldValue("amenities")||[]),[d,c]=N.useState({}),u=N.useMemo(()=>s!=null&&s.length?s.filter(E=>a.includes(E.id)):[],[s,a]),f=N.useMemo(()=>u.reduce((E,b)=>E+b.dimensions.width*b.dimensions.height,0),[u]),h=(i==null?void 0:i.basicAmenities)&&i.basicAmenities.length>0,p=(i==null?void 0:i.amenities)&&i.amenities.length>0,y=N.useMemo(()=>!h||f===0?[]:((i==null?void 0:i.basicAmenities)||[]).map(E=>{const b=Math.floor(f/E.perSqm)*E.quantity;return{...E,calculatedQuantity:b>0?b:0,key:E._id||E.id}}),[i,h,f]),x=E=>{const b={...d};E.forEach(_=>{o.includes(_)||(b[_]=1)}),Object.keys(b).forEach(_=>{E.includes(_)||delete b[_]}),c(b),l(E)},g=E=>(E._id||E.id||"").toString(),v=(E,b)=>{c(_=>({..._,[E]:b}))};_t.useEffect(()=>{const E=o.map(b=>({id:b,quantity:d[b]||1}));e.setFieldsValue({amenities:E})},[o,d,e]);const k=E=>`₹${E.toLocaleString("en-IN")}`,T=N.useMemo(()=>p?((i==null?void 0:i.amenities)||[]).filter(E=>o.includes(g(E))).map(E=>({...E,key:g(E),quantity:d[g(E)]||1})):[],[i,p,o,d]),m=[{title:"Name",dataIndex:"name",key:"name",render:(E,b)=>n.jsxs(ke,{children:[n.jsx(xn,{strong:!0,children:E}),n.jsx(Ne,{color:"blue",children:b.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:E=>n.jsxs(Ne,{color:"green",children:[E," ",E===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(E,b)=>n.jsx(ht,{title:b.description,children:n.jsxs(xn,{type:"secondary",children:[n.jsx(or,{style:{marginRight:5}}),"1 ",b.quantity>1?`set of ${b.quantity}`:"unit"," per ",E," sqm"]})})}],w=[{title:"Name",dataIndex:"name",key:"name",render:(E,b)=>n.jsxs(ke,{align:"center",children:[n.jsx(xn,{strong:!0,children:E}),n.jsx(Ne,{color:"blue",children:b.type}),n.jsx(xn,{type:"secondary",style:{fontSize:"13px"},children:b.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:E=>n.jsx(xn,{strong:!0,style:{color:"#1890ff"},children:k(E)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(E,b)=>n.jsx(Mr,{min:1,value:d[b.key]||1,onChange:_=>v(b.key,_||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,render:(E,b)=>{const _=d[b.key]||1,A=b.rate*_;return n.jsx(xn,{strong:!0,style:{color:"#1890ff"},children:k(A)})}}];return n.jsxs(as,{children:[n.jsx(Tv,{level:4,children:"Stall Amenities"}),n.jsx(au,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),n.jsx(Ae,{title:`Selected Stalls: ${a.length}`,style:{marginBottom:24},children:a.length>0?n.jsxs(au,{children:["You've selected ",a.length," stall(s) with a total area of ",f," sq. meters."]}):n.jsx(xt,{image:xt.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),n.jsx(Ae,{title:n.jsxs(ke,{children:[n.jsx(Br,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:a.length===0?n.jsx(Ct,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):h?n.jsx(ft,{dataSource:y.filter(E=>E.calculatedQuantity>0),columns:m,pagination:!1,size:"small",locale:{emptyText:n.jsx(xt,{image:xt.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):n.jsx(xt,{image:n.jsx(Ad,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),n.jsx(Tt,{}),n.jsx(Ae,{title:"Additional Amenities (Extra Charges)",children:p?n.jsxs("div",{children:[n.jsx(oe.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:n.jsx(nt,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:o,onChange:x,optionLabelProp:"label",children:((i==null?void 0:i.amenities)||[]).map(E=>n.jsxs(Av,{value:g(E),label:`${E.name} (${k(E.rate)})`,children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(ke,{children:[n.jsx(xn,{strong:!0,children:E.name}),n.jsx(Ne,{color:"blue",children:E.type})]}),n.jsx(xn,{style:{color:"#1890ff"},children:k(E.rate)})]}),n.jsx("div",{children:n.jsx(xn,{type:"secondary",children:E.description})})]},g(E)))})}),T.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Tt,{orientation:"left",children:"Selected Amenities"}),n.jsx(ft,{dataSource:T,columns:w,pagination:!1,size:"small"})]})]}):n.jsx(xt,{image:n.jsx(Ad,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),n.jsx(oe.Item,{name:"amenities",hidden:!0,children:n.jsx(Re,{type:"hidden"})}),n.jsx(oe.Item,{name:"selectedStalls",hidden:!0,children:n.jsx(Re,{type:"hidden"})})]})},{Title:cl,Paragraph:lu,Text:At}=Ue,cu=({form:e,stallDetails:t=[],selectedStallId:r,selectedStallIds:i=[],selectedStalls:s=[],exhibition:a,onPrev:o,onFinish:l,loading:d=!1,formValues:c={}})=>{const[u,f]=N.useState([]),h=N.useMemo(()=>{const w=(e.getFieldValue("selectedStalls")||[]).map(b=>String(b));if(console.log("ReviewStep - Form has selectedStalls:",w),console.log("ReviewStep - Props selectedStallIds:",i),console.log("ReviewStep - Props selectedStalls:",s),w.length>0)return w;const E=[];if(r){const b=String(r);E.push(b)}return i&&i.length&&i.forEach(b=>{const _=String(b);E.includes(_)||E.push(_)}),s&&s.length&&s.forEach(b=>{const _=String(b);E.includes(_)||E.push(_)}),console.log("ReviewStep - Final consolidated stall IDs:",E),E},[e,r,i,s]);N.useEffect(()=>{if(console.log("ReviewStep - Processing stall details with IDs:",h),console.log("ReviewStep - Available stall details:",t),t&&t.length&&h.length){const m=t.filter(E=>h.includes(String(E.id)));console.log("ReviewStep - Matched stalls:",m.length);const w=m.map(E=>({key:E.id,id:E.id,number:E.number||E.stallNumber||`Stall ${E.id}`,hallName:E.hallName||`Hall ${E.hallId}`,size:`${E.dimensions.width}m × ${E.dimensions.height}m`,area:E.dimensions.width*E.dimensions.height,rate:E.ratePerSqm,price:E.price||E.ratePerSqm*E.dimensions.width*E.dimensions.height,type:E.typeName||E.type||"Standard"}));f(w)}},[t,h]);const p=N.useMemo(()=>{var q,K,Q,ie;const m=u.reduce((Z,R)=>Z+R.price,0),w=u.reduce((Z,R)=>Z+(R.area||0),0),E=((q=a==null?void 0:a.basicAmenities)==null?void 0:q.map(Z=>{const R=Math.floor(w/Z.perSqm)*Z.quantity;return{...Z,calculatedQuantity:R>0?R:0}}))||[],b=e.getFieldValue("amenities")||[];console.log("ReviewStep - Selected amenities with quantities:",b);let _=0;const A=b.map(Z=>{var I;const R=Z.id,U=Z.quantity||1,O=(I=a==null?void 0:a.amenities)==null?void 0:I.find(W=>W.id===R||W._id===R);if(O){const W=(O.rate||0)*U;return _+=W,{name:O.name,rate:O.rate,type:O.type,description:O.description,quantity:U,total:W}}return null}).filter(Boolean);console.log("ReviewStep - Processed amenity items:",A);const j=(((K=a==null?void 0:a.publicDiscountConfig)==null?void 0:K.filter(Z=>Z.isActive))||[]).map(Z=>{const R=Z.type==="percentage"?m*(Math.min(Math.max(0,Z.value),100)/100):Math.min(Z.value,m);return{name:Z.name,type:Z.type,value:Z.value,amount:R}}),C=j.reduce((Z,R)=>Z+R.amount,0),P=m-C,M=P,X=((ie=(Q=a==null?void 0:a.taxConfig)==null?void 0:Q.filter(Z=>Z.isActive))==null?void 0:ie.map(Z=>({name:Z.name,rate:Z.rate,amount:M*(Z.rate/100)})))||[],ee=X.reduce((Z,R)=>Z+R.amount,0);return{baseAmount:m,basicAmenities:E,totalStallArea:w,amenities:A,amenitiesTotal:_,discounts:j,totalDiscountAmount:C,amountAfterDiscount:P,subtotal:M,taxes:X,totalTaxAmount:ee,total:M+ee,stallCount:u.length}},[u,e,a]);N.useEffect(()=>{var w;const m=((w=a==null?void 0:a.publicDiscountConfig)==null?void 0:w.filter(E=>E.isActive))||[];if(m.length>0){const E=m[0];console.log("Setting discountId in form to:",E),e.setFieldsValue({discountId:{name:E.name,type:E.type,value:E.value}})}},[a,e]);const y=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:(m,w)=>n.jsx(Ne,{color:"purple",children:m},`stall-type-${w.key}`)},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:(m,w)=>n.jsxs("span",{children:[m," sqm"]},`stall-area-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",render:(m,w)=>n.jsxs("span",{children:["₹",m,"/sqm"]},`stall-rate-${w.key}`)},{title:"Price",dataIndex:"price",key:"price",render:(m,w)=>n.jsxs("span",{children:["₹",m.toLocaleString()]},`stall-price-${w.key}`)}],x=m=>`₹${m.toLocaleString("en-IN")}`,g=c.customerName||e.getFieldValue("customerName"),v=c.customerPhone||e.getFieldValue("customerPhone"),k=c.email||e.getFieldValue("email"),T=c.companyName||e.getFieldValue("companyName");return console.log("ReviewStep - Exhibitor Info:",{customerName:g,companyName:T,customerPhone:v,customerEmail:k,formValues:c,formFieldValues:{customerName:e.getFieldValue("customerName"),companyName:e.getFieldValue("companyName"),customerPhone:e.getFieldValue("customerPhone"),email:e.getFieldValue("email")}}),d?n.jsx(as,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:n.jsx(Rt,{size:"large",tip:"Processing your booking..."})}):h.length===0?n.jsxs(as,{children:[n.jsx(Ct,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),n.jsx("div",{style:{marginTop:24,textAlign:"right"},children:n.jsx(fe,{onClick:o,children:"Back to Stall Selection"})})]}):n.jsxs(as,{children:[n.jsx(oe.Item,{name:"discountId",hidden:!0,children:n.jsx(Re,{})}),n.jsx(cl,{level:4,children:"Booking Summary"}),n.jsx(lu,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),n.jsx(Ae,{title:"Exhibitor Information",style:{marginBottom:24},children:n.jsxs(Xe,{column:2,children:[n.jsx(Xe.Item,{label:"Name",children:g||"Not provided"}),n.jsx(Xe.Item,{label:"Company",children:T||"Not provided"}),n.jsx(Xe.Item,{label:"Phone",children:v||"Not provided"}),n.jsx(Xe.Item,{label:"Email",children:k||"Not provided"})]})}),n.jsxs(Ae,{title:"Selected Stalls",className:"review-card",size:"small",children:[n.jsx(ft,{dataSource:u,columns:y,pagination:!1,size:"small",style:{marginBottom:16}}),n.jsxs(At,{strong:!0,children:["Total Base Amount: ",x(p.baseAmount)]})]}),p.basicAmenities&&p.basicAmenities.length>0&&n.jsxs(Ae,{title:n.jsxs(ke,{children:[n.jsx(Br,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[n.jsxs(lu,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",p.totalStallArea," sqm."]}),n.jsx(ft,{dataSource:p.basicAmenities.filter(m=>m.calculatedQuantity>0).map((m,w)=>({...m,key:`basic-${w}`})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(m,w)=>n.jsxs(ke,{children:[n.jsx(At,{strong:!0,children:m}),n.jsx(Ne,{color:"blue",children:w.type})]},`name-${w.key}`)},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:(m,w)=>n.jsxs(Ne,{color:"green",children:[m," ",m===1?"unit":"units"]},`quantity-${w.key}`)},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(m,w)=>n.jsxs(At,{type:"secondary",children:[n.jsx(or,{style:{marginRight:5}}),"1 ",w.quantity>1?`set of ${w.quantity}`:"unit"," per ",m," sqm"]},`allocation-${w.key}`)},{title:"Status",key:"status",width:100,align:"right",render:(m,w)=>n.jsx(At,{type:"success",children:"Included"},`status-${w.key}`)}],pagination:!1,size:"small",locale:{emptyText:n.jsx(Ct,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),p.amenities&&p.amenities.length>0&&n.jsxs(Ae,{title:"Selected Amenities",style:{marginBottom:24},children:[n.jsx(ft,{dataSource:p.amenities.map((m,w)=>({...m,key:w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(m,w)=>n.jsxs(ke,{children:[n.jsx(At,{strong:!0,children:m}),n.jsx(Ne,{color:"blue",children:w.type})]},`amenity-name-${w.key}`)},{title:"Description",dataIndex:"description",key:"description",render:(m,w)=>n.jsx(At,{type:"secondary",style:{fontSize:"13px"},children:m||"No description provided"},`amenity-desc-${w.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",width:110,align:"right",render:(m,w)=>n.jsx(At,{strong:!0,style:{color:"#1890ff"},children:x(m)},`amenity-rate-${w.key}`)},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:90,align:"center",render:(m,w)=>n.jsx(Ne,{color:"green",children:m},`amenity-qty-${w.key}`)},{title:"Total",dataIndex:"total",key:"total",width:110,align:"right",render:(m,w)=>n.jsx(At,{strong:!0,style:{color:"#1890ff"},children:x(m)},`amenity-total-${w.key}`)}],pagination:!1,size:"small"}),n.jsx(Tt,{}),n.jsx("div",{style:{textAlign:"right"},children:n.jsxs(At,{strong:!0,children:["Amenities Total: ",x(p.amenitiesTotal)]})})]}),n.jsxs(Ae,{title:"Price Calculation",style:{marginBottom:24},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{children:"Base Amount:"}),n.jsx(At,{children:x(p.baseAmount)})]}),p.discounts.length>0&&n.jsxs(n.Fragment,{children:[p.discounts.map((m,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(At,{children:[m.name," (",m.type==="percentage"?`${m.value}%`:x(m.value),"):"]}),n.jsxs(At,{type:"danger",children:["- ",x(m.amount)]})]},w)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{children:"Amount after Discount:"}),n.jsx(At,{children:x(p.amountAfterDiscount)})]})]}),p.amenitiesTotal>0&&n.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[n.jsx(At,{type:"secondary",children:"Selected Amenities (for information only):"}),n.jsx(At,{type:"secondary",children:x(p.amenitiesTotal)})]}),n.jsx(At,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsx(At,{strong:!0,children:"Subtotal:"}),n.jsx(At,{strong:!0,children:x(p.subtotal)})]}),p.taxes.length>0&&n.jsx(n.Fragment,{children:p.taxes.map((m,w)=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[n.jsxs(At,{children:[m.name," (",m.rate,"%):"]}),n.jsx(At,{children:x(m.amount)})]},w))}),n.jsx(Tt,{}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(cl,{level:5,children:"Total:"}),n.jsx(cl,{level:5,children:x(p.total)})]})]})]})},{confirm:kv}=pt,Cv=({visible:e,stallDetails:t,selectedStallId:r,selectedStallIds:i,loading:s,exhibition:a,onCancel:o,onSubmit:l})=>{const[d]=oe.useForm(),[c,u]=N.useState(0),[f]=N.useState(3),[h,p]=N.useState({}),[y,x]=N.useState(!1),[g,v]=N.useState(!1),k=ut(j=>j.exhibitorAuth.exhibitor);N.useEffect(()=>{if(e){u(0),x(!1),p({}),d.resetFields();const j=i.map(M=>String(M));r&&j.push(String(r));const C=[...new Set(j)],P={selectedStalls:C,exhibitionId:a==null?void 0:a._id};k&&(P.customerName=k.contactPerson||"",P.companyName=k.companyName||"",P.email=k.email||"",P.customerPhone=k.phone||""),d.setFieldsValue(P),p(P),console.log("Booking form initialized with stalls:",C),console.log("Exhibitor profile data:",k)}},[e,d,r,i,a,k]);const T=()=>{x(!0)},m=()=>{y?kv({title:"Discard changes?",icon:n.jsx(po,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){o()}}):o()},w=()=>{v(!0),d.validateFields().then(j=>{const C={...h,...j},P={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},M={...C,...P};p(M),console.log("Step completed, saving form values:",M),console.log("Selected stalls are:",M.selectedStalls||[]),console.log("Exhibitor info:",P),u(c+1),v(!1)}).catch(j=>{v(!1),console.error("Form validation failed:",j),Se.error("Please complete all required fields")})},E=()=>{u(c-1)},b=()=>{d.validateFields().then(j=>{const C={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},P=d.getFieldValue("selectedStalls")||[],M=d.getFieldValue("amenities")||[],ee=t.filter(ie=>P.includes(String(ie.id))).reduce((ie,Z)=>ie+Z.dimensions.width*Z.dimensions.height,0);let q=[];a!=null&&a.basicAmenities&&a.basicAmenities.length>0&&(q=a.basicAmenities.filter(ie=>Math.floor(ee/ie.perSqm)*ie.quantity>0).map(ie=>{const Z=Math.floor(ee/ie.perSqm)*ie.quantity;return{name:ie.name,type:ie.type,perSqm:ie.perSqm,quantity:ie.quantity,calculatedQuantity:Z,description:ie.description||""}}));let K=[];M&&M.length>0&&(K=M.map(ie=>{var R;const Z=(R=a==null?void 0:a.amenities)==null?void 0:R.find(U=>String(U._id||U.id)===String(ie.id));return Z?{id:String(Z._id||Z.id),name:Z.name,type:Z.type,rate:Z.rate,quantity:ie.quantity||1,description:Z.description||""}:null}).filter(Boolean));const Q={...h,...j,...C,basicAmenities:q,extraAmenities:K};console.log("Submitting booking with values:",Q),console.log("Basic amenities:",q),console.log("Extra amenities:",K),l(Q)}).catch(j=>{console.error("Form validation failed:",j),Se.error("Please complete all required fields")})},_=["Stall Details","Amenities","Review"],A=[{title:"Stall Details",icon:n.jsx(_x,{}),content:n.jsx(su,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:i,exhibition:a})},{title:"Amenities",icon:n.jsx(Fs,{}),content:n.jsx(ou,{form:d,stallDetails:t,selectedStallIds:d.getFieldValue("selectedStalls")||[],exhibition:a,formValues:h})},{title:"Review",icon:n.jsx(Nt,{}),content:n.jsx(cu,{form:d,formValues:h,loading:s,exhibition:a,selectedStalls:d.getFieldValue("selectedStalls")||[],selectedStallIds:d.getFieldValue("selectedStalls")||[],stallDetails:t})}];N.useEffect(()=>{const j=d.getFieldValue("selectedStalls");console.log(`Step ${c} - Form has selectedStalls:`,j)},[c,d]);const S=j=>{const C=d.getFieldValue("selectedStalls")||[],P={customerName:d.getFieldValue("customerName"),companyName:d.getFieldValue("companyName"),email:d.getFieldValue("email"),customerPhone:d.getFieldValue("customerPhone")},M={...h,...P};switch(console.log(`Rendering step ${j} with:`,{selectedStalls:C,exhibitorInfo:P}),j){case 0:return n.jsx(su,{form:d,stallDetails:t,selectedStallId:r,selectedStallIds:i,exhibition:a});case 1:return n.jsx(ou,{form:d,stallDetails:t,selectedStallIds:C,exhibition:a,formValues:M});case 2:return n.jsx(cu,{form:d,formValues:M,loading:s,exhibition:a,selectedStalls:C,selectedStallIds:C,stallDetails:t,onPrev:E,onFinish:b});default:return null}};return n.jsx(wv,{title:`Book Exhibition Stall - ${_[c]}`,open:e,onCancel:m,footer:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[c>0&&n.jsx(ll,{onClick:E,disabled:g||s,size:"large",children:"Back"}),n.jsx("div",{children:c<f-1?n.jsx(ll,{type:"primary",onClick:w,loading:g,disabled:s,size:"large",children:"Next"}):n.jsx(ll,{type:"primary",onClick:b,loading:s,disabled:g,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:n.jsxs(Rt,{spinning:s||g,tip:s?"Processing your booking...":"Validating...",children:[n.jsx(Sv,{children:A.map((j,C)=>n.jsxs("div",{className:`step-item ${c===C?"active":""} ${c>C?"completed":""}`,onClick:()=>c>C?u(C):null,style:{cursor:c>C?"pointer":"default"},children:[n.jsx("span",{className:"step-icon",children:c>C?n.jsx(jh,{}):C+1}),j.title]},C))}),n.jsx(oe,{form:d,layout:"vertical",preserve:!0,onFieldsChange:T,children:S(c)},`form-step-${c}`)]})})},{Content:aa}=Et,{Title:hk}=Ue,Iv=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/"))return`${rn.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),i=`uploads/${t}`;return r?`${rn.defaults.baseURL}/${i}?token=${r}`:`${rn.defaults.baseURL}/${i}`},Nv=()=>{var K,Q,ie,Z;const{id:e}=Ps(),t=tr(),r=hr(),[i,s]=N.useState(null),[a,o]=N.useState(null),[l,d]=N.useState(null),[c,u]=N.useState([]),[f,h]=N.useState(!1),[p,y]=N.useState(!0),[x,g]=N.useState(null),[v,k]=N.useState(!1),[T,m]=N.useState(null),w=N.useRef(null),[E,b]=N.useState({width:800,height:600}),[_,A]=N.useState(!1),[S]=oe.useForm(),{isAuthenticated:j}=ut(R=>R.exhibitorAuth);N.useEffect(()=>{const R=()=>{A(window.innerWidth<768)};return R(),window.addEventListener("resize",R),()=>{window.removeEventListener("resize",R)}},[]);const C=N.useCallback(R=>R.status==="booked"||R.status==="reserved",[]),P=N.useCallback(()=>{if(w.current){const{clientWidth:R,clientHeight:U}=w.current,O=_?320:800,I=_?480:600,W=Math.max(R||O,O),J=Math.max(U||I,I);(Math.abs(W-E.width)>5||Math.abs(J-E.height)>5)&&b({width:W,height:J})}},[E.width,E.height,_]);N.useEffect(()=>{let R=null;const U=()=>{R===null&&(R=window.setTimeout(()=>{R=null,P()},_?100:50))};P();const O=new ResizeObserver(U);return w.current&&O.observe(w.current),window.addEventListener("resize",U),()=>{R!==null&&window.clearTimeout(R),O.disconnect(),window.removeEventListener("resize",U)}},[P,_]),N.useEffect(()=>{(async()=>{try{if(!e){g("Exhibition ID is missing"),y(!1);return}y(!0),g(null);const U=await Ir.getLayout(e);s(U.data)}catch(U){g(U.message||"Failed to fetch layout"),console.error("Error fetching exhibition:",U)}finally{y(!1)}})()},[e]),N.useEffect(()=>{i&&P()},[i]),N.useEffect(()=>{j&&i&&(d(null),u([]),P(),Se.info("You can now select stalls to book.",3))},[j]);const M=N.useCallback(async R=>{if(C(R)){Se.info(`This stall (${R.stallNumber}) is already booked.`);return}if(!j){r(Zn("stall-booking"));return}const O=R._id||R.id;u(I=>I.includes(O)?(Se.info(`Stall ${R.stallNumber} removed from selection`),I.filter(W=>W!==O)):(Se.success(`Stall ${R.stallNumber} added to selection`),[...I,O]))},[C,j,r]),X=async R=>{try{k(!0);const U={...R,exhibitionId:i==null?void 0:i.exhibition._id,stallIds:R.selectedStalls};if(j){const O=await Ir.exhibitorBookStalls(U);Se.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{const O=await Ir.bookMultipleStalls(e,U);Se.success("Your booking request has been submitted successfully!")}if(h(!1),u([]),e)try{const O=await Ir.getLayout(e);s(O.data)}catch(O){console.error("Error refreshing layout data:",O)}}catch(U){console.error("Error booking stall",U),Se.error("Failed to book stall. Please try again.")}finally{k(!1)}},ee=async()=>{var R;try{if(!i)return;k(!0);let U=null;if(l){const I=i.layout.find(W=>W.stalls.some(J=>J.id===l));I?U=I.stalls.find(W=>W.id===l)||null:console.error("Selected stall not found in any hall")}const O=i.layout.flatMap(I=>I.stalls.map(W=>({...W,hallId:I.id,hallName:I.name}))).filter(I=>I.status==="available");if(c.length===0&&l===null&&O.length===0){Se.error("No stalls are available for booking");return}if(!i.exhibition.basicAmenities)try{const I=await Ir.getExhibition(e||"");(R=I==null?void 0:I.data)!=null&&R.basicAmenities&&s({...i,exhibition:{...i.exhibition,basicAmenities:I.data.basicAmenities}})}catch(I){console.error("Error fetching exhibition details with amenities:",I)}m(O),h(!0)}catch(U){console.error("Error opening booking modal:",U),Se.error("Failed to open booking form")}finally{k(!1)}};N.useCallback(R=>{R.cancelBubble=!0},[]);const q=N.useMemo(()=>{var R;return i?{halls:i.layout.map(U=>n.jsx(R0,{hall:{...U,exhibitionId:e||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},U.id)),stalls:i.layout.flatMap(U=>U.stalls.map(O=>{var I,W,J,he,ye,H,Y,le;return n.jsx(D0,{stall:{...O,hallId:U.id,hallName:U.name,isSelected:c.includes(O.id),stallTypeId:"default",number:O.stallNumber,typeName:O.type||"Standard",ratePerSqm:O.price||0,rotation:0,dimensions:{x:((I=O.position)==null?void 0:I.x)||0,y:((W=O.position)==null?void 0:W.y)||0,width:((J=O.dimensions)==null?void 0:J.width)||0,height:((he=O.dimensions)==null?void 0:he.height)||0},status:O.status==="maintenance"?"booked":O.status},isSelected:l===O.id||c.includes(O.id),onSelect:O.status==="available"?()=>M(O):void 0,hallWidth:((ye=U.dimensions)==null?void 0:ye.width)||0,hallHeight:((H=U.dimensions)==null?void 0:H.height)||0,hallX:((Y=U.dimensions)==null?void 0:Y.x)||0,hallY:((le=U.dimensions)==null?void 0:le.y)||0},O.id)})),fixtures:(R=i.fixtures)==null?void 0:R.map(U=>{var O,I;return n.jsx(P0,{fixture:{...U,id:U.id||U._id,_id:U._id||U.id,exhibitionId:e||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:((O=i.exhibition.dimensions)==null?void 0:O.width)||0,exhibitionHeight:((I=i.exhibition.dimensions)==null?void 0:I.height)||0},U.id||U._id)})}:null},[i,e,l,c,M]);return p?n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(aa,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Rt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):x||!i?n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(aa,{style:{paddingTop:"64px"},children:n.jsx(ps,{status:"error",title:"Failed to load exhibition layout",subTitle:x||"The exhibition layout couldn't be loaded.",extra:[n.jsx(fe,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):!((K=i.exhibition.dimensions)!=null&&K.width)||!((Q=i.exhibition.dimensions)!=null&&Q.height)?n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(aa,{style:{paddingTop:"64px"},children:n.jsx(Ae,{children:n.jsx(ps,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]}):n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsxs(aa,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[_&&n.jsx("div",{style:{height:"16px",width:"100%"}}),n.jsxs(Ae,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:_?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:_?"5px":"24px"},children:[n.jsxs(ze,{gutter:[24,24],style:{marginBottom:_?16:32},children:[n.jsx(ae,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:_?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:_?"column":"row",alignItems:_?"flex-start":"center",gap:_?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:_?"center":"flex-start",width:_?"100%":"auto"},children:i.exhibition.headerLogo?n.jsx(Ch,{src:Iv(i.exhibition.headerLogo),alt:`${i.exhibition.name} logo`,style:{maxHeight:_?70:90,maxWidth:_?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:_?200:250,height:_?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:n.jsx(Rt,{size:"small"})})}):n.jsx("div",{style:{width:_?70:90,height:_?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:n.jsx(cn,{style:{fontSize:_?24:32,color:"#aaa"}})})}),!_&&n.jsx(Tt,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),n.jsxs("div",{style:{flex:1,width:_?"100%":"auto"},children:[n.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:_?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i.exhibition.name}),n.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:_?"13px":"14px"},children:[n.jsx(cn,{style:{fontSize:_?"14px":"16px",color:"#1890ff"}}),n.jsxs("span",{children:[new Date(i.exhibition.startDate).toLocaleDateString()," -",new Date(i.exhibition.endDate).toLocaleDateString()]})]}),n.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:_?"13px":"14px"},children:[n.jsx(or,{style:{fontSize:_?"14px":"16px",color:"#1890ff"}}),n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:_?"nowrap":"normal",maxWidth:_?"260px":"none"},children:i.exhibition.venue})]})]})]})}),n.jsx(ae,{xs:24,sm:24,md:12,children:n.jsxs("div",{style:{padding:_?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[n.jsx("div",{style:{marginBottom:"16px",fontSize:_?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),n.jsxs("div",{style:{display:"flex",flexDirection:_?"column":"row",justifyContent:"center",alignItems:"center",gap:_?"10px":"16px",width:"100%"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:_?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(Br,{status:"success"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:_?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(Br,{status:"processing",color:"#1890ff"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:_?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[n.jsx(Br,{status:"warning"}),n.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),n.jsxs("div",{ref:w,style:{width:"100%",height:_?"70vh":"80vh",minHeight:_?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[n.jsx("style",{children:`
                /* Hide only canvas context menu in public view */
                .konvajs-content .ant-menu {
                  display: none !important;
                }
                
                /* Base canvas optimization */
                .konvajs-content {
                  will-change: transform;
                  transform: translateZ(0);
                  backface-visibility: hidden;
                  transition: filter 0.2s ease-out;
                }
                
                /* Fast layer for static background */
                .public-canvas-container .konvajs-content canvas:first-child {
                  image-rendering: auto;
                }
                
                /* Canvas optimization for all canvases */
                .public-canvas-container canvas {
                  backface-visibility: hidden;
                  -webkit-backface-visibility: hidden;
                  transition: filter 0.15s linear;
                }
                
                /* Dragging state - apply blur effect with better control */
                .public-canvas-container .konvajs-content.dragging {
                  filter: blur(1px);
                }
                
                /* Mobile-specific blur - slightly stronger */
                @media (max-width: 768px) {
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(1.5px);
                  }
                }
                
                /* Performance optimizations for dragging */
                .public-canvas-container .konvajs-content:active canvas {
                  image-rendering: optimizeSpeed;
                }
                
                /* Touch device optimizations */
                @media (pointer: coarse) {
                  .public-canvas-container .konvajs-content:active {
                    touch-action: none;
                  }
                  
                  .public-canvas-container .konvajs-content.dragging {
                    filter: blur(2px); /* Stronger blur for touch devices */
                  }
                }
                
                /* Animation smoothing to reduce flickering */
                .public-canvas-container .konvajs-content canvas {
                  will-change: filter;
                  transform: translateZ(0);
                }
                
                /* Low-end device optimizations */
                @media (max-width: 480px), 
                       (resolution: 150dpi),
                       (any-pointer: coarse) {
                  .public-canvas-container .konvajs-content:active canvas {
                    image-rendering: optimizeSpeed;
                  }
                }
              `}),n.jsxs(pv,{width:E.width,height:E.height,exhibitionWidth:((ie=i==null?void 0:i.exhibition.dimensions)==null?void 0:ie.width)||0,exhibitionHeight:((Z=i==null?void 0:i.exhibition.dimensions)==null?void 0:Z.height)||0,halls:(i==null?void 0:i.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[q==null?void 0:q.halls,q==null?void 0:q.stalls,q==null?void 0:q.fixtures]})]})]})]}),c.length>0&&n.jsx(Tx,{offsetBottom:20,children:n.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:n.jsxs(fe,{type:"primary",size:"large",icon:n.jsx(qa,{}),onClick:ee,loading:v,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",c.length,")"]})})}),n.jsx(Cv,{visible:f,stallDetails:T,selectedStallId:l,selectedStallIds:c,loading:v,exhibition:i==null?void 0:i.exhibition,onCancel:()=>{h(!1)},onSubmit:X})]})},Fv=_t.memo(Nv),{Content:dl}=Et,{Title:ul,Text:qn,Paragraph:du}=Ue,hl=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/")||t.includes("sponsors/"))return`${Pe.defaults.baseURL}/public/images/${t}`;const r=localStorage.getItem("token"),i=`uploads/${t}`;return r?`${Pe.defaults.baseURL}/${i}?token=${r}`:`${Pe.defaults.baseURL}/${i}`},Rv=(e,t)=>{const r=new Date,i=new Date(e),s=new Date(t);return r<i?{status:"Upcoming",color:"#722ED1"}:r>s?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},oa=e=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Pv=(e,t)=>{const r=new Date,i=new Date(e),s=new Date(t);if(r<i){const a=i.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} until start`,count:o,isPast:!1}}else if(r>s){const a=r.getTime()-s.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} since end`,count:o,isPast:!0}}else{const a=s.getTime()-r.getTime(),o=Math.ceil(a/(1e3*60*60*24));return{text:`Day${o!==1?"s":""} remaining`,count:o,isPast:!1}}},Dv=()=>{const{id:e}=Ps(),t=tr(),[r,i]=N.useState(null),[s,a]=N.useState(!0),[o,l]=N.useState(null),[d,c]=N.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(N.useEffect(()=>{(async()=>{try{if(!e){l("Exhibition ID is missing");return}a(!0),l(null);const y=await Ir.getExhibition(e);if(i(y.data),y.data.headerBackground){const x=hl(y.data.headerBackground);c(x);const g=new window.Image;g.src=x}else if(y.data.headerLogo){const x=hl(y.data.headerLogo),g=new window.Image;g.src=x}}catch(y){console.error("Error fetching exhibition:",y),l(y.message||"Error fetching exhibition")}finally{a(!1)}})()},[e]),s)return n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(dl,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Rt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(o||!r)return n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(dl,{style:{paddingTop:"64px"},children:n.jsx(ps,{status:"404",title:"Exhibition not found",subTitle:o||"The exhibition you're looking for doesn't exist or has been removed.",extra:n.jsx(fe,{type:"primary",onClick:()=>t("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:u,color:f}=Rv(r.startDate,r.endDate),h=Pv(r.startDate,r.endDate);return n.jsxs(Et,{className:"exhibition-details-layout",children:[n.jsx(Gr,{}),n.jsxs(dl,{className:"exhibition-content",children:[n.jsx("div",{className:"breadcrumb-container",children:n.jsx(Ax,{items:[{title:n.jsx(Cr,{to:"/",children:n.jsx(Sc,{})})},{title:n.jsx(Cr,{to:"/exhibitions",children:"Exhibitions"})},{title:r.name}]})}),n.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${d}')`},children:n.jsx("div",{className:"hero-overlay",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("div",{className:"hero-main",children:[n.jsx(ul,{level:1,className:"exhibition-title",children:r.name}),n.jsxs(ke,{size:24,className:"exhibition-meta",children:[n.jsxs("div",{className:"meta-item",children:[n.jsx(cn,{}),n.jsxs(qn,{children:[oa(r.startDate)," - ",oa(r.endDate)]})]}),r.venue&&n.jsxs("div",{className:"meta-item",children:[n.jsx(Ri,{}),n.jsx(qn,{children:r.venue})]}),n.jsxs("div",{className:"meta-item",children:[n.jsx(br,{}),n.jsxs(qn,{children:[h.text,": ",n.jsx("strong",{children:h.count})]})]})]})]}),n.jsxs("div",{className:"hero-actions",children:[n.jsx(fe,{type:"primary",size:"large",icon:n.jsx(Ec,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),n.jsx(fe,{size:"large",icon:n.jsx($r,{}),onClick:()=>t(`/exhibitions/${e}/layout`),className:"action-button book-button",children:"Book a Stall"}),h.isPast?null:n.jsx(fe,{size:"large",icon:n.jsx(wc,{}),onClick:()=>t("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),n.jsx("div",{className:"stats-container",children:n.jsxs(ze,{gutter:[16,16],className:"stats-row",children:[n.jsx(ae,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon duration-icon",children:n.jsx(cn,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:Math.ceil((new Date(r.endDate).getTime()-new Date(r.startDate).getTime())/(1e3*60*60*24))}),n.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),n.jsx(ae,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon countdown-icon",children:n.jsx(br,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value",children:h.count}),n.jsx("div",{className:"stat-label",children:h.text})]})]})}),n.jsx(ae,{xs:24,sm:8,children:n.jsxs("div",{className:"stat-card",children:[n.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:f+"20",color:f},children:n.jsx(or,{})}),n.jsxs("div",{className:"stat-content",children:[n.jsx("div",{className:"stat-value status-value",style:{color:f},children:u}),n.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),r.sponsorLogos&&r.sponsorLogos.length>0&&n.jsxs("div",{className:"sponsors-section",children:[n.jsx("div",{className:"sponsors-header",children:n.jsx(qn,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),n.jsx("div",{className:"sponsors-container",children:r.sponsorLogos.map((p,y)=>n.jsx("div",{className:"sponsor-logo-wrapper",children:n.jsx("div",{className:"sponsor-logo",children:n.jsx("img",{src:hl(p),alt:`Sponsor ${y+1}`,className:"sponsor-logo-img",onError:x=>{x.target.src="/placeholder-logo.png"}})})},y))})]}),n.jsx("div",{className:"exhibition-details-container",children:n.jsxs(ze,{gutter:[24,24],children:[n.jsx(ae,{xs:24,lg:16,children:n.jsxs(Ae,{className:"details-card about-card",bordered:!1,children:[n.jsx(ul,{level:3,className:"section-title",children:"About This Exhibition"}),n.jsx(du,{className:"main-description",children:r.description}),r.headerDescription&&n.jsx(du,{className:"extended-description",children:r.headerDescription}),r.headerSubtitle&&n.jsxs("div",{className:"subtitle-section",children:[n.jsx(ul,{level:4,children:r.headerSubtitle}),n.jsx(Tt,{})]})]})}),n.jsx(ae,{xs:24,lg:8,children:n.jsx(ke,{direction:"vertical",style:{width:"100%"},size:24,children:n.jsx(Ae,{title:"Key Information",className:"details-card info-card",bordered:!1,children:n.jsxs("div",{className:"info-grid",children:[n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon start-icon",children:n.jsx(cn,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(qn,{type:"secondary",className:"info-label",children:"Start Date"}),n.jsx("div",{className:"info-value",children:oa(r.startDate)})]})]}),n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon end-icon",children:n.jsx(cn,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(qn,{type:"secondary",className:"info-label",children:"End Date"}),n.jsx("div",{className:"info-value",children:oa(r.endDate)})]})]}),r.venue&&n.jsxs("div",{className:"info-item",children:[n.jsx("div",{className:"info-icon venue-icon",children:n.jsx(Ri,{})}),n.jsxs("div",{className:"info-content",children:[n.jsx(qn,{type:"secondary",className:"info-label",children:"Venue"}),n.jsx("div",{className:"info-value",children:r.venue})]})]})]})})})})]})})]}),n.jsx("style",{children:`
        .exhibition-details-layout {
          background-color: #f9fafc;
        }
        
        .exhibition-content {
          padding-top: 64px;
          min-height: calc(100vh - 64px);
        }
        
        .breadcrumb-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 16px 24px;
        }
        
        /* Hero Section */
        .exhibition-hero {
          height: 500px;
          background-size: cover;
          background-position: center;
          position: relative;
          color: white;
          margin-bottom: 0;
        }
        
        .hero-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));
          display: flex;
          align-items: center;
        }
        
        .hero-content {
          max-width: 1280px;
          width: 100%;
          margin: 0 auto;
          padding: 40px 24px;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        
        .hero-main {
          max-width: 800px;
        }
        
        .exhibition-title {
          color: #fff !important;
          margin-bottom: 32px !important;
          font-size: 3.5rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          letter-spacing: -0.5px;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .exhibition-meta {
          margin-bottom: 24px;
        }
        
        .meta-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .meta-item .anticon {
          font-size: 18px;
          color: rgba(255, 255, 255, 0.9);
        }
        
        .meta-item span {
          color: rgba(255, 255, 255, 0.9);
          font-size: 16px;
        }
        
        .hero-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
        }
        
        .action-button {
          padding: 0 24px;
          height: 48px;
          font-weight: 500;
          border-radius: 8px;
          transition: all 0.3s ease;
        }
        
        .layout-button {
          background: #4361ee;
          border-color: #4361ee;
        }
        
        .layout-button:hover {
          background: #3a56d4;
          border-color: #3a56d4;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
        }
        
        .book-button {
          background: white;
          color: #111;
          border-color: transparent;
        }
        
        .book-button:hover {
          background: #f8f9fa;
          color: #4361ee;
          transform: translateY(-2px);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .exhibitor-button {
          border-color: rgba(255, 255, 255, 0.3);
          color: white;
          background: transparent;
        }
        
        .exhibitor-button:hover {
          border-color: white;
          color: white;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-2px);
        }
        
        /* Stats Section */
        .stats-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px;
          margin-top: -50px;
          margin-bottom: 40px;
          position: relative;
          z-index: 5;
        }
        
        .stats-row {
          margin: 0;
        }
        
        .stat-card {
          background: white;
          padding: 24px;
          border-radius: 12px;
          display: flex;
          gap: 20px;
          align-items: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
          height: 100%;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        .stat-icon {
          width: 60px;
          height: 60px;
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
        }
        
        .duration-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .countdown-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .stat-content {
          flex: 1;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 700;
          line-height: 1.2;
          color: #111827;
        }
        
        .stat-label {
          font-size: 14px;
          color: #6b7280;
          margin-top: 4px;
        }
        
        /* Sponsor Logos Styles */
        .sponsors-section {
          max-width: 1280px;
          margin: 0 auto 40px;
          padding: 36px 24px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .sponsors-header {
          text-align: center;
          margin-bottom: 30px;
        }
        
        .sponsors-header .ant-typography {
          font-size: 14px;
          letter-spacing: 2px;
          font-weight: 600;
          color: #6b7280;
          position: relative;
          display: inline-block;
        }
        
        .sponsors-header .ant-typography:before,
        .sponsors-header .ant-typography:after {
          content: "";
          position: absolute;
          top: 50%;
          width: 40px;
          height: 1px;
          background: #e5e7eb;
        }
        
        .sponsors-header .ant-typography:before {
          right: 100%;
          margin-right: 15px;
        }
        
        .sponsors-header .ant-typography:after {
          left: 100%;
          margin-left: 15px;
        }
        
        .sponsors-container {
          display: flex;
          flex-wrap: wrap;
          gap: 30px;
          justify-content: center;
          align-items: center;
        }
        
        .sponsor-logo-wrapper {
          display: inline-flex;
          transition: transform 0.3s ease;
        }
        
        .sponsor-logo-wrapper:hover {
          transform: translateY(-5px);
        }
        
        .sponsor-logo {
          width: 190px;
          height: auto;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #ffffff;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
          padding: 20px;
          transition: box-shadow 0.3s ease;
        }
        
        .sponsor-logo:hover {
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sponsor-logo-img {
          max-width: 100%;
          max-height: 100%;
          object-fit: contain;
        }
        
        /* Details Section */
        .exhibition-details-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 24px 60px;
        }
        
        .details-card {
          border-radius: 16px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          height: 100%;
        }
        
        .about-card .ant-card-body {
          padding: 32px;
        }
        
        .section-title {
          margin-bottom: 24px !important;
          font-weight: 700 !important;
          color: #111827 !important;
          font-size: 28px !important;
          position: relative;
        }
        
        .section-title:after {
          content: "";
          position: absolute;
          left: 0;
          bottom: -12px;
          width: 60px;
          height: 4px;
          background: #4361ee;
          border-radius: 2px;
        }
        
        .main-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #374151 !important;
        }
        
        .extended-description {
          font-size: 16px !important;
          line-height: 1.7 !important;
          margin-bottom: 24px !important;
          color: #6b7280 !important;
        }
        
        .subtitle-section {
          margin: 24px 0;
        }
        
        .subtitle-section .ant-typography {
          color: #111827;
          font-weight: 600;
        }
        
        .info-card .ant-card-head {
          border-bottom: none;
          padding: 20px 24px 0;
        }
        
        .info-card .ant-card-head-title {
          font-weight: 600;
          font-size: 18px;
          color: #111827;
        }
        
        .info-card .ant-card-body {
          padding: 16px 24px 24px;
        }
        
        .info-grid {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }
        
        .info-item {
          display: flex;
          align-items: flex-start;
          gap: 16px;
        }
        
        .info-icon {
          width: 40px;
          height: 40px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
        }
        
        .start-icon {
          background-color: #4361ee20;
          color: #4361ee;
        }
        
        .end-icon {
          background-color: #f7257520;
          color: #f72575;
        }
        
        .venue-icon {
          background-color: #0ea5e920;
          color: #0ea5e9;
        }
        
        .info-content {
          flex: 1;
        }
        
        .info-label {
          display: block;
          margin-bottom: 4px;
          font-size: 14px;
        }
        
        .info-value {
          font-size: 16px;
          font-weight: 500;
          color: #111827;
        }
        
        @media (max-width: 991px) {
          .exhibition-hero {
            height: auto;
            min-height: 350px;
          }
          
          .hero-overlay {
            position: relative;
            padding: 50px 0;
          }
          
          .exhibition-title {
            font-size: 2.5rem !important;
          }
          
          .stats-container {
            margin-top: 0;
          }
          
          .stat-card {
            margin-bottom: 16px;
          }
        }
        
        @media (max-width: 768px) {
          .exhibition-title {
            font-size: 2rem !important;
            margin-bottom: 24px !important;
          }
          
          .hero-content {
            padding: 40px 20px;
          }
          
          .hero-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .hero-actions button {
            width: 100%;
          }
          
          .sponsors-container {
            gap: 20px;
          }
          
          .sponsor-logo {
            width: 150px;
          }
          
          .stats-container {
            padding: 0 16px;
          }
          
          .stat-card {
            padding: 16px;
          }
          
          .stat-icon {
            width: 50px;
            height: 50px;
            font-size: 20px;
          }
          
          .stat-value {
            font-size: 22px;
          }
          
          .exhibition-details-container {
            padding: 0 16px 40px;
          }
          
          .about-card .ant-card-body {
            padding: 24px;
          }
          
          .section-title {
            font-size: 24px !important;
          }
        }
        
        @media (max-width: 480px) {
          .exhibition-title {
            font-size: 1.75rem !important;
          }
          
          .meta-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
          }
        }
        `})]})},{Title:uu,Text:fl,Paragraph:hu}=Ue,{Content:pl}=Et,Ov=(e,t)=>{const r=new Date,i=new Date(e),s=new Date(t);return r<i?{status:"Upcoming",color:"#722ED1"}:r>s?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}},fu=e=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},Lv=e=>{const t=new Date,i=new Date(e).getTime()-t.getTime();return Math.ceil(i/(1e3*60*60*24))},pu=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/")||e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e,r=t.includes("logos/")?t:`logos/${t}`;return`${Pe.defaults.baseURL}/public/images/${r}`},Mv=()=>{const e=tr(),[t,r]=N.useState([]),[i,s]=N.useState(!0),[a,o]=N.useState(null),[l,d]=N.useState({});return N.useEffect(()=>{(async()=>{try{s(!0),o(null);const u=await Ir.getExhibitions();r(u.data);const f={};u.data.forEach(h=>{if(h.headerLogo){const p=pu(h.headerLogo),y=new window.Image;y.onload=()=>{f[h._id]=!0,d(x=>({...x,[h._id]:!0}))},y.onerror=()=>{console.warn(`Failed to preload image: ${p}`),f[h._id]=!1,d(x=>({...x,[h._id]:!1}))},y.src=p}})}catch(u){o(u.message||"Failed to fetch exhibitions")}finally{s(!1)}})()},[]),i?n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(pl,{style:{paddingTop:"64px"},children:n.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[n.jsx(Rt,{size:"large"}),n.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):a?n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(pl,{style:{paddingTop:"64px"},children:n.jsx(ps,{status:"error",title:"Failed to load exhibitions",subTitle:a,extra:[n.jsx(fe,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):n.jsxs(Et,{children:[n.jsx(Gr,{}),n.jsx(pl,{style:{paddingTop:"64px",background:"#f5f5f5"},children:n.jsxs("div",{style:{padding:"80px 16px"},children:[n.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[n.jsx(uu,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),n.jsx(hu,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),t.length>0?n.jsx(ze,{gutter:[24,24],children:t.map(c=>{const{status:u,color:f}=Ov(c.startDate,c.endDate),h=Lv(c.startDate),p=c.headerLogo?pu(c.headerLogo):void 0;return n.jsx(ae,{xs:24,sm:12,lg:8,children:n.jsxs(Ae,{hoverable:!0,onClick:()=>e(F0(c)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[n.jsx(Br.Ribbon,{text:u,color:f,style:{right:"-1px",top:"10px",zIndex:2}}),n.jsxs("div",{className:"exhibition-card-container",children:[n.jsx("div",{className:"exhibition-card-logo-container",children:p&&n.jsx("div",{className:"exhibition-logo",children:n.jsx(Ch,{src:p,alt:`${c.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:n.jsx(Rt,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsxs("div",{className:"exhibition-card-content",children:[n.jsx("div",{className:"exhibition-title",children:n.jsx(uu,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:c.name})}),n.jsx(hu,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:c.description}),n.jsxs("div",{className:"exhibition-card-details",children:[n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(cn,{style:{color:"#722ED1"}}),n.jsx(ht,{title:"Exhibition Date Range",children:n.jsxs(fl,{style:{fontSize:14},children:[fu(c.startDate)," - ",fu(c.endDate)]})})]}),c.venue&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(Ri,{style:{color:"#F5222D"}}),n.jsx(ht,{title:"Venue",children:n.jsx(fl,{style:{fontSize:14},ellipsis:!0,children:c.venue})})]}),u==="Upcoming"&&h>0&&n.jsxs("div",{className:"exhibition-card-detail-item",children:[n.jsx(br,{style:{color:"#1890FF"}}),n.jsx(ht,{title:"Time Remaining",children:n.jsxs(fl,{style:{fontSize:14},children:["Starts in ",h," day",h!==1?"s":""]})})]})]}),n.jsx("div",{className:"exhibition-card-footer",children:n.jsxs(fe,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",n.jsx(Jl,{})]})})]})]})]})},c._id)})}):n.jsx(xt,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:xt.PRESENTED_IMAGE_SIMPLE})]})}),n.jsx(N0,{}),n.jsx("style",{children:`
        .exhibition-card {
          transition: all 0.3s ease;
        }
        
        .exhibition-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;
        }
        
        .exhibition-card-container {
          display: flex;
          flex-direction: row;
          width: 100%;
          height: 100%;
        }
        
        .exhibition-card-logo-container {
          width: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
          background-color: #f9f9f9;
          border-right: 1px solid #eaeaea;
        }
        
        .exhibition-logo {
          position: relative;
          flex-shrink: 0;
          width: 100%;
          height: 172px;
          border-radius: 8px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          border: 1px solid #e8e8e8;
        }
        
        .exhibition-card-content {
          width: 50%;
          padding: 24px;
          display: flex;
          flex-direction: column;
        }
        
        .exhibition-title {
          margin-right: 36px;
        }
        
        .exhibition-card-details {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 24px;
        }
        
        .exhibition-card-detail-item {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .exhibition-card-footer {
          margin-top: auto;
        }
        
        .view-details-btn {
          color: #722ED1;
        }
        
        .view-details-btn:hover {
          color: #9254DE;
        }
        
        .view-details-btn .anticon {
          transition: transform 0.3s ease;
        }
        
        .view-details-btn:hover .anticon {
          transform: translateX(4px);
        }
        
        @media (max-width: 575px) {
          .exhibition-card-container {
            flex-direction: column;
          }
          
          .exhibition-card-logo-container {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid #eaeaea;
            padding: 20px;
          }
          
          .exhibition-logo {
            height: 140px;
          }
          
          .exhibition-card-content {
            width: 100%;
            padding: 20px;
          }
        }
        `})]})};class Bv extends _t.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Lazy loading error:",t,r)}render(){return this.state.hasError?n.jsx(Ct,{message:"Something went wrong",description:"The component failed to load. Please try refreshing the page.",type:"error",showIcon:!0}):this.props.children}}const $v=()=>n.jsx("div",{style:{padding:"20px",textAlign:"center"},children:n.jsx(Rt,{size:"large"})});function fr(e,t=$v){const r=N.lazy(e);return i=>n.jsx(Bv,{children:n.jsx(N.Suspense,{fallback:n.jsx(t,{}),children:n.jsx(r,{...i})})})}const Uv={bookings:[],currentBooking:null,loading:!1,statsLoading:!1,error:null,pagination:{total:0,page:1,limit:10,pages:0},stats:{total:0,pending:0,approved:0,rejected:0,confirmed:0,cancelled:0,totalRevenue:0,totalBaseAmount:0}},os=Ye("booking/fetchBookings",async(e={},{rejectWithValue:t})=>{var r,i;try{const s={};return e.page&&(s.page=e.page),e.limit&&(s.limit=e.limit),(await Pe.get("/bookings",{params:s})).data}catch(s){return t(((i=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch bookings")}}),xl=Ye("booking/fetchBooking",async e=>(await Pe.get(`/bookings/${e}`)).data),Ra=Ye("booking/createBooking",async e=>(await Pe.post("/bookings",e)).data),Pa=Ye("booking/updateStatus",async({id:e,status:t,rejectionReason:r})=>(await Pe.patch(`/bookings/${e}`,{status:t,...r&&{rejectionReason:r}})).data),ml=Ye("booking/updatePaymentStatus",async({id:e,paymentStatus:t,paymentDetails:r})=>(await Pe.patch(`/bookings/${e}/payment`,{paymentStatus:t,paymentDetails:r})).data),Da=Ye("booking/deleteBooking",async e=>(await Pe.delete(`/bookings/${e}`),e)),Oa=Ye("booking/fetchBookingStats",async(e,{rejectWithValue:t})=>{var r,i;try{return(await Pe.get("/bookings/stats")).data}catch(s){return t(((i=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch booking statistics")}}),L0=gr({name:"booking",initialState:Uv,reducers:{clearCurrentBooking:e=>{e.currentBooking=null},clearBookingError:e=>{e.error=null}},extraReducers:e=>{e.addCase(os.pending,t=>{t.loading=!0,t.error=null}).addCase(os.fulfilled,(t,r)=>{t.loading=!1,t.bookings=r.payload.data||[],r.payload.pagination&&(t.pagination=r.payload.pagination)}).addCase(os.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch bookings"}).addCase(xl.pending,t=>{t.loading=!0,t.error=null}).addCase(xl.fulfilled,(t,r)=>{t.loading=!1,t.currentBooking=r.payload}).addCase(xl.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to fetch booking"}).addCase(Ra.pending,t=>{t.loading=!0,t.error=null}).addCase(Ra.fulfilled,(t,r)=>{t.loading=!1,t.bookings.unshift(r.payload),t.currentBooking=r.payload}).addCase(Ra.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to create booking"}).addCase(Pa.pending,t=>{t.loading=!0,t.error=null}).addCase(Pa.fulfilled,(t,r)=>{var s;t.loading=!1;const i=t.bookings.findIndex(a=>a._id===r.payload._id);i!==-1&&(t.bookings[i]=r.payload),((s=t.currentBooking)==null?void 0:s._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(Pa.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update booking status"}).addCase(ml.pending,t=>{t.loading=!0,t.error=null}).addCase(ml.fulfilled,(t,r)=>{var s;t.loading=!1;const i=t.bookings.findIndex(a=>a._id===r.payload._id);i!==-1&&(t.bookings[i]=r.payload),((s=t.currentBooking)==null?void 0:s._id)===r.payload._id&&(t.currentBooking=r.payload)}).addCase(ml.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to update payment status"}).addCase(Oa.pending,t=>{t.statsLoading=!0,t.error=null}).addCase(Oa.fulfilled,(t,r)=>{t.statsLoading=!1,t.stats=r.payload}).addCase(Oa.rejected,(t,r)=>{t.statsLoading=!1,t.error=r.error.message||"Failed to fetch booking statistics"}).addCase(Da.pending,t=>{t.loading=!0,t.error=null}).addCase(Da.fulfilled,(t,r)=>{var i;t.loading=!1,t.bookings=t.bookings.filter(s=>s._id!==r.payload),((i=t.currentBooking)==null?void 0:i._id)===r.payload&&(t.currentBooking=null)}).addCase(Da.rejected,(t,r)=>{t.loading=!1,t.error=r.error.message||"Failed to delete booking"})}}),{clearCurrentBooking:fk,clearBookingError:pk}=L0.actions,zv=L0.reducer,$t=e=>{var r,i;const t=((i=(r=e.response)==null?void 0:r.data)==null?void 0:i.message)||"An error occurred";throw new Error(t)},Fr={getExhibitions:async()=>{try{return await Pe.get("/exhibitions")}catch(e){return $t(e)}},getActiveExhibitions:async()=>{try{return await Pe.get("/exhibitions/active")}catch(e){return $t(e)}},getExhibition:async e=>{try{return await Pe.get(`/exhibitions/${e}`)}catch(t){return $t(t)}},createExhibition:async e=>{try{return await Pe.post("/exhibitions",e)}catch(t){return $t(t)}},updateExhibition:async(e,t)=>{try{return await Pe.put(`/exhibitions/${e}`,t)}catch(r){return $t(r)}},deleteExhibition:async e=>{try{return await Pe.delete(`/exhibitions/${e}`)}catch(t){return $t(t)}},getHalls:async e=>{try{return await Pe.get(`/exhibitions/${e}/halls`)}catch(t){return $t(t)}},createHall:async(e,t)=>{try{const{_id:r,id:i,createdAt:s,updatedAt:a,...o}=t;return console.log("Creating hall with data:",{exhibitionId:e,data:o}),(await Pe.post(`/exhibitions/${e}/halls`,o)).data}catch(r){throw console.error("Error creating hall:",r),r}},updateHall:async(e,t,r)=>{try{const{_id:i,id:s,createdAt:a,updatedAt:o,...l}=r;console.log("Updating hall with data:",{exhibitionId:e,hallId:t,data:l});const d=await Pe.put(`/exhibitions/${e}/halls/${t}`,l);return console.log("Hall updated:",d.data),d}catch(i){return console.error("Error updating hall:",i),$t(i)}},deleteHall:async(e,t)=>{var r,i,s;try{if(!e||!t)throw new Error("Exhibition ID and Hall ID are required");console.log("Deleting hall:",{exhibitionId:e,hallId:t});const a=await Pe.delete(`/exhibitions/${e}/halls/${t}`);if(!a.data)throw new Error("No response received from server");return a}catch(a){throw console.error("Error deleting hall:",a),((r=a.response)==null?void 0:r.status)===401?new Error("Unauthorized. Please log in again."):((i=a.response)==null?void 0:i.status)===403?new Error("You do not have permission to delete halls."):((s=a.response)==null?void 0:s.status)===404?new Error("Hall not found."):a}},saveLayout:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return{data:{halls:t}}}catch(r){return $t(r)}},getLayout:async e=>{try{if(!e)throw new Error("Exhibition ID is required");return await Pe.get(`/exhibitions/${e}/layout`)}catch(t){return $t(t)}},getStalls:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await Pe.get(`/exhibitions/${e}/stalls`,{params:{hallId:t}})}catch(r){return $t(r)}},createStall:async(e,t)=>{try{if(!e)throw new Error("Exhibition ID is required");return await Pe.post(`/exhibitions/${e}/stalls`,t)}catch(r){return $t(r)}},updateStall:async(e,t,r)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");console.log("Updating stall:",{exhibitionId:e,stallId:t,data:r});const i=await Pe.put(`/exhibitions/${e}/stalls/${t}`,r);return console.log("Stall update response:",i),i}catch(i){return console.error("Error updating stall:",i),$t(i)}},deleteStall:async(e,t)=>{try{if(!e||!t)throw new Error("Exhibition ID and Stall ID are required");return await Pe.delete(`/exhibitions/${e}/stalls/${t}`)}catch(r){return $t(r)}},getFixtures:async(e,t)=>{try{const r=`/exhibitions/${e}/fixtures`,i=t?{type:t}:void 0;return await Pe.get(r,{params:i})}catch(r){return $t(r)}},getFixture:async(e,t)=>{try{return await Pe.get(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return $t(r)}},createFixture:async(e,t)=>{try{return await Pe.post(`/exhibitions/${e}/fixtures`,t)}catch(r){return $t(r)}},updateFixture:async(e,t,r)=>{try{return await Pe.put(`/exhibitions/${e}/fixtures/${t}`,r)}catch(i){return $t(i)}},deleteFixture:async(e,t)=>{try{return await Pe.delete(`/exhibitions/${e}/fixtures/${t}`)}catch(r){return $t(r)}}},Wv={exhibitions:[],currentExhibition:null,halls:[],stalls:[],fixtures:[],loading:!1,error:null},Yn=Ye("exhibition/fetchExhibitions",async(e,{rejectWithValue:t})=>{try{return(await Fr.getExhibitions()).data.map(s=>({...s,id:s._id||s.id})).filter(s=>s.id)}catch(r){return t(r.message)}}),La=Ye("exhibition/fetchExhibition",async(e,{rejectWithValue:t})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.getExhibition(e)).data}catch(r){return t(r.message)}}),gl=Ye("exhibition/createExhibition",async(e,{rejectWithValue:t})=>{try{return(await Fr.createExhibition(e)).data}catch(r){return t(r.message)}}),yl=Ye("exhibition/updateExhibition",async({id:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.updateExhibition(e,t)).data}catch(i){return r(i.message)}}),vl=Ye("exhibition/fetchHalls",async(e,{rejectWithValue:t})=>{var r;try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.getHalls(e)).data}catch(i){return((r=i.response)==null?void 0:r.status)===404?[]:t(i.message)}}),bl=Ye("exhibition/fetchStalls",async({exhibitionId:e,hallId:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.getStalls(e,t)).data}catch(i){return r(i.message)}}),wl=Ye("exhibition/deleteExhibition",async(e,{rejectWithValue:t})=>{try{return await Fr.deleteExhibition(e),e}catch(r){return t(r.message)}}),Sl=Ye("exhibition/fetchFixtures",async({exhibitionId:e,type:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.getFixtures(e,t)).data}catch(i){return r(i.message)}}),jl=Ye("exhibition/createFixture",async({exhibitionId:e,data:t},{rejectWithValue:r})=>{try{if(!e)throw new Error("Exhibition ID is required");return(await Fr.createFixture(e,t)).data}catch(i){return r(i.message)}}),El=Ye("exhibition/updateFixture",async({exhibitionId:e,id:t,data:r},{rejectWithValue:i})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return(await Fr.updateFixture(e,t,r)).data}catch(s){return i(s.message)}}),_l=Ye("exhibition/deleteFixture",async({exhibitionId:e,id:t},{rejectWithValue:r})=>{try{if(!e||!t)throw new Error("Exhibition ID and Fixture ID are required");return await Fr.deleteFixture(e,t),t}catch(i){return r(i.message)}}),M0=gr({name:"exhibition",initialState:Wv,reducers:{clearCurrentExhibition:e=>{e.currentExhibition=null,e.halls=[],e.stalls=[],e.fixtures=[],e.error=null},clearError:e=>{e.error=null},clearStalls:e=>{e.stalls=[]},clearFixtures:e=>{e.fixtures=[]}},extraReducers:e=>{e.addCase(Yn.pending,t=>{t.loading=!0,t.error=null}).addCase(Yn.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=r.payload}).addCase(Yn.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(La.pending,t=>{t.loading=!0,t.error=null}).addCase(La.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload}).addCase(La.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(gl.pending,t=>{t.loading=!0,t.error=null}).addCase(gl.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions.push(r.payload)}).addCase(gl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(yl.pending,t=>{t.loading=!0,t.error=null}).addCase(yl.fulfilled,(t,r)=>{t.loading=!1,t.currentExhibition=r.payload;const i=t.exhibitions.findIndex(s=>s.id===r.payload.id);i!==-1&&(t.exhibitions[i]=r.payload)}).addCase(yl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(vl.pending,t=>{t.loading=!0,t.error=null}).addCase(vl.fulfilled,(t,r)=>{t.loading=!1,t.halls=r.payload}).addCase(vl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(bl.pending,t=>{t.loading=!0,t.error=null}).addCase(bl.fulfilled,(t,r)=>{t.loading=!1;const i=r.payload.map(s=>{var a;return{...s,id:s._id||s.id,_id:s._id||s.id,stallTypeId:typeof s.stallTypeId=="string"?s.stallTypeId:(a=s.stallTypeId)==null?void 0:a._id,stallType:s.stallType||{name:"N/A",description:null}}});r.meta.arg.hallId,t.stalls=i}).addCase(bl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(wl.pending,t=>{t.loading=!0,t.error=null}).addCase(wl.fulfilled,(t,r)=>{t.loading=!1,t.exhibitions=t.exhibitions.filter(i=>(i._id||i.id)!==r.payload)}).addCase(wl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Sl.pending,t=>{t.loading=!0,t.error=null}).addCase(Sl.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=r.payload.map(i=>({...i,id:i._id||i.id,_id:i._id||i.id}))}).addCase(Sl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(jl.pending,t=>{t.loading=!0,t.error=null}).addCase(jl.fulfilled,(t,r)=>{t.loading=!1;const i={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id};t.fixtures.push(i)}).addCase(jl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(El.pending,t=>{t.loading=!0,t.error=null}).addCase(El.fulfilled,(t,r)=>{t.loading=!1;const i={...r.payload,id:r.payload._id||r.payload.id,_id:r.payload._id||r.payload.id},s=t.fixtures.findIndex(a=>a.id===i.id||a._id===i._id);s!==-1&&(t.fixtures[s]=i)}).addCase(El.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(_l.pending,t=>{t.loading=!0,t.error=null}).addCase(_l.fulfilled,(t,r)=>{t.loading=!1,t.fixtures=t.fixtures.filter(i=>i.id!==r.payload&&i._id!==r.payload)}).addCase(_l.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearCurrentExhibition:xk,clearError:mk,clearStalls:gk,clearFixtures:yk}=M0.actions,qv=M0.reducer;var Vv=class extends Error{constructor(t){super(t[0].message);Sd(this,"issues");this.name="SchemaError",this.issues=t}},B0=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(B0||{});function xu(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var mu=xs;function $0(e,t){if(e===t||!(mu(e)&&mu(t)||Array.isArray(e)&&Array.isArray(t)))return t;const r=Object.keys(t),i=Object.keys(e);let s=r.length===i.length;const a=Array.isArray(t)?[]:{};for(const o of r)a[o]=$0(e[o],t[o]),s&&(s=e[o]===a[o]);return s?e:a}function Ai(e){let t=0;for(const r in e)t++;return t}var gu=e=>[].concat(...e);function Hv(e){return new RegExp("(^|:)//").test(e)}function Gv(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function Xa(e){return e!=null}function Yv(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var Xv=e=>e.replace(/\/$/,""),Kv=e=>e.replace(/^\//,"");function Qv(e,t){if(!e)return t;if(!t)return e;if(Hv(t))return t;const r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=Xv(e),t=Kv(t),`${e}${r}${t}`}function Jv(e,t,r){return e.has(t)?e.get(t):e.set(t,r).get(t)}var yu=(...e)=>fetch(...e),Zv=e=>e.status>=200&&e.status<=299,eb=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function vu(e){if(!xs(e))return e;const t={...e};for(const[r,i]of Object.entries(t))i===void 0&&delete t[r];return t}function Hc({baseUrl:e,prepareHeaders:t=f=>f,fetchFn:r=yu,paramsSerializer:i,isJsonContentType:s=eb,jsonContentType:a="application/json",jsonReplacer:o,timeout:l,responseHandler:d,validateStatus:c,...u}={}){return typeof fetch>"u"&&r===yu&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(h,p,y)=>{const{getState:x,extra:g,endpoint:v,forced:k,type:T}=p;let m,{url:w,headers:E=new Headers(u.headers),params:b=void 0,responseHandler:_=d??"json",validateStatus:A=c??Zv,timeout:S=l,...j}=typeof h=="string"?{url:h}:h,C,P=p.signal;S&&(C=new AbortController,p.signal.addEventListener("abort",C.abort),P=C.signal);let M={...u,signal:P,...j};E=new Headers(vu(E)),M.headers=await t(E,{getState:x,arg:h,extra:g,endpoint:v,forced:k,type:T,extraOptions:y})||E;const X=O=>typeof O=="object"&&(xs(O)||Array.isArray(O)||typeof O.toJSON=="function");if(!M.headers.has("content-type")&&X(M.body)&&M.headers.set("content-type",a),X(M.body)&&s(M.headers)&&(M.body=JSON.stringify(M.body,o)),b){const O=~w.indexOf("?")?"&":"?",I=i?i(b):new URLSearchParams(vu(b));w+=O+I}w=Qv(e,w);const ee=new Request(w,M);m={request:new Request(w,M)};let K,Q=!1,ie=C&&setTimeout(()=>{Q=!0,C.abort()},S);try{K=await r(ee)}catch(O){return{error:{status:Q?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(O)},meta:m}}finally{ie&&clearTimeout(ie),C==null||C.signal.removeEventListener("abort",C.abort)}const Z=K.clone();m.response=Z;let R,U="";try{let O;if(await Promise.all([f(K,_).then(I=>R=I,I=>O=I),Z.text().then(I=>U=I,()=>{})]),O)throw O}catch(O){return{error:{status:"PARSING_ERROR",originalStatus:K.status,data:U,error:String(O)},meta:m}}return A(K,R)?{data:R,meta:m}:{error:{status:K.status,data:R},meta:m}};async function f(h,p){if(typeof p=="function")return p(h);if(p==="content-type"&&(p=s(h.headers)?"json":"text"),p==="json"){const y=await h.text();return y.length?JSON.parse(y):null}return h.text()}}var bu=class{constructor(e,t=void 0){this.value=e,this.meta=t}},Gc=Li("__rtkq/focused"),U0=Li("__rtkq/unfocused"),Yc=Li("__rtkq/online"),z0=Li("__rtkq/offline");function Ro(e){return e.type==="query"}function tb(e){return e.type==="mutation"}function Po(e){return e.type==="infinitequery"}function Ka(e){return Ro(e)||Po(e)}function Xc(e,t,r,i,s,a){return rb(e)?e(t,r,i,s).filter(Xa).map(hc).map(a):Array.isArray(e)?e.map(hc).map(a):[]}function rb(e){return typeof e=="function"}function hc(e){return typeof e=="string"?{type:e}:e}function nb(e,t){return e.catch(t)}var ws=Symbol("forceQueryFn"),fc=e=>typeof e[ws]=="function";function ib({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:r,mutationThunk:i,api:s,context:a}){const o=new Map,l=new Map,{unsubscribeQueryResult:d,removeMutationResult:c,updateSubscriptionOptions:u}=s.internalActions;return{buildInitiateQuery:g,buildInitiateInfiniteQuery:v,buildInitiateMutation:k,getRunningQueryThunk:f,getRunningMutationThunk:h,getRunningQueriesThunk:p,getRunningMutationsThunk:y};function f(T,m){return w=>{var _;const E=a.endpointDefinitions[T],b=e({queryArgs:m,endpointDefinition:E,endpointName:T});return(_=o.get(w))==null?void 0:_[b]}}function h(T,m){return w=>{var E;return(E=l.get(w))==null?void 0:E[m]}}function p(){return T=>Object.values(o.get(T)||{}).filter(Xa)}function y(){return T=>Object.values(l.get(T)||{}).filter(Xa)}function x(T,m){const w=(E,{subscribe:b=!0,forceRefetch:_,subscriptionOptions:A,[ws]:S,...j}={})=>(C,P)=>{var W;const M=e({queryArgs:E,endpointDefinition:m,endpointName:T});let X;const ee={...j,type:"query",subscribe:b,forceRefetch:_,subscriptionOptions:A,endpointName:T,originalArgs:E,queryCacheKey:M,[ws]:S};if(Ro(m))X=t(ee);else{const{direction:J,initialPageParam:he}=j;X=r({...ee,direction:J,initialPageParam:he})}const q=s.endpoints[T].select(E),K=C(X),Q=q(P()),{requestId:ie,abort:Z}=K,R=Q.requestId!==ie,U=(W=o.get(C))==null?void 0:W[M],O=()=>q(P()),I=Object.assign(S?K.then(O):R&&!U?Promise.resolve(Q):Promise.all([U,K]).then(O),{arg:E,requestId:ie,subscriptionOptions:A,queryCacheKey:M,abort:Z,async unwrap(){const J=await I;if(J.isError)throw J.error;return J.data},refetch:()=>C(w(E,{subscribe:!1,forceRefetch:!0})),unsubscribe(){b&&C(d({queryCacheKey:M,requestId:ie}))},updateSubscriptionOptions(J){I.subscriptionOptions=J,C(u({endpointName:T,requestId:ie,queryCacheKey:M,options:J}))}});if(!U&&!R&&!S){const J=Jv(o,C,{});J[M]=I,I.then(()=>{delete J[M],Ai(J)||o.delete(C)})}return I};return w}function g(T,m){return x(T,m)}function v(T,m){return x(T,m)}function k(T){return(m,{track:w=!0,fixedCacheKey:E}={})=>(b,_)=>{const A=i({type:"mutation",endpointName:T,originalArgs:m,track:w,fixedCacheKey:E}),S=b(A),{requestId:j,abort:C,unwrap:P}=S,M=nb(S.unwrap().then(K=>({data:K})),K=>({error:K})),X=()=>{b(c({requestId:j,fixedCacheKey:E}))},ee=Object.assign(M,{arg:S.arg,requestId:j,abort:C,unwrap:P,reset:X}),q=l.get(b)||{};return l.set(b,q),q[j]=ee,ee.then(()=>{delete q[j],Ai(q)||l.delete(b)}),E&&(q[E]=ee,ee.then(()=>{q[E]===ee&&(delete q[E],Ai(q)||l.delete(b))})),ee}}}var W0=class extends Vv{constructor(e,t,r,i){super(e),this.value=t,this.schemaName=r,this._bqMeta=i}};async function Vn(e,t,r,i){const s=await e["~standard"].validate(t);if(s.issues)throw new W0(s.issues,t,r,i);return s.value}function sb(e){return e}var es=(e={})=>({...e,[Rh]:!0});function ab({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:i,api:s,assertTagType:a,selectors:o,onSchemaFailure:l,catchSchemaFailure:d,skipSchemaValidation:c}){const u=(j,C,P,M)=>(X,ee)=>{const q=r[j],K=i({queryArgs:C,endpointDefinition:q,endpointName:j});if(X(s.internalActions.queryResultPatched({queryCacheKey:K,patches:P})),!M)return;const Q=s.endpoints[j].select(C)(ee()),ie=Xc(q.providesTags,Q.data,void 0,C,{},a);X(s.internalActions.updateProvidedBy([{queryCacheKey:K,providedTags:ie}]))};function f(j,C,P=0){const M=[C,...j];return P&&M.length>P?M.slice(0,-1):M}function h(j,C,P=0){const M=[...j,C];return P&&M.length>P?M.slice(1):M}const p=(j,C,P,M=!0)=>(X,ee)=>{const K=s.endpoints[j].select(C)(ee()),Q={patches:[],inversePatches:[],undo:()=>X(s.util.patchQueryData(j,C,Q.inversePatches,M))};if(K.status==="uninitialized")return Q;let ie;if("data"in K)if(Ix(K.data)){const[Z,R,U]=Dh(K.data,P);Q.patches.push(...R),Q.inversePatches.push(...U),ie=Z}else ie=P(K.data),Q.patches.push({op:"replace",path:[],value:ie}),Q.inversePatches.push({op:"replace",path:[],value:K.data});return Q.patches.length===0||X(s.util.patchQueryData(j,C,Q.patches,M)),Q},y=(j,C,P)=>M=>M(s.endpoints[j].initiate(C,{subscribe:!1,forceRefetch:!0,[ws]:()=>({data:P})})),x=(j,C)=>j.query&&j[C]?j[C]:sb,g=async(j,{signal:C,abort:P,rejectWithValue:M,fulfillWithValue:X,dispatch:ee,getState:q,extra:K})=>{var R,U;const Q=r[j.endpointName],{metaSchema:ie,skipSchemaValidation:Z=c}=Q;try{let O=x(Q,"transformResponse");const I={signal:C,abort:P,dispatch:ee,getState:q,extra:K,endpoint:j.endpointName,type:j.type,forced:j.type==="query"?v(j,q()):void 0,queryCacheKey:j.type==="query"?j.queryCacheKey:void 0},W=j.type==="query"?j[ws]:void 0;let J;const he=async(H,Y,le,de)=>{if(Y==null&&H.pages.length)return Promise.resolve({data:H});const G={queryArg:j.originalArgs,pageParam:Y},xe=await ye(G),ge=de?f:h;return{data:{pages:ge(H.pages,xe.data,le),pageParams:ge(H.pageParams,Y,le)},meta:xe.meta}};async function ye(H){let Y;const{extraOptions:le,argSchema:de,rawResponseSchema:G,responseSchema:xe}=Q;if(de&&!Z&&(H=await Vn(de,H,"argSchema",{})),W?Y=W():Q.query?Y=await t(Q.query(H),I,le):Y=await Q.queryFn(H,I,le,Te=>t(Te,I,le)),typeof process<"u",Y.error)throw new bu(Y.error,Y.meta);let{data:ge}=Y;G&&!Z&&(ge=await Vn(G,Y.data,"rawResponseSchema",Y.meta));let me=await O(ge,Y.meta,H);return xe&&!Z&&(me=await Vn(xe,me,"responseSchema",Y.meta)),{...Y,data:me}}if(j.type==="query"&&"infiniteQueryOptions"in Q){const{infiniteQueryOptions:H}=Q,{maxPages:Y=1/0}=H;let le;const de={pages:[],pageParams:[]},G=(R=o.selectQueryEntry(q(),j.queryCacheKey))==null?void 0:R.data,ge=v(j,q())&&!j.direction||!G?de:G;if("direction"in j&&j.direction&&ge.pages.length){const me=j.direction==="backward",ue=(me?q0:pc)(H,ge);le=await he(ge,ue,Y,me)}else{const{initialPageParam:me=H.initialPageParam}=j,Te=(G==null?void 0:G.pageParams)??[],ue=Te[0]??me,Me=Te.length;le=await he(ge,ue,Y),W&&(le={data:le.data.pages[0]});for(let $e=1;$e<Me;$e++){const ct=pc(H,le.data);le=await he(le.data,ct,Y)}}J=le}else J=await ye(j.originalArgs);return ie&&!Z&&J.meta&&(J.meta=await Vn(ie,J.meta,"metaSchema",J.meta)),X(J.data,es({fulfilledTimeStamp:Date.now(),baseQueryMeta:J.meta}))}catch(O){let I=O;if(I instanceof bu){let W=x(Q,"transformErrorResponse");const{rawErrorResponseSchema:J,errorResponseSchema:he}=Q;let{value:ye,meta:H}=I;try{J&&!Z&&(ye=await Vn(J,ye,"rawErrorResponseSchema",H)),ie&&!Z&&(H=await Vn(ie,H,"metaSchema",H));let Y=await W(ye,H,j.originalArgs);return he&&!Z&&(Y=await Vn(he,Y,"errorResponseSchema",H)),M(Y,es({baseQueryMeta:H}))}catch(Y){I=Y}}try{if(I instanceof W0){const W={endpoint:j.endpointName,arg:j.originalArgs,type:j.type,queryCacheKey:j.type==="query"?j.queryCacheKey:void 0};(U=Q.onSchemaFailure)==null||U.call(Q,I,W),l==null||l(I,W);const{catchSchemaFailure:J=d}=Q;if(J)return M(J(I,W),es({baseQueryMeta:I._bqMeta}))}}catch(W){I=W}throw console.error(I),I}};function v(j,C){const P=o.selectQueryEntry(C,j.queryCacheKey),M=o.selectConfig(C).refetchOnMountOrArgChange,X=P==null?void 0:P.fulfilledTimeStamp,ee=j.forceRefetch??(j.subscribe&&M);return ee?ee===!0||(Number(new Date)-Number(X))/1e3>=ee:!1}const k=()=>Ye(`${e}/executeQuery`,g,{getPendingMeta({arg:C}){const P=r[C.endpointName];return es({startedTimeStamp:Date.now(),...Po(P)?{direction:C.direction}:{}})},condition(C,{getState:P}){var Z;const M=P(),X=o.selectQueryEntry(M,C.queryCacheKey),ee=X==null?void 0:X.fulfilledTimeStamp,q=C.originalArgs,K=X==null?void 0:X.originalArgs,Q=r[C.endpointName],ie=C.direction;return fc(C)?!0:(X==null?void 0:X.status)==="pending"?!1:v(C,M)||Ro(Q)&&((Z=Q==null?void 0:Q.forceRefetch)!=null&&Z.call(Q,{currentArg:q,previousArg:K,endpointState:X,state:M}))?!0:!(ee&&!ie)},dispatchConditionRejection:!0}),T=k(),m=k(),w=Ye(`${e}/executeMutation`,g,{getPendingMeta(){return es({startedTimeStamp:Date.now()})}}),E=j=>"force"in j,b=j=>"ifOlderThan"in j,_=(j,C,P)=>(M,X)=>{const ee=E(P)&&P.force,q=b(P)&&P.ifOlderThan,K=(ie=!0)=>{const Z={forceRefetch:ie,isPrefetch:!0};return s.endpoints[j].initiate(C,Z)},Q=s.endpoints[j].select(C)(X());if(ee)M(K());else if(q){const ie=Q==null?void 0:Q.fulfilledTimeStamp;if(!ie){M(K());return}(Number(new Date)-Number(new Date(ie)))/1e3>=q&&M(K())}else M(K(!1))};function A(j){return C=>{var P,M;return((M=(P=C==null?void 0:C.meta)==null?void 0:P.arg)==null?void 0:M.endpointName)===j}}function S(j,C){return{matchPending:Yo(Ph(j),A(C)),matchFulfilled:Yo(Jn(j),A(C)),matchRejected:Yo(Ac(j),A(C))}}return{queryThunk:T,mutationThunk:w,infiniteQueryThunk:m,prefetch:_,updateQueryData:p,upsertQueryData:y,patchQueryData:u,buildMatchThunkActions:S}}function pc(e,{pages:t,pageParams:r}){const i=t.length-1;return e.getNextPageParam(t[i],t,r[i],r)}function q0(e,{pages:t,pageParams:r}){var i;return(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,r[0],r)}function V0(e,t,r,i){return Xc(r[e.meta.arg.endpointName][t],Jn(e)?e.payload:void 0,Tc(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,i)}function la(e,t,r){const i=e[t];i&&r(i)}function Ss(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function wu(e,t,r){const i=e[Ss(t)];i&&r(i)}var ca={};function ob({reducerPath:e,queryThunk:t,mutationThunk:r,serializeQueryArgs:i,context:{endpointDefinitions:s,apiUid:a,extractRehydrationInfo:o,hasRehydrationInfo:l},assertTagType:d,config:c}){const u=Li(`${e}/resetApiState`);function f(A,S,j,C){var P;A[P=S.queryCacheKey]??(A[P]={status:"uninitialized",endpointName:S.endpointName}),la(A,S.queryCacheKey,M=>{M.status="pending",M.requestId=j&&M.requestId?M.requestId:C.requestId,S.originalArgs!==void 0&&(M.originalArgs=S.originalArgs),M.startedTimeStamp=C.startedTimeStamp;const X=s[C.arg.endpointName];Po(X)&&"direction"in S&&(M.direction=S.direction)})}function h(A,S,j,C){la(A,S.arg.queryCacheKey,P=>{if(P.requestId!==S.requestId&&!C)return;const{merge:M}=s[S.arg.endpointName];if(P.status="fulfilled",M)if(P.data!==void 0){const{fulfilledTimeStamp:X,arg:ee,baseQueryMeta:q,requestId:K}=S;let Q=_c(P.data,ie=>M(ie,j,{arg:ee.originalArgs,baseQueryMeta:q,fulfilledTimeStamp:X,requestId:K}));P.data=Q}else P.data=j;else P.data=s[S.arg.endpointName].structuralSharing??!0?$0(Fx(P.data)?Rx(P.data):P.data,j):j;delete P.error,P.fulfilledTimeStamp=S.fulfilledTimeStamp})}const p=gr({name:`${e}/queries`,initialState:ca,reducers:{removeQueryResult:{reducer(A,{payload:{queryCacheKey:S}}){delete A[S]},prepare:Gi()},cacheEntriesUpserted:{reducer(A,S){for(const j of S.payload){const{queryDescription:C,value:P}=j;f(A,C,!0,{arg:C,requestId:S.meta.requestId,startedTimeStamp:S.meta.timestamp}),h(A,{arg:C,requestId:S.meta.requestId,fulfilledTimeStamp:S.meta.timestamp,baseQueryMeta:{}},P,!0)}},prepare:A=>({payload:A.map(C=>{const{endpointName:P,arg:M,value:X}=C,ee=s[P];return{queryDescription:{type:"query",endpointName:P,originalArgs:C.arg,queryCacheKey:i({queryArgs:M,endpointDefinition:ee,endpointName:P})},value:X}}),meta:{[Rh]:!0,requestId:Ih(),timestamp:Date.now()}})},queryResultPatched:{reducer(A,{payload:{queryCacheKey:S,patches:j}}){la(A,S,C=>{C.data=Cd(C.data,j.concat())})},prepare:Gi()}},extraReducers(A){A.addCase(t.pending,(S,{meta:j,meta:{arg:C}})=>{const P=fc(C);f(S,C,P,j)}).addCase(t.fulfilled,(S,{meta:j,payload:C})=>{const P=fc(j.arg);h(S,j,C,P)}).addCase(t.rejected,(S,{meta:{condition:j,arg:C,requestId:P},error:M,payload:X})=>{la(S,C.queryCacheKey,ee=>{if(!j){if(ee.requestId!==P)return;ee.status="rejected",ee.error=X??M}})}).addMatcher(l,(S,j)=>{const{queries:C}=o(j);for(const[P,M]of Object.entries(C))((M==null?void 0:M.status)==="fulfilled"||(M==null?void 0:M.status)==="rejected")&&(S[P]=M)})}}),y=gr({name:`${e}/mutations`,initialState:ca,reducers:{removeMutationResult:{reducer(A,{payload:S}){const j=Ss(S);j in A&&delete A[j]},prepare:Gi()}},extraReducers(A){A.addCase(r.pending,(S,{meta:j,meta:{requestId:C,arg:P,startedTimeStamp:M}})=>{P.track&&(S[Ss(j)]={requestId:C,status:"pending",endpointName:P.endpointName,startedTimeStamp:M})}).addCase(r.fulfilled,(S,{payload:j,meta:C})=>{C.arg.track&&wu(S,C,P=>{P.requestId===C.requestId&&(P.status="fulfilled",P.data=j,P.fulfilledTimeStamp=C.fulfilledTimeStamp)})}).addCase(r.rejected,(S,{payload:j,error:C,meta:P})=>{P.arg.track&&wu(S,P,M=>{M.requestId===P.requestId&&(M.status="rejected",M.error=j??C)})}).addMatcher(l,(S,j)=>{const{mutations:C}=o(j);for(const[P,M]of Object.entries(C))((M==null?void 0:M.status)==="fulfilled"||(M==null?void 0:M.status)==="rejected")&&P!==(M==null?void 0:M.requestId)&&(S[P]=M)})}}),x={tags:{},keys:{}},g=gr({name:`${e}/invalidation`,initialState:x,reducers:{updateProvidedBy:{reducer(A,S){var j,C,P;for(const{queryCacheKey:M,providedTags:X}of S.payload){v(A,M);for(const{type:ee,id:q}of X){const K=(C=(j=A.tags)[ee]??(j[ee]={}))[P=q||"__internal_without_id"]??(C[P]=[]);K.includes(M)||K.push(M)}A.keys[M]=X}},prepare:Gi()}},extraReducers(A){A.addCase(p.actions.removeQueryResult,(S,{payload:{queryCacheKey:j}})=>{v(S,j)}).addMatcher(l,(S,j)=>{var P,M,X;const{provided:C}=o(j);for(const[ee,q]of Object.entries(C))for(const[K,Q]of Object.entries(q)){const ie=(M=(P=S.tags)[ee]??(P[ee]={}))[X=K||"__internal_without_id"]??(M[X]=[]);for(const Z of Q)ie.includes(Z)||ie.push(Z)}}).addMatcher(Ha(Jn(t),Tc(t)),(S,j)=>{k(S,[j])}).addMatcher(p.actions.cacheEntriesUpserted.match,(S,j)=>{const C=j.payload.map(({queryDescription:P,value:M})=>({type:"UNKNOWN",payload:M,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:P}}));k(S,C)})}});function v(A,S){var C;const j=A.keys[S]??[];for(const P of j){const M=P.type,X=P.id??"__internal_without_id",ee=(C=A.tags[M])==null?void 0:C[X];ee&&(A.tags[M][X]=ee.filter(q=>q!==S))}delete A.keys[S]}function k(A,S){const j=S.map(C=>{const P=V0(C,"providesTags",s,d),{queryCacheKey:M}=C.meta.arg;return{queryCacheKey:M,providedTags:P}});g.caseReducers.updateProvidedBy(A,g.actions.updateProvidedBy(j))}const T=gr({name:`${e}/subscriptions`,initialState:ca,reducers:{updateSubscriptionOptions(A,S){},unsubscribeQueryResult(A,S){},internal_getRTKQSubscriptions(){}}}),m=gr({name:`${e}/internalSubscriptions`,initialState:ca,reducers:{subscriptionsUpdated:{reducer(A,S){return Cd(A,S.payload)},prepare:Gi()}}}),w=gr({name:`${e}/config`,initialState:{online:Yv(),focused:Gv(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(A,{payload:S}){A.middlewareRegistered=A.middlewareRegistered==="conflict"||a!==S?"conflict":!0}},extraReducers:A=>{A.addCase(Yc,S=>{S.online=!0}).addCase(z0,S=>{S.online=!1}).addCase(Gc,S=>{S.focused=!0}).addCase(U0,S=>{S.focused=!1}).addMatcher(l,S=>({...S}))}}),E=Cx({queries:p.reducer,mutations:y.reducer,provided:g.reducer,subscriptions:m.reducer,config:w.reducer}),b=(A,S)=>E(u.match(S)?void 0:A,S),_={...w.actions,...p.actions,...T.actions,...m.actions,...y.actions,...g.actions,resetApiState:u};return{reducer:b,actions:_}}var qr=Symbol.for("RTKQ/skipToken"),H0={status:"uninitialized"},Su=_c(H0,()=>{}),ju=_c(H0,()=>{});function lb({serializeQueryArgs:e,reducerPath:t,createSelector:r}){const i=T=>Su,s=T=>ju;return{buildQuerySelector:h,buildInfiniteQuerySelector:p,buildMutationSelector:y,selectInvalidatedBy:x,selectCachedArgsForQuery:g,selectApiState:o,selectQueries:l,selectMutations:c,selectQueryEntry:d,selectConfig:u};function a(T){return{...T,...xu(T.status)}}function o(T){return T[t]}function l(T){var m;return(m=o(T))==null?void 0:m.queries}function d(T,m){var w;return(w=l(T))==null?void 0:w[m]}function c(T){var m;return(m=o(T))==null?void 0:m.mutations}function u(T){var m;return(m=o(T))==null?void 0:m.config}function f(T,m,w){return E=>{if(E===qr)return r(i,w);const b=e({queryArgs:E,endpointDefinition:m,endpointName:T});return r(A=>d(A,b)??Su,w)}}function h(T,m){return f(T,m,a)}function p(T,m){const{infiniteQueryOptions:w}=m;function E(b){const _={...b,...xu(b.status)},{isLoading:A,isError:S,direction:j}=_,C=j==="forward",P=j==="backward";return{..._,hasNextPage:v(w,_.data),hasPreviousPage:k(w,_.data),isFetchingNextPage:A&&C,isFetchingPreviousPage:A&&P,isFetchNextPageError:S&&C,isFetchPreviousPageError:S&&P}}return f(T,m,E)}function y(){return T=>{let m;return typeof T=="object"?m=Ss(T)??qr:m=T,r(m===qr?s:b=>{var _,A;return((A=(_=o(b))==null?void 0:_.mutations)==null?void 0:A[m])??ju},a)}}function x(T,m){const w=T[t],E=new Set;for(const b of m.filter(Xa).map(hc)){const _=w.provided.tags[b.type];if(!_)continue;let A=(b.id!==void 0?_[b.id]:gu(Object.values(_)))??[];for(const S of A)E.add(S)}return gu(Array.from(E.values()).map(b=>{const _=w.queries[b];return _?[{queryCacheKey:b,endpointName:_.endpointName,originalArgs:_.originalArgs}]:[]}))}function g(T,m){return Object.values(l(T)).filter(w=>(w==null?void 0:w.endpointName)===m&&w.status!=="uninitialized").map(w=>w.originalArgs)}function v(T,m){return m?pc(T,m)!=null:!1}function k(T,m){return!m||!T.getPreviousPageParam?!1:q0(T,m)!=null}}var fi=WeakMap?new WeakMap:void 0,Qa=({endpointName:e,queryArgs:t})=>{let r="";const i=fi==null?void 0:fi.get(t);if(typeof i=="string")r=i;else{const s=JSON.stringify(t,(a,o)=>(o=typeof o=="bigint"?{$bigint:o.toString()}:o,o=xs(o)?Object.keys(o).sort().reduce((l,d)=>(l[d]=o[d],l),{}):o,o));xs(t)&&(fi==null||fi.set(t,s)),r=s}return`${e}(${r})`};function G0(...e){return function(r){const i=kd(c=>{var u;return(u=r.extractRehydrationInfo)==null?void 0:u.call(r,c,{reducerPath:r.reducerPath??"api"})}),s={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:i,serializeQueryArgs(c){let u=Qa;if("serializeQueryArgs"in c.endpointDefinition){const f=c.endpointDefinition.serializeQueryArgs;u=h=>{const p=f(h);return typeof p=="string"?p:Qa({...h,queryArgs:p})}}else r.serializeQueryArgs&&(u=r.serializeQueryArgs);return u(c)},tagTypes:[...r.tagTypes||[]]},a={endpointDefinitions:{},batch(c){c()},apiUid:Ih(),extractRehydrationInfo:i,hasRehydrationInfo:kd(c=>i(c)!=null)},o={injectEndpoints:d,enhanceEndpoints({addTagTypes:c,endpoints:u}){if(c)for(const f of c)s.tagTypes.includes(f)||s.tagTypes.push(f);if(u)for(const[f,h]of Object.entries(u))typeof h=="function"?h(a.endpointDefinitions[f]):Object.assign(a.endpointDefinitions[f]||{},h);return o}},l=e.map(c=>c.init(o,s,a));function d(c){const u=c.endpoints({query:f=>({...f,type:"query"}),mutation:f=>({...f,type:"mutation"}),infiniteQuery:f=>({...f,type:"infinitequery"})});for(const[f,h]of Object.entries(u)){if(c.overrideExisting!==!0&&f in a.endpointDefinitions){if(c.overrideExisting==="throw")throw new Error(Nh(39));continue}a.endpointDefinitions[f]=h;for(const p of l)p.injectEndpoint(f,h)}return o}return o.injectEndpoints({endpoints:r.endpoints})}}function mn(e,...t){return Object.assign(e,...t)}var cb=({api:e,queryThunk:t,internalState:r})=>{const i=`${e.reducerPath}/subscriptions`;let s=null,a=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:l}=e.internalActions,d=(p,y)=>{var g,v,k;if(o.match(y)){const{queryCacheKey:T,requestId:m,options:w}=y.payload;return(g=p==null?void 0:p[T])!=null&&g[m]&&(p[T][m]=w),!0}if(l.match(y)){const{queryCacheKey:T,requestId:m}=y.payload;return p[T]&&delete p[T][m],!0}if(e.internalActions.removeQueryResult.match(y))return delete p[y.payload.queryCacheKey],!0;if(t.pending.match(y)){const{meta:{arg:T,requestId:m}}=y,w=p[v=T.queryCacheKey]??(p[v]={});return w[`${m}_running`]={},T.subscribe&&(w[m]=T.subscriptionOptions??w[m]??{}),!0}let x=!1;if(t.fulfilled.match(y)||t.rejected.match(y)){const T=p[y.meta.arg.queryCacheKey]||{},m=`${y.meta.requestId}_running`;x||(x=!!T[m]),delete T[m]}if(t.rejected.match(y)){const{meta:{condition:T,arg:m,requestId:w}}=y;if(T&&m.subscribe){const E=p[k=m.queryCacheKey]??(p[k]={});E[w]=m.subscriptionOptions??E[w]??{},x=!0}}return x},c=()=>r.currentSubscriptions,h={getSubscriptions:c,getSubscriptionCount:p=>{const x=c()[p]??{};return Ai(x)},isRequestSubscribed:(p,y)=>{var g;const x=c();return!!((g=x==null?void 0:x[p])!=null&&g[y])}};return(p,y)=>{if(s||(s=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(p))return s=r.currentSubscriptions={},a=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(p))return[!1,h];const x=d(r.currentSubscriptions,p);let g=!0;if(x){a||(a=setTimeout(()=>{const T=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,m]=Dh(s,()=>T);y.next(e.internalActions.subscriptionsUpdated(m)),s=T,a=null},500));const v=typeof p.type=="string"&&!!p.type.startsWith(i),k=t.rejected.match(p)&&p.meta.condition&&!!p.meta.arg.subscribe;g=!v&&!k}return[g,!1]}};function db(e){for(const t in e)return!1;return!0}var ub=2147483647/1e3-1,hb=({reducerPath:e,api:t,queryThunk:r,context:i,internalState:s,selectors:{selectQueryEntry:a,selectConfig:o}})=>{const{removeQueryResult:l,unsubscribeQueryResult:d,cacheEntriesUpserted:c}=t.internalActions,u=Ha(d.match,r.fulfilled,r.rejected,c.match);function f(g){const v=s.currentSubscriptions[g];return!!v&&!db(v)}const h={},p=(g,v,k)=>{const T=v.getState(),m=o(T);if(u(g)){let w;if(c.match(g))w=g.payload.map(E=>E.queryDescription.queryCacheKey);else{const{queryCacheKey:E}=d.match(g)?g.payload:g.meta.arg;w=[E]}y(w,v,m)}if(t.util.resetApiState.match(g))for(const[w,E]of Object.entries(h))E&&clearTimeout(E),delete h[w];if(i.hasRehydrationInfo(g)){const{queries:w}=i.extractRehydrationInfo(g);y(Object.keys(w),v,m)}};function y(g,v,k){const T=v.getState();for(const m of g){const w=a(T,m);x(m,w==null?void 0:w.endpointName,v,k)}}function x(g,v,k,T){const m=i.endpointDefinitions[v],w=(m==null?void 0:m.keepUnusedDataFor)??T.keepUnusedDataFor;if(w===1/0)return;const E=Math.max(0,Math.min(w,ub));if(!f(g)){const b=h[g];b&&clearTimeout(b),h[g]=setTimeout(()=>{f(g)||k.dispatch(l({queryCacheKey:g})),delete h[g]},E*1e3)}}return p},Eu=new Error("Promise never resolved before cacheEntryRemoved."),fb=({api:e,reducerPath:t,context:r,queryThunk:i,mutationThunk:s,internalState:a,selectors:{selectQueryEntry:o,selectApiState:l}})=>{const d=Id(i),c=Id(s),u=Jn(i,s),f={};function h(v,k,T){const m=f[v];m!=null&&m.valueResolved&&(m.valueResolved({data:k,meta:T}),delete m.valueResolved)}function p(v){const k=f[v];k&&(delete f[v],k.cacheEntryRemoved())}const y=(v,k,T)=>{const m=x(v);function w(E,b,_,A){const S=o(T,b),j=o(k.getState(),b);!S&&j&&g(E,A,b,k,_)}if(i.pending.match(v))w(v.meta.arg.endpointName,m,v.meta.requestId,v.meta.arg.originalArgs);else if(e.internalActions.cacheEntriesUpserted.match(v))for(const{queryDescription:E,value:b}of v.payload){const{endpointName:_,originalArgs:A,queryCacheKey:S}=E;w(_,S,v.meta.requestId,A),h(S,b,{})}else if(s.pending.match(v))k.getState()[t].mutations[m]&&g(v.meta.arg.endpointName,v.meta.arg.originalArgs,m,k,v.meta.requestId);else if(u(v))h(m,v.payload,v.meta.baseQueryMeta);else if(e.internalActions.removeQueryResult.match(v)||e.internalActions.removeMutationResult.match(v))p(m);else if(e.util.resetApiState.match(v))for(const E of Object.keys(f))p(E)};function x(v){return d(v)?v.meta.arg.queryCacheKey:c(v)?v.meta.arg.fixedCacheKey??v.meta.requestId:e.internalActions.removeQueryResult.match(v)?v.payload.queryCacheKey:e.internalActions.removeMutationResult.match(v)?Ss(v.payload):""}function g(v,k,T,m,w){const E=r.endpointDefinitions[v],b=E==null?void 0:E.onCacheEntryAdded;if(!b)return;const _={},A=new Promise(X=>{_.cacheEntryRemoved=X}),S=Promise.race([new Promise(X=>{_.valueResolved=X}),A.then(()=>{throw Eu})]);S.catch(()=>{}),f[T]=_;const j=e.endpoints[v].select(Ka(E)?k:T),C=m.dispatch((X,ee,q)=>q),P={...m,getCacheEntry:()=>j(m.getState()),requestId:w,extra:C,updateCachedData:Ka(E)?X=>m.dispatch(e.util.updateQueryData(v,k,X)):void 0,cacheDataLoaded:S,cacheEntryRemoved:A},M=b(k,P);Promise.resolve(M).catch(X=>{if(X!==Eu)throw X})}return y},pb=({api:e,context:{apiUid:t},reducerPath:r})=>(i,s)=>{e.util.resetApiState.match(i)&&s.dispatch(e.internalActions.middlewareRegistered(t))},xb=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:i,queryThunk:s,api:a,assertTagType:o,refetchQuery:l,internalState:d})=>{const{removeQueryResult:c}=a.internalActions,u=Ha(Jn(i),Tc(i)),f=Ha(Jn(i,s),Ac(i,s));let h=[];const p=(g,v)=>{u(g)?x(V0(g,"invalidatesTags",r,o),v):f(g)?x([],v):a.util.invalidateTags.match(g)&&x(Xc(g.payload,void 0,void 0,void 0,void 0,o),v)};function y(g){var T;const{queries:v,mutations:k}=g;for(const m of[v,k])for(const w in m)if(((T=m[w])==null?void 0:T.status)==="pending")return!0;return!1}function x(g,v){const k=v.getState(),T=k[e];if(h.push(...g),T.config.invalidationBehavior==="delayed"&&y(T))return;const m=h;if(h=[],m.length===0)return;const w=a.util.selectInvalidatedBy(k,m);t.batch(()=>{const E=Array.from(w.values());for(const{queryCacheKey:b}of E){const _=T.queries[b],A=d.currentSubscriptions[b]??{};_&&(Ai(A)===0?v.dispatch(c({queryCacheKey:b})):_.status!=="uninitialized"&&v.dispatch(l(_)))}})}return p},mb=({reducerPath:e,queryThunk:t,api:r,refetchQuery:i,internalState:s})=>{const a={},o=(h,p)=>{(r.internalActions.updateSubscriptionOptions.match(h)||r.internalActions.unsubscribeQueryResult.match(h))&&d(h.payload,p),(t.pending.match(h)||t.rejected.match(h)&&h.meta.condition)&&d(h.meta.arg,p),(t.fulfilled.match(h)||t.rejected.match(h)&&!h.meta.condition)&&l(h.meta.arg,p),r.util.resetApiState.match(h)&&u()};function l({queryCacheKey:h},p){const y=p.getState()[e],x=y.queries[h],g=s.currentSubscriptions[h];if(!x||x.status==="uninitialized")return;const{lowestPollingInterval:v,skipPollingIfUnfocused:k}=f(g);if(!Number.isFinite(v))return;const T=a[h];T!=null&&T.timeout&&(clearTimeout(T.timeout),T.timeout=void 0);const m=Date.now()+v;a[h]={nextPollTimestamp:m,pollingInterval:v,timeout:setTimeout(()=>{(y.config.focused||!k)&&p.dispatch(i(x)),l({queryCacheKey:h},p)},v)}}function d({queryCacheKey:h},p){const x=p.getState()[e].queries[h],g=s.currentSubscriptions[h];if(!x||x.status==="uninitialized")return;const{lowestPollingInterval:v}=f(g);if(!Number.isFinite(v)){c(h);return}const k=a[h],T=Date.now()+v;(!k||T<k.nextPollTimestamp)&&l({queryCacheKey:h},p)}function c(h){const p=a[h];p!=null&&p.timeout&&clearTimeout(p.timeout),delete a[h]}function u(){for(const h of Object.keys(a))c(h)}function f(h={}){let p=!1,y=Number.POSITIVE_INFINITY;for(let x in h)h[x].pollingInterval&&(y=Math.min(h[x].pollingInterval,y),p=h[x].skipPollingIfUnfocused||p);return{lowestPollingInterval:y,skipPollingIfUnfocused:p}}return o},gb=({api:e,context:t,queryThunk:r,mutationThunk:i})=>{const s=Ph(r,i),a=Ac(r,i),o=Jn(r,i),l={};return(c,u)=>{var f,h;if(s(c)){const{requestId:p,arg:{endpointName:y,originalArgs:x}}=c.meta,g=t.endpointDefinitions[y],v=g==null?void 0:g.onQueryStarted;if(v){const k={},T=new Promise((b,_)=>{k.resolve=b,k.reject=_});T.catch(()=>{}),l[p]=k;const m=e.endpoints[y].select(Ka(g)?x:p),w=u.dispatch((b,_,A)=>A),E={...u,getCacheEntry:()=>m(u.getState()),requestId:p,extra:w,updateCachedData:Ka(g)?b=>u.dispatch(e.util.updateQueryData(y,x,b)):void 0,queryFulfilled:T};v(x,E)}}else if(o(c)){const{requestId:p,baseQueryMeta:y}=c.meta;(f=l[p])==null||f.resolve({data:c.payload,meta:y}),delete l[p]}else if(a(c)){const{requestId:p,rejectedWithValue:y,baseQueryMeta:x}=c.meta;(h=l[p])==null||h.reject({error:c.payload??c.error,isUnhandledError:!y,meta:x}),delete l[p]}}},yb=({reducerPath:e,context:t,api:r,refetchQuery:i,internalState:s})=>{const{removeQueryResult:a}=r.internalActions,o=(d,c)=>{Gc.match(d)&&l(c,"refetchOnFocus"),Yc.match(d)&&l(c,"refetchOnReconnect")};function l(d,c){const u=d.getState()[e],f=u.queries,h=s.currentSubscriptions;t.batch(()=>{for(const p of Object.keys(h)){const y=f[p],x=h[p];if(!x||!y)continue;(Object.values(x).some(v=>v[c]===!0)||Object.values(x).every(v=>v[c]===void 0)&&u.config[c])&&(Ai(x)===0?d.dispatch(a({queryCacheKey:p})):y.status!=="uninitialized"&&d.dispatch(i(y)))}})}return o};function vb(e){const{reducerPath:t,queryThunk:r,api:i,context:s}=e,{apiUid:a}=s,o={invalidateTags:Li(`${t}/invalidateTags`)},l=f=>f.type.startsWith(`${t}/`),d=[pb,hb,xb,mb,fb,gb];return{middleware:f=>{let h=!1;const y={...e,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:l},x=d.map(k=>k(y)),g=cb(y),v=yb(y);return k=>T=>{if(!Nx(T))return k(T);h||(h=!0,f.dispatch(i.internalActions.middlewareRegistered(a)));const m={...f,next:k},w=f.getState(),[E,b]=g(T,m,w);let _;if(E?_=k(T):_=b,f.getState()[t]&&(v(T,m,w),l(T)||s.hasRehydrationInfo(T)))for(const A of x)A(T,m,w);return _}},actions:o};function u(f){return e.api.endpoints[f.endpointName].initiate(f.originalArgs,{subscribe:!1,forceRefetch:!0})}}var _u=Symbol(),Y0=({createSelector:e=Fh}={})=>({name:_u,init(t,{baseQuery:r,tagTypes:i,reducerPath:s,serializeQueryArgs:a,keepUnusedDataFor:o,refetchOnMountOrArgChange:l,refetchOnFocus:d,refetchOnReconnect:c,invalidationBehavior:u,onSchemaFailure:f,catchSchemaFailure:h,skipSchemaValidation:p},y){kx();const x=I=>I;Object.assign(t,{reducerPath:s,endpoints:{},internalActions:{onOnline:Yc,onOffline:z0,onFocus:Gc,onFocusLost:U0},util:{}});const g=lb({serializeQueryArgs:a,reducerPath:s,createSelector:e}),{selectInvalidatedBy:v,selectCachedArgsForQuery:k,buildQuerySelector:T,buildInfiniteQuerySelector:m,buildMutationSelector:w}=g;mn(t.util,{selectInvalidatedBy:v,selectCachedArgsForQuery:k});const{queryThunk:E,infiniteQueryThunk:b,mutationThunk:_,patchQueryData:A,updateQueryData:S,upsertQueryData:j,prefetch:C,buildMatchThunkActions:P}=ab({baseQuery:r,reducerPath:s,context:y,api:t,serializeQueryArgs:a,assertTagType:x,selectors:g,onSchemaFailure:f,catchSchemaFailure:h,skipSchemaValidation:p}),{reducer:M,actions:X}=ob({context:y,queryThunk:E,mutationThunk:_,serializeQueryArgs:a,reducerPath:s,assertTagType:x,config:{refetchOnFocus:d,refetchOnReconnect:c,refetchOnMountOrArgChange:l,keepUnusedDataFor:o,reducerPath:s,invalidationBehavior:u}});mn(t.util,{patchQueryData:A,updateQueryData:S,upsertQueryData:j,prefetch:C,resetApiState:X.resetApiState,upsertQueryEntries:X.cacheEntriesUpserted}),mn(t.internalActions,X);const{middleware:ee,actions:q}=vb({reducerPath:s,context:y,queryThunk:E,mutationThunk:_,infiniteQueryThunk:b,api:t,assertTagType:x,selectors:g});mn(t.util,q),mn(t,{reducer:M,middleware:ee});const{buildInitiateQuery:K,buildInitiateInfiniteQuery:Q,buildInitiateMutation:ie,getRunningMutationThunk:Z,getRunningMutationsThunk:R,getRunningQueriesThunk:U,getRunningQueryThunk:O}=ib({queryThunk:E,mutationThunk:_,infiniteQueryThunk:b,api:t,serializeQueryArgs:a,context:y});return mn(t.util,{getRunningMutationThunk:Z,getRunningMutationsThunk:R,getRunningQueryThunk:O,getRunningQueriesThunk:U}),{name:_u,injectEndpoint(I,W){var ye;const he=(ye=t.endpoints)[I]??(ye[I]={});Ro(W)&&mn(he,{name:I,select:T(I,W),initiate:K(I,W)},P(E,I)),tb(W)&&mn(he,{name:I,select:w(),initiate:ie(I)},P(_,I)),Po(W)&&mn(he,{name:I,select:m(I,W),initiate:Q(I,W)},P(E,I))}}}});Y0();function da(e){return e.replace(e[0],e[0].toUpperCase())}function bb(e){return e.type==="query"}function wb(e){return e.type==="mutation"}function X0(e){return e.type==="infinitequery"}function ts(e,...t){return Object.assign(e,...t)}var Tl=Symbol();function Al(e,t,r,i){const s=N.useMemo(()=>({queryArgs:e,serialized:typeof e=="object"?t({queryArgs:e,endpointDefinition:r,endpointName:i}):e}),[e,t,r,i]),a=N.useRef(s);return N.useEffect(()=>{a.current.serialized!==s.serialized&&(a.current=s)},[s]),a.current.serialized===s.serialized?a.current.queryArgs:e}function ua(e){const t=N.useRef(e);return N.useEffect(()=>{ss(t.current,e)||(t.current=e)},[e]),ss(t.current,e)?t.current:e}var Sb=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jb=Sb(),Eb=()=>typeof navigator<"u"&&navigator.product==="ReactNative",_b=Eb(),Tb=()=>jb||_b?N.useLayoutEffect:N.useEffect,Ab=Tb(),Tu=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:B0.pending}:e;function kl(e,...t){const r={};return t.forEach(i=>{r[i]=e[i]}),r}var Cl=["data","status","isLoading","isSuccess","isError","error"];function kb({api:e,moduleOptions:{batch:t,hooks:{useDispatch:r,useSelector:i,useStore:s},unstable__sideEffectsInRender:a,createSelector:o},serializeQueryArgs:l,context:d}){const c=a?m=>m():N.useEffect;return{buildQueryHooks:v,buildInfiniteQueryHooks:k,buildMutationHook:T,usePrefetch:h};function u(m,w,E){if(w!=null&&w.endpointName&&m.isUninitialized){const{endpointName:C}=w,P=d.endpointDefinitions[C];E!==qr&&l({queryArgs:w.originalArgs,endpointDefinition:P,endpointName:C})===l({queryArgs:E,endpointDefinition:P,endpointName:C})&&(w=void 0)}let b=m.isSuccess?m.data:w==null?void 0:w.data;b===void 0&&(b=m.data);const _=b!==void 0,A=m.isLoading,S=(!w||w.isLoading||w.isUninitialized)&&!_&&A,j=m.isSuccess||_&&(A&&!(w!=null&&w.isError)||m.isUninitialized);return{...m,data:b,currentData:m.data,isFetching:A,isLoading:S,isSuccess:j}}function f(m,w,E){if(w!=null&&w.endpointName&&m.isUninitialized){const{endpointName:C}=w,P=d.endpointDefinitions[C];E!==qr&&l({queryArgs:w.originalArgs,endpointDefinition:P,endpointName:C})===l({queryArgs:E,endpointDefinition:P,endpointName:C})&&(w=void 0)}let b=m.isSuccess?m.data:w==null?void 0:w.data;b===void 0&&(b=m.data);const _=b!==void 0,A=m.isLoading,S=(!w||w.isLoading||w.isUninitialized)&&!_&&A,j=m.isSuccess||A&&_;return{...m,data:b,currentData:m.data,isFetching:A,isLoading:S,isSuccess:j}}function h(m,w){const E=r(),b=ua(w);return N.useCallback((_,A)=>E(e.util.prefetch(m,_,{...b,...A})),[m,E,b])}function p(m,w,{refetchOnReconnect:E,refetchOnFocus:b,refetchOnMountOrArgChange:_,skip:A=!1,pollingInterval:S=0,skipPollingIfUnfocused:j=!1,...C}={}){const{initiate:P}=e.endpoints[m],M=r(),X=N.useRef(void 0);if(!X.current){const I=M(e.internalActions.internal_getRTKQSubscriptions());X.current=I}const ee=Al(A?qr:w,Qa,d.endpointDefinitions[m],m),q=ua({refetchOnReconnect:E,refetchOnFocus:b,pollingInterval:S,skipPollingIfUnfocused:j}),K=C.initialPageParam,Q=ua(K),ie=N.useRef(void 0);let{queryCacheKey:Z,requestId:R}=ie.current||{},U=!1;Z&&R&&(U=X.current.isRequestSubscribed(Z,R));const O=!U&&ie.current!==void 0;return c(()=>{O&&(ie.current=void 0)},[O]),c(()=>{var J;const I=ie.current;if(ee===qr){I==null||I.unsubscribe(),ie.current=void 0;return}const W=(J=ie.current)==null?void 0:J.subscriptionOptions;if(!I||I.arg!==ee){I==null||I.unsubscribe();const he=M(P(ee,{subscriptionOptions:q,forceRefetch:_,...X0(d.endpointDefinitions[m])?{initialPageParam:Q}:{}}));ie.current=he}else q!==W&&I.updateSubscriptionOptions(q)},[M,P,_,ee,q,O,Q,m]),[ie,M,P,q]}function y(m,w){return(b,{skip:_=!1,selectFromResult:A}={})=>{const{select:S}=e.endpoints[m],j=Al(_?qr:b,l,d.endpointDefinitions[m],m),C=N.useRef(void 0),P=N.useMemo(()=>o([S(j),(K,Q)=>Q,K=>j],w,{memoizeOptions:{resultEqualityCheck:ss}}),[S,j]),M=N.useMemo(()=>A?o([P],A,{devModeChecks:{identityFunctionCheck:"never"}}):P,[P,A]),X=i(K=>M(K,C.current),ss),ee=s(),q=P(ee.getState(),C.current);return Ab(()=>{C.current=q},[q]),X}}function x(m){N.useEffect(()=>()=>{var w,E;(E=(w=m.current)==null?void 0:w.unsubscribe)==null||E.call(w),m.current=void 0},[m])}function g(m){if(!m.current)throw new Error(Nh(38));return m.current.refetch()}function v(m){const w=(_,A={})=>{const[S]=p(m,_,A);return x(S),N.useMemo(()=>({refetch:()=>g(S)}),[S])},E=({refetchOnReconnect:_,refetchOnFocus:A,pollingInterval:S=0,skipPollingIfUnfocused:j=!1}={})=>{const{initiate:C}=e.endpoints[m],P=r(),[M,X]=N.useState(Tl),ee=N.useRef(void 0),q=ua({refetchOnReconnect:_,refetchOnFocus:A,pollingInterval:S,skipPollingIfUnfocused:j});c(()=>{var R,U;const Z=(R=ee.current)==null?void 0:R.subscriptionOptions;q!==Z&&((U=ee.current)==null||U.updateSubscriptionOptions(q))},[q]);const K=N.useRef(q);c(()=>{K.current=q},[q]);const Q=N.useCallback(function(Z,R=!1){let U;return t(()=>{var O;(O=ee.current)==null||O.unsubscribe(),ee.current=U=P(C(Z,{subscriptionOptions:K.current,forceRefetch:!R})),X(Z)}),U},[P,C]),ie=N.useCallback(()=>{var Z,R;(Z=ee.current)!=null&&Z.queryCacheKey&&P(e.internalActions.removeQueryResult({queryCacheKey:(R=ee.current)==null?void 0:R.queryCacheKey}))},[P]);return N.useEffect(()=>()=>{var Z;(Z=ee==null?void 0:ee.current)==null||Z.unsubscribe()},[]),N.useEffect(()=>{M!==Tl&&!ee.current&&Q(M,!0)},[M,Q]),N.useMemo(()=>[Q,M,{reset:ie}],[Q,M,ie])},b=y(m,u);return{useQueryState:b,useQuerySubscription:w,useLazyQuerySubscription:E,useLazyQuery(_){const[A,S,{reset:j}]=E(_),C=b(S,{..._,skip:S===Tl}),P=N.useMemo(()=>({lastArg:S}),[S]);return N.useMemo(()=>[A,{...C,reset:j},P],[A,C,j,P])},useQuery(_,A){const S=w(_,A),j=b(_,{selectFromResult:_===qr||A!=null&&A.skip?void 0:Tu,...A}),C=kl(j,...Cl);return N.useDebugValue(C),N.useMemo(()=>({...j,...S}),[j,S])}}}function k(m){const w=(b,_={})=>{const[A,S,j,C]=p(m,b,_),P=N.useRef(C);c(()=>{P.current=C},[C]);const M=N.useCallback(function(q,K){let Q;return t(()=>{var ie;(ie=A.current)==null||ie.unsubscribe(),A.current=Q=S(j(q,{subscriptionOptions:P.current,direction:K}))}),Q},[A,S,j]);x(A);const X=Al(_.skip?qr:b,Qa,d.endpointDefinitions[m],m),ee=N.useCallback(()=>g(A),[A]);return N.useMemo(()=>({trigger:M,refetch:ee,fetchNextPage:()=>M(X,"forward"),fetchPreviousPage:()=>M(X,"backward")}),[ee,M,X])},E=y(m,f);return{useInfiniteQueryState:E,useInfiniteQuerySubscription:w,useInfiniteQuery(b,_){const{refetch:A,fetchNextPage:S,fetchPreviousPage:j}=w(b,_),C=E(b,{selectFromResult:b===qr||_!=null&&_.skip?void 0:Tu,..._}),P=kl(C,...Cl,"hasNextPage","hasPreviousPage");return N.useDebugValue(P),N.useMemo(()=>({...C,fetchNextPage:S,fetchPreviousPage:j,refetch:A}),[C,S,j,A])}}}function T(m){return({selectFromResult:w,fixedCacheKey:E}={})=>{const{select:b,initiate:_}=e.endpoints[m],A=r(),[S,j]=N.useState();N.useEffect(()=>()=>{S!=null&&S.arg.fixedCacheKey||S==null||S.reset()},[S]);const C=N.useCallback(function(Z){const R=A(_(Z,{fixedCacheKey:E}));return j(R),R},[A,_,E]),{requestId:P}=S||{},M=N.useMemo(()=>b({fixedCacheKey:E,requestId:S==null?void 0:S.requestId}),[E,S,b]),X=N.useMemo(()=>w?o([M],w):M,[w,M]),ee=i(X,ss),q=E==null?S==null?void 0:S.arg.originalArgs:void 0,K=N.useCallback(()=>{t(()=>{S&&j(void 0),E&&A(e.internalActions.removeMutationResult({requestId:P,fixedCacheKey:E}))})},[A,E,S,P]),Q=kl(ee,...Cl,"endpointName");N.useDebugValue(Q);const ie=N.useMemo(()=>({...ee,originalArgs:q,reset:K}),[ee,q,K]);return N.useMemo(()=>[C,ie],[C,ie])}}}var Cb=Symbol(),Ib=({batch:e=Px,hooks:t={useDispatch:hr,useSelector:ut,useStore:Dx},createSelector:r=Fh,unstable__sideEffectsInRender:i=!1,...s}={})=>({name:Cb,init(a,{serializeQueryArgs:o},l){const d=a,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:f,usePrefetch:h}=kb({api:a,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:i,createSelector:r},serializeQueryArgs:o,context:l});return ts(d,{usePrefetch:h}),ts(l,{batch:e}),{injectEndpoint(p,y){if(bb(y)){const{useQuery:x,useLazyQuery:g,useLazyQuerySubscription:v,useQueryState:k,useQuerySubscription:T}=c(p);ts(d.endpoints[p],{useQuery:x,useLazyQuery:g,useLazyQuerySubscription:v,useQueryState:k,useQuerySubscription:T}),a[`use${da(p)}Query`]=x,a[`useLazy${da(p)}Query`]=g}if(wb(y)){const x=f(p);ts(d.endpoints[p],{useMutation:x}),a[`use${da(p)}Mutation`]=x}else if(X0(y)){const{useInfiniteQuery:x,useInfiniteQuerySubscription:g,useInfiniteQueryState:v}=u(p);ts(d.endpoints[p],{useInfiniteQuery:x,useInfiniteQuerySubscription:g,useInfiniteQueryState:v}),a[`use${da(p)}InfiniteQuery`]=x}}}}}),Kc=G0(Y0(),Ib());const Nb="/api",Ma=Kc({reducerPath:"invoiceApi",baseQuery:Hc({baseUrl:Nb,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["Invoice"],endpoints:e=>({getInvoices:e.query({query:(t={page:1,limit:10})=>({url:"/invoices",method:"GET",params:t}),transformResponse:t=>(console.log("Raw invoice response:",t),typeof t=="object"&&t!==null&&"data"in t?t:Array.isArray(t)?{success:!0,data:t,pagination:{total:t.length,page:1,limit:t.length,pages:1}}:(console.error("Invalid invoice response:",t),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:t=>(console.error("Invoice API Error:",t),t),providesTags:["Invoice"]}),getInvoice:e.query({query:t=>({url:`/invoices/${t}`,method:"GET"}),transformErrorResponse:t=>(console.error("Get Invoice Error:",t),t),providesTags:(t,r,i)=>[{type:"Invoice",id:i}]}),downloadInvoice:e.mutation({query:t=>({url:`/invoices/${t}/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({id:t,...r})=>({url:`/invoices/${t}/share/whatsapp`,method:"POST",body:r})})})}),{useGetInvoicesQuery:Do,useGetInvoiceQuery:Fb,useShareViaEmailMutation:Rb}=Ma,Pb=({bookings:e,paginationTotal:t,stats:r,statsLoading:i=!1})=>{const a=r||{total:t!==void 0?t:e.length,pending:e.filter(l=>l.status==="pending").length,approved:e.filter(l=>l.status==="approved").length,rejected:e.filter(l=>l.status==="rejected").length,confirmed:e.filter(l=>l.status==="confirmed").length,cancelled:e.filter(l=>l.status==="cancelled").length,totalRevenue:e.filter(l=>l.status==="confirmed"||l.status==="approved").reduce((l,d)=>l+d.amount,0),totalBaseAmount:e.reduce((l,d)=>{var c;return l+(((c=d.calculations)==null?void 0:c.totalBaseAmount)||0)},0)};return n.jsxs(n.Fragment,{children:[n.jsxs(ze,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Total count across all pages",children:["Total Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.total,prefix:n.jsx(kc,{})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Count of all pending bookings",children:["Pending Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.pending,prefix:n.jsx(br,{style:{color:"#faad14"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Count of all approved bookings",children:["Approved Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.approved,prefix:n.jsx(Nt,{style:{color:"#52c41a"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Count of all confirmed bookings",children:["Confirmed Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.confirmed,prefix:n.jsx(Nt,{style:{color:"#52c41a"}})})})})]}),n.jsxs(ze,{gutter:[16,16],style:{marginBottom:"24px"},children:[n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Count of all rejected bookings",children:["Rejected Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.rejected,prefix:n.jsx(Kr,{style:{color:"#f5222d"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Count of all cancelled bookings",children:["Cancelled Bookings ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.cancelled,prefix:n.jsx(Kr,{style:{color:"#f5222d"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Total revenue from all bookings",children:["Total Revenue ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.totalRevenue,precision:0,prefix:"₹"})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:i?n.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:n.jsx(Rt,{})}):n.jsx(Pt,{title:n.jsxs(ht,{title:"Total base amount before taxes and discounts",children:["Total Base Amount ",n.jsx(or,{style:{fontSize:"14px",marginLeft:4}})]}),value:a.totalBaseAmount,precision:0,prefix:"₹",valueStyle:{color:"#1890ff"}})})})]})]})},{RangePicker:Db}=xo,Ob=({filters:e,exhibitions:t,onFilterChange:r,onRefresh:i})=>n.jsx(Ae,{style:{marginBottom:"24px"},children:n.jsxs(ke,{wrap:!0,children:[n.jsx(Re,{placeholder:"Search by company name",prefix:n.jsx(ms,{}),value:e.search,onChange:s=>r({...e,search:s.target.value}),style:{width:200},allowClear:!0}),n.jsx(nt,{placeholder:"Filter by exhibition",value:e.exhibition,onChange:s=>r({...e,exhibition:s}),style:{minWidth:200},allowClear:!0,options:t.map(s=>({label:s.name,value:s._id}))}),n.jsx(nt,{mode:"multiple",placeholder:"Filter by status",value:e.status,onChange:s=>r({...e,status:s}),style:{minWidth:200},options:[{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Confirmed",value:"confirmed"},{label:"Cancelled",value:"cancelled"}]}),n.jsx(Db,{onChange:s=>{var a,o;return r({...e,dateRange:s?[((a=s[0])==null?void 0:a.toISOString())||"",((o=s[1])==null?void 0:o.toISOString())||""]:null})}}),n.jsx(fe,{icon:n.jsx(Is,{}),onClick:i,children:"Refresh"})]})}),Lb=()=>{const{user:e}=ut(r=>r.auth),t=r=>{if(!e||!e.role||!e.role.permissions)return!1;const i=e.role.permissions;if(i.includes(r)||i.includes("*")||i.includes("all")||i.includes("admin")||i.includes("superadmin")||i.includes("full_access"))return!0;const s=r.split("_");if(s.length===2){const a=s[0],o=s[1],l=[`${a}.*`,`*.${o}`,`view_${a}`,`${a}_view`,`${a}s_${o}`,`${o}_${a}`,a.endsWith("s")?`${a.slice(0,-1)}_${o}`:`${a}s_${o}`,`${a}_${o==="view"?"read":o}`,`${o==="view"?"read":o}_${a}`];for(const d of l)if(i.includes(d))return!0}return!1};return{hasPermission:t,hasAnyPermission:r=>r.some(i=>t(i)),hasAllPermissions:r=>r.every(i=>t(i))}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ja={};Ja.version="0.18.5";var K0=1252,Mb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Q0=function(e){Mb.indexOf(e)!=-1&&(K0=e)};function Bb(){Q0(1252)}var js=function(e){Q0(e)};function $b(){js(1200),Bb()}var ha=function(t){return String.fromCharCode(t)},Au=function(t){return String.fromCharCode(t)},ku,Pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Es(e){for(var t="",r=0,i=0,s=0,a=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,i=e.charCodeAt(c++),o=(r&3)<<4|i>>4,s=e.charCodeAt(c++),l=(i&15)<<2|s>>6,d=s&63,isNaN(i)?l=d=64:isNaN(s)&&(d=64),t+=Pn.charAt(a)+Pn.charAt(o)+Pn.charAt(l)+Pn.charAt(d);return t}function _n(e){var t="",r=0,i=0,s=0,a=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Pn.indexOf(e.charAt(c++)),o=Pn.indexOf(e.charAt(c++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=Pn.indexOf(e.charAt(c++)),i=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(i)),d=Pn.indexOf(e.charAt(c++)),s=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(s));return t}var tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),kn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ei(e){return tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Cu(e){return tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return tt?kn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Oo(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),i=0;i!=e.length;++i)r[i]=e.charCodeAt(i)&255;return t}function Bs(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ub(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Qt=tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:kn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var i=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)i.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";i.set(new Uint8Array(e[t]),r)}return i}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function zb(e){for(var t=[],r=0,i=e.length+250,s=ei(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>i&&(t.push(s.slice(0,r)),r=0,s=ei(65535),i=65530)}return t.push(s.slice(0,r)),Qt(t)}var ls=/\u0000/g,fa=/[\u0001-\u0006]/g;function ki(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yr(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}function Qc(e,t){var r=""+e;return r.length>=t?r:kt(" ",t-r.length)+r}function Za(e,t){var r=""+e;return r.length>=t?r:r+kt(" ",t-r.length)}function Wb(e,t){var r=""+Math.round(e);return r.length>=t?r:kt("0",t-r.length)+r}function qb(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}var Iu=Math.pow(2,32);function pi(e,t){if(e>Iu||e<-Iu)return Wb(e,t);var r=Math.round(e);return qb(r,t)}function eo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Nu=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Il=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Vb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var It={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Fu={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Hb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function to(e,t,r){for(var i=e<0?-1:1,s=e*i,a=0,o=1,l=0,d=1,c=0,u=0,f=Math.floor(s);c<t&&(f=Math.floor(s),l=f*o+a,u=f*c+d,!(s-f<5e-8));)s=1/(s-f),a=o,o=l,d=c,c=u;if(u>t&&(c>t?(u=d,l=a):(u=c,l=o)),!r)return[0,i*l,u];var h=Math.floor(i*l/u);return[h,i*l-h*u,u]}function pa(e,t,r){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),a=0,o=[],l={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++i,++l.D)),i===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(i===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var d=new Date(1900,0,1);d.setDate(d.getDate()+i-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],a=d.getDay(),i<60&&(a=(a+6)%7),r&&(a=Zb(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var J0=new Date(1899,11,31,0,0,0),Gb=J0.getTime(),Yb=new Date(1900,2,1,0,0,0);function Z0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Yb&&(r+=24*60*60*1e3),(r-(Gb+(e.getTimezoneOffset()-J0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Jc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Xb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kb(e){var t=e<0?12:11,r=Jc(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Qb(e){var t=Jc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Jb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Kb(e):t===10?r=e.toFixed(10).substr(0,12):r=Qb(e),Jc(Xb(r.toUpperCase()))}function xc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Jb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Mn(14,Z0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Zb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function e2(e,t,r,i){var s="",a=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return Il[r.m-1][1];case 5:return Il[r.m-1][0];default:return Il[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return Nu[r.q][0];default:return Nu[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yr(r.S,t.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=Yr(a,2+i),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var u=c>0?Yr(d,c):"";return u}function Dn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,i=e.substr(0,r);r!=e.length;r+=t)i+=(i.length>0?",":"")+e.substr(r,t);return i}var ef=/%/g;function t2(e,t,r){var i=t.replace(ef,""),s=t.length-i.length;return wn(e,i,r*Math.pow(10,2*s))+kt("%",s)}function r2(e,t,r){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return wn(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}function tf(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tf(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(i+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rf=/# (\?+)( ?)\/( ?)(\d+)/;function n2(e,t,r){var i=parseInt(e[4],10),s=Math.round(t*i),a=Math.floor(s/i),o=s-a*i,l=i;return r+(a===0?"":""+a)+" "+(o===0?kt(" ",e[1].length+1+e[4].length):Qc(o,e[1].length)+e[2]+"/"+e[3]+Yr(l,e[4].length))}function i2(e,t,r){return r+(t===0?"":""+t)+kt(" ",e[1].length+2+e[4].length)}var nf=/^#*0*\.([0#]+)/,sf=/\).*[0#]/,af=/\(###\) ###\\?-####/;function pr(e){for(var t="",r,i=0;i!=e.length;++i)switch(r=e.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ru(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Pu(e,t){var r=e-Math.floor(e),i=Math.pow(10,t);return t<(""+Math.round(r*i)).length?0:Math.round(r*i)}function s2(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function a2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sf)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dr("n",i,r):"("+Dr("n",i,-r)+")"}if(t.charCodeAt(t.length-1)===44)return r2(e,t,r);if(t.indexOf("%")!==-1)return t2(e,t,r);if(t.indexOf("E")!==-1)return tf(t,r);if(t.charCodeAt(0)===36)return"$"+Dr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+pi(d,t.length);if(t.match(/^[#?]+$/))return s=pi(r,0),s==="0"&&(s=""),s.length>t.length?s:pr(t.substr(0,t.length-s.length))+s;if(a=t.match(rf))return n2(a,d,c);if(t.match(/^#+0+$/))return c+pi(d,t.length-t.indexOf("0"));if(a=t.match(nf))return s=Ru(r,a[1].length).replace(/^([^\.]+)$/,"$1."+pr(a[1])).replace(/\.$/,"."+pr(a[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+kt("0",pr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Ru(d,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Dn(pi(d,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):Dn(""+(Math.floor(r)+s2(r,a[1].length)))+"."+Yr(Pu(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Dr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ki(Dr(e,t.replace(/[\\-]/g,""),r)),o=0,ki(ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(t.match(af))return s=Dr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=to(d,Math.pow(10,o)-1,!1),s=""+c,u=wn("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Za(l[2],o),u.length<a[4].length&&(u=pr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=to(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qc(l[1],o)+a[2]+"/"+a[3]+Za(l[2],o):kt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=pi(r,0),t.length<=s.length?s:pr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return pr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Pu(r,a[1].length),r<0?"-"+Dr(e,t,-r):Dn(a2(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Yr(0,3-y.length):"")+y})+"."+Yr(o,a[1].length);switch(t){case"###,##0.00":return Dr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Dn(pi(d,0));return p!=="0"?c+p:"";case"###,###.00":return Dr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function o2(e,t,r){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return wn(e,t.substr(0,i),r/Math.pow(10,3*(t.length-i)))}function l2(e,t,r){var i=t.replace(ef,""),s=t.length-i.length;return wn(e,i,r*Math.pow(10,2*s))+kt("%",s)}function of(e,t){var r,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+of(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(i+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(i);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function en(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sf)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?en("n",i,r):"("+en("n",i,-r)+")"}if(t.charCodeAt(t.length-1)===44)return o2(e,t,r);if(t.indexOf("%")!==-1)return l2(e,t,r);if(t.indexOf("E")!==-1)return of(t,r);if(t.charCodeAt(0)===36)return"$"+en(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Yr(d,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:pr(t.substr(0,t.length-s.length))+s;if(a=t.match(rf))return i2(a,d,c);if(t.match(/^#+0+$/))return c+Yr(d,t.length-t.indexOf("0"));if(a=t.match(nf))return s=(""+r).replace(/^([^\.]+)$/,"$1."+pr(a[1])).replace(/\.$/,"."+pr(a[1])),s=s.replace(/\.(\d*)$/,function(y,x){return"."+x+kt("0",pr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Dn(""+d);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+en(e,t,-r):Dn(""+r)+"."+kt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return en(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ki(en(e,t.replace(/[\\-]/g,""),r)),o=0,ki(ki(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(t.match(af))return s=en(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=to(d,Math.pow(10,o)-1,!1),s=""+c,u=wn("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Za(l[2],o),u.length<a[4].length&&(u=pr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=to(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qc(l[1],o)+a[2]+"/"+a[3]+Za(l[2],o):kt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:pr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return pr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+en(e,t,-r):Dn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Yr(0,3-y.length):"")+y})+"."+Yr(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Dn(""+d);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return en(e,t.slice(0,t.lastIndexOf(".")),r)+pr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wn(e,t,r){return(r|0)===r?en(e,t,r):Dr(e,t,r)}function c2(e){for(var t=[],r=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=e.substr(s,i-s),s=i+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cf(e){for(var t=0,r="",i="";t<e.length;)switch(r=e.charAt(t)){case"G":eo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=r;e.charAt(t++)!=="]"&&t<e.length;)i+=e.charAt(t);if(i.match(lf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function d2(e,t,r,i){for(var s=[],a="",o=0,l="",d="t",c,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!eo(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++o;break;case"\\":var p=e.charAt(++o),y=p==="("||p===")"?p:"t";s[s.length]={t:y,v:p},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=pa(t,r,e.charAt(o+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=pa(t,r),c==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:a},d=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(c==null&&(c=pa(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(x.v=c.H>=12?"下午":"上午"),x.t="T",o+=5,h="h"):(x.t="t",++o),c==null&&x.t==="T")return"";s[s.length]=x,d=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(lf)){if(c==null&&(c=pa(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},d=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",cf(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:i===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,v=0,k;for(o=s.length-1,d="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,d="h",g<1&&(g=1);break;case"s":(k=s[o].v.match(/\.0+$/))&&(v=Math.max(v,k[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":d=s[o].t;break;case"m":d==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",m;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=e2(s[o].t.charCodeAt(0),s[o].v,c,v),s[o].t="t";break;case"n":case"?":for(m=o+1;s[m]!=null&&((l=s[m].t)==="?"||l==="D"||(l===" "||l==="t")&&s[m+1]!=null&&(s[m+1].t==="?"||s[m+1].t==="t"&&s[m+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[m].v==="/"||s[m].v===" "&&s[m+1]!=null&&s[m+1].t=="?"));)s[o].v+=s[m].v,s[m]={v:"",t:";"},++m;T+=s[o].v,o=m-1;break;case"G":s[o].t="t",s[o].v=xc(t,r);break}var w="",E,b;if(T.length>0){T.charCodeAt(0)==40?(E=t<0&&T.charCodeAt(0)===45?-t:t,b=wn("n",T,E)):(E=t<0&&i>1?-t:t,b=wn("n",T,E),E<0&&s[0]&&s[0].t=="t"&&(b=b.substr(1),s[0].v="-"+s[0].v)),m=b.length-1;var _=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){_=o;break}var A=s.length;if(_===s.length&&b.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(m>=s[o].v.length-1?(m-=s[o].v.length,s[o].v=b.substr(m+1,s[o].v.length)):m<0?s[o].v="":(s[o].v=b.substr(0,m+1),m=-1),s[o].t="t",A=o);m>=0&&A<s.length&&(s[A].v=b.substr(0,m+1)+s[A].v)}else if(_!==s.length&&b.indexOf("E")===-1){for(m=b.indexOf(".")-1,o=_;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===_?s[o].v.indexOf(".")-1:s[o].v.length-1,w=s[o].v.substr(u+1);u>=0;--u)m>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(w=b.charAt(m--)+w);s[o].v=w,s[o].t="t",A=o}for(m>=0&&A<s.length&&(s[A].v=b.substr(0,m+1)+s[A].v),m=b.indexOf(".")+1,o=_;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==_)){for(u=s[o].v.indexOf(".")>-1&&o===_?s[o].v.indexOf(".")+1:0,w=s[o].v.substr(0,u);u<s[o].v.length;++u)m<b.length&&(w+=b.charAt(m++));s[o].v=w,s[o].t="t",A=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(E=i>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=wn(s[o].t,s[o].v,E),s[o].t="t");var S="";for(o=0;o!==s.length;++o)s[o]!=null&&(S+=s[o].v);return S}var Du=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ou(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function u2(e,t){var r=c2(e),i=r.length,s=r[i-1].indexOf("@");if(i<4&&s>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[i,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Du),l=r[1].match(Du);return Ou(t,o)?[i,r[0]]:Ou(t,l)?[i,r[1]]:[i,r[o!=null&&l!=null?2:1]]}return[i,a]}function Mn(e,t,r){r==null&&(r={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?i=r.dateNF:i=e;break;case"number":e==14&&r.dateNF?i=r.dateNF:i=(r.table!=null?r.table:It)[e],i==null&&(i=r.table&&r.table[Fu[e]]||It[Fu[e]]),i==null&&(i=Hb[e]||"General");break}if(eo(i,0))return xc(t,r);t instanceof Date&&(t=Z0(t,r.date1904));var s=u2(i,t);if(eo(s[1]))return xc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return d2(s[1],t,r,s[0])}function df(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(It[r]==null){t<0&&(t=r);continue}if(It[r]==e){t=r;break}}t<0&&(t=391)}return It[t]=e,t}function Lo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&df(e[t],t)}function Mo(){It=Vb()}var uf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function h2(e){var t=typeof e=="number"?It[e]:e;return t=t.replace(uf,"(\\d+)"),new RegExp("^"+t+"$")}function f2(e,t,r){var i=-1,s=-1,a=-1,o=-1,l=-1,d=-1;(t.match(uf)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":i=p;break;case"d":a=p;break;case"h":o=p;break;case"s":d=p;break;case"m":o>=0?l=p:s=p;break}}),d>=0&&l==-1&&s>=0&&(l=s,s=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:i==-1&&s==-1&&a==-1?u:c+"T"+u}var p2=function(){var e={};e.version="1.2.0";function t(){for(var b=0,_=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,_[A]=b;return typeof Int32Array<"u"?new Int32Array(_):_}var r=t();function i(b){var _=0,A=0,S=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(S=0;S!=256;++S)j[S]=b[S];for(S=0;S!=256;++S)for(A=b[S],_=256+S;_<4096;_+=256)A=j[_]=A>>>8^b[A&255];var C=[];for(S=1;S!=16;++S)C[S-1]=typeof Int32Array<"u"?j.subarray(S*256,S*256+256):j.slice(S*256,S*256+256);return C}var s=i(r),a=s[0],o=s[1],l=s[2],d=s[3],c=s[4],u=s[5],f=s[6],h=s[7],p=s[8],y=s[9],x=s[10],g=s[11],v=s[12],k=s[13],T=s[14];function m(b,_){for(var A=_^-1,S=0,j=b.length;S<j;)A=A>>>8^r[(A^b.charCodeAt(S++))&255];return~A}function w(b,_){for(var A=_^-1,S=b.length-15,j=0;j<S;)A=T[b[j++]^A&255]^k[b[j++]^A>>8&255]^v[b[j++]^A>>16&255]^g[b[j++]^A>>>24]^x[b[j++]]^y[b[j++]]^p[b[j++]]^h[b[j++]]^f[b[j++]]^u[b[j++]]^c[b[j++]]^d[b[j++]]^l[b[j++]]^o[b[j++]]^a[b[j++]]^r[b[j++]];for(S+=15;j<S;)A=A>>>8^r[(A^b[j++])&255];return~A}function E(b,_){for(var A=_^-1,S=0,j=b.length,C=0,P=0;S<j;)C=b.charCodeAt(S++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,P=b.charCodeAt(S++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|P>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|P&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return e.table=r,e.bstr=m,e.buf=w,e.str=E,e}(),dt=function(){var t={};t.version="1.2.1";function r(F,B){for(var D=F.split("/"),L=B.split("/"),z=0,V=0,re=Math.min(D.length,L.length);z<re;++z){if(V=D[z].length-L[z].length)return V;if(D[z]!=L[z])return D[z]<L[z]?-1:1}return D.length-L.length}function i(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:i(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(0,B+1)}function s(F){if(F.charAt(F.length-1)=="/")return s(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(B+1)}function a(F,B){typeof B=="string"&&(B=new Date(B));var D=B.getHours();D=D<<6|B.getMinutes(),D=D<<5|B.getSeconds()>>>1,F.write_shift(2,D);var L=B.getFullYear()-1980;L=L<<4|B.getMonth()+1,L=L<<5|B.getDate(),F.write_shift(2,L)}function o(F){var B=F.read_shift(2)&65535,D=F.read_shift(2)&65535,L=new Date,z=D&31;D>>>=5;var V=D&15;D>>>=4,L.setMilliseconds(0),L.setFullYear(D+1980),L.setMonth(V-1),L.setDate(z);var re=B&31;B>>>=5;var pe=B&63;return B>>>=6,L.setHours(B),L.setMinutes(pe),L.setSeconds(re<<1),L}function l(F){Tr(F,0);for(var B={},D=0;F.l<=F.length-4;){var L=F.read_shift(2),z=F.read_shift(2),V=F.l+z,re={};switch(L){case 21589:D=F.read_shift(1),D&1&&(re.mtime=F.read_shift(4)),z>5&&(D&2&&(re.atime=F.read_shift(4)),D&4&&(re.ctime=F.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}F.l=V,B[L]=re}return B}var d;function c(){return d||(d={})}function u(F,B){if(F[0]==80&&F[1]==75)return wd(F,B);if((F[0]|32)==109&&(F[1]|32)==105)return zp(F,B);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var D=3,L=512,z=0,V=0,re=0,pe=0,te=0,ne=[],se=F.slice(0,512);Tr(se,0);var we=f(se);switch(D=we[0],D){case 3:L=512;break;case 4:L=4096;break;case 0:if(we[1]==0)return wd(F,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}L!==512&&(se=F.slice(0,L),Tr(se,28));var Ce=F.slice(0,L);h(se,D);var De=se.read_shift(4,"i");if(D===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);se.l+=4,re=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),pe=se.read_shift(4,"i"),z=se.read_shift(4,"i"),te=se.read_shift(4,"i"),V=se.read_shift(4,"i");for(var je=-1,Fe=0;Fe<109&&(je=se.read_shift(4,"i"),!(je<0));++Fe)ne[Fe]=je;var We=p(F,L);g(te,V,We,L,ne);var yt=k(We,re,ne,L);yt[re].name="!Directory",z>0&&pe!==P&&(yt[pe].name="!MiniFAT"),yt[ne[0]].name="!FAT",yt.fat_addrs=ne,yt.ssz=L;var vt={},nr=[],qi=[],Vi=[];T(re,yt,We,nr,z,vt,qi,pe),y(qi,Vi,nr),nr.shift();var Hi={FileIndex:qi,FullPaths:Vi};return B&&B.raw&&(Hi.raw={header:Ce,sectors:We}),Hi}function f(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(M,"Header Signature: "),F.l+=16;var B=F.read_shift(2,"u");return[F.read_shift(2,"u"),B]}function h(F,B){var D=9;switch(F.l+=2,D=F.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function p(F,B){for(var D=Math.ceil(F.length/B)-1,L=[],z=1;z<D;++z)L[z-1]=F.slice(z*B,(z+1)*B);return L[D-1]=F.slice(D*B),L}function y(F,B,D){for(var L=0,z=0,V=0,re=0,pe=0,te=D.length,ne=[],se=[];L<te;++L)ne[L]=se[L]=L,B[L]=D[L];for(;pe<se.length;++pe)L=se[pe],z=F[L].L,V=F[L].R,re=F[L].C,ne[L]===L&&(z!==-1&&ne[z]!==z&&(ne[L]=ne[z]),V!==-1&&ne[V]!==V&&(ne[L]=ne[V])),re!==-1&&(ne[re]=L),z!==-1&&L!=ne[L]&&(ne[z]=ne[L],se.lastIndexOf(z)<pe&&se.push(z)),V!==-1&&L!=ne[L]&&(ne[V]=ne[L],se.lastIndexOf(V)<pe&&se.push(V));for(L=1;L<te;++L)ne[L]===L&&(V!==-1&&ne[V]!==V?ne[L]=ne[V]:z!==-1&&ne[z]!==z&&(ne[L]=ne[z]));for(L=1;L<te;++L)if(F[L].type!==0){if(pe=L,pe!=ne[pe])do pe=ne[pe],B[L]=B[pe]+"/"+B[L];while(pe!==0&&ne[pe]!==-1&&pe!=ne[pe]);ne[L]=-1}for(B[0]+="/",L=1;L<te;++L)F[L].type!==2&&(B[L]+="/")}function x(F,B,D){for(var L=F.start,z=F.size,V=[],re=L;D&&z>0&&re>=0;)V.push(B.slice(re*C,re*C+C)),z-=C,re=Gn(D,re*4);return V.length===0?ce(0):Qt(V).slice(0,F.size)}function g(F,B,D,L,z){var V=P;if(F===P){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var re=D[F],pe=(L>>>2)-1;if(!re)return;for(var te=0;te<pe&&(V=Gn(re,te*4))!==P;++te)z.push(V);g(Gn(re,L-4),B-1,D,L,z)}}function v(F,B,D,L,z){var V=[],re=[];z||(z=[]);var pe=L-1,te=0,ne=0;for(te=B;te>=0;){z[te]=!0,V[V.length]=te,re.push(F[te]);var se=D[Math.floor(te*4/L)];if(ne=te*4&pe,L<4+ne)throw new Error("FAT boundary crossed: "+te+" 4 "+L);if(!F[se])break;te=Gn(F[se],ne)}return{nodes:V,data:qu([re])}}function k(F,B,D,L){var z=F.length,V=[],re=[],pe=[],te=[],ne=L-1,se=0,we=0,Ce=0,De=0;for(se=0;se<z;++se)if(pe=[],Ce=se+B,Ce>=z&&(Ce-=z),!re[Ce]){te=[];var je=[];for(we=Ce;we>=0;){je[we]=!0,re[we]=!0,pe[pe.length]=we,te.push(F[we]);var Fe=D[Math.floor(we*4/L)];if(De=we*4&ne,L<4+De)throw new Error("FAT boundary crossed: "+we+" 4 "+L);if(!F[Fe]||(we=Gn(F[Fe],De),je[we]))break}V[Ce]={nodes:pe,data:qu([te])}}return V}function T(F,B,D,L,z,V,re,pe){for(var te=0,ne=L.length?2:0,se=B[F].data,we=0,Ce=0,De;we<se.length;we+=128){var je=se.slice(we,we+128);Tr(je,64),Ce=je.read_shift(2),De=nd(je,0,Ce-ne),L.push(De);var Fe={name:De,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},We=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);We!==0&&(Fe.ct=m(je,je.l-8));var yt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);yt!==0&&(Fe.mt=m(je,je.l-8)),Fe.start=je.read_shift(4,"i"),Fe.size=je.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=P,Fe.name=""),Fe.type===5?(te=Fe.start,z>0&&te!==P&&(B[te].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",B[Fe.start]===void 0&&(B[Fe.start]=v(D,Fe.start,B.fat_addrs,B.ssz)),B[Fe.start].name=Fe.name,Fe.content=B[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:te!==P&&Fe.start!==P&&B[te]&&(Fe.content=x(Fe,B[te].data,(B[pe]||{}).data))),Fe.content&&Tr(Fe.content,0),V[De]=Fe,re.push(Fe)}}function m(F,B){return new Date((kr(F,B+4)/1e7*Math.pow(2,32)+kr(F,B)/1e7-11644473600)*1e3)}function w(F,B){return c(),u(d.readFileSync(F),B)}function E(F,B){var D=B&&B.type;switch(D||tt&&Buffer.isBuffer(F)&&(D="buffer"),D||"base64"){case"file":return w(F,B);case"base64":return u(Hr(_n(F)),B);case"binary":return u(Hr(F),B)}return u(F,B)}function b(F,B){var D=B||{},L=D.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=L+"/",F.FileIndex[0]={name:L,type:5}),D.CLSID&&(F.FileIndex[0].clsid=D.CLSID),_(F)}function _(F){var B="Sh33tJ5";if(!dt.find(F,"/"+B)){var D=ce(4);D[0]=55,D[1]=D[3]=50,D[2]=54,F.FileIndex.push({name:B,type:2,content:D,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+B),A(F)}}function A(F,B){b(F);for(var D=!1,L=!1,z=F.FullPaths.length-1;z>=0;--z){var V=F.FileIndex[z];switch(V.type){case 0:L?D=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(V.R*V.L*V.C)&&(D=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!B)){var re=new Date(1987,1,19),pe=0,te=Object.create?Object.create(null):{},ne=[];for(z=0;z<F.FullPaths.length;++z)te[F.FullPaths[z]]=!0,F.FileIndex[z].type!==0&&ne.push([F.FullPaths[z],F.FileIndex[z]]);for(z=0;z<ne.length;++z){var se=i(ne[z][0]);L=te[se],L||(ne.push([se,{name:s(se).replace("/",""),type:1,clsid:ee,ct:re,mt:re,content:null}]),te[se]=!0)}for(ne.sort(function(De,je){return r(De[0],je[0])}),F.FullPaths=[],F.FileIndex=[],z=0;z<ne.length;++z)F.FullPaths[z]=ne[z][0],F.FileIndex[z]=ne[z][1];for(z=0;z<ne.length;++z){var we=F.FileIndex[z],Ce=F.FullPaths[z];if(we.name=s(Ce).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||ee,z===0)we.C=ne.length>1?1:-1,we.size=0,we.type=5;else if(Ce.slice(-1)=="/"){for(pe=z+1;pe<ne.length&&i(F.FullPaths[pe])!=Ce;++pe);for(we.C=pe>=ne.length?-1:pe,pe=z+1;pe<ne.length&&i(F.FullPaths[pe])!=i(Ce);++pe);we.R=pe>=ne.length?-1:pe,we.type=1}else i(F.FullPaths[z+1]||"")==i(Ce)&&(we.R=z+1),we.type=2}}}function S(F,B){var D=B||{};if(D.fileType=="mad")return Wp(F,D);switch(A(F),D.fileType){case"zip":return Op(F,D)}var L=function(De){for(var je=0,Fe=0,We=0;We<De.FileIndex.length;++We){var yt=De.FileIndex[We];if(yt.content){var vt=yt.content.length;vt>0&&(vt<4096?je+=vt+63>>6:Fe+=vt+511>>9)}}for(var nr=De.FullPaths.length+3>>2,qi=je+7>>3,Vi=je+127>>7,Hi=qi+Fe+nr+Vi,Wn=Hi+127>>7,Go=Wn<=109?0:Math.ceil((Wn-109)/127);Hi+Wn+Go+127>>7>Wn;)Go=++Wn<=109?0:Math.ceil((Wn-109)/127);var fn=[1,Go,Wn,Vi,nr,Fe,je,0];return De.FileIndex[0].size=je<<6,fn[7]=(De.FileIndex[0].start=fn[0]+fn[1]+fn[2]+fn[3]+fn[4]+fn[5])+(fn[6]+7>>3),fn}(F),z=ce(L[7]<<9),V=0,re=0;{for(V=0;V<8;++V)z.write_shift(1,X[V]);for(V=0;V<8;++V)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),V=0;V<3;++V)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,L[2]),z.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:P),z.write_shift(4,L[3]),z.write_shift(-4,L[1]?L[0]-1:P),z.write_shift(4,L[1]),V=0;V<109;++V)z.write_shift(-4,V<L[2]?L[1]+V:-1)}if(L[1])for(re=0;re<L[1];++re){for(;V<236+re*127;++V)z.write_shift(-4,V<L[2]?L[1]+V:-1);z.write_shift(-4,re===L[1]-1?P:re+1)}var pe=function(De){for(re+=De;V<re-1;++V)z.write_shift(-4,V+1);De&&(++V,z.write_shift(-4,P))};for(re=V=0,re+=L[1];V<re;++V)z.write_shift(-4,q.DIFSECT);for(re+=L[2];V<re;++V)z.write_shift(-4,q.FATSECT);pe(L[3]),pe(L[4]);for(var te=0,ne=0,se=F.FileIndex[0];te<F.FileIndex.length;++te)se=F.FileIndex[te],se.content&&(ne=se.content.length,!(ne<4096)&&(se.start=re,pe(ne+511>>9)));for(pe(L[6]+7>>3);z.l&511;)z.write_shift(-4,q.ENDOFCHAIN);for(re=V=0,te=0;te<F.FileIndex.length;++te)se=F.FileIndex[te],se.content&&(ne=se.content.length,!(!ne||ne>=4096)&&(se.start=re,pe(ne+63>>6)));for(;z.l&511;)z.write_shift(-4,q.ENDOFCHAIN);for(V=0;V<L[4]<<2;++V){var we=F.FullPaths[V];if(!we||we.length===0){for(te=0;te<17;++te)z.write_shift(4,0);for(te=0;te<3;++te)z.write_shift(4,-1);for(te=0;te<12;++te)z.write_shift(4,0);continue}se=F.FileIndex[V],V===0&&(se.start=se.size?se.start-1:P);var Ce=V===0&&D.root||se.name;if(ne=2*(Ce.length+1),z.write_shift(64,Ce,"utf16le"),z.write_shift(2,ne),z.write_shift(1,se.type),z.write_shift(1,se.color),z.write_shift(-4,se.L),z.write_shift(-4,se.R),z.write_shift(-4,se.C),se.clsid)z.write_shift(16,se.clsid,"hex");else for(te=0;te<4;++te)z.write_shift(4,0);z.write_shift(4,se.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,se.start),z.write_shift(4,se.size),z.write_shift(4,0)}for(V=1;V<F.FileIndex.length;++V)if(se=F.FileIndex[V],se.size>=4096)if(z.l=se.start+1<<9,tt&&Buffer.isBuffer(se.content))se.content.copy(z,z.l,0,se.size),z.l+=se.size+511&-512;else{for(te=0;te<se.size;++te)z.write_shift(1,se.content[te]);for(;te&511;++te)z.write_shift(1,0)}for(V=1;V<F.FileIndex.length;++V)if(se=F.FileIndex[V],se.size>0&&se.size<4096)if(tt&&Buffer.isBuffer(se.content))se.content.copy(z,z.l,0,se.size),z.l+=se.size+63&-64;else{for(te=0;te<se.size;++te)z.write_shift(1,se.content[te]);for(;te&63;++te)z.write_shift(1,0)}if(tt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function j(F,B){var D=F.FullPaths.map(function(te){return te.toUpperCase()}),L=D.map(function(te){var ne=te.split("/");return ne[ne.length-(te.slice(-1)=="/"?2:1)]}),z=!1;B.charCodeAt(0)===47?(z=!0,B=D[0].slice(0,-1)+B):z=B.indexOf("/")!==-1;var V=B.toUpperCase(),re=z===!0?D.indexOf(V):L.indexOf(V);if(re!==-1)return F.FileIndex[re];var pe=!V.match(fa);for(V=V.replace(ls,""),pe&&(V=V.replace(fa,"!")),re=0;re<D.length;++re)if((pe?D[re].replace(fa,"!"):D[re]).replace(ls,"")==V||(pe?L[re].replace(fa,"!"):L[re]).replace(ls,"")==V)return F.FileIndex[re];return null}var C=64,P=-2,M="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(F,B,D){c();var L=S(F,D);d.writeFileSync(B,L)}function Q(F){for(var B=new Array(F.length),D=0;D<F.length;++D)B[D]=String.fromCharCode(F[D]);return B.join("")}function ie(F,B){var D=S(F,B);switch(B&&B.type||"buffer"){case"file":return c(),d.writeFileSync(B.filename,D),D;case"binary":return typeof D=="string"?D:Q(D);case"base64":return Es(typeof D=="string"?D:Q(D));case"buffer":if(tt)return Buffer.isBuffer(D)?D:kn(D);case"array":return typeof D=="string"?Hr(D):D}return D}var Z;function R(F){try{var B=F.InflateRaw,D=new B;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)Z=F;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function U(F,B){if(!Z)return vd(F,B);var D=Z.InflateRaw,L=new D,z=L._processChunk(F.slice(F.l),L._finishFlushFlag);return F.l+=L.bytesRead,z}function O(F){return Z?Z.deflateRawSync(F):gt(F)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(F){var B=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(B>>16|B>>8|B)&255}for(var ye=typeof Uint8Array<"u",H=ye?new Uint8Array(256):[],Y=0;Y<256;++Y)H[Y]=he(Y);function le(F,B){var D=H[F&255];return B<=8?D>>>8-B:(D=D<<8|H[F>>8&255],B<=16?D>>>16-B:(D=D<<8|H[F>>16&255],D>>>24-B))}function de(F,B){var D=B&7,L=B>>>3;return(F[L]|(D<=6?0:F[L+1]<<8))>>>D&3}function G(F,B){var D=B&7,L=B>>>3;return(F[L]|(D<=5?0:F[L+1]<<8))>>>D&7}function xe(F,B){var D=B&7,L=B>>>3;return(F[L]|(D<=4?0:F[L+1]<<8))>>>D&15}function ge(F,B){var D=B&7,L=B>>>3;return(F[L]|(D<=3?0:F[L+1]<<8))>>>D&31}function me(F,B){var D=B&7,L=B>>>3;return(F[L]|(D<=1?0:F[L+1]<<8))>>>D&127}function Te(F,B,D){var L=B&7,z=B>>>3,V=(1<<D)-1,re=F[z]>>>L;return D<8-L||(re|=F[z+1]<<8-L,D<16-L)||(re|=F[z+2]<<16-L,D<24-L)||(re|=F[z+3]<<24-L),re&V}function ue(F,B,D){var L=B&7,z=B>>>3;return L<=5?F[z]|=(D&7)<<L:(F[z]|=D<<L&255,F[z+1]=(D&7)>>8-L),B+3}function Me(F,B,D){var L=B&7,z=B>>>3;return D=(D&1)<<L,F[z]|=D,B+1}function $e(F,B,D){var L=B&7,z=B>>>3;return D<<=L,F[z]|=D&255,D>>>=8,F[z+1]=D,B+8}function ct(F,B,D){var L=B&7,z=B>>>3;return D<<=L,F[z]|=D&255,D>>>=8,F[z+1]=D&255,F[z+2]=D>>>8,B+16}function rt(F,B){var D=F.length,L=2*D>B?2*D:B+5,z=0;if(D>=B)return F;if(tt){var V=Cu(L);if(F.copy)F.copy(V);else for(;z<F.length;++z)V[z]=F[z];return V}else if(ye){var re=new Uint8Array(L);if(re.set)re.set(F);else for(;z<D;++z)re[z]=F[z];return re}return F.length=L,F}function Ie(F){for(var B=new Array(F),D=0;D<F;++D)B[D]=0;return B}function Be(F,B,D){var L=1,z=0,V=0,re=0,pe=0,te=F.length,ne=ye?new Uint16Array(32):Ie(32);for(V=0;V<32;++V)ne[V]=0;for(V=te;V<D;++V)F[V]=0;te=F.length;var se=ye?new Uint16Array(te):Ie(te);for(V=0;V<te;++V)ne[z=F[V]]++,L<z&&(L=z),se[V]=0;for(ne[0]=0,V=1;V<=L;++V)ne[V+16]=pe=pe+ne[V-1]<<1;for(V=0;V<te;++V)pe=F[V],pe!=0&&(se[V]=ne[pe+16]++);var we=0;for(V=0;V<te;++V)if(we=F[V],we!=0)for(pe=le(se[V],L)>>L-we,re=(1<<L+4-we)-1;re>=0;--re)B[pe|re<<we]=we&15|V<<4;return L}var Ve=ye?new Uint16Array(512):Ie(512),Le=ye?new Uint16Array(32):Ie(32);if(!ye){for(var Oe=0;Oe<512;++Oe)Ve[Oe]=0;for(Oe=0;Oe<32;++Oe)Le[Oe]=0}(function(){for(var F=[],B=0;B<32;B++)F.push(5);Be(F,Le,32);var D=[];for(B=0;B<=143;B++)D.push(8);for(;B<=255;B++)D.push(9);for(;B<=279;B++)D.push(7);for(;B<=287;B++)D.push(8);Be(D,Ve,288)})();var Qe=function(){for(var B=ye?new Uint8Array(32768):[],D=0,L=0;D<J.length-1;++D)for(;L<J[D+1];++L)B[L]=D;for(;L<32768;++L)B[L]=29;var z=ye?new Uint8Array(259):[];for(D=0,L=0;D<W.length-1;++D)for(;L<W[D+1];++L)z[L]=D;function V(pe,te){for(var ne=0;ne<pe.length;){var se=Math.min(65535,pe.length-ne),we=ne+se==pe.length;for(te.write_shift(1,+we),te.write_shift(2,se),te.write_shift(2,~se&65535);se-- >0;)te[te.l++]=pe[ne++]}return te.l}function re(pe,te){for(var ne=0,se=0,we=ye?new Uint16Array(32768):[];se<pe.length;){var Ce=Math.min(65535,pe.length-se);if(Ce<10){for(ne=ue(te,ne,+(se+Ce==pe.length)),ne&7&&(ne+=8-(ne&7)),te.l=ne/8|0,te.write_shift(2,Ce),te.write_shift(2,~Ce&65535);Ce-- >0;)te[te.l++]=pe[se++];ne=te.l*8;continue}ne=ue(te,ne,+(se+Ce==pe.length)+2);for(var De=0;Ce-- >0;){var je=pe[se];De=(De<<5^je)&32767;var Fe=-1,We=0;if((Fe=we[De])&&(Fe|=se&-32768,Fe>se&&(Fe-=32768),Fe<se))for(;pe[Fe+We]==pe[se+We]&&We<250;)++We;if(We>2){je=z[We],je<=22?ne=$e(te,ne,H[je+1]>>1)-1:($e(te,ne,3),ne+=5,$e(te,ne,H[je-23]>>5),ne+=3);var yt=je<8?0:je-4>>2;yt>0&&(ct(te,ne,We-W[je]),ne+=yt),je=B[se-Fe],ne=$e(te,ne,H[je]>>3),ne-=3;var vt=je<4?0:je-2>>1;vt>0&&(ct(te,ne,se-Fe-J[je]),ne+=vt);for(var nr=0;nr<We;++nr)we[De]=se&32767,De=(De<<5^pe[se])&32767,++se;Ce-=We-1}else je<=143?je=je+48:ne=Me(te,ne,1),ne=$e(te,ne,H[je]),we[De]=se&32767,++se}ne=$e(te,ne,0)-1}return te.l=(ne+7)/8|0,te.l}return function(te,ne){return te.length<8?V(te,ne):re(te,ne)}}();function gt(F){var B=ce(50+Math.floor(F.length*1.1)),D=Qe(F,B);return B.slice(0,D)}var Er=ye?new Uint16Array(32768):Ie(32768),Cn=ye?new Uint16Array(32768):Ie(32768),Vs=ye?new Uint16Array(128):Ie(128),Hs=1,Gs=1;function qo(F,B){var D=ge(F,B)+257;B+=5;var L=ge(F,B)+1;B+=5;var z=xe(F,B)+4;B+=4;for(var V=0,re=ye?new Uint8Array(19):Ie(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ne=ye?new Uint8Array(8):Ie(8),se=ye?new Uint8Array(8):Ie(8),we=re.length,Ce=0;Ce<z;++Ce)re[I[Ce]]=V=G(F,B),te<V&&(te=V),ne[V]++,B+=3;var De=0;for(ne[0]=0,Ce=1;Ce<=te;++Ce)se[Ce]=De=De+ne[Ce-1]<<1;for(Ce=0;Ce<we;++Ce)(De=re[Ce])!=0&&(pe[Ce]=se[De]++);var je=0;for(Ce=0;Ce<we;++Ce)if(je=re[Ce],je!=0){De=H[pe[Ce]]>>8-je;for(var Fe=(1<<7-je)-1;Fe>=0;--Fe)Vs[De|Fe<<je]=je&7|Ce<<3}var We=[];for(te=1;We.length<D+L;)switch(De=Vs[me(F,B)],B+=De&7,De>>>=3){case 16:for(V=3+de(F,B),B+=2,De=We[We.length-1];V-- >0;)We.push(De);break;case 17:for(V=3+G(F,B),B+=3;V-- >0;)We.push(0);break;case 18:for(V=11+me(F,B),B+=7;V-- >0;)We.push(0);break;default:We.push(De),te<De&&(te=De);break}var yt=We.slice(0,D),vt=We.slice(D);for(Ce=D;Ce<286;++Ce)yt[Ce]=0;for(Ce=L;Ce<30;++Ce)vt[Ce]=0;return Hs=Be(yt,Er,286),Gs=Be(vt,Cn,30),B}function Vo(F,B){if(F[0]==3&&!(F[1]&3))return[ei(B),2];for(var D=0,L=0,z=Cu(B||1<<18),V=0,re=z.length>>>0,pe=0,te=0;!(L&1);){if(L=G(F,D),D+=3,L>>>1)L>>1==1?(pe=9,te=5):(D=qo(F,D),pe=Hs,te=Gs);else{D&7&&(D+=8-(D&7));var ne=F[D>>>3]|F[(D>>>3)+1]<<8;if(D+=32,ne>0)for(!B&&re<V+ne&&(z=rt(z,V+ne),re=z.length);ne-- >0;)z[V++]=F[D>>>3],D+=8;continue}for(;;){!B&&re<V+32767&&(z=rt(z,V+32767),re=z.length);var se=Te(F,D,pe),we=L>>>1==1?Ve[se]:Er[se];if(D+=we&15,we>>>=4,!(we>>>8&255))z[V++]=we;else{if(we==256)break;we-=257;var Ce=we<8?0:we-4>>2;Ce>5&&(Ce=0);var De=V+W[we];Ce>0&&(De+=Te(F,D,Ce),D+=Ce),se=Te(F,D,te),we=L>>>1==1?Le[se]:Cn[se],D+=we&15,we>>>=4;var je=we<4?0:we-2>>1,Fe=J[we];for(je>0&&(Fe+=Te(F,D,je),D+=je),!B&&re<De&&(z=rt(z,De+100),re=z.length);V<De;)z[V]=z[V-Fe],++V}}}return B?[z,D+7>>>3]:[z.slice(0,V),D+7>>>3]}function vd(F,B){var D=F.slice(F.l||0),L=Vo(D,B);return F.l+=L[1],L[0]}function bd(F,B){if(F)typeof console<"u"&&console.error(B);else throw new Error(B)}function wd(F,B){var D=F;Tr(D,0);var L=[],z=[],V={FileIndex:L,FullPaths:z};b(V,{root:B.root});for(var re=D.length-4;(D[re]!=80||D[re+1]!=75||D[re+2]!=5||D[re+3]!=6)&&re>=0;)--re;D.l=re+4,D.l+=4;var pe=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,re=0;re<pe;++re){D.l+=20;var ne=D.read_shift(4),se=D.read_shift(4),we=D.read_shift(2),Ce=D.read_shift(2),De=D.read_shift(2);D.l+=8;var je=D.read_shift(4),Fe=l(D.slice(D.l+we,D.l+we+Ce));D.l+=we+Ce+De;var We=D.l;D.l=je+4,Dp(D,ne,se,V,Fe),D.l=We}return V}function Dp(F,B,D,L,z){F.l+=2;var V=F.read_shift(2),re=F.read_shift(2),pe=o(F);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var te=F.read_shift(4),ne=F.read_shift(4),se=F.read_shift(4),we=F.read_shift(2),Ce=F.read_shift(2),De="",je=0;je<we;++je)De+=String.fromCharCode(F[F.l++]);if(Ce){var Fe=l(F.slice(F.l,F.l+Ce));(Fe[21589]||{}).mt&&(pe=Fe[21589].mt),((z||{})[21589]||{}).mt&&(pe=z[21589].mt)}F.l+=Ce;var We=F.slice(F.l,F.l+ne);switch(re){case 8:We=U(F,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var yt=!1;V&8&&(te=F.read_shift(4),te==134695760&&(te=F.read_shift(4),yt=!0),ne=F.read_shift(4),se=F.read_shift(4)),ne!=B&&bd(yt,"Bad compressed size: "+B+" != "+ne),se!=D&&bd(yt,"Bad uncompressed size: "+D+" != "+se),Ho(L,De,We,{unsafe:!0,mt:pe})}function Op(F,B){var D=B||{},L=[],z=[],V=ce(1),re=D.compression?8:0,pe=0,te=0,ne=0,se=0,we=0,Ce=F.FullPaths[0],De=Ce,je=F.FileIndex[0],Fe=[],We=0;for(te=1;te<F.FullPaths.length;++te)if(De=F.FullPaths[te].slice(Ce.length),je=F.FileIndex[te],!(!je.size||!je.content||De=="Sh33tJ5")){var yt=se,vt=ce(De.length);for(ne=0;ne<De.length;++ne)vt.write_shift(1,De.charCodeAt(ne)&127);vt=vt.slice(0,vt.l),Fe[we]=p2.buf(je.content,0);var nr=je.content;re==8&&(nr=O(nr)),V=ce(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,pe),V.write_shift(2,re),je.mt?a(V,je.mt):V.write_shift(4,0),V.write_shift(-4,Fe[we]),V.write_shift(4,nr.length),V.write_shift(4,je.content.length),V.write_shift(2,vt.length),V.write_shift(2,0),se+=V.length,L.push(V),se+=vt.length,L.push(vt),se+=nr.length,L.push(nr),V=ce(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,pe),V.write_shift(2,re),V.write_shift(4,0),V.write_shift(-4,Fe[we]),V.write_shift(4,nr.length),V.write_shift(4,je.content.length),V.write_shift(2,vt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,yt),We+=V.l,z.push(V),We+=vt.length,z.push(vt),++we}return V=ce(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,we),V.write_shift(2,we),V.write_shift(4,We),V.write_shift(4,se),V.write_shift(2,0),Qt([Qt(L),Qt(z),V])}var Ys={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lp(F,B){if(F.ctype)return F.ctype;var D=F.name||"",L=D.match(/\.([^\.]+)$/);return L&&Ys[L[1]]||B&&(L=(D=B).match(/[\.\\]([^\.\\])+$/),L&&Ys[L[1]])?Ys[L[1]]:"application/octet-stream"}function Mp(F){for(var B=Es(F),D=[],L=0;L<B.length;L+=76)D.push(B.slice(L,L+76));return D.join(`\r
`)+`\r
`}function Bp(F){var B=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var se=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],L=B.split(`\r
`),z=0;z<L.length;++z){var V=L[z];if(V.length==0){D.push("");continue}for(var re=0;re<V.length;){var pe=76,te=V.slice(re,re+pe);te.charAt(pe-1)=="="?pe--:te.charAt(pe-2)=="="?pe-=2:te.charAt(pe-3)=="="&&(pe-=3),te=V.slice(re,re+pe),re+=pe,re<V.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function $p(F){for(var B=[],D=0;D<F.length;++D){for(var L=F[D];D<=F.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+F[++D];B.push(L)}for(var z=0;z<B.length;++z)B[z]=B[z].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Hr(B.join(`\r
`))}function Up(F,B,D){for(var L="",z="",V="",re,pe=0;pe<10;++pe){var te=B[pe];if(!te||te.match(/^\s*$/))break;var ne=te.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":L=ne[2].trim();break;case"content-type":V=ne[2].trim();break;case"content-transfer-encoding":z=ne[2].trim();break}}switch(++pe,z.toLowerCase()){case"base64":re=Hr(_n(B.slice(pe).join("")));break;case"quoted-printable":re=$p(B.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var se=Ho(F,L.slice(D.length),re,{unsafe:!0});V&&(se.ctype=V)}function zp(F,B){if(Q(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=B&&B.root||"",L=(tt&&Buffer.isBuffer(F)?F.toString("binary"):Q(F)).split(`\r
`),z=0,V="";for(z=0;z<L.length;++z)if(V=L[z],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),D||(D=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),V.slice(0,D.length)!=D););var re=(L[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var pe="--"+(re[1]||""),te=[],ne=[],se={FileIndex:te,FullPaths:ne};b(se);var we,Ce=0;for(z=0;z<L.length;++z){var De=L[z];De!==pe&&De!==pe+"--"||(Ce++&&Up(se,L.slice(we,z),D),we=z)}return se}function Wp(F,B){var D=B||{},L=D.boundary||"SheetJS";L="------="+L;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],V=F.FullPaths[0],re=V,pe=F.FileIndex[0],te=1;te<F.FullPaths.length;++te)if(re=F.FullPaths[te].slice(V.length),pe=F.FileIndex[te],!(!pe.size||!pe.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var ne=pe.content,se=tt&&Buffer.isBuffer(ne)?ne.toString("binary"):Q(ne),we=0,Ce=Math.min(1024,se.length),De=0,je=0;je<=Ce;++je)(De=se.charCodeAt(je))>=32&&De<128&&++we;var Fe=we>=Ce*4/5;z.push(L),z.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+re),z.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),z.push("Content-Type: "+Lp(pe,re)),z.push(""),z.push(Fe?Bp(se):Mp(se))}return z.push(L+`--\r
`),z.join(`\r
`)}function qp(F){var B={};return b(B,F),B}function Ho(F,B,D,L){var z=L&&L.unsafe;z||b(F);var V=!z&&dt.find(F,B);if(!V){var re=F.FullPaths[0];B.slice(0,re.length)==re?re=B:(re.slice(-1)!="/"&&(re+="/"),re=(re+B).replace("//","/")),V={name:s(B),type:2},F.FileIndex.push(V),F.FullPaths.push(re),z||dt.utils.cfb_gc(F)}return V.content=D,V.size=D?D.length:0,L&&(L.CLSID&&(V.clsid=L.CLSID),L.mt&&(V.mt=L.mt),L.ct&&(V.ct=L.ct)),V}function Vp(F,B){b(F);var D=dt.find(F,B);if(D){for(var L=0;L<F.FileIndex.length;++L)if(F.FileIndex[L]==D)return F.FileIndex.splice(L,1),F.FullPaths.splice(L,1),!0}return!1}function Hp(F,B,D){b(F);var L=dt.find(F,B);if(L){for(var z=0;z<F.FileIndex.length;++z)if(F.FileIndex[z]==L)return F.FileIndex[z].name=s(D),F.FullPaths[z]=D,!0}return!1}function Gp(F){A(F,!0)}return t.find=j,t.read=E,t.parse=u,t.write=ie,t.writeFile=K,t.utils={cfb_new:qp,cfb_add:Ho,cfb_del:Vp,cfb_mov:Hp,cfb_gc:Gp,ReadShift:ds,CheckField:Cf,prep_blob:Tr,bconcat:Qt,use_zlib:R,_deflateRaw:gt,_inflateRaw:vd,consts:q},t}();function x2(e){return typeof e=="string"?Oo(e):Array.isArray(e)?Ub(e):e}function $s(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Oo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var i=r=="utf8"?Ts(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var s=new Blob([x2(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Bs(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function er(e){for(var t=Object.keys(e),r=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(e,t[i])&&r.push(t[i]);return r}function Lu(e,t){for(var r=[],i=er(e),s=0;s!==i.length;++s)r[e[i[s]][t]]==null&&(r[e[i[s]][t]]=i[s]);return r}function Zc(e){for(var t=[],r=er(e),i=0;i!==r.length;++i)t[e[r[i]]]=r[i];return t}function Bo(e){for(var t=[],r=er(e),i=0;i!==r.length;++i)t[e[r[i]]]=parseInt(r[i],10);return t}function m2(e){for(var t=[],r=er(e),i=0;i!==r.length;++i)t[e[r[i]]]==null&&(t[e[r[i]]]=[]),t[e[r[i]]].push(r[i]);return t}var ro=new Date(1899,11,30,0,0,0);function Sr(e,t){var r=e.getTime(),i=ro.getTime()+(e.getTimezoneOffset()-ro.getTimezoneOffset())*6e4;return(r-i)/(24*60*60*1e3)}var hf=new Date,g2=ro.getTime()+(hf.getTimezoneOffset()-ro.getTimezoneOffset())*6e4,Mu=hf.getTimezoneOffset();function ff(e){var t=new Date;return t.setTime(e*24*60*60*1e3+g2),t.getTimezoneOffset()!==Mu&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Mu)*6e4),t}var Bu=new Date("2017-02-19T19:06:09.000Z"),pf=isNaN(Bu.getFullYear())?new Date("2/19/17"):Bu,y2=pf.getFullYear()==2017;function mr(e,t){var r=new Date(e);if(y2)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(pf.getFullYear()==1917&&!isNaN(r.getFullYear())){var i=r.getFullYear();return e.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function $o(e,t){if(tt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function jr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=jr(e[r]));return t}function kt(e,t){for(var r="";r.length<t;)r+=e;return r}function Sn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(i)))?t/r:t}var v2=["january","february","march","april","may","june","july","august","september","october","november","december"];function _s(e){var t=new Date(e),r=new Date(NaN),i=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v2.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return i<0||i>8099?r:(s>0||a>1)&&i!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var i;return tt?i=kn(r):i=zb(r),dt.utils.cfb_add(e,t,i)}dt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ed(){return dt.utils.cfb_new()}var Mt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,b2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},td=Zc(b2),rd=/[&<>'"]/g,w2=/[\u0000-\u0008\u000b-\u001f]/g;function at(e){var t=e+"";return t.replace(rd,function(r){return td[r]}).replace(w2,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $u(e){return at(e).replace(/ /g,"_x0020_")}var xf=/[\u0000-\u001f]/g;function S2(e){var t=e+"";return t.replace(rd,function(r){return td[r]}).replace(/\n/g,"<br/>").replace(xf,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function j2(e){var t=e+"";return t.replace(rd,function(r){return td[r]}).replace(xf,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function E2(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function _2(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nl(e){for(var t="",r=0,i=0,s=0,a=0,o=0,l=0;r<e.length;){if(i=e.charCodeAt(r++),i<128){t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),i>191&&i<224){o=(i&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),i<240){t+=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Uu(e){var t=ei(2*e.length),r,i,s=1,a=0,o=0,l;for(i=0;i<e.length;i+=s)s=1,(l=e.charCodeAt(i))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(i+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function zu(e){return kn(e,"binary").toString("utf8")}var xa="foo bar bazâð£",cs=tt&&(zu(xa)==Nl(xa)&&zu||Uu(xa)==Nl(xa)&&Uu)||Nl,Ts=tt?function(e){return kn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,i=0,s=0;r<e.length;)switch(i=e.charCodeAt(r++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(r++)-56320+(i<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},T2=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}}(),mf=/(^\s|\s$|\n)/;function Jt(e,t){return"<"+e+(t.match(mf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function As(e){return er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ee(e,t,r){return"<"+e+(r!=null?As(r):"")+(t!=null?(t.match(mf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function A2(e,t){switch(typeof e){case"string":var r=Ee("vt:lpwstr",at(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ee((e|0)==e?"vt:i4":"vt:r8",at(String(e)));case"boolean":return Ee("vt:bool",e?"true":"false")}if(e instanceof Date)return Ee("vt:filetime",mc(e));throw new Error("Unable to serialize "+e)}var qt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$i=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function k2(e,t){for(var r=1-2*(e[t+7]>>>7),i=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return i==2047?s==0?r*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),r*Math.pow(2,i-52)*s)}function C2(e,t,r){var i=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=i?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|i}var Wu=function(e){for(var t=[],r=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,a=e[0][i].length;s<a;s+=r)t.push.apply(t,e[0][i].slice(s,s+r));return t},qu=tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:kn(t)})):Wu(e)}:Wu,Vu=function(e,t,r){for(var i=[],s=t;s<r;s+=2)i.push(String.fromCharCode(is(e,s)));return i.join("").replace(ls,"")},nd=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ls,""):Vu(e,t,r)}:Vu,Hu=function(e,t,r){for(var i=[],s=t;s<t+r;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},gf=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Hu(e,t,r)}:Hu,Gu=function(e,t,r){for(var i=[],s=t;s<r;s++)i.push(String.fromCharCode(Si(e,s)));return i.join("")},Us=tt?function(t,r,i){return Buffer.isBuffer(t)?t.toString("utf8",r,i):Gu(t,r,i)}:Gu,yf=function(e,t){var r=kr(e,t);return r>0?Us(e,t+4,t+4+r-1):""},vf=yf,bf=function(e,t){var r=kr(e,t);return r>0?Us(e,t+4,t+4+r-1):""},wf=bf,Sf=function(e,t){var r=2*kr(e,t);return r>0?Us(e,t+4,t+4+r-1):""},jf=Sf,Ef=function(t,r){var i=kr(t,r);return i>0?nd(t,r+4,r+4+i):""},_f=Ef,Tf=function(e,t){var r=kr(e,t);return r>0?Us(e,t+4,t+4+r):""},Af=Tf,kf=function(e,t){return k2(e,t)},no=kf,id=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};tt&&(vf=function(t,r){if(!Buffer.isBuffer(t))return yf(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},wf=function(t,r){if(!Buffer.isBuffer(t))return bf(t,r);var i=t.readUInt32LE(r);return i>0?t.toString("utf8",r+4,r+4+i-1):""},jf=function(t,r){if(!Buffer.isBuffer(t))return Sf(t,r);var i=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i-1)},_f=function(t,r){if(!Buffer.isBuffer(t))return Ef(t,r);var i=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+i)},Af=function(t,r){if(!Buffer.isBuffer(t))return Tf(t,r);var i=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+i)},no=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):kf(t,r)},id=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Si=function(e,t){return e[t]},is=function(e,t){return e[t+1]*256+e[t]},I2=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Gn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},N2=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ds(e,t){var r="",i,s,a=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(is(this,c)),c+=2;e*=2;break;case"utf8":r=Us(this,this.l,this.l+e);break;case"utf16le":e*=2,r=nd(this,this.l,this.l+e);break;case"wstr":return ds.call(this,e,"dbcs");case"lpstr-ansi":r=vf(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":r=wf(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":r=jf(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),r=_f(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),r=Af(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Si(this,this.l+e++))!==0;)a.push(ha(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=is(this,this.l+e))!==0;)a.push(ha(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Si(this,c),this.l=c+1,l=ds.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(ha(is(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Si(this,c),this.l=c+1,l=ds.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(ha(Si(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return i=Si(this,this.l),this.l++,i;case 2:return i=(t==="i"?I2:is)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(i=(e>0?Gn:N2)(this,this.l),this.l+=4,i):(s=kr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=no(this,this.l):s=no([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=gf(this,this.l,e);break}}return this.l+=e,r}var F2=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},R2=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},P2=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function D2(e,t,r){var i=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)P2(this,t.charCodeAt(s),this.l+2*s);i=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;i=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,F2(this,t,this.l);break;case 8:if(i=8,r==="f"){C2(this,t,this.l);break}case 16:break;case-4:i=4,R2(this,t,this.l);break}return this.l+=i,this}function Cf(e,t){var r=gf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Tr(e,t){e.l=t,e.read_shift=ds,e.chk=Cf,e.write_shift=D2}function hn(e,t){e.l+=t}function ce(e){var t=ei(e);return Tr(t,0),t}function vr(){var e=[],t=tt?256:2048,r=function(c){var u=ce(c);return Tr(u,0),u},i=r(t),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},a=function(c){return i&&c<i.length-i.l?i:(s(),i=r(Math.max(c+1,t)))},o=function(){return s(),Qt(e)},l=function(c){s(),i=c,i.l==null&&(i.l=i.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ve(e,t,r,i){var s=+t,a;if(!isNaN(s)){i||(i=kT[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,i>=128&&++a,i>=16384&&++a,i>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(i>=128)o.write_shift(1,(i&127)+128),i>>=7;else{o.write_shift(1,i);break}i>0&&id(r)&&e.push(r)}}function us(e,t,r){var i=jr(e);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Yu(e,t,r){var i=jr(e);return i.s=us(i.s,t.s,r),i.e=us(i.e,t.s,r),i}function hs(e,t){if(e.cRel&&e.c<0)for(e=jr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=jr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ot(e);return!e.cRel&&e.cRel!=null&&(r=M2(r)),!e.rRel&&e.rRel!=null&&(r=O2(r)),r}function Fl(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dr(e.s.c)+":"+(e.e.cRel?"":"$")+dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zt(e.s.r)+":"+(e.e.rRel?"":"$")+Zt(e.e.r):hs(e.s,t.biff)+":"+hs(e.e,t.biff)}function sd(e){return parseInt(L2(e),10)-1}function Zt(e){return""+(e+1)}function O2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function L2(e){return e.replace(/\$(\d+)$/,"$1")}function ad(e){for(var t=B2(e),r=0,i=0;i!==t.length;++i)r=26*r+t.charCodeAt(i)-64;return r-1}function dr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function M2(e){return e.replace(/^([A-Z])/,"$$$1")}function B2(e){return e.replace(/^\$([A-Z])/,"$1")}function $2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vt(e){for(var t=0,r=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ot(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rr(e){var t=e.indexOf(":");return t==-1?{s:Vt(e),e:Vt(e)}:{s:Vt(e.slice(0,t)),e:Vt(e.slice(t+1))}}function Lt(e,t){return typeof t>"u"||typeof t=="number"?Lt(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof t!="string"&&(t=ot(t)),e==t?e:e+":"+t)}function mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,s=0,a=e.length;for(r=0;i<a&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.s.c=--r,r=0;i<a&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;if(t.s.r=--r,i===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,r=0;i!=a&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(t.e.c=--r,r=0;i!=a&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;return t.e.r=--r,t}function Xu(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Mn(e.z,r?Sr(t):t)}catch{}try{return e.w=Mn((e.XF||{}).numFmtId||(r?14:0),r?Sr(t):t)}catch{return""+t}}function Tn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zs[e.v]||e.v:t==null?Xu(e,e.v):Xu(e,t))}function ii(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",i={};return i[r]=e,{SheetNames:[r],Sheets:i}}function If(e,t,r){var i=r||{},s=e?Array.isArray(e):i.dense,a=e||(s?[]:{}),o=0,l=0;if(a&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var d=typeof i.origin=="string"?Vt(i.origin):i.origin;o=d.r,l=d.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=mt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},y=o+f,x=l+h;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(i.nullError)p.t="e",p.v=0;else if(i.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=i.dateNF||It[14],i.cellDates?(p.t="d",p.w=Mn(p.z,Sr(p.v))):(p.t="n",p.v=Sr(p.v),p.w=Mn(p.z,p.v))):p.t="s";if(s)a[y]||(a[y]=[]),a[y][x]&&a[y][x].z&&(p.z=a[y][x].z),a[y][x]=p;else{var g=ot({c:x,r:y});a[g]&&a[g].z&&(p.z=a[g].z),a[g]=p}}}return c.s.c<1e7&&(a["!ref"]=Lt(c)),a}function Ui(e,t){return If(null,e,t)}function U2(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=ce(4)),t.write_shift(4,e),t}function ur(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ht(e,t){var r=!1;return t==null&&(r=!0,t=ce(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function z2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function W2(e,t){return t||(t=ce(4)),t.write_shift(2,0),t.write_shift(2,0),t}function od(e,t){var r=e.l,i=e.read_shift(1),s=ur(e),a=[],o={t:s,h:s};if(i&1){for(var l=e.read_shift(4),d=0;d!=l;++d)a.push(z2(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function q2(e,t){var r=!1;return t==null&&(r=!0,t=ce(15+4*e.t.length)),t.write_shift(1,0),Ht(e.t,t),r?t.slice(0,t.l):t}var V2=od;function H2(e,t){var r=!1;return t==null&&(r=!0,t=ce(23+4*e.t.length)),t.write_shift(1,1),Ht(e.t,t),t.write_shift(4,1),W2({},t),r?t.slice(0,t.l):t}function Ur(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function si(e,t){return t==null&&(t=ce(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ai(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function oi(e,t){return t==null&&(t=ce(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var G2=ur,Nf=Ht;function ld(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function io(e,t){var r=!1;return t==null&&(r=!0,t=ce(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Y2=ur,gc=ld,cd=io;function Ff(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,i=t[0]&2;e.l+=4;var s=i===0?no([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Gn(t,0)>>2;return r?s/100:s}function Rf(e,t){t==null&&(t=ce(4));var r=0,i=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,r=1),i)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Pf(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function X2(e,t){return t||(t=ce(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var li=Pf,zi=X2;function Wi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ti(e,t){return(t||ce(8)).write_shift(8,e,"f")}function K2(e){var t={},r=e.read_shift(1),i=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,i){case 0:t.auto=1;break;case 1:t.index=s;var c=sw[s];c&&(t.rgb=ah(c));break;case 2:t.rgb=ah([o,l,d]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function so(e,t){if(t||(t=ce(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=e.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function Q2(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function J2(e,t){t||(t=ce(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Df=2,_r=3,ma=11,ao=19,ga=64,Z2=65,ew=71,tw=4108,rw=4126,Xt=80,Ku={1:{n:"CodePage",t:Df},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:_r},5:{n:"LineCount",t:_r},6:{n:"ParagraphCount",t:_r},7:{n:"SlideCount",t:_r},8:{n:"NoteCount",t:_r},9:{n:"HiddenCount",t:_r},10:{n:"MultimediaClipCount",t:_r},11:{n:"ScaleCrop",t:ma},12:{n:"HeadingPairs",t:tw},13:{n:"TitlesOfParts",t:rw},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:ma},17:{n:"CharacterCount",t:_r},19:{n:"SharedDoc",t:ma},22:{n:"HyperlinksChanged",t:ma},23:{n:"AppVersion",t:_r,p:"version"},24:{n:"DigSig",t:Z2},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:ao},2147483651:{n:"Behavior",t:ao},1919054434:{}},Qu={1:{n:"CodePage",t:Df},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:ga},11:{n:"LastPrinted",t:ga},12:{n:"CreatedDate",t:ga},13:{n:"ModifiedDate",t:ga},14:{n:"PageCount",t:_r},15:{n:"WordCount",t:_r},16:{n:"CharCount",t:_r},17:{n:"Thumbnail",t:ew},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:_r},255:{},2147483648:{n:"Locale",t:ao},2147483651:{n:"Behavior",t:ao},1919054434:{}};function nw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var iw=nw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sw=jr(iw),zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ya={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Of(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Lf(e,t){var r=m2(aw),i=[],s;i[i.length]=Mt,i[i.length]=Ee("Types",null,{xmlns:qt.CT,"xmlns:xsd":qt.xsd,"xmlns:xsi":qt.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ee("Default",null,{Extension:d[0],ContentType:d[1]})}));var a=function(d){e[d]&&e[d].length>0&&(s=e[d][0],i[i.length]=Ee("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:ya[d][t.bookType]||ya[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){i[i.length]=Ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ya[d][t.bookType]||ya[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){i[i.length]=Ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Je={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ci(e){var t=[Mt,Ee("Relationships",null,{xmlns:qt.RELS})];return er(e["!id"]).forEach(function(r){t[t.length]=Ee("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function st(e,t,r,i,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=i,s.Target=r,[Je.HLINK,Je.XPATH,Je.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function ow(e){var t=[Mt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ju(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function lw(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function cw(e){var t=[Mt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Ju(e[r][0],e[r][1])),t.push(lw("",e[r][0]));return t.push(Ju("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Bf(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ja.version+"</meta:generator></office:meta></office:document-meta>"}var Xn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Rl(e,t,r,i,s){s[e]!=null||t==null||t===""||(s[e]=t,t=at(t),i[i.length]=r?Ee(e,t,r):Jt(e,t))}function $f(e,t){var r=t||{},i=[Mt,Ee("cp:coreProperties",null,{"xmlns:cp":qt.CORE_PROPS,"xmlns:dc":qt.dc,"xmlns:dcterms":qt.dcterms,"xmlns:dcmitype":qt.dcmitype,"xmlns:xsi":qt.xsi})],s={};if(!e&&!r.Props)return i.join("");e&&(e.CreatedDate!=null&&Rl("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:mc(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),e.ModifiedDate!=null&&Rl("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:mc(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var a=0;a!=Xn.length;++a){var o=Xn[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Rl(o[0],l,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Ii=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Uf=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zf(e){var t=[],r=Ee;return e||(e={}),e.Application="SheetJS",t[t.length]=Mt,t[t.length]=Ee("Properties",null,{xmlns:qt.EXT_PROPS,"xmlns:vt":qt.vt}),Ii.forEach(function(i){if(e[i[1]]!==void 0){var s;switch(i[2]){case"string":s=at(String(e[i[1]]));break;case"bool":s=e[i[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(i[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+at(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Wf(e){var t=[Mt,Ee("Properties",null,{xmlns:qt.CUST_PROPS,"xmlns:vt":qt.vt})];if(!e)return t.join("");var r=1;return er(e).forEach(function(s){++r,t[t.length]=Ee("property",A2(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:at(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zu={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dw(e,t){var r=[];return er(Zu).map(function(i){for(var s=0;s<Xn.length;++s)if(Xn[s][1]==i)return Xn[s];for(s=0;s<Ii.length;++s)if(Ii[s][1]==i)return Ii[s];throw i}).forEach(function(i){if(e[i[1]]!=null){var s=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:e[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Jt(Zu[i[1]]||i[1],s))}}),Ee("DocumentProperties",r.join(""),{xmlns:Ar.o})}function uw(e,t){var r=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return e&&er(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<Xn.length;++o)if(a==Xn[o][1])return;for(o=0;o<Ii.length;++o)if(a==Ii[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),s.push(Ee($u(a),l,{"dt:dt":d}))}}),t&&er(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ee($u(a),o,{"dt:dt":l}))}}),"<"+i+' xmlns="'+Ar.o+'">'+s.join("")+"</"+i+">"}function hw(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,i=r%Math.pow(2,32),s=(r-i)/Math.pow(2,32);i*=1e7,s*=1e7;var a=i/Math.pow(2,32)|0;a>0&&(i=i%Math.pow(2,32),s+=a);var o=ce(8);return o.write_shift(4,i),o.write_shift(4,s),o}function eh(e,t){var r=ce(4),i=ce(4);switch(r.write_shift(4,e==80?31:e),e){case 3:i.write_shift(-4,t);break;case 5:i=ce(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=hw(t);break;case 31:case 80:for(i=ce(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qt([r,i])}var qf=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fw(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function th(e,t,r){var i=ce(8),s=[],a=[],o=8,l=0,d=ce(8),c=ce(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),a.push(d),s.push(c),o+=8+d.length,!t){c=ce(8),c.write_shift(4,0),s.unshift(c);var u=[ce(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(d=ce(8+2*(f.length+1)+(f.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,f.length+1),d.write_shift(0,f,"dbcs");d.l!=d.length;)d.write_shift(1,0);u.push(d)}d=Qt(u),a.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(qf.indexOf(e[l][0])>-1||Uf.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var y=r[p];if(y.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}d=eh(y.t,h)}else{var g=fw(h);g==-1&&(g=31,h=String(h)),d=eh(g,h)}a.push(d),c=ce(8),c.write_shift(4,t?p:2+l),s.push(c),o+=8+d.length}var v=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,v),v+=a[l].length;return i.write_shift(4,o),i.write_shift(4,a.length),Qt([i].concat(s).concat(a))}function rh(e,t,r,i,s,a){var o=ce(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,dt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var d=th(e,r,i);if(l.push(d),s){var c=th(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+d.length),l.push(c)}return Qt(l)}function pw(e,t){t||(t=ce(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xw(e,t){return e.read_shift(t)===1}function xr(e,t){return t||(t=ce(2)),t.write_shift(2,+!!e),t}function Vf(e){return e.read_shift(2,"u")}function Or(e,t){return t||(t=ce(2)),t.write_shift(2,e),t}function Hf(e,t,r){return r||(r=ce(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Gf(e,t,r){var i=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=i?e.read_shift(i,s):"";return o}function mw(e){var t=e.t||"",r=ce(3);r.write_shift(2,t.length),r.write_shift(1,1);var i=ce(2*t.length);i.write_shift(2*t.length,t,"utf16le");var s=[r,i];return Qt(s)}function gw(e,t,r){var i;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(t,"sbcs-cont"):i=e.read_shift(t,"dbcs-cont"),i}function yw(e,t,r){var i=e.read_shift(r&&r.biff==2?1:2);return i===0?(e.l++,""):gw(e,i,r)}function vw(e,t,r){if(r.biff>5)return yw(e,t,r);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Yf(e,t,r){return r||(r=ce(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function nh(e,t){t||(t=ce(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function bw(e){var t=ce(512),r=0,i=e.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),a=s>-1?31:23;switch(i.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)i=i.slice(1),nh(i,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?i.slice(0,s):i;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&nh(s>-1?i.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;i.slice(d*3,d*3+3)=="../"||i.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,i.length-3*d+1),r=0;r<i.length-3*d;++r)t.write_shift(1,i.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ri(e,t,r,i){return i||(i=ce(6)),i.write_shift(2,e),i.write_shift(2,t),i.write_shift(2,r||0),i}function ww(e,t,r){var i=r.biff>8?4:2,s=e.read_shift(i),a=e.read_shift(i,"i"),o=e.read_shift(i,"i");return[s,a,o]}function Sw(e){var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r:t},e:{c:s,r}}}function Xf(e,t){return t||(t=ce(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function dd(e,t,r){var i=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ce(s);return a.write_shift(2,i),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function jw(e,t){var r=!t||t.biff==8,i=ce(r?112:54);for(i.write_shift(t.biff==8?2:1,7),r&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(r?0:536870912));i.l<i.length;)i.write_shift(1,r?0:32);return i}function Ew(e,t){var r=!t||t.biff>=8?2:1,i=ce(8+r*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function _w(e,t){var r=ce(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var i=[],s=0;s<e.length;++s)i[s]=mw(e[s]);var a=Qt([r].concat(i));return a.parts=[r.length].concat(i.map(function(o){return o.length})),a}function Tw(){var e=ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Aw(e){var t=ce(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function kw(e,t){var r=e.name||"Arial",i=t&&t.biff==5,s=i?15+r.length:16+2*r.length,a=ce(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le"),a}function Cw(e,t,r,i){var s=ce(10);return ri(e,t,i,s),s.write_shift(4,r),s}function Iw(e,t,r,i,s){var a=!s||s.biff==8,o=ce(8+ +a+(1+a)*r.length);return ri(e,t,i,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function Nw(e,t,r,i){var s=r&&r.biff==5;i||(i=ce(s?3+t.length:5+2*t.length)),i.write_shift(2,e),i.write_shift(s?1:2,t.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=i.length>i.l?i.slice(0,i.l):i;return a.l==null&&(a.l=a.length),a}function Fw(e,t){var r=t.biff==8||!t.biff?4:2,i=ce(2*r+6);return i.write_shift(r,e.s.r),i.write_shift(r,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}function ih(e,t,r,i){var s=r&&r.biff==5;i||(i=ce(s?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),i.write_shift(4,a),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function Rw(e){var t=ce(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Pw(e,t,r,i,s,a){var o=ce(8);return ri(e,t,i,o),Hf(r,a,o),o}function Dw(e,t,r,i){var s=ce(14);return ri(e,t,i,s),ti(r,s),s}function Ow(e,t,r){if(r.biff<8)return Lw(e,t,r);for(var i=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)i.push(ww(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function Lw(e,t,r){e[e.l+1]==3&&e[e.l]++;var i=Gf(e,t,r);return i.charCodeAt(0)==3?i.slice(1):i}function Mw(e){var t=ce(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Xf(e[r],t);return t}function Bw(e){var t=ce(24),r=Vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(i[s],16));return Qt([t,bw(e[1])])}function $w(e){var t=e[1].Tooltip,r=ce(10+2*(t.length+1));r.write_shift(2,2048);var i=Vt(e[0]);r.write_shift(2,i.r),r.write_shift(2,i.r),r.write_shift(2,i.c),r.write_shift(2,i.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Uw(e){return e||(e=ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function zw(e,t,r){if(!r.cellStyles)return hn(e,t);var i=r&&r.biff>=12?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(i),d=e.read_shift(2);i==2&&(e.l+=2);var c={s,e:a,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function Ww(e,t){var r=ce(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var i=0;return e.hidden&&(i|=1),r.write_shift(1,i),i=e.level||0,r.write_shift(1,i),r.write_shift(2,0),r}function qw(e){for(var t=ce(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Vw(e,t,r){var i=ce(15);return qs(i,e,t),i.write_shift(8,r,"f"),i}function Hw(e,t,r){var i=ce(9);return qs(i,e,t),i.write_shift(2,r),i}var Gw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Zc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],u=ei(1);switch(d.type){case"base64":u=Hr(_n(l));break;case"binary":u=Hr(l);break;case"buffer":case"array":u=l;break}Tr(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,y=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,g=521;f==2&&(x=u.read_shift(2)),u.l+=3,f!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(g=u.read_shift(2));var v=u.read_shift(2),k=d.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(k=e[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var T=[],m={},w=Math.min(u.length,f==2?521:g-10-(p?264:0)),E=y?32:11;u.l<w&&u[u.l]!=13;)switch(m={},m.name=ku.utils.decode(k,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,m.type=String.fromCharCode(u.read_shift(1)),f!=2&&!y&&(m.offset=u.read_shift(4)),m.len=u.read_shift(1),f==2&&(m.offset=u.read_shift(2)),m.dec=u.read_shift(1),m.name.length&&T.push(m),f!=2&&(u.l+=y?13:14),m.type){case"B":(!p||m.len!=8)&&d.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var b=0,_=0;for(c[0]=[],_=0;_!=T.length;++_)c[0][_]=T[_].name;for(;x-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++b]=[],_=0,_=0;_!=T.length;++_){var A=u.slice(u.l,u.l+T[_].len);u.l+=T[_].len,Tr(A,0);var S=ku.utils.decode(k,A);switch(T[_].type){case"C":S.trim().length&&(c[b][_]=S.replace(/\s+$/,""));break;case"D":S.length===8?c[b][_]=new Date(+S.slice(0,4),+S.slice(4,6)-1,+S.slice(6,8)):c[b][_]=S;break;case"F":c[b][_]=parseFloat(S.trim());break;case"+":case"I":c[b][_]=y?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(S.trim().toUpperCase()){case"Y":case"T":c[b][_]=!0;break;case"N":case"F":c[b][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+S+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[b][_]="##MEMO##"+(y?parseInt(S.trim(),10):A.read_shift(4));break;case"N":S=S.replace(/\u0000/g,"").trim(),S&&S!="."&&(c[b][_]=+S||0);break;case"@":c[b][_]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[b][_]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[b][_]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][_]=-A.read_shift(-8,"f");break;case"B":if(p&&T[_].len==8){c[b][_]=A.read_shift(8,"f");break}case"G":case"P":A.l+=T[_].len;break;case"0":if(T[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[_].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=T,c}function i(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ui(r(l,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(l,d){try{return ii(i(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&js(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=vr(),f=ho(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),y=l["!cols"]||[],x=0,g=0,v=0,k=1;for(x=0;x<h.length;++x){if(((y[x]||{}).DBF||{}).name){h[x]=y[x].DBF.name,++v;continue}if(h[x]!=null){if(++v,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(g=0;g<1024;++g)if(h.indexOf(h[x]+"_"+g)==-1){h[x]+="_"+g;break}}}}var T=mt(l["!ref"]),m=[],w=[],E=[];for(x=0;x<=T.e.c-T.s.c;++x){var b="",_="",A=0,S=[];for(g=0;g<p.length;++g)p[g][x]!=null&&S.push(p[g][x]);if(S.length==0||h[x]==null){m[x]="?";continue}for(g=0;g<S.length;++g){switch(typeof S[g]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=S[g]instanceof Date?"D":"C";break;default:_="C"}A=Math.max(A,String(S[g]).length),b=b&&b!=_?"C":_}A>250&&(A=250),_=((y[x]||{}).DBF||{}).type,_=="C"&&y[x].DBF.len>A&&(A=y[x].DBF.len),b=="B"&&_=="N"&&(b="N",E[x]=y[x].DBF.dec,A=y[x].DBF.len),w[x]=b=="C"||_=="N"?A:a[b]||0,k+=w[x],m[x]=b}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,p.length),j.write_shift(2,296+32*v),j.write_shift(2,k),x=0;x<4;++x)j.write_shift(4,0);for(j.write_shift(4,0|(+t[K0]||3)<<8),x=0,g=0;x<h.length;++x)if(h[x]!=null){var C=u.next(32),P=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,P,"sbcs"),C.write_shift(1,m[x]=="?"?"C":m[x],"sbcs"),C.write_shift(4,g),C.write_shift(1,w[x]||a[m[x]]||0),C.write_shift(1,E[x]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),g+=w[x]||a[m[x]]||0}var M=u.next(264);for(M.write_shift(4,13),x=0;x<65;++x)M.write_shift(4,0);for(x=0;x<p.length;++x){var X=u.next(k);for(X.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(m[g]){case"L":X.write_shift(1,p[x][g]==null?63:p[x][g]?84:70);break;case"B":X.write_shift(8,p[x][g]||0,"f");break;case"N":var ee="0";for(typeof p[x][g]=="number"&&(ee=p[x][g].toFixed(E[g]||0)),v=0;v<w[g]-ee.length;++v)X.write_shift(1,32);X.write_shift(1,ee,"sbcs");break;case"D":p[x][g]?(X.write_shift(4,("0000"+p[x][g].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[x][g].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[x][g].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[x][g]!=null?p[x][g]:"").slice(0,w[g]);for(X.write_shift(1,q,"sbcs"),v=0;v<w[g]-q.length;++v)X.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:i,from_sheet:o}}(),Yw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var y=e[p];return typeof y=="number"?Au(y):y},i=function(h,p,y){var x=p.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?h:Au(x)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return a(_n(h),p);case"binary":return a(h,p);case"buffer":return a(tt&&Buffer.isBuffer(h)?h.toString("binary"):Bs(h),p);case"array":return a($o(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var y=h.split(/[\n\r]+/),x=-1,g=-1,v=0,k=0,T=[],m=[],w=null,E={},b=[],_=[],A=[],S=0,j;for(+p.codepage>=0&&js(+p.codepage);v!==y.length;++v){S=0;var C=y[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,r),P=C.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),M=P[0],X;if(C.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&m.push(C.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,q=!1,K=!1,Q=!1,ie=-1,Z=-1;for(k=1;k<P.length;++k)switch(P[k].charAt(0)){case"A":break;case"X":g=parseInt(P[k].slice(1))-1,q=!0;break;case"Y":for(x=parseInt(P[k].slice(1))-1,q||(g=0),j=T.length;j<=x;++j)T[j]=[];break;case"K":X=P[k].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Sn(X))?isNaN(_s(X).getDate())||(X=mr(X)):(X=Sn(X),w!==null&&cf(w)&&(X=ff(X))),ee=!0;break;case"E":Q=!0;var R=HS(P[k].slice(1),{r:x,c:g});T[x][g]=[T[x][g],R];break;case"S":K=!0,T[x][g]=[T[x][g],"S5S"];break;case"G":break;case"R":ie=parseInt(P[k].slice(1))-1;break;case"C":Z=parseInt(P[k].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(ee&&(T[x][g]&&T[x][g].length==2?T[x][g][0]=X:T[x][g]=X,w=null),K){if(Q)throw new Error("SYLK shared formula cannot have own formula");var U=ie>-1&&T[ie][Z];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");T[x][g][1]=GS(U[1],{r:x-ie,c:g-Z})}break;case"F":var O=0;for(k=1;k<P.length;++k)switch(P[k].charAt(0)){case"X":g=parseInt(P[k].slice(1))-1,++O;break;case"Y":for(x=parseInt(P[k].slice(1))-1,j=T.length;j<=x;++j)T[j]=[];break;case"M":S=parseInt(P[k].slice(1))/20;break;case"F":break;case"G":break;case"P":w=m[parseInt(P[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=P[k].slice(1).split(" "),j=parseInt(A[0],10);j<=parseInt(A[1],10);++j)S=parseInt(A[2],10),_[j-1]=S===0?{hidden:!0}:{wch:S},ud(_[j-1]);break;case"C":g=parseInt(P[k].slice(1))-1,_[g]||(_[g]={});break;case"R":x=parseInt(P[k].slice(1))-1,b[x]||(b[x]={}),S>0?(b[x].hpt=S,b[x].hpx=ep(S)):S===0&&(b[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}O<1&&(w=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return b.length>0&&(E["!rows"]=b),_.length>0&&(E["!cols"]=_),p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),[T,E]}function o(h,p){var y=s(h,p),x=y[0],g=y[1],v=Ui(x,p);return er(g).forEach(function(k){v[k]=g[k]}),v}function l(h,p){return ii(o(h,p),p)}function d(h,p,y,x){var g="C;Y"+(y+1)+";X"+(x+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+fd(h.f,{r:y,c:x}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,p){p.forEach(function(y,x){var g="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?g+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=oo(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=lo(y.wpx)),typeof y.wch=="number"&&(g+=Math.round(y.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,p){p.forEach(function(y,x){var g="F;";y.hidden?g+="M0;":y.hpt?g+="M"+20*y.hpt+";":y.hpx&&(g+="M"+20*co(y.hpx)+";"),g.length>2&&h.push(g+"R"+(x+1))})}function f(h,p){var y=["ID;PWXL;N;E"],x=[],g=mt(h["!ref"]),v,k=Array.isArray(h),T=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),h["!cols"]&&c(y,h["!cols"]),h["!rows"]&&u(y,h["!rows"]),y.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var m=g.s.r;m<=g.e.r;++m)for(var w=g.s.c;w<=g.e.c;++w){var E=ot({r:m,c:w});v=k?(h[m]||[])[w]:h[E],!(!v||v.v==null&&(!v.f||v.F))&&x.push(d(v,h,m,w))}return y.join(T)+T+x.join(T)+T+"E"+T}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),Xw=function(){function e(a,o){switch(o.type){case"base64":return t(_n(a),o);case"binary":return t(a,o);case"buffer":return t(tt&&Buffer.isBuffer(a)?a.toString("binary"):Bs(a),o);case"array":return t($o(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),d=-1,c=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++d]=[],c=0;continue}if(!(d<0)){var h=l[u].trim().split(","),p=h[0],y=h[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+p){case-1:if(x==="BOT"){f[++d]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[d][c]=!0:x==="FALSE"?f[d][c]=!1:isNaN(Sn(y))?isNaN(_s(y).getDate())?f[d][c]=y:f[d][c]=mr(y):f[d][c]=Sn(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[d][c++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return Ui(e(a,o),o)}function i(a,o){return ii(r(a,o),o)}var s=function(){var a=function(d,c,u,f,h){d.push(c),d.push(u+","+f),d.push('"'+h.replace(/"/g,'""')+'"')},o=function(d,c,u,f){d.push(c+","+u),d.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(d){var c=[],u=mt(d["!ref"]),f,h=Array.isArray(d);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){o(c,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var x=ot({r:p,c:y});if(f=h?(d[p]||[])[y]:d[x],!f){o(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(c,1,0,"="+f.f):o(c,1,0,""):o(c,0,g,"V");break;case"b":o(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Mn(f.z||It[14],Sr(mr(f.v)))),o(c,0,f.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,k=c.join(v);return k}}();return{to_workbook:i,to_sheet:r,from_sheet:s}}(),Kf=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),y=-1,x=-1,g=0,v=[];g!==p.length;++g){var k=p[g].trim().split(":");if(k[0]==="cell"){var T=Vt(k[1]);if(v.length<=T.r)for(y=v.length;y<=T.r;++y)v[y]||(v[y]=[]);switch(y=T.r,x=T.c,k[2]){case"t":v[y][x]=e(k[3]);break;case"v":v[y][x]=+k[3];break;case"vtf":var m=k[k.length-1];case"vtc":switch(k[3]){case"nl":v[y][x]=!!+k[4];break;default:v[y][x]=+k[4];break}k[2]=="vtf"&&(v[y][x]=[v[y][x],m])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function i(f,h){return Ui(r(f,h),h)}function s(f,h){return ii(i(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],y,x="",g=Rr(f["!ref"]),v=Array.isArray(f),k=g.s.r;k<=g.e.r;++k)for(var T=g.s.c;T<=g.e.c;++T)if(x=ot({r:k,c:T}),y=v?(f[k]||[])[T]:f[x],!(!y||y.v==null||y.t==="z")){switch(p=["cell",x,"t"],y.t){case"s":case"str":p.push(t(y.v));break;case"n":y.f?(p[2]="vtf",p[3]="n",p[4]=y.v,p[5]=t(y.f)):(p[2]="v",p[3]=y.v);break;case"b":p[2]="vt"+(y.f?"f":"c"),p[3]="nl",p[4]=y.v?"1":"0",p[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var m=Sr(mr(y.v));p[2]="vtc",p[3]="nd",p[4]=""+m,p[5]=y.w||Mn(y.z||It[14],m);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[a,o,l,o,c(f),d].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:u}}(),Kw=function(){function e(u,f,h,p,y){y.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(Sn(u))?isNaN(_s(u).getDate())?f[h][p]=u:f[h][p]=mr(u):f[h][p]=Sn(u))}function t(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var y=u.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var g=10,v=0,k=0;k<=x;++k)v=y[k].indexOf(" "),v==-1?v=y[k].length:v++,g=Math.max(g,v);for(k=0;k<=x;++k){p[k]=[];var T=0;for(e(y[k].slice(0,g).trim(),p,k,T,h),T=1;T<=(y[k].length-g)/10+1;++T)e(y[k].slice(g+(T-1)*10,g+T*10).trim(),p,k,T,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,y=0;p<u.length;++p)(y=u.charCodeAt(p))==34?h=!h:!h&&y in r&&(f[y]=(f[y]||0)+1);y=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&y.push([f[p],p]);if(!y.length){f=i;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&y.push([f[p],p])}return y.sort(function(x,g){return x[0]-g[0]||i[x[1]]-i[g[1]]}),r[y.pop()[1]]||44}function a(u,f){var h=f||{},p="",y=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var g=0,v=0,k=0,T=0,m=0,w=p.charCodeAt(0),E=!1,b=0,_=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?h2(h.dateNF):null;function S(){var j=u.slice(T,m),C={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)C.t="z";else if(h.raw)C.t="s",C.v=j;else if(j.trim().length===0)C.t="s",C.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(C.t="s",C.v=j.slice(2,-1).replace(/""/g,'"')):YS(j)?(C.t="n",C.f=j.slice(1)):(C.t="s",C.v=j);else if(j=="TRUE")C.t="b",C.v=!0;else if(j=="FALSE")C.t="b",C.v=!1;else if(!isNaN(k=Sn(j)))C.t="n",h.cellText!==!1&&(C.w=j),C.v=k;else if(!isNaN(_s(j).getDate())||A&&j.match(A)){C.z=h.dateNF||It[14];var P=0;A&&j.match(A)&&(j=f2(j,h.dateNF,j.match(A)||[]),P=1),h.cellDates?(C.t="d",C.v=mr(j,P)):(C.t="n",C.v=Sr(mr(j,P))),h.cellText!==!1&&(C.w=Mn(C.z,C.v instanceof Date?Sr(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=j;if(C.t=="z"||(h.dense?(y[g]||(y[g]=[]),y[g][v]=C):y[ot({c:v,r:g})]=C),T=m+1,_=u.charCodeAt(T),x.e.c<v&&(x.e.c=v),x.e.r<g&&(x.e.r=g),b==w)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;m<u.length;++m)switch(b=u.charCodeAt(m)){case 34:_===34&&(E=!E);break;case w:case 10:case 13:if(!E&&S())break e;break}return m-T>0&&S(),y["!ref"]=Lt(x),y}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,f):Ui(t(u,f),f)}function l(u,f){var h="",p=f.type=="string"?[0,0,0,0]:l4(u,f);switch(f.type){case"base64":h=_n(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):(f.codepage,h=tt&&Buffer.isBuffer(u)?u.toString("binary"):Bs(u));break;case"array":h=$o(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=cs(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=cs(h):f.type=="binary",h.slice(0,19)=="socialcalc:version:"?Kf.to_sheet(f.type=="string"?h:cs(h),f):o(h,f)}function d(u,f){return ii(l(u,f),f)}function c(u){for(var f=[],h=mt(u["!ref"]),p,y=Array.isArray(u),x=h.s.r;x<=h.e.r;++x){for(var g=[],v=h.s.c;v<=h.e.c;++v){var k=ot({r:x,c:v});if(p=y?(u[x]||[])[v]:u[k],!p||p.v==null){g.push("          ");continue}for(var T=(p.w||(Tn(p),p.w)||"").slice(0,10);T.length<10;)T+=" ";g.push(T+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}}(),sh=function(){function e(R,U,O){if(R){Tr(R,R.l||0);for(var I=O.Enum||ie;R.l<R.length;){var W=R.read_shift(2),J=I[W]||I[65535],he=R.read_shift(2),ye=R.l+he,H=J.f&&J.f(R,he,O);if(R.l=ye,U(H,J,W))return}}}function t(R,U){switch(U.type){case"base64":return r(Hr(_n(R)),U);case"binary":return r(Hr(R),U);case"buffer":case"array":return r(R,U)}throw"Unsupported type "+U.type}function r(R,U){if(!R)return R;var O=U||{},I=O.dense?[]:{},W="Sheet1",J="",he=0,ye={},H=[],Y=[],le={s:{r:0,c:0},e:{r:0,c:0}},de=O.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)O.Enum=ie,e(R,function(me,Te,ue){switch(ue){case 0:O.vers=me,me>=4096&&(O.qpro=!0);break;case 6:le=me;break;case 204:me&&(J=me);break;case 222:J=me;break;case 15:case 51:O.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:ue==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=O.dateNF||It[14],O.cellDates&&(me[1].t="d",me[1].v=ff(me[1].v))),O.qpro&&me[3]>he&&(I["!ref"]=Lt(le),ye[W]=I,H.push(W),I=O.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},he=me[3],W=J||"Sheet"+(he+1),J="");var Me=O.dense?(I[me[0].r]||[])[me[0].c]:I[ot(me[0])];if(Me){Me.t=me[1].t,Me.v=me[1].v,me[1].z!=null&&(Me.z=me[1].z),me[1].f!=null&&(Me.f=me[1].f);break}O.dense?(I[me[0].r]||(I[me[0].r]=[]),I[me[0].r][me[0].c]=me[1]):I[ot(me[0])]=me[1];break}},O);else if(R[2]==26||R[2]==14)O.Enum=Z,R[2]==14&&(O.qpro=!0,R.l=0),e(R,function(me,Te,ue){switch(ue){case 204:W=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>he&&(I["!ref"]=Lt(le),ye[W]=I,H.push(W),I=O.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},he=me[3],W="Sheet"+(he+1)),de>0&&me[0].r>=de)break;O.dense?(I[me[0].r]||(I[me[0].r]=[]),I[me[0].r][me[0].c]=me[1]):I[ot(me[0])]=me[1],le.e.c<me[0].c&&(le.e.c=me[0].c),le.e.r<me[0].r&&(le.e.r=me[0].r);break;case 27:me[14e3]&&(Y[me[14e3][0]]=me[14e3][1]);break;case 1537:Y[me[0]]=me[1],me[0]==he&&(W=me[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(I["!ref"]=Lt(le),ye[J||W]=I,H.push(J||W),!Y.length)return{SheetNames:H,Sheets:ye};for(var G={},xe=[],ge=0;ge<Y.length;++ge)ye[H[ge]]?(xe.push(Y[ge]||H[ge]),G[Y[ge]]=ye[Y[ge]]||ye[H[ge]]):(xe.push(Y[ge]),G[Y[ge]]={"!ref":"A1"});return{SheetNames:xe,Sheets:G}}function i(R,U){var O=U||{};if(+O.codepage>=0&&js(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var I=vr(),W=mt(R["!ref"]),J=Array.isArray(R),he=[];_e(I,0,a(1030)),_e(I,6,d(W));for(var ye=Math.min(W.e.r,8191),H=W.s.r;H<=ye;++H)for(var Y=Zt(H),le=W.s.c;le<=W.e.c;++le){H===W.s.r&&(he[le]=dr(le));var de=he[le]+Y,G=J?(R[H]||[])[le]:R[de];if(!(!G||G.t=="z"))if(G.t=="n")(G.v|0)==G.v&&G.v>=-32768&&G.v<=32767?_e(I,13,p(H,le,G.v)):_e(I,14,x(H,le,G.v));else{var xe=Tn(G);_e(I,15,f(H,le,xe.slice(0,239)))}}return _e(I,1),I.end()}function s(R,U){var O=U||{};if(+O.codepage>=0&&js(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var I=vr();_e(I,0,o(R));for(var W=0,J=0;W<R.SheetNames.length;++W)(R.Sheets[R.SheetNames[W]]||{})["!ref"]&&_e(I,27,Q(R.SheetNames[W],J++));var he=0;for(W=0;W<R.SheetNames.length;++W){var ye=R.Sheets[R.SheetNames[W]];if(!(!ye||!ye["!ref"])){for(var H=mt(ye["!ref"]),Y=Array.isArray(ye),le=[],de=Math.min(H.e.r,8191),G=H.s.r;G<=de;++G)for(var xe=Zt(G),ge=H.s.c;ge<=H.e.c;++ge){G===H.s.r&&(le[ge]=dr(ge));var me=le[ge]+xe,Te=Y?(ye[G]||[])[ge]:ye[me];if(!(!Te||Te.t=="z"))if(Te.t=="n")_e(I,23,S(G,ge,he,Te.v));else{var ue=Tn(Te);_e(I,22,b(G,ge,he,ue.slice(0,239)))}}++he}}return _e(I,1),I.end()}function a(R){var U=ce(2);return U.write_shift(2,R),U}function o(R){var U=ce(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var O=0,I=0,W=0,J=0;J<R.SheetNames.length;++J){var he=R.SheetNames[J],ye=R.Sheets[he];if(!(!ye||!ye["!ref"])){++W;var H=Rr(ye["!ref"]);O<H.e.r&&(O=H.e.r),I<H.e.c&&(I=H.e.c)}}return O>8191&&(O=8191),U.write_shift(2,O),U.write_shift(1,W),U.write_shift(1,I),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(R,U,O){var I={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&O.qpro?(I.s.c=R.read_shift(1),R.l++,I.s.r=R.read_shift(2),I.e.c=R.read_shift(1),R.l++,I.e.r=R.read_shift(2),I):(I.s.c=R.read_shift(2),I.s.r=R.read_shift(2),U==12&&O.qpro&&(R.l+=2),I.e.c=R.read_shift(2),I.e.r=R.read_shift(2),U==12&&O.qpro&&(R.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function d(R){var U=ce(8);return U.write_shift(2,R.s.c),U.write_shift(2,R.s.r),U.write_shift(2,R.e.c),U.write_shift(2,R.e.r),U}function c(R,U,O){var I=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(I[0].c=R.read_shift(1),I[3]=R.read_shift(1),I[0].r=R.read_shift(2),R.l+=2):(I[2]=R.read_shift(1),I[0].c=R.read_shift(2),I[0].r=R.read_shift(2)),I}function u(R,U,O){var I=R.l+U,W=c(R,U,O);if(W[1].t="s",O.vers==20768){R.l++;var J=R.read_shift(1);return W[1].v=R.read_shift(J,"utf8"),W}return O.qpro&&R.l++,W[1].v=R.read_shift(I-R.l,"cstr"),W}function f(R,U,O){var I=ce(7+O.length);I.write_shift(1,255),I.write_shift(2,U),I.write_shift(2,R),I.write_shift(1,39);for(var W=0;W<I.length;++W){var J=O.charCodeAt(W);I.write_shift(1,J>=128?95:J)}return I.write_shift(1,0),I}function h(R,U,O){var I=c(R,U,O);return I[1].v=R.read_shift(2,"i"),I}function p(R,U,O){var I=ce(7);return I.write_shift(1,255),I.write_shift(2,U),I.write_shift(2,R),I.write_shift(2,O,"i"),I}function y(R,U,O){var I=c(R,U,O);return I[1].v=R.read_shift(8,"f"),I}function x(R,U,O){var I=ce(13);return I.write_shift(1,255),I.write_shift(2,U),I.write_shift(2,R),I.write_shift(8,O,"f"),I}function g(R,U,O){var I=R.l+U,W=c(R,U,O);if(W[1].v=R.read_shift(8,"f"),O.qpro)R.l=I;else{var J=R.read_shift(2);m(R.slice(R.l,R.l+J),W),R.l+=J}return W}function v(R,U,O){var I=U&32768;return U&=-32769,U=(I?R:0)+(U>=8192?U-16384:U),(I?"":"$")+(O?dr(U):Zt(U))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function m(R,U){Tr(R,0);for(var O=[],I=0,W="",J="",he="",ye="";R.l<R.length;){var H=R[R.l++];switch(H){case 0:O.push(R.read_shift(8,"f"));break;case 1:J=v(U[0].c,R.read_shift(2),!0),W=v(U[0].r,R.read_shift(2),!1),O.push(J+W);break;case 2:{var Y=v(U[0].c,R.read_shift(2),!0),le=v(U[0].r,R.read_shift(2),!1);J=v(U[0].c,R.read_shift(2),!0),W=v(U[0].r,R.read_shift(2),!1),O.push(Y+le+":"+J+W)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(R.read_shift(2));break;case 6:{for(var de="";H=R[R.l++];)de+=String.fromCharCode(H);O.push('"'+de.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ye=O.pop(),he=O.pop(),O.push(["AND","OR"][H-20]+"("+he+","+ye+")");break;default:if(H<32&&T[H])ye=O.pop(),he=O.pop(),O.push(he+T[H]+ye);else if(k[H]){if(I=k[H][1],I==69&&(I=R[R.l++]),I>O.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+O.join("|")+"|");return}var G=O.slice(-I);O.length-=I,O.push(k[H][0]+"("+G.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}O.length==1?U[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function w(R){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=R.read_shift(2),U[3]=R[R.l++],U[0].c=R[R.l++],U}function E(R,U){var O=w(R);return O[1].t="s",O[1].v=R.read_shift(U-4,"cstr"),O}function b(R,U,O,I){var W=ce(6+I.length);W.write_shift(2,R),W.write_shift(1,O),W.write_shift(1,U),W.write_shift(1,39);for(var J=0;J<I.length;++J){var he=I.charCodeAt(J);W.write_shift(1,he>=128?95:he)}return W.write_shift(1,0),W}function _(R,U){var O=w(R);O[1].v=R.read_shift(2);var I=O[1].v>>1;if(O[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return O[1].v=I,O}function A(R,U){var O=w(R),I=R.read_shift(4),W=R.read_shift(4),J=R.read_shift(2);if(J==65535)return I===0&&W===3221225472?(O[1].t="e",O[1].v=15):I===0&&W===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var he=J&32768;return J=(J&32767)-16446,O[1].v=(1-he*2)*(W*Math.pow(2,J+32)+I*Math.pow(2,J)),O}function S(R,U,O,I){var W=ce(14);if(W.write_shift(2,R),W.write_shift(1,O),W.write_shift(1,U),I==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var J=0,he=0,ye=0,H=0;return I<0&&(J=1,I=-I),he=Math.log2(I)|0,I/=Math.pow(2,he-31),H=I>>>0,H&2147483648||(I/=2,++he,H=I>>>0),I-=H,H|=2147483648,H>>>=0,I*=Math.pow(2,32),ye=I>>>0,W.write_shift(4,ye),W.write_shift(4,H),he+=16383+(J?32768:0),W.write_shift(2,he),W}function j(R,U){var O=A(R);return R.l+=U-14,O}function C(R,U){var O=w(R),I=R.read_shift(4);return O[1].v=I>>6,O}function P(R,U){var O=w(R),I=R.read_shift(8,"f");return O[1].v=I,O}function M(R,U){var O=P(R);return R.l+=U-10,O}function X(R,U){return R[R.l+U-1]==0?R.read_shift(U,"cstr"):""}function ee(R,U){var O=R[R.l++];O>U-1&&(O=U-1);for(var I="";I.length<O;)I+=String.fromCharCode(R[R.l++]);return I}function q(R,U,O){if(!(!O.qpro||U<21)){var I=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var W=R.read_shift(U-21,"cstr");return[I,W]}}function K(R,U){for(var O={},I=R.l+U;R.l<I;){var W=R.read_shift(2);if(W==14e3){for(O[W]=[0,""],O[W][0]=R.read_shift(2);R[R.l];)O[W][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return O}function Q(R,U){var O=ce(5+R.length);O.write_shift(2,14e3),O.write_shift(2,U);for(var I=0;I<R.length;++I){var W=R.charCodeAt(I);O[O.l++]=W>127?95:W}return O[O.l++]=0,O}var ie={0:{n:"BOF",f:Vf},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:t}}(),Qw=/^\s|\s$|[\t\n\r]/;function Qf(e,t){if(!t.bookSST)return"";var r=[Mt];r[r.length]=Ee("sst",null,{xmlns:$i[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(e[i]!=null){var s=e[i],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Qw)&&(a+=' xml:space="preserve"'),a+=">"+at(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Jw(e){return[e.read_shift(4),e.read_shift(4)]}function Zw(e,t){return t||(t=ce(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var eS=q2;function tS(e){var t=vr();ve(t,159,Zw(e));for(var r=0;r<e.length;++r)ve(t,19,eS(e[r]));return ve(t,160),t.end()}function rS(e){for(var t=[],r=e.split(""),i=0;i<r.length;++i)t[i]=r[i].charCodeAt(0);return t}function Jf(e){var t=0,r,i=rS(e),s=i.length+1,a,o,l,d,c;for(r=ei(s),r[0]=i.length,a=1;a!=s;++a)r[a]=i[a-1];for(a=s-1;a>=0;--a)o=r[a],l=t&16384?1:0,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var nS=function(){function e(s,a){switch(a.type){case"base64":return t(_n(s),a);case"binary":return t(s,a);case"buffer":return t(tt&&Buffer.isBuffer(s)?s.toString("binary"):Bs(s),a);case"array":return t($o(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},l=o.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,y,x=-1;y=h.exec(u);){switch(y[0]){case"\\cell":var g=u.slice(p,h.lastIndex-y[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[f][x]=v:l[ot({r:f,c:x})]=v}break}p=h.lastIndex}x>c.e.c&&(c.e.c=x)}),l["!ref"]=Lt(c),l}function r(s,a){return ii(e(s,a),a)}function i(s){for(var a=["{\\rtf1\\ansi"],o=mt(s["!ref"]),l,d=Array.isArray(s),c=o.s.r;c<=o.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=ot({r:c,c:u});l=d?(s[c]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Tn(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:i}}();function ah(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var iS=6,jn=iS;function oo(e){return Math.floor((e+Math.round(128/jn)/256)*jn)}function lo(e){return Math.floor((e-5)/jn*100+.5)/100}function yc(e){return Math.round((e*jn+5)/jn*256)/256}function ud(e){e.width?(e.wpx=oo(e.width),e.wch=lo(e.wpx),e.MDW=jn):e.wpx?(e.wch=lo(e.wpx),e.width=yc(e.wch),e.MDW=jn):typeof e.wch=="number"&&(e.width=yc(e.wch),e.wpx=oo(e.width),e.MDW=jn),e.customWidth&&delete e.customWidth}var sS=96,Zf=sS;function co(e){return e*96/Zf}function ep(e){return e*Zf/96}function aS(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&(t[t.length]=Ee("numFmt",null,{numFmtId:i,formatCode:at(e[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ee("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function oS(e){var t=[];return t[t.length]=Ee("cellXfs",null),e.forEach(function(r){t[t.length]=Ee("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ee("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function tp(e,t){var r=[Mt,Ee("styleSheet",null,{xmlns:$i[0],"xmlns:vt":qt.vt})],i;return e.SSF&&(i=aS(e.SSF))!=null&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=oS(t.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function lS(e,t){var r=e.read_shift(2),i=ur(e);return[r,i]}function cS(e,t,r){r||(r=ce(6+4*t.length)),r.write_shift(2,e),Ht(t,r);var i=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),i}function dS(e,t,r){var i={};i.sz=e.read_shift(2)/20;var s=Q2(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var a=e.read_shift(2);switch(a===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(i.underline=o);var l=e.read_shift(1);l>0&&(i.family=l);var d=e.read_shift(1);switch(d>0&&(i.charset=d),e.l++,i.color=K2(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=ur(e),i}function uS(e,t){t||(t=ce(25+4*32)),t.write_shift(2,e.sz*20),J2(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),so(e.color,t);var i=0;return i=2,t.write_shift(1,i),Ht(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hS=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Pl,fS=hn;function oh(e,t){t||(t=ce(4*3+8*7+16*1)),Pl||(Pl=Zc(hS));var r=Pl[e.patternType];r==null&&(r=40),t.write_shift(4,r);var i=0;if(r!=40)for(so({auto:1},t),so({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function pS(e,t){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:i,numFmtId:s}}function rp(e,t,r){r||(r=ce(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var i=0;return r.write_shift(1,i),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function rs(e,t){return t||(t=ce(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var xS=hn;function mS(e,t){return t||(t=ce(51)),t.write_shift(1,0),rs(null,t),rs(null,t),rs(null,t),rs(null,t),rs(null,t),t.length>t.l?t.slice(0,t.l):t}function gS(e,t){return t||(t=ce(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),io(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function yS(e,t,r){var i=ce(2052);return i.write_shift(4,e),io(t,i),io(r,i),i.length>i.l?i.slice(0,i.l):i}function vS(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&++r}),r!=0&&(ve(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&ve(e,44,cS(s,t[s]))}),ve(e,616))}}function bS(e){var t=1;ve(e,611,Xr(t)),ve(e,43,uS({sz:12,color:{theme:1},name:"Calibri",family:2})),ve(e,612)}function wS(e){var t=2;ve(e,603,Xr(t)),ve(e,45,oh({patternType:"none"})),ve(e,45,oh({patternType:"gray125"})),ve(e,604)}function SS(e){var t=1;ve(e,613,Xr(t)),ve(e,46,mS()),ve(e,614)}function jS(e){var t=1;ve(e,626,Xr(t)),ve(e,47,rp({numFmtId:0},65535)),ve(e,627)}function ES(e,t){ve(e,617,Xr(t.length)),t.forEach(function(r){ve(e,47,rp(r,0))}),ve(e,618)}function _S(e){var t=1;ve(e,619,Xr(t)),ve(e,48,gS({xfId:0,name:"Normal"})),ve(e,620)}function TS(e){var t=0;ve(e,505,Xr(t)),ve(e,506)}function AS(e){var t=0;ve(e,508,yS(t,"TableStyleMedium9","PivotStyleMedium4")),ve(e,509)}function kS(e,t){var r=vr();return ve(r,278),vS(r,e.SSF),bS(r),wS(r),SS(r),jS(r),ES(r,t.cellXfs),_S(r),TS(r),AS(r),ve(r,279),r.end()}function np(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Mt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function CS(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ur(e)}}function IS(e){var t=ce(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ht(e.name,t),t.slice(0,t.l)}function NS(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function FS(e){var t=ce(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function RS(e,t){var r=ce(8+2*t.length);return r.write_shift(4,e),Ht(t,r),r.slice(0,r.l)}function PS(e){return e.l+=4,e.read_shift(4)!=0}function DS(e,t){var r=ce(8);return r.write_shift(4,e),r.write_shift(4,1),r}function OS(){var e=vr();return ve(e,332),ve(e,334,Xr(1)),ve(e,335,IS({name:"XLDAPR",version:12e4,flags:3496657072})),ve(e,336),ve(e,339,RS(1,"XLDAPR")),ve(e,52),ve(e,35,Xr(514)),ve(e,4096,Xr(0)),ve(e,4097,Or(1)),ve(e,36),ve(e,53),ve(e,340),ve(e,337,DS(1)),ve(e,51,FS([[1,0]])),ve(e,338),ve(e,333),e.end()}function ip(){var e=[Mt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function LS(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ot(r);var i=e.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var ji=1024;function sp(e,t){for(var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ee("xml",null,{"xmlns:v":Ar.v,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:mv":Ar.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:i})];ji<e*1e3;)ji+=1e3;return t.forEach(function(a){var o=Vt(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ee("v:fill",d,l),u={on:"t",obscured:"t"};++ji,s=s.concat(["<v:shape"+As({id:"_x0000_s"+ji,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ee("v:shadow",null,u),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Jt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Jt("x:AutoFill","False"),Jt("x:Row",String(o.r)),Jt("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function ap(e){var t=[Mt,Ee("comments",null,{xmlns:$i[0]})],r=[];return t.push("<authors>"),e.forEach(function(i){i[1].forEach(function(s){var a=at(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(i){var s=0,a=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=r.indexOf("tc="+i[1][0].ID):i[1].forEach(function(d){d.a&&(s=r.indexOf(at(d.a))),a.push(d.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Jt("t",at(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(Jt("t",at(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function MS(e,t,r){var i=[Mt,Ee("ThreadedComments",null,{xmlns:qt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=d.id:d.parentId=a,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),i.push(Ee("threadedComment",Jt("text",o.t||""),d))})}),i.push("</ThreadedComments>"),i.join("")}function BS(e){var t=[Mt,Ee("personList",null,{xmlns:qt.TCMNT,"xmlns:x":$i[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,i){t.push(Ee("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $S(e){var t={};t.iauthor=e.read_shift(4);var r=li(e);return t.rfx=r.s,t.ref=ot(r.s),e.l+=16,t}function US(e,t){return t==null&&(t=ce(36)),t.write_shift(4,e[1].iauthor),zi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zS=ur;function WS(e){return Ht(e.slice(0,54))}function qS(e){var t=vr(),r=[];return ve(t,628),ve(t,630),e.forEach(function(i){i[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ve(t,632,WS(s.a)))})}),ve(t,631),ve(t,633),e.forEach(function(i){i[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Vt(i[0]),e:Vt(i[0])};ve(t,635,US([a,s])),s.t&&s.t.length>0&&ve(t,637,H2(s)),ve(t,636),delete s.iauthor})}),ve(t,634),ve(t,629),t.end()}function VS(e,t){t.FullPaths.forEach(function(r,i){if(i!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&dt.utils.cfb_add(e,s,t.FileIndex[i].content)}})}var op=["xlsb","xlsm","xlam","biff8","xla"],HS=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(i,s,a,o){var l=!1,d=!1;a.length==0?d=!0:a.charAt(0)=="["&&(d=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,d?c+=t.r:--c,s+(l?"":"$")+dr(u)+(d?"":"$")+Zt(c)}return function(s,a){return t=a,s.replace(e,r)}}(),hd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fd=function(){return function(t,r){return t.replace(hd,function(i,s,a,o,l,d){var c=ad(o)-(a?0:r.c),u=sd(d)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=c==0?"":a?c+1:"["+c+"]";return s+"R"+f+"C"+h})}}();function GS(e,t){return e.replace(hd,function(r,i,s,a,o,l){return i+(s=="$"?s+a:dr(ad(a)+t.c))+(o=="$"?o+l:Zt(sd(l)+t.r))})}function YS(e){return e.length!=1}function Ft(e){e.l+=1}function Bn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function lp(e,t,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return cp(e);r.biff==12&&(i=4)}var s=e.read_shift(i),a=e.read_shift(i),o=Bn(e),l=Bn(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function cp(e){var t=Bn(e),r=Bn(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function XS(e,t,r){if(r.biff<8)return cp(e);var i=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Bn(e),o=Bn(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function dp(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return KS(e);var i=e.read_shift(r&&r.biff==12?4:2),s=Bn(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function KS(e){var t=Bn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function QS(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JS(e,t,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return ZS(e);var s=e.read_shift(i>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function ZS(e){var t=e.read_shift(2),r=e.read_shift(1),i=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:i}}function ej(e,t,r){var i=(e[e.l++]&96)>>5,s=lp(e,r.biff>=2&&r.biff<=5?6:8,r);return[i,s]}function tj(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=lp(e,a,r);return[i,s,o]}function rj(e,t,r){var i=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}function nj(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[i,s]}function ij(e,t,r){var i=(e[e.l++]&96)>>5,s=XS(e,t-1,r);return[i,s]}function sj(e,t,r){var i=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[i]}function lh(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function aj(e,t,r){e.l+=2;for(var i=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=i;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function oj(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(r&&r.biff==2?1:2)]}function lj(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(r&&r.biff==2?1:2)]}function cj(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dj(e,t,r){var i=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[i]}function up(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function uj(e){return e.read_shift(2),up(e)}function hj(e){return e.read_shift(2),up(e)}function fj(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=dp(e,0,r);return[i,s]}function pj(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=JS(e,0,r);return[i,s]}function xj(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=dp(e,0,r);return[i,s,a]}function mj(e,t,r){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[mE[s],pp[s],i]}function gj(e,t,r){var i=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[i==88?-1:0,e.read_shift(1)]:yj(e);return[s,(a[0]===0?pp:xE)[a[1]]]}function yj(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vj(e,t,r){e.l+=r&&r.biff==2?3:4}function bj(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function wj(e){return e.l++,zs[e.read_shift(1)]}function Sj(e){return e.l++,e.read_shift(2)}function jj(e){return e.l++,e.read_shift(1)!==0}function Ej(e){return e.l++,Wi(e)}function _j(e,t,r){return e.l++,Gf(e,t-1,r)}function Tj(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xw(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wi(e);break;case 2:r[1]=vw(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Aj(e,t,r){for(var i=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=i;++a)s.push((r.biff==12?li:Sw)(e));return s}function kj(e,t,r){var i=0,s=0;r.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,--s==0&&(s=256));for(var a=0,o=[];a!=i&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=Tj(e,r.biff);return o}function Cj(e,t,r){var i=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,a]}function Ij(e,t,r){if(r.biff==5)return Nj(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[i,s,a]}function Nj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[t,r,i]}function Fj(e,t,r){var i=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function Rj(e,t,r){var i=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[i,s]}function Pj(e,t,r){var i=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[i]}function Dj(e,t,r){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[i,s]}var Oj=hn,Lj=hn,Mj=hn;function Ws(e,t,r){return e.l+=2,[QS(e)]}function pd(e){return e.l+=6,[]}var Bj=Ws,$j=pd,Uj=pd,zj=Ws;function hp(e){return e.l+=2,[Vf(e),e.read_shift(2)&1]}var Wj=Ws,qj=hp,Vj=pd,Hj=Ws,Gj=Ws,Yj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Xj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=Yj[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:i,c:s,C:a}}function Kj(e){return e.l+=2,[e.read_shift(4)]}function Qj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Jj(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Zj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function eE(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function tE(e){return e.l+=4,[0,0]}var ch={1:{n:"PtgExp",f:bj},2:{n:"PtgTbl",f:Mj},3:{n:"PtgAdd",f:Ft},4:{n:"PtgSub",f:Ft},5:{n:"PtgMul",f:Ft},6:{n:"PtgDiv",f:Ft},7:{n:"PtgPower",f:Ft},8:{n:"PtgConcat",f:Ft},9:{n:"PtgLt",f:Ft},10:{n:"PtgLe",f:Ft},11:{n:"PtgEq",f:Ft},12:{n:"PtgGe",f:Ft},13:{n:"PtgGt",f:Ft},14:{n:"PtgNe",f:Ft},15:{n:"PtgIsect",f:Ft},16:{n:"PtgUnion",f:Ft},17:{n:"PtgRange",f:Ft},18:{n:"PtgUplus",f:Ft},19:{n:"PtgUminus",f:Ft},20:{n:"PtgPercent",f:Ft},21:{n:"PtgParen",f:Ft},22:{n:"PtgMissArg",f:Ft},23:{n:"PtgStr",f:_j},26:{n:"PtgSheet",f:Qj},27:{n:"PtgEndSheet",f:Jj},28:{n:"PtgErr",f:wj},29:{n:"PtgBool",f:jj},30:{n:"PtgInt",f:Sj},31:{n:"PtgNum",f:Ej},32:{n:"PtgArray",f:sj},33:{n:"PtgFunc",f:mj},34:{n:"PtgFuncVar",f:gj},35:{n:"PtgName",f:Cj},36:{n:"PtgRef",f:fj},37:{n:"PtgArea",f:ej},38:{n:"PtgMemArea",f:Fj},39:{n:"PtgMemErr",f:Oj},40:{n:"PtgMemNoMem",f:Lj},41:{n:"PtgMemFunc",f:Rj},42:{n:"PtgRefErr",f:Pj},43:{n:"PtgAreaErr",f:rj},44:{n:"PtgRefN",f:pj},45:{n:"PtgAreaN",f:ij},46:{n:"PtgMemAreaN",f:Zj},47:{n:"PtgMemNoMemN",f:eE},57:{n:"PtgNameX",f:Ij},58:{n:"PtgRef3d",f:xj},59:{n:"PtgArea3d",f:tj},60:{n:"PtgRefErr3d",f:Dj},61:{n:"PtgAreaErr3d",f:nj},255:{}},rE={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},nE={1:{n:"PtgElfLel",f:hp},2:{n:"PtgElfRw",f:Hj},3:{n:"PtgElfCol",f:Bj},6:{n:"PtgElfRwV",f:Gj},7:{n:"PtgElfColV",f:zj},10:{n:"PtgElfRadical",f:Wj},11:{n:"PtgElfRadicalS",f:Vj},13:{n:"PtgElfColS",f:$j},15:{n:"PtgElfColSV",f:Uj},16:{n:"PtgElfRadicalLel",f:qj},25:{n:"PtgList",f:Xj},29:{n:"PtgSxName",f:Kj},255:{}},iE={0:{n:"PtgAttrNoop",f:tE},1:{n:"PtgAttrSemi",f:dj},2:{n:"PtgAttrIf",f:lj},4:{n:"PtgAttrChoose",f:aj},8:{n:"PtgAttrGoto",f:oj},16:{n:"PtgAttrSum",f:vj},32:{n:"PtgAttrBaxcel",f:lh},33:{n:"PtgAttrBaxcel",f:lh},64:{n:"PtgAttrSpace",f:uj},65:{n:"PtgAttrSpaceSemi",f:hj},128:{n:"PtgAttrIfError",f:cj},255:{}};function sE(e,t,r,i){if(i.biff<8)return hn(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=kj(e,0,i),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Aj(e,r[o][1],i),a.push(r[o][2]);break;case"PtgExp":i&&i.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(hn(e,t)),a}function aE(e,t,r){for(var i=e.l+t,s,a,o=[];i!=e.l;)t=i-e.l,a=e[e.l],s=ch[a]||ch[rE[a]],(a===24||a===25)&&(s=(a===24?nE:iE)[e[e.l+1]]),!s||!s.f?hn(e,t):o.push([s.n,s.f(e,t,r)]);return o}function oE(e){for(var t=[],r=0;r<e.length;++r){for(var i=e[r],s=[],a=0;a<i.length;++a){var o=i[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var lE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cE(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function fp(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!i)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[i[0]][0];case 355:default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function dh(e,t,r){var i=fp(e,t,r);return i=="#REF"?i:cE(i,r)}function Oi(e,t,r,i,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],d,c,u,f=0,h=0,p,y="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",v=0,k=e[0].length;v<k;++v){var T=e[0][v];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=kt(" ",e[0][x][1][1]);break;case 1:g=kt("\r",e[0][x][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+g,x=-1}l.push(c+lE[T[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=us(T[1][1],o,s),l.push(hs(u,a));break;case"PtgRefN":u=r?us(T[1][1],r,s):T[1][1],l.push(hs(u,a));break;case"PtgRef3d":f=T[1][1],u=us(T[1][2],o,s),y=dh(i,f,s),l.push(y+"!"+hs(u,a));break;case"PtgFunc":case"PtgFuncVar":var m=T[1][0],w=T[1][1];m||(m=0),m&=127;var E=m==0?[]:l.slice(-m);l.length-=m,w==="User"&&(w=E.shift()),l.push(w+"("+E.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":p=Yu(T[1][1],r?{s:r}:o,s),l.push(Fl(p,s));break;case"PtgArea":p=Yu(T[1][1],o,s),l.push(Fl(p,s));break;case"PtgArea3d":f=T[1][1],p=T[1][2],y=dh(i,f,s),l.push(y+"!"+Fl(p,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=T[1][2];var b=(i.names||[])[h-1]||(i[0]||[])[h],_=b?b.Name:"SH33TJSNAME"+String(h);_&&_.slice(0,6)=="_xlfn."&&!s.xlfn&&(_=_.slice(6)),l.push(_);break;case"PtgNameX":var A=T[1][1];h=T[1][2];var S;if(s.biff<=5)A<0&&(A=-A),i[A]&&(S=i[A][h]);else{var j="";if(((i[A]||[])[0]||[])[0]==14849||(((i[A]||[])[0]||[])[0]==1025?i[A][h]&&i[A][h].itab>0&&(j=i.SheetNames[i[A][h].itab-1]+"!"):j=i.SheetNames[h-1]+"!"),i[A]&&i[A][h])j+=i[A][h].Name;else if(i[0]&&i[0][h])j+=i[0][h].Name;else{var C=(fp(i,A,s)||"").split(";;");C[h-1]?j=C[h-1]:j+="SH33TJSERRX"}l.push(j);break}S||(S={Name:"SH33TJSERRY"}),l.push(S.Name);break;case"PtgParen":var P="(",M=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:P=kt(" ",e[0][x][1][1])+P;break;case 3:P=kt("\r",e[0][x][1][1])+P;break;case 4:M=kt(" ",e[0][x][1][1])+M;break;case 5:M=kt("\r",e[0][x][1][1])+M;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(P+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:T[1][1],r:T[1][0]};var X={c:r.c,r:r.r};if(i.sharedf[ot(u)]){var ee=i.sharedf[ot(u)];l.push(Oi(ee,o,X,i,s))}else{var q=!1;for(d=0;d!=i.arrayf.length;++d)if(c=i.arrayf[d],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){l.push(Oi(c[1],o,X,i,s)),q=!0;break}q||l.push(T[1])}break;case"PtgArray":l.push("{"+oE(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&K.indexOf(e[0][v][0])==-1){T=e[0][x];var Q=!0;switch(T[1][0]){case 4:Q=!1;case 0:g=kt(" ",T[1][1]);break;case 5:Q=!1;case 1:g=kt("\r",T[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((Q?g:"")+l.pop()+(Q?"":g)),x=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function dE(e){if(e==null){var t=ce(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ti(e);return ti(0)}function uE(e,t,r,i,s){var a=ri(t,r,s),o=dE(e.v),l=ce(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=ce(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=Qt([a,o,l,c]);return f}function Uo(e,t,r){var i=e.read_shift(4),s=aE(e,i,r),a=e.read_shift(4),o=a>0?sE(e,a,s,r):null;return[s,o]}var hE=Uo,zo=Uo,fE=Uo,pE=Uo,xE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},pp={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gE(e){var t="of:="+e.replace(hd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yE(e){return e.replace(/\./,"!")}var fs=typeof Map<"u";function xd(e,t,r){var i=0,s=e.length;if(r){if(fs?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=fs?r.get(t):r[t];i<a.length;++i)if(e[a[i]].t===t)return e.Count++,a[i]}}else for(;i<s;++i)if(e[i].t===t)return e.Count++,i;return e[s]={t},e.Count++,e.Unique++,r&&(fs?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Wo(e,t){var r={min:e+1,max:e+1},i=-1;return t.MDW&&(jn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?i=lo(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(r.width=yc(i),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function xp(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function zn(e,t,r){var i=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(i==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){df(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=i=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===i)return s;return e[a]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function vE(e,t,r){if(e&&e["!ref"]){var i=mt(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function bE(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Lt(e[r])+'"/>';return t+"</mergeCells>"}function wE(e,t,r,i,s){var a=!1,o={},l=null;if(i.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}a=!0,o.codeName=Ts(at(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+Ee("outlinePr",null,c)}!a&&!l||(s[s.length]=Ee("sheetPr",l,o))}var SE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function EE(e){var t={sheet:1};return SE.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),jE.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Jf(e.password).toString(16).toUpperCase()),Ee("sheetProtection",null,t)}function _E(e){return xp(e),Ee("pageMargins",null,e)}function TE(e,t){for(var r=["<cols>"],i,s=0;s!=t.length;++s)(i=t[s])&&(r[r.length]=Ee("col",null,Wo(s,i)));return r[r.length]="</cols>",r.join("")}function AE(e,t,r,i){var s=typeof e.ref=="string"?e.ref:Lt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Rr(s);o.s.r==o.e.r&&(o.e.r=Rr(t["!ref"]).e.r,s=Lt(o));for(var l=0;l<a.length;++l){var d=a[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==i){d.Ref="'"+r.SheetNames[i]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+s}),Ee("autoFilter",null,{ref:s})}function kE(e,t,r,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,s),{})}function CE(e,t,r,i){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=zs[e.v];break;case"d":i&&i.cellDates?s=mr(e.v,-1).toISOString():(e=jr(e),e.t="n",s=""+(e.v=Sr(mr(e.v)))),typeof e.z>"u"&&(e.z=It[14]);break;default:s=e.v;break}var l=Jt("v",at(s)),d={r:t},c=zn(i.cellXfs,e,i);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){l=Jt("v",""+xd(i.Strings,e.v,i.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ee("f",at(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Ee("c",l,d)}function IE(e,t,r,i){var s=[],a=[],o=mt(e["!ref"]),l="",d,c="",u=[],f=0,h=0,p=e["!rows"],y=Array.isArray(e),x={r:c},g,v=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=dr(h);for(f=o.s.r;f<=o.e.r;++f){for(a=[],c=Zt(f),h=o.s.c;h<=o.e.c;++h){d=u[h]+c;var k=y?(e[f]||[])[h]:e[d];k!==void 0&&(l=CE(k,d,e,t))!=null&&a.push(l)}(a.length>0||p&&p[f])&&(x={r:c},p&&p[f]&&(g=p[f],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=co(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),s[s.length]=Ee("row",a.join(""),x))}if(p)for(;f<p.length;++f)p&&p[f]&&(x={r:f+1},g=p[f],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=co(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level),s[s.length]=Ee("row","",x));return s.join("")}function mp(e,t,r,i){var s=[Mt,Ee("worksheet",null,{xmlns:$i[0],"xmlns:r":qt.r})],a=r.SheetNames[e],o=0,l="",d=r.Sheets[a];d==null&&(d={});var c=d["!ref"]||"A1",u=mt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Lt(u)}i||(i={}),d["!comments"]=[];var f=[];wE(d,r,e,t,s),s[s.length]=Ee("dimension",null,{ref:c}),s[s.length]=kE(d,t,e,r),t.sheetFormat&&(s[s.length]=Ee("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=TE(d,d["!cols"])),s[o=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=IE(d,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),d["!protect"]&&(s[s.length]=EE(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=AE(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=bE(d["!merges"]));var h=-1,p,y=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=st(i,-1,at(x[1].Target).replace(/#.*$/,""),Je.HLINK),p["r:id"]="rId"+y),(h=x[1].Target.indexOf("#"))>-1&&(p.location=at(x[1].Target.slice(h+1))),x[1].Tooltip&&(p.tooltip=at(x[1].Tooltip)),s[s.length]=Ee("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=_E(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Jt("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(y=st(i,-1,"../drawings/drawing"+(e+1)+".xml",Je.DRAW),s[s.length]=Ee("drawing",null,{"r:id":"rId"+y}),d["!drawing"]=f),d["!comments"].length>0&&(y=st(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Je.VML),s[s.length]=Ee("legacyDrawing",null,{"r:id":"rId"+y}),d["!legacy"]=y),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function NE(e,t){var r={},i=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=i,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function FE(e,t,r){var i=ce(145),s=(r["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var a=320;s.hpx?a=co(s.hpx)*20:s.hpt&&(a=s.hpt*20),i.write_shift(2,a),i.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var l=0,d=i.l;i.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];y&&(f<0&&(f=p),h=p)}f<0||(++l,i.write_shift(4,f),i.write_shift(4,h))}var x=i.l;return i.l=d,i.write_shift(4,l),i.l=x,i.length>i.l?i.slice(0,i.l):i}function RE(e,t,r,i){var s=FE(i,r,t);(s.length>17||(t["!rows"]||[])[i])&&ve(e,0,s)}var PE=li,DE=zi;function OE(){}function LE(e,t){var r={},i=e[e.l];return++e.l,r.above=!(i&64),r.left=!(i&128),e.l+=18,r.name=G2(e),r}function ME(e,t,r){r==null&&(r=ce(84+4*e.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),r.write_shift(1,i);for(var s=1;s<3;++s)r.write_shift(1,0);return so({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Nf(e,r),r.slice(0,r.l)}function BE(e){var t=Ur(e);return[t]}function $E(e,t,r){return r==null&&(r=ce(8)),si(t,r)}function UE(e){var t=ai(e);return[t]}function zE(e,t,r){return r==null&&(r=ce(4)),oi(t,r)}function WE(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"b"]}function qE(e,t,r){return r==null&&(r=ce(9)),si(t,r),r.write_shift(1,e.v?1:0),r}function VE(e){var t=ai(e),r=e.read_shift(1);return[t,r,"b"]}function HE(e,t,r){return r==null&&(r=ce(5)),oi(t,r),r.write_shift(1,e.v?1:0),r}function GE(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"e"]}function YE(e,t,r){return r==null&&(r=ce(9)),si(t,r),r.write_shift(1,e.v),r}function XE(e){var t=ai(e),r=e.read_shift(1);return[t,r,"e"]}function KE(e,t,r){return r==null&&(r=ce(8)),oi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function QE(e){var t=Ur(e),r=e.read_shift(4);return[t,r,"s"]}function JE(e,t,r){return r==null&&(r=ce(12)),si(t,r),r.write_shift(4,t.v),r}function ZE(e){var t=ai(e),r=e.read_shift(4);return[t,r,"s"]}function e_(e,t,r){return r==null&&(r=ce(8)),oi(t,r),r.write_shift(4,t.v),r}function t_(e){var t=Ur(e),r=Wi(e);return[t,r,"n"]}function r_(e,t,r){return r==null&&(r=ce(16)),si(t,r),ti(e.v,r),r}function n_(e){var t=ai(e),r=Wi(e);return[t,r,"n"]}function i_(e,t,r){return r==null&&(r=ce(12)),oi(t,r),ti(e.v,r),r}function s_(e){var t=Ur(e),r=Ff(e);return[t,r,"n"]}function a_(e,t,r){return r==null&&(r=ce(12)),si(t,r),Rf(e.v,r),r}function o_(e){var t=ai(e),r=Ff(e);return[t,r,"n"]}function l_(e,t,r){return r==null&&(r=ce(8)),oi(t,r),Rf(e.v,r),r}function c_(e){var t=Ur(e),r=od(e);return[t,r,"is"]}function d_(e){var t=Ur(e),r=ur(e);return[t,r,"str"]}function u_(e,t,r){return r==null&&(r=ce(12+4*e.v.length)),si(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function h_(e){var t=ai(e),r=ur(e);return[t,r,"str"]}function f_(e,t,r){return r==null&&(r=ce(8+4*e.v.length)),oi(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function p_(e,t,r){var i=e.l+t,s=Ur(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=zo(e,i-e.l,r);o[3]=Oi(l,null,s,r.supbooks,r)}else e.l=i;return o}function x_(e,t,r){var i=e.l+t,s=Ur(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=zo(e,i-e.l,r);o[3]=Oi(l,null,s,r.supbooks,r)}else e.l=i;return o}function m_(e,t,r){var i=e.l+t,s=Ur(e);s.r=r["!row"];var a=Wi(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=zo(e,i-e.l,r);o[3]=Oi(l,null,s,r.supbooks,r)}else e.l=i;return o}function g_(e,t,r){var i=e.l+t,s=Ur(e);s.r=r["!row"];var a=ur(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=zo(e,i-e.l,r);o[3]=Oi(l,null,s,r.supbooks,r)}else e.l=i;return o}var y_=li,v_=zi;function b_(e,t){return t==null&&(t=ce(4)),t.write_shift(4,e),t}function w_(e,t){var r=e.l+t,i=li(e),s=ld(e),a=ur(e),o=ur(e),l=ur(e);e.l=r;var d={rfx:i,relId:s,loc:a,display:l};return o&&(d.Tooltip=o),d}function S_(e,t){var r=ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));zi({s:Vt(e[0]),e:Vt(e[0])},r),cd("rId"+t,r);var i=e[1].Target.indexOf("#"),s=i==-1?"":e[1].Target.slice(i+1);return Ht(s||"",r),Ht(e[1].Tooltip||"",r),Ht("",r),r.slice(0,r.l)}function j_(){}function E_(e,t,r){var i=e.l+t,s=Pf(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=hE(e,i-e.l,r);o[1]=l}else e.l=i;return o}function __(e,t,r){var i=e.l+t,s=li(e),a=[s];if(r.cellFormula){var o=pE(e,i-e.l,r);a[1]=o,e.l=i}else e.l=i;return a}function T_(e,t,r){r==null&&(r=ce(18));var i=Wo(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(i.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var gp=["left","right","top","bottom","header","footer"];function A_(e){var t={};return gp.forEach(function(r){t[r]=Wi(e)}),t}function k_(e,t){return t==null&&(t=ce(6*8)),xp(e),gp.forEach(function(r){ti(e[r],t)}),t}function C_(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function I_(e,t,r){r==null&&(r=ce(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),r.write_shift(2,i),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function N_(e){var t=ce(24);return t.write_shift(4,4),t.write_shift(4,1),zi(e,t),t}function F_(e,t){return t==null&&(t=ce(16*4+2)),t.write_shift(2,e.password?Jf(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function R_(){}function P_(){}function D_(e,t,r,i,s,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=jr(t),t.z=t.z||It[14],t.v=Sr(mr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:i};switch(d.s=zn(s.cellXfs,t,s),t.l&&a["!links"].push([ot(d),t.l]),t.c&&a["!comments"].push([ot(d),t.c]),t.t){case"s":case"str":return s.bookSST?(l=xd(s.Strings,t.v,s.revStrings),d.t="s",d.v=l,o?ve(e,18,e_(t,d)):ve(e,7,JE(t,d))):(d.t="str",o?ve(e,17,f_(t,d)):ve(e,6,u_(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ve(e,13,l_(t,d)):ve(e,2,a_(t,d)):o?ve(e,16,i_(t,d)):ve(e,5,r_(t,d)),!0;case"b":return d.t="b",o?ve(e,15,HE(t,d)):ve(e,4,qE(t,d)),!0;case"e":return d.t="e",o?ve(e,14,KE(t,d)):ve(e,3,YE(t,d)),!0}return o?ve(e,12,zE(t,d)):ve(e,1,$E(t,d)),!0}function O_(e,t,r,i){var s=mt(t["!ref"]||"A1"),a,o="",l=[];ve(e,145);var d=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){o=Zt(u),RE(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=dr(h)),a=l[h]+o;var p=d?(t[u]||[])[h]:t[a];if(!p){f=!1;continue}f=D_(e,p,u,h,i,t,f)}}ve(e,146)}function L_(e,t){!t||!t["!merges"]||(ve(e,177,b_(t["!merges"].length)),t["!merges"].forEach(function(r){ve(e,176,v_(r))}),ve(e,178))}function M_(e,t){!t||!t["!cols"]||(ve(e,390),t["!cols"].forEach(function(r,i){r&&ve(e,60,T_(i,r))}),ve(e,391))}function B_(e,t){!t||!t["!ref"]||(ve(e,648),ve(e,649,N_(mt(t["!ref"]))),ve(e,650))}function $_(e,t,r){t["!links"].forEach(function(i){if(i[1].Target){var s=st(r,-1,i[1].Target.replace(/#.*$/,""),Je.HLINK);ve(e,494,S_(i,s))}}),delete t["!links"]}function U_(e,t,r,i){if(t["!comments"].length>0){var s=st(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Je.VML);ve(e,551,cd("rId"+s)),t["!legacy"]=s}}function z_(e,t,r,i){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Lt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Rr(a);l.s.r==l.e.r&&(l.e.r=Rr(t["!ref"]).e.r,a=Lt(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i){c.Ref="'"+r.SheetNames[i]+"'!"+a;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+a}),ve(e,161,zi(mt(a))),ve(e,162)}}function W_(e,t,r){ve(e,133),ve(e,137,I_(t,r)),ve(e,138),ve(e,134)}function q_(e,t){t["!protect"]&&ve(e,535,F_(t["!protect"]))}function V_(e,t,r,i){var s=vr(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=mt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ve(s,129),(r.vbaraw||o["!outline"])&&ve(s,147,ME(l,o["!outline"])),ve(s,148,DE(d)),W_(s,o,r.Workbook),M_(s,o),O_(s,o,e,t),q_(s,o),z_(s,o,r,e),L_(s,o),$_(s,o,i),o["!margins"]&&ve(s,476,k_(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&B_(s,o),U_(s,o,e,i),ve(s,130),s.end()}function H_(e,t){e.l+=10;var r=ur(e);return{name:r}}var G_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Y_(e){return!e.Workbook||!e.Workbook.WBProps?"false":_2(e.Workbook.WBProps.date1904)?"true":"false"}var X_="][*?/\\".split("");function yp(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return X_.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function K_(e,t,r){e.forEach(function(i,s){yp(i);for(var a=0;a<s;++a)if(i==e[a])throw new Error("Duplicate Sheet Name: "+i);if(r){var o=t&&t[s]&&t[s].CodeName||i;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Q_(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];K_(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vE(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function vp(e){var t=[Mt];t[t.length]=Ee("workbook",null,{xmlns:$i[0],"xmlns:r":qt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(G_.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=Ee("workbookPr",null,i);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:at(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ee("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=Ee("definedName",at(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function J_(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=gc(e),r.name=ur(e),r}function Z_(e,t){return t||(t=ce(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),cd(e.strRelID,t),Ht(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function eT(e,t){var r={},i=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ur(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(i&65536),r.backupFile=!!(i&64),r.checkCompatibility=!!(i&4096),r.date1904=!!(i&1),r.filterPrivacy=!!(i&8),r.hidePivotFieldList=!!(i&1024),r.promptedSolutions=!!(i&16),r.publishItems=!!(i&2048),r.refreshAllConnections=!!(i&262144),r.saveExternalLinkValues=!!(i&128),r.showBorderUnselectedTables=!!(i&4),r.showInkAnnotation=!!(i&32),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(i&32768),r.updateLinks=["userSet","never","always"][i>>8&3],r}function tT(e,t){t||(t=ce(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Nf(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rT(e,t,r){var i=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Y2(e),o=fE(e,0,r),l=ld(e);e.l=i;var d={Name:a,Ptg:o};return s<268435455&&(d.Sheet=s),l&&(d.Comment=l),d}function nT(e,t){ve(e,143);for(var r=0;r!=t.SheetNames.length;++r){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:i,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ve(e,156,Z_(s))}ve(e,144)}function iT(e,t){t||(t=ce(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ht("SheetJS",t),Ht(Ja.version,t),Ht(Ja.version,t),Ht("7262",t),t.length>t.l?t.slice(0,t.l):t}function sT(e,t){t||(t=ce(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function aT(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,i=0,s=-1,a=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&s==-1?s=i:r[i].Hidden==1&&a==-1&&(a=i);a>s||(ve(e,135),ve(e,158,sT(s)),ve(e,136))}}function oT(e,t){var r=vr();return ve(r,131),ve(r,128,iT()),ve(r,153,tT(e.Workbook&&e.Workbook.WBProps||null)),aT(r,e),nT(r,e),ve(r,132),r.end()}function lT(e,t,r){return(t.slice(-4)===".bin"?oT:vp)(e)}function cT(e,t,r,i,s){return(t.slice(-4)===".bin"?V_:mp)(e,r,i,s)}function dT(e,t,r){return(t.slice(-4)===".bin"?kS:tp)(e,r)}function uT(e,t,r){return(t.slice(-4)===".bin"?tS:Qf)(e,r)}function hT(e,t,r){return(t.slice(-4)===".bin"?qS:ap)(e)}function fT(e){return(e.slice(-4)===".bin"?OS:ip)()}function pT(e,t){var r=[];return e.Props&&r.push(dw(e.Props,t)),e.Custprops&&r.push(uw(e.Props,e.Custprops)),r.join("")}function xT(){return""}function mT(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,s){var a=[];a.push(Ee("NumberFormat",null,{"ss:Format":at(It[i.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ee("Style",a.join(""),o))}),Ee("Styles",r.join(""))}function bp(e){return Ee("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+fd(e.Ref,{r:0,c:0})})}function gT(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],i=0;i<t.length;++i){var s=t[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(bp(s)))}return Ee("Names",r.join(""))}function yT(e,t,r,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(bp(l)))}return a.join("")}function vT(e,t,r,i){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ee("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ee("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ee("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[r])if(i.Workbook.Sheets[r].Hidden)s.push(Ee("Visible",i.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(i.Workbook.Sheets[a]&&!i.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Jt("ProtectContents","True")),e["!protect"].objects&&s.push(Jt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Jt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Jt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Jt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ee("WorksheetOptions",s.join(""),{xmlns:Ar.x})}function bT(e){return e.map(function(t){var r=E2(t.t||""),i=Ee("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ee("Comment",i,{"ss:Author":t.a})}).join("")}function wT(e,t,r,i,s,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+at(fd(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Vt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=at(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=at(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(l["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(l["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",h="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=zs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||It[14]);break;case"s":f="String",h=j2(e.v||"");break}var p=zn(i.cellXfs,e,i);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var y=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+y+"</Data>";return(e.c||[]).length>0&&(x+=bT(e.c)),Ee("Cell",x,l)}function ST(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ep(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function jT(e,t,r,i){if(!e["!ref"])return"";var s=mt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){ud(g);var k=!!g.width,T=Wo(v,g),m={"ss:Index":v+1};k&&(m["ss:Width"]=oo(T.width)),g.hidden&&(m["ss:Hidden"]="1"),l.push(Ee("Column",null,m))});for(var d=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var u=[ST(c,(e["!rows"]||[])[c])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>c)&&!(a[o].e.c<f)&&!(a[o].e.r<c)){(a[o].s.c!=f||a[o].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:f},y=ot(p),x=d?(e[c]||[])[f]:e[y];u.push(wT(x,y,e,t,r,i,p))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function ET(e,t,r){var i=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?yT(a,t,e,r):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=a?jT(a,t,e,r):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(vT(a,t,e,r)),i.join("")}function _T(e,t){t||(t={}),e.SSF||(e.SSF=jr(It)),e.SSF&&(Mo(),Lo(e.SSF),t.revssf=Bo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pT(e,t)),r.push(xT()),r.push(""),r.push("");for(var i=0;i<e.SheetNames.length;++i)r.push(Ee("Worksheet",ET(i,t,e),{"ss:Name":at(e.SheetNames[i])}));return r[2]=mT(e,t),r[3]=gT(e),Mt+Ee("Workbook",r.join(""),{xmlns:Ar.ss,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:ss":Ar.ss,"xmlns:dt":Ar.dt,"xmlns:html":Ar.html})}var Dl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function TT(e,t){var r=[],i=[],s=[],a=0,o,l=Lu(Ku,"n"),d=Lu(Qu,"n");if(e.Props)for(o=er(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?i:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=er(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(d,o[a])?i:s).push([o[a],e.Custprops[o[a]]]);var c=[];for(a=0;a<s.length;++a)qf.indexOf(s[a][0])>-1||Uf.indexOf(s[a][0])>-1||s[a][1]!=null&&c.push(s[a]);i.length&&dt.utils.cfb_add(t,"/SummaryInformation",rh(i,Dl.SI,d,Qu)),(r.length||c.length)&&dt.utils.cfb_add(t,"/DocumentSummaryInformation",rh(r,Dl.DSI,l,Ku,c.length?c:null,Dl.UDI))}function AT(e,t){var r=t||{},i=dt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return dt.utils.cfb_add(i,s,wp(e,r)),r.biff==8&&(e.Props||e.Custprops)&&TT(e,i),r.biff==8&&e.vbaraw&&VS(i,dt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),i}var kT={0:{f:NE},1:{f:BE},2:{f:s_},3:{f:GE},4:{f:WE},5:{f:t_},6:{f:d_},7:{f:QE},8:{f:g_},9:{f:m_},10:{f:p_},11:{f:x_},12:{f:UE},13:{f:o_},14:{f:XE},15:{f:VE},16:{f:n_},17:{f:h_},18:{f:ZE},19:{f:od},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rT},40:{},42:{},43:{f:dS},44:{f:lS},45:{f:fS},46:{f:xS},47:{f:pS},48:{},49:{f:U2},50:{},51:{f:NS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zw},62:{f:c_},63:{f:LS},64:{f:R_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:C_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:LE},148:{f:PE,p:16},151:{f:j_},152:{},153:{f:eT},154:{},155:{},156:{f:J_},157:{},158:{},159:{T:1,f:Jw},160:{T:-1},161:{T:1,f:li},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:y_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CS},336:{T:-1},337:{f:PS,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ow},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:E_},427:{f:__},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:A_},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:w_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zS},633:{T:1},634:{T:-1},635:{T:1,f:$S},636:{T:-1},637:{f:V2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:H_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:P_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(e,t,r,i){var s=t;if(!isNaN(s)){var a=i||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&id(r)&&e.push(r)}}function CT(e,t,r,i){var s=(r||[]).length||0;if(s<=8224)return _e(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<s;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function qs(e,t,r){return e||(e=ce(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function IT(e,t,r,i){var s=ce(9);return qs(s,e,t),Hf(r,i||"b",s),s}function NT(e,t,r){var i=ce(8+2*r.length);return qs(i,e,t),i.write_shift(1,r.length),i.write_shift(r.length,r,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function FT(e,t,r,i){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Sr(mr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?_e(e,2,Hw(r,i,s)):_e(e,3,Vw(r,i,s));return;case"b":case"e":_e(e,5,IT(r,i,t.v,t.t));return;case"s":case"str":_e(e,4,NT(r,i,(t.v||"").slice(0,255)));return}_e(e,1,qs(null,r,i))}function RT(e,t,r,i){var s=Array.isArray(t),a=mt(t["!ref"]||"A1"),o,l="",d=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Lt(a)}for(var c=a.s.r;c<=a.e.r;++c){l=Zt(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(d[u]=dr(u)),o=d[u]+l;var f=s?(t[c]||[])[u]:t[o];f&&FT(e,f,c,u)}}}function PT(e,t){for(var r=t||{},i=vr(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(i,r.biff==4?1033:r.biff==3?521:9,dd(e,16,r)),RT(i,e.Sheets[e.SheetNames[s]],s,r),_e(i,10),i.end()}function DT(e,t,r){_e(e,49,kw({sz:12,name:"Arial"},r))}function OT(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&_e(e,1054,Nw(s,t[s],r))})}function LT(e,t){var r=ce(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(e,2151,r),r=ce(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Xf(mt(t["!ref"]||"A1"),r),r.write_shift(4,4),_e(e,2152,r)}function MT(e,t){for(var r=0;r<16;++r)_e(e,224,ih({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){_e(e,224,ih(i,0,t))})}function BT(e,t){for(var r=0;r<t["!links"].length;++r){var i=t["!links"][r];_e(e,440,Bw(i)),i[1].Tooltip&&_e(e,2048,$w(i))}delete t["!links"]}function $T(e,t){if(t){var r=0;t.forEach(function(i,s){++r<=256&&i&&_e(e,125,Ww(Wo(s,i),s))})}}function UT(e,t,r,i,s){var a=16+zn(s.cellXfs,t,s);if(t.v==null&&!t.bf){_e(e,513,ri(r,i,a));return}if(t.bf)_e(e,6,uE(t,r,i,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?Sr(mr(t.v)):t.v;_e(e,515,Dw(r,i,o,a));break;case"b":case"e":_e(e,517,Pw(r,i,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=xd(s.Strings,t.v,s.revStrings);_e(e,253,Cw(r,i,l,a))}else _e(e,516,Iw(r,i,(t.v||"").slice(0,255),a,s));break;default:_e(e,513,ri(r,i,a))}}function zT(e,t,r){var i=vr(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(a),c=t.biff==8,u,f="",h=[],p=mt(a["!ref"]||"A1"),y=c?65536:16384;if(p.e.c>255||p.e.r>=y){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,y-1)}_e(i,2057,dd(r,16,t)),_e(i,13,Or(1)),_e(i,12,Or(100)),_e(i,15,xr(!0)),_e(i,17,xr(!1)),_e(i,16,ti(.001)),_e(i,95,xr(!0)),_e(i,42,xr(!1)),_e(i,43,xr(!1)),_e(i,130,Or(1)),_e(i,128,Rw()),_e(i,131,xr(!1)),_e(i,132,xr(!1)),c&&$T(i,a["!cols"]),_e(i,512,Fw(p,t)),c&&(a["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){f=Zt(x);for(var g=p.s.c;g<=p.e.c;++g){x===p.s.r&&(h[g]=dr(g)),u=h[g]+f;var v=d?(a[x]||[])[g]:a[u];v&&(UT(i,v,x,g,t),c&&v.l&&a["!links"].push([u,v.l]))}}var k=l.CodeName||l.name||s;return c&&_e(i,574,Aw((o.Views||[])[0])),c&&(a["!merges"]||[]).length&&_e(i,229,Mw(a["!merges"])),c&&BT(i,a),_e(i,442,Yf(k)),c&&LT(i,a),_e(i,10),i.end()}function WT(e,t,r){var i=vr(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,d=r.biff==5;if(_e(i,2057,dd(e,5,r)),r.bookType=="xla"&&_e(i,135),_e(i,225,l?Or(1200):null),_e(i,193,pw(2)),d&&_e(i,191),d&&_e(i,192),_e(i,226),_e(i,92,jw("SheetJS",r)),_e(i,66,Or(l?1200:1252)),l&&_e(i,353,Or(0)),l&&_e(i,448),_e(i,317,qw(e.SheetNames.length)),l&&e.vbaraw&&_e(i,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";_e(i,442,Yf(c))}_e(i,156,Or(17)),_e(i,25,xr(!1)),_e(i,18,xr(!1)),_e(i,19,Or(0)),l&&_e(i,431,xr(!1)),l&&_e(i,444,Or(0)),_e(i,61,Tw()),_e(i,64,xr(!1)),_e(i,141,Or(0)),_e(i,34,xr(Y_(e)=="true")),_e(i,14,xr(!0)),l&&_e(i,439,xr(!1)),_e(i,218,Or(0)),DT(i,e,r),OT(i,e.SSF,r),MT(i,r),l&&_e(i,352,xr(!1));var u=i.end(),f=vr();l&&_e(f,140,Uw()),l&&r.Strings&&CT(f,252,_w(r.Strings)),_e(f,10);var h=f.end(),p=vr(),y=0,x=0;for(x=0;x<e.SheetNames.length;++x)y+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=u.length+y+h.length;for(x=0;x<e.SheetNames.length;++x){var v=a[x]||{};_e(p,133,Ew({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var k=p.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var T=[];return u.length&&T.push(u),k.length&&T.push(k),h.length&&T.push(h),Qt(T)}function qT(e,t){var r=t||{},i=[];e&&!e.SSF&&(e.SSF=jr(It)),e&&e.SSF&&(Mo(),Lo(e.SSF),r.revssf=Bo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,md(r),r.cellXfs=[],zn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)i[i.length]=zT(s,r,e);return i.unshift(WT(e,i,r)),Qt(i)}function wp(e,t){for(var r=0;r<=e.SheetNames.length;++r){var i=e.Sheets[e.SheetNames[r]];if(!(!i||!i["!ref"])){var s=Rr(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return qT(e,t);case 4:case 3:case 2:return PT(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function VT(e,t,r,i){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>o)&&!(s[c].e.r<r||s[c].e.c<o)){if(s[c].s.r<r||s[c].s.c<o){l=-1;break}l=s[c].e.r-s[c].s.r+1,d=s[c].e.c-s[c].s.c+1;break}if(!(l<0)){var u=ot({r,c:o}),f=i.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||S2(f.w||(Tn(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),d>1&&(p.colspan=d),i.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(i.id||"sjs")+"-"+u,a.push(Ee("td",h,p))}}var y="<tr>";return y+a.join("")+"</tr>"}var HT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',GT="</body></html>";function YT(e,t,r){var i=[];return i.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Sp(e,t){var r=t||{},i=r.header!=null?r.header:HT,s=r.footer!=null?r.footer:GT,a=[i],o=Rr(e["!ref"]);r.dense=Array.isArray(e),a.push(YT(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(VT(e,o,l,r));return a.push("</table>"+s),a.join("")}function jp(e,t,r){var i=r||{},s=0,a=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var o=typeof i.origin=="string"?Vt(i.origin):i.origin;s=o.r,a=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(i.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Rr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),y=0,x=0,g=0,v=0,k=0,T=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&x<d;++y){var m=l[y];if(uh(m)){if(i.display)continue;p[x]={hidden:!0}}var w=m.children;for(g=v=0;g<w.length;++g){var E=w[g];if(!(i.display&&uh(E))){var b=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):T2(E.innerHTML),_=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<f.length;++h){var A=f[h];A.s.c==v+a&&A.s.r<x+s&&x+s<=A.e.r&&(v=A.e.c+1-a,h=-1)}T=+E.getAttribute("colspan")||1,((k=+E.getAttribute("rowspan")||1)>1||T>1)&&f.push({s:{r:x+s,c:v+a},e:{r:x+s+(k||1)-1,c:v+a+(T||1)-1}});var S={t:"s",v:b},j=E.getAttribute("data-t")||E.getAttribute("t")||"";b!=null&&(b.length==0?S.t=j||"z":i.raw||b.trim().length==0||j=="s"||(b==="TRUE"?S={t:"b",v:!0}:b==="FALSE"?S={t:"b",v:!1}:isNaN(Sn(b))?isNaN(_s(b).getDate())||(S={t:"d",v:mr(b)},i.cellDates||(S={t:"n",v:Sr(S.v)}),S.z=i.dateNF||It[14]):S={t:"n",v:Sn(b)})),S.z===void 0&&_!=null&&(S.z=_);var C="",P=E.getElementsByTagName("A");if(P&&P.length)for(var M=0;M<P.length&&!(P[M].hasAttribute("href")&&(C=P[M].getAttribute("href"),C.charAt(0)!="#"));++M);C&&C.charAt(0)!="#"&&(S.l={Target:C}),i.dense?(e[x+s]||(e[x+s]=[]),e[x+s][v+a]=S):e[ot({c:v+a,r:x+s})]=S,c.e.c<v+a&&(c.e.c=v+a),v+=T}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,x-1+s),e["!ref"]=Lt(c),x>=d&&(e["!fullref"]=Lt((c.e.r=l.length-y+x-1+s,c))),e}function Ep(e,t){var r=t||{},i=r.dense?[]:{};return jp(i,e,t)}function XT(e,t){return ii(Ep(e,t),t)}function uh(e){var t="",r=KT(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KT(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var QT=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+As({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Mt+t}}(),hh=function(){var e=function(a){return at(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,i=function(a,o,l){var d=[];d.push('      <table:table table:name="'+at(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,u=0,f=Rr(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,y=Array.isArray(a);if(a["!cols"])for(u=0;u<=f.e.c;++u)d.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",g=a["!rows"]||[];for(c=0;c<f.s.r;++c)x=g[c]?' table:style-name="ro'+g[c].ods+'"':"",d.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=f.e.r;++c){for(x=g[c]?' table:style-name="ro'+g[c].ods+'"':"",d.push("        <table:table-row"+x+`>
`),u=0;u<f.s.c;++u)d.push(t);for(;u<=f.e.c;++u){var v=!1,k={},T="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>u)&&!(h[p].s.r>c)&&!(h[p].e.c<u)&&!(h[p].e.r<c)){(h[p].s.c!=u||h[p].s.r!=c)&&(v=!0),k["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,k["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){d.push(r);continue}var m=ot({r:c,c:u}),w=y?(a[c]||[])[u]:a[m];if(w&&w.f&&(k["table:formula"]=at(gE(w.f)),w.F&&w.F.slice(0,m.length)==m)){var E=Rr(w.F);k["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,k["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!w){d.push(t);continue}switch(w.t){case"b":T=w.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=w.v?"true":"false";break;case"n":T=w.w||String(w.v||0),k["office:value-type"]="float",k["office:value"]=w.v||0;break;case"s":case"str":T=w.v==null?"":w.v,k["office:value-type"]="string";break;case"d":T=w.w||mr(w.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=mr(w.v).toISOString(),k["table:style-name"]="ce1";break;default:d.push(t);continue}var b=e(T);if(w.l&&w.l.Target){var _=w.l.Target;_=_.charAt(0)=="#"?"#"+yE(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),b=Ee("text:a",b,{"xlink:href":_.replace(/&/g,"&amp;")})}d.push("          "+Ee("table:table-cell",Ee("text:p",b,{}),k)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ud(f),f.ods=l;var h=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=d;var f=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++d}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var d=[Mt],c=As({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=As({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+u+`>
`),d.push(Bf().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),s(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)d.push(i(o.Sheets[o.SheetNames[f]],o,f));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function _p(e,t){if(t.bookType=="fods")return hh(e,t);var r=ed(),i="",s=[],a=[];return i="mimetype",qe(r,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",qe(r,i,hh(e,t)),s.push([i,"text/xml"]),a.push([i,"ContentFile"]),i="styles.xml",qe(r,i,QT(e,t)),s.push([i,"text/xml"]),a.push([i,"StylesFile"]),i="meta.xml",qe(r,i,Mt+Bf()),s.push([i,"text/xml"]),a.push([i,"MetadataFile"]),i="manifest.rdf",qe(r,i,cw(a)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",qe(r,i,ow(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function JT(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(Ts(e))}function ZT(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var i=0;i<t.length;++i)if(e[r+i]!=t[i])continue e;return!0}return!1}function $n(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),i=0;return e.forEach(function(s){r.set(s,i),i+=s.length}),r}function e4(e,t,r){var i=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,i-6176);e[t+15]|=i>>7,e[t+14]|=(i&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function ks(e,t){var r=t?t[0]:0,i=e[r]&127;e:if(e[r++]>=128&&(i|=(e[r]&127)<<7,e[r++]<128||(i|=(e[r]&127)<<14,e[r++]<128)||(i|=(e[r]&127)<<21,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(i+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),i}function it(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ni(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var i=r[0],s=ks(e,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ks(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(i))}var c={data:l,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function Yt(e){var t=[];return e.forEach(function(r,i){r.forEach(function(s){s.data&&(t.push(it(i*8+s.type)),s.type==2&&t.push(it(s.data.length)),t.push(s.data))})}),$n(t)}function zr(e){for(var t,r=[],i=[0];i[0]<e.length;){var s=ks(e,i),a=zt(e.slice(i[0],i[0]+s));i[0]+=s;var o={id:Ni(a[1][0].data),messages:[]};a[2].forEach(function(l){var d=zt(l.data),c=Ni(d[3][0].data);o.messages.push({meta:d,data:e.slice(i[0],i[0]+c)}),i[0]+=c}),(t=a[3])!=null&&t[0]&&(o.merge=Ni(a[3][0].data)>>>0>0),r.push(o)}return r}function xi(e){var t=[];return e.forEach(function(r){var i=[];i[1]=[{data:it(r.id),type:0}],i[2]=[],r.merge!=null&&(i[3]=[{data:it(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:it(o.data.length)}],i[2].push({data:Yt(o.meta),type:2})});var a=Yt(i);t.push(it(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),$n(t)}function t4(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],i=ks(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[$n(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(s.push(s[0].slice(-d)),c-=d;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-d,-d+c))}}var u=$n(s);if(u.length!=i)throw new Error("Unexpected length: ".concat(u.length," != ").concat(i));return u}function Wr(e){for(var t=[],r=0;r<e.length;){var i=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(t4(i,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $n(t)}function mi(e){for(var t=[],r=0;r<e.length;){var i=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=it(i),o=a.length;t.push(a),i<=60?(o++,t.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(e.slice(r,r+i)),o+=i,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=i}return $n(t)}function Ol(e,t){var r=new Uint8Array(32),i=uo(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,e4(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,i.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,i.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,a,!0),r.slice(0,s)}function Ll(e,t){var r=new Uint8Array(32),i=uo(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,i.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,i.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,i.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,a,!0),r.slice(0,s)}function Nn(e){var t=zt(e);return ks(t[1][0].data)}function r4(e,t,r){var i,s,a,o;if(!((i=e[6])!=null&&i[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Ni(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=uo(e[7][0].data),u=0,f=[],h=uo(e[4][0].data),p=0,y=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),h.setUint16(x*2,p,!0);var g,v;switch(typeof t[x]){case"string":g=Ol({t:"s",v:t[x]},r),v=Ll({t:"s",v:t[x]},r);break;case"number":g=Ol({t:"n",v:t[x]},r),v=Ll({t:"n",v:t[x]},r);break;case"boolean":g=Ol({t:"b",v:t[x]},r),v=Ll({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(g),u+=g.length,y.push(v),p+=v.length,++d}for(e[2][0].data=it(d);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=$n(f),e[3][0].data=$n(y),d}function n4(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Rr(r["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Lt(i)));var a=ho(r,{range:i,header:1}),o=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(O){typeof O=="string"&&o.push(O)})});var l={},d=[],c=dt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,O){return[U,c.FullPaths[O]]}).forEach(function(U){var O=U[0],I=U[1];if(O.type==2&&O.name.match(/\.iwa/)){var W=O.content,J=Wr(W),he=zr(J);he.forEach(function(ye){d.push(ye.id),l[ye.id]={deps:[],location:I,type:Ni(ye.messages[0].meta[1][0].data)}})}}),d.sort(function(U,O){return U-O});var u=d.filter(function(U){return U>1}).map(function(U){return[U,it(U)]});c.FileIndex.map(function(U,O){return[U,c.FullPaths[O]]}).forEach(function(U){var O=U[0];if(U[1],!!O.name.match(/\.iwa/)){var I=zr(Wr(O.content));I.forEach(function(W){W.messages.forEach(function(J){u.forEach(function(he){W.messages.some(function(ye){return Ni(ye.meta[1][0].data)!=11006&&ZT(ye.data,he[1])})&&l[he[0]].deps.push(W.id)})})})}});for(var f=dt.find(c,l[1].location),h=zr(Wr(f.content)),p,y=0;y<h.length;++y){var x=h[y];x.id==1&&(p=x)}var g=Nn(zt(p.messages[0].data)[1][0].data);for(f=dt.find(c,l[g].location),h=zr(Wr(f.content)),y=0;y<h.length;++y)x=h[y],x.id==g&&(p=x);for(g=Nn(zt(p.messages[0].data)[2][0].data),f=dt.find(c,l[g].location),h=zr(Wr(f.content)),y=0;y<h.length;++y)x=h[y],x.id==g&&(p=x);for(g=Nn(zt(p.messages[0].data)[2][0].data),f=dt.find(c,l[g].location),h=zr(Wr(f.content)),y=0;y<h.length;++y)x=h[y],x.id==g&&(p=x);var v=zt(p.messages[0].data);{v[6][0].data=it(i.e.r+1),v[7][0].data=it(i.e.c+1);var k=Nn(v[46][0].data),T=dt.find(c,l[k].location),m=zr(Wr(T.content));{for(var w=0;w<m.length&&m[w].id!=k;++w);if(m[w].id!=k)throw"Bad ColumnRowUIDMapArchive";var E=zt(m[w].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var b=0;b<=i.e.c;++b){var _=[];_[1]=_[2]=[{type:0,data:it(b+420690)}],E[1].push({type:2,data:Yt(_)}),E[2].push({type:0,data:it(b)}),E[3].push({type:0,data:it(b)})}E[4]=[],E[5]=[],E[6]=[];for(var A=0;A<=i.e.r;++A)_=[],_[1]=_[2]=[{type:0,data:it(A+726270)}],E[4].push({type:2,data:Yt(_)}),E[5].push({type:0,data:it(A)}),E[6].push({type:0,data:it(A)});m[w].messages[0].data=Yt(E)}T.content=mi(xi(m)),T.size=T.content.length,delete v[46];var S=zt(v[4][0].data);{S[7][0].data=it(i.e.r+1);var j=zt(S[1][0].data),C=Nn(j[2][0].data);T=dt.find(c,l[C].location),m=zr(Wr(T.content));{if(m[0].id!=C)throw"Bad HeaderStorageBucket";var P=zt(m[0].messages[0].data);for(A=0;A<a.length;++A){var M=zt(P[2][0].data);M[1][0].data=it(A),M[4][0].data=it(a[A].length),P[2][A]={type:P[2][0].type,data:Yt(M)}}m[0].messages[0].data=Yt(P)}T.content=mi(xi(m)),T.size=T.content.length;var X=Nn(S[2][0].data);T=dt.find(c,l[X].location),m=zr(Wr(T.content));{if(m[0].id!=X)throw"Bad HeaderStorageBucket";for(P=zt(m[0].messages[0].data),b=0;b<=i.e.c;++b)M=zt(P[2][0].data),M[1][0].data=it(b),M[4][0].data=it(i.e.r+1),P[2][b]={type:P[2][0].type,data:Yt(M)};m[0].messages[0].data=Yt(P)}T.content=mi(xi(m)),T.size=T.content.length;var ee=Nn(S[4][0].data);(function(){for(var U=dt.find(c,l[ee].location),O=zr(Wr(U.content)),I,W=0;W<O.length;++W){var J=O[W];J.id==ee&&(I=J)}var he=zt(I.messages[0].data);{he[3]=[];var ye=[];o.forEach(function(le,de){ye[1]=[{type:0,data:it(de)}],ye[2]=[{type:0,data:it(1)}],ye[3]=[{type:2,data:JT(le)}],he[3].push({type:2,data:Yt(ye)})})}I.messages[0].data=Yt(he);var H=xi(O),Y=mi(H);U.content=Y,U.size=U.content.length})();var q=zt(S[3][0].data);{var K=q[1][0];delete q[2];var Q=zt(K.data);{var ie=Nn(Q[2][0].data);(function(){for(var U=dt.find(c,l[ie].location),O=zr(Wr(U.content)),I,W=0;W<O.length;++W){var J=O[W];J.id==ie&&(I=J)}var he=zt(I.messages[0].data);{delete he[6],delete q[7];var ye=new Uint8Array(he[5][0].data);he[5]=[];for(var H=0,Y=0;Y<=i.e.r;++Y){var le=zt(ye);H+=r4(le,a[Y],o),le[1][0].data=it(Y),he[5].push({data:Yt(le),type:2})}he[1]=[{type:0,data:it(i.e.c+1)}],he[2]=[{type:0,data:it(i.e.r+1)}],he[3]=[{type:0,data:it(H)}],he[4]=[{type:0,data:it(i.e.r+1)}]}I.messages[0].data=Yt(he);var de=xi(O),G=mi(de);U.content=G,U.size=U.content.length})()}K.data=Yt(Q)}S[3][0].data=Yt(q)}v[4][0].data=Yt(S)}p.messages[0].data=Yt(v);var Z=xi(h),R=mi(Z);return f.content=R,f.size=f.content.length,c}function i4(e){return function(r){for(var i=0;i!=e.length;++i){var s=e[i];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function md(e){i4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function s4(e,t){return t.bookType=="ods"?_p(e,t):t.bookType=="numbers"?n4(e,t):t.bookType=="xlsb"?a4(e,t):o4(e,t)}function a4(e,t){ji=1024,e&&!e.SSF&&(e.SSF=jr(It)),e&&e.SSF&&(Mo(),Lo(e.SSF),t.revssf=Bo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,fs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",i=op.indexOf(t.bookType)>-1,s=Of();md(t=t||{});var a=ed(),o="",l=0;if(t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(a,o,$f(e.Props,t)),s.coreprops.push(o),st(t.rels,2,o,Je.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,qe(a,o,zf(e.Props)),s.extprops.push(o),st(t.rels,3,o,Je.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(a,o,Wf(e.Custprops)),s.custprops.push(o),st(t.rels,4,o,Je.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,qe(a,o,cT(l-1,o,t,e,u)),s.sheets.push(o),st(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Je.WS[0])}if(f){var p=f["!comments"],y=!1,x="";p&&p.length>0&&(x="xl/comments"+l+"."+r,qe(a,x,hT(p,x)),s.comments.push(x),st(u,-1,"../comments"+l+"."+r,Je.CMNT),y=!0),f["!legacy"]&&y&&qe(a,"xl/drawings/vmlDrawing"+l+".vml",sp(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&qe(a,Mf(o),Ci(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(a,o,uT(t.Strings,o,t)),s.strs.push(o),st(t.wbrels,-1,"sharedStrings."+r,Je.SST)),o="xl/workbook."+r,qe(a,o,lT(e,o)),s.workbooks.push(o),st(t.rels,1,o,Je.WB),o="xl/theme/theme1.xml",qe(a,o,np(e.Themes,t)),s.themes.push(o),st(t.wbrels,-1,"theme/theme1.xml",Je.THEME),o="xl/styles."+r,qe(a,o,dT(e,o,t)),s.styles.push(o),st(t.wbrels,-1,"styles."+r,Je.STY),e.vbaraw&&i&&(o="xl/vbaProject.bin",qe(a,o,e.vbaraw),s.vba.push(o),st(t.wbrels,-1,"vbaProject.bin",Je.VBA)),o="xl/metadata."+r,qe(a,o,fT(o)),s.metadata.push(o),st(t.wbrels,-1,"metadata."+r,Je.XLMETA),qe(a,"[Content_Types].xml",Lf(s,t)),qe(a,"_rels/.rels",Ci(t.rels)),qe(a,"xl/_rels/workbook."+r+".rels",Ci(t.wbrels)),delete t.revssf,delete t.ssf,a}function o4(e,t){ji=1024,e&&!e.SSF&&(e.SSF=jr(It)),e&&e.SSF&&(Mo(),Lo(e.SSF),t.revssf=Bo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,fs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",i=op.indexOf(t.bookType)>-1,s=Of();md(t=t||{});var a=ed(),o="",l=0;if(t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(a,o,$f(e.Props,t)),s.coreprops.push(o),st(t.rels,2,o,Je.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,qe(a,o,zf(e.Props)),s.extprops.push(o),st(t.rels,3,o,Je.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(a,o,Wf(e.Custprops)),s.custprops.push(o),st(t.rels,4,o,Je.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,qe(a,o,mp(l-1,t,e,f)),s.sheets.push(o),st(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Je.WS[0])}if(h){var y=h["!comments"],x=!1,g="";if(y&&y.length>0){var v=!1;y.forEach(function(k){k[1].forEach(function(T){T.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,qe(a,g,MS(y,u,t)),s.threadedcomments.push(g),st(f,-1,"../threadedComments/threadedComment"+l+"."+r,Je.TCMNT)),g="xl/comments"+l+"."+r,qe(a,g,ap(y)),s.comments.push(g),st(f,-1,"../comments"+l+"."+r,Je.CMNT),x=!0}h["!legacy"]&&x&&qe(a,"xl/drawings/vmlDrawing"+l+".vml",sp(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&qe(a,Mf(o),Ci(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(a,o,Qf(t.Strings,t)),s.strs.push(o),st(t.wbrels,-1,"sharedStrings."+r,Je.SST)),o="xl/workbook."+r,qe(a,o,vp(e)),s.workbooks.push(o),st(t.rels,1,o,Je.WB),o="xl/theme/theme1.xml",qe(a,o,np(e.Themes,t)),s.themes.push(o),st(t.wbrels,-1,"theme/theme1.xml",Je.THEME),o="xl/styles."+r,qe(a,o,tp(e,t)),s.styles.push(o),st(t.wbrels,-1,"styles."+r,Je.STY),e.vbaraw&&i&&(o="xl/vbaProject.bin",qe(a,o,e.vbaraw),s.vba.push(o),st(t.wbrels,-1,"vbaProject.bin",Je.VBA)),o="xl/metadata."+r,qe(a,o,ip()),s.metadata.push(o),st(t.wbrels,-1,"metadata."+r,Je.XLMETA),u.length>1&&(o="xl/persons/person.xml",qe(a,o,BS(u)),s.people.push(o),st(t.wbrels,-1,"persons/person.xml",Je.PEOPLE)),qe(a,"[Content_Types].xml",Lf(s,t)),qe(a,"_rels/.rels",Ci(t.rels)),qe(a,"xl/_rels/workbook."+r+".rels",Ci(t.wbrels)),delete t.revssf,delete t.ssf,a}function l4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_n(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Tp(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return $s(t.file,dt.write(e,{type:tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return dt.write(e,t)}function c4(e,t){var r=jr(t||{}),i=s4(e,r);return d4(i,r)}function d4(e,t){var r={},i=tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=i;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?dt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Oo(s))}return t.password&&typeof encrypt_agile<"u"?Tp(encrypt_agile(s,t.password),t):t.type==="file"?$s(t.file,s):t.type=="string"?cs(s):s}function u4(e,t){var r=t||{},i=AT(e,r);return Tp(i,r)}function tn(e,t,r){r||(r="");var i=r+e;switch(t.type){case"base64":return Es(Ts(i));case"binary":return Ts(i);case"string":return e;case"file":return $s(t.file,i,"utf8");case"buffer":return tt?kn(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):tn(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function h4(e,t){switch(t.type){case"base64":return Es(e);case"binary":return e;case"string":return e;case"file":return $s(t.file,e,"binary");case"buffer":return tt?kn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function va(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",i=0;i<e.length;++i)r+=String.fromCharCode(e[i]);return t.type=="base64"?Es(r):t.type=="string"?cs(r):r;case"file":return $s(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function gd(e,t){$b(),Q_(e);var r=jr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var i=gd(e,r);return r.type="array",Oo(i)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return tn(_T(e,r),r);case"slk":case"sylk":return tn(Yw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return tn(Sp(e.Sheets[e.SheetNames[s]],r),r);case"txt":return h4(Ap(e.Sheets[e.SheetNames[s]],r),r);case"csv":return tn(yd(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return tn(Xw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return va(Gw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return tn(Kw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return tn(nS.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return tn(Kf.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return tn(_p(e,r),r);case"wk1":return va(sh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return va(sh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),va(wp(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),u4(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return c4(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function f4(e,t,r,i,s,a,o,l){var d=Zt(r),c=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var y=o?e[r][p]:e[i[p]+d];if(y===void 0||y.t===void 0){if(c===void 0)continue;a[p]!=null&&(h[a[p]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(a[p]!=null){if(x==null)if(y.t=="e"&&x===null)h[a[p]]=null;else if(c!==void 0)h[a[p]]=c;else if(u&&x===null)h[a[p]]=null;else continue;else h[a[p]]=u&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?x:Tn(y,x,l);x!=null&&(f=!1)}}return{row:h,isempty:f}}function ho(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},i=0,s=1,a=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof u){case"string":d=mt(u);break;case"number":d=mt(e["!ref"]),d.s.r=u;break;default:d=u}i>0&&(s=0);var f=Zt(d.s.r),h=[],p=[],y=0,x=0,g=Array.isArray(e),v=d.s.r,k=0,T={};g&&!e[v]&&(e[v]=[]);var m=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(k=d.s.c;k<=d.e.c;++k)if(!(m[k]||{}).hidden)switch(h[k]=dr(k),r=g?e[v][k]:e[h[k]+f],i){case 1:a[k]=k-d.s.c;break;case 2:a[k]=h[k];break;case 3:a[k]=c.header[k-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Tn(r,null,c),x=T[o]||0,!x)T[o]=1;else{do l=o+"_"+x++;while(T[l]);T[o]=x,T[l]=1}a[k]=l}for(v=d.s.r+s;v<=d.e.r;++v)if(!(w[v]||{}).hidden){var E=f4(e,d,v,h,i,a,g,c);(E.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(p[y++]=E.row)}return p.length=y,p}var fh=/"/g;function p4(e,t,r,i,s,a,o,l){for(var d=!0,c=[],u="",f=Zt(r),h=t.s.c;h<=t.e.c;++h)if(i[h]){var p=l.dense?(e[r]||[])[h]:e[i[h]+f];if(p==null)u="";else if(p.v!=null){d=!1,u=""+(l.rawNumbers&&p.t=="n"?p.v:Tn(p,null,l));for(var y=0,x=0;y!==u.length;++y)if((x=u.charCodeAt(y))===s||x===a||x===34||l.forceQuotes){u='"'+u.replace(fh,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(d=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(fh,'""')+'"')):u="";c.push(u)}return l.blankrows===!1&&d?null:c.join(o)}function yd(e,t){var r=[],i=t??{};if(e==null||e["!ref"]==null)return"";var s=mt(e["!ref"]),a=i.FS!==void 0?i.FS:",",o=a.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,d=l.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",f=[];i.dense=Array.isArray(e);for(var h=i.skipHidden&&e["!cols"]||[],p=i.skipHidden&&e["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(h[y]||{}).hidden||(f[y]=dr(y));for(var x=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(u=p4(e,s,g,f,o,d,a,i),u!=null&&(i.strip&&(u=u.replace(c,"")),(u||i.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete i.dense,r.join("")}function Ap(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=yd(e,t);return r}function x4(e){var t="",r,i="";if(e==null||e["!ref"]==null)return[];var s=mt(e["!ref"]),a="",o=[],l,d=[],c=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=dr(l);for(var u=s.s.r;u<=s.e.r;++u)for(a=Zt(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,r=c?(e[u]||[])[l]:e[t],i="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;i=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)i=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}d[d.length]=t+"="+i}return d}function kp(e,t,r){var i=r||{},s=+!i.skipHeader,a=e||{},o=0,l=0;if(a&&i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var d=typeof i.origin=="string"?Vt(i.origin):i.origin;o=d.r,l=d.c}var c,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(a["!ref"]){var f=mt(a["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=i.header||[],p=0;t.forEach(function(x,g){er(x).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var k=x[v],T="z",m="",w=ot({c:l+p,r:o+g+s});c=Cs(a,w),k&&typeof k=="object"&&!(k instanceof Date)?a[w]=k:(typeof k=="number"?T="n":typeof k=="boolean"?T="b":typeof k=="string"?T="s":k instanceof Date?(T="d",i.cellDates||(T="n",k=Sr(k)),m=i.dateNF||It[14]):k===null&&i.nullError&&(T="e",k=0),c?(c.t=T,c.v=k,delete c.w,delete c.R,m&&(c.z=m)):a[w]=c={t:T,v:k},m&&(c.z=m))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var y=Zt(o);if(s)for(p=0;p<h.length;++p)a[dr(p+l)+y]={t:"s",v:h[p]};return a["!ref"]=Lt(u),a}function m4(e,t){return kp(null,e,t)}function Cs(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var i=Vt(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Cs(e,ot(t)):Cs(e,ot({r:t,c:r||0}))}function g4(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function y4(){return{SheetNames:[],Sheets:{}}}function v4(e,t,r,i){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(yp(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function b4(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=g4(e,t);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[i].Hidden=r}function w4(e,t){return e.z=t,e}function Cp(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function S4(e,t,r){return Cp(e,"#"+t,r)}function j4(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function E4(e,t,r,i){for(var s=typeof t!="string"?t:mt(t),a=typeof t=="string"?t:Lt(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var d=Cs(e,o,l);d.t="n",d.F=a,delete d.v,o==s.s.r&&l==s.s.c&&(d.f=r,i&&(d.D=!0))}return e}var Fi={encode_col:dr,encode_row:Zt,encode_cell:ot,encode_range:Lt,decode_col:ad,decode_row:sd,split_cell:$2,decode_cell:Vt,decode_range:Rr,format_cell:Tn,sheet_add_aoa:If,sheet_add_json:kp,sheet_add_dom:jp,aoa_to_sheet:Ui,json_to_sheet:m4,table_to_sheet:Ep,table_to_book:XT,sheet_to_csv:yd,sheet_to_txt:Ap,sheet_to_json:ho,sheet_to_html:Sp,sheet_to_formulae:x4,sheet_to_row_object_array:ho,sheet_get_cell:Cs,book_new:y4,book_append_sheet:v4,book_set_sheet_visibility:b4,cell_set_number_format:w4,cell_set_hyperlink:Cp,cell_set_internal_link:S4,cell_add_comment:j4,sheet_set_array_formula:E4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ip={exports:{}};(function(e,t){(function(r,i){i()})(wi,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function i(c,u,f){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){d(h.response,u,f)},h.onerror=function(){console.error("could not download file")},h.send()}function s(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof wi=="object"&&wi.global===wi?wi:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,u,f){var h=o.URL||o.webkitURL,p=document.createElement("a");u=u||c.name||"download",p.download=u,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?a(p):s(p.href)?i(c,u,f):a(p,p.target="_blank")):(p.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,f){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,f),u);else if(s(c))i(c,u,f);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){a(h)})}}:function(c,u,f,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return i(c,u,f);var p=c.type==="application/octet-stream",y=/constructor/i.test(o.HTMLElement)||o.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||p&&y||l)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var T=g.result;T=x?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=T:location=T,h=null},g.readAsDataURL(c)}else{var v=o.URL||o.webkitURL,k=v.createObjectURL(c);h?h.location=k:location.href=k,h=null,setTimeout(function(){v.revokeObjectURL(k)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})})(Ip);var Np=Ip.exports;const{Title:vk,Text:Wt}=Ue,_4=({selectedBooking:e,isDetailsModalVisible:t,setIsDetailsModalVisible:r,setSelectedBooking:i,setIsStatusModalVisible:s,setSelectedStatus:a,setRejectionReasonText:o,formatBookingNumber:l})=>n.jsx(pt,{title:"Booking Details",open:t,onCancel:()=>{r(!1),i(null)},footer:[n.jsx(fe,{type:"primary",disabled:!e,onClick:()=>{e&&(a(e.status),o(e.rejectionReason||""),s(!0))},children:"Update Status"},"updateStatus"),n.jsx(fe,{onClick:()=>{r(!1),i(null)},children:"Close"},"close")],width:800,children:e&&n.jsxs(ke,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(Xe,{bordered:!0,column:2,children:[n.jsxs(Xe.Item,{label:"Booking Number",span:2,children:[l(e._id,e.createdAt),n.jsxs(Wt,{type:"secondary",style:{marginLeft:8,fontSize:"12px"},children:["(ID: ",e._id,")"]})]}),n.jsx(Xe.Item,{label:"Exhibition",span:2,children:e.exhibitionId.name}),n.jsxs(Xe.Item,{label:"Status",span:2,children:[n.jsx(Ne,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()}),e.rejectionReason&&n.jsxs("div",{style:{marginTop:8},children:[n.jsx(Wt,{type:"secondary",children:"Rejection Reason:"}),n.jsx("br",{}),n.jsx(Wt,{children:e.rejectionReason})]})]}),n.jsx(Xe.Item,{label:"Customer Name",children:e.customerName}),n.jsx(Xe.Item,{label:"Customer Email",children:e.customerEmail}),n.jsx(Xe.Item,{label:"Customer Phone",children:e.customerPhone}),n.jsx(Xe.Item,{label:"Company Name",children:e.companyName})]}),n.jsx(Ae,{title:"Stall Details",size:"small",children:n.jsx(ft,{dataSource:e.stallIds,pagination:!1,rowKey:"_id",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:d=>d.type||"-"},{title:"Dimensions",key:"dimensions",render:d=>n.jsx(Ne,{color:"blue",children:d.dimensions?`${d.dimensions.width}x${d.dimensions.height}m`:"No dimensions"})},{title:"Rate (per sqm)",dataIndex:"ratePerSqm",key:"rate",render:d=>`₹${d.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:d=>{const c=e.calculations.stalls.find(u=>u.stallId===d._id);return c?`₹${c.baseAmount.toLocaleString()}`:"-"}},{title:"Discount",key:"discount",render:d=>{const c=e.calculations.stalls.find(u=>u.stallId===d._id);return c!=null&&c.discount?n.jsx(ht,{title:n.jsx("div",{children:c.discount.type==="percentage"&&` (${c.discount.value}%)`}),children:n.jsxs(Ne,{color:"red",children:["-₹",c.discount.amount.toLocaleString(),c.discount.type==="percentage"&&` (${c.discount.value}%)`]})}):"-"}}]})}),n.jsx(Ae,{title:"Financial Summary",size:"small",children:n.jsxs(ke,{direction:"vertical",style:{width:"100%"},size:"small",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Wt,{children:"Total Base Amount:"}),n.jsxs(Wt,{children:["₹",e.calculations.totalBaseAmount.toLocaleString()]})]}),e.calculations.totalDiscountAmount>0&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Wt,{children:"Total Discount:"}),n.jsxs(Wt,{type:"danger",children:["-₹",e.calculations.totalDiscountAmount.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Wt,{children:"Amount after Discount:"}),n.jsxs(Wt,{children:["₹",e.calculations.totalAmountAfterDiscount.toLocaleString()]})]}),n.jsx(Tt,{style:{margin:"8px 0"}}),e.calculations.taxes.map(d=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Wt,{children:[d.name," (",d.rate,"%):"]}),n.jsxs(Wt,{children:["₹",d.amount.toLocaleString()]})]},`tax-${d.name}-${d.rate}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(Wt,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(Wt,{strong:!0,children:["₹",e.amount.toLocaleString()]})]})]})})]})}),T4=({selectedBooking:e,isStatusModalVisible:t,setIsStatusModalVisible:r,selectedStatus:i,setSelectedStatus:s,rejectionReasonText:a,setRejectionReasonText:o,formatBookingNumber:l,refreshAfterAction:d})=>{const c=hr(),[u,f]=_t.useState(!1),{refetch:h}=Do({page:1,limit:100}),p=async(x,g,v)=>{try{f(!0),await c(Pa({id:x,status:g,...v&&{rejectionReason:v}})).unwrap(),Se.success(`Booking ${g} successfully`),d(),r(!1),y(null),g==="approved"&&setTimeout(async()=>{await h()},1e3)}catch{Se.error("Failed to update booking status")}finally{f(!1)}},y=x=>{};return n.jsx(pt,{title:"Update Booking Status",open:t,onCancel:()=>{r(!1),o("")},footer:null,width:600,children:e&&n.jsxs("div",{children:[n.jsx(Ae,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(Qn,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Booking Information"})]}),style:{marginBottom:16},variant:"borderless",size:"small",children:n.jsxs(ke,{direction:"vertical",size:8,style:{width:"100%"},children:[n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(Ne,{color:"processing",children:l(e._id,e.createdAt)}),n.jsx(Ne,{color:"default",children:e.exhibitionId.name}),n.jsx(Ne,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()})]}),n.jsxs("div",{style:{marginTop:"8px"},children:[n.jsx(Wt,{strong:!0,children:"Stall Details:"}),n.jsx("div",{style:{marginTop:"4px"},children:e.stallIds.map((x,g)=>n.jsxs(Ne,{style:{margin:"2px"},children:["#",x.number," ",x.type&&`(${x.type})`]},x._id))})]}),n.jsx(Tt,{style:{margin:"8px 0"}}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(Wt,{strong:!0,style:{minWidth:"120px"},children:"Company:"}),n.jsx(Wt,{children:e.companyName})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:[n.jsx(Wt,{strong:!0,style:{minWidth:"120px"},children:"Current Status:"}),n.jsx(Ne,{color:e.status==="confirmed"?"success":e.status==="approved"?"blue":e.status==="pending"?"warning":e.status==="rejected"?"error":"default",children:e.status.toUpperCase()})]})]})}),n.jsxs(Ae,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(po,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),variant:"borderless",size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Wt,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(yr.Group,{value:i,onChange:x=>s(x.target.value),buttonStyle:"solid",style:{display:"flex",flexWrap:"nowrap",overflowX:"auto"},children:[n.jsx(yr.Button,{value:"pending",style:{flex:"0 0 auto"},children:n.jsxs(ke,{children:[n.jsx(br,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(yr.Button,{value:"approved",style:{flex:"0 0 auto"},children:n.jsxs(ke,{children:[n.jsx(Nt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(yr.Button,{value:"rejected",style:{flex:"0 0 auto"},children:n.jsxs(ke,{children:[n.jsx(Kr,{style:{color:"#f5222d"}}),"Rejected"]})}),n.jsx(yr.Button,{value:"confirmed",style:{flex:"0 0 auto"},children:n.jsxs(ke,{children:[n.jsx(Nt,{style:{color:"#1890ff"}}),"Confirmed"]})}),n.jsx(yr.Button,{value:"cancelled",style:{flex:"0 0 auto"},children:n.jsxs(ke,{children:[n.jsx(Kr,{style:{color:"#ff7875"}}),"Cancelled"]})})]})})]}),i==="rejected"&&n.jsx("div",{children:n.jsx(oe.Item,{label:n.jsx(Wt,{strong:!0,children:"Rejection Reason:"}),required:i==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the customer",children:n.jsx(Re.TextArea,{rows:4,value:a,onChange:x=>o(x.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),i==="approved"&&n.jsx(Ct,{message:"Approval Confirmation",description:"By approving this booking, the stalls will be reserved but not yet confirmed. Customer will be notified.",type:"success",showIcon:!0,style:{marginTop:8}}),i==="confirmed"&&n.jsx(Ct,{message:"Confirmation Notice",description:"By confirming this booking, the stalls will be marked as booked. This should be done after payment is received.",type:"info",showIcon:!0,style:{marginTop:8}}),i==="cancelled"&&n.jsx(Ct,{message:"Cancellation Warning",description:"By cancelling this booking, all stalls will be marked as available again.",type:"warning",showIcon:!0,style:{marginTop:8}}),i==="pending"&&n.jsx(Ct,{message:"Return to Pending",description:"This booking will be moved back to pending status.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(fe,{onClick:()=>{r(!1),o("")},children:"Cancel"}),n.jsx(fe,{type:"primary",onClick:()=>{if(i==="rejected"&&!a.trim()){Se.error("Rejection reason is required when rejecting a booking");return}p(e._id,i,i==="rejected"?a:void 0)},loading:u,disabled:i==="rejected"&&!a.trim(),children:"Update Status"})]})]})]})})},A4=(e,t,r)=>{pt.confirm({title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[n.jsx(En,{style:{color:"#F04438",fontSize:"22px"}}),n.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Booking"})]}),content:n.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[n.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete booking ",n.jsx("strong",{children:r(e._id,e.createdAt)}),"?"]}),n.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data including invoices."})]}),footer:n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[n.jsx(fe,{onClick:()=>pt.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),n.jsx(fe,{danger:!0,type:"primary",onClick:()=>{t(e._id),pt.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},k4=e=>{const t=tr(),{data:r,isLoading:i,error:s,refetch:a}=Do({page:1,limit:100}),o=d=>{if(i||s||!r)return null;const u=(r.data||[]).find(f=>f.bookingId&&typeof f.bookingId=="object"&&f.bookingId._id===d);return u==null?void 0:u._id},l=async d=>{if(i){Se.loading("Loading invoice data...");return}let c=o(d._id);if(c)t(`/invoice/${c}`);else{const u="invoice-loading";if(Se.loading({content:"Checking for invoice...",key:u}),await a(),c=o(d._id),c){Se.success({content:"Invoice found!",key:u,duration:1}),t(`/invoice/${c}`);return}const f=new Date(d.createdAt),h=new Date(Date.now()-30*60*1e3);if(f>h||d.status==="approved"){Se.info({content:"Invoice is still being generated. Checking again in a moment...",key:u});let y=0;const x=5,g=[2e3,3e3,5e3,8e3,1e4],v=async()=>{y++,await a();const k=o(d._id);if(k)Se.success({content:"Invoice is ready!",key:u,duration:1}),t(`/invoice/${k}`);else if(y<x){const T=g[y]||5e3,m=T/1e3;Se.info({content:`Attempt ${y}/${x}: Invoice not ready yet. Trying again in ${m} seconds...`,key:u}),setTimeout(v,T)}else Se.warning({content:"Invoice generation is taking longer than expected. Please try refreshing the page in a few moments.",key:u})};setTimeout(v,g[0])}else Se.error({content:"No invoice found for this booking. Please contact support if this persists.",key:u})}};return[{title:"Booking Number",dataIndex:"_id",key:"bookingNumber",fixed:"left",width:170,render:(d,c)=>n.jsx(fe,{type:"link",onClick:()=>{e.setSelectedBooking(c),e.setIsDetailsModalVisible(!0)},children:e.formatBookingNumber(d,c.createdAt)})},{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibition",width:250,render:(d,c)=>c.exhibitionId.name},{title:"Company Name",dataIndex:"companyName",key:"company",width:250,render:d=>d||"N/A"},{title:"Stall No.",key:"stallNumber",width:120,render:(d,c)=>n.jsx("span",{children:c.stallIds.map((u,f)=>n.jsxs("span",{children:[u.number,f<c.stallIds.length-1?", ":""]},`stall-${u._id||f}`))})},{title:"Stall Type",key:"stallType",width:120,render:(d,c)=>{const u=Array.from(new Set(c.stallIds.map(f=>f.type)));return n.jsx("span",{children:u.map((f,h)=>n.jsxs("span",{children:[f,h<u.length-1?", ":""]},`type-${f}-${h}`))})}},{title:"Dimensions",key:"dimensions",width:150,render:(d,c)=>n.jsx("span",{children:c.stallIds.map((u,f)=>n.jsxs("span",{children:[u.dimensions?`${u.dimensions.width}m × ${u.dimensions.height}m`:"No dimensions",f<c.stallIds.length-1?", ":""]},`dim-${u._id||f}`))})},{title:"Area (sqm)",key:"area",width:120,render:(d,c)=>{const u=c.stallIds.reduce((f,h)=>h.dimensions?f+h.dimensions.width*h.dimensions.height:f,0);return n.jsxs("span",{children:[Math.round(u)," sqm"]})}},{title:"Base Amount",dataIndex:["calculations","totalBaseAmount"],key:"baseAmount",width:150,render:d=>`₹${d.toLocaleString()}`},{title:"Discount",key:"discount",width:150,render:(d,c)=>{const u=c.calculations.totalDiscountAmount;if(!u||u===0)return"-";const f=c.calculations.stalls.filter(p=>p.discount).map(p=>p.discount);if(f.length===0)return"-";const h=f[0];return n.jsx(ht,{title:n.jsx("div",{children:f.map((p,y)=>n.jsxs("div",{children:[p==null?void 0:p.name,": ",(p==null?void 0:p.type)==="percentage"?`${p==null?void 0:p.value}%`:`₹${p==null?void 0:p.value}`,n.jsx("br",{}),"Amount: ₹",p==null?void 0:p.amount.toLocaleString()]},`discount-${y}-${(p==null?void 0:p.name)||"unnamed"}`))}),children:n.jsxs(Ne,{color:"red",children:["-₹",u.toLocaleString(),(h==null?void 0:h.type)==="percentage"&&` (${h.value}%)`,f.length>1&&" +"]})})}},{title:"Total Amount",dataIndex:"amount",key:"amount",width:150,render:d=>`₹${d.toLocaleString()}`},{title:"Status",dataIndex:"status",key:"status",width:120,render:d=>n.jsx(Ne,{color:d==="confirmed"?"success":d==="approved"?"blue":d==="pending"?"warning":d==="rejected"?"error":"default",children:d.toUpperCase()})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",width:200,render:d=>St(d).format("MMM D, YYYY HH:mm")},{title:"Actions",key:"actions",fixed:"right",width:220,render:(d,c)=>n.jsxs(ke,{children:[n.jsx(ht,{title:"View Details",children:n.jsx(fe,{icon:n.jsx(Ds,{}),onClick:()=>{e.setSelectedBooking(c),e.setIsDetailsModalVisible(!0)}})}),n.jsx(ni,{overlay:n.jsxs(cr,{children:[c.status!=="cancelled"&&e.hasPermission("view_bookings")&&n.jsx(cr.Item,{icon:n.jsx(Qn,{}),disabled:i,onClick:()=>l(c),children:"View Invoice"},"invoice"),n.jsx(cr.Item,{icon:n.jsx(Nt,{}),onClick:()=>{e.setSelectedBooking(c),e.setSelectedStatus(c.status),e.setRejectionReasonText(c.rejectionReason||""),e.setIsStatusModalVisible(!0)},children:"Update Status"},"updateStatus"),e.hasPermission("bookings_delete")&&n.jsx(cr.Item,{icon:n.jsx(En,{}),danger:!0,onClick:()=>{A4(c,e.handleDelete,e.formatBookingNumber)},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(fe,{icon:n.jsx(Oh,{})})})]})}]},C4=e=>{const{bookings:t,loading:r,pagination:i,fetchBookingsWithPagination:s}=e,a=k4(e),o=(l,d,c,u)=>n.jsx("div",{className:"ant-table-pagination ant-table-pagination-right",style:{padding:"16px 24px",margin:0,display:"flex",justifyContent:"flex-end"},children:n.jsx(Ox,{current:l,pageSize:d,total:c,showTotal:f=>`Total ${f} items`,showSizeChanger:!0,pageSizeOptions:["5","10","20","50","100"],onChange:f=>u(f,d),onShowSizeChange:(f,h)=>u(f,h),size:"default"})});return n.jsxs(n.Fragment,{children:[n.jsx(ft,{columns:a,dataSource:t,loading:r,rowKey:"_id",scroll:{x:1800},pagination:!1}),o(i.page,i.limit,i.total,(l,d)=>s(l,d))]})},{Title:I4,Text:N4}=Ue,F4=()=>{const e=hr(),{bookings:t,loading:r,pagination:i,stats:s,statsLoading:a}=ut(q=>q.booking),{exhibitions:o}=ut(q=>q.exhibition),[l,d]=N.useState(null),[c,u]=N.useState(!1),[f,h]=N.useState(!1),[p,y]=N.useState("pending"),[x,g]=N.useState(""),[v,k]=N.useState({search:"",status:[],dateRange:null,exhibition:null}),T=tr(),{data:m,isLoading:w,error:E,refetch:b}=Do({page:1,limit:100}),{hasPermission:_}=Lb(),A=N.useCallback((q=1,K=10)=>{const Q={page:q,limit:K};v.search&&(Q.search=v.search),v.exhibition&&(Q.exhibitionId=v.exhibition),v.status&&v.status.length>0&&(Q.status=v.status),v.dateRange&&v.dateRange.length===2&&(Q.startDate=v.dateRange[0],Q.endDate=v.dateRange[1]),e(os(Q))},[e,v]),S=N.useCallback(()=>{e(Oa())},[e]),j=N.useCallback(()=>{A(i.page,i.limit),S()},[A,S,i.page,i.limit]);N.useEffect(()=>{A(i.page,i.limit),S()},[A,S,i.page,i.limit]),N.useEffect(()=>{e(Yn())},[e]),N.useEffect(()=>{t.length>0&&[...new Set(t.map(K=>K.exhibitionId._id))].forEach(K=>{e(La(K))})},[t,e]);const C=async q=>{try{await e(Da(q)).unwrap(),Se.success("Booking deleted successfully"),j()}catch(K){Se.error((K==null?void 0:K.message)||"Failed to delete booking")}},P=q=>{k(q),A(1,i.limit)},M=Array.isArray(t)?t:[],X=(q,K)=>{const Q=new Date(K).getFullYear(),ie=M.find(W=>W._id===q);if(!ie)return`--/${Q}/--`;const U=(M.filter(W=>W.exhibitionId._id===ie.exhibitionId._id).sort((W,J)=>new Date(W.createdAt).getTime()-new Date(J.createdAt).getTime()).findIndex(W=>W._id===q)+1).toString().padStart(2,"0"),O=o.find(W=>W._id===ie.exhibitionId._id);return`${(O==null?void 0:O.invoicePrefix)||ie.exhibitionId.invoicePrefix||"BK"}/${Q}/${U}`},ee=async()=>{try{Se.loading({content:"Preparing export...",key:"export"});const q={};v.search&&(q.search=v.search),v.exhibition&&(q.exhibitionId=v.exhibition),v.status&&v.status.length>0&&(q.status=v.status),v.dateRange&&v.dateRange.length===2&&(q.startDate=v.dateRange[0],q.endDate=v.dateRange[1]);const Q=(await Pe.get("/bookings/export",{params:q})).data;if(!Array.isArray(Q))throw new Error("Invalid data format received");const ie=Q.map(W=>{const J=W.stallIds.reduce((he,ye)=>ye.dimensions?he+ye.dimensions.width*ye.dimensions.height:he,0);return{"Booking Number":X(W._id,W.createdAt),Exhibition:W.exhibitionId.name,"Company Name":W.companyName||"N/A","Customer Name":W.customerName,"Customer Email":W.customerEmail,"Customer Phone":W.customerPhone,"Stall Numbers":W.stallIds.map(he=>he.number).join(", "),"Stall Types":Array.from(new Set(W.stallIds.map(he=>he.type||(he.stallTypeId&&typeof he.stallTypeId=="object"?he.stallTypeId.name:"-")))).join(", "),Dimensions:W.stallIds.map(he=>he.dimensions?`${he.dimensions.width}m × ${he.dimensions.height}m`:"No dimensions").join(", "),"Total Area (sqm)":Math.round(J),"Base Amount":Math.round(W.calculations.totalBaseAmount),Discount:Math.round(W.calculations.totalDiscountAmount),"Total Amount":Math.round(W.calculations.totalAmount),Status:W.status.toUpperCase(),"Created Date":new Date(W.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}}),Z=Fi.json_to_sheet(ie),R=Fi.book_new();Fi.book_append_sheet(R,Z,"Bookings");const U=gd(R,{bookType:"xlsx",type:"array"}),O=new Blob([U],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),I=new Date().toISOString().split("T")[0];Np.saveAs(O,`bookings_export_${I}.xlsx`),Se.success({content:"Export successful!",key:"export",duration:2})}catch(q){console.error("Export error:",q),Se.error({content:"Failed to export bookings",key:"export",duration:2})}};return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(ze,{gutter:[24,24],align:"middle",children:[n.jsx(ae,{flex:"auto",children:n.jsxs(ke,{direction:"vertical",size:4,children:[n.jsx(I4,{level:4,style:{margin:0},children:"Stall Bookings"}),n.jsx(N4,{type:"secondary",children:"Manage exhibition stall bookings"})]})}),n.jsx(ae,{children:n.jsxs(ke,{children:[n.jsx(fe,{icon:n.jsx(Os,{}),onClick:ee,size:"large",children:"Export"}),n.jsx(fe,{type:"primary",size:"large",icon:n.jsx(Lh,{}),onClick:()=>T("/bookings/create"),children:"Create Booking"})]})})]})}),n.jsx(Pb,{bookings:t,paginationTotal:i.total,stats:s,statsLoading:a}),n.jsx(Ob,{filters:v,exhibitions:o,onFilterChange:P,onRefresh:j}),n.jsx(Ae,{className:"info-card",styles:{body:{padding:0,overflow:"auto"},header:{paddingBottom:12}},title:"Booking List",children:n.jsx(C4,{bookings:M,loading:r,fetchBookingsWithPagination:A,pagination:i,setSelectedBooking:d,setIsDetailsModalVisible:u,setIsStatusModalVisible:h,setSelectedStatus:y,setRejectionReasonText:g,formatBookingNumber:X,handleDelete:C,hasPermission:_})}),n.jsx(_4,{selectedBooking:l,isDetailsModalVisible:c,setIsDetailsModalVisible:u,setSelectedBooking:d,setIsStatusModalVisible:h,setSelectedStatus:y,setRejectionReasonText:g,formatBookingNumber:X}),n.jsx(T4,{selectedBooking:l,isStatusModalVisible:f,setIsStatusModalVisible:h,selectedStatus:p,setSelectedStatus:y,rejectionReasonText:x,setRejectionReasonText:g,formatBookingNumber:X,refreshAfterAction:j})]})},R4={exhibitors:[],loading:!1,error:null},ln=Ye("exhibitors/fetchAll",async(e,{rejectWithValue:t})=>{var r,i;try{return(await lr.getExhibitors()).data}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch exhibitors")}}),P4=gr({name:"exhibitor",initialState:R4,reducers:{},extraReducers:e=>{e.addCase(ln.pending,t=>{t.loading=!0,t.error=null}).addCase(ln.fulfilled,(t,r)=>{t.exhibitors=r.payload,t.loading=!1}).addCase(ln.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),D4=P4.reducer,{Title:O4,Text:Jr}=Ue,L4=()=>{var J,he,ye;const[e]=oe.useForm(),[t]=oe.useForm(),[r,i]=N.useState(!1),[s,a]=N.useState([]),[o,l]=N.useState(!1),[d,c]=N.useState([]),[u,f]=N.useState(null),[h,p]=N.useState(),[y,x]=N.useState([]),[g,v]=N.useState({}),[k,T]=N.useState([]),[m,w]=N.useState(0),E=tr(),b=hr(),{loading:_}=ut(H=>H.booking),{exhibitions:A=[],loading:S}=ut(H=>H.exhibition),{exhibitors:j=[],loading:C}=ut(H=>H.exhibitor),{isAuthenticated:P}=ut(H=>H.auth);N.useEffect(()=>{if(!P){Se.error("Please login to create a booking"),E("/login");return}b(Yn()),b(ln())},[b,P,E]);const M=async H=>{try{l(!0),e.setFieldValue("stallIds",[]),e.setFieldValue("discountId",void 0),e.setFieldValue("extraAmenities",[]),c([]),x([]),T([]),w(0);const Y=await Fr.getExhibition(H);f(Y.data);const de=(await Fr.getStalls(H)).data.filter(G=>G.status==="available");a(de)}catch(Y){console.error("Failed to fetch exhibition data:",Y),Se.error("Failed to fetch exhibition data")}finally{l(!1)}},X=H=>Math.round(H.ratePerSqm*H.dimensions.width*H.dimensions.height*100)/100,ee=H=>{var de;const Y=s.filter(G=>{const xe=G._id||G.id;return xe&&H.includes(xe)});c(Y);const le=Y.reduce((G,xe)=>G+xe.dimensions.width*xe.dimensions.height,0);if(w(le),(de=u==null?void 0:u.basicAmenities)!=null&&de.length){const G=u.basicAmenities.map(xe=>{const ge=Math.floor(le/xe.perSqm)*xe.quantity;return{...xe,calculatedQuantity:ge>0?ge:0,key:xe._id||xe.id}});T(G)}},q=(H,Y,le)=>{if(!(le!=null&&le.isActive))return 0;let de=0;if(le.type==="percentage")de=H*(Math.max(0,Math.min(100,le.value))/100);else{const G=H/Y*le.value;de=Math.min(G,H)}return Math.round(de*100)/100},K=async H=>{var Y,le;try{const de=j.find(Oe=>Oe._id===H.exhibitorId);if(!de)throw new Error("Selected exhibitor not found");const[G,xe,ge]=H.discountId?H.discountId.split("-"):[],me=(Y=u==null?void 0:u.discountConfig)==null?void 0:Y.find(Oe=>`${Oe.name}-${Oe.value}-${Oe.type}`===H.discountId),Te=d.map(Oe=>{const Qe=Oe._id||Oe.id;if(!Qe)throw new Error(`Invalid stall ID for stall number ${Oe.number}`);return{stall:Oe,stallId:Qe,baseAmount:X(Oe)}}),ue=Te.reduce((Oe,{baseAmount:Qe})=>Oe+Qe,0),Me=Te.map(({stall:Oe,stallId:Qe,baseAmount:gt})=>{const Er=me?q(gt,ue,me):0;return{stallId:Qe,number:Oe.number,baseAmount:gt,discount:me?{name:me.name,type:me.type,value:me.value,amount:Er}:void 0,amountAfterDiscount:Math.round((gt-Er)*100)/100}}),$e=Me.reduce((Oe,Qe)=>{var gt;return Oe+(((gt=Qe.discount)==null?void 0:gt.amount)||0)},0),ct=Math.round((ue-$e)*100)/100,rt=((le=u==null?void 0:u.taxConfig)==null?void 0:le.filter(Oe=>Oe.isActive).map(Oe=>({name:Oe.name,rate:Oe.rate,amount:Math.round(ct*Oe.rate/100*100)/100})))||[],Ie=rt.reduce((Oe,Qe)=>Oe+Qe.amount,0),Be=Math.round((ct+Ie)*100)/100,Ve={exhibitionId:H.exhibitionId,exhibitorId:H.exhibitorId,stallIds:Me.map(Oe=>Oe.stallId),customerName:de.contactPerson,customerEmail:de.email,customerPhone:de.phone,customerAddress:de.address||"N/A",customerGSTIN:de.gstNumber||"N/A",customerPAN:de.panNumber||"N/A",companyName:de.companyName,discount:me?{name:me.name,type:me.type,value:me.value}:void 0,amount:Be,calculations:{stalls:Me,totalBaseAmount:ue,totalDiscountAmount:$e,totalAmountAfterDiscount:ct,taxes:rt,totalTaxAmount:Ie,totalAmount:Be}};k.length&&(Ve.basicAmenities=k.filter(Oe=>Oe.calculatedQuantity>0).map(Oe=>({name:Oe.name,type:Oe.type,perSqm:Oe.perSqm,quantity:Oe.quantity,calculatedQuantity:Oe.calculatedQuantity,description:Oe.description}))),y.length&&(Ve.extraAmenities=O());const Le=await b(Ra(Ve)).unwrap();Le&&Le.invoiceId?(Se.success("Booking created successfully! Redirecting to invoice..."),setTimeout(()=>{E(`/invoice/${Le.invoiceId}`)},2e3)):(Se.success("Booking created successfully"),E("/bookings")),Le&&Le.warning&&Se.warning(Le.warning)}catch(de){console.error("Error creating booking:",de),Se.error("Failed to create booking")}},Q=async H=>{try{const Y=await lr.createExhibitor(H);Se.success("Exhibitor added successfully"),b(ln()),e.setFieldsValue({exhibitorId:Y.data._id}),i(!1),t.resetFields()}catch(Y){const le=(Y==null?void 0:Y.message)||"Failed to add exhibitor";Se.error(le),le==="User with this email already exists"&&t.setFields([{name:"contactEmail",errors:["This email is already registered"]}])}},ie=A.map(H=>({label:H.name,value:H._id||H.id})),Z=j.map(H=>({label:H.companyName,value:H._id}));s.map(H=>({label:`Stall ${H.number} (${H.dimensions.width}m × ${H.dimensions.height}m = ${(H.dimensions.width*H.dimensions.height).toFixed(2)} sqm) - ₹${H.ratePerSqm.toLocaleString()}/sq.m`,value:H._id||H.id}));const R=H=>{p(H),e.setFieldValue("discountId",H)},U=()=>{var me,Te;const H=d.reduce((ue,Me)=>ue+X(Me),0),Y=(me=u==null?void 0:u.discountConfig)==null?void 0:me.find(ue=>`${ue.name}-${ue.value}-${ue.type}`===h&&ue.isActive),le=Y?Y.type==="percentage"?Math.round(H*Y.value/100*100)/100:Math.min(Y.value,H):0,de=Math.round((H-le)*100)/100,G=((Te=u==null?void 0:u.taxConfig)==null?void 0:Te.filter(ue=>ue.isActive).map(ue=>({name:ue.name,rate:ue.rate,amount:Math.round(de*ue.rate/100*100)/100})))||[],xe=G.reduce((ue,Me)=>ue+Me.amount,0),ge=Math.round((de+xe)*100)/100;return{baseAmount:H,selectedDiscount:Y,discountAmount:le,amountAfterDiscount:de,taxes:G,totalTaxAmount:xe,totalAmount:ge}},O=()=>{var H;return(H=u==null?void 0:u.amenities)!=null&&H.length?u.amenities.filter(Y=>{const le=Y._id||Y.id;return le&&y.includes(le.toString())}).map(Y=>{const le=(Y._id||Y.id).toString();return{id:le,name:Y.name,type:Y.type,rate:Y.rate,description:Y.description,quantity:g[le]||1}}):[]},I=H=>{const Y={...g};H.forEach(le=>{y.includes(le)||(Y[le]=1)}),Object.keys(Y).forEach(le=>{H.includes(le)||delete Y[le]}),v(Y),x(H)},W=(H,Y)=>{v(le=>({...le,[H]:Y}))};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsxs(ze,{gutter:[24,24],children:[n.jsx(ae,{span:24,children:n.jsxs(ke,{direction:"vertical",size:4,children:[n.jsx(O4,{level:2,style:{margin:0},children:"Create Booking"}),n.jsx(Ue.Text,{type:"secondary",children:"Create a new stall booking"})]})}),n.jsx(ae,{span:24,children:n.jsx(Ae,{children:n.jsx(oe,{form:e,layout:"vertical",onFinish:K,style:{maxWidth:800},children:n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"exhibitionId",label:"Exhibition",rules:[{required:!0,message:"Please select an exhibition"}],children:n.jsx(nt,{placeholder:"Select exhibition",loading:S,options:ie,onChange:M})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"exhibitorId",label:n.jsxs(ke,{children:[n.jsx("span",{children:"Exhibitor"}),n.jsx(fe,{type:"link",icon:n.jsx(Lh,{}),onClick:()=>i(!0),style:{padding:0},children:"Add Exhibitor"})]}),rules:[{required:!0,message:"Please select an exhibitor"}],children:n.jsx(nt,{showSearch:!0,placeholder:"Select exhibitor",loading:C,options:Z,filterOption:(H,Y)=>{var le;return(((le=Y==null?void 0:Y.label)==null?void 0:le.toString())??"").toLowerCase().includes(H.toLowerCase())}})})}),n.jsx(ae,{span:24,children:n.jsx(oe.Item,{name:"stallIds",label:"Select Stalls",rules:[{required:!0,message:"Please select at least one stall"}],children:n.jsx(nt,{mode:"multiple",placeholder:o?"Loading stalls...":"Select stalls",loading:o,onChange:ee,options:s.map(H=>({label:`Stall ${H.number} (${H.dimensions.width}m × ${H.dimensions.height}m = ${(H.dimensions.width*H.dimensions.height).toFixed(2)} sqm) - ₹${H.ratePerSqm.toLocaleString()}/sq.m`,value:H._id||H.id}))})})}),d.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(ae,{span:24,children:n.jsx(Ae,{title:"Selected Stalls Summary",size:"small",children:n.jsx(ft,{dataSource:d.map(H=>({...H,key:H._id||H.id})),pagination:!1,size:"small",columns:[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Stall Type",key:"type",render:(H,Y)=>{var le,de;return((le=Y.stallType)==null?void 0:le.name)||(typeof Y.stallTypeId=="object"?(de=Y.stallTypeId)==null?void 0:de.name:"Not specified")}},{title:"Dimensions",key:"dimensions",render:(H,Y)=>`${Y.dimensions.width}m × ${Y.dimensions.height}m`},{title:"Area (sqm)",key:"area",render:(H,Y)=>(Y.dimensions.width*Y.dimensions.height).toFixed(2)},{title:"Rate/sq.m",dataIndex:"ratePerSqm",key:"rate",render:H=>`₹${H.toLocaleString()}`},{title:"Base Amount",key:"baseAmount",render:(H,Y)=>`₹${X(Y).toLocaleString()}`}],summary:()=>{const H=d.reduce((Y,le)=>Y+X(le),0);return n.jsxs(ft.Summary.Row,{children:[n.jsx(ft.Summary.Cell,{index:0,colSpan:5,children:n.jsx("strong",{children:"Total Base Amount"})}),n.jsx(ft.Summary.Cell,{index:1,children:n.jsxs("strong",{children:["₹",H.toLocaleString()]})})]},"summary")}})})}),n.jsx(ae,{span:24,children:n.jsx(Ae,{title:"Stall Amenities",size:"small",children:n.jsxs(ze,{gutter:[16,24],children:[n.jsxs(ae,{span:24,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Ue.Title,{level:5,style:{margin:0},children:n.jsxs(ke,{children:[n.jsx("span",{children:"Included Basic Amenities"}),n.jsx(Ne,{color:"green",children:"Based on stall area"})]})}),n.jsxs(Ue.Text,{type:"secondary",children:["The following amenities are included based on your total stall area of ",m.toFixed(2)," sqm."]})]}),(J=u==null?void 0:u.basicAmenities)!=null&&J.length?n.jsx(ft,{dataSource:k.filter(H=>H.calculatedQuantity>0),columns:[{title:"Name",dataIndex:"name",key:"name",render:(H,Y)=>n.jsxs(ke,{children:[n.jsx(Ue.Text,{strong:!0,children:H}),n.jsx(Ne,{color:"blue",children:Y.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:H=>n.jsxs(Ne,{color:"green",children:[H," ",H===1?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(H,Y)=>n.jsx(ht,{title:Y.description,children:n.jsxs(Ue.Text,{type:"secondary",children:[n.jsx(or,{style:{marginRight:5}}),"1 ",Y.quantity>1?`set of ${Y.quantity}`:"unit"," per ",H," sqm"]})})},{title:"Status",key:"status",width:100,align:"right",render:()=>n.jsx(Ue.Text,{type:"success",children:"Included"})}],pagination:!1,size:"small",locale:{emptyText:n.jsx(Ue.Text,{children:"No basic amenities qualify based on the selected stall area."})}}):n.jsx(Ue.Text,{type:"secondary",children:"No basic amenities have been configured for this exhibition."})]}),n.jsxs(ae,{span:24,children:[n.jsx(Tt,{style:{margin:"12px 0 24px"}}),n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Ue.Title,{level:5,style:{margin:0},children:n.jsxs(ke,{children:[n.jsx("span",{children:"Additional Amenities"}),n.jsx(Ne,{color:"blue",children:"Optional"})]})}),n.jsx(Ue.Text,{type:"secondary",children:"Select any additional amenities for the booking."})]}),(he=u==null?void 0:u.amenities)!=null&&he.length?n.jsxs(n.Fragment,{children:[n.jsx(oe.Item,{name:"extraAmenities",label:"Select Additional Amenities",children:n.jsx(nt,{mode:"multiple",placeholder:"Select amenities",style:{width:"100%"},onChange:I,optionLabelProp:"label",options:u.amenities.map(H=>({label:`${H.name} (${H.rate?`₹${H.rate.toLocaleString()}`:"N/A"})`,value:H._id||H.id,key:H._id||H.id}))})}),y.length>0&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(Ue.Text,{strong:!0,children:"Selected Amenities:"}),n.jsx(ft,{dataSource:O(),columns:[{title:"Name",dataIndex:"name",key:"name",render:(H,Y)=>n.jsxs(ke,{align:"center",children:[n.jsx(Ue.Text,{strong:!0,children:H}),n.jsx(Ne,{color:"blue",children:Y.type}),n.jsx(Ue.Text,{type:"secondary",style:{fontSize:"13px"},children:Y.description||""})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,align:"right",render:H=>n.jsxs(Ue.Text,{strong:!0,style:{color:"#1890ff"},children:["₹",H.toLocaleString("en-IN")]})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(H,Y)=>n.jsx(Mr,{min:1,value:g[Y.id]||1,onChange:le=>W(Y.id,le||1),style:{width:"100%"}})},{title:"Total",key:"total",width:120,align:"right",render:(H,Y)=>{const le=g[Y.id]||1,de=Y.rate*le;return n.jsxs(Ue.Text,{strong:!0,style:{color:"#1890ff"},children:["₹",de.toLocaleString("en-IN")]})}}],pagination:!1,size:"small"})]})]}):n.jsx(Ue.Text,{type:"secondary",children:"No additional amenities have been configured for this exhibition."})]})]})})}),n.jsx(ae,{span:24,children:n.jsxs(Ae,{title:"Price Calculations",size:"small",children:[n.jsx(ze,{gutter:[16,16],children:n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"discountId",label:"Available Discounts",children:n.jsx(nt,{placeholder:"Select discount",allowClear:!0,onChange:R,options:(ye=u==null?void 0:u.discountConfig)==null?void 0:ye.map(H=>({label:`${H.name} (${H.type==="percentage"?H.value+"%":"₹"+H.value})${H.isActive?"":" - Inactive"}`,value:`${H.name}-${H.value}-${H.type}`,disabled:!H.isActive}))})})})}),n.jsx("div",{style:{background:"#fafafa",padding:"16px",borderRadius:"8px",marginTop:"16px"},children:n.jsx(ke,{direction:"vertical",style:{width:"100%"},size:"small",children:(()=>{const{baseAmount:H,selectedDiscount:Y,discountAmount:le,amountAfterDiscount:de,taxes:G,totalAmount:xe}=U();return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Jr,{children:"Total Base Amount:"}),n.jsxs(Jr,{children:["₹",H.toLocaleString()]})]}),Y&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Jr,{children:["Discount (",Y.type==="percentage"?`${Y.value}%`:`₹${Y.value.toLocaleString()}`,"):"]}),n.jsxs(Jr,{type:"danger",children:["-₹",le.toLocaleString()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsx(Jr,{children:"Amount after Discount:"}),n.jsxs(Jr,{children:["₹",de.toLocaleString()]})]}),n.jsx(Tt,{style:{margin:"8px 0"}}),G.map(ge=>n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[n.jsxs(Jr,{children:[ge.name," (",ge.rate,"%):"]}),n.jsxs(Jr,{children:["₹",ge.amount.toLocaleString()]})]},`tax-${ge.name}`)),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[n.jsx(Jr,{strong:!0,children:"Total Amount (incl. Taxes):"}),n.jsxs(Jr,{strong:!0,children:["₹",xe.toLocaleString()]})]})]})})()})})]})})]}),n.jsx(ae,{span:24,children:n.jsx(oe.Item,{children:n.jsxs(ke,{children:[n.jsx(fe,{type:"primary",htmlType:"submit",loading:_,children:"Create Booking"}),n.jsx(fe,{onClick:()=>E("/bookings"),children:"Cancel"})]})})})]})})})})]}),n.jsx(pt,{title:n.jsx("span",{style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add Exhibitor"}),open:r,onCancel:()=>{i(!1),t.resetFields()},width:800,footer:n.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-start",padding:"20px 24px"},children:[n.jsx(fe,{onClick:()=>{i(!1),t.resetFields()},style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",backgroundColor:"white"},children:"Cancel"}),n.jsx(fe,{type:"primary",onClick:t.submit,style:{height:"40px",padding:"10px 16px",borderRadius:"8px",border:"none",backgroundColor:"#6941C6",color:"white",fontWeight:500,fontSize:"14px",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Add Exhibitor"})]}),styles:{body:{padding:"24px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},header:{borderBottom:"1px solid #E5E7EB",padding:"24px"},footer:{borderTop:"1px solid #E5E7EB",padding:0}},style:{top:20},children:n.jsx(oe,{form:t,layout:"vertical",onFinish:Q,requiredMark:!1,children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Company Information"}),n.jsx(oe.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"address",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:n.jsx(Re.TextArea,{rows:3})}),n.jsx(oe.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"pinCode",label:"PIN Code",rules:[{required:!0,message:"Please enter PIN code"},{pattern:/^\d{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"status",label:"Status",initialValue:"active",children:n.jsxs(nt,{children:[n.jsx(nt.Option,{value:"active",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#F6FEF9",color:"#039855",border:"1px solid #ABEFC6",alignItems:"center",height:"22px"},children:"ACTIVE"})}),n.jsx(nt.Option,{value:"inactive",children:n.jsx("div",{style:{display:"inline-flex",padding:"2px 8px",borderRadius:"16px",fontSize:"12px",fontWeight:500,backgroundColor:"#FEF3F2",color:"#D92D20",border:"1px solid #FDA29B",alignItems:"center",height:"22px"},children:"INACTIVE"})})]})})]}),n.jsxs("div",{children:[n.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#101828",marginBottom:"24px"},children:"Contact & Legal Information"}),n.jsx(oe.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"contactEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"contactPhone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\d{10}$/,message:"Please enter a valid 10-digit phone number"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"panNumber",label:"PAN Number",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(Re,{placeholder:"ABCDE1234F"})}),n.jsx(oe.Item,{name:"gstNumber",label:"GST Number",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(Re,{placeholder:"27AAPFU0939F1ZV"})})]})]})})})]})},Fp=({booking:e})=>{var S,j,C;const[t,r]=N.useState(null),[i,s]=N.useState(!0),a=ut(P=>P.settings.settings);N.useEffect(()=>{(async()=>{s(!0);try{if(e.exhibitionId.headerLogo){const M=e.exhibitionId.headerLogo;r(`${Pe.defaults.baseURL}/public/uploads/${M}`),console.log("Using exhibition header logo:",M)}else if(a!=null&&a.logo){const M=a.logo;r(`${Pe.defaults.baseURL}/public/uploads/${M}`),console.log("Using global settings logo:",M)}else{const M=`${Pe.defaults.baseURL}/public/logo`;r(M),console.log("Using public logo endpoint:",M)}}catch(M){console.error("Error loading logo:",M),r(null)}finally{s(!1)}})()},[e.exhibitionId.headerLogo,a==null?void 0:a.logo]);const o=()=>{const P=new Date(e.exhibitionId.startDate||""),M=new Date(e.exhibitionId.endDate||""),X={};let ee=new Date(P);for(;ee<=M;){const K=ee.toLocaleString("default",{month:"short",year:"numeric"});X[K]||(X[K]=[]),X[K].push(ee.getDate().toString().padStart(2,"0")),ee=new Date(ee),ee.setDate(ee.getDate()+1)}const q=Object.entries(X).map(([K,Q])=>`${Q.join(", ")} ${K}`);return`${e.exhibitionId.name||"ABSE"} (${q.join(" & ")})`},l=P=>{const M=new Date(P);return{date:M.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:M.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},d=e.stallIds.map((P,M)=>{var K;const X=P,ee=P.dimensions.width*P.dimensions.height,q=ee*P.ratePerSqm;return{key:P._id,sn:M+1,stallNo:P.number,stallType:((K=X.stallTypeId)==null?void 0:K.name)||"Standard",dimensions:`${P.dimensions.width}x${P.dimensions.height}m`,area:ee.toFixed(0),rate:P.ratePerSqm.toFixed(0),amount:q}}),c=d.reduce((P,M)=>P+M.amount,0),u=e.calculations,f=((S=u.stalls[0])==null?void 0:S.discount)!==void 0&&((j=u.stalls[0])==null?void 0:j.discount)!==null,h=f?(C=u.stalls[0])==null?void 0:C.discount:null,p=(h==null?void 0:h.type)||"percentage",y=(h==null?void 0:h.value)||0;let x=0;f&&y>0&&(p==="percentage"?x=Math.round(c*y/100*100)/100:p==="fixed"&&(x=Math.min(y,c)));const g=c-x,v=u.taxes.find(P=>P.name.includes("GST")),k=v?v.rate:18,T=Math.round(g*k/100*100)/100,m=g+T,w=c,E=x,b=g,_=T,A=m;return n.jsx("div",{className:"invoice-container",children:n.jsxs("div",{className:"proforma-invoice",children:[n.jsxs("div",{className:"header-section",children:[n.jsx("div",{className:"logo-cell",children:i?n.jsx("div",{className:"logo-loading",children:"Loading..."}):t?n.jsx("img",{src:t,alt:e.exhibitionId.companyName,className:"logo-image",onError:()=>r(null)}):e.exhibitionId.companyName}),n.jsxs("div",{className:"title-company",children:[n.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),n.jsx("div",{className:"company-cell",children:e.exhibitionId.companyName})]})]}),n.jsxs("div",{className:"bill-to-section",children:[n.jsx("div",{className:"bill-to-cell",children:"Bill To"}),n.jsxs("div",{className:"bill-to-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Company Name"}),n.jsx("div",{className:"value-cell",children:e.companyName}),n.jsx("div",{className:"date-label-cell",children:"Date"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).date})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Phone No."}),n.jsx("div",{className:"value-cell",children:e.customerPhone}),n.jsx("div",{className:"date-label-cell",children:"Time"}),n.jsx("div",{className:"date-value-cell",children:l(e.createdAt).time})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"GST No."}),n.jsx("div",{className:"value-cell",children:e.customerGSTIN}),n.jsx("div",{className:"date-label-cell",children:"Invoice No"}),n.jsx("div",{className:"date-value-cell",children:e.invoiceNumber})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("div",{className:"label-cell",children:"Address"}),n.jsx("div",{className:"value-cell",children:e.customerAddress})]})]})]}),n.jsxs("div",{className:"expo-venue-section",children:[n.jsxs("div",{className:"expo-column",children:[n.jsx("div",{className:"heading",children:"Expo Name"}),n.jsx("div",{className:"content",children:o()})]}),n.jsxs("div",{className:"venue-column",children:[n.jsx("div",{className:"heading",children:"Venue"}),n.jsx("div",{className:"content",children:e.exhibitionId.venue})]})]}),n.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),n.jsxs("div",{className:"stall-table",children:[n.jsxs("div",{className:"stall-header",children:[n.jsx("div",{className:"stall-header-cell",children:"S/N"}),n.jsx("div",{className:"stall-header-cell",children:"Stall No."}),n.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),n.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),n.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),n.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),d.map(P=>n.jsxs("div",{className:"stall-row",children:[n.jsx("div",{className:"stall-cell",children:P.sn}),n.jsx("div",{className:"stall-cell",children:P.stallNo}),n.jsx("div",{className:"stall-cell",children:P.stallType}),n.jsx("div",{className:"stall-cell",children:P.dimensions}),n.jsx("div",{className:"stall-cell",children:P.area}),n.jsx("div",{className:"stall-cell",children:Number(P.rate).toLocaleString("en-IN")}),n.jsx("div",{className:"stall-cell",children:P.amount.toLocaleString("en-IN")})]},P.key))]}),n.jsx("div",{className:"section-header",children:"Calculation Summary"}),n.jsxs("div",{className:"calc-table",children:[n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",w.toLocaleString("en-IN")]})]}),f&&E>0&&n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:p==="percentage"?`Discount (${y}%)`:`Discount (Fixed ₹${y.toLocaleString("en-IN")})`}),n.jsxs("div",{className:"calc-value",children:["-₹",E.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsx("div",{className:"calc-label",children:f&&E>0?"Amount after Discount":"Net Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",b.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row",children:[n.jsxs("div",{className:"calc-label",children:["GST (",k,"%)"]}),n.jsxs("div",{className:"calc-value",children:["₹",_.toLocaleString("en-IN")]})]}),n.jsxs("div",{className:"calc-row total-row",children:[n.jsx("div",{className:"calc-label",children:"Total Amount"}),n.jsxs("div",{className:"calc-value",children:["₹",A.toLocaleString("en-IN")]})]})]}),n.jsxs("div",{className:"details-section",children:[n.jsxs("div",{className:"bank-details",children:[n.jsx("div",{className:"details-header",children:"Bank Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Bank Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Account No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccount})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Name"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankAccountName})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Branch"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankBranch})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"IFSC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.bankIFSC})]})]}),n.jsxs("div",{className:"company-details",children:[n.jsx("div",{className:"details-header",children:"Company Details"}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"CIN No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyCIN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Pan No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyPAN})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"SAC CODE"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companySAC})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"GST No."}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyGST})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Email"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyEmail})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Website"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyWebsite})]}),n.jsxs("div",{className:"details-row",children:[n.jsx("div",{className:"detail-label",children:"Address"}),n.jsx("div",{className:"detail-value",children:e.exhibitionId.companyAddress})]})]})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"PI Instruction"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),n.jsxs("div",{className:"instruction-section",children:[n.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),n.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:e.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),n.jsx("div",{className:"signature-section",children:n.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},M4=()=>{const{id:e}=Ps(),t=tr(),{data:r,isLoading:i}=Fb(e||""),[s,a]=N.useState(!1),[o,l]=N.useState(!1),[d]=oe.useForm(),[c,u]=N.useState(0),[f,h]=N.useState(!1),p=async()=>{if(e)try{h(!0),u(0),Se.loading({content:"Preparing invoice...",key:"download"});const g=await Uh(`/invoices/${e}/download?force=false`,!1,T=>{const m=T.total,w=T.loaded;if(m){const E=Math.round(w*100/m);u(E),E%25===0&&Se.loading({content:`Downloading: ${E}% complete`,key:"download"})}}),v=window.URL.createObjectURL(new Blob([g.data])),k=document.createElement("a");k.href=v,k.setAttribute("download",`invoice-${e}.pdf`),document.body.appendChild(k),k.click(),k.remove(),window.URL.revokeObjectURL(v),Se.success({content:"Invoice downloaded successfully",key:"download"})}catch(g){console.error("Download error:",g),Se.error({content:"Failed to download invoice",key:"download"})}finally{h(!1),u(0)}},y=async g=>{try{await Pe.post(`/invoices/${e}/share/email`,g),Se.success("Invoice shared via email successfully"),a(!1),d.resetFields()}catch(v){console.error("Email sharing error:",v),Se.error("Failed to share invoice via email")}},x=async g=>{try{await Pe.post(`/invoices/${e}/share/whatsapp`,g),Se.success("Invoice shared via WhatsApp successfully"),l(!1),d.resetFields()}catch(v){console.error("WhatsApp sharing error:",v),Se.error("Failed to share invoice via WhatsApp")}};return i||!r?n.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",r),n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(Ae,{title:"Invoice Details",extra:n.jsxs(ke,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ke,{children:[n.jsx(fe,{icon:n.jsx(Mh,{}),onClick:()=>t(-1),disabled:f,children:"Back"}),n.jsx(fe,{type:"primary",icon:n.jsx(Os,{}),onClick:p,loading:f&&c<100,disabled:f&&c>=100,children:"Download"}),n.jsx(fe,{icon:n.jsx(Ln,{}),onClick:()=>a(!0),disabled:f,children:"Share via Email"}),n.jsx(fe,{icon:n.jsx(Bh,{}),onClick:()=>l(!0),disabled:f,children:"Share via WhatsApp"})]}),f&&n.jsx(fo,{percent:c,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:n.jsx(Fp,{booking:{...r.bookingId,customerGSTIN:r.bookingId.customerGSTIN||"",invoiceNumber:r.invoiceNumber,exhibitionId:{...r.bookingId.exhibitionId,companyName:r.bookingId.exhibitionId.companyName||"Company Name",bankName:r.bookingId.exhibitionId.bankName||"",bankAccount:r.bookingId.exhibitionId.bankAccount||"",bankAccountName:r.bookingId.exhibitionId.bankAccountName||"",bankBranch:r.bookingId.exhibitionId.bankBranch||"",bankIFSC:r.bookingId.exhibitionId.bankIFSC||"",companyCIN:r.bookingId.exhibitionId.companyCIN||"",companyPAN:r.bookingId.exhibitionId.companyPAN||"",companySAC:r.bookingId.exhibitionId.companySAC||"",companyGST:r.bookingId.exhibitionId.companyGST||"",companyEmail:r.bookingId.exhibitionId.companyEmail||"",companyWebsite:r.bookingId.exhibitionId.companyWebsite||"",companyAddress:r.bookingId.exhibitionId.companyAddress||"",headerLogo:r.bookingId.exhibitionId.headerLogo||void 0},calculations:{...r.bookingId.calculations,stalls:r.bookingId.calculations.stalls.map(g=>({discount:g.discount?{...g.discount,type:g.discount.type||"percentage",value:g.discount.value}:void 0}))}}})}),n.jsx(pt,{title:"Share Invoice via Email",open:s,onCancel:()=>a(!1),footer:null,children:n.jsxs(oe,{form:d,onFinish:y,layout:"vertical",children:[n.jsx(oe.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(Re,{placeholder:"Enter email address"})}),n.jsx(oe.Item,{name:"message",label:"Message (Optional)",children:n.jsx(Re.TextArea,{placeholder:"Enter optional message"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(pt,{title:"Share Invoice via WhatsApp",open:o,onCancel:()=>l(!1),footer:null,children:n.jsxs(oe,{form:d,onFinish:x,layout:"vertical",children:[n.jsx(oe.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:n.jsx(Re,{placeholder:"Enter phone number with country code"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},{Title:B4,Text:gi}=Ue,{Option:ba}=nt,{RangePicker:$4}=xo,U4=()=>{var H;const e=tr(),t=hr(),[r,i]=N.useState(1),[s,a]=N.useState(10),[o,l]=N.useState(""),[d,c]=N.useState(null),[u,f]=N.useState(null),[h,p]=N.useState(null),[y,x]=N.useState(!1),[g,v]=N.useState(null),[k,T]=N.useState(""),[m,w]=N.useState(""),[E,b]=N.useState("createdAt"),[_,A]=N.useState("descend"),[S,j]=Se.useMessage(),[C,P]=N.useState(null),[M,X]=N.useState(0),{exhibitions:ee,loading:q}=ut(Y=>Y.exhibition);N.useEffect(()=>{t(Yn())},[t]);const{data:K,isLoading:Q,refetch:ie}=Do({page:r,limit:s}),[Z,{isLoading:R}]=Rb(),U=_t.useMemo(()=>K!=null&&K.data?K.data.filter(Y=>{const le=o.toLowerCase(),de=o===""||Y.invoiceNumber&&Y.invoiceNumber.toLowerCase().includes(le)||Y._id.toLowerCase().includes(le)||Y.bookingId.customerName&&Y.bookingId.customerName.toLowerCase().includes(le)||Y.bookingId.companyName&&Y.bookingId.companyName.toLowerCase().includes(le),G=!d||Y.status===d,xe=!u||Y.bookingId.exhibitionId&&Y.bookingId.exhibitionId._id===u;let ge=!0;if(h&&h[0]&&h[1]){const me=St(Y.createdAt);ge=me.isAfter(h[0])&&me.isBefore(h[1])}return de&&G&&xe&&ge}):[],[K,o,d,u,h]),O=async Y=>{try{P(Y),X(0),S.loading({content:"Preparing invoice...",key:Y});const le=await Uh(`/invoices/${Y}/download?force=false`,!1,xe=>{const ge=xe.total,me=xe.loaded;if(ge){const Te=Math.round(me*100/ge);X(Te),Te%25===0&&S.loading({content:`Downloading: ${Te}% complete`,key:Y})}}),de=window.URL.createObjectURL(new Blob([le.data])),G=document.createElement("a");G.href=de,G.setAttribute("download",`invoice-${Y}.pdf`),document.body.appendChild(G),G.click(),G.remove(),window.URL.revokeObjectURL(de),S.success({content:"Invoice downloaded successfully",key:Y})}catch(le){console.error("Download error:",le),S.error({content:"Failed to download invoice",key:Y})}finally{P(null),X(0)}},I=async()=>{if(!(!g||!k))try{S.loading({content:"Sending email...",key:"email"}),await Z({id:g,email:k,message:m||void 0}).unwrap(),S.success({content:"Invoice sent via email successfully",key:"email"}),x(!1),T(""),w(""),v(null)}catch(Y){console.error("Email error:",Y),S.error({content:"Failed to send invoice via email",key:"email"})}},W=Y=>{v(Y),x(!0)},J=()=>{l(""),c(null),f(null),p(null)},he=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:E==="invoiceNumber"?_:null,render:(Y,le)=>n.jsx("a",{onClick:()=>e(`/invoice/${le._id}`),children:Y||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:E==="companyName"?_:null,render:Y=>Y||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:E==="exhibitionName"?_:null,render:(Y,le)=>n.jsx("a",{onClick:()=>e(`/exhibition/${le.bookingId.exhibitionId._id}`),children:Y})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:E==="amount"?_:null,render:Y=>`₹${Y.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:E==="status"?_:null,render:Y=>n.jsx(Ne,{color:Y==="paid"?"green":Y==="pending"?"gold":Y==="cancelled"?"red":"blue",children:Y.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:E==="dueDate"?_:null,render:Y=>Y?St(Y).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:E==="createdAt"?_:null,render:Y=>St(Y).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(Y,le)=>n.jsxs(ke,{direction:"vertical",size:"small",style:{width:"100%"},children:[n.jsxs(ke,{children:[n.jsx(ht,{title:"View Invoice",children:n.jsx(fe,{type:"text",icon:n.jsx(Ds,{}),onClick:()=>e(`/invoice/${le._id}`)})}),n.jsx(ht,{title:"Download",children:n.jsx(fe,{type:"text",icon:n.jsx(Os,{}),onClick:()=>O(le._id),loading:C===le._id&&M<100,disabled:C!==null&&C!==le._id})}),n.jsx(ht,{title:"Email",children:n.jsx(fe,{type:"text",icon:n.jsx(Ln,{}),onClick:()=>W(le._id),disabled:C!==null})})]}),C===le._id&&n.jsx(fo,{percent:M,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],ye=(Y,le,de)=>{de&&de.field&&(b(de.field),A(de.order||"descend"))};return n.jsxs(Rs,{children:[j,n.jsxs("div",{className:"invoice-list-container",children:[n.jsx(Ae,{children:n.jsxs(ke,{direction:"vertical",style:{width:"100%"},size:"large",children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx(B4,{level:2,style:{margin:0},children:"Invoices"}),n.jsx(ke,{children:n.jsx(ht,{title:"Refresh",children:n.jsx(fe,{icon:n.jsx(Is,{}),onClick:()=>ie(),loading:Q})})})]}),n.jsx(Ae,{size:"small",title:n.jsxs(ke,{children:[n.jsx(kc,{})," Filters"]}),children:n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[n.jsxs("div",{style:{minWidth:"200px",flex:1},children:[n.jsx(gi,{strong:!0,children:"Search"}),n.jsx(Re,{placeholder:"Search by invoice #, company...",value:o,onChange:Y=>l(Y.target.value),prefix:n.jsx(ms,{}),allowClear:!0})]}),n.jsxs("div",{style:{minWidth:"150px"},children:[n.jsx(gi,{strong:!0,children:"Status"}),n.jsxs(nt,{style:{width:"100%"},placeholder:"Filter by status",value:d,onChange:c,allowClear:!0,children:[n.jsx(ba,{value:"pending",children:"Pending"}),n.jsx(ba,{value:"paid",children:"Paid"}),n.jsx(ba,{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{style:{minWidth:"200px"},children:[n.jsx(gi,{strong:!0,children:"Exhibition"}),n.jsx(nt,{style:{width:"100%"},placeholder:"Filter by exhibition",value:u,onChange:f,loading:q,allowClear:!0,children:ee.map(Y=>n.jsx(ba,{value:Y._id||Y.id,children:Y.name},Y._id||Y.id))})]}),n.jsxs("div",{style:{minWidth:"300px"},children:[n.jsx(gi,{strong:!0,children:"Date Range"}),n.jsx($4,{style:{width:"100%"},value:h,onChange:p})]}),n.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:n.jsx(fe,{icon:n.jsx(Lx,{}),onClick:J,children:"Clear Filters"})})]})}),n.jsx(ft,{columns:he,dataSource:U,rowKey:"_id",loading:Q,pagination:{current:r,pageSize:s,total:((H=K==null?void 0:K.pagination)==null?void 0:H.total)||0,onChange:(Y,le)=>{i(Y),le&&a(le)},showSizeChanger:!0,showTotal:Y=>`Total ${Y} invoices`},onChange:ye})]})}),n.jsxs(pt,{title:"Send Invoice via Email",open:y,onCancel:()=>x(!1),onOk:I,okText:"Send",confirmLoading:R,children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(gi,{strong:!0,children:"Email Address"}),n.jsx(Re,{placeholder:"Enter recipient email",value:k,onChange:Y=>T(Y.target.value),style:{width:"100%"}})]}),n.jsxs("div",{children:[n.jsx(gi,{strong:!0,children:"Message (Optional)"}),n.jsx(Re.TextArea,{placeholder:"Enter optional message",value:m,onChange:Y=>w(Y.target.value),rows:4})]})]})]})]})},{Title:z4,Text:Ke,Paragraph:W4}=Ue,{Option:wa}=nt,{TextArea:ph,Search:q4}=Re,{RangePicker:V4}=xo,H4=()=>{const e=hr(),{exhibitors:t,loading:r}=ut(I=>I.exhibitor),[i,s]=N.useState(null),[a,o]=N.useState(!1),[l,d]=N.useState(!1),[c,u]=N.useState(!1),[f,h]=N.useState("approved"),[p,y]=N.useState(""),[x,g]=N.useState(!1),[v,k]=N.useState(!1),[T,m]=N.useState(!1),[w,E]=N.useState(""),[b,_]=N.useState([]),[A]=oe.useForm(),[S,j]=N.useState([]);S.length>0;const[C,P]=N.useState({total:0,pending:0,approved:0,rejected:0});N.useEffect(()=>{e(ln())},[e]),N.useEffect(()=>{if(t!=null&&t.length){_(t);const I={total:t.length,pending:t.filter(W=>W.status==="pending").length,approved:t.filter(W=>W.status==="approved").length,rejected:t.filter(W=>W.status==="rejected").length};P(I)}},[t]),N.useEffect(()=>{i&&l&&A.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,l,A]);const M=I=>{switch(I){case"approved":return n.jsx(Ne,{color:"success",children:"Approved"});case"pending":return n.jsx(Ne,{color:"warning",children:"Pending"});case"rejected":return n.jsx(Ne,{color:"error",children:"Rejected"});default:return n.jsx(Ne,{children:"Unknown"})}},X=async()=>{var I,W;if(i)try{g(!0),await lr.updateStatus(i._id,f,f==="rejected"?p:void 0),Se.success(`Exhibitor status updated to ${f}`),o(!1),e(ln())}catch(J){Se.error(((W=(I=J.response)==null?void 0:I.data)==null?void 0:W.message)||"Failed to update exhibitor status")}finally{g(!1)}},ee=async I=>{var W,J;if(i)try{k(!0),await lr.updateExhibitor(i._id,I),Se.success("Exhibitor details updated successfully"),d(!1),e(ln())}catch(he){Se.error(((J=(W=he.response)==null?void 0:W.data)==null?void 0:J.message)||"Failed to update exhibitor details")}finally{k(!1)}},q=async I=>{var W,J;try{m(!0),await lr.deleteExhibitor(I),Se.success("Exhibitor deleted successfully"),e(ln())}catch(he){Se.error(((J=(W=he.response)==null?void 0:W.data)==null?void 0:J.message)||"Failed to delete exhibitor")}finally{m(!1)}},K=I=>{if(E(I),!I){_(t);return}const W=I.toLowerCase(),J=t.filter(he=>he.companyName.toLowerCase().includes(W)||he.contactPerson.toLowerCase().includes(W)||he.email.toLowerCase().includes(W)||he.phone.toLowerCase().includes(W));_(J)},Q=I=>{if(I==="all"){_(t);return}const W=t.filter(J=>J.status===I);_(W)},ie=I=>{if(!I||I.length!==2){_(t);return}const W=I[0].startOf("day").toISOString(),J=I[1].endOf("day").toISOString(),he=t.filter(ye=>{const H=new Date(ye.createdAt).toISOString();return H>=W&&H<=J});_(he)},Z=()=>{const I=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],W=b.map(Y=>[Y.companyName,Y.contactPerson,Y.email,Y.phone,Y.status,Y.isActive?"Yes":"No",new Date(Y.createdAt).toLocaleDateString(),Y.address||"",Y.website||""]);W.unshift(I);const J=W.map(Y=>Y.map(le=>typeof le=="string"&&(le.includes(",")||le.includes('"')||le.includes(`
`))?`"${le.replace(/"/g,'""')}"`:le).join(",")).join(`
`),he=new Blob([J],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(he),H=document.createElement("a");H.setAttribute("href",ye),H.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H),Se.success("Exhibitor data exported successfully")},R=()=>{pt.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${S.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{m(!0);const I=S.map(W=>lr.deleteExhibitor(W.toString()));await Promise.all(I),Se.success(`${S.length} exhibitors deleted successfully`),j([]),e(ln())}catch{Se.error("Failed to delete some exhibitors")}finally{m(!1)}}})},U={selectedRowKeys:S,onChange:I=>{j(I)}},O=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(I,W)=>I.companyName.localeCompare(W.companyName),filterDropdown:({setSelectedKeys:I,selectedKeys:W,confirm:J,clearFilters:he})=>n.jsxs("div",{style:{padding:8},children:[n.jsx(Re,{placeholder:"Search company or contact",value:W[0],onChange:ye=>I(ye.target.value?[ye.target.value]:[]),onPressEnter:()=>J(),style:{width:188,marginBottom:8,display:"block"}}),n.jsxs(ke,{children:[n.jsx(fe,{type:"primary",onClick:()=>J(),icon:n.jsx(ms,{}),size:"small",style:{width:90},children:"Filter"}),n.jsx(fe,{onClick:()=>{he&&he(),J()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:I=>n.jsx(ms,{style:{color:I?"#1890ff":void 0}}),onFilter:(I,W)=>{const J=String(I).toLowerCase();return W.companyName.toLowerCase().includes(J)||W.contactPerson.toLowerCase().includes(J)},render:(I,W)=>n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:"bold"},children:I}),n.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",W.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(I,W)=>n.jsxs("div",{children:[n.jsx("div",{children:I}),n.jsx("div",{style:{fontSize:"12px"},children:W.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(I,W)=>W.status===I,render:I=>M(I)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(I,W)=>W.isActive===I,render:I=>n.jsx(Ne,{color:I?"green":"red",children:I?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(I,W)=>new Date(I.createdAt).getTime()-new Date(W.createdAt).getTime(),render:I=>n.jsx(ht,{title:new Date(I).toLocaleString(),children:new Date(I).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:I=>I?n.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",children:I.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(I,W)=>n.jsxs(ke,{children:[n.jsx(ht,{title:"View Details",children:n.jsx(fe,{icon:n.jsx(Ds,{}),onClick:()=>{s(W),u(!0)}})}),n.jsx(fe,{type:"primary",onClick:()=>{s(W),h(W.status),y(W.rejectionReason||""),o(!0)},children:"Update Status"}),n.jsx(ni,{overlay:n.jsxs(cr,{children:[n.jsx(cr.Item,{icon:n.jsx($h,{}),onClick:()=>{s(W),d(!0)},children:"Edit"},"edit"),n.jsx(cr.Item,{icon:n.jsx(En,{}),danger:!0,onClick:J=>{J.domEvent.stopPropagation(),pt.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>q(W._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:n.jsx(fe,{icon:n.jsx(Oh,{})})})]})}];return n.jsxs("div",{className:"dashboard-container",children:[n.jsx("div",{style:{marginBottom:"24px"},children:n.jsxs(ze,{gutter:[24,24],align:"middle",children:[n.jsx(ae,{flex:"auto",children:n.jsxs(ke,{direction:"vertical",size:4,children:[n.jsx(z4,{level:4,style:{margin:0},children:"Exhibitors"}),n.jsx(Ke,{type:"secondary",children:"Manage exhibitors and their information"})]})}),n.jsx(ae,{children:n.jsx(fe,{type:"primary",icon:n.jsx($a,{}),onClick:()=>d(!0),size:"large",children:"Add Exhibitor"})})]})}),n.jsxs(ze,{gutter:[16,24],style:{marginBottom:"24px"},children:[n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Total Exhibitors",value:C.total,prefix:n.jsx(jt,{})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Pending",value:C.pending,prefix:n.jsx(br,{style:{color:"#faad14"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Approved",value:C.approved,prefix:n.jsx(Nt,{style:{color:"#52c41a"}})})})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsx(Ae,{children:n.jsx(Pt,{title:"Rejected",value:C.rejected,prefix:n.jsx(Kr,{style:{color:"#ff4d4f"}})})})})]}),n.jsx(Ae,{className:"info-card",style:{marginBottom:"24px"},children:n.jsxs(ke,{direction:"vertical",size:"middle",style:{width:"100%"},children:[n.jsxs(ze,{gutter:[16,16],align:"middle",children:[n.jsx(ae,{xs:24,sm:8,md:6,lg:4,children:n.jsx(q4,{placeholder:"Search exhibitors",allowClear:!0,onSearch:K,style:{width:"100%"}})}),n.jsx(ae,{xs:24,sm:8,md:6,lg:4,children:n.jsxs(nt,{placeholder:"Filter by status",style:{width:"100%"},onChange:Q,allowClear:!0,children:[n.jsx(wa,{value:"all",children:"All Status"}),n.jsx(wa,{value:"pending",children:"Pending"}),n.jsx(wa,{value:"approved",children:"Approved"}),n.jsx(wa,{value:"rejected",children:"Rejected"})]})}),n.jsx(ae,{xs:24,sm:8,md:6,lg:6,children:n.jsx(V4,{style:{width:"100%"},onChange:ie})})]}),S.length>0&&n.jsx(ze,{children:n.jsxs(ke,{children:[n.jsxs(Ke,{children:["Selected ",S.length," items"]}),n.jsx(fe,{danger:!0,onClick:R,children:"Delete Selected"}),n.jsx(fe,{type:"primary",onClick:Z,children:"Export Selected"})]})})]})}),n.jsx(Ae,{className:"info-card",children:n.jsx(ft,{rowSelection:U,dataSource:b,columns:O,rowKey:"_id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(I,W)=>`${W[0]}-${W[1]} of ${I} items`},scroll:{x:1500}})}),n.jsx(pt,{title:"Exhibitor Details",open:c,onCancel:()=>u(!1),footer:[n.jsx(fe,{onClick:()=>u(!1),children:"Close"},"close")],width:600,children:i&&n.jsx("div",{children:n.jsxs(ze,{gutter:[16,16],children:[n.jsx(ae,{span:24,children:n.jsx(Ae,{title:"Company Information",children:n.jsxs(ze,{gutter:[16,8],children:[n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Company Name:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.companyName})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Contact Person:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.contactPerson})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Email:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.email})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Phone:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.phone})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Address:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.address||"Not provided"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Status:"})}),n.jsx(ae,{span:12,children:M(i.status)}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Active:"})}),n.jsx(ae,{span:12,children:n.jsx(Br,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Registration Date:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:new Date(i.createdAt).toLocaleString()})})]})})}),n.jsx(ae,{span:24,children:n.jsxs(Ae,{title:"Additional Information",children:[n.jsxs(ze,{gutter:[16,8],children:[n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Address:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{children:i.address||"Not provided"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Website:"})}),n.jsx(ae,{span:12,children:i.website?n.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&n.jsxs(n.Fragment,{children:[n.jsx(ae,{span:12,children:n.jsx(Ke,{strong:!0,children:"Rejection Reason:"})}),n.jsx(ae,{span:12,children:n.jsx(Ke,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&n.jsxs(n.Fragment,{children:[n.jsx(Tt,{}),n.jsx(Ke,{strong:!0,children:"Description:"}),n.jsx(W4,{style:{marginTop:8},children:i.description})]})]})})]})})}),n.jsx(pt,{title:"Update Exhibitor Status",open:a,onCancel:()=>o(!1),footer:null,width:600,children:i&&n.jsxs("div",{children:[n.jsx(Ae,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(jt,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:n.jsxs(ze,{gutter:[16,8],children:[n.jsx(ae,{span:8,children:n.jsx(Ke,{strong:!0,children:"Company:"})}),n.jsx(ae,{span:16,children:n.jsx(Ke,{children:i.companyName})}),n.jsx(ae,{span:8,children:n.jsx(Ke,{strong:!0,children:"Contact Person:"})}),n.jsx(ae,{span:16,children:n.jsx(Ke,{children:i.contactPerson})}),n.jsx(ae,{span:8,children:n.jsx(Ke,{strong:!0,children:"Email:"})}),n.jsx(ae,{span:16,children:n.jsx(Ke,{children:i.email})}),n.jsx(ae,{span:8,children:n.jsx(Ke,{strong:!0,children:"Address:"})}),n.jsx(ae,{span:16,children:n.jsx(Ke,{children:i.address||"Not provided"})}),n.jsx(ae,{span:8,children:n.jsx(Ke,{strong:!0,children:"Current Status:"})}),n.jsx(ae,{span:16,children:M(i.status)})]})}),n.jsxs(Ae,{title:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx(po,{style:{fontSize:"18px"}}),n.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx(Ke,{strong:!0,children:"Select New Status:"}),n.jsx("div",{style:{marginTop:"16px"},children:n.jsxs(yr.Group,{value:f,onChange:I=>h(I.target.value),buttonStyle:"solid",children:[n.jsx(yr.Button,{value:"pending",children:n.jsxs(ke,{children:[n.jsx(br,{style:{color:"#faad14"}}),"Pending"]})}),n.jsx(yr.Button,{value:"approved",children:n.jsxs(ke,{children:[n.jsx(Nt,{style:{color:"#52c41a"}}),"Approved"]})}),n.jsx(yr.Button,{value:"rejected",children:n.jsxs(ke,{children:[n.jsx(Kr,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),f==="rejected"&&n.jsx("div",{children:n.jsx(oe.Item,{label:n.jsx(Ke,{strong:!0,children:"Rejection Reason:"}),required:f==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:n.jsx(ph,{rows:4,value:p,onChange:I=>y(I.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),f==="approved"&&n.jsx(Ct,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),f==="pending"&&n.jsx(Ct,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),n.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx(fe,{onClick:()=>o(!1),children:"Cancel"}),n.jsx(fe,{type:"primary",onClick:X,loading:x,disabled:f==="rejected"&&!p.trim(),children:"Update Status"})]})]})]})}),n.jsx(pt,{title:"Edit Exhibitor Details",open:l,onCancel:()=>d(!1),footer:null,width:600,children:n.jsxs(oe,{form:A,layout:"vertical",onFinish:ee,children:[n.jsx(oe.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"address",label:"Address",children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"website",label:"Website",children:n.jsx(Re,{})}),n.jsx(oe.Item,{name:"description",label:"Description",children:n.jsx(ph,{rows:4})}),n.jsx(oe.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:n.jsx(Ah,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),n.jsx(oe.Item,{children:n.jsxs(ke,{children:[n.jsx(fe,{type:"primary",htmlType:"submit",loading:v,children:"Save Changes"}),n.jsx(fe,{onClick:()=>d(!1),children:"Cancel"})]})})]})})]})},{Title:G4,Text:yi}=Ue,{Option:Zr}=nt,{RangePicker:Y4}=xo,X4=({exhibitionId:e,exhibitions:t,exhibitionsLoading:r,onExhibitionChange:i,typeFilter:s,setTypeFilter:a,bookingStatusFilter:o,setBookingStatusFilter:l,searchQuery:d,setSearchQuery:c,dateRange:u,setDateRange:f,resetFilters:h})=>{var x,g;const p=v=>{c(v.target.value)},y=v=>{f(v)};return n.jsxs(Ae,{className:"amenities-filters",children:[n.jsx(G4,{level:5,className:"filter-heading",children:"Filters"}),n.jsxs(ze,{gutter:[16,16],children:[n.jsx(ae,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(yi,{className:"filter-label",children:"Exhibition"}),n.jsx(nt,{placeholder:"Select an exhibition",style:{width:"100%"},loading:r,onChange:i,value:e,children:t.map(v=>n.jsx(Zr,{value:v._id,children:v.name},v._id))})]})}),n.jsx(ae,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(yi,{className:"filter-label",children:"Amenity Type"}),n.jsxs(nt,{mode:"multiple",placeholder:"Select types",style:{width:"100%"},value:s,onChange:a,maxTagCount:2,children:[n.jsx(Zr,{value:"facility",children:"Facility"}),n.jsx(Zr,{value:"service",children:"Service"}),n.jsx(Zr,{value:"equipment",children:"Equipment"}),n.jsx(Zr,{value:"other",children:"Other"})]})]})}),n.jsx(ae,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(yi,{className:"filter-label",children:"Booking Status"}),n.jsxs(nt,{mode:"multiple",placeholder:"Select statuses",style:{width:"100%"},value:o,onChange:l,maxTagCount:2,children:[n.jsx(Zr,{value:"confirmed",children:"Confirmed"}),n.jsx(Zr,{value:"approved",children:"Approved"}),n.jsx(Zr,{value:"pending",children:"Pending"}),n.jsx(Zr,{value:"rejected",children:"Rejected"}),n.jsx(Zr,{value:"cancelled",children:"Cancelled"})]})]})}),n.jsx(ae,{xs:24,md:8,lg:6,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(yi,{className:"filter-label",children:"Search"}),n.jsx(Re,{placeholder:"Search amenities",prefix:n.jsx(ms,{}),value:d,onChange:p,allowClear:!0})]})}),n.jsx(ae,{xs:24,md:16,lg:12,children:n.jsxs("div",{className:"filter-group",children:[n.jsx(yi,{className:"filter-label",children:"Booking Date Range"}),n.jsx(Y4,{style:{width:"100%"},onChange:y,value:u})]})}),n.jsx(ae,{xs:24,md:8,lg:12,children:n.jsx("div",{className:"filter-group",style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%"},children:n.jsxs(ke,{children:[n.jsx(fe,{icon:n.jsx(Is,{}),onClick:h,children:"Reset"}),n.jsx(fe,{type:"primary",icon:n.jsx(kc,{}),children:"Apply Filters"})]})})})]}),(s.length>0||o.length>0||d||u)&&n.jsxs(n.Fragment,{children:[n.jsx(Tt,{className:"filter-divider"}),n.jsxs("div",{children:[n.jsx(yi,{className:"filter-label",children:"Active Filters:"}),n.jsxs("div",{style:{marginTop:8},children:[s.map(v=>n.jsxs(Ne,{closable:!0,onClose:()=>a(s.filter(k=>k!==v)),className:`amenity-tag amenity-tag-${v}`,children:["Type: ",v]},`type-${v}`)),o.map(v=>n.jsxs(Ne,{closable:!0,onClose:()=>l(o.filter(k=>k!==v)),color:"blue",children:["Status: ",v]},`status-${v}`)),d&&n.jsxs(Ne,{closable:!0,onClose:()=>c(""),color:"purple",children:["Search: ",d]}),u&&n.jsxs(Ne,{closable:!0,onClose:()=>f(null),color:"green",children:["Date Range: ",(x=u[0])==null?void 0:x.format("MMM DD, YYYY")," - ",(g=u[1])==null?void 0:g.format("MMM DD, YYYY")]})]})]})]})]})},{Text:bk}=Ue,K4=({basicAmenities:e,extraAmenities:t,bookedStalls:r,calculatedAmenities:i})=>n.jsxs(ze,{gutter:[24,24],children:[n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsxs(Ae,{className:"stats-card stats-primary",bordered:!1,children:[n.jsx(bc,{style:{fontSize:24,color:"#1890ff"}}),n.jsx("div",{className:"stats-value",children:e.length}),n.jsx("div",{className:"stats-label",children:"Basic Amenities"})]})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsxs(Ae,{className:"stats-card stats-secondary",bordered:!1,children:[n.jsx(Fs,{style:{fontSize:24,color:"#52c41a"}}),n.jsx("div",{className:"stats-value",children:t.length}),n.jsx("div",{className:"stats-label",children:"Extra Amenities"})]})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsxs(Ae,{className:"stats-card stats-tertiary",bordered:!1,children:[n.jsx(qa,{style:{fontSize:24,color:"#fa8c16"}}),n.jsx("div",{className:"stats-value",children:r}),n.jsx("div",{className:"stats-label",children:"Booked Stalls"})]})}),n.jsx(ae,{xs:24,sm:12,md:6,children:n.jsxs(Ae,{className:"stats-card stats-quaternary",bordered:!1,children:[n.jsx(Mx,{style:{fontSize:24,color:"#722ed1"}}),n.jsx("div",{className:"stats-value",children:i}),n.jsx("div",{className:"stats-label",children:"Calculated Amenities"})]})})]}),{Text:gn,Title:xh}=Ue,mh=e=>{switch(e){case"facility":return{color:"#e6f7ff",borderColor:"#91d5ff",textColor:"#1890ff"};case"service":return{color:"#f6ffed",borderColor:"#b7eb8f",textColor:"#52c41a"};case"equipment":return{color:"#fff7e6",borderColor:"#ffd591",textColor:"#fa8c16"};default:return{color:"#f9f0ff",borderColor:"#d3adf7",textColor:"#722ed1"}}},Ml=({title:e,amenities:t,loading:r,onExport:i,isDynamicColumns:s=!1,isCalculated:a=!1,exhibitionId:o,amenityViewType:l="all"})=>{const[d,c]=N.useState([]),[u,f]=N.useState([]),[h,p]=N.useState(!1),y=N.useMemo(()=>!a||l==="all"?t:l==="basic"?t.filter(w=>w.hasOwnProperty("calculatedQuantity")||w.hasOwnProperty("perSqm")):l==="extra"?t.filter(w=>w.hasOwnProperty("rate")&&!w.hasOwnProperty("perSqm")):t,[t,a,l]);N.useEffect(()=>{if(!o){f([]),p(!1);return}p(!0),setTimeout(()=>{p(!1)},500)},[o]);const x=()=>{const w=new Map;return y.forEach(b=>{var _,A;if(b.stallId&&b.stallNumber){w.has(b.stallId)||w.set(b.stallId,{key:b.stallId,companyName:b.exhibitorName||"Unknown",stallNumber:b.stallNumber,dimension:b.dimensions?`${b.dimensions.width}x${b.dimensions.height}m`:"-",stallType:b.stallType||"-",area:b.area||((_=b.dimensions)!=null&&_.width&&((A=b.dimensions)!=null&&A.height)?b.dimensions.width*b.dimensions.height:"-"),bookingDate:b.bookingDate?new Date(b.bookingDate).toISOString().slice(0,10):"-",status:b.bookingStatus||"-",amenities:{}});const S=w.get(b.stallId);if(b.hasOwnProperty("calculatedQuantity"))S.amenities[b.name]=b.calculatedQuantity;else if(b.hasOwnProperty("perSqm")){const j=typeof S.area=="number"?S.area:0,C=Math.floor(j/b.perSqm)*b.quantity;S.amenities[b.name]=C>0?C:b.quantity}else if(b.hasOwnProperty("booked")&&b.booked){let j=1;typeof b.quantity=="number"?j=b.quantity:typeof b.quantity=="string"&&(j=parseInt(b.quantity,10),isNaN(j)&&(j=1)),S.amenities[b.name]=j}else b.hasOwnProperty("rate")&&(S.amenities[b.name]=0)}}),Array.from(w.values()).filter(b=>Object.keys(b.amenities).length>0)},g=()=>{const w=new Set;return y.forEach(E=>{const b=_=>a?!0:e.toLowerCase().includes("basic")?_.hasOwnProperty("perSqm"):e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra")?_.hasOwnProperty("rate"):!0;E.name&&b(E)&&w.add(E.name)}),Array.from(w)},v=()=>{const w=[{title:"Company Name",dataIndex:"companyName",key:"companyName",fixed:"left",width:180,render:A=>n.jsx(gn,{strong:!0,children:A}),sorter:(A,S)=>A.companyName.localeCompare(S.companyName)},{title:"Stall No.",dataIndex:"stallNumber",key:"stallNumber",width:100,render:A=>n.jsx(Br,{status:"success",text:A}),sorter:(A,S)=>A.stallNumber.localeCompare(S.stallNumber)},{title:"Dimension",dataIndex:"dimension",key:"dimension",width:120},{title:"Stall Type",dataIndex:"stallType",key:"stallType",width:120},{title:"Area (SQM)",dataIndex:"area",key:"area",width:100,render:A=>typeof A=="number"?A.toFixed(2):A,sorter:(A,S)=>{const j=typeof A.area=="number"?A.area:0,C=typeof S.area=="number"?S.area:0;return j-C}}],b=g().map(A=>({title:A,dataIndex:["amenities",A],key:A,width:100,render:S=>S==null?"-":S===0?n.jsx(gn,{type:"secondary",children:"0"}):S==="✓"?n.jsx(Br,{status:"success"}):n.jsx(gn,{strong:!0,children:S}),sorter:(S,j)=>{const C=S.amenities[A]||0,P=j.amenities[A]||0;return C-P}})),_={title:"Actions",key:"actions",width:80,fixed:"right",render:(A,S)=>n.jsx(ni,{overlay:n.jsxs(cr,{children:[n.jsx(cr.Item,{icon:n.jsx(Ds,{}),children:"View Details"},"view"),n.jsx(cr.Item,{icon:n.jsx($h,{}),children:"Edit"},"edit"),n.jsx(cr.Item,{icon:n.jsx(Ua,{}),children:"Settings"},"settings")]}),trigger:["click"],children:n.jsx(fe,{type:"text",icon:n.jsx(Bx,{})})})};return[...w,...b,_]},k=w=>{c(w)},T=x(),m=w=>n.jsxs("div",{style:{padding:"20px"},children:[n.jsx(xh,{level:5,children:"Stall Details"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:[Object.entries(w).map(([E,b])=>["key","amenities"].includes(E)?null:n.jsxs("div",{style:{marginBottom:"8px"},children:[n.jsxs(gn,{type:"secondary",style:{fontSize:"12px"},children:[E.charAt(0).toUpperCase()+E.slice(1).replace(/([A-Z])/g," $1"),":"]}),n.jsx("div",{children:n.jsx(gn,{strong:!0,children:b==null?"-":typeof b=="object"?JSON.stringify(b):String(b)})})]},E)),n.jsxs("div",{style:{marginBottom:"8px",gridColumn:"1 / -1"},children:[n.jsx(gn,{type:"secondary",style:{fontSize:"12px"},children:"Amenities:"}),n.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"4px"},children:Object.entries(w.amenities||{}).map(([E,b])=>n.jsxs(Ne,{color:"blue",children:[E,": ",b==="✓"?"Available":b]},E))})]})]})]});return n.jsx(Ae,{className:"amenities-card",title:n.jsxs(ke,{children:[n.jsx(xh,{level:5,style:{margin:0},children:e}),a&&n.jsxs(n.Fragment,{children:[n.jsx(Ne,{color:"green",children:"Calculated"}),l==="basic"&&n.jsx(Ne,{color:"blue",children:"Basic Amenities"}),l==="extra"&&n.jsx(Ne,{color:"purple",children:"Extra Amenities"}),l==="all"&&n.jsx(Ne,{color:"orange",children:"All Amenities"})]})]}),extra:n.jsx(ke,{children:n.jsx(fe,{type:"primary",icon:n.jsx(Os,{}),onClick:i,disabled:y.length===0,children:"Export"})}),children:y.length===0?n.jsx(xt,{image:xt.PRESENTED_IMAGE_SIMPLE,description:"No amenities data available"}):e.toLowerCase().includes("basic")&&!a?n.jsx(ft,{dataSource:y.map((w,E)=>({key:w._id||w.id||`basic-${E}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,E)=>n.jsxs(ke,{children:[n.jsx(gn,{strong:!0,children:w}),n.jsx(Ne,{color:mh(E.type).textColor,children:E.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Per SQM",dataIndex:"perSqm",key:"perSqm",render:w=>w?`1 per ${w} sqm`:"-"},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:w=>n.jsx(Ne,{color:"blue",children:w})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):(e.toLowerCase().includes("additional")||e.toLowerCase().includes("extra"))&&!a?n.jsx(ft,{dataSource:y.map((w,E)=>({key:w._id||w.id||`extra-${E}`,...w})),columns:[{title:"Name",dataIndex:"name",key:"name",render:(w,E)=>n.jsxs(ke,{children:[n.jsx(gn,{strong:!0,children:w}),n.jsx(Ne,{color:mh(E.type).textColor,children:E.type})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Rate",dataIndex:"rate",key:"rate",render:w=>n.jsxs(gn,{style:{color:"#1890ff"},children:["₹",w.toLocaleString()]})}],loading:r,pagination:{pageSize:10},className:"amenities-table"}):T.length===0?n.jsx(Ct,{message:"No stall data available",description:"Amenities exist but could not be linked to stalls. Make sure stalls are booked and have amenities assigned.",type:"info",showIcon:!0}):n.jsx(ft,{dataSource:T,columns:v(),loading:r||h,pagination:{pageSize:10},className:"amenities-table",scroll:{x:"max-content"},expandable:{expandedRowKeys:d,onExpandedRowsChange:k,expandedRowRender:m}})})},{Title:Q4,Text:gh}=Ue,{TabPane:wk}=An,Bl=(e,t)=>{const r=Fi.json_to_sheet(e),i=Fi.book_new();Fi.book_append_sheet(i,r,"Amenities");const s=gd(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Np.saveAs(a,`${t}.xlsx`)},J4=()=>{const e=hr(),{message:t}=Rs.useApp(),{exhibitions:r,loading:i}=ut(de=>de.exhibition),{bookings:s,loading:a}=ut(de=>de.booking),[o,l]=N.useState(null),[d,c]=N.useState([]),[u,f]=N.useState([]),[h,p]=N.useState([]),[y,x]=N.useState([]),[g,v]=N.useState(!1),[k,T]=N.useState({}),[m,w]=N.useState(!1),[E,b]=N.useState({current:1,pageSize:10,total:0}),[_,A]=N.useState([]),[S,j]=N.useState([]),[C,P]=N.useState(""),[M,X]=N.useState(null),[ee,q]=N.useState(0),[K,Q]=N.useState(0),[ie,Z]=N.useState("basic"),[R,U]=N.useState("basic");N.useEffect(()=>{e(Yn()),e(os({page:1,limit:100}))},[e]);const O=async(de,G=1,xe=10)=>{try{v(!0);const ge=await Pe.get("/bookings",{params:{exhibitionId:de,includeDetails:!0,populate:"stallIds.stallTypeId",page:G,limit:xe}});if(ge&&ge.data){const Te=ge.data.data.map(ue=>{const Me={...ue};return Me.stallIds&&(Me.stallIds=Me.stallIds.map($e=>($e.stallTypeId&&typeof $e.stallTypeId=="object"&&($e.type=$e.stallTypeId.name),$e))),Me}).filter(ue=>ue.exhibitionId._id===de&&["confirmed","approved"].includes(ue.status));x(Te),b({current:ge.data.pagination.page,pageSize:ge.data.pagination.limit,total:ge.data.pagination.total})}else x([]),b({current:1,pageSize:10,total:0})}catch(ge){console.error("Error fetching complete booking data:",ge),x([]),b({current:1,pageSize:10,total:0})}finally{v(!1)}};N.useEffect(()=>{if(o&&r.length>0){const de=r.find(G=>G._id===o);de&&(c(de.basicAmenities||[]),f(de.amenities||[]),O(o,E.current,E.pageSize))}else c([]),f([]),p([]),q(0),Q(0),x([])},[o,r]),N.useEffect(()=>{if(o&&r.length>0&&y.length>0){const de=r.find(G=>G._id===o);if(de){const G=y.flatMap(Te=>Te.stallIds.map(ue=>{const Me=ue.type||(ue.stallTypeId&&typeof ue.stallTypeId=="object"?ue.stallTypeId.name:k[ue.stallTypeId])||"-";return{stallId:ue._id,stallNumber:ue.number,bookingId:Te._id,exhibitorName:Te.companyName,bookingDate:Te.createdAt,dimensions:ue.dimensions,area:ue.dimensions.width*ue.dimensions.height,status:Te.status,stallType:Me}})),xe=y.flatMap(Te=>!Te.basicAmenities||Te.basicAmenities.length===0?Te.stallIds.flatMap(ue=>{const Me=ue.dimensions.width*ue.dimensions.height,$e=ue.type||(ue.stallTypeId&&typeof ue.stallTypeId=="object"?ue.stallTypeId.name:k[ue.stallTypeId])||"-";return(de.basicAmenities||[]).map(ct=>{const rt=Math.floor(Me/ct.perSqm)*ct.quantity;return{...ct,calculatedQuantity:rt>0?rt:ct.quantity,stallId:ue._id,stallNumber:ue.number,bookingId:Te._id,exhibitorId:Te.exhibitorId||"",exhibitorName:Te.companyName,bookingDate:Te.createdAt,dimensions:ue.dimensions,area:Me,bookingStatus:Te.status,stallType:$e}})}):Te.basicAmenities.flatMap(ue=>Te.stallIds.map(Me=>{const $e=Me.type||(Me.stallTypeId&&typeof Me.stallTypeId=="object"?Me.stallTypeId.name:k[Me.stallTypeId])||"-";return{...ue,stallId:Me._id,stallNumber:Me.number,bookingId:Te._id,exhibitorId:Te.exhibitorId||"",exhibitorName:Te.companyName,bookingDate:Te.createdAt,dimensions:Me.dimensions,area:Me.dimensions.width*Me.dimensions.height,bookingStatus:Te.status,stallType:$e}}))),ge=y.flatMap(Te=>!Te.extraAmenities||Te.extraAmenities.length===0?[]:Te.extraAmenities.flatMap(ue=>Te.stallIds.map(Me=>{const $e=Me.type||(Me.stallTypeId&&typeof Me.stallTypeId=="object"?Me.stallTypeId.name:k[Me.stallTypeId])||"-";return{...ue,booked:!0,stallId:Me._id,stallNumber:Me.number,bookingId:Te._id,exhibitorId:Te.exhibitorId||"",exhibitorName:Te.companyName,bookingDate:Te.createdAt,dimensions:Me.dimensions,area:Me.dimensions.width*Me.dimensions.height,bookingStatus:Te.status,stallType:$e,isExtraAmenity:!0,quantity:ue.quantity||1}})));let me=ge;ge.length===0&&de.amenities&&de.amenities.length>0&&(me=y.flatMap(ue=>ue.stallIds).flatMap((ue,Me)=>(de.amenities||[]).map(($e,ct)=>{var Oe;const rt=y.find(Qe=>Qe.stallIds.some(gt=>gt._id===ue._id)),Ie=(Oe=rt==null?void 0:rt.extraAmenities)==null?void 0:Oe.find(Qe=>Qe.name===$e.name),Be=!!Ie,Ve=`sim-${Me}-${ct}-${Date.now()}`,Le=ue.type||(ue.stallTypeId&&typeof ue.stallTypeId=="object"?ue.stallTypeId.name:k[ue.stallTypeId])||"-";return{...$e,id:Ve,booked:Be,stallId:ue._id,stallNumber:ue.number,bookingId:(rt==null?void 0:rt._id)||"",exhibitorId:(rt==null?void 0:rt.exhibitorId)||"",exhibitorName:(rt==null?void 0:rt.companyName)||"Unknown",bookingDate:(rt==null?void 0:rt.createdAt)||new Date().toISOString(),dimensions:ue.dimensions,area:ue.dimensions.width*ue.dimensions.height,bookingStatus:(rt==null?void 0:rt.status)||"approved",stallType:Le,isExtraAmenity:!0,quantity:Be?(Ie==null?void 0:Ie.quantity)||1:0}}))),p([...xe,...me]),q(G.length),Q(xe.length+me.length)}}else o&&r.length>0&&(p([]),q(0),Q(0))},[o,r,y,k]);const I=N.useMemo(()=>{let de=d;if(_.length>0&&(de=de.filter(G=>_.includes(G.type))),C){const G=C.toLowerCase();de=de.filter(xe=>xe.name.toLowerCase().includes(G)||xe.type.toLowerCase().includes(G)||xe.description&&xe.description.toLowerCase().includes(G))}return de},[d,_,C]),W=N.useMemo(()=>{let de=u;if(_.length>0&&(de=de.filter(G=>_.includes(G.type))),C){const G=C.toLowerCase();de=de.filter(xe=>xe.name.toLowerCase().includes(G)||xe.type.toLowerCase().includes(G)||xe.description&&xe.description.toLowerCase().includes(G))}return de},[u,_,C]),J=N.useMemo(()=>{let de=h;if(_.length>0&&(de=de.filter(G=>_.includes(G.type))),S.length>0&&(de=de.filter(G=>S.includes(G.bookingStatus))),C){const G=C.toLowerCase();de=de.filter(xe=>xe.name.toLowerCase().includes(G)||xe.type.toLowerCase().includes(G)||xe.description&&xe.description.toLowerCase().includes(G)||xe.stallNumber&&xe.stallNumber.toLowerCase().includes(G)||xe.exhibitorName&&xe.exhibitorName.toLowerCase().includes(G))}if(M&&M[0]&&M[1]){const G=M[0].startOf("day"),xe=M[1].endOf("day");de=de.filter(ge=>{if(!ge.bookingDate)return!1;const me=St(ge.bookingDate);return me.isAfter(G)&&me.isBefore(xe)})}return de},[h,_,S,C,M]),he=()=>{A([]),j([]),P(""),X(null)},ye=()=>{if(I.length===0){t.warning("No basic amenities to export");return}const de=I.map(ge=>({Name:ge.name,Type:ge.type,Description:ge.description||"","Per Sq. Meter":ge.perSqm,"Quantity Per Unit":ge.quantity,ID:ge._id||ge.id})),G=r.find(ge=>ge._id===o),xe=`${(G==null?void 0:G.name)||"Exhibition"}_Basic_Amenities`;Bl(de,xe),t.success("Basic amenities exported successfully")},H=()=>{if(W.length===0){t.warning("No extra amenities to export");return}const de=W.map(ge=>({Name:ge.name,Type:ge.type,Description:ge.description||"",Rate:ge.rate,ID:ge._id||ge.id})),G=r.find(ge=>ge._id===o),xe=`${(G==null?void 0:G.name)||"Exhibition"}_Extra_Amenities`;Bl(de,xe),t.success("Extra amenities exported successfully")},Y=()=>{if(J.length===0){t.warning("No calculated amenities to export");return}const de=new Map;J.filter(ue=>R==="all"?!0:R==="basic"?ue.hasOwnProperty("calculatedQuantity")||ue.hasOwnProperty("perSqm"):R==="extra"?ue.hasOwnProperty("rate")&&!ue.hasOwnProperty("perSqm"):!0).forEach(ue=>{if(ue.stallId&&ue.stallNumber){if(!de.has(ue.stallId)){const $e=ue.dimensions||{width:0,height:0},ct=ue.area||($e.width&&$e.height?$e.width*$e.height:0);de.set(ue.stallId,{"Company Name":ue.exhibitorName||"Unknown","Stall No.":ue.stallNumber,Dimension:$e?`${$e.width}x${$e.height}m`:"-","Stall Type":ue.stallType||"-","Area (SQM)":typeof ct=="number"?ct:0,"Booking Date":ue.bookingDate?new Date(ue.bookingDate).toLocaleDateString():"-","Booking Status":ue.bookingStatus||"-"})}const Me=de.get(ue.stallId);if(ue.hasOwnProperty("calculatedQuantity"))Me[ue.name]=ue.calculatedQuantity;else if(ue.hasOwnProperty("perSqm")){const $e=typeof Me["Area (SQM)"]=="number"?Me["Area (SQM)"]:0,ct=Math.floor($e/ue.perSqm)*ue.quantity;Me[ue.name]=ct>0?ct:ue.quantity}else if(ue.hasOwnProperty("booked")&&ue.booked){let $e=1;typeof ue.quantity=="number"?$e=ue.quantity:typeof ue.quantity=="string"&&($e=parseInt(ue.quantity,10),isNaN($e)&&($e=1)),Me[ue.name]=$e}else ue.hasOwnProperty("rate")&&(Me[ue.name]=0)}});const xe=Array.from(de.values()),ge=r.find(ue=>ue._id===o),me=R==="basic"?"Basic":R==="extra"?"Extra":"All",Te=`${(ge==null?void 0:ge.name)||"Exhibition"}_${me}_Calculated_Amenities`;Bl(xe,Te),t.success(`${me} calculated amenities exported successfully`)},le=async()=>{try{w(!0);const{default:de}=await rr(async()=>{const{default:xe}=await Promise.resolve().then(()=>xv);return{default:xe}},void 0),G=await de.getStallTypes();if(G&&G.data){const xe={};G.data.forEach(ge=>{ge._id&&(xe[ge._id]=ge.name)}),T(xe)}}catch(de){console.error("Error fetching stall types:",de)}finally{w(!1)}};return N.useEffect(()=>{o&&le()},[o]),n.jsxs("div",{className:"amenities-container",children:[n.jsxs("div",{className:"amenities-header",children:[n.jsx(Q4,{level:4,className:"amenities-title",children:"Amenities Management"}),n.jsx(gh,{type:"secondary",children:"View, filter, and export amenities data. See calculated amenities for booked stalls."})]}),n.jsx(X4,{exhibitionId:o,exhibitions:r,exhibitionsLoading:i,onExhibitionChange:l,typeFilter:_,setTypeFilter:A,bookingStatusFilter:S,setBookingStatusFilter:j,searchQuery:C,setSearchQuery:P,dateRange:M,setDateRange:X,resetFilters:he}),o&&n.jsx("div",{style:{marginBottom:24},children:n.jsx(K4,{basicAmenities:d,extraAmenities:u,bookedStalls:ee,calculatedAmenities:K})}),o?n.jsx(An,{activeKey:ie,onChange:Z,className:"amenities-tabs",items:[{key:"basic",label:n.jsxs("span",{children:[n.jsx($x,{}),"Basic Amenities"]}),children:n.jsx(Ml,{title:"Basic Amenities",amenities:I,loading:i,onExport:ye,exhibitionId:o})},{key:"extra",label:n.jsxs("span",{children:[n.jsx(Fs,{}),"Extra Amenities"]}),children:n.jsx(Ml,{title:"Additional Amenities",amenities:W,loading:i,onExport:H,exhibitionId:o})},{key:"calculated",label:n.jsxs("span",{children:[n.jsx(Ux,{}),"Calculated Amenities"]}),children:n.jsxs(n.Fragment,{children:[n.jsx(ze,{gutter:[0,16],children:n.jsx(ae,{span:24,children:n.jsx(Ae,{className:"filter-card",children:n.jsxs(ke,{children:[n.jsx(gh,{strong:!0,children:"View: "}),n.jsxs(yr.Group,{value:R,onChange:de=>U(de.target.value),optionType:"button",buttonStyle:"solid",children:[n.jsx(yr.Button,{value:"basic",children:"Basic Amenities"}),n.jsx(yr.Button,{value:"extra",children:"Extra Amenities"}),n.jsx(yr.Button,{value:"all",children:"All Amenities"})]})]})})})}),n.jsx(Ml,{title:"Calculated Amenities",amenities:J,loading:i,onExport:Y,isDynamicColumns:!0,isCalculated:!0,exhibitionId:o,amenityViewType:R})]})}]}):n.jsx("div",{style:{marginTop:24,textAlign:"center",padding:48,background:"#fff",borderRadius:8},children:n.jsx(xt,{description:"Please select an exhibition to view amenities",image:xt.PRESENTED_IMAGE_SIMPLE})})]})},{Title:Z4,Text:Fn}=Ue,{Option:Sk}=nt,{TabPane:vi}=An,{confirm:eA}=pt,{Search:tA}=Re,rA=()=>{const[e,t]=N.useState([]),[r,i]=N.useState(!0),[s,a]=N.useState(null),[o,l]=N.useState(""),[d,c]=N.useState("all"),u=tr(),f=vc();N.useEffect(()=>{h()},[]),N.useEffect(()=>{const j=new URLSearchParams(f.search).get("status");j&&c(j)},[f]);const h=async()=>{try{i(!0),a(null);const S=await Ir.getExhibitorBookings();t(S.data||[])}catch(S){console.error("Error fetching bookings:",S),a("Failed to load bookings. Please try again.")}finally{i(!1)}},p=S=>{eA({title:"Are you sure you want to cancel this booking?",icon:n.jsx(po,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await Ir.cancelExhibitorBooking(S),Se.success("Booking cancelled successfully"),h()}catch(j){console.error("Error cancelling booking:",j),Se.error("Failed to cancel booking")}}})},y=S=>{switch(S){case"approved":return n.jsxs(Ne,{color:"success",children:[n.jsx(Nt,{})," Approved"]});case"pending":return n.jsxs(Ne,{color:"warning",children:[n.jsx(br,{})," Pending"]});case"rejected":return n.jsxs(Ne,{color:"error",children:[n.jsx(Kr,{})," Rejected"]});case"confirmed":return n.jsxs(Ne,{color:"blue",children:[n.jsx(Nt,{})," Confirmed"]});case"cancelled":return n.jsxs(Ne,{color:"default",children:[n.jsx(Kr,{})," Cancelled"]});default:return n.jsx(Ne,{children:"Unknown"})}},x=S=>{switch(S){case"paid":return n.jsxs(Ne,{color:"success",children:[n.jsx(Va,{})," Paid"]});case"pending":return n.jsxs(Ne,{color:"warning",children:[n.jsx(br,{})," Pending"]});case"refunded":return n.jsxs(Ne,{color:"default",children:[n.jsx(Va,{})," Refunded"]});default:return n.jsx(Ne,{children:"Unknown"})}},g=async S=>{try{u(`/exhibitor/invoice/${S}`)}catch(j){console.error("Error navigating to invoice:",j),Se.error("Failed to access invoice. Please try again.")}},v=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(S,j)=>{var C,P;return n.jsxs(ke,{direction:"vertical",size:0,children:[n.jsx(Fn,{strong:!0,children:((C=j.exhibitionId)==null?void 0:C.name)||"N/A"}),n.jsx(Fn,{type:"secondary",style:{fontSize:"12px"},children:((P=j.exhibitionId)==null?void 0:P.venue)||"N/A"})]})},sorter:(S,j)=>{var C,P;return(((C=S.exhibitionId)==null?void 0:C.name)||"").localeCompare(((P=j.exhibitionId)==null?void 0:P.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:S=>n.jsx(ke,{direction:"vertical",size:4,children:(S==null?void 0:S.map(j=>n.jsx(Ne,{children:j.number},j._id)))||"N/A"})},{title:"Type",key:"stallType",render:(S,j)=>{var C;return n.jsx(ke,{direction:"vertical",size:4,children:((C=j.stallIds)==null?void 0:C.map(P=>{var M;return(M=P.stallTypeId)!=null&&M.name?n.jsx(Ne,{color:"blue",children:P.stallTypeId.name},P._id):n.jsx(Fn,{type:"secondary",children:"N/A"},P._id)}))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(S,j)=>{var C;return n.jsx(ke,{direction:"vertical",size:4,children:((C=j.stallIds)==null?void 0:C.map(P=>n.jsxs(Fn,{children:[P.dimensions.width,"m x ",P.dimensions.height,"m"]},P._id)))||"N/A"})}},{title:"Dates",key:"dates",render:(S,j)=>{var C,P;return n.jsxs(ke,{direction:"vertical",size:0,children:[n.jsxs(Fn,{children:[n.jsx(cn,{style:{marginRight:4}}),St((C=j.exhibitionId)==null?void 0:C.startDate).format("MMM D")," - ",St((P=j.exhibitionId)==null?void 0:P.endDate).format("MMM D, YYYY")]}),n.jsxs(Fn,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",St(j.createdAt).format("MMM D, YYYY")]})]})},sorter:(S,j)=>St(S.createdAt).unix()-St(j.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:S=>n.jsxs(Fn,{strong:!0,children:["₹",S.toLocaleString()]}),sorter:(S,j)=>S.amount-j.amount},{title:"Status",key:"status",dataIndex:"status",render:(S,j)=>S==="rejected"&&j.rejectionReason?n.jsxs(ht,{title:j.rejectionReason,children:[y(S),n.jsx(or,{style:{marginLeft:4,color:"#ff4d4f"}})]}):y(S),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(S,j)=>j.status===S},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:S=>x(S),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(S,j)=>j.paymentStatus===S},{title:"Actions",key:"actions",render:(S,j)=>n.jsxs(ke,{children:[n.jsx(fe,{type:"link",icon:n.jsx(Ds,{}),onClick:()=>u(`/exhibitor/bookings/${j._id}`),children:"Details"}),(j.status==="approved"||j.status==="confirmed")&&n.jsx(fe,{type:"link",icon:n.jsx(Th,{}),onClick:()=>g(j._id),children:"Invoice"}),j.status==="pending"&&n.jsx(fe,{type:"link",danger:!0,onClick:()=>p(j._id),children:"Cancel"})]})}],k=S=>{l(S)},T=e.filter(S=>{var P,M;const j=(((P=S.exhibitionId)==null?void 0:P.name)||"").toLowerCase().includes(o.toLowerCase())||S.stallIds.some(X=>X.number.toLowerCase().includes(o.toLowerCase()))||(((M=S.exhibitionId)==null?void 0:M.venue)||"").toLowerCase().includes(o.toLowerCase())||(S.customerName||"").toLowerCase().includes(o.toLowerCase()),C=d==="all"||S.status===d;return j&&C}),m=()=>e.length,w=()=>e.filter(S=>S.status==="pending").length,E=()=>e.filter(S=>S.status==="approved").length,b=()=>e.filter(S=>S.status==="confirmed").length,_=()=>e.filter(S=>S.status==="rejected").length,A=()=>e.filter(S=>S.status==="cancelled").length;return n.jsxs("div",{children:[n.jsx(Z4,{level:2,children:"My Bookings"}),n.jsx(Fn,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),s&&n.jsx(Ct,{message:"Error",description:s,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(fe,{type:"primary",onClick:h,children:"Retry"})}),n.jsxs(Ae,{style:{marginTop:24},children:[n.jsxs(ze,{gutter:[16,16],style:{marginBottom:16},children:[n.jsx(ae,{flex:"auto",children:n.jsx(tA,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:k,onChange:S=>l(S.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),n.jsx(ae,{children:n.jsx(fe,{icon:n.jsx(Is,{}),onClick:h,children:"Refresh"})})]}),n.jsxs(An,{defaultActiveKey:d,onChange:S=>c(S),children:[n.jsx(vi,{tab:`All Bookings (${m()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):T.length>0?n.jsx(ft,{columns:v,dataSource:T,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):n.jsx(xt,{description:o?"No bookings match your search criteria":"No bookings found",image:xt.PRESENTED_IMAGE_SIMPLE})},"all"),n.jsx(vi,{tab:`Pending (${w()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):n.jsx(ft,{columns:v,dataSource:e.filter(S=>S.status==="pending"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(xt,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),n.jsx(vi,{tab:`Approved (${E()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):n.jsx(ft,{columns:v,dataSource:e.filter(S=>S.status==="approved"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(xt,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),n.jsx(vi,{tab:`Confirmed (${b()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):n.jsx(ft,{columns:v,dataSource:e.filter(S=>S.status==="confirmed"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(xt,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),n.jsx(vi,{tab:`Rejected (${_()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):n.jsx(ft,{columns:v,dataSource:e.filter(S=>S.status==="rejected"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(xt,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),n.jsx(vi,{tab:`Cancelled (${A()})`,children:r?n.jsx(vn,{active:!0,paragraph:{rows:5}}):n.jsx(ft,{columns:v,dataSource:e.filter(S=>S.status==="cancelled"),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx(xt,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})},{Title:yh,Text:$l}=Ue,nA=()=>{var f,h,p,y,x,g,v,k,T,m,w,E,b;const{id:e}=Ps(),t=tr(),[r,i]=N.useState(null),[s,a]=N.useState(!0);N.useEffect(()=>{o()},[e]);const o=async()=>{try{a(!0);const _=await Ir.getExhibitorBooking(e||"");i(_.data)}catch(_){console.error("Error fetching booking details:",_),Se.error("Failed to load booking details")}finally{a(!1)}},l=async()=>{try{t(`/exhibitor/invoice/${e}`)}catch(_){console.error("Error fetching invoice:",_),Se.error("Failed to retrieve invoice")}},d=_=>{switch(_){case"approved":return n.jsxs(Ne,{color:"success",children:[n.jsx(Nt,{})," Approved"]});case"pending":return n.jsxs(Ne,{color:"warning",children:[n.jsx(br,{})," Pending"]});case"rejected":return n.jsx(Ne,{color:"error",children:"Rejected"});case"confirmed":return n.jsxs(Ne,{color:"blue",children:[n.jsx(Nt,{})," Confirmed"]});case"cancelled":return n.jsx(Ne,{color:"default",children:"Cancelled"});default:return n.jsx(Ne,{children:"Unknown"})}},c=_=>{switch(_){case"paid":return n.jsx(Ne,{color:"success",children:"Paid"});case"pending":return n.jsx(Ne,{color:"warning",children:"Pending"});case"refunded":return n.jsx(Ne,{color:"default",children:"Refunded"});default:return n.jsx(Ne,{children:"Unknown"})}},u=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:_=>`${_.dimensions.width}m × ${_.dimensions.height}m`},{title:"Size",key:"size",render:_=>`${_.dimensions.width*_.dimensions.height} m²`},{title:"Rate per m²",dataIndex:"ratePerSqm",key:"ratePerSqm",render:_=>`₹${_.toLocaleString()}`},{title:"Amount",key:"amount",render:(_,A,S)=>{var C;const j=(C=r.calculations)==null?void 0:C.stalls[S];return j?`₹${j.baseAmount.toLocaleString()}`:"N/A"}}];return s?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:n.jsx(Rt,{size:"large"})}):r?n.jsxs("div",{style:{padding:"20px"},children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(fe,{icon:n.jsx(Mh,{}),onClick:()=>t("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(r.status)&&n.jsx(fe,{type:"primary",icon:n.jsx(Qn,{}),onClick:l,children:"View Invoice"})]}),n.jsxs(Ae,{title:"Booking Details",style:{marginBottom:20},children:[n.jsxs(Xe,{bordered:!0,column:{xs:1,sm:2,md:3},children:[n.jsx(Xe.Item,{label:"Booking ID",children:r._id}),n.jsx(Xe.Item,{label:"Exhibition",children:((f=r.exhibitionId)==null?void 0:f.name)||"N/A"}),n.jsx(Xe.Item,{label:"Venue",children:((h=r.exhibitionId)==null?void 0:h.venue)||"N/A"}),n.jsx(Xe.Item,{label:"Booking Date",children:St(r.createdAt).format("MMM D, YYYY")}),n.jsxs(Xe.Item,{label:"Exhibition Dates",children:[St((p=r.exhibitionId)==null?void 0:p.startDate).format("MMM D, YYYY")," -",St((y=r.exhibitionId)==null?void 0:y.endDate).format("MMM D, YYYY")]}),n.jsx(Xe.Item,{label:"Status",children:d(r.status)}),n.jsx(Xe.Item,{label:"Payment Status",children:c(r.paymentStatus||"pending")}),n.jsxs(Xe.Item,{label:"Total Amount",children:["₹",((x=r.amount)==null?void 0:x.toLocaleString())||"N/A"]})]}),r.rejectionReason&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(yh,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),n.jsx($l,{children:r.rejectionReason})]})]}),n.jsx(Ae,{title:"Stall Details",style:{marginBottom:20},children:n.jsx(ft,{dataSource:r.stallIds||[],columns:u,rowKey:"_id",pagination:!1})}),n.jsx(Ae,{title:"Calculation Summary",children:n.jsx(ze,{gutter:[16,16],children:n.jsx(ae,{span:24,children:n.jsxs(Xe,{bordered:!0,column:1,children:[n.jsxs(Xe.Item,{label:"Base Amount",children:["₹",((g=r.calculations)==null?void 0:g.totalBaseAmount.toLocaleString())||"N/A"]}),((v=r.calculations)==null?void 0:v.totalDiscountAmount)>0&&n.jsxs(Xe.Item,{label:"Discount",children:["- ₹",((k=r.calculations)==null?void 0:k.totalDiscountAmount.toLocaleString())||"N/A"]}),((T=r.calculations)==null?void 0:T.totalDiscountAmount)>0&&n.jsxs(Xe.Item,{label:"Amount After Discount",children:["₹",((m=r.calculations)==null?void 0:m.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),(E=(w=r.calculations)==null?void 0:w.taxes)==null?void 0:E.map(_=>n.jsxs(Xe.Item,{label:`${_.name} (${_.rate}%)`,children:["+ ₹",_.amount.toLocaleString()||"N/A"]},_.name)),n.jsx(Xe.Item,{label:"Total Amount",children:n.jsxs($l,{strong:!0,style:{fontSize:"16px"},children:["₹",((b=r.amount)==null?void 0:b.toLocaleString())||"N/A"]})})]})})})}),n.jsx(Ae,{title:"Customer Information",style:{marginTop:20},children:n.jsxs(Xe,{bordered:!0,column:{xs:1,sm:2},children:[n.jsx(Xe.Item,{label:"Company Name",children:r.companyName}),n.jsx(Xe.Item,{label:"Contact Person",children:r.customerName}),n.jsx(Xe.Item,{label:"Email",children:r.customerEmail}),n.jsx(Xe.Item,{label:"Phone",children:r.customerPhone})]})})]}):n.jsx(Ae,{children:n.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[n.jsx(yh,{level:3,children:"Booking Not Found"}),n.jsx($l,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),n.jsx("div",{style:{marginTop:20},children:n.jsx(fe,{type:"primary",onClick:()=>t("/exhibitor/bookings"),children:"Back to Bookings"})})]})})},{Title:vh,Text:bh}=Ue,{TabPane:wh}=An,iA=()=>{var d;const[e]=oe.useForm(),[t,r]=N.useState(!1),[i,s]=N.useState(!1),a=hr(),o=ut(c=>c.exhibitorAuth.exhibitor);N.useEffect(()=>{(async()=>{try{s(!0);const u=await lr.getProfile();u.data&&a(dc({exhibitor:u.data,token:(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||""}))}catch{Se.error("Failed to fetch exhibitor profile")}finally{s(!1)}})()},[a]),N.useEffect(()=>{o&&e.setFieldsValue({companyName:o.companyName||"",contactPerson:o.contactPerson||"",email:o.email||"",phone:o.phone||"",address:o.address||"",website:o.website||"",description:o.description||"",panNumber:o.panNumber||"",gstNumber:o.gstNumber||"",city:o.city||"",state:o.state||"",pinCode:o.pinCode||""})},[o,e]);const l=async c=>{try{r(!0);const u=await lr.updateProfile(c),f=(o==null?void 0:o.token)||localStorage.getItem("exhibitor_token")||"";a(dc({exhibitor:{...o,...c},token:f})),Se.success("Profile updated successfully")}catch{Se.error("Failed to update profile")}finally{r(!1)}};return n.jsxs("div",{children:[n.jsx(vh,{level:2,children:"My Profile"}),n.jsx(bh,{type:"secondary",children:"Manage your exhibitor profile information"}),n.jsx(Ae,{style:{marginTop:24},loading:i,children:n.jsxs(An,{defaultActiveKey:"profile",children:[n.jsx(wh,{tab:"Profile Information",children:n.jsxs(ze,{gutter:32,children:[n.jsx(ae,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(Kn,{size:100,icon:n.jsx(jt,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:((d=o==null?void 0:o.companyName)==null?void 0:d.charAt(0).toUpperCase())||"E"}),n.jsx(vh,{level:4,children:o==null?void 0:o.companyName}),n.jsx(bh,{type:"secondary",children:o==null?void 0:o.email})]})}),n.jsx(ae,{span:18,children:n.jsxs(oe,{form:e,layout:"vertical",onFinish:l,initialValues:{companyName:(o==null?void 0:o.companyName)||"",contactPerson:(o==null?void 0:o.contactPerson)||"",email:(o==null?void 0:o.email)||"",phone:(o==null?void 0:o.phone)||"",address:(o==null?void 0:o.address)||"",website:(o==null?void 0:o.website)||"",description:(o==null?void 0:o.description)||"",panNumber:(o==null?void 0:o.panNumber)||"",gstNumber:(o==null?void 0:o.gstNumber)||"",city:(o==null?void 0:o.city)||"",state:(o==null?void 0:o.state)||"",pinCode:(o==null?void 0:o.pinCode)||""},children:[n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:n.jsx(Re,{prefix:n.jsx(Sc,{}),placeholder:"Company Name"})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:n.jsx(Re,{prefix:n.jsx(jt,{}),placeholder:"Contact Person"})})})]}),n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(Re,{prefix:n.jsx(Ln,{}),placeholder:"Email",disabled:!0})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:n.jsx(Re,{prefix:n.jsx(jc,{}),placeholder:"Phone Number"})})})]}),n.jsx(oe.Item,{name:"address",label:"Address",children:n.jsx(Re.TextArea,{rows:2,placeholder:"Company Address"})}),n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:8,children:n.jsx(oe.Item,{name:"city",label:"City",children:n.jsx(Re,{placeholder:"City"})})}),n.jsx(ae,{span:8,children:n.jsx(oe.Item,{name:"state",label:"State",children:n.jsx(Re,{placeholder:"State"})})}),n.jsx(ae,{span:8,children:n.jsx(oe.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(Re,{placeholder:"PIN Code",maxLength:6})})})]}),n.jsxs(ze,{gutter:16,children:[n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(Re,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),n.jsx(ae,{span:12,children:n.jsx(oe.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(Re,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),n.jsx(oe.Item,{name:"website",label:"Website",children:n.jsx(Re,{placeholder:"https://www.yourcompany.com"})}),n.jsx(oe.Item,{name:"description",label:"Company Description",children:n.jsx(Re.TextArea,{rows:4,placeholder:"Brief description of your company"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",loading:t,icon:n.jsx(kh,{}),children:"Save Changes"})})]})})]})},"profile"),n.jsx(wh,{tab:"Change Password",children:n.jsxs(oe,{layout:"vertical",onFinish:c=>{Se.success("Password updated successfully")},children:[n.jsx(oe.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(Re.Password,{placeholder:"Current Password"})}),n.jsx(oe.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(Re.Password,{placeholder:"New Password"})}),n.jsx(oe.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:c})=>({validator(u,f){return!f||c("newPassword")===f?Promise.resolve():Promise.reject(new Error("The two passwords do not match"))}})],children:n.jsx(Re.Password,{placeholder:"Confirm New Password"})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})},sA="/api",Ba=Kc({reducerPath:"exhibitorInvoiceApi",baseQuery:Hc({baseUrl:sA,credentials:"include",prepareHeaders:e=>{const t=localStorage.getItem("exhibitor_token");return t&&e.set("authorization",`Bearer ${t}`),e.set("Content-Type","application/json"),e.set("Accept","application/json"),e}}),tagTypes:["ExhibitorInvoice"],endpoints:e=>({getExhibitorInvoice:e.query({query:t=>({url:`/exhibitor-bookings/${t}/invoice`,method:"GET"}),transformResponse:t=>t,transformErrorResponse:t=>t,providesTags:(t,r,i)=>[{type:"ExhibitorInvoice",id:i}]}),downloadExhibitorInvoice:e.mutation({query:t=>({url:`/exhibitor-bookings/${t}/invoice/download`,method:"GET",responseHandler:r=>r.blob()})}),shareViaEmail:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/email`,method:"POST",body:r})}),shareViaWhatsApp:e.mutation({query:({bookingId:t,...r})=>({url:`/exhibitor-bookings/${t}/invoice/share/whatsapp`,method:"POST",body:r})})})}),{useGetExhibitorInvoiceQuery:aA,useDownloadExhibitorInvoiceMutation:oA,useShareViaEmailMutation:lA,useShareViaWhatsAppMutation:cA}=Ba,{Title:dA,Text:uA}=Ue,hA=()=>{var E,b,_,A,S,j,C,P,M,X,ee,q,K,Q,ie,Z,R,U,O;const{id:e}=Ps(),{data:t,isLoading:r,error:i}=aA(e||""),[s]=oA(),[a]=lA(),[o]=cA(),[l,d]=N.useState(!1),[c,u]=N.useState(!1),[f]=oe.useForm(),[h]=oe.useForm(),[p,y]=N.useState(0),[x,g]=N.useState(!1),v=async()=>{if(e)try{g(!0),y(0),Se.loading({content:"Preparing invoice...",key:"download"});const W=(()=>{let J=0;const he=setInterval(()=>{J+=5,J<=90?(y(J),J%25===0&&Se.loading({content:`Downloading: ${J}% complete`,key:"download"})):clearInterval(he)},200);return he})();try{const J=await s(e).unwrap();clearInterval(W),y(100),Se.loading({content:"Finalizing download...",key:"download"});const he=URL.createObjectURL(J),ye=document.createElement("a");ye.href=he,ye.download=`Invoice-${(t==null?void 0:t.invoiceNumber)||e||"download"}.pdf`,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(he),Se.success({content:"Invoice downloaded successfully",key:"download"})}catch(J){throw clearInterval(W),J}}catch(I){console.error("Error downloading PDF:",I),Se.error({content:"Failed to download invoice",key:"download"})}finally{g(!1),setTimeout(()=>y(0),500)}},k=()=>{d(!0)},T=()=>{u(!0)},m=async I=>{try{await a({bookingId:e||"",email:I.email,message:I.message}).unwrap(),Se.success(`Invoice sent to ${I.email}`),d(!1),f.resetFields()}catch(W){console.error("Error sending email:",W),Se.error("Failed to send email")}},w=async I=>{try{await o({bookingId:e||"",phoneNumber:I.phoneNumber}).unwrap();const W=I.phoneNumber.replace(/\D/g,""),J=encodeURIComponent(I.message);window.open(`https://wa.me/${W}?text=${J}`,"_blank"),u(!1),h.resetFields()}catch(W){console.error("Error opening WhatsApp:",W),Se.error("Failed to open WhatsApp")}};return r?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:n.jsx(Rt,{size:"large"})}):i||!t?n.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[n.jsx(dA,{level:3,children:"Invoice Not Found"}),n.jsx(uA,{children:"The requested invoice could not be loaded. Please try again later."})]}):n.jsxs(n.Fragment,{children:[n.jsxs(Ae,{title:"Invoice Details",style:{margin:"20px"},children:[n.jsx(ze,{gutter:[16,24],children:n.jsx(ae,{span:24,children:n.jsxs(ke,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(ke,{children:[n.jsx(fe,{icon:n.jsx(Os,{}),onClick:v,loading:x&&p<100,disabled:x&&p>=100,children:"Download PDF"}),n.jsx(fe,{icon:n.jsx(Ln,{}),onClick:k,disabled:x,children:"Share via Email"}),n.jsx(fe,{icon:n.jsx(Bh,{}),onClick:T,disabled:x,children:"Share via WhatsApp"})]}),x&&n.jsx(fo,{percent:p,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),n.jsx(Tt,{}),n.jsx(Fp,{booking:{...t.bookingId,customerGSTIN:(E=t.bookingId)!=null&&E.customerGSTIN||((b=t.bookingId)==null?void 0:b.customerGSTIN)===""?t.bookingId.customerGSTIN:"N/A",customerAddress:(_=t.bookingId)!=null&&_.customerAddress||((A=t.bookingId)==null?void 0:A.customerAddress)===""?t.bookingId.customerAddress:"N/A",invoiceNumber:t.invoiceNumber,exhibitionId:{...t.bookingId.exhibitionId,companyName:((S=t.bookingId.exhibitionId)==null?void 0:S.companyName)||"",bankName:((j=t.bookingId.exhibitionId)==null?void 0:j.bankName)||"",bankAccount:((C=t.bookingId.exhibitionId)==null?void 0:C.bankAccount)||"",bankAccountName:((P=t.bookingId.exhibitionId)==null?void 0:P.bankAccountName)||"",bankBranch:((M=t.bookingId.exhibitionId)==null?void 0:M.bankBranch)||"",bankIFSC:((X=t.bookingId.exhibitionId)==null?void 0:X.bankIFSC)||"",companyCIN:((ee=t.bookingId.exhibitionId)==null?void 0:ee.companyCIN)||"",companyPAN:((q=t.bookingId.exhibitionId)==null?void 0:q.companyPAN)||"",companySAC:((K=t.bookingId.exhibitionId)==null?void 0:K.companySAC)||"",companyGST:((Q=t.bookingId.exhibitionId)==null?void 0:Q.companyGST)||"",companyEmail:((ie=t.bookingId.exhibitionId)==null?void 0:ie.companyEmail)||"",companyWebsite:((Z=t.bookingId.exhibitionId)==null?void 0:Z.companyWebsite)||"",companyAddress:((R=t.bookingId.exhibitionId)==null?void 0:R.companyAddress)||""},calculations:{...t.bookingId.calculations,stalls:((O=(U=t.bookingId.calculations)==null?void 0:U.stalls)==null?void 0:O.map(I=>({...I,discount:I.discount?{...I.discount,type:I.discount.type||"percentage",value:I.discount.value}:void 0})))||[]}}})]}),n.jsx(pt,{title:"Share Invoice via Email",visible:l,onCancel:()=>d(!1),footer:null,children:n.jsxs(oe,{form:f,layout:"vertical",onFinish:m,children:[n.jsx(oe.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(Re,{placeholder:"example@example.com"})}),n.jsx(oe.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(Re.TextArea,{rows:4})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(pt,{title:"Share Invoice via WhatsApp",visible:c,onCancel:()=>u(!1),footer:null,children:n.jsxs(oe,{form:h,layout:"vertical",onFinish:w,children:[n.jsx(oe.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:n.jsx(Re,{placeholder:"+1234567890"})}),n.jsx(oe.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${t.invoiceNumber}.`,children:n.jsx(Re.TextArea,{rows:4})}),n.jsx(oe.Item,{children:n.jsx(fe,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})},fA=fr(()=>rr(()=>import("./Profile-pjpivlBe.js"),__vite__mapDeps([0,1,2,3]))),pA=fr(()=>rr(()=>import("./Settings-7lKtozgo.js"),__vite__mapDeps([4,1,2,3]))),xA=fr(()=>rr(()=>import("./index-DqlSwRRM.js"),__vite__mapDeps([5,1,2,3]))),mA=fr(()=>rr(()=>import("./index-Ahak6Wm8.js"),__vite__mapDeps([6,1,2,3]))),gA=fr(()=>rr(()=>import("./index-BnI-KQ2-.js"),__vite__mapDeps([7,1,2,3]))),yA=fr(()=>rr(()=>import("./index-CDFsR1o5.js"),__vite__mapDeps([8,1,2,3]))),vA=fr(()=>rr(()=>import("./index-Debrw9F4.js"),__vite__mapDeps([9,1,10,11,2,3]))),bA=fr(()=>rr(()=>import("./index-9A4FFAsW.js"),__vite__mapDeps([12,1,2,3]))),wA=fr(()=>rr(()=>import("./edit-CuRt1fT3.js"),__vite__mapDeps([13,1,10,11,2,3]))),SA=fr(()=>rr(()=>import("./index-DxE3Dla6.js"),__vite__mapDeps([14,1,3,2]))),jA=fr(()=>rr(()=>import("./index-Bk-L6djj.js"),__vite__mapDeps([15,1,2,3]))),EA=fr(()=>rr(()=>import("./index-BNW7guJz.js"),__vite__mapDeps([16,1,3,2]))),_A=fr(()=>rr(()=>import("./index-DW8o6y-L.js"),__vite__mapDeps([17,1,3,2]))),TA=fr(()=>rr(()=>import("./index-ykipEumD.js"),__vite__mapDeps([18,1,3,2]))),AA=fr(()=>rr(()=>import("./index-mWyePFbu.js"),__vite__mapDeps([19,1,2,3]))),kA=fr(()=>rr(()=>import("./index-BlrrYI1G.js"),__vite__mapDeps([20,1,2,3]))),wt=({children:e})=>ut(r=>r.auth.isAuthenticated)?e:n.jsx(Cc,{to:"/login"}),bi=({children:e})=>ut(r=>r.exhibitorAuth.isAuthenticated)?e:n.jsx(Cc,{to:"/"});function CA(){return n.jsx(Rs,{children:n.jsx(cv,{children:n.jsx(zx,{children:n.jsxs(Wx,{children:[n.jsx(He,{path:"/",element:n.jsx(lv,{})}),n.jsx(He,{path:"/login",element:n.jsx(wy,{})}),n.jsx(He,{path:"/exhibitions",element:n.jsx(Mv,{})}),n.jsx(He,{path:"/exhibitions/:id",element:n.jsx(Dv,{})}),n.jsx(He,{path:"/exhibitions/:id/layout",element:n.jsx(Fv,{})}),n.jsx(He,{path:"/exhibitor/dashboard",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx(Ty,{})})})}),n.jsx(He,{path:"/exhibitor/profile",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx(iA,{})})})}),n.jsx(He,{path:"/exhibitor/bookings",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx(rA,{})})})}),n.jsx(He,{path:"/exhibitor/bookings/:id",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx(nA,{})})})}),n.jsx(He,{path:"/exhibitor/support",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx("div",{children:"Help & Support"})})})}),n.jsx(He,{path:"/exhibitor/invoice/:id",element:n.jsx(bi,{children:n.jsx(ci,{children:n.jsx(hA,{})})})}),n.jsx(He,{path:"/dashboard",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(Ey,{})})})}),n.jsx(He,{path:"/account",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(fA,{})})})}),n.jsx(He,{path:"/exhibition",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(yA,{})})})}),n.jsx(He,{path:"/exhibition/create",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(vA,{})})})}),n.jsx(He,{path:"/exhibition/:id",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(bA,{})})})}),n.jsx(He,{path:"/exhibition/:id/space",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(SA,{})})})}),n.jsx(He,{path:"/exhibition/:id/layout",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(jA,{})})})}),n.jsx(He,{path:"/exhibition/:id/halls",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(EA,{})})})}),n.jsx(He,{path:"/exhibition/:id/stalls",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(_A,{})})})}),n.jsx(He,{path:"/exhibition/:id/fixtures",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(TA,{})})})}),n.jsx(He,{path:"/exhibition/:id/edit",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(wA,{})})})}),n.jsx(He,{path:"/stall/list",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(AA,{})})})}),n.jsx(He,{path:"/stall-types",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(kA,{})})})}),n.jsx(He,{path:"/bookings",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(F4,{})})})}),n.jsx(He,{path:"/bookings/create",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(L4,{})})})}),n.jsx(He,{path:"/amenities",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(J4,{})})})}),n.jsx(He,{path:"/invoices",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(U4,{})})})}),n.jsx(He,{path:"/invoice/:id",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(M4,{})})})}),n.jsx(He,{path:"/index",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(mA,{})})})}),n.jsx(He,{path:"/settings",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(pA,{})})})}),n.jsx(He,{path:"/roles",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(xA,{})})})}),n.jsx(He,{path:"/notifications",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(gA,{})})})}),n.jsx(He,{path:"/exhibitors",element:n.jsx(wt,{children:n.jsx(bt,{children:n.jsx(H4,{})})})}),n.jsx(He,{path:"*",element:n.jsx(Cc,{to:"/",replace:!0})})]})})})})}const IA=async()=>{try{return(await Pe.get("/roles")).data}catch(e){throw console.error("Error fetching roles:",e),e}},NA=async e=>{try{return(await Pe.get(`/roles/${e}`)).data}catch(t){throw console.error("Error fetching role:",t),t}},FA=async e=>{try{return(await Pe.post("/roles",e)).data}catch(t){throw console.error("Error creating role:",t),t}},RA=async(e,t)=>{try{return(await Pe.put(`/roles/${e}`,t)).data}catch(r){throw console.error("Error updating role:",r),r}},PA=async e=>{try{await Pe.delete(`/roles/${e}`)}catch(t){throw console.error("Error deleting role:",t),t}},DA={roles:[],role:null,loading:!1,error:null},Ul=Ye("roles/fetchRoles",async(e,{rejectWithValue:t})=>{var r,i;try{return await IA()}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch roles")}}),zl=Ye("roles/fetchRoleById",async(e,{rejectWithValue:t})=>{var r,i;try{return await NA(e)}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch role")}}),Wl=Ye("roles/addRole",async(e,{rejectWithValue:t})=>{var r,i;try{return await FA(e)}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to create role")}}),ql=Ye("roles/modifyRole",async({id:e,roleData:t},{rejectWithValue:r})=>{var i,s;try{return await RA(e,t)}catch(a){return r(((s=(i=a.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to update role")}}),Vl=Ye("roles/removeRole",async(e,{rejectWithValue:t})=>{var r,i;try{return await PA(e),e}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to delete role")}}),Rp=gr({name:"roles",initialState:DA,reducers:{clearRoleError:e=>{e.error=null},setSelectedRole:(e,t)=>{e.role=t.payload}},extraReducers:e=>{e.addCase(Ul.pending,t=>{t.loading=!0,t.error=null}).addCase(Ul.fulfilled,(t,r)=>{t.loading=!1,t.roles=r.payload}).addCase(Ul.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(zl.pending,t=>{t.loading=!0,t.error=null}).addCase(zl.fulfilled,(t,r)=>{t.loading=!1,t.role=r.payload}).addCase(zl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Wl.pending,t=>{t.loading=!0,t.error=null}).addCase(Wl.fulfilled,(t,r)=>{t.loading=!1,t.roles.push(r.payload)}).addCase(Wl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(ql.pending,t=>{t.loading=!0,t.error=null}).addCase(ql.fulfilled,(t,r)=>{var s;t.loading=!1;const i=t.roles.findIndex(a=>a._id===r.payload._id);i!==-1&&(t.roles[i]=r.payload),((s=t.role)==null?void 0:s._id)===r.payload._id&&(t.role=r.payload)}).addCase(ql.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Vl.pending,t=>{t.loading=!0,t.error=null}).addCase(Vl.fulfilled,(t,r)=>{var i;t.loading=!1,t.roles=t.roles.filter(s=>s._id!==r.payload),((i=t.role)==null?void 0:i._id)===r.payload&&(t.role=null)}).addCase(Vl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearRoleError:jk,setSelectedRole:Ek}=Rp.actions,OA=Rp.reducer,LA=async()=>{try{return(await Pe.get("/users")).data}catch(e){throw console.error("Error fetching users:",e),e}},MA=async e=>{try{return(await Pe.get(`/users/${e}`)).data}catch(t){throw console.error("Error fetching user:",t),t}},BA=async e=>{try{return(await Pe.post("/users",e)).data}catch(t){throw console.error("Error creating user:",t),t}},$A=async(e,t)=>{try{return(await Pe.put(`/users/${e}`,t)).data}catch(r){throw console.error("Error updating user:",r),r}},UA=async e=>{try{await Pe.delete(`/users/${e}`)}catch(t){throw console.error("Error deleting user:",t),t}},zA={users:[],selectedUser:null,loading:!1,error:null},Hl=Ye("users/fetchUsers",async(e,{rejectWithValue:t})=>{var r,i;try{return await LA()}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch users")}}),Gl=Ye("users/fetchUserById",async(e,{rejectWithValue:t})=>{var r,i;try{return await MA(e)}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to fetch user")}}),Yl=Ye("users/addUser",async(e,{rejectWithValue:t})=>{var r,i;try{return await BA(e)}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to create user")}}),Xl=Ye("users/modifyUser",async({id:e,userData:t},{rejectWithValue:r})=>{var i,s;try{return await $A(e,t)}catch(a){return r(((s=(i=a.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to update user")}}),Kl=Ye("users/removeUser",async(e,{rejectWithValue:t})=>{var r,i;try{return await UA(e),e}catch(s){return t(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to delete user")}}),Pp=gr({name:"users",initialState:zA,reducers:{clearUserError:e=>{e.error=null},setSelectedUser:(e,t)=>{e.selectedUser=t.payload}},extraReducers:e=>{e.addCase(Hl.pending,t=>{t.loading=!0,t.error=null}).addCase(Hl.fulfilled,(t,r)=>{t.loading=!1,t.users=r.payload}).addCase(Hl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Gl.pending,t=>{t.loading=!0,t.error=null}).addCase(Gl.fulfilled,(t,r)=>{t.loading=!1,t.selectedUser=r.payload}).addCase(Gl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Yl.pending,t=>{t.loading=!0,t.error=null}).addCase(Yl.fulfilled,(t,r)=>{t.loading=!1,t.users.push(r.payload)}).addCase(Yl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Xl.pending,t=>{t.loading=!0,t.error=null}).addCase(Xl.fulfilled,(t,r)=>{var s;t.loading=!1;const i=t.users.findIndex(a=>a._id===r.payload._id);i!==-1&&(t.users[i]=r.payload),((s=t.selectedUser)==null?void 0:s._id)===r.payload._id&&(t.selectedUser=r.payload)}).addCase(Xl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload}).addCase(Kl.pending,t=>{t.loading=!0,t.error=null}).addCase(Kl.fulfilled,(t,r)=>{var i;t.loading=!1,t.users=t.users.filter(s=>s._id!==r.payload),((i=t.selectedUser)==null?void 0:i._id)===r.payload&&(t.selectedUser=null)}).addCase(Kl.rejected,(t,r)=>{t.loading=!1,t.error=r.payload})}}),{clearUserError:_k,setSelectedUser:Tk}=Pp.actions,WA=Pp.reducer,Ql=Kc({reducerPath:"bookingApi",baseQuery:Hc({baseUrl:"/api"}),endpoints:e=>({getBookings:e.query({query:()=>"/bookings"}),getBooking:e.query({query:t=>`/bookings/${t}`}),createBooking:e.mutation({query:t=>({url:"/bookings",method:"POST",body:t})}),updateBookingStatus:e.mutation({query:({id:t,status:r})=>({url:`/bookings/${t}/status`,method:"PATCH",body:{status:r}})})})}),qA=qx({reducer:{auth:hm,exhibitorAuth:D1,exhibition:qv,booking:zv,exhibitor:D4,settings:wg,role:OA,user:WA,[Ql.reducerPath]:Ql.reducer,[Ma.reducerPath]:Ma.reducer,[Ba.reducerPath]:Ba.reducer},middleware:e=>e().concat(Ql.middleware).concat(Ma.middleware).concat(Ba.middleware)}),VA={token:{colorPrimary:"#7C3AED",borderRadius:8,colorBgContainer:"#FFFFFF",colorBgLayout:"#F9FAFB",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},components:{Layout:{siderBg:"#FFFFFF",headerBg:"#FFFFFF"},Menu:{itemBg:"transparent",itemSelectedBg:"#F3F4F6",itemHoverBg:"#F3F4F6",itemSelectedColor:"#7C3AED",itemColor:"#6B7280"},Card:{boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},Button:{borderRadius:8,primaryShadow:"0 1px 2px 0 rgb(124 58 237 / 0.05)"},Table:{borderRadius:8,headerBg:"#F9FAFB"}}};Zl.createRoot(document.getElementById("root")).render(n.jsx(_t.StrictMode,{children:n.jsx(Vx,{store:qA,children:n.jsx(Hx,{theme:VA,children:n.jsx(Rs,{children:n.jsx(CA,{})})})})}));export{La as A,vl as B,bl as C,yl as D,O0 as E,QA as F,cv as G,pv as H,ak as I,dk as J,Sl as K,El as L,jl as M,fg as N,_l as O,D0 as S,qh as a,el as b,Lb as c,Ul as d,Wl as e,ka as f,Xl as g,Yl as h,Hl as i,n as j,Tk as k,Kl as l,ql as m,ir as n,JA as o,on as p,ZA as q,Vl as r,um as s,Yn as t,Ca as u,wl as v,ik as w,F0 as x,Fr as y,gl as z};
