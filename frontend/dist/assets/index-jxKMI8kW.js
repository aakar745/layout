import{a as f,C as Ge,j as e}from"./index-nu_xN7Rs.js";import{r as d,j as Je,i as Xe}from"./vendor-react-BNeW3y6d.js";import{W as o,T as et,z as tt,n as Ce,a6 as $,a4 as k,a5 as a,a3 as z,P as A,J as st,c as p,bn as Z,al as ge,E as me,u as nt,d as G,Y as w,U as J,b as L,D as je,ap as _,aZ as fe,S as U,aO as Se,aI as D,x as X,h as Q,m as ee,bq as be,C as ke,aE as te,V as rt,R as we,j as lt,br as at,a as Y,p as it,bd as ot,B as ct,K as v,Z as ve,N as Te,bb as dt,ak as ut}from"./vendor-antd-CPyaZRZ0.js";import"./vendor-utils-DNTYNPA0.js";import"./vendor-styling-DBLAJE0-.js";import"./vendor-canvas-BRbMLhVA.js";const S=n=>{var l,j;const r=((j=(l=n.response)==null?void 0:l.data)==null?void 0:j.message)||"An error occurred";throw new Error(r)},T={sendLettersManually:async(n,r)=>{try{return(await f.post(`/exhibition-letters/${n}/send`,{letterType:r})).data}catch(l){return S(l)}},getLetters:async(n,r={})=>{try{const l=new URLSearchParams;return r.page&&l.append("page",r.page.toString()),r.limit&&l.append("limit",r.limit.toString()),r.letterType&&l.append("letterType",r.letterType),r.status&&l.append("status",r.status),r.search&&l.append("search",r.search),(await f.get(`/exhibition-letters/${n}?${l.toString()}`)).data}catch(l){return S(l)}},getStatistics:async n=>{try{return(await f.get(`/exhibition-letters/${n}/statistics`)).data}catch(r){return S(r)}},previewLetter:async(n,r,l)=>{try{return(await f.get(`/exhibition-letters/${n}/preview/${r}?letterType=${l}`)).data}catch(j){return S(j)}},resendLetter:async n=>{try{return(await f.post(`/exhibition-letters/letter/${n}/resend`)).data}catch(r){return S(r)}},getUpcomingSchedules:async()=>{try{return(await f.get("/exhibition-letters/schedules/upcoming")).data}catch(n){return S(n)}},deleteLetter:async(n,r=!1)=>{try{const l=`/exhibition-letters/letter/${n}${r?"?force=true":""}`;return(await f.delete(l)).data}catch(l){return S(l)}},bulkDeleteLetters:async(n,r)=>{try{return(await f.post(`/exhibition-letters/${n}/bulk-delete`,r)).data}catch(l){return S(l)}},cleanOldLetters:async(n,r={})=>{try{return(await f.post(`/exhibition-letters/${n}/clean-old`,r)).data}catch(l){return S(l)}},getLetterById:async n=>{try{return(await f.get(`/exhibition-letters/letter/${n}`)).data}catch(r){return S(r)}},downloadLetterPDF:async n=>{try{return(await f.get(`/exhibition-letters/letter/${n}/download`,{responseType:"blob"})).data}catch(r){return S(r)}},resendBothLetters:async(n,r,l)=>{try{return(await f.post(`/exhibition-letters/${n}/resend-both/${r}`,{letterTypes:l})).data}catch(j){return S(j)}}},{Title:xt,Text:y,Paragraph:ht}=et,{Option:R}=z,{Search:pt}=st,{TabPane:Le}=Ce,{RangePicker:wt}=dt,{Step:vt}=ut,Tt=()=>{var ye;const[n,r]=d.useState(()=>localStorage.getItem("letters-selected-exhibition")||""),[l,j]=d.useState([]),[g,Pe]=d.useState(null),[Ie,$e]=d.useState([]),[Re,se]=d.useState(!1),[V,ne]=d.useState(!1),[re,E]=d.useState(0),[De,H]=d.useState(""),[P,M]=d.useState({current:1,pageSize:10,total:0}),[F,le]=d.useState("all"),[O,ae]=d.useState(""),[N,ie]=d.useState(""),[yt,gt]=d.useState(!1),[ze,q]=d.useState(!1),[h,Fe]=d.useState(null),[Be,oe]=d.useState(!1),ce=Je(),{exhibitions:B}=Xe(t=>t.exhibition);d.useEffect(()=>{ce(Ge())},[ce]);const Ae=t=>{r(t),t?localStorage.setItem("letters-selected-exhibition",t):localStorage.removeItem("letters-selected-exhibition"),M(s=>({...s,current:1}))};d.useEffect(()=>{n&&B.length>0&&(B.some(s=>s._id===n)||(r(""),localStorage.removeItem("letters-selected-exhibition")))},[n,B]),d.useEffect(()=>{n&&(C(),I())},[n,O,F,N,P.current,P.pageSize]),d.useEffect(()=>{Ee()},[]);const C=async()=>{if(n){se(!0);try{const t=await T.getLetters(n,{page:P.current,limit:P.pageSize,letterType:O,status:F==="all"?"":F,search:N});j(t.letters),M(s=>({...s,total:t.pagination.total}))}catch(t){o.error(t.message||"Failed to fetch letters")}finally{se(!1)}}},I=async()=>{if(n)try{const t=await T.getStatistics(n);Pe(t)}catch(t){o.error(t.message||"Failed to fetch statistics")}},Ee=async()=>{try{const t=await T.getUpcomingSchedules();$e(t)}catch(t){o.error(t.message||"Failed to fetch upcoming schedules")}},de=async t=>{if(n){ne(!0),E(0),oe(!0);try{const s=[];for(let c=0;c<t.length;c++){const x=t[c];H(`Sending ${x==="standPossession"?"Stand Possession":"Transport"} letters...`),E(c/t.length*100);const m=await T.sendLettersManually(n,x);s.push({type:x,result:m.result}),E((c+1)/t.length*100)}H("Complete!");const i=s.reduce((c,x)=>c+x.result.sent,0),u=s.reduce((c,x)=>c+x.result.failed,0);i>0?o.success(`Successfully sent ${i} letters${u>0?` (${u} failed)`:""}`):o.warning("No letters were sent"),C(),I()}catch(s){o.error(s.message||"Failed to send letters")}finally{ne(!1),setTimeout(()=>{oe(!1),E(0),H("")},2e3)}}},ue=async t=>{await de([t])},Me=async()=>{await de(["standPossession","transport"])},Oe=async t=>{try{await T.resendLetter(t),o.success("Letter resent successfully"),C(),I()}catch(s){o.error(s.message||"Failed to resend letter")}},K=async(t,s="",i=!1)=>{try{const u=await T.deleteLetter(t,i);if(u.requiresForce){w.confirm({title:"Delete Sent Letter",icon:e.jsx(_,{}),content:e.jsxs("div",{children:[e.jsx(A,{message:"This letter has already been sent",description:"Deleting a sent letter will remove it from your records but cannot unsend the email. Are you sure you want to proceed?",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx("p",{children:e.jsx("strong",{children:"Letter Details:"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Type: ",s==="standPossession"?"Stand Possession":"Transport"]}),e.jsxs("li",{children:["Status: ",s]})]})]}),okText:"Yes, Delete",okType:"danger",cancelText:"Cancel",onOk:()=>K(t,s,!0)});return}o.success(u.message||"Letter deleted successfully"),C(),I()}catch(u){o.error(u.message||"Failed to delete letter")}},Ne=()=>{n&&w.confirm({title:"Bulk Delete Letters",icon:e.jsx(_,{}),width:650,content:e.jsx(Ye,{exhibitionId:n,onSuccess:()=>{C(),I()}}),footer:null})},_e=()=>{n&&w.confirm({title:"Quick Cleanup",icon:e.jsx(Z,{}),width:550,content:e.jsx(Ve,{exhibitionId:n,onSuccess:()=>{C(),I()}}),footer:null})},W=async(t,s)=>{if(n)try{const i=s.map(Ze=>Ze==="standPossession"?"Stand Possession":"Transport").join(" and ");o.loading({content:`Sending ${i} letter(s)...`,key:"resend-letters"});const u=typeof t.bookingId=="object"&&t.bookingId!==null?t.bookingId._id:t.bookingId,c=await T.resendBothLetters(n,u,s),x=c.summary.sent,m=c.summary.failed,b=c.summary.total;x>0&&m===0?o.success({content:`${i} letter(s) sent successfully (${x}/${b})`,key:"resend-letters"}):x>0&&m>0?o.warning({content:`Partially successful: ${x} sent, ${m} failed`,key:"resend-letters"}):o.error({content:`Failed to send ${i} letter(s): ${c.message}`,key:"resend-letters"}),C(),I()}catch(i){o.error({content:i.message||"Failed to resend letters",key:"resend-letters"})}},Ue=async t=>{Fe(t),q(!0)},xe=async t=>{try{o.loading({content:"Generating PDF...",key:"download"});const s=await T.downloadLetterPDF(t._id),i=window.URL.createObjectURL(s),u=document.createElement("a");u.href=i;const c=t.letterType==="standPossession"?"Stand_Possession":"Transport",x=t.companyName.replace(/[^a-zA-Z0-9\-_]/g,"_").substring(0,20),m=`${c}_Letter_${x}.pdf`;u.setAttribute("download",m),document.body.appendChild(u),u.click(),u.remove(),window.URL.revokeObjectURL(i),o.success({content:"Letter downloaded successfully",key:"download"})}catch(s){o.error({content:s.message||"Failed to download letter",key:"download"})}},Qe=()=>{le("all"),ae(""),ie(""),M(t=>({...t,current:1}))},he=()=>!!(F!=="all"||O||N),pe=t=>{const i={sent:{color:"green",icon:e.jsx(X,{})},pending:{color:"orange",icon:e.jsx(Q,{})},failed:{color:"red",icon:e.jsx(ee,{})},scheduled:{color:"blue",icon:e.jsx(Q,{})}}[t]||{color:"default",icon:null};return e.jsx(L,{color:i.color,icon:i.icon,children:t.toUpperCase()})},Ye=({exhibitionId:t,onSuccess:s})=>{const[i]=v.useForm(),[u,c]=d.useState(!1),x=async m=>{try{c(!0);const b=await T.bulkDeleteLetters(t,{status:m.status,letterType:m.letterType,olderThanDays:m.olderThanDays,force:m.force||!1});if(b.requiresForce){o.warning("Sent letters require force confirmation. Please check the force option and try again.");return}o.success(`Successfully deleted ${b.deletedCount} letters`),s(),w.destroyAll()}catch(b){o.error(b.message||"Failed to delete letters")}finally{c(!1)}};return e.jsxs(v,{form:i,layout:"vertical",onFinish:x,children:[e.jsx(A,{message:"Bulk Delete Letters",description:"Select criteria for letters to delete. This action cannot be undone.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(v.Item,{name:"status",label:"Status to Delete",children:e.jsx(z,{mode:"multiple",placeholder:"Select status types",options:[{label:"Failed Letters",value:"failed"},{label:"Pending Letters",value:"pending"},{label:"Sent Letters",value:"sent"}]})}),e.jsx(v.Item,{name:"letterType",label:"Letter Type (Optional)",children:e.jsx(z,{placeholder:"All types",allowClear:!0,options:[{label:"Stand Possession",value:"standPossession"},{label:"Transport",value:"transport"}]})}),e.jsx(v.Item,{name:"olderThanDays",label:"Older Than (Days)",children:e.jsx(ve,{min:1,placeholder:"e.g., 30",style:{width:"100%"}})}),e.jsx(v.Item,{name:"force",valuePropName:"checked",children:e.jsx(Te,{children:"Force delete sent letters (I understand this removes delivery records)"})}),e.jsxs(k,{justify:"end",gutter:8,children:[e.jsx(a,{children:e.jsx(p,{onClick:()=>w.destroyAll(),children:"Cancel"})}),e.jsx(a,{children:e.jsx(p,{type:"primary",danger:!0,htmlType:"submit",loading:u,children:"Delete Letters"})})]})]})},Ve=({exhibitionId:t,onSuccess:s})=>{const[i]=v.useForm(),[u,c]=d.useState(!1),x=async m=>{try{c(!0);const b=await T.cleanOldLetters(t,{daysOld:m.daysOld||30,includeSent:m.includeSent||!1});o.success(`Successfully cleaned ${b.deletedCount} old letters`),s(),w.destroyAll()}catch(b){o.error(b.message||"Failed to clean letters")}finally{c(!1)}};return e.jsxs(v,{form:i,layout:"vertical",onFinish:x,initialValues:{daysOld:30},children:[e.jsx(A,{message:"Quick Cleanup",description:"Remove old letters to keep your database clean. By default, only failed and pending letters are removed.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(v.Item,{name:"daysOld",label:"Remove letters older than",rules:[{required:!0}],children:e.jsx(ve,{min:1,max:365,style:{width:"100%"},suffix:"days",placeholder:"30"})}),e.jsx(v.Item,{name:"includeSent",valuePropName:"checked",children:e.jsx(Te,{children:"Also remove sent letters (not recommended unless archiving)"})}),e.jsxs(k,{justify:"end",gutter:8,children:[e.jsx(a,{children:e.jsx(p,{onClick:()=>w.destroyAll(),children:"Cancel"})}),e.jsx(a,{children:e.jsx(p,{type:"primary",htmlType:"submit",loading:u,children:"Clean Old Letters"})})]})]})},He=()=>{if(!g)return null;const t=u=>{switch(u){case"sent":return"#52c41a";case"pending":return"#faad14";case"failed":return"#ff4d4f";default:return"#1890ff"}},s=g.standPossession.sent+g.standPossession.pending+g.standPossession.failed,i=g.transport.sent+g.transport.pending+g.transport.failed;return e.jsxs(k,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(a,{xs:24,lg:12,children:e.jsxs($,{size:"small",title:"Stand Possession Letters",extra:e.jsx(L,{color:"blue",children:"Stand Possession"}),children:[e.jsxs(k,{gutter:16,children:[e.jsx(a,{span:8,children:e.jsx(D,{title:"Sent",value:g.standPossession.sent,valueStyle:{color:t("sent"),fontSize:"20px"},prefix:e.jsx(X,{})})}),e.jsx(a,{span:8,children:e.jsx(D,{title:"Pending",value:g.standPossession.pending,valueStyle:{color:t("pending"),fontSize:"20px"},prefix:e.jsx(Q,{})})}),e.jsx(a,{span:8,children:e.jsx(D,{title:"Failed",value:g.standPossession.failed,valueStyle:{color:t("failed"),fontSize:"20px"},prefix:e.jsx(ee,{})})})]}),s>0&&e.jsx(J,{percent:Math.round(g.standPossession.sent/s*100),strokeColor:t("sent"),style:{marginTop:"12px"}})]})}),e.jsx(a,{xs:24,lg:12,children:e.jsxs($,{size:"small",title:"Transport Letters",extra:e.jsx(L,{color:"green",children:"Transport"}),children:[e.jsxs(k,{gutter:16,children:[e.jsx(a,{span:8,children:e.jsx(D,{title:"Sent",value:g.transport.sent,valueStyle:{color:t("sent"),fontSize:"20px"},prefix:e.jsx(X,{})})}),e.jsx(a,{span:8,children:e.jsx(D,{title:"Pending",value:g.transport.pending,valueStyle:{color:t("pending"),fontSize:"20px"},prefix:e.jsx(Q,{})})}),e.jsx(a,{span:8,children:e.jsx(D,{title:"Failed",value:g.transport.failed,valueStyle:{color:t("failed"),fontSize:"20px"},prefix:e.jsx(ee,{})})})]}),i>0&&e.jsx(J,{percent:Math.round(g.transport.sent/i*100),strokeColor:t("sent"),style:{marginTop:"12px"}})]})})]})},qe=()=>n?e.jsxs($,{title:e.jsxs(U,{children:[e.jsx(at,{}),e.jsx("span",{children:"Quick Actions"})]}),size:"small",style:{marginBottom:"24px"},children:[e.jsxs(k,{gutter:[16,16],children:[e.jsx(a,{xs:24,sm:8,children:e.jsx(p,{type:"primary",size:"large",block:!0,icon:e.jsx(be,{}),loading:V,onClick:Me,style:{height:"48px"},children:"Send Both Letter Types"})}),e.jsx(a,{xs:12,sm:8,children:e.jsx(p,{size:"large",block:!0,icon:e.jsx(ke,{}),loading:V,onClick:()=>ue("standPossession"),style:{height:"48px"},children:"Stand Possession Only"})}),e.jsx(a,{xs:12,sm:8,children:e.jsx(p,{size:"large",block:!0,icon:e.jsx(te,{}),loading:V,onClick:()=>ue("transport"),style:{height:"48px"},children:"Transport Only"})})]}),e.jsx(je,{style:{margin:"16px 0 12px 0"}}),e.jsxs(k,{gutter:[8,8],style:{marginTop:"12px"},children:[e.jsx(a,{flex:"auto",children:e.jsxs(y,{type:"secondary",style:{fontSize:"12px"},children:[e.jsx(rt,{style:{marginRight:"4px"}}),"Letters are sent to exhibitors automatically. Use manual sending for immediate delivery."]})}),e.jsx(a,{children:e.jsxs(U,{size:"small",children:[e.jsx(p,{icon:e.jsx(Z,{}),onClick:_e,size:"small",title:"Quick cleanup old letters",children:"Quick Cleanup"}),e.jsx(p,{icon:e.jsx(we,{}),onClick:Ne,size:"small",danger:!0,title:"Bulk delete letters",children:"Bulk Delete"}),e.jsx(p,{icon:e.jsx(lt,{}),onClick:C,size:"small",children:"Refresh"})]})})]})]}):null,Ke=[{title:"Type",dataIndex:"letterType",key:"letterType",width:140,render:t=>e.jsx(L,{color:t==="standPossession"?"blue":"green",style:{fontSize:"11px",padding:"2px 8px"},children:t==="standPossession"?"Stand Possession":"Transport"})},{title:"Recipient",key:"recipient",render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"13px"},children:s.recipientName}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:s.companyName}),e.jsx("div",{style:{fontSize:"11px",color:"#999"},children:s.recipientEmail})]})},{title:"Stalls",dataIndex:"stallNumbers",key:"stallNumbers",width:100,render:t=>e.jsx(L,{color:"default",style:{fontSize:"11px"},children:t.join(", ")})},{title:"Status",dataIndex:"status",key:"status",width:100,render:(t,s)=>e.jsxs("div",{children:[pe(t),s.failureReason&&e.jsx(Y,{title:s.failureReason,placement:"top",children:e.jsx(_,{style:{color:"#ff4d4f",marginLeft:"4px",cursor:"help"}})})]})},{title:"Sent",dataIndex:"sentAt",key:"sentAt",width:140,render:t=>e.jsx(y,{style:{fontSize:"12px"},children:t?G(t).format("MMM DD, HH:mm"):"-"})},{title:"Actions",key:"actions",width:180,render:(t,s)=>e.jsxs(U,{size:"small",children:[e.jsx(Y,{title:"View Details",children:e.jsx(p,{type:"text",icon:e.jsx(Se,{}),size:"small",onClick:()=>Ue(s)})}),e.jsx(Y,{title:"Download PDF",children:e.jsx(p,{type:"text",icon:e.jsx(fe,{}),size:"small",onClick:()=>xe(s)})}),s.status==="failed"&&e.jsx(Y,{title:"Retry Send",children:e.jsx(p,{type:"text",icon:e.jsx(te,{}),size:"small",onClick:()=>Oe(s._id),style:{color:"#1890ff"}})}),e.jsx(it,{menu:{items:[{key:"both",label:"Resend Both Types",icon:e.jsx(be,{}),onClick:()=>W(s,["standPossession","transport"])},{key:"standPossession",label:"Resend Stand Possession",icon:e.jsx(ke,{}),onClick:()=>W(s,["standPossession"])},{key:"transport",label:"Resend Transport",icon:e.jsx(te,{}),onClick:()=>W(s,["transport"])},{type:"divider"},{key:"delete",label:s.status==="sent"?"Delete Sent Letter":"Delete Letter",icon:e.jsx(we,{}),danger:!0,onClick:()=>{s.status==="sent"?K(s._id,s.status):w.confirm({title:"Delete Letter",content:"Are you sure you want to delete this letter?",onOk:()=>K(s._id,s.status)})}}]},trigger:["click"],placement:"bottomRight",children:e.jsx(p,{type:"text",icon:e.jsx(ot,{}),size:"small"})})]})}],We=[{title:"Exhibition",dataIndex:"exhibitionName",key:"exhibitionName"},{title:"Letter Type",dataIndex:"letterType",key:"letterType",render:t=>e.jsx(L,{color:t==="standPossession"?"blue":"green",children:t==="standPossession"?"Stand Possession":"Transport"})},{title:"Scheduled Date",dataIndex:"scheduledDate",key:"scheduledDate",render:t=>G(t).format("MMM DD, YYYY")},{title:"Days Until Start",dataIndex:"daysUntilStart",key:"daysUntilStart",render:t=>e.jsx(ct,{count:t,style:{backgroundColor:t<=7?"#ff4d4f":"#52c41a"},overflowCount:99})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(L,{color:t==="due"?"red":"blue",children:t.toUpperCase()})}];return e.jsxs("div",{style:{padding:"24px",background:"#f5f5f5",minHeight:"100vh"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs(xt,{level:2,style:{margin:0,display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(tt,{style:{color:"#1890ff"}}),"Exhibition Letters"]}),e.jsx(ht,{type:"secondary",style:{margin:"8px 0 0 0",fontSize:"16px"},children:"Manage and monitor exhibition letters sent to exhibitors"})]}),e.jsxs(Ce,{defaultActiveKey:"dashboard",style:{background:"white",borderRadius:"8px",padding:"24px"},children:[e.jsxs(Le,{tab:e.jsxs("span",{children:[e.jsx(nt,{}),"Dashboard"]}),children:[e.jsx($,{style:{marginBottom:"24px"},size:"small",children:e.jsxs(k,{gutter:[16,16],align:"middle",children:[e.jsx(a,{xs:24,md:12,children:e.jsxs("div",{children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Select Exhibition:"}),e.jsx(z,{style:{width:"100%"},placeholder:"Choose an exhibition to manage letters",value:n||void 0,onChange:Ae,showSearch:!0,optionFilterProp:"children",allowClear:!!n,size:"large",children:B.map(t=>e.jsx(R,{value:t._id,children:t.name},t._id))})]})}),n&&e.jsx(a,{xs:24,md:12,children:e.jsx(A,{message:`Managing letters for: ${(ye=B.find(t=>t._id===n))==null?void 0:ye.name}`,type:"info",showIcon:!0,style:{margin:0}})})]})}),n?e.jsxs(e.Fragment,{children:[e.jsx(He,{}),e.jsx(qe,{}),e.jsx($,{style:{marginBottom:"24px"},size:"small",children:e.jsxs(k,{gutter:[16,16],align:"middle",children:[e.jsxs(a,{xs:24,sm:6,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Quick Filter:"}),e.jsxs(z,{style:{width:"100%"},value:F,onChange:le,children:[e.jsx(R,{value:"all",children:"All Letters"}),e.jsx(R,{value:"sent",children:"Sent Only"}),e.jsx(R,{value:"pending",children:"Pending Only"}),e.jsx(R,{value:"failed",children:"Failed Only"})]})]}),e.jsxs(a,{xs:24,sm:6,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Letter Type:"}),e.jsxs(z,{style:{width:"100%"},placeholder:"All Types",value:O||void 0,onChange:ae,allowClear:!0,children:[e.jsx(R,{value:"standPossession",children:"Stand Possession"}),e.jsx(R,{value:"transport",children:"Transport"})]})]}),e.jsxs(a,{xs:24,sm:8,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Search:"}),e.jsx(pt,{placeholder:"Search by name, company, email...",value:N,onChange:t=>ie(t.target.value),allowClear:!0})]}),e.jsx(a,{xs:24,sm:4,children:e.jsx("div",{style:{marginTop:"32px"},children:e.jsx(p,{onClick:Qe,disabled:!he(),danger:he(),icon:e.jsx(Z,{}),block:!0,children:"Clear Filters"})})})]})}),e.jsx($,{children:e.jsx(ge,{columns:Ke,dataSource:l,rowKey:"_id",loading:Re,size:"small",scroll:{x:800},pagination:{current:P.current,pageSize:P.pageSize,total:P.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} letters`,onChange:(t,s)=>{M(i=>({...i,current:t,pageSize:s||10}))}}})})]}):e.jsx(me,{image:me.PRESENTED_IMAGE_SIMPLE,description:e.jsx("span",{children:"Please select an exhibition to view and manage letters"})})]},"dashboard"),e.jsxs(Le,{tab:"Upcoming Schedules",children:[e.jsx(A,{message:"Automatic Letter Schedules",description:"These letters will be sent automatically based on exhibition dates and letter settings.",type:"info",showIcon:!0,style:{marginBottom:"24px"}}),e.jsx($,{children:e.jsx(ge,{columns:We,dataSource:Ie,rowKey:t=>`${t.exhibitionId}-${t.letterType}`,pagination:!1,size:"small"})})]},"schedules")]}),e.jsx(w,{title:"Sending Letters",open:Be,footer:null,closable:!1,centered:!0,children:e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(J,{type:"circle",percent:re,status:re===100?"success":"active",style:{marginBottom:"16px"}}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsx(y,{strong:!0,children:De})})]})}),e.jsx(w,{title:e.jsxs(U,{children:[e.jsx(Se,{}),"Letter Details"]}),open:ze,onCancel:()=>q(!1),footer:[e.jsx(p,{onClick:()=>q(!1),children:"Close"},"close"),h&&e.jsx(p,{type:"primary",icon:e.jsx(fe,{}),onClick:()=>h&&xe(h),children:"Download PDF"},"download")],width:900,children:h&&e.jsxs("div",{children:[e.jsxs(k,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Type:"}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(L,{color:h.letterType==="standPossession"?"blue":"green",children:h.letterType==="standPossession"?"Stand Possession":"Transport"})})]}),e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Status:"}),e.jsx("div",{style:{marginTop:"4px"},children:pe(h.status)})]}),e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Recipient:"}),e.jsxs("div",{style:{marginTop:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:h.recipientName}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:h.recipientEmail})]})]}),e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Company:"}),e.jsx("div",{style:{marginTop:"4px"},children:h.companyName})]}),e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Stalls:"}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(L,{children:h.stallNumbers.join(", ")})})]}),e.jsxs(a,{span:12,children:[e.jsx(y,{strong:!0,children:"Sent At:"}),e.jsx("div",{style:{marginTop:"4px"},children:h.sentAt?G(h.sentAt).format("MMM DD, YYYY HH:mm"):"Not sent"})]})]}),e.jsx(je,{}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx(y,{strong:!0,children:"Subject:"}),e.jsx("div",{style:{marginTop:"8px",padding:"12px",background:"#f5f5f5",borderRadius:"6px",border:"1px solid #d9d9d9"},children:h.subject})]}),e.jsxs("div",{children:[e.jsx(y,{strong:!0,children:"Content:"}),e.jsx("div",{style:{marginTop:"8px",padding:"16px",background:"#f5f5f5",borderRadius:"6px",border:"1px solid #d9d9d9",whiteSpace:"pre-line",fontFamily:"monospace",maxHeight:"400px",overflow:"auto",fontSize:"13px",lineHeight:"1.6"},children:h.content})]}),h.failureReason&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsx(y,{strong:!0,children:"Failure Reason:"}),e.jsxs("div",{style:{marginTop:"8px",padding:"12px",background:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"6px",color:"#a8071a"},children:[e.jsx(_,{style:{marginRight:"8px"}}),h.failureReason]})]})]})})]})};export{Tt as default};
