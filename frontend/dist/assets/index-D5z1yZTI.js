import{a as j,j as e,v as Xe}from"./index-DoSueJxk.js";import{u as Ze,r as d,l as et,k as tt}from"./vendor-react-dkbxt9Jf.js";import{X as st,c as h,W as o,T as nt,z as rt,n as Le,a1 as I,$ as k,a0 as l,ab as z,P as A,J as lt,aY as G,ai as ye,E as ge,u as at,d as J,ag as w,U as X,b as L,D as me,al as _,aQ as je,S as U,at as fe,aq as D,x as Z,h as Q,m as ee,b0 as Se,C as be,b1 as te,V as it,R as ke,j as ot,b2 as ct,a as Y,p as dt,ay as ut,B as xt,K as v,aF as we,N as ve,aw as ht}from"./vendor-antd-mFVHvrVJ.js";import{u as pt}from"./reduxHooks-Be1Cl4uN.js";import"./vendor-utils-ngrFHoWO.js";import"./vendor-styling-CQa69cNz.js";const f=a=>{const r=a.response?.data?.message||"An error occurred";throw new Error(r)},T={sendLettersManually:async(a,r)=>{try{return(await j.post(`/exhibition-letters/${a}/send`,{letterType:r})).data}catch(n){return f(n)}},getLetters:async(a,r={})=>{try{const n=new URLSearchParams;return r.page&&n.append("page",r.page.toString()),r.limit&&n.append("limit",r.limit.toString()),r.letterType&&n.append("letterType",r.letterType),r.status&&n.append("status",r.status),r.search&&n.append("search",r.search),(await j.get(`/exhibition-letters/${a}?${n.toString()}`)).data}catch(n){return f(n)}},getStatistics:async a=>{try{return(await j.get(`/exhibition-letters/${a}/statistics`)).data}catch(r){return f(r)}},previewLetter:async(a,r,n)=>{try{return(await j.get(`/exhibition-letters/${a}/preview/${r}?letterType=${n}`)).data}catch(S){return f(S)}},resendLetter:async a=>{try{return(await j.post(`/exhibition-letters/letter/${a}/resend`)).data}catch(r){return f(r)}},getUpcomingSchedules:async()=>{try{return(await j.get("/exhibition-letters/schedules/upcoming")).data}catch(a){return f(a)}},deleteLetter:async(a,r=!1)=>{try{const n=`/exhibition-letters/letter/${a}${r?"?force=true":""}`;return(await j.delete(n)).data}catch(n){return f(n)}},bulkDeleteLetters:async(a,r)=>{try{return(await j.post(`/exhibition-letters/${a}/bulk-delete`,r)).data}catch(n){return f(n)}},cleanOldLetters:async(a,r={})=>{try{return(await j.post(`/exhibition-letters/${a}/clean-old`,r)).data}catch(n){return f(n)}},getLetterById:async a=>{try{return(await j.get(`/exhibition-letters/letter/${a}`)).data}catch(r){return f(r)}},downloadLetterPDF:async a=>{try{return(await j.get(`/exhibition-letters/letter/${a}/download`,{responseType:"blob"})).data}catch(r){return f(r)}},resendBothLetters:async(a,r,n)=>{try{return(await j.post(`/exhibition-letters/${a}/resend-both/${r}`,{letterTypes:n})).data}catch(S){return f(S)}}},{Title:yt,Text:y,Paragraph:gt}=nt,{Option:R}=z,{Search:mt}=lt,{TabPane:Te}=Le,{RangePicker:Lt}=ht,Pt=()=>{const{hasPermission:a}=pt(),r=Ze();if(!a("view_letters"))return e.jsx(st,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:e.jsx(h,{type:"primary",onClick:()=>r("/dashboard"),children:"Back to Dashboard"})});const[n,S]=d.useState(()=>localStorage.getItem("letters-selected-exhibition")||""),[Pe,Ce]=d.useState([]),[g,$e]=d.useState(null),[Ie,Re]=d.useState([]),[De,se]=d.useState(!1),[V,ne]=d.useState(!1),[re,E]=d.useState(0),[ze,H]=d.useState(""),[C,M]=d.useState({current:1,pageSize:10,total:0}),[F,le]=d.useState("all"),[N,ae]=d.useState(""),[O,ie]=d.useState(""),[jt,ft]=d.useState(!1),[Fe,q]=d.useState(!1),[p,Be]=d.useState(null),[Ae,oe]=d.useState(!1),ce=et(),{exhibitions:B}=tt(t=>t.exhibition);d.useEffect(()=>{ce(Xe())},[ce]);const Ee=t=>{S(t),t?localStorage.setItem("letters-selected-exhibition",t):localStorage.removeItem("letters-selected-exhibition"),M(s=>({...s,current:1}))};d.useEffect(()=>{n&&B.length>0&&(B.some(s=>s._id===n)||(S(""),localStorage.removeItem("letters-selected-exhibition")))},[n,B]),d.useEffect(()=>{n&&(P(),$())},[n,N,F,O,C.current,C.pageSize]),d.useEffect(()=>{Me()},[]);const P=async()=>{if(n){se(!0);try{const t=await T.getLetters(n,{page:C.current,limit:C.pageSize,letterType:N,status:F==="all"?"":F,search:O});Ce(t.letters),M(s=>({...s,total:t.pagination.total}))}catch(t){o.error(t.message||"Failed to fetch letters")}finally{se(!1)}}},$=async()=>{if(n)try{const t=await T.getStatistics(n);$e(t)}catch(t){o.error(t.message||"Failed to fetch statistics")}},Me=async()=>{try{const t=await T.getUpcomingSchedules();Re(t)}catch(t){o.error(t.message||"Failed to fetch upcoming schedules")}},de=async t=>{if(n){ne(!0),E(0),oe(!0);try{const s=[];for(let c=0;c<t.length;c++){const x=t[c];H(`Sending ${x==="standPossession"?"Stand Possession":"Transport"} letters...`),E(c/t.length*100);const m=await T.sendLettersManually(n,x);s.push({type:x,result:m.result}),E((c+1)/t.length*100)}H("Complete!");const i=s.reduce((c,x)=>c+x.result.sent,0),u=s.reduce((c,x)=>c+x.result.failed,0);i>0?o.success(`Successfully sent ${i} letters${u>0?` (${u} failed)`:""}`):o.warning("No letters were sent"),P(),$()}catch(s){o.error(s.message||"Failed to send letters")}finally{ne(!1),setTimeout(()=>{oe(!1),E(0),H("")},2e3)}}},ue=async t=>{await de([t])},Ne=async()=>{await de(["standPossession","transport"])},Oe=async t=>{try{await T.resendLetter(t),o.success("Letter resent successfully"),P(),$()}catch(s){o.error(s.message||"Failed to resend letter")}},K=async(t,s="",i=!1)=>{try{const u=await T.deleteLetter(t,i);if(u.requiresForce){w.confirm({title:"Delete Sent Letter",icon:e.jsx(_,{}),content:e.jsxs("div",{children:[e.jsx(A,{message:"This letter has already been sent",description:"Deleting a sent letter will remove it from your records but cannot unsend the email. Are you sure you want to proceed?",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx("p",{children:e.jsx("strong",{children:"Letter Details:"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Type: ",s==="standPossession"?"Stand Possession":"Transport"]}),e.jsxs("li",{children:["Status: ",s]})]})]}),okText:"Yes, Delete",okType:"danger",cancelText:"Cancel",onOk:()=>K(t,s,!0)});return}o.success(u.message||"Letter deleted successfully"),P(),$()}catch(u){o.error(u.message||"Failed to delete letter")}},_e=()=>{n&&w.confirm({title:"Bulk Delete Letters",icon:e.jsx(_,{}),width:650,content:e.jsx(Ve,{exhibitionId:n,onSuccess:()=>{P(),$()}}),footer:null})},Ue=()=>{n&&w.confirm({title:"Quick Cleanup",icon:e.jsx(G,{}),width:550,content:e.jsx(He,{exhibitionId:n,onSuccess:()=>{P(),$()}}),footer:null})},W=async(t,s)=>{if(n)try{const i=s.map(Je=>Je==="standPossession"?"Stand Possession":"Transport").join(" and ");o.loading({content:`Sending ${i} letter(s)...`,key:"resend-letters"});const u=typeof t.bookingId=="object"&&t.bookingId!==null?t.bookingId._id:t.bookingId,c=await T.resendBothLetters(n,u,s),x=c.summary.sent,m=c.summary.failed,b=c.summary.total;x>0&&m===0?o.success({content:`${i} letter(s) sent successfully (${x}/${b})`,key:"resend-letters"}):x>0&&m>0?o.warning({content:`Partially successful: ${x} sent, ${m} failed`,key:"resend-letters"}):o.error({content:`Failed to send ${i} letter(s): ${c.message}`,key:"resend-letters"}),P(),$()}catch(i){o.error({content:i.message||"Failed to resend letters",key:"resend-letters"})}},Qe=async t=>{Be(t),q(!0)},xe=async t=>{try{o.loading({content:"Generating PDF...",key:"download"});const s=await T.downloadLetterPDF(t._id),i=window.URL.createObjectURL(s),u=document.createElement("a");u.href=i;const c=t.letterType==="standPossession"?"Stand_Possession":"Transport",x=t.companyName.replace(/[^a-zA-Z0-9\-_]/g,"_").substring(0,20),m=`${c}_Letter_${x}.pdf`;u.setAttribute("download",m),document.body.appendChild(u),u.click(),u.remove(),window.URL.revokeObjectURL(i),o.success({content:"Letter downloaded successfully",key:"download"})}catch(s){o.error({content:s.message||"Failed to download letter",key:"download"})}},Ye=()=>{le("all"),ae(""),ie(""),M(t=>({...t,current:1}))},he=()=>!!(F!=="all"||N||O),pe=t=>{const i={sent:{color:"green",icon:e.jsx(Z,{})},pending:{color:"orange",icon:e.jsx(Q,{})},failed:{color:"red",icon:e.jsx(ee,{})},scheduled:{color:"blue",icon:e.jsx(Q,{})}}[t]||{color:"default",icon:null};return e.jsx(L,{color:i.color,icon:i.icon,children:t.toUpperCase()})},Ve=({exhibitionId:t,onSuccess:s})=>{const[i]=v.useForm(),[u,c]=d.useState(!1),x=async m=>{try{c(!0);const b=await T.bulkDeleteLetters(t,{status:m.status,letterType:m.letterType,olderThanDays:m.olderThanDays,force:m.force||!1});if(b.requiresForce){o.warning("Sent letters require force confirmation. Please check the force option and try again.");return}o.success(`Successfully deleted ${b.deletedCount} letters`),s(),w.destroyAll()}catch(b){o.error(b.message||"Failed to delete letters")}finally{c(!1)}};return e.jsxs(v,{form:i,layout:"vertical",onFinish:x,children:[e.jsx(A,{message:"Bulk Delete Letters",description:"Select criteria for letters to delete. This action cannot be undone.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(v.Item,{name:"status",label:"Status to Delete",children:e.jsx(z,{mode:"multiple",placeholder:"Select status types",options:[{label:"Failed Letters",value:"failed"},{label:"Pending Letters",value:"pending"},{label:"Sent Letters",value:"sent"}]})}),e.jsx(v.Item,{name:"letterType",label:"Letter Type (Optional)",children:e.jsx(z,{placeholder:"All types",allowClear:!0,options:[{label:"Stand Possession",value:"standPossession"},{label:"Transport",value:"transport"}]})}),e.jsx(v.Item,{name:"olderThanDays",label:"Older Than (Days)",children:e.jsx(we,{min:1,placeholder:"e.g., 30",style:{width:"100%"}})}),e.jsx(v.Item,{name:"force",valuePropName:"checked",children:e.jsx(ve,{children:"Force delete sent letters (I understand this removes delivery records)"})}),e.jsxs(k,{justify:"end",gutter:8,children:[e.jsx(l,{children:e.jsx(h,{onClick:()=>w.destroyAll(),children:"Cancel"})}),e.jsx(l,{children:e.jsx(h,{type:"primary",danger:!0,htmlType:"submit",loading:u,children:"Delete Letters"})})]})]})},He=({exhibitionId:t,onSuccess:s})=>{const[i]=v.useForm(),[u,c]=d.useState(!1),x=async m=>{try{c(!0);const b=await T.cleanOldLetters(t,{daysOld:m.daysOld||30,includeSent:m.includeSent||!1});o.success(`Successfully cleaned ${b.deletedCount} old letters`),s(),w.destroyAll()}catch(b){o.error(b.message||"Failed to clean letters")}finally{c(!1)}};return e.jsxs(v,{form:i,layout:"vertical",onFinish:x,initialValues:{daysOld:30},children:[e.jsx(A,{message:"Quick Cleanup",description:"Remove old letters to keep your database clean. By default, only failed and pending letters are removed.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(v.Item,{name:"daysOld",label:"Remove letters older than",rules:[{required:!0}],children:e.jsx(we,{min:1,max:365,style:{width:"100%"},suffix:"days",placeholder:"30"})}),e.jsx(v.Item,{name:"includeSent",valuePropName:"checked",children:e.jsx(ve,{children:"Also remove sent letters (not recommended unless archiving)"})}),e.jsxs(k,{justify:"end",gutter:8,children:[e.jsx(l,{children:e.jsx(h,{onClick:()=>w.destroyAll(),children:"Cancel"})}),e.jsx(l,{children:e.jsx(h,{type:"primary",htmlType:"submit",loading:u,children:"Clean Old Letters"})})]})]})},qe=()=>{if(!g)return null;const t=u=>{switch(u){case"sent":return"#52c41a";case"pending":return"#faad14";case"failed":return"#ff4d4f";default:return"#1890ff"}},s=g.standPossession.sent+g.standPossession.pending+g.standPossession.failed,i=g.transport.sent+g.transport.pending+g.transport.failed;return e.jsxs(k,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(l,{xs:24,lg:12,children:e.jsxs(I,{size:"small",title:"Stand Possession Letters",extra:e.jsx(L,{color:"blue",children:"Stand Possession"}),children:[e.jsxs(k,{gutter:16,children:[e.jsx(l,{span:8,children:e.jsx(D,{title:"Sent",value:g.standPossession.sent,valueStyle:{color:t("sent"),fontSize:"20px"},prefix:e.jsx(Z,{})})}),e.jsx(l,{span:8,children:e.jsx(D,{title:"Pending",value:g.standPossession.pending,valueStyle:{color:t("pending"),fontSize:"20px"},prefix:e.jsx(Q,{})})}),e.jsx(l,{span:8,children:e.jsx(D,{title:"Failed",value:g.standPossession.failed,valueStyle:{color:t("failed"),fontSize:"20px"},prefix:e.jsx(ee,{})})})]}),s>0&&e.jsx(X,{percent:Math.round(g.standPossession.sent/s*100),strokeColor:t("sent"),style:{marginTop:"12px"}})]})}),e.jsx(l,{xs:24,lg:12,children:e.jsxs(I,{size:"small",title:"Transport Letters",extra:e.jsx(L,{color:"green",children:"Transport"}),children:[e.jsxs(k,{gutter:16,children:[e.jsx(l,{span:8,children:e.jsx(D,{title:"Sent",value:g.transport.sent,valueStyle:{color:t("sent"),fontSize:"20px"},prefix:e.jsx(Z,{})})}),e.jsx(l,{span:8,children:e.jsx(D,{title:"Pending",value:g.transport.pending,valueStyle:{color:t("pending"),fontSize:"20px"},prefix:e.jsx(Q,{})})}),e.jsx(l,{span:8,children:e.jsx(D,{title:"Failed",value:g.transport.failed,valueStyle:{color:t("failed"),fontSize:"20px"},prefix:e.jsx(ee,{})})})]}),i>0&&e.jsx(X,{percent:Math.round(g.transport.sent/i*100),strokeColor:t("sent"),style:{marginTop:"12px"}})]})})]})},Ke=()=>n?e.jsxs(I,{title:e.jsxs(U,{children:[e.jsx(ct,{}),e.jsx("span",{children:"Quick Actions"})]}),size:"small",style:{marginBottom:"24px"},children:[e.jsxs(k,{gutter:[16,16],children:[e.jsx(l,{xs:24,sm:8,children:e.jsx(h,{type:"primary",size:"large",block:!0,icon:e.jsx(Se,{}),loading:V,onClick:Ne,style:{height:"48px"},children:"Send Both Letter Types"})}),e.jsx(l,{xs:12,sm:8,children:e.jsx(h,{size:"large",block:!0,icon:e.jsx(be,{}),loading:V,onClick:()=>ue("standPossession"),style:{height:"48px"},children:"Stand Possession Only"})}),e.jsx(l,{xs:12,sm:8,children:e.jsx(h,{size:"large",block:!0,icon:e.jsx(te,{}),loading:V,onClick:()=>ue("transport"),style:{height:"48px"},children:"Transport Only"})})]}),e.jsx(me,{style:{margin:"16px 0 12px 0"}}),e.jsxs(k,{gutter:[8,8],style:{marginTop:"12px"},children:[e.jsx(l,{flex:"auto",children:e.jsxs(y,{type:"secondary",style:{fontSize:"12px"},children:[e.jsx(it,{style:{marginRight:"4px"}}),"Letters are sent to exhibitors automatically. Use manual sending for immediate delivery."]})}),e.jsx(l,{children:e.jsxs(U,{size:"small",children:[e.jsx(h,{icon:e.jsx(G,{}),onClick:Ue,size:"small",title:"Quick cleanup old letters",children:"Quick Cleanup"}),e.jsx(h,{icon:e.jsx(ke,{}),onClick:_e,size:"small",danger:!0,title:"Bulk delete letters",children:"Bulk Delete"}),e.jsx(h,{icon:e.jsx(ot,{}),onClick:P,size:"small",children:"Refresh"})]})})]})]}):null,We=[{title:"Type",dataIndex:"letterType",key:"letterType",width:140,render:t=>e.jsx(L,{color:t==="standPossession"?"blue":"green",style:{fontSize:"11px",padding:"2px 8px"},children:t==="standPossession"?"Stand Possession":"Transport"})},{title:"Recipient",key:"recipient",render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"13px"},children:s.recipientName}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:s.companyName}),e.jsx("div",{style:{fontSize:"11px",color:"#999"},children:s.recipientEmail})]})},{title:"Stalls",dataIndex:"stallNumbers",key:"stallNumbers",width:100,render:t=>e.jsx(L,{color:"default",style:{fontSize:"11px"},children:t.join(", ")})},{title:"Status",dataIndex:"status",key:"status",width:100,render:(t,s)=>e.jsxs("div",{children:[pe(t),s.failureReason&&e.jsx(Y,{title:s.failureReason,placement:"top",children:e.jsx(_,{style:{color:"#ff4d4f",marginLeft:"4px",cursor:"help"}})})]})},{title:"Sent",dataIndex:"sentAt",key:"sentAt",width:140,render:t=>e.jsx(y,{style:{fontSize:"12px"},children:t?J(t).format("MMM DD, HH:mm"):"-"})},{title:"Actions",key:"actions",width:180,render:(t,s)=>e.jsxs(U,{size:"small",children:[e.jsx(Y,{title:"View Details",children:e.jsx(h,{type:"text",icon:e.jsx(fe,{}),size:"small",onClick:()=>Qe(s)})}),e.jsx(Y,{title:"Download PDF",children:e.jsx(h,{type:"text",icon:e.jsx(je,{}),size:"small",onClick:()=>xe(s)})}),s.status==="failed"&&e.jsx(Y,{title:"Retry Send",children:e.jsx(h,{type:"text",icon:e.jsx(te,{}),size:"small",onClick:()=>Oe(s._id),style:{color:"#1890ff"}})}),e.jsx(dt,{menu:{items:[{key:"both",label:"Resend Both Types",icon:e.jsx(Se,{}),onClick:()=>W(s,["standPossession","transport"])},{key:"standPossession",label:"Resend Stand Possession",icon:e.jsx(be,{}),onClick:()=>W(s,["standPossession"])},{key:"transport",label:"Resend Transport",icon:e.jsx(te,{}),onClick:()=>W(s,["transport"])},{type:"divider"},{key:"delete",label:s.status==="sent"?"Delete Sent Letter":"Delete Letter",icon:e.jsx(ke,{}),danger:!0,onClick:()=>{s.status==="sent"?K(s._id,s.status):w.confirm({title:"Delete Letter",content:"Are you sure you want to delete this letter?",onOk:()=>K(s._id,s.status)})}}]},trigger:["click"],placement:"bottomRight",children:e.jsx(h,{type:"text",icon:e.jsx(ut,{}),size:"small"})})]})}],Ge=[{title:"Exhibition",dataIndex:"exhibitionName",key:"exhibitionName"},{title:"Letter Type",dataIndex:"letterType",key:"letterType",render:t=>e.jsx(L,{color:t==="standPossession"?"blue":"green",children:t==="standPossession"?"Stand Possession":"Transport"})},{title:"Scheduled Date",dataIndex:"scheduledDate",key:"scheduledDate",render:t=>J(t).format("MMM DD, YYYY")},{title:"Days Until Start",dataIndex:"daysUntilStart",key:"daysUntilStart",render:t=>e.jsx(xt,{count:t,style:{backgroundColor:t<=7?"#ff4d4f":"#52c41a"},overflowCount:99})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(L,{color:t==="due"?"red":"blue",children:t.toUpperCase()})}];return e.jsxs("div",{style:{padding:"24px",background:"#f5f5f5",minHeight:"100vh"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs(yt,{level:2,style:{margin:0,display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(rt,{style:{color:"#1890ff"}}),"Exhibition Letters"]}),e.jsx(gt,{type:"secondary",style:{margin:"8px 0 0 0",fontSize:"16px"},children:"Manage and monitor exhibition letters sent to exhibitors"})]}),e.jsxs(Le,{defaultActiveKey:"dashboard",style:{background:"white",borderRadius:"8px",padding:"24px"},children:[e.jsxs(Te,{tab:e.jsxs("span",{children:[e.jsx(at,{}),"Dashboard"]}),children:[e.jsx(I,{style:{marginBottom:"24px"},size:"small",children:e.jsxs(k,{gutter:[16,16],align:"middle",children:[e.jsx(l,{xs:24,md:12,children:e.jsxs("div",{children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Select Exhibition:"}),e.jsx(z,{style:{width:"100%"},placeholder:"Choose an exhibition to manage letters",value:n||void 0,onChange:Ee,showSearch:!0,optionFilterProp:"children",allowClear:!!n,size:"large",children:B.map(t=>e.jsx(R,{value:t._id,children:t.name},t._id))})]})}),n&&e.jsx(l,{xs:24,md:12,children:e.jsx(A,{message:`Managing letters for: ${B.find(t=>t._id===n)?.name}`,type:"info",showIcon:!0,style:{margin:0}})})]})}),n?e.jsxs(e.Fragment,{children:[e.jsx(qe,{}),e.jsx(Ke,{}),e.jsx(I,{style:{marginBottom:"24px"},size:"small",children:e.jsxs(k,{gutter:[16,16],align:"middle",children:[e.jsxs(l,{xs:24,sm:6,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Quick Filter:"}),e.jsxs(z,{style:{width:"100%"},value:F,onChange:le,children:[e.jsx(R,{value:"all",children:"All Letters"}),e.jsx(R,{value:"sent",children:"Sent Only"}),e.jsx(R,{value:"pending",children:"Pending Only"}),e.jsx(R,{value:"failed",children:"Failed Only"})]})]}),e.jsxs(l,{xs:24,sm:6,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Letter Type:"}),e.jsxs(z,{style:{width:"100%"},placeholder:"All Types",value:N||void 0,onChange:ae,allowClear:!0,children:[e.jsx(R,{value:"standPossession",children:"Stand Possession"}),e.jsx(R,{value:"transport",children:"Transport"})]})]}),e.jsxs(l,{xs:24,sm:8,children:[e.jsx(y,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Search:"}),e.jsx(mt,{placeholder:"Search by name, company, email...",value:O,onChange:t=>ie(t.target.value),allowClear:!0})]}),e.jsx(l,{xs:24,sm:4,children:e.jsx("div",{style:{marginTop:"32px"},children:e.jsx(h,{onClick:Ye,disabled:!he(),danger:he(),icon:e.jsx(G,{}),block:!0,children:"Clear Filters"})})})]})}),e.jsx(I,{children:e.jsx(ye,{columns:We,dataSource:Pe,rowKey:"_id",loading:De,size:"small",scroll:{x:800},pagination:{current:C.current,pageSize:C.pageSize,total:C.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} letters`,onChange:(t,s)=>{M(i=>({...i,current:t,pageSize:s||10}))}}})})]}):e.jsx(ge,{image:ge.PRESENTED_IMAGE_SIMPLE,description:e.jsx("span",{children:"Please select an exhibition to view and manage letters"})})]},"dashboard"),e.jsxs(Te,{tab:"Upcoming Schedules",children:[e.jsx(A,{message:"Automatic Letter Schedules",description:"These letters will be sent automatically based on exhibition dates and letter settings.",type:"info",showIcon:!0,style:{marginBottom:"24px"}}),e.jsx(I,{children:e.jsx(ye,{columns:Ge,dataSource:Ie,rowKey:t=>`${t.exhibitionId}-${t.letterType}`,pagination:!1,size:"small"})})]},"schedules")]}),e.jsx(w,{title:"Sending Letters",open:Ae,footer:null,closable:!1,centered:!0,children:e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(X,{type:"circle",percent:re,status:re===100?"success":"active",style:{marginBottom:"16px"}}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsx(y,{strong:!0,children:ze})})]})}),e.jsx(w,{title:e.jsxs(U,{children:[e.jsx(fe,{}),"Letter Details"]}),open:Fe,onCancel:()=>q(!1),footer:[e.jsx(h,{onClick:()=>q(!1),children:"Close"},"close"),p&&e.jsx(h,{type:"primary",icon:e.jsx(je,{}),onClick:()=>p&&xe(p),children:"Download PDF"},"download")],width:900,children:p&&e.jsxs("div",{children:[e.jsxs(k,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Type:"}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(L,{color:p.letterType==="standPossession"?"blue":"green",children:p.letterType==="standPossession"?"Stand Possession":"Transport"})})]}),e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Status:"}),e.jsx("div",{style:{marginTop:"4px"},children:pe(p.status)})]}),e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Recipient:"}),e.jsxs("div",{style:{marginTop:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:p.recipientName}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:p.recipientEmail})]})]}),e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Company:"}),e.jsx("div",{style:{marginTop:"4px"},children:p.companyName})]}),e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Stalls:"}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(L,{children:p.stallNumbers.join(", ")})})]}),e.jsxs(l,{span:12,children:[e.jsx(y,{strong:!0,children:"Sent At:"}),e.jsx("div",{style:{marginTop:"4px"},children:p.sentAt?J(p.sentAt).format("MMM DD, YYYY HH:mm"):"Not sent"})]})]}),e.jsx(me,{}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx(y,{strong:!0,children:"Subject:"}),e.jsx("div",{style:{marginTop:"8px",padding:"12px",background:"#f5f5f5",borderRadius:"6px",border:"1px solid #d9d9d9"},children:p.subject})]}),e.jsxs("div",{children:[e.jsx(y,{strong:!0,children:"Content:"}),e.jsx("div",{style:{marginTop:"8px",padding:"16px",background:"#f5f5f5",borderRadius:"6px",border:"1px solid #d9d9d9",whiteSpace:"pre-line",fontFamily:"monospace",maxHeight:"400px",overflow:"auto",fontSize:"13px",lineHeight:"1.6"},children:p.content})]}),p.failureReason&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsx(y,{strong:!0,children:"Failure Reason:"}),e.jsxs("div",{style:{marginTop:"8px",padding:"12px",background:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"6px",color:"#a8071a"},children:[e.jsx(_,{style:{marginRight:"8px"}}),p.failureReason]})]})]})})]})};export{Pt as default};
