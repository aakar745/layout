import{M as d,j as e}from"./index-ZeXq6Cnq.js";import{u as N,r}from"./vendor-react-BNeW3y6d.js";/* empty css                  */import{ae as V,H as i,a6 as D,a7 as g,S as p,T as P,I as m,c as u,aT as _,a5 as q,aj as L,W as O,a1 as b,b as S}from"./vendor-antd-DmzwxccF.js";import"./vendor-utils-D9BQhWAM.js";import"./vendor-styling-C4kvkEn0.js";import"./vendor-canvas-BRbMLhVA.js";const{Title:R,Text:B}=P,{TextArea:U}=m,{Search:z}=m,{Option:T}=b,X=()=>{N();const{message:n}=V.useApp(),[c,o]=r.useState(!1),[l]=i.useForm(),[v,f]=r.useState(!1),[F,I]=r.useState([]),[w,j]=r.useState(!1),[a,y]=r.useState(null);r.useEffect(()=>{h()},[]),r.useEffect(()=>{var t;if(console.log("Modal visibility changed:",c),console.log("Editing stall type:",a),c&&a){const s=((t=a.features)==null?void 0:t.map(x=>x.feature).join(", "))||"";console.log("Setting form values:",{name:a.name,description:a.description,features:s,status:a.status}),setTimeout(()=>{l.setFieldsValue({name:a.name,description:a.description,features:s,status:a.status})},0)}else c&&(l.resetFields(),l.setFieldsValue({status:"active"}))},[a,l,c]);const h=async()=>{try{j(!0);const t=await d.getStallTypes();I(t.data)}catch(t){n.error("Failed to fetch stall types: "+t.message)}finally{j(!1)}},C=async t=>{try{f(!0),console.log("Form values:",t);const s={name:t.name,description:t.description,status:t.status,features:t.features?t.features.split(",").map(x=>({feature:x.trim()})):[]};console.log("Submitting data:",s),a?(await d.updateStallType(a._id,s),n.success("Stall type updated successfully")):(await d.createStallType(s),n.success("Stall type created successfully")),o(!1),y(null),l.resetFields(),h()}catch(s){n.error(`Failed to ${a?"update":"create"} stall type: `+s.message)}finally{f(!1)}},E=t=>{console.log("Editing stall type:",t),y(t),o(!0)},k=async t=>{try{await d.deleteStallType(t._id),n.success("Stall type deleted successfully"),h()}catch(s){n.error("Failed to delete stall type: "+s.message)}},A=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(t,s)=>t.name.localeCompare(s.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:t=>e.jsx(p,{wrap:!0,children:t==null?void 0:t.map(({feature:s})=>e.jsx(S,{children:s},s))})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(S,{color:t==="active"?"success":"default",children:t.toUpperCase()})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(p,{children:[e.jsx(u,{type:"link",onClick:()=>E(s),children:"Edit"}),e.jsx(u,{type:"link",danger:!0,onClick:()=>k(s),children:"Delete"})]})}],M=()=>{o(!1),y(null),l.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(D,{justify:"space-between",align:"middle",children:[e.jsx(g,{children:e.jsxs(p,{direction:"vertical",size:4,children:[e.jsx(R,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(B,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(g,{children:e.jsxs(p,{children:[e.jsx(z,{placeholder:"Search stall types",style:{width:200},onSearch:t=>console.log(t)}),e.jsx(u,{type:"primary",icon:e.jsx(_,{}),onClick:()=>o(!0),children:"Add Stall Type"})]})})]})}),e.jsx(q,{className:"info-card",children:e.jsx(L,{columns:A,dataSource:F,rowKey:t=>t._id,loading:w})}),e.jsx(O,{title:a?"Edit Stall Type":"Add Stall Type",open:c,onCancel:M,footer:null,destroyOnClose:!1,children:e.jsxs(i,{form:l,layout:"vertical",onFinish:C,initialValues:{status:"active"},preserve:!0,children:[e.jsx(i.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(m,{placeholder:"e.g., 1 Side Open"})}),e.jsx(i.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(U,{rows:4,placeholder:"Enter description"})}),e.jsx(i.Item,{name:"features",label:"Features",children:e.jsx(m,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(i.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(b,{children:[e.jsx(T,{value:"active",children:"Active"}),e.jsx(T,{value:"inactive",children:"Inactive"})]})}),e.jsx(i.Item,{children:e.jsxs(u,{type:"primary",htmlType:"submit",loading:v,block:!0,children:[a?"Update":"Create"," Stall Type"]})})]})})]})};export{X as default};
