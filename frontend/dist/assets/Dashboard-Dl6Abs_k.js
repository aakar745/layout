import{p as D,j as e}from"./index-ZeXq6Cnq.js";import{r as x,i as J,u as K,L as v}from"./vendor-react-BNeW3y6d.js";import{d as l,T as O,N as T,c as t,a6 as b,a7 as n,a5 as c,aI as u,w as R,x as g,h as Y,aF as L,L as h,S as $,D as X,aN as Z,E as N,z as P,aL as ee,f as ie,b as j,m as U}from"./vendor-antd-DmzwxccF.js";import"./vendor-utils-D9BQhWAM.js";import"./vendor-styling-C4kvkEn0.js";import"./vendor-canvas-BRbMLhVA.js";const{Title:se,Text:r,Paragraph:ce}=O,de=()=>{const[a,V]=x.useState([]),[s,k]=x.useState(!0),[E,I]=x.useState(null),[S,z]=x.useState([]),[w,M]=x.useState(!0),f=J(i=>i.exhibitorAuth.exhibitor),o=K();x.useEffect(()=>{_(),F()},[]);const _=async()=>{try{k(!0),I(null);const i=await D.getExhibitorBookings();V(i.data||[])}catch(i){console.error("Failed to fetch bookings:",i),I("Unable to load your bookings at this time. Please try again later.")}finally{k(!1)}},F=async()=>{try{M(!0);const i=await D.getExhibitions(),d=l(),m=(i.data||[]).filter(p=>p.isActive&&l(p.endDate).isAfter(d)).slice(0,3);z(m)}catch(i){console.error("Failed to fetch upcoming exhibitions:",i)}finally{M(!1)}},G=a.filter(i=>i.status==="approved").length,y=a.filter(i=>i.status==="pending").length;a.filter(i=>i.status==="rejected").length;const H=a.filter(i=>i.status==="confirmed").length,Q=i=>{switch(i){case"approved":return e.jsxs(j,{color:"success",children:[e.jsx(g,{})," Approved"]});case"pending":return e.jsxs(j,{color:"warning",children:[e.jsx(Y,{})," Pending"]});case"rejected":return e.jsxs(j,{color:"error",children:[e.jsx(U,{})," Rejected"]});case"confirmed":return e.jsxs(j,{color:"blue",children:[e.jsx(g,{})," Confirmed"]});case"cancelled":return e.jsxs(j,{color:"default",children:[e.jsx(U,{})," Cancelled"]});default:return e.jsx(j,{children:"Unknown"})}},W=i=>{o(`/exhibitor/invoice/${i}`)},A=(i,d)=>i.status===d;return e.jsxs("div",{children:[e.jsxs(se,{level:2,children:["Welcome, ",(f==null?void 0:f.companyName)||"Exhibitor"]}),e.jsx(r,{type:"secondary",children:"Here's an overview of your exhibition activities"}),E&&e.jsx(T,{message:"Error",description:E,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),y>0&&e.jsx(T,{message:"Pending Approvals",description:`You have ${y} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:e.jsx(t,{size:"small",type:"primary",onClick:()=>o("/exhibitor/bookings"),children:"View Bookings"})}),e.jsxs(b,{gutter:[24,24],style:{marginTop:24},children:[e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(c,{children:e.jsx(u,{title:"Total Bookings",value:s?"-":a.length,prefix:e.jsx(R,{}),loading:s})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(c,{children:e.jsx(u,{title:"Confirmed",value:s?"-":H,valueStyle:{color:"#1890ff"},prefix:e.jsx(g,{}),loading:s})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(c,{children:e.jsx(u,{title:"Approved",value:s?"-":G,valueStyle:{color:"#3f8600"},prefix:e.jsx(g,{}),loading:s})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(c,{children:e.jsx(u,{title:"Pending",value:s?"-":y,valueStyle:{color:"#faad14"},prefix:e.jsx(Y,{}),loading:s})})})]}),e.jsx(c,{title:"Recent Bookings",extra:e.jsx(v,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:s,children:s?e.jsx(L,{active:!0,paragraph:{rows:3}}):a.length>0?e.jsx(h,{dataSource:a.slice(0,5),renderItem:i=>{var d,m,p,B,C;return e.jsxs(h.Item,{actions:[e.jsx(t,{type:"link",onClick:()=>o(`/exhibitor/bookings/${i._id}`),children:"View Details"},"view"),A(i,"approved")||A(i,"confirmed")?e.jsx(t,{type:"link",icon:e.jsx(Z,{}),onClick:()=>W(i._id),children:"Invoice"},"invoice"):null].filter(Boolean),children:[e.jsx(h.Item.Meta,{title:e.jsxs("div",{children:[e.jsx(r,{strong:!0,children:((d=i.exhibitionId)==null?void 0:d.name)||"Exhibition"}),e.jsxs(r,{type:"secondary",style:{marginLeft:12},children:["Stall: ",((m=i.stallIds)==null?void 0:m.map(q=>q.number).join(", "))||"N/A"]})]}),description:e.jsxs($,{direction:"vertical",size:1,children:[e.jsxs("div",{children:[e.jsxs(r,{children:["Booked on: ",l(i.createdAt).format("MMM D, YYYY")]}),e.jsx(X,{type:"vertical"}),e.jsxs(r,{children:["Amount: â‚¹",((p=i.amount)==null?void 0:p.toLocaleString())||"N/A"]})]}),e.jsx("div",{children:e.jsxs(r,{children:["Exhibition date: ",l((B=i.exhibitionId)==null?void 0:B.startDate).format("MMM D")," - ",l((C=i.exhibitionId)==null?void 0:C.endDate).format("MMM D, YYYY")]})})]})}),Q(i.status)]})}}):e.jsx(N,{description:"No bookings found",image:N.PRESENTED_IMAGE_SIMPLE})}),e.jsx(c,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:w,extra:e.jsx(v,{to:"/exhibitions",children:"View All"}),children:w?e.jsx(L,{active:!0,paragraph:{rows:3}}):S.length>0?e.jsx(h,{dataSource:S,renderItem:i=>e.jsx(h.Item,{actions:[e.jsx(t,{type:"primary",onClick:()=>o(`/exhibitions/${i._id}/layout`),children:"Book Stall"},"book")],children:e.jsx(h.Item.Meta,{title:i.name,description:e.jsxs($,{direction:"vertical",size:1,children:[e.jsx(r,{children:i.venue}),e.jsxs(r,{type:"secondary",children:[l(i.startDate).format("MMM D")," - ",l(i.endDate).format("MMM D, YYYY")]})]})})})}):e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(P,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),e.jsxs("div",{children:[e.jsx(r,{children:"No upcoming exhibitions at the moment"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(v,{to:"/exhibitions",children:e.jsx(t,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),e.jsx(b,{gutter:[24,24],style:{marginTop:24},children:e.jsx(n,{span:24,children:e.jsx(c,{title:"Quick Actions",children:e.jsxs(b,{gutter:[16,16],children:[e.jsx(n,{xs:24,sm:12,md:8,lg:6,children:e.jsx(t,{type:"primary",icon:e.jsx(R,{}),block:!0,onClick:()=>o("/exhibitions"),children:"Book New Stall"})}),e.jsx(n,{xs:24,sm:12,md:8,lg:6,children:e.jsx(t,{icon:e.jsx(P,{}),block:!0,onClick:()=>o("/exhibitor/bookings"),children:"View All Bookings"})}),e.jsx(n,{xs:24,sm:12,md:8,lg:6,children:e.jsx(t,{icon:e.jsx(ee,{}),block:!0,onClick:()=>o("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),e.jsx(n,{xs:24,sm:12,md:8,lg:6,children:e.jsx(t,{icon:e.jsx(ie,{}),block:!0,onClick:()=>o("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})};export{de as default};
