import{r as e,j as s,M as t,d as n,F as i,A as r,a6 as a,C as l,T as d,Z as o,a8 as c,_ as h,q as x}from"./vendor-others-aeGeD6f-.js";import{u as j,a as p}from"./vendor-react-i7tvbPTl.js";import{m}from"./store-D4NI4RZ9.js";import{e as u}from"./services-DHEt1Qtz.js";import"./page-dashboard-984XnN9x.js";import{F as g}from"./vendor-antd-form-DJHhvp8w.js";import{R as v,C as y,e as f,T as b,c as w,z as C,I as S,f as A,d as k,B as I,D as P,x as E,A as N,h as T,s as D,o as R,k as F,v as z,M as L}from"./vendor-antd-core-CLD06I8y.js";import{B}from"./vendor-antd-buttons-wjEWA2x8.js";import{F as O}from"./vendor-antd-table-CA0XBoxE.js";import{M as $}from"./vendor-antd-modal-1GBGM2fb.js";import"./vendor-ui-BOD89xu8.js";import"./vendor-canvas-BOVIu3pe.js";import"./vendor-utils-CTzFqUk0.js";import"./component-exhibition-CuwlJtEU.js";import"./vendor-editor-HOXaQDhO.js";import"./component-layout-BTsCaDZB.js";import"./component-auth-ClRi3ofU.js";const{Title:q,Text:U,Paragraph:_}=b,{Option:W}=A,{TextArea:K,Search:M}=S,{RangePicker:Y}=k,V=()=>{const b=j(),{exhibitors:k,loading:V}=p((e=>e.exhibitor)),[G,Z]=e.useState(null),[H,J]=e.useState(!1),[Q,X]=e.useState(!1),[ee,se]=e.useState(!1),[te,ne]=e.useState("approved"),[ie,re]=e.useState(""),[ae,le]=e.useState(!1),[de,oe]=e.useState(!1),[ce,he]=e.useState(!1),[xe,je]=e.useState(""),[pe,me]=e.useState([]),[ue]=g.useForm(),[ge,ve]=e.useState([]);ge.length;const[ye,fe]=e.useState({total:0,pending:0,approved:0,rejected:0});e.useEffect((()=>{b(m())}),[b]),e.useEffect((()=>{if(null==k?void 0:k.length){me(k);const e={total:k.length,pending:k.filter((e=>"pending"===e.status)).length,approved:k.filter((e=>"approved"===e.status)).length,rejected:k.filter((e=>"rejected"===e.status)).length};fe(e)}}),[k]),e.useEffect((()=>{G&&Q&&ue.setFieldsValue({companyName:G.companyName,contactPerson:G.contactPerson,email:G.email,phone:G.phone,address:G.address||"",website:G.website||"",description:G.description||"",isActive:G.isActive})}),[G,Q,ue]);const be=e=>{switch(e){case"approved":return s.jsx(R,{color:"success",children:"Approved"});case"pending":return s.jsx(R,{color:"warning",children:"Pending"});case"rejected":return s.jsx(R,{color:"error",children:"Rejected"});default:return s.jsx(R,{children:"Unknown"})}},we={selectedRowKeys:ge,onChange:e=>{ve(e)}},Ce=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(e,s)=>e.companyName.localeCompare(s.companyName),filterDropdown:({setSelectedKeys:e,selectedKeys:t,confirm:n,clearFilters:i})=>s.jsxs("div",{style:{padding:8},children:[s.jsx(S,{placeholder:"Search company or contact",value:t[0],onChange:s=>e(s.target.value?[s.target.value]:[]),onPressEnter:()=>n(),style:{width:188,marginBottom:8,display:"block"}}),s.jsxs(f,{children:[s.jsx(B,{type:"primary",onClick:()=>n(),icon:s.jsx(d,{}),size:"small",style:{width:90},children:"Filter"}),s.jsx(B,{onClick:()=>{i&&i(),n()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:e=>s.jsx(d,{style:{color:e?"#1890ff":void 0}}),onFilter:(e,s)=>{const t=String(e).toLowerCase();return s.companyName.toLowerCase().includes(t)||s.contactPerson.toLowerCase().includes(t)},render:(e,t)=>s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"bold"},children:e}),s.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",t.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(e,t)=>s.jsxs("div",{children:[s.jsx("div",{children:e}),s.jsx("div",{style:{fontSize:"12px"},children:t.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(e,s)=>s.status===e,render:e=>be(e)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(e,s)=>s.isActive===e,render:e=>s.jsx(R,{color:e?"green":"red",children:e?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(e,s)=>new Date(e.createdAt).getTime()-new Date(s.createdAt).getTime(),render:e=>s.jsx(F,{title:new Date(e).toLocaleString(),children:new Date(e).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:e=>e?s.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:e.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(e,t)=>s.jsxs(f,{children:[s.jsx(F,{title:"View Details",children:s.jsx(B,{icon:s.jsx(o,{}),onClick:()=>{Z(t),se(!0)}})}),s.jsx(B,{type:"primary",onClick:()=>{Z(t),ne(t.status),re(t.rejectionReason||""),J(!0)},children:"Update Status"}),s.jsx(z,{overlay:s.jsxs(L,{children:[s.jsx(L.Item,{icon:s.jsx(h,{}),onClick:()=>{Z(t),X(!0)},children:"Edit"},"edit"),s.jsx(L.Item,{icon:s.jsx(x,{}),danger:!0,onClick:e=>{e.domEvent.stopPropagation(),$.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>(async e=>{var s,t;try{he(!0),await u.deleteExhibitor(e),D.success("Exhibitor deleted successfully"),b(m())}catch(n){D.error((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.message)||"Failed to delete exhibitor")}finally{he(!1)}})(t._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:s.jsx(B,{icon:s.jsx(c,{})})})]})}];return s.jsxs("div",{className:"dashboard-container",children:[s.jsx("div",{style:{marginBottom:"24px"},children:s.jsxs(v,{gutter:[24,24],align:"middle",children:[s.jsx(y,{flex:"auto",children:s.jsxs(f,{direction:"vertical",size:4,children:[s.jsx(q,{level:4,style:{margin:0},children:"Exhibitors"}),s.jsx(U,{type:"secondary",children:"Manage exhibitors and their information"})]})}),s.jsx(y,{children:s.jsx(B,{type:"primary",icon:s.jsx(t,{}),onClick:()=>X(!0),size:"large",children:"Add Exhibitor"})})]})}),s.jsxs(v,{gutter:[16,24],style:{marginBottom:"24px"},children:[s.jsx(y,{xs:24,sm:12,md:6,children:s.jsx(w,{children:s.jsx(C,{title:"Total Exhibitors",value:ye.total,prefix:s.jsx(n,{})})})}),s.jsx(y,{xs:24,sm:12,md:6,children:s.jsx(w,{children:s.jsx(C,{title:"Pending",value:ye.pending,prefix:s.jsx(i,{style:{color:"#faad14"}})})})}),s.jsx(y,{xs:24,sm:12,md:6,children:s.jsx(w,{children:s.jsx(C,{title:"Approved",value:ye.approved,prefix:s.jsx(r,{style:{color:"#52c41a"}})})})}),s.jsx(y,{xs:24,sm:12,md:6,children:s.jsx(w,{children:s.jsx(C,{title:"Rejected",value:ye.rejected,prefix:s.jsx(a,{style:{color:"#ff4d4f"}})})})})]}),s.jsx(w,{className:"info-card",style:{marginBottom:"24px"},children:s.jsxs(f,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsxs(v,{gutter:[16,16],align:"middle",children:[s.jsx(y,{xs:24,sm:8,md:6,lg:4,children:s.jsx(M,{placeholder:"Search exhibitors",allowClear:!0,onSearch:e=>{if(je(e),!e)return void me(k);const s=e.toLowerCase(),t=k.filter((e=>e.companyName.toLowerCase().includes(s)||e.contactPerson.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.phone.toLowerCase().includes(s)));me(t)},style:{width:"100%"}})}),s.jsx(y,{xs:24,sm:8,md:6,lg:4,children:s.jsxs(A,{placeholder:"Filter by status",style:{width:"100%"},onChange:e=>{if("all"===e)return void me(k);const s=k.filter((s=>s.status===e));me(s)},allowClear:!0,children:[s.jsx(W,{value:"all",children:"All Status"}),s.jsx(W,{value:"pending",children:"Pending"}),s.jsx(W,{value:"approved",children:"Approved"}),s.jsx(W,{value:"rejected",children:"Rejected"})]})}),s.jsx(y,{xs:24,sm:8,md:6,lg:6,children:s.jsx(Y,{style:{width:"100%"},onChange:e=>{if(!e||2!==e.length)return void me(k);const s=e[0].startOf("day").toISOString(),t=e[1].endOf("day").toISOString(),n=k.filter((e=>{const n=new Date(e.createdAt).toISOString();return n>=s&&n<=t}));me(n)}})})]}),ge.length>0&&s.jsx(v,{children:s.jsxs(f,{children:[s.jsxs(U,{children:["Selected ",ge.length," items"]}),s.jsx(B,{danger:!0,onClick:()=>{$.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${ge.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{he(!0);const e=ge.map((e=>u.deleteExhibitor(e.toString())));await Promise.all(e),D.success(`${ge.length} exhibitors deleted successfully`),ve([]),b(m())}catch(e){D.error("Failed to delete some exhibitors")}finally{he(!1)}}})},children:"Delete Selected"}),s.jsx(B,{type:"primary",onClick:()=>{const e=pe.map((e=>[e.companyName,e.contactPerson,e.email,e.phone,e.status,e.isActive?"Yes":"No",new Date(e.createdAt).toLocaleDateString(),e.address||"",e.website||""]));e.unshift(["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"]);const s=e.map((e=>e.map((e=>"string"==typeof e&&(e.includes(",")||e.includes('"')||e.includes("\n"))?`"${e.replace(/"/g,'""')}"`:e)).join(","))).join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",`exhibitors-${(new Date).toISOString().split("T")[0]}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),D.success("Exhibitor data exported successfully")},children:"Export Selected"})]})})]})}),s.jsx(w,{className:"info-card",children:s.jsx(O,{rowSelection:we,dataSource:pe,columns:Ce,rowKey:"_id",loading:V,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(e,s)=>`${s[0]}-${s[1]} of ${e} items`},scroll:{x:1500}})}),s.jsx($,{title:"Exhibitor Details",open:ee,onCancel:()=>se(!1),footer:[s.jsx(B,{onClick:()=>se(!1),children:"Close"},"close")],width:600,children:G&&s.jsx("div",{children:s.jsxs(v,{gutter:[16,16],children:[s.jsx(y,{span:24,children:s.jsx(w,{title:"Company Information",children:s.jsxs(v,{gutter:[16,8],children:[s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Company Name:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.companyName})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Contact Person:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.contactPerson})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Email:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.email})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Phone:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.phone})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Address:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.address||"Not provided"})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Status:"})}),s.jsx(y,{span:12,children:be(G.status)}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Active:"})}),s.jsx(y,{span:12,children:s.jsx(I,{status:G.isActive?"success":"error",text:G.isActive?"Yes":"No"})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Registration Date:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:new Date(G.createdAt).toLocaleString()})})]})})}),s.jsx(y,{span:24,children:s.jsxs(w,{title:"Additional Information",children:[s.jsxs(v,{gutter:[16,8],children:[s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Address:"})}),s.jsx(y,{span:12,children:s.jsx(U,{children:G.address||"Not provided"})}),s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Website:"})}),s.jsx(y,{span:12,children:G.website?s.jsx("a",{href:G.website,target:"_blank",rel:"noopener noreferrer",children:G.website}):"Not provided"}),"rejected"===G.status&&s.jsxs(s.Fragment,{children:[s.jsx(y,{span:12,children:s.jsx(U,{strong:!0,children:"Rejection Reason:"})}),s.jsx(y,{span:12,children:s.jsx(U,{type:"danger",children:G.rejectionReason||"No reason provided"})})]})]}),G.description&&s.jsxs(s.Fragment,{children:[s.jsx(P,{}),s.jsx(U,{strong:!0,children:"Description:"}),s.jsx(_,{style:{marginTop:8},children:G.description})]})]})})]})})}),s.jsx($,{title:"Update Exhibitor Status",open:H,onCancel:()=>J(!1),footer:null,width:600,children:G&&s.jsxs("div",{children:[s.jsx(w,{title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(n,{style:{fontSize:"18px"}}),s.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:s.jsxs(v,{gutter:[16,8],children:[s.jsx(y,{span:8,children:s.jsx(U,{strong:!0,children:"Company:"})}),s.jsx(y,{span:16,children:s.jsx(U,{children:G.companyName})}),s.jsx(y,{span:8,children:s.jsx(U,{strong:!0,children:"Contact Person:"})}),s.jsx(y,{span:16,children:s.jsx(U,{children:G.contactPerson})}),s.jsx(y,{span:8,children:s.jsx(U,{strong:!0,children:"Email:"})}),s.jsx(y,{span:16,children:s.jsx(U,{children:G.email})}),s.jsx(y,{span:8,children:s.jsx(U,{strong:!0,children:"Address:"})}),s.jsx(y,{span:16,children:s.jsx(U,{children:G.address||"Not provided"})}),s.jsx(y,{span:8,children:s.jsx(U,{strong:!0,children:"Current Status:"})}),s.jsx(y,{span:16,children:be(G.status)})]})}),s.jsxs(w,{title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(l,{style:{fontSize:"18px"}}),s.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[s.jsxs("div",{children:[s.jsx(U,{strong:!0,children:"Select New Status:"}),s.jsx("div",{style:{marginTop:"16px"},children:s.jsxs(E.Group,{value:te,onChange:e=>ne(e.target.value),buttonStyle:"solid",children:[s.jsx(E.Button,{value:"pending",children:s.jsxs(f,{children:[s.jsx(i,{style:{color:"#faad14"}}),"Pending"]})}),s.jsx(E.Button,{value:"approved",children:s.jsxs(f,{children:[s.jsx(r,{style:{color:"#52c41a"}}),"Approved"]})}),s.jsx(E.Button,{value:"rejected",children:s.jsxs(f,{children:[s.jsx(a,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),"rejected"===te&&s.jsx("div",{children:s.jsx(g.Item,{label:s.jsx(U,{strong:!0,children:"Rejection Reason:"}),required:"rejected"===te,rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:s.jsx(K,{rows:4,value:ie,onChange:e=>re(e.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),"approved"===te&&s.jsx(N,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),"pending"===te&&s.jsx(N,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),s.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[s.jsx(B,{onClick:()=>J(!1),children:"Cancel"}),s.jsx(B,{type:"primary",onClick:async()=>{var e,s;if(G)try{le(!0),await u.updateStatus(G._id,te,"rejected"===te?ie:void 0),D.success(`Exhibitor status updated to ${te}`),J(!1),b(m())}catch(t){D.error((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.message)||"Failed to update exhibitor status")}finally{le(!1)}},loading:ae,disabled:"rejected"===te&&!ie.trim(),children:"Update Status"})]})]})]})}),s.jsx($,{title:"Edit Exhibitor Details",open:Q,onCancel:()=>X(!1),footer:null,width:600,children:s.jsxs(g,{form:ue,layout:"vertical",onFinish:async e=>{var s,t;if(G)try{oe(!0),await u.updateExhibitor(G._id,e),D.success("Exhibitor details updated successfully"),X(!1),b(m())}catch(n){D.error((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.message)||"Failed to update exhibitor details")}finally{oe(!1)}},children:[s.jsx(g.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:s.jsx(S,{})}),s.jsx(g.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:s.jsx(S,{})}),s.jsx(g.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:s.jsx(S,{})}),s.jsx(g.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:s.jsx(S,{})}),s.jsx(g.Item,{name:"address",label:"Address",children:s.jsx(S,{})}),s.jsx(g.Item,{name:"website",label:"Website",children:s.jsx(S,{})}),s.jsx(g.Item,{name:"description",label:"Description",children:s.jsx(K,{rows:4})}),s.jsx(g.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:s.jsx(T,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),s.jsx(g.Item,{children:s.jsxs(f,{children:[s.jsx(B,{type:"primary",htmlType:"submit",loading:de,children:"Save Changes"}),s.jsx(B,{onClick:()=>X(!1),children:"Cancel"})]})})]})})]})};export{V as default};
