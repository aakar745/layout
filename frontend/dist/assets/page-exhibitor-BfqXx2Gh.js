import{r as e,j as n,m as i,A as t,F as s,af as o,a7 as r,a9 as l,d as a,a6 as d,U as c,D as m,i as u,Z as x,C as h,ad as p,c as j,a as g,e as b,x as y,X as v,ag as f}from"./vendor-others-aeGeD6f-.js";import{a as I,c as k,L as w,d as S,b as A,u as P}from"./vendor-react-i7tvbPTl.js";import{d as N}from"./vendor-utils-CTzFqUk0.js";import{p as C,e as T}from"./services-DHEt1Qtz.js";import{T as M,A as D,R as B,C as _,c as E,z,H as Y,J as F,e as L,D as R,E as $,o as U,I as O,j as q,k as V,s as G,f as K,b as W,n as Z,u as H,P as J}from"./vendor-antd-core-CLD06I8y.js";import{B as Q}from"./vendor-antd-buttons-wjEWA2x8.js";import{F as X}from"./vendor-antd-table-CA0XBoxE.js";import{M as ee}from"./vendor-antd-modal-1GBGM2fb.js";import{b as ne,z as ie,A as te,B as se,C as oe}from"./store-D4NI4RZ9.js";import{F as re}from"./vendor-antd-form-DJHhvp8w.js";import{I as le}from"./component-invoice-D8MH7a8A.js";const{Title:ae,Text:de,Paragraph:ce}=M,me=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[c,m]=e.useState([]),[u,x]=e.useState(!0),[h,p]=e.useState(null),[j,g]=e.useState([]),[b,y]=e.useState(!0),v=I((e=>e.exhibitorAuth.exhibitor)),f=k();e.useEffect((()=>{S(),A()}),[]);const S=async()=>{try{x(!0),p(null);const e=await C.getExhibitorBookings();m(e.data||[])}catch(e){p("Unable to load your bookings at this time. Please try again later.")}finally{x(!1)}},A=async()=>{try{y(!0);const e=await C.getExhibitions(),n=N(),i=(e.data||[]).filter((e=>e.isActive&&N(e.endDate).isAfter(n))).slice(0,3);g(i)}catch(e){}finally{y(!1)}},P=c.filter((e=>"approved"===e.status)).length,T=c.filter((e=>"pending"===e.status)).length;c.filter((e=>"rejected"===e.status)).length;const M=c.filter((e=>"confirmed"===e.status)).length,O=e=>{switch(e){case"approved":return n.jsxs(U,{color:"success",children:[n.jsx(t,{})," Approved"]});case"pending":return n.jsxs(U,{color:"warning",children:[n.jsx(s,{})," Pending"]});case"rejected":return n.jsxs(U,{color:"error",children:[n.jsx(d,{})," Rejected"]});case"confirmed":return n.jsxs(U,{color:"blue",children:[n.jsx(t,{})," Confirmed"]});case"cancelled":return n.jsxs(U,{color:"default",children:[n.jsx(d,{})," Cancelled"]});default:return n.jsx(U,{children:"Unknown"})}},q=(e,n)=>e.status===n;return n.jsxs("div",{children:[n.jsxs(ae,{level:2,children:["Welcome, ",(null==v?void 0:v.companyName)||"Exhibitor"]}),n.jsx(de,{type:"secondary",children:"Here's an overview of your exhibition activities"}),h&&n.jsx(D,{message:"Error",description:h,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24}}),T>0&&n.jsx(D,{message:"Pending Approvals",description:`You have ${T} booking(s) waiting for approval.`,type:"info",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(Q,{size:"small",type:"primary",onClick:()=>f("/exhibitor/bookings"),children:"View Bookings"})}),n.jsxs(B,{gutter:[24,24],style:{marginTop:24},children:[n.jsx(_,{xs:24,sm:12,md:6,children:n.jsx(E,{children:n.jsx(z,{title:"Total Bookings",value:u?"-":c.length,prefix:n.jsx(i,{}),loading:u})})}),n.jsx(_,{xs:24,sm:12,md:6,children:n.jsx(E,{children:n.jsx(z,{title:"Confirmed",value:u?"-":M,valueStyle:{color:"#1890ff"},prefix:n.jsx(t,{}),loading:u})})}),n.jsx(_,{xs:24,sm:12,md:6,children:n.jsx(E,{children:n.jsx(z,{title:"Approved",value:u?"-":P,valueStyle:{color:"#3f8600"},prefix:n.jsx(t,{}),loading:u})})}),n.jsx(_,{xs:24,sm:12,md:6,children:n.jsx(E,{children:n.jsx(z,{title:"Pending",value:u?"-":T,valueStyle:{color:"#faad14"},prefix:n.jsx(s,{}),loading:u})})})]}),n.jsx(E,{title:"Recent Bookings",extra:n.jsx(w,{to:"/exhibitor/bookings",children:"View All"}),style:{marginTop:24},loading:u,children:u?n.jsx(Y,{active:!0,paragraph:{rows:3}}):c.length>0?n.jsx(F,{dataSource:c.slice(0,5),renderItem:e=>{var i,t,s,r,l;return n.jsxs(F.Item,{actions:[n.jsx(Q,{type:"link",onClick:()=>f(`/exhibitor/bookings/${e._id}`),children:"View Details"},"view"),q(e,"approved")||q(e,"confirmed")?n.jsx(Q,{type:"link",icon:n.jsx(o,{}),onClick:()=>{return n=e._id,void f(`/exhibitor/invoice/${n}`);var n},children:"Invoice"},"invoice"):null].filter(Boolean),children:[n.jsx(F.Item.Meta,{title:n.jsxs("div",{children:[n.jsx(de,{strong:!0,children:(null==(i=e.exhibitionId)?void 0:i.name)||"Exhibition"}),n.jsxs(de,{type:"secondary",style:{marginLeft:12},children:["Stall: ",(null==(t=e.stallIds)?void 0:t.map((e=>e.number)).join(", "))||"N/A"]})]}),description:n.jsxs(L,{direction:"vertical",size:1,children:[n.jsxs("div",{children:[n.jsxs(de,{children:["Booked on: ",N(e.createdAt).format("MMM D, YYYY")]}),n.jsx(R,{type:"vertical"}),n.jsxs(de,{children:["Amount: ₹",(null==(s=e.amount)?void 0:s.toLocaleString())||"N/A"]})]}),n.jsx("div",{children:n.jsxs(de,{children:["Exhibition date: ",N(null==(r=e.exhibitionId)?void 0:r.startDate).format("MMM D")," - ",N(null==(l=e.exhibitionId)?void 0:l.endDate).format("MMM D, YYYY")]})})]})}),O(e.status)]})}}):n.jsx($,{description:"No bookings found",image:$.PRESENTED_IMAGE_SIMPLE})}),n.jsx(E,{title:"Upcoming Exhibitions",style:{marginTop:24},loading:b,extra:n.jsx(w,{to:"/exhibitions",children:"View All"}),children:b?n.jsx(Y,{active:!0,paragraph:{rows:3}}):j.length>0?n.jsx(F,{dataSource:j,renderItem:e=>n.jsx(F.Item,{actions:[n.jsx(Q,{type:"primary",onClick:()=>f(`/exhibitions/${e._id}/layout`),children:"Book Stall"},"book")],children:n.jsx(F.Item.Meta,{title:e.name,description:n.jsxs(L,{direction:"vertical",size:1,children:[n.jsx(de,{children:e.venue}),n.jsxs(de,{type:"secondary",children:[N(e.startDate).format("MMM D")," - ",N(e.endDate).format("MMM D, YYYY")]})]})})})}):n.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[n.jsx(r,{style:{fontSize:48,color:"#1890ff",marginBottom:16}}),n.jsxs("div",{children:[n.jsx(de,{children:"No upcoming exhibitions at the moment"}),n.jsx("div",{style:{marginTop:16},children:n.jsx(w,{to:"/exhibitions",children:n.jsx(Q,{type:"primary",children:"Browse All Exhibitions"})})})]})]})}),n.jsx(B,{gutter:[24,24],style:{marginTop:24},children:n.jsx(_,{span:24,children:n.jsx(E,{title:"Quick Actions",children:n.jsxs(B,{gutter:[16,16],children:[n.jsx(_,{xs:24,sm:12,md:8,lg:6,children:n.jsx(Q,{type:"primary",icon:n.jsx(i,{}),block:!0,onClick:()=>f("/exhibitions"),children:"Book New Stall"})}),n.jsx(_,{xs:24,sm:12,md:8,lg:6,children:n.jsx(Q,{icon:n.jsx(r,{}),block:!0,onClick:()=>f("/exhibitor/bookings"),children:"View All Bookings"})}),n.jsx(_,{xs:24,sm:12,md:8,lg:6,children:n.jsx(Q,{icon:n.jsx(l,{}),block:!0,onClick:()=>f("/exhibitor/bookings?status=approved"),children:"Pending Payments"})}),n.jsx(_,{xs:24,sm:12,md:8,lg:6,children:n.jsx(Q,{icon:n.jsx(a,{}),block:!0,onClick:()=>f("/exhibitor/profile"),children:"Update Profile"})})]})})})})]})}},Symbol.toStringTag,{value:"Module"})),{Title:ue,Text:xe}=M,{Option:he}=K,{TabPane:pe}=q,{confirm:je}=ee,{Search:ge}=O,be=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[i,r]=e.useState([]),[a,p]=e.useState(!0),[j,g]=e.useState(null),[b,y]=e.useState(""),[v,f]=e.useState("all"),I=k(),w=S();e.useEffect((()=>{A()}),[]),e.useEffect((()=>{const e=new URLSearchParams(w.search).get("status");e&&f(e)}),[w]);const A=async()=>{try{p(!0),g(null);const e=await C.getExhibitorBookings();r(e.data||[])}catch(e){g("Failed to load bookings. Please try again.")}finally{p(!1)}},P=e=>{switch(e){case"approved":return n.jsxs(U,{color:"success",children:[n.jsx(t,{})," Approved"]});case"pending":return n.jsxs(U,{color:"warning",children:[n.jsx(s,{})," Pending"]});case"rejected":return n.jsxs(U,{color:"error",children:[n.jsx(d,{})," Rejected"]});case"confirmed":return n.jsxs(U,{color:"blue",children:[n.jsx(t,{})," Confirmed"]});case"cancelled":return n.jsxs(U,{color:"default",children:[n.jsx(d,{})," Cancelled"]});default:return n.jsx(U,{children:"Unknown"})}},T=[{title:"Exhibition",dataIndex:["exhibitionId","name"],key:"exhibitionName",render:(e,i)=>{var t,s;return n.jsxs(L,{direction:"vertical",size:0,children:[n.jsx(xe,{strong:!0,children:(null==(t=i.exhibitionId)?void 0:t.name)||"N/A"}),n.jsx(xe,{type:"secondary",style:{fontSize:"12px"},children:(null==(s=i.exhibitionId)?void 0:s.venue)||"N/A"})]})},sorter:(e,n)=>{var i,t;return((null==(i=e.exhibitionId)?void 0:i.name)||"").localeCompare((null==(t=n.exhibitionId)?void 0:t.name)||"")}},{title:"Stall(s)",dataIndex:"stallIds",key:"stallNumbers",render:e=>n.jsx(L,{direction:"vertical",size:4,children:(null==e?void 0:e.map((e=>n.jsx(U,{children:e.number},e._id))))||"N/A"})},{title:"Type",key:"stallType",render:(e,i)=>{var t;return n.jsx(L,{direction:"vertical",size:4,children:(null==(t=i.stallIds)?void 0:t.map((e=>{var i;return(null==(i=e.stallTypeId)?void 0:i.name)?n.jsx(U,{color:"blue",children:e.stallTypeId.name},e._id):n.jsx(xe,{type:"secondary",children:"N/A"},e._id)})))||"N/A"})}},{title:"Dimensions",key:"dimensions",render:(e,i)=>{var t;return n.jsx(L,{direction:"vertical",size:4,children:(null==(t=i.stallIds)?void 0:t.map((e=>n.jsxs(xe,{children:[e.dimensions.width,"m x ",e.dimensions.height,"m"]},e._id))))||"N/A"})}},{title:"Dates",key:"dates",render:(e,i)=>{var t,s;return n.jsxs(L,{direction:"vertical",size:0,children:[n.jsxs(xe,{children:[n.jsx(m,{style:{marginRight:4}}),N(null==(t=i.exhibitionId)?void 0:t.startDate).format("MMM D")," - ",N(null==(s=i.exhibitionId)?void 0:s.endDate).format("MMM D, YYYY")]}),n.jsxs(xe,{type:"secondary",style:{fontSize:"12px"},children:["Booked: ",N(i.createdAt).format("MMM D, YYYY")]})]})},sorter:(e,n)=>N(e.createdAt).unix()-N(n.createdAt).unix()},{title:"Amount",dataIndex:"amount",key:"amount",render:e=>n.jsxs(xe,{strong:!0,children:["₹",e.toLocaleString()]}),sorter:(e,n)=>e.amount-n.amount},{title:"Status",key:"status",dataIndex:"status",render:(e,i)=>"rejected"===e&&i.rejectionReason?n.jsxs(V,{title:i.rejectionReason,children:[P(e),n.jsx(u,{style:{marginLeft:4,color:"#ff4d4f"}})]}):P(e),filters:[{text:"Approved",value:"approved"},{text:"Pending",value:"pending"},{text:"Rejected",value:"rejected"},{text:"Confirmed",value:"confirmed"},{text:"Cancelled",value:"cancelled"}],onFilter:(e,n)=>n.status===e},{title:"Payment",key:"paymentStatus",dataIndex:"paymentStatus",render:e=>(e=>{switch(e){case"paid":return n.jsxs(U,{color:"success",children:[n.jsx(l,{})," Paid"]});case"pending":return n.jsxs(U,{color:"warning",children:[n.jsx(s,{})," Pending"]});case"refunded":return n.jsxs(U,{color:"default",children:[n.jsx(l,{})," Refunded"]});default:return n.jsx(U,{children:"Unknown"})}})(e),filters:[{text:"Paid",value:"paid"},{text:"Pending",value:"pending"},{text:"Refunded",value:"refunded"}],onFilter:(e,n)=>n.paymentStatus===e},{title:"Actions",key:"actions",render:(e,i)=>n.jsxs(L,{children:[n.jsx(Q,{type:"link",icon:n.jsx(x,{}),onClick:()=>I(`/exhibitor/bookings/${i._id}`),children:"Details"}),("approved"===i.status||"confirmed"===i.status)&&n.jsx(Q,{type:"link",icon:n.jsx(o,{}),onClick:()=>(async e=>{try{I(`/exhibitor/invoice/${e}`)}catch(n){G.error("Failed to access invoice. Please try again.")}})(i._id),children:"Invoice"}),"pending"===i.status&&n.jsx(Q,{type:"link",danger:!0,onClick:()=>{return e=i._id,void je({title:"Are you sure you want to cancel this booking?",icon:n.jsx(h,{}),content:"This action cannot be undone. Once cancelled, the stalls will be available for others to book.",okText:"Yes, Cancel Booking",okType:"danger",cancelText:"No, Keep Booking",onOk:async()=>{try{await C.cancelExhibitorBooking(e),G.success("Booking cancelled successfully"),A()}catch(n){G.error("Failed to cancel booking")}}});var e},children:"Cancel"})]})}],M=i.filter((e=>{var n,i;const t=((null==(n=e.exhibitionId)?void 0:n.name)||"").toLowerCase().includes(b.toLowerCase())||e.stallIds.some((e=>e.number.toLowerCase().includes(b.toLowerCase())))||((null==(i=e.exhibitionId)?void 0:i.venue)||"").toLowerCase().includes(b.toLowerCase())||(e.customerName||"").toLowerCase().includes(b.toLowerCase()),s="all"===v||e.status===v;return t&&s}));return n.jsxs("div",{children:[n.jsx(ue,{level:2,children:"My Bookings"}),n.jsx(xe,{type:"secondary",children:"Manage all your exhibition stall bookings in one place"}),j&&n.jsx(D,{message:"Error",description:j,type:"error",showIcon:!0,style:{marginTop:24,marginBottom:24},action:n.jsx(Q,{type:"primary",onClick:A,children:"Retry"})}),n.jsxs(E,{style:{marginTop:24},children:[n.jsxs(B,{gutter:[16,16],style:{marginBottom:16},children:[n.jsx(_,{flex:"auto",children:n.jsx(ge,{placeholder:"Search bookings by exhibition name, stall number, or venue",onSearch:e=>{y(e)},onChange:e=>y(e.target.value),style:{width:"100%",maxWidth:400},allowClear:!0})}),n.jsx(_,{children:n.jsx(Q,{icon:n.jsx(c,{}),onClick:A,children:"Refresh"})})]}),n.jsxs(q,{defaultActiveKey:v,onChange:e=>f(e),children:[n.jsx(pe,{tab:`All Bookings (${i.length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):M.length>0?n.jsx(X,{columns:T,dataSource:M,rowKey:"_id",pagination:{pageSize:10},scroll:{x:!0},size:"middle"}):n.jsx($,{description:b?"No bookings match your search criteria":"No bookings found",image:$.PRESENTED_IMAGE_SIMPLE})},"all"),n.jsx(pe,{tab:`Pending (${i.filter((e=>"pending"===e.status)).length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):n.jsx(X,{columns:T,dataSource:i.filter((e=>"pending"===e.status)),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx($,{description:"No pending bookings"})},scroll:{x:!0},size:"middle"})},"pending"),n.jsx(pe,{tab:`Approved (${i.filter((e=>"approved"===e.status)).length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):n.jsx(X,{columns:T,dataSource:i.filter((e=>"approved"===e.status)),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx($,{description:"No approved bookings"})},scroll:{x:!0},size:"middle"})},"approved"),n.jsx(pe,{tab:`Confirmed (${i.filter((e=>"confirmed"===e.status)).length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):n.jsx(X,{columns:T,dataSource:i.filter((e=>"confirmed"===e.status)),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx($,{description:"No confirmed bookings"})},scroll:{x:!0},size:"middle"})},"confirmed"),n.jsx(pe,{tab:`Rejected (${i.filter((e=>"rejected"===e.status)).length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):n.jsx(X,{columns:T,dataSource:i.filter((e=>"rejected"===e.status)),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx($,{description:"No rejected bookings"})},scroll:{x:!0},size:"middle"})},"rejected"),n.jsx(pe,{tab:`Cancelled (${i.filter((e=>"cancelled"===e.status)).length})`,children:a?n.jsx(Y,{active:!0,paragraph:{rows:5}}):n.jsx(X,{columns:T,dataSource:i.filter((e=>"cancelled"===e.status)),rowKey:"_id",pagination:{pageSize:10},locale:{emptyText:n.jsx($,{description:"No cancelled bookings"})},scroll:{x:!0},size:"middle"})},"cancelled")]})]})]})}},Symbol.toStringTag,{value:"Module"})),{Title:ye,Text:ve}=M,fe=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i,o,l,a,d,c,m,u,x,h,j,g,b;const{id:y}=A(),v=k(),[f,I]=e.useState(null),[w,S]=e.useState(!0);e.useEffect((()=>{P()}),[y]);const P=async()=>{try{S(!0);const e=await C.getExhibitorBooking(y||"");I(e.data)}catch(e){G.error("Failed to load booking details")}finally{S(!1)}},T=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Dimensions",key:"dimensions",render:e=>`${e.dimensions.width}m × ${e.dimensions.height}m`},{title:"Size",key:"size",render:e=>e.dimensions.width*e.dimensions.height+" m²"},{title:"Rate per m²",dataIndex:"ratePerSqm",key:"ratePerSqm",render:e=>`₹${e.toLocaleString()}`},{title:"Amount",key:"amount",render:(e,n,i)=>{var t;const s=null==(t=f.calculations)?void 0:t.stalls[i];return s?`₹${s.baseAmount.toLocaleString()}`:"N/A"}}];return w?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:n.jsx(W,{size:"large"})}):f?n.jsxs("div",{style:{padding:"20px"},children:[n.jsxs("div",{style:{marginBottom:16},children:[n.jsx(Q,{icon:n.jsx(p,{}),onClick:()=>v("/exhibitor/bookings"),style:{marginRight:16},children:"Back to Bookings"}),["approved","confirmed"].includes(f.status)&&n.jsx(Q,{type:"primary",icon:n.jsx(r,{}),onClick:async()=>{try{v(`/exhibitor/invoice/${y}`)}catch(e){G.error("Failed to retrieve invoice")}},children:"View Invoice"})]}),n.jsxs(E,{title:"Booking Details",style:{marginBottom:20},children:[n.jsxs(Z,{bordered:!0,column:{xs:1,sm:2,md:3},children:[n.jsx(Z.Item,{label:"Booking ID",children:f._id}),n.jsx(Z.Item,{label:"Exhibition",children:(null==(i=f.exhibitionId)?void 0:i.name)||"N/A"}),n.jsx(Z.Item,{label:"Venue",children:(null==(o=f.exhibitionId)?void 0:o.venue)||"N/A"}),n.jsx(Z.Item,{label:"Booking Date",children:N(f.createdAt).format("MMM D, YYYY")}),n.jsxs(Z.Item,{label:"Exhibition Dates",children:[N(null==(l=f.exhibitionId)?void 0:l.startDate).format("MMM D, YYYY")," -",N(null==(a=f.exhibitionId)?void 0:a.endDate).format("MMM D, YYYY")]}),n.jsx(Z.Item,{label:"Status",children:(e=>{switch(e){case"approved":return n.jsxs(U,{color:"success",children:[n.jsx(t,{})," Approved"]});case"pending":return n.jsxs(U,{color:"warning",children:[n.jsx(s,{})," Pending"]});case"rejected":return n.jsx(U,{color:"error",children:"Rejected"});case"confirmed":return n.jsxs(U,{color:"blue",children:[n.jsx(t,{})," Confirmed"]});case"cancelled":return n.jsx(U,{color:"default",children:"Cancelled"});default:return n.jsx(U,{children:"Unknown"})}})(f.status)}),n.jsx(Z.Item,{label:"Payment Status",children:(e=>{switch(e){case"paid":return n.jsx(U,{color:"success",children:"Paid"});case"pending":return n.jsx(U,{color:"warning",children:"Pending"});case"refunded":return n.jsx(U,{color:"default",children:"Refunded"});default:return n.jsx(U,{children:"Unknown"})}})(f.paymentStatus||"pending")}),n.jsxs(Z.Item,{label:"Total Amount",children:["₹",(null==(d=f.amount)?void 0:d.toLocaleString())||"N/A"]})]}),f.rejectionReason&&n.jsxs("div",{style:{marginTop:16},children:[n.jsx(ye,{level:5,style:{color:"#f5222d"},children:"Rejection Reason:"}),n.jsx(ve,{children:f.rejectionReason})]})]}),n.jsx(E,{title:"Stall Details",style:{marginBottom:20},children:n.jsx(X,{dataSource:f.stallIds||[],columns:T,rowKey:"_id",pagination:!1})}),n.jsx(E,{title:"Calculation Summary",children:n.jsx(B,{gutter:[16,16],children:n.jsx(_,{span:24,children:n.jsxs(Z,{bordered:!0,column:1,children:[n.jsxs(Z.Item,{label:"Base Amount",children:["₹",(null==(c=f.calculations)?void 0:c.totalBaseAmount.toLocaleString())||"N/A"]}),(null==(m=f.calculations)?void 0:m.totalDiscountAmount)>0&&n.jsxs(Z.Item,{label:"Discount",children:["- ₹",(null==(u=f.calculations)?void 0:u.totalDiscountAmount.toLocaleString())||"N/A"]}),(null==(x=f.calculations)?void 0:x.totalDiscountAmount)>0&&n.jsxs(Z.Item,{label:"Amount After Discount",children:["₹",(null==(h=f.calculations)?void 0:h.totalAmountAfterDiscount.toLocaleString())||"N/A"]}),null==(g=null==(j=f.calculations)?void 0:j.taxes)?void 0:g.map((e=>n.jsxs(Z.Item,{label:`${e.name} (${e.rate}%)`,children:["+ ₹",e.amount.toLocaleString()||"N/A"]},e.name))),n.jsx(Z.Item,{label:"Total Amount",children:n.jsxs(ve,{strong:!0,style:{fontSize:"16px"},children:["₹",(null==(b=f.amount)?void 0:b.toLocaleString())||"N/A"]})})]})})})}),n.jsx(E,{title:"Customer Information",style:{marginTop:20},children:n.jsxs(Z,{bordered:!0,column:{xs:1,sm:2},children:[n.jsx(Z.Item,{label:"Company Name",children:f.companyName}),n.jsx(Z.Item,{label:"Contact Person",children:f.customerName}),n.jsx(Z.Item,{label:"Email",children:f.customerEmail}),n.jsx(Z.Item,{label:"Phone",children:f.customerPhone})]})})]}):n.jsx(E,{children:n.jsxs("div",{style:{textAlign:"center",margin:"50px 0"},children:[n.jsx(ye,{level:3,children:"Booking Not Found"}),n.jsx(ve,{type:"secondary",children:"The requested booking could not be found or you don't have permission to view it."}),n.jsx("div",{style:{marginTop:20},children:n.jsx(Q,{type:"primary",onClick:()=>v("/exhibitor/bookings"),children:"Back to Bookings"})})]})})}},Symbol.toStringTag,{value:"Module"})),{Title:Ie,Text:ke}=M,{TabPane:we}=q,Se=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i;const[t]=re.useForm(),[s,o]=e.useState(!1),[r,l]=e.useState(!1),d=P(),c=I((e=>e.exhibitorAuth.exhibitor));e.useEffect((()=>{(async()=>{try{l(!0);const e=await T.getProfile();e.data&&d(ne({exhibitor:e.data,token:(null==c?void 0:c.token)||localStorage.getItem("exhibitor_token")||""}))}catch(e){G.error("Failed to fetch exhibitor profile")}finally{l(!1)}})()}),[d]),e.useEffect((()=>{c&&t.setFieldsValue({companyName:c.companyName||"",contactPerson:c.contactPerson||"",email:c.email||"",phone:c.phone||"",address:c.address||"",website:c.website||"",description:c.description||"",panNumber:c.panNumber||"",gstNumber:c.gstNumber||"",city:c.city||"",state:c.state||"",pinCode:c.pinCode||""})}),[c,t]);return n.jsxs("div",{children:[n.jsx(Ie,{level:2,children:"My Profile"}),n.jsx(ke,{type:"secondary",children:"Manage your exhibitor profile information"}),n.jsx(E,{style:{marginTop:24},loading:r,children:n.jsxs(q,{defaultActiveKey:"profile",children:[n.jsx(we,{tab:"Profile Information",children:n.jsxs(B,{gutter:32,children:[n.jsx(_,{span:6,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[n.jsx(H,{size:100,icon:n.jsx(a,{}),style:{backgroundColor:"#1890ff",marginBottom:16},children:(null==(i=null==c?void 0:c.companyName)?void 0:i.charAt(0).toUpperCase())||"E"}),n.jsx(Ie,{level:4,children:null==c?void 0:c.companyName}),n.jsx(ke,{type:"secondary",children:null==c?void 0:c.email})]})}),n.jsx(_,{span:18,children:n.jsxs(re,{form:t,layout:"vertical",onFinish:async e=>{try{o(!0);await T.updateProfile(e);const n=(null==c?void 0:c.token)||localStorage.getItem("exhibitor_token")||"";d(ne({exhibitor:{...c,...e},token:n})),G.success("Profile updated successfully")}catch(n){G.error("Failed to update profile")}finally{o(!1)}},initialValues:{companyName:(null==c?void 0:c.companyName)||"",contactPerson:(null==c?void 0:c.contactPerson)||"",email:(null==c?void 0:c.email)||"",phone:(null==c?void 0:c.phone)||"",address:(null==c?void 0:c.address)||"",website:(null==c?void 0:c.website)||"",description:(null==c?void 0:c.description)||"",panNumber:(null==c?void 0:c.panNumber)||"",gstNumber:(null==c?void 0:c.gstNumber)||"",city:(null==c?void 0:c.city)||"",state:(null==c?void 0:c.state)||"",pinCode:(null==c?void 0:c.pinCode)||""},children:[n.jsxs(B,{gutter:16,children:[n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter your company name"}],children:n.jsx(O,{prefix:n.jsx(j,{}),placeholder:"Company Name"})})}),n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person name"}],children:n.jsx(O,{prefix:n.jsx(a,{}),placeholder:"Contact Person"})})})]}),n.jsxs(B,{gutter:16,children:[n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:n.jsx(O,{prefix:n.jsx(g,{}),placeholder:"Email",disabled:!0})})}),n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter your phone number"}],children:n.jsx(O,{prefix:n.jsx(b,{}),placeholder:"Phone Number"})})})]}),n.jsx(re.Item,{name:"address",label:"Address",children:n.jsx(O.TextArea,{rows:2,placeholder:"Company Address"})}),n.jsxs(B,{gutter:16,children:[n.jsx(_,{span:8,children:n.jsx(re.Item,{name:"city",label:"City",children:n.jsx(O,{placeholder:"City"})})}),n.jsx(_,{span:8,children:n.jsx(re.Item,{name:"state",label:"State",children:n.jsx(O,{placeholder:"State"})})}),n.jsx(_,{span:8,children:n.jsx(re.Item,{name:"pinCode",label:"PIN Code",rules:[{pattern:/^[0-9]{6}$/,message:"Please enter a valid 6-digit PIN code"}],children:n.jsx(O,{placeholder:"PIN Code",maxLength:6})})})]}),n.jsxs(B,{gutter:16,children:[n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"panNumber",label:"PAN No.",rules:[{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN number"}],children:n.jsx(O,{placeholder:"PAN Number",style:{textTransform:"uppercase"},maxLength:10})})}),n.jsx(_,{span:12,children:n.jsx(re.Item,{name:"gstNumber",label:"GST No.",rules:[{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid GST number"}],children:n.jsx(O,{placeholder:"GST Number",style:{textTransform:"uppercase"}})})})]}),n.jsx(re.Item,{name:"website",label:"Website",children:n.jsx(O,{placeholder:"https://www.yourcompany.com"})}),n.jsx(re.Item,{name:"description",label:"Company Description",children:n.jsx(O.TextArea,{rows:4,placeholder:"Brief description of your company"})}),n.jsx(re.Item,{children:n.jsx(Q,{type:"primary",htmlType:"submit",loading:s,icon:n.jsx(y,{}),children:"Save Changes"})})]})})]})},"profile"),n.jsx(we,{tab:"Change Password",children:n.jsxs(re,{layout:"vertical",onFinish:e=>{G.success("Password updated successfully")},children:[n.jsx(re.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:n.jsx(O.Password,{placeholder:"Current Password"})}),n.jsx(re.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter your new password"},{min:6,message:"Password must be at least 6 characters"}],children:n.jsx(O.Password,{placeholder:"New Password"})}),n.jsx(re.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:e})=>({validator:(n,i)=>i&&e("newPassword")!==i?Promise.reject(new Error("The two passwords do not match")):Promise.resolve()})],children:n.jsx(O.Password,{placeholder:"Confirm New Password"})}),n.jsx(re.Item,{children:n.jsx(Q,{type:"primary",htmlType:"submit",children:"Update Password"})})]})},"password")]})})]})}},Symbol.toStringTag,{value:"Module"})),{Title:Ae,Text:Pe}=M,Ne=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i,t,s,o,r,l,a,d,c,m,u,x,h,p,j,b,y,I,k;const{id:w}=A(),{data:S,isLoading:P,error:N}=ie(w||""),[C]=te(),[T]=se(),[M]=oe(),[D,z]=e.useState(!1),[Y,F]=e.useState(!1),[$]=re.useForm(),[U]=re.useForm(),[q,V]=e.useState(0),[K,Z]=e.useState(!1);return P?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:n.jsx(W,{size:"large"})}):N||!S?n.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[n.jsx(Ae,{level:3,children:"Invoice Not Found"}),n.jsx(Pe,{children:"The requested invoice could not be loaded. Please try again later."})]}):n.jsxs(n.Fragment,{children:[n.jsxs(E,{title:"Invoice Details",style:{margin:"20px"},children:[n.jsx(B,{gutter:[16,24],children:n.jsx(_,{span:24,children:n.jsxs(L,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(L,{children:[n.jsx(Q,{icon:n.jsx(v,{}),onClick:async()=>{if(w)try{Z(!0),V(0),G.loading({content:"Preparing invoice...",key:"download"});const n=(()=>{let e=0;const n=setInterval((()=>{e+=5,e<=90?(V(e),e%25==0&&G.loading({content:`Downloading: ${e}% complete`,key:"download"})):clearInterval(n)}),200);return n})();try{const e=await C(w).unwrap();clearInterval(n),V(100),G.loading({content:"Finalizing download...",key:"download"});const i=URL.createObjectURL(e),t=document.createElement("a");t.href=i,t.download=`Invoice-${(null==S?void 0:S.invoiceNumber)||w||"download"}.pdf`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(i),G.success({content:"Invoice downloaded successfully",key:"download"})}catch(e){throw clearInterval(n),e}}catch(e){G.error({content:"Failed to download invoice",key:"download"})}finally{Z(!1),setTimeout((()=>V(0)),500)}},loading:K&&q<100,disabled:K&&q>=100,children:"Download PDF"}),n.jsx(Q,{icon:n.jsx(g,{}),onClick:()=>{z(!0)},disabled:K,children:"Share via Email"}),n.jsx(Q,{icon:n.jsx(f,{}),onClick:()=>{F(!0)},disabled:K,children:"Share via WhatsApp"})]}),K&&n.jsx(J,{percent:q,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})})}),n.jsx(R,{}),n.jsx(le,{booking:{...S.bookingId,customerGSTIN:(null==(i=S.bookingId)?void 0:i.customerGSTIN)||""===(null==(t=S.bookingId)?void 0:t.customerGSTIN)?S.bookingId.customerGSTIN:"N/A",customerAddress:(null==(s=S.bookingId)?void 0:s.customerAddress)||""===(null==(o=S.bookingId)?void 0:o.customerAddress)?S.bookingId.customerAddress:"N/A",invoiceNumber:S.invoiceNumber,exhibitionId:{...S.bookingId.exhibitionId,companyName:(null==(r=S.bookingId.exhibitionId)?void 0:r.companyName)||"",bankName:(null==(l=S.bookingId.exhibitionId)?void 0:l.bankName)||"",bankAccount:(null==(a=S.bookingId.exhibitionId)?void 0:a.bankAccount)||"",bankAccountName:(null==(d=S.bookingId.exhibitionId)?void 0:d.bankAccountName)||"",bankBranch:(null==(c=S.bookingId.exhibitionId)?void 0:c.bankBranch)||"",bankIFSC:(null==(m=S.bookingId.exhibitionId)?void 0:m.bankIFSC)||"",companyCIN:(null==(u=S.bookingId.exhibitionId)?void 0:u.companyCIN)||"",companyPAN:(null==(x=S.bookingId.exhibitionId)?void 0:x.companyPAN)||"",companySAC:(null==(h=S.bookingId.exhibitionId)?void 0:h.companySAC)||"",companyGST:(null==(p=S.bookingId.exhibitionId)?void 0:p.companyGST)||"",companyEmail:(null==(j=S.bookingId.exhibitionId)?void 0:j.companyEmail)||"",companyWebsite:(null==(b=S.bookingId.exhibitionId)?void 0:b.companyWebsite)||"",companyAddress:(null==(y=S.bookingId.exhibitionId)?void 0:y.companyAddress)||""},calculations:{...S.bookingId.calculations,stalls:(null==(k=null==(I=S.bookingId.calculations)?void 0:I.stalls)?void 0:k.map((e=>({...e,discount:e.discount?{...e.discount,type:e.discount.type||"percentage",value:e.discount.value}:void 0}))))||[]}}})]}),n.jsx(ee,{title:"Share Invoice via Email",visible:D,onCancel:()=>z(!1),footer:null,children:n.jsxs(re,{form:$,layout:"vertical",onFinish:async e=>{try{await T({bookingId:w||"",email:e.email,message:e.message}).unwrap(),G.success(`Invoice sent to ${e.email}`),z(!1),$.resetFields()}catch(n){G.error("Failed to send email")}},children:[n.jsx(re.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:n.jsx(O,{placeholder:"example@example.com"})}),n.jsx(re.Item,{name:"message",label:"Message",initialValue:`Please find attached the invoice for your booking with invoice number ${S.invoiceNumber}.`,children:n.jsx(O.TextArea,{rows:4})}),n.jsx(re.Item,{children:n.jsx(Q,{type:"primary",htmlType:"submit",children:"Send"})})]})}),n.jsx(ee,{title:"Share Invoice via WhatsApp",visible:Y,onCancel:()=>F(!1),footer:null,children:n.jsxs(re,{form:U,layout:"vertical",onFinish:async e=>{try{await M({bookingId:w||"",phoneNumber:e.phoneNumber}).unwrap();const n=e.phoneNumber.replace(/\D/g,""),i=encodeURIComponent(e.message);window.open(`https://wa.me/${n}?text=${i}`,"_blank"),F(!1),U.resetFields()}catch(n){G.error("Failed to open WhatsApp")}},children:[n.jsx(re.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter a phone number"}],children:n.jsx(O,{placeholder:"+1234567890"})}),n.jsx(re.Item,{name:"message",label:"Message",initialValue:`Please find the invoice for your booking with invoice number ${S.invoiceNumber}.`,children:n.jsx(O.TextArea,{rows:4})}),n.jsx(re.Item,{children:n.jsx(Q,{type:"primary",htmlType:"submit",children:"Open WhatsApp"})})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{be as B,me as D,Ne as I,Se as P,fe as a};
