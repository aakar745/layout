import{j as e}from"./vendor-pdf-Cn0rG44s.js";import{a4 as M,r,F as i,y as N,z as j,S as d,T as V,t as m,h as p,af as P,G as _,a7 as q,K as L,Z as b,f as S}from"./vendor-antd-B8jUXf3i.js";import{D as u}from"./index-4IR4xblb.js";import{u as O}from"./vendor-react-DW9h-haf.js";import"./vendor-redux-rS0pI56E.js";import"./vendor-http-t--hEgTQ.js";import"./vendor-antd-icons-BoTJB7uA.js";import"./vendor-ui-BmMA_ojr.js";import"./vendor-canvas-DrFPvyt4.js";const{Title:R,Text:z}=V,{TextArea:B}=m,{Search:K}=m,{Option:T}=b,Y=()=>{O();const{message:n}=M.useApp(),[o,c]=r.useState(!1),[l]=i.useForm(),[F,f]=r.useState(!1),[v,I]=r.useState([]),[w,g]=r.useState(!1),[a,y]=r.useState(null);r.useEffect(()=>{h()},[]),r.useEffect(()=>{var t;if(console.log("Modal visibility changed:",o),console.log("Editing stall type:",a),o&&a){const s=((t=a.features)==null?void 0:t.map(x=>x.feature).join(", "))||"";console.log("Setting form values:",{name:a.name,description:a.description,features:s,status:a.status}),setTimeout(()=>{l.setFieldsValue({name:a.name,description:a.description,features:s,status:a.status})},0)}else o&&(l.resetFields(),l.setFieldsValue({status:"active"}))},[a,l,o]);const h=async()=>{try{g(!0);const t=await u.getStallTypes();I(t.data)}catch(t){n.error("Failed to fetch stall types: "+t.message)}finally{g(!1)}},C=async t=>{try{f(!0),console.log("Form values:",t);const s={name:t.name,description:t.description,status:t.status,features:t.features?t.features.split(",").map(x=>({feature:x.trim()})):[]};console.log("Submitting data:",s),a?(await u.updateStallType(a._id,s),n.success("Stall type updated successfully")):(await u.createStallType(s),n.success("Stall type created successfully")),c(!1),y(null),l.resetFields(),h()}catch(s){n.error(`Failed to ${a?"update":"create"} stall type: `+s.message)}finally{f(!1)}},E=t=>{console.log("Editing stall type:",t),y(t),c(!0)},k=async t=>{try{await u.deleteStallType(t._id),n.success("Stall type deleted successfully"),h()}catch(s){n.error("Failed to delete stall type: "+s.message)}},A=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(t,s)=>t.name.localeCompare(s.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:t=>e.jsx(d,{wrap:!0,children:t==null?void 0:t.map(({feature:s})=>e.jsx(S,{children:s},s))})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(S,{color:t==="active"?"success":"default",children:t.toUpperCase()})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(d,{children:[e.jsx(p,{type:"link",onClick:()=>E(s),children:"Edit"}),e.jsx(p,{type:"link",danger:!0,onClick:()=>k(s),children:"Delete"})]})}],D=()=>{c(!1),y(null),l.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(N,{justify:"space-between",align:"middle",children:[e.jsx(j,{children:e.jsxs(d,{direction:"vertical",size:4,children:[e.jsx(R,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(z,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(j,{children:e.jsxs(d,{children:[e.jsx(K,{placeholder:"Search stall types",style:{width:200},onSearch:t=>console.log(t)}),e.jsx(p,{type:"primary",icon:e.jsx(P,{}),onClick:()=>c(!0),children:"Add Stall Type"})]})})]})}),e.jsx(_,{className:"info-card",children:e.jsx(q,{columns:A,dataSource:v,rowKey:t=>t._id,loading:w})}),e.jsx(L,{title:a?"Edit Stall Type":"Add Stall Type",open:o,onCancel:D,footer:null,destroyOnClose:!1,children:e.jsxs(i,{form:l,layout:"vertical",onFinish:C,initialValues:{status:"active"},preserve:!0,children:[e.jsx(i.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(m,{placeholder:"e.g., 1 Side Open"})}),e.jsx(i.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(B,{rows:4,placeholder:"Enter description"})}),e.jsx(i.Item,{name:"features",label:"Features",children:e.jsx(m,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(i.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(b,{children:[e.jsx(T,{value:"active",children:"Active"}),e.jsx(T,{value:"inactive",children:"Inactive"})]})}),e.jsx(i.Item,{children:e.jsxs(p,{type:"primary",htmlType:"submit",loading:F,block:!0,children:[a?"Update":"Create"," Stall Type"]})})]})})]})};export{Y as default};
