import{a1 as A,j as e,e as T}from"./index-0Suq5uxL.js";import{j as be,i as we,r as l}from"./vendor-react-BNeW3y6d.js";/* empty css                  */import{H as h,a6 as y,a7 as n,S as m,T as Se,c,i as Ce,a5 as p,aI as N,f as H,h as J,x as Q,m as X,I as f,a1 as ne,a$ as Ie,aj as Ae,W as E,B as Ee,D as ke,b6 as L,N as Z,an as Re,a4 as De,U as g,aW as ee,b as k,a as te,aO as Pe,p as Te,b1 as Ne,M as V,aU as Le,R as $e}from"./vendor-antd--VDS8NUg.js";import"./vendor-utils-CtctGR1F.js";import"./vendor-styling-CU6mz1ss.js";import"./vendor-canvas-BRbMLhVA.js";const{Title:Fe,Text:r,Paragraph:Be}=Se,{Option:$}=ne,{TextArea:se,Search:ze}=f,{RangePicker:Me}=Ie,He=()=>{const w=be(),{exhibitors:o,loading:ie}=we(t=>t.exhibitor),[i,F]=l.useState(null),[re,R]=l.useState(!1),[B,I]=l.useState(!1),[ae,z]=l.useState(!1),[j,W]=l.useState("approved"),[M,_]=l.useState(""),[le,q]=l.useState(!1),[oe,Y]=l.useState(!1),[Ue,D]=l.useState(!1),[Oe,de]=l.useState(""),[K,v]=l.useState([]),[U]=h.useForm(),[b,G]=l.useState([]);b.length>0;const[P,ce]=l.useState({total:0,pending:0,approved:0,rejected:0});l.useEffect(()=>{w(A())},[w]),l.useEffect(()=>{if(o!=null&&o.length){v(o);const t={total:o.length,pending:o.filter(s=>s.status==="pending").length,approved:o.filter(s=>s.status==="approved").length,rejected:o.filter(s=>s.status==="rejected").length};ce(t)}},[o]),l.useEffect(()=>{i&&B&&U.setFieldsValue({companyName:i.companyName,contactPerson:i.contactPerson,email:i.email,phone:i.phone,address:i.address||"",website:i.website||"",description:i.description||"",isActive:i.isActive})},[i,B,U]);const O=t=>{switch(t){case"approved":return e.jsx(k,{color:"success",children:"Approved"});case"pending":return e.jsx(k,{color:"warning",children:"Pending"});case"rejected":return e.jsx(k,{color:"error",children:"Rejected"});default:return e.jsx(k,{children:"Unknown"})}},he=async()=>{var t,s;if(i)try{q(!0),await T.updateStatus(i._id,j,j==="rejected"?M:void 0),g.success(`Exhibitor status updated to ${j}`),R(!1),w(A())}catch(a){g.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to update exhibitor status")}finally{q(!1)}},xe=async t=>{var s,a;if(i)try{Y(!0),await T.updateExhibitor(i._id,t),g.success("Exhibitor details updated successfully"),I(!1),w(A())}catch(d){g.error(((a=(s=d.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to update exhibitor details")}finally{Y(!1)}},pe=async t=>{var s,a;try{D(!0),await T.deleteExhibitor(t),g.success("Exhibitor deleted successfully"),w(A())}catch(d){g.error(((a=(s=d.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete exhibitor")}finally{D(!1)}},je=t=>{if(de(t),!t){v(o);return}const s=t.toLowerCase(),a=o.filter(d=>d.companyName.toLowerCase().includes(s)||d.contactPerson.toLowerCase().includes(s)||d.email.toLowerCase().includes(s)||d.phone.toLowerCase().includes(s));v(a)},ue=t=>{if(t==="all"){v(o);return}const s=o.filter(a=>a.status===t);v(s)},me=t=>{if(!t||t.length!==2){v(o);return}const s=t[0].startOf("day").toISOString(),a=t[1].endOf("day").toISOString(),d=o.filter(S=>{const u=new Date(S.createdAt).toISOString();return u>=s&&u<=a});v(d)},ge=()=>{const t=["Company Name","Contact Person","Email","Phone","Status","Active","Registration Date","Address","Website"],s=K.map(x=>[x.companyName,x.contactPerson,x.email,x.phone,x.status,x.isActive?"Yes":"No",new Date(x.createdAt).toLocaleDateString(),x.address||"",x.website||""]);s.unshift(t);const a=s.map(x=>x.map(C=>typeof C=="string"&&(C.includes(",")||C.includes('"')||C.includes(`
`))?`"${C.replace(/"/g,'""')}"`:C).join(",")).join(`
`),d=new Blob([a],{type:"text/csv;charset=utf-8;"}),S=URL.createObjectURL(d),u=document.createElement("a");u.setAttribute("href",S),u.setAttribute("download",`exhibitors-${new Date().toISOString().split("T")[0]}.csv`),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),g.success("Exhibitor data exported successfully")},ye=()=>{E.confirm({title:"Delete Selected Exhibitors",content:`Are you sure you want to delete ${b.length} exhibitors? This action cannot be undone.`,okText:"Yes",okType:"danger",cancelText:"No",onOk:async()=>{try{D(!0);const t=b.map(s=>T.deleteExhibitor(s.toString()));await Promise.all(t),g.success(`${b.length} exhibitors deleted successfully`),G([]),w(A())}catch{g.error("Failed to delete some exhibitors")}finally{D(!1)}}})},fe={selectedRowKeys:b,onChange:t=>{G(t)}},ve=[{title:"Company",dataIndex:"companyName",key:"companyName",width:220,fixed:"left",sorter:(t,s)=>t.companyName.localeCompare(s.companyName),filterDropdown:({setSelectedKeys:t,selectedKeys:s,confirm:a,clearFilters:d})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(f,{placeholder:"Search company or contact",value:s[0],onChange:S=>t(S.target.value?[S.target.value]:[]),onPressEnter:()=>a(),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(m,{children:[e.jsx(c,{type:"primary",onClick:()=>a(),icon:e.jsx(ee,{}),size:"small",style:{width:90},children:"Filter"}),e.jsx(c,{onClick:()=>{d&&d(),a()},size:"small",style:{width:90},children:"Reset"})]})]}),filterIcon:t=>e.jsx(ee,{style:{color:t?"#1890ff":void 0}}),onFilter:(t,s)=>{const a=String(t).toLowerCase();return s.companyName.toLowerCase().includes(a)||s.contactPerson.toLowerCase().includes(a)},render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:t}),e.jsxs("div",{style:{fontSize:"12px",color:"#888"},children:["Contact: ",s.contactPerson]})]})},{title:"Contact",dataIndex:"email",key:"email",width:220,render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{children:t}),e.jsx("div",{style:{fontSize:"12px"},children:s.phone})]})},{title:"Status",dataIndex:"status",key:"status",width:120,filters:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Rejected",value:"rejected"}],onFilter:(t,s)=>s.status===t,render:t=>O(t)},{title:"Active",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:(t,s)=>s.isActive===t,render:t=>e.jsx(k,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Registration Date",dataIndex:"createdAt",key:"createdAt",width:160,sorter:(t,s)=>new Date(t.createdAt).getTime()-new Date(s.createdAt).getTime(),render:t=>e.jsx(te,{title:new Date(t).toLocaleString(),children:new Date(t).toLocaleDateString()})},{title:"Address",dataIndex:"address",key:"address",width:200,ellipsis:!0},{title:"Website",dataIndex:"website",key:"website",width:180,render:t=>t?e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:t.replace(/^https?:\/\/(www\.)?/i,"")}):"-"},{title:"Actions",key:"actions",fixed:"right",width:220,render:(t,s)=>e.jsxs(m,{children:[e.jsx(te,{title:"View Details",children:e.jsx(c,{icon:e.jsx(Pe,{}),onClick:()=>{F(s),z(!0)}})}),e.jsx(c,{type:"primary",onClick:()=>{F(s),W(s.status),_(s.rejectionReason||""),R(!0)},children:"Update Status"}),e.jsx(Te,{overlay:e.jsxs(V,{children:[e.jsx(V.Item,{icon:e.jsx(Le,{}),onClick:()=>{F(s),I(!0)},children:"Edit"},"edit"),e.jsx(V.Item,{icon:e.jsx($e,{}),danger:!0,onClick:a=>{a.domEvent.stopPropagation(),E.confirm({title:"Delete Exhibitor",content:"Are you sure you want to delete this exhibitor? This action cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>pe(s._id)})},children:"Delete"},"delete")]}),trigger:["click"],children:e.jsx(c,{icon:e.jsx(Ne,{})})})]})}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(y,{gutter:[24,24],align:"middle",children:[e.jsx(n,{flex:"auto",children:e.jsxs(m,{direction:"vertical",size:4,children:[e.jsx(Fe,{level:4,style:{margin:0},children:"Exhibitors"}),e.jsx(r,{type:"secondary",children:"Manage exhibitors and their information"})]})}),e.jsx(n,{children:e.jsx(c,{type:"primary",icon:e.jsx(Ce,{}),onClick:()=>I(!0),size:"large",children:"Add Exhibitor"})})]})}),e.jsxs(y,{gutter:[16,24],style:{marginBottom:"24px"},children:[e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(N,{title:"Total Exhibitors",value:P.total,prefix:e.jsx(H,{})})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(N,{title:"Pending",value:P.pending,prefix:e.jsx(J,{style:{color:"#faad14"}})})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(N,{title:"Approved",value:P.approved,prefix:e.jsx(Q,{style:{color:"#52c41a"}})})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(N,{title:"Rejected",value:P.rejected,prefix:e.jsx(X,{style:{color:"#ff4d4f"}})})})})]}),e.jsx(p,{className:"info-card",style:{marginBottom:"24px"},children:e.jsxs(m,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(y,{gutter:[16,16],align:"middle",children:[e.jsx(n,{xs:24,sm:8,md:6,lg:4,children:e.jsx(ze,{placeholder:"Search exhibitors",allowClear:!0,onSearch:je,style:{width:"100%"}})}),e.jsx(n,{xs:24,sm:8,md:6,lg:4,children:e.jsxs(ne,{placeholder:"Filter by status",style:{width:"100%"},onChange:ue,allowClear:!0,children:[e.jsx($,{value:"all",children:"All Status"}),e.jsx($,{value:"pending",children:"Pending"}),e.jsx($,{value:"approved",children:"Approved"}),e.jsx($,{value:"rejected",children:"Rejected"})]})}),e.jsx(n,{xs:24,sm:8,md:6,lg:6,children:e.jsx(Me,{style:{width:"100%"},onChange:me})})]}),b.length>0&&e.jsx(y,{children:e.jsxs(m,{children:[e.jsxs(r,{children:["Selected ",b.length," items"]}),e.jsx(c,{danger:!0,onClick:ye,children:"Delete Selected"}),e.jsx(c,{type:"primary",onClick:ge,children:"Export Selected"})]})})]})}),e.jsx(p,{className:"info-card",children:e.jsx(Ae,{rowSelection:fe,dataSource:K,columns:ve,rowKey:"_id",loading:ie,pagination:{pageSize:10,showSizeChanger:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} items`},scroll:{x:1500}})}),e.jsx(E,{title:"Exhibitor Details",open:ae,onCancel:()=>z(!1),footer:[e.jsx(c,{onClick:()=>z(!1),children:"Close"},"close")],width:600,children:i&&e.jsx("div",{children:e.jsxs(y,{gutter:[16,16],children:[e.jsx(n,{span:24,children:e.jsx(p,{title:"Company Information",children:e.jsxs(y,{gutter:[16,8],children:[e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Company Name:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.companyName})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Contact Person:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.contactPerson})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Email:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.email})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Phone:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.phone})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Address:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.address||"Not provided"})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Status:"})}),e.jsx(n,{span:12,children:O(i.status)}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Active:"})}),e.jsx(n,{span:12,children:e.jsx(Ee,{status:i.isActive?"success":"error",text:i.isActive?"Yes":"No"})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Registration Date:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:new Date(i.createdAt).toLocaleString()})})]})})}),e.jsx(n,{span:24,children:e.jsxs(p,{title:"Additional Information",children:[e.jsxs(y,{gutter:[16,8],children:[e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Address:"})}),e.jsx(n,{span:12,children:e.jsx(r,{children:i.address||"Not provided"})}),e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Website:"})}),e.jsx(n,{span:12,children:i.website?e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",children:i.website}):"Not provided"}),i.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{span:12,children:e.jsx(r,{strong:!0,children:"Rejection Reason:"})}),e.jsx(n,{span:12,children:e.jsx(r,{type:"danger",children:i.rejectionReason||"No reason provided"})})]})]}),i.description&&e.jsxs(e.Fragment,{children:[e.jsx(ke,{}),e.jsx(r,{strong:!0,children:"Description:"}),e.jsx(Be,{style:{marginTop:8},children:i.description})]})]})})]})})}),e.jsx(E,{title:"Update Exhibitor Status",open:re,onCancel:()=>R(!1),footer:null,width:600,children:i&&e.jsxs("div",{children:[e.jsx(p,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(H,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Exhibitor Information"})]}),style:{marginBottom:16},bordered:!1,size:"small",children:e.jsxs(y,{gutter:[16,8],children:[e.jsx(n,{span:8,children:e.jsx(r,{strong:!0,children:"Company:"})}),e.jsx(n,{span:16,children:e.jsx(r,{children:i.companyName})}),e.jsx(n,{span:8,children:e.jsx(r,{strong:!0,children:"Contact Person:"})}),e.jsx(n,{span:16,children:e.jsx(r,{children:i.contactPerson})}),e.jsx(n,{span:8,children:e.jsx(r,{strong:!0,children:"Email:"})}),e.jsx(n,{span:16,children:e.jsx(r,{children:i.email})}),e.jsx(n,{span:8,children:e.jsx(r,{strong:!0,children:"Address:"})}),e.jsx(n,{span:16,children:e.jsx(r,{children:i.address||"Not provided"})}),e.jsx(n,{span:8,children:e.jsx(r,{strong:!0,children:"Current Status:"})}),e.jsx(n,{span:16,children:O(i.status)})]})}),e.jsxs(p,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Re,{style:{fontSize:"18px"}}),e.jsx("span",{children:"Update Status"})]}),bordered:!1,size:"small",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx(r,{strong:!0,children:"Select New Status:"}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(L.Group,{value:j,onChange:t=>W(t.target.value),buttonStyle:"solid",children:[e.jsx(L.Button,{value:"pending",children:e.jsxs(m,{children:[e.jsx(J,{style:{color:"#faad14"}}),"Pending"]})}),e.jsx(L.Button,{value:"approved",children:e.jsxs(m,{children:[e.jsx(Q,{style:{color:"#52c41a"}}),"Approved"]})}),e.jsx(L.Button,{value:"rejected",children:e.jsxs(m,{children:[e.jsx(X,{style:{color:"#f5222d"}}),"Rejected"]})})]})})]}),j==="rejected"&&e.jsx("div",{children:e.jsx(h.Item,{label:e.jsx(r,{strong:!0,children:"Rejection Reason:"}),required:j==="rejected",rules:[{required:!0,message:"Please provide a reason for rejection"}],help:"This will be visible to the exhibitor",children:e.jsx(se,{rows:4,value:M,onChange:t=>_(t.target.value),placeholder:"Provide a reason for rejection",style:{marginTop:8}})})}),j==="approved"&&e.jsx(Z,{message:"Approval Confirmation",description:"By approving this exhibitor, they will be able to log in and manage their exhibition space.",type:"success",showIcon:!0,style:{marginTop:8}}),j==="pending"&&e.jsx(Z,{message:"Return to Pending",description:"This exhibitor will be moved back to pending status and will not be able to log in.",type:"warning",showIcon:!0,style:{marginTop:8}})]}),e.jsxs("div",{style:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx(c,{onClick:()=>R(!1),children:"Cancel"}),e.jsx(c,{type:"primary",onClick:he,loading:le,disabled:j==="rejected"&&!M.trim(),children:"Update Status"})]})]})]})}),e.jsx(E,{title:"Edit Exhibitor Details",open:B,onCancel:()=>I(!1),footer:null,width:600,children:e.jsxs(h,{form:U,layout:"vertical",onFinish:xe,children:[e.jsx(h.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:e.jsx(f,{})}),e.jsx(h.Item,{name:"contactPerson",label:"Contact Person",rules:[{required:!0,message:"Please enter contact person"}],children:e.jsx(f,{})}),e.jsx(h.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(f,{})}),e.jsx(h.Item,{name:"phone",label:"Phone",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(f,{})}),e.jsx(h.Item,{name:"address",label:"Address",children:e.jsx(f,{})}),e.jsx(h.Item,{name:"website",label:"Website",children:e.jsx(f,{})}),e.jsx(h.Item,{name:"description",label:"Description",children:e.jsx(se,{rows:4})}),e.jsx(h.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:e.jsx(De,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),e.jsx(h.Item,{children:e.jsxs(m,{children:[e.jsx(c,{type:"primary",htmlType:"submit",loading:oe,children:"Save Changes"}),e.jsx(c,{onClick:()=>I(!1),children:"Cancel"})]})})]})})]})};export{He as default};
