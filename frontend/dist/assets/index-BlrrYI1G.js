import{E as d,j as e}from"./index-aoH9EzMk.js";import{u as N,aO as V,r as i,Z as r,a9 as D,aa as j,S as p,T as O,Y as y,i as u,by as P,ab as _,aS as q,ag as L,aF as b,h as S}from"./vendor-Be5M1UDi.js";import"./apis-CU9I9MMq.js";import"./canvas-C-A9eff5.js";const{Title:R,Text:B}=O,{TextArea:U}=y,{Search:z}=y,{Option:T}=b,G=()=>{N();const{message:n}=V.useApp(),[c,o]=i.useState(!1),[l]=r.useForm(),[F,f]=i.useState(!1),[v,E]=i.useState([]),[I,g]=i.useState(!1),[a,m]=i.useState(null);i.useEffect(()=>{h()},[]),i.useEffect(()=>{var t;if(console.log("Modal visibility changed:",c),console.log("Editing stall type:",a),c&&a){const s=((t=a.features)==null?void 0:t.map(x=>x.feature).join(", "))||"";console.log("Setting form values:",{name:a.name,description:a.description,features:s,status:a.status}),setTimeout(()=>{l.setFieldsValue({name:a.name,description:a.description,features:s,status:a.status})},0)}else c&&(l.resetFields(),l.setFieldsValue({status:"active"}))},[a,l,c]);const h=async()=>{try{g(!0);const t=await d.getStallTypes();E(t.data)}catch(t){n.error("Failed to fetch stall types: "+t.message)}finally{g(!1)}},w=async t=>{try{f(!0),console.log("Form values:",t);const s={name:t.name,description:t.description,status:t.status,features:t.features?t.features.split(",").map(x=>({feature:x.trim()})):[]};console.log("Submitting data:",s),a?(await d.updateStallType(a._id,s),n.success("Stall type updated successfully")):(await d.createStallType(s),n.success("Stall type created successfully")),o(!1),m(null),l.resetFields(),h()}catch(s){n.error(`Failed to ${a?"update":"create"} stall type: `+s.message)}finally{f(!1)}},C=t=>{console.log("Editing stall type:",t),m(t),o(!0)},k=async t=>{try{await d.deleteStallType(t._id),n.success("Stall type deleted successfully"),h()}catch(s){n.error("Failed to delete stall type: "+s.message)}},A=[{title:"Type Name",dataIndex:"name",key:"name",sorter:(t,s)=>t.name.localeCompare(s.name)},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Features",dataIndex:"features",key:"features",render:t=>e.jsx(p,{wrap:!0,children:t==null?void 0:t.map(({feature:s})=>e.jsx(S,{children:s},s))})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(S,{color:t==="active"?"success":"default",children:t.toUpperCase()})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(p,{children:[e.jsx(u,{type:"link",onClick:()=>C(s),children:"Edit"}),e.jsx(u,{type:"link",danger:!0,onClick:()=>k(s),children:"Delete"})]})}],M=()=>{o(!1),m(null),l.resetFields()};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(D,{justify:"space-between",align:"middle",children:[e.jsx(j,{children:e.jsxs(p,{direction:"vertical",size:4,children:[e.jsx(R,{level:4,style:{margin:0},children:"Stall Types"}),e.jsx(B,{type:"secondary",children:"Manage your stall types and configurations"})]})}),e.jsx(j,{children:e.jsxs(p,{children:[e.jsx(z,{placeholder:"Search stall types",style:{width:200},onSearch:t=>console.log(t)}),e.jsx(u,{type:"primary",icon:e.jsx(P,{}),onClick:()=>o(!0),children:"Add Stall Type"})]})})]})}),e.jsx(_,{className:"info-card",children:e.jsx(q,{columns:A,dataSource:v,rowKey:t=>t._id,loading:I})}),e.jsx(L,{title:a?"Edit Stall Type":"Add Stall Type",open:c,onCancel:M,footer:null,destroyOnClose:!1,children:e.jsxs(r,{form:l,layout:"vertical",onFinish:w,initialValues:{status:"active"},preserve:!0,children:[e.jsx(r.Item,{name:"name",label:"Type Name",rules:[{required:!0,message:"Please enter stall type name"}],children:e.jsx(y,{placeholder:"e.g., 1 Side Open"})}),e.jsx(r.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:e.jsx(U,{rows:4,placeholder:"Enter description"})}),e.jsx(r.Item,{name:"features",label:"Features",children:e.jsx(y,{placeholder:"Enter features (comma-separated)",allowClear:!0})}),e.jsx(r.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(b,{children:[e.jsx(T,{value:"active",children:"Active"}),e.jsx(T,{value:"inactive",children:"Inactive"})]})}),e.jsx(r.Item,{children:e.jsxs(u,{type:"primary",htmlType:"submit",loading:F,block:!0,children:[a?"Update":"Create"," Stall Type"]})})]})})]})};export{G as default};
