import{r as e,j as t,g as i,a7 as n,A as s,F as a,ab as o,T as l,q as r,Z as d,_ as c,a8 as x,k as h,V as p,i as u,D as m,s as b,l as g,m as f,ac as y,d as j,ad as v,x as w,n as S,ae as C}from"./vendor-others-aeGeD6f-.js";import{c as k,u as I,a as E,b as D,d as A,N as _,e as T}from"./vendor-react-i7tvbPTl.js";import{f as z,o as M,p as B,k as R,q as N,r as L,t as P,v as F,w as H,x as W,y as Y}from"./store-D4NI4RZ9.js";import{c as O}from"./services-DHEt1Qtz.js";import{g as q,a as V,E as G,C as X,H as U,S as $,b as K,F as Z}from"./component-exhibition-CuwlJtEU.js";import{d as J}from"./vendor-utils-CTzFqUk0.js";import"./page-dashboard-984XnN9x.js";import{u as Q}from"./page-booking-B9D71fvQ.js";import{i as ee,R as te,C as ie,e as ne,T as se,c as ae,z as oe,I as le,f as re,d as de,G as ce,P as xe,k as he,v as pe,o as ue,s as me,H as be,D as ge,u as fe,g as ye}from"./vendor-antd-core-CLD06I8y.js";import{B as je}from"./vendor-antd-buttons-wjEWA2x8.js";import{F as ve}from"./vendor-antd-table-CA0XBoxE.js";import{M as we}from"./vendor-antd-modal-1GBGM2fb.js";import"./vendor-canvas-BOVIu3pe.js";import{E as Se}from"./component-common-BGb_0Ph7.js";import{F as Ce}from"./vendor-antd-form-DJHhvp8w.js";const{Title:ke,Text:Ie}=se,{RangePicker:Ee}=de,De=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{message:u,modal:m}=ee.useApp(),b=k(),g=I(),{exhibitions:f,loading:y}=E((e=>e.exhibition)),[j,v]=e.useState([]),[w,S]=e.useState(!1),[C,D]=e.useState(!1),[A,_]=e.useState({status:[],dateRange:null,search:"",activeStatus:null}),[T,B]=e.useState("all"),{hasPermission:R}=Q();e.useEffect((()=>{g(z())}),[g]);const N=e.useMemo((()=>({total:f.length,active:f.filter((e=>"published"===e.status)).length,upcoming:f.filter((e=>new Date(e.startDate)>new Date)).length,completed:f.filter((e=>"completed"===e.status)).length,activeCount:f.filter((e=>e.isActive)).length})),[f]),L=async()=>{m.confirm({title:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[t.jsx(r,{style:{color:"#F04438",fontSize:"22px"}}),t.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Selected Exhibitions"})]}),content:t.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[t.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",t.jsxs("strong",{children:[j.length," selected exhibitions"]}),"?"]}),t.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data for these exhibitions."})]}),footer:t.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[t.jsx(je,{onClick:()=>we.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),t.jsx(je,{danger:!0,type:"primary",onClick:async()=>{try{S(!0),await Promise.all(j.map((e=>g(M(e._id||e.id)).unwrap()))),u.success(`Successfully deleted ${j.length} exhibitions`),v([])}catch(e){u.error(e.message||"Failed to delete some exhibitions")}finally{S(!1),we.destroyAll()}},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete All"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},P=async(e,t)=>{try{D(!0);const i=e._id||e.id;await O.updateExhibition(i,{status:t});const n=f.map((e=>(e._id||e.id)===i?{...e,status:t}:e));g(z.fulfilled(n,"",void 0)),u.success("Status updated successfully")}catch(i){u.error("Failed to update status"),g(z())}finally{D(!1)}},F=(e,t)=>{const i=e._id||e.id;b("/layout"===t?q(e,"layout"):q(e)+t,{state:{exhibitionId:i}})},H=e=>{const t=new Date,i=new Date(e.startDate),n=new Date(e.endDate);if(t<i)return 0;if(t>n)return 100;const s=n.getTime()-i.getTime(),a=t.getTime()-i.getTime();return Math.round(a/s*100)},W=e=>{m.confirm({title:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#101828",padding:"20px 24px",borderBottom:"1px solid #EAECF0"},children:[t.jsx(r,{style:{color:"#F04438",fontSize:"22px"}}),t.jsx("span",{style:{fontSize:"18px",fontWeight:600,lineHeight:"28px"},children:"Delete Exhibition"})]}),content:t.jsxs("div",{style:{padding:"20px 24px",color:"#475467"},children:[t.jsxs("p",{style:{fontSize:"14px",lineHeight:"20px",marginBottom:"8px"},children:["Are you sure you want to delete ",t.jsx("strong",{children:e.name}),"?"]}),t.jsx("p",{style:{color:"#667085",fontSize:"14px",lineHeight:"20px",marginBottom:0},children:"This action cannot be undone and will permanently delete all associated data."})]}),footer:t.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 24px",borderTop:"1px solid #EAECF0",marginTop:0},children:[t.jsx(je,{onClick:()=>we.destroyAll(),style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"1px solid #D0D5DD",color:"#344054",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Cancel"}),t.jsx(je,{danger:!0,type:"primary",onClick:()=>{(async e=>{const t=e._id||e.id;try{S(!0),await g(M(t)).unwrap(),u.success("Exhibition deleted successfully")}catch(i){u.error(i.message||"Failed to delete exhibition")}finally{S(!1)}})(e),we.destroyAll()},style:{height:"40px",padding:"10px 18px",borderRadius:"8px",border:"none",backgroundColor:"#D92D20",color:"white",fontWeight:500,fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)"},children:"Delete"})]}),centered:!0,icon:null,width:400,closable:!0,maskClosable:!0,className:"delete-confirmation-modal",styles:{mask:{backgroundColor:"rgba(52, 64, 84, 0.7)"},content:{padding:0,borderRadius:"12px",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.05), 0px 12px 16px -4px rgba(16, 24, 40, 0.1)"},body:{padding:0},footer:{display:"none"}}})},Y=e=>[{key:"view",label:"View Details",icon:t.jsx(d,{}),onClick:()=>F(e,"")},{key:"edit",label:"Edit Exhibition",icon:t.jsx(c,{}),onClick:()=>F(e,"/edit")},{key:"layout",label:"Manage Layout",icon:t.jsx(h,{}),onClick:()=>F(e,"/layout")},{type:"divider"},..."published"===e.status?[{key:"public-view",label:"Public View",icon:t.jsx(d,{}),onClick:()=>window.open(V(e),"_blank")},{type:"divider"}]:[],{key:"status",label:"Change Status",icon:t.jsx(p,{}),children:[{key:"draft",label:t.jsxs(ne,{children:[t.jsx(ue,{color:"#faad14",style:{margin:0},children:"Draft"}),t.jsx("span",{children:"Set as Draft"})]}),icon:t.jsx(n,{}),onClick:()=>P(e,"draft"),disabled:"draft"===e.status||C},{key:"published",label:t.jsxs(ne,{children:[t.jsx(ue,{color:"#52c41a",style:{margin:0},children:"Published"}),t.jsx("span",{children:"Publish"})]}),icon:t.jsx(s,{}),onClick:()=>P(e,"published"),disabled:"published"===e.status||C},{key:"completed",label:t.jsxs(ne,{children:[t.jsx(ue,{color:"#1890ff",style:{margin:0},children:"Completed"}),t.jsx("span",{children:"Mark as Completed"})]}),icon:t.jsx(a,{}),onClick:()=>P(e,"completed"),disabled:"completed"===e.status||C}]},{key:"active-status",label:t.jsxs(ne,{children:[e.isActive?t.jsx(ue,{color:"red",style:{margin:0},children:"Deactivate"}):t.jsx(ue,{color:"#52c41a",style:{margin:0},children:"Activate"}),t.jsx("span",{children:e.isActive?"Deactivate":"Activate"})]}),icon:t.jsx(o,{}),onClick:()=>(async(e,t)=>{try{D(!0);const i=e._id||e.id;await O.updateExhibition(i,{isActive:t});const n=f.map((e=>(e._id||e.id)===i?{...e,isActive:t}:e));g(z.fulfilled(n,"",void 0)),u.success(`Exhibition ${t?"activated":"deactivated"} successfully`)}catch(i){u.error("Failed to update active status"),g(z())}finally{D(!1)}})(e,!e.isActive),disabled:C},{type:"divider"},{key:"delete",label:"Delete",icon:t.jsx(r,{}),danger:!0,onClick:()=>W(e)}],G=e.useMemo((()=>f.filter((e=>{if(A.search&&!e.name.toLowerCase().includes(A.search.toLowerCase()))return!1;if(A.status.length>0&&!A.status.includes(e.status))return!1;if(null!==A.activeStatus&&e.isActive!==A.activeStatus)return!1;if(A.dateRange){const[t,i]=A.dateRange,n=new Date(e.startDate),s=new Date(e.endDate);if(n<new Date(t)||s>new Date(i))return!1}switch(T){case"active":return"published"===e.status;case"upcoming":return new Date(e.startDate)>new Date;case"completed":return"completed"===e.status;default:return!0}}))),[f,A,T]),X=[{title:"Exhibition Details",key:"details",render:(e,i)=>t.jsx(Ie,{strong:!0,style:{fontSize:"16px",cursor:"pointer"},onClick:()=>F(i,""),children:i.name})},{title:"Status",key:"status",width:180,align:"center",render:(e,i)=>((e,i)=>{const n=(e=>{switch(e.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}})(e);return t.jsxs(ne,{size:4,style:{display:"inline-flex",alignItems:"center"},children:[t.jsx(ue,{color:n,style:{textTransform:"capitalize",minWidth:"80px",textAlign:"center",margin:0},children:e}),!i&&t.jsx(ue,{color:"red",style:{margin:0},children:"Inactive"})]})})(i.status,i.isActive),filters:[{text:"Draft",value:"draft"},{text:"Published",value:"published"},{text:"Completed",value:"completed"}],onFilter:(e,t)=>t.status===e},{title:"Start Date",key:"startDate",width:130,render:(e,i)=>t.jsx(Ie,{children:J(i.startDate).format("MMM D, YYYY")})},{title:"End Date",key:"endDate",width:130,render:(e,i)=>t.jsx(Ie,{children:J(i.endDate).format("MMM D, YYYY")})},{title:"Create Date",key:"createdAt",width:130,render:(e,i)=>t.jsx(Ie,{children:J(i.createdAt).format("MMM D, YYYY")})},{title:"Progress",key:"progress",width:200,render:(e,i)=>t.jsx(xe,{percent:H(i),size:"small",status:"completed"===i.status?"success":"active"})},{title:"Actions",key:"actions",width:150,fixed:"right",render:(e,i)=>t.jsxs(ne,{size:"middle",children:[R("exhibitions_view")&&t.jsx(he,{title:"View Details",children:t.jsx(je,{type:"text",icon:t.jsx(d,{}),onClick:()=>F(i,"")})}),R("exhibitions_edit")&&t.jsx(he,{title:"Edit Exhibition",children:t.jsx(je,{type:"text",icon:t.jsx(c,{}),onClick:()=>F(i,"/edit")})}),R("exhibitions_delete")&&t.jsx(pe,{menu:{items:Y(i)},trigger:["click"],placement:"bottomRight",children:t.jsx(je,{type:"text",icon:t.jsx(x,{})})})]})}];return t.jsxs("div",{className:"dashboard-container",children:[t.jsx("div",{style:{marginBottom:"24px"},children:t.jsxs(te,{gutter:[24,24],align:"middle",children:[t.jsx(ie,{flex:"auto",children:t.jsxs(ne,{direction:"vertical",size:4,children:[t.jsx(ke,{level:4,style:{margin:0},children:"Exhibitions"}),t.jsx(Ie,{type:"secondary",children:"Manage your exhibition spaces and layouts"})]})}),t.jsx(ie,{children:t.jsx(je,{type:"primary",icon:t.jsx(i,{}),onClick:()=>b("/exhibition/create"),size:"large",children:"Create Exhibition"})})]})}),t.jsxs(te,{gutter:[24,24],style:{marginBottom:"24px"},children:[t.jsx(ie,{xs:24,sm:12,md:6,lg:4,children:t.jsx(ae,{children:t.jsx(oe,{title:"Total Exhibitions",value:N.total,prefix:t.jsx(n,{})})})}),t.jsx(ie,{xs:24,sm:12,md:6,lg:5,children:t.jsx(ae,{children:t.jsx(oe,{title:"Published Exhibitions",value:N.active,prefix:t.jsx(s,{style:{color:"#52c41a"}})})})}),t.jsx(ie,{xs:24,sm:12,md:6,lg:5,children:t.jsx(ae,{children:t.jsx(oe,{title:"Upcoming Exhibitions",value:N.upcoming,prefix:t.jsx(a,{style:{color:"#1890ff"}})})})}),t.jsx(ie,{xs:24,sm:12,md:6,lg:5,children:t.jsx(ae,{children:t.jsx(oe,{title:"Completed Exhibitions",value:N.completed,prefix:t.jsx(s,{style:{color:"#8c8c8c"}})})})}),t.jsx(ie,{xs:24,sm:12,md:6,lg:5,children:t.jsx(ae,{children:t.jsx(oe,{title:"Active Status",value:N.activeCount,prefix:t.jsx(o,{style:{color:"#52c41a"}})})})})]}),t.jsx(ae,{className:"info-card",style:{marginBottom:"16px"},styles:{body:{padding:"20px"}},children:t.jsxs(ne,{direction:"vertical",size:"middle",style:{width:"100%"},children:[t.jsxs(te,{gutter:[16,16],align:"middle",children:[t.jsx(ie,{flex:"auto",children:t.jsxs(ne,{size:"middle",wrap:!0,children:[t.jsx(le,{placeholder:"Search exhibitions",prefix:t.jsx(l,{style:{color:"#8c8c8c"}}),style:{width:"250px"},value:A.search,onChange:e=>_((t=>({...t,search:e.target.value}))),allowClear:!0}),t.jsx(re,{mode:"multiple",placeholder:"Filter by status",style:{minWidth:"200px"},value:A.status,onChange:e=>_((t=>({...t,status:e}))),options:[{label:"Draft",value:"draft"},{label:"Published",value:"published"},{label:"Completed",value:"completed"}]}),t.jsxs(re,{placeholder:"Active Status",style:{width:"150px"},value:A.activeStatus,onChange:e=>_((t=>({...t,activeStatus:e}))),allowClear:!0,children:[t.jsx(re.Option,{value:!0,children:"Active"}),t.jsx(re.Option,{value:!1,children:"Inactive"})]}),t.jsx(Ee,{onChange:e=>_((t=>{var i,n;return{...t,dateRange:e?[(null==(i=e[0])?void 0:i.toISOString())||"",(null==(n=e[1])?void 0:n.toISOString())||""]:null}}))})]})}),t.jsx(ie,{children:t.jsx(ce,{options:[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Upcoming",value:"upcoming"},{label:"Completed",value:"completed"}],value:T,onChange:e=>B(e)})})]}),j.length>0&&t.jsx(te,{children:t.jsxs(ne,{children:[t.jsxs(Ie,{children:["Selected ",j.length," items"]}),t.jsx(je,{danger:!0,onClick:L,children:"Delete Selected"})]})})]})}),t.jsx(ae,{className:"info-card",styles:{body:{padding:0}},children:t.jsx(ve,{columns:X,dataSource:G.map((e=>({...e,key:e._id||e.id}))),rowKey:e=>e._id||e.id,loading:y||w||C,rowSelection:{selectedRowKeys:j.map((e=>e._id||e.id)),onChange:(e,t)=>v(t),selections:[ve.SELECTION_ALL,ve.SELECTION_NONE]},footer:()=>j.length>0&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[t.jsxs(Ie,{children:["Selected ",t.jsx("strong",{children:j.length})," ",1===j.length?"exhibition":"exhibitions"]}),t.jsx(je,{danger:!0,onClick:L,icon:t.jsx(r,{}),loading:w,children:"Delete Selected"})]}),scroll:{x:1500},pagination:{pageSize:10,showSizeChanger:!0,showTotal:e=>`Total ${e} items`,style:{marginTop:"16px"}}})})]})}},Symbol.toStringTag,{value:"Module"})),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const e=k(),i=I();return t.jsx(ae,{title:"Create New Exhibition",children:t.jsx(G,{onSubmit:async t=>{var n,s;try{const[a,o]=t.dateRange,l={name:t.name,description:t.description,venue:t.venue,startDate:a.toISOString(),endDate:o.toISOString(),status:t.status||"draft",isActive:t.isActive??!0,invoicePrefix:t.invoicePrefix,stallRates:t.stallRates||[],dimensions:{width:100,height:100},taxConfig:t.taxConfig||[],discountConfig:t.discountConfig||[],publicDiscountConfig:t.publicDiscountConfig||[],companyName:t.companyName,companyContactNo:t.companyContactNo,companyEmail:t.companyEmail,companyAddress:t.companyAddress,companyWebsite:t.companyWebsite,companyPAN:t.companyPAN,companyGST:t.companyGST,companySAC:t.companySAC,companyCIN:t.companyCIN,termsAndConditions:t.termsAndConditions,piInstructions:t.piInstructions,bankName:t.bankName,bankBranch:t.bankBranch,bankIFSC:t.bankIFSC,bankAccountName:t.bankAccountName,bankAccount:t.bankAccount,headerTitle:t.headerTitle,headerSubtitle:t.headerSubtitle,headerDescription:t.headerDescription,headerLogo:t.headerLogo,sponsorLogos:t.sponsorLogos||[],footerText:t.footerText,footerLogo:t.footerLogo,contactEmail:t.contactEmail,contactPhone:t.contactPhone,footerLinks:t.footerLinks||[],amenities:(null==(n=t.amenities)?void 0:n.map((e=>({type:e.type,name:e.name,description:e.description,rate:e.rate}))))||[],basicAmenities:(null==(s=t.basicAmenities)?void 0:s.map((e=>({type:e.type,name:e.name,description:e.description,perSqm:e.perSqm,quantity:e.quantity}))))||[],specialRequirements:t.specialRequirements},r=await i(B(l)).unwrap();me.success("Exhibition created successfully");const d=r._id||r.id;d?e(q({_id:d,id:d,name:l.name}),{state:{exhibitionId:d}}):(me.error("Exhibition ID not found in response"),e("/exhibition"))}catch(a){me.error(a.message||"Failed to create exhibition")}},submitText:"Create Exhibition"})})}},Symbol.toStringTag,{value:"Module"})),{Title:_e,Text:Te,Paragraph:ze}=se,Me=()=>{const e=k();return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>e("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},Be=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:i}=D(),n=k(),o=I(),{currentExhibition:l,halls:r,stalls:x,loading:p}=E((e=>e.exhibition)),[v,w]=e.useState(0);e.useEffect((()=>{i&&(o(R(i)),o(N(i)),o(L({exhibitionId:i})))}),[i,o]),e.useEffect((()=>{l&&C()}),[l]);const S=()=>{if(!l)return{hallCount:0,stallCount:0,bookedStallCount:0,availableStallCount:0};const e=r.length||0;let t=x.length||0,i=x.filter((e=>"booked"===e.status||"reserved"===e.status)).length;return 0===t&&(l.stalls&&l.stalls.length>0?(t=l.stalls.length,i=l.stalls.filter((e=>"booked"===e.status||"reserved"===e.status)).length):(t=l.stallCount||0,i=l.bookedStallCount||0)),{hallCount:e,stallCount:t,bookedStallCount:i,availableStallCount:t-i}},C=()=>{if(!l)return 0;const e=new Date,t=new Date(l.startDate),i=new Date(l.endDate);if(e<t)return w(0);if(e>i)return w(100);const n=i.getTime()-t.getTime(),s=e.getTime()-t.getTime();w(Math.round(s/n*100))},A=e=>{switch(e.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},_=e=>{n(q(l,e))};if(p)return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(Me,{}),t.jsx(ae,{children:t.jsx(be,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!l)return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(Me,{}),t.jsx(ae,{children:t.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[t.jsx(u,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),t.jsx(_e,{level:4,children:"Exhibition not found"}),t.jsx(ze,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const T=(()=>{if(!l)return{text:"",count:0,isPast:!1};const e=new Date,t=new Date(l.startDate),i=new Date(l.endDate);if(e>i){return{text:"Ended",count:Math.ceil((e.getTime()-i.getTime())/864e5),isPast:!0}}if(e>=t&&e<=i){return{text:"Days Remaining",count:Math.ceil((i.getTime()-e.getTime())/864e5),isPast:!1}}return{text:"Days Until Start",count:Math.ceil((t.getTime()-e.getTime())/864e5),isPast:!1}})();return t.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[t.jsx(Me,{}),t.jsx(ae,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},bodyStyle:{padding:"0"},children:t.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:t.jsxs(te,{gutter:[24,24],align:"middle",children:[t.jsxs(ie,{xs:24,md:16,children:[t.jsx(_e,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:l.name}),t.jsx(ze,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:l.description}),t.jsxs(ne,{split:t.jsx(ge,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[t.jsxs(ne,{children:[t.jsx(m,{style:{color:"rgba(255,255,255,0.8)"}}),t.jsxs(Te,{style:{color:"rgba(255,255,255,0.8)"},children:[J(l.startDate).format("MMM D, YYYY")," - ",J(l.endDate).format("MMM D, YYYY")]})]}),l.venue&&t.jsxs(ne,{children:[t.jsx(b,{style:{color:"rgba(255,255,255,0.8)"}}),t.jsx(Te,{style:{color:"rgba(255,255,255,0.8)"},children:l.venue})]})]})]}),t.jsx(ie,{xs:24,md:8,children:t.jsxs(ae,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[t.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:A(l.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:l.status.toUpperCase()}),t.jsx(oe,{title:T.text,value:T.count,suffix:"days",valueStyle:{color:T.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:t.jsx(a,{})}),t.jsx(ge,{style:{margin:"16px 0"}}),t.jsx("div",{style:{marginBottom:"8px"},children:t.jsx(Te,{type:"secondary",children:"Exhibition Progress"})}),t.jsx(xe,{percent:v,status:100===v?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]})})]})})}),t.jsxs(te,{gutter:[16,16],style:{marginBottom:"24px"},children:[t.jsx(ie,{xs:24,sm:8,children:t.jsx(je,{type:"primary",icon:t.jsx(h,{}),onClick:()=>_(`${i}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),t.jsx(ie,{xs:24,sm:8,children:t.jsx(je,{icon:t.jsx(c,{}),onClick:()=>_(`${i}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),t.jsx(ie,{xs:24,sm:8,children:t.jsx(je,{icon:t.jsx(d,{}),onClick:()=>window.open(V(l),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:"published"!==l.status,children:"View Public Page"})})]}),t.jsxs(te,{gutter:[24,24],children:[t.jsx(ie,{xs:24,lg:16,children:t.jsxs(ae,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[t.jsxs(te,{gutter:[24,24],children:[t.jsxs(ie,{xs:24,sm:12,children:[t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),t.jsx(Te,{strong:!0,style:{fontSize:"16px"},children:J(l.startDate).format("MMMM D, YYYY")})]}),t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),t.jsx(Te,{strong:!0,style:{fontSize:"16px"},children:J(l.endDate).format("MMMM D, YYYY")})]}),t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),t.jsx(Te,{strong:!0,style:{fontSize:"16px"},children:J(l.createdAt).format("MMMM D, YYYY")})]})]}),t.jsxs(ie,{xs:24,sm:12,children:[t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),t.jsx(ue,{color:A(l.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:l.status.toUpperCase()})]}),t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),t.jsx(ue,{color:l.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:l.isActive?"ACTIVE":"INACTIVE"})]}),l.venue&&t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),t.jsx(Te,{strong:!0,style:{fontSize:"16px"},children:l.venue})]})]})]}),t.jsx(ge,{}),t.jsxs("div",{children:[t.jsx(Te,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),t.jsx(ze,{children:l.description||"No description provided."})]})]})}),t.jsxs(ie,{xs:24,lg:8,children:[t.jsx(ae,{title:"Exhibition Stats",style:{borderRadius:"12px",marginBottom:"24px"},children:t.jsxs(te,{gutter:[16,24],children:[t.jsx(ie,{span:12,children:t.jsx(oe,{title:"Halls",value:S().hallCount,prefix:t.jsx(g,{})})}),t.jsx(ie,{span:12,children:t.jsx(oe,{title:"Stalls",value:S().stallCount,prefix:t.jsx(f,{})})}),t.jsx(ie,{span:12,children:t.jsx(oe,{title:"Booked Stalls",value:S().bookedStallCount,prefix:t.jsx(s,{})})}),t.jsx(ie,{span:12,children:t.jsx(oe,{title:"Available Stalls",value:S().availableStallCount,prefix:t.jsx(y,{})})})]})}),t.jsx(ae,{title:"Created By",style:{borderRadius:"12px"},children:l.createdBy?t.jsxs(ne,{children:[t.jsx(fe,{icon:t.jsx(j,{})}),t.jsx(Te,{children:l.createdByName||"Administrator"})]}):t.jsx(Te,{type:"secondary",children:"Information not available"})})]})]})]})}},Symbol.toStringTag,{value:"Module"})),Re=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i;const{message:n}=ee.useApp(),{id:s}=D(),a=null==(i=A().state)?void 0:i.exhibitionId,o=k(),l=I(),{currentExhibition:r,loading:d,error:c}=E((e=>e.exhibition)),[x,h]=e.useState(!1);e.useEffect((()=>{(async()=>{if(!a)return n.error("Exhibition ID not found"),void o("/exhibition");try{await l(R(a)).unwrap()}catch(e){n.error(e.message||"Failed to fetch exhibition"),o("/exhibition")}finally{h(!0)}})()}),[a,l,n,o]),e.useEffect((()=>{c&&n.error(c)}),[c,n]);if(!x)return t.jsx(ae,{loading:!0});if(!a)return t.jsx(_,{to:"/exhibition",replace:!0});if(d||!r)return t.jsx(ae,{loading:!0});const p={name:r.name,description:r.description,venue:r.venue,dateRange:[J(r.startDate),J(r.endDate)],status:r.status,isActive:r.isActive,invoicePrefix:r.invoicePrefix,stallRates:r.stallRates||[],taxConfig:r.taxConfig||[],discountConfig:r.discountConfig||[],publicDiscountConfig:r.publicDiscountConfig||[],companyName:r.companyName,companyContactNo:r.companyContactNo,companyEmail:r.companyEmail,companyAddress:r.companyAddress,companyWebsite:r.companyWebsite,companyPAN:r.companyPAN,companyGST:r.companyGST,companySAC:r.companySAC,companyCIN:r.companyCIN,termsAndConditions:r.termsAndConditions,piInstructions:r.piInstructions,bankName:r.bankName,bankBranch:r.bankBranch,bankIFSC:r.bankIFSC,bankAccountName:r.bankAccountName,bankAccount:r.bankAccount,headerTitle:r.headerTitle,headerSubtitle:r.headerSubtitle,headerDescription:r.headerDescription,headerLogo:r.headerLogo,sponsorLogos:r.sponsorLogos||[],footerText:r.footerText,footerLogo:r.footerLogo,contactEmail:r.contactEmail,contactPhone:r.contactPhone,footerLinks:r.footerLinks||[],amenities:r.amenities||[],basicAmenities:r.basicAmenities||[],specialRequirements:r.specialRequirements};return t.jsx(ae,{title:"Edit Exhibition",extra:t.jsx("a",{onClick:()=>o(q(r),{state:{exhibitionId:a}}),children:"Back to Details"}),children:t.jsx(G,{initialValues:p,onSubmit:async e=>{var t,i;if(a&&r)try{const[s,d]=e.dateRange,c={name:e.name,description:e.description,venue:e.venue,startDate:s.toISOString(),endDate:d.toISOString(),status:e.status,isActive:e.isActive,invoicePrefix:e.invoicePrefix,stallRates:e.stallRates||[],dimensions:r.dimensions,taxConfig:e.taxConfig||[],discountConfig:e.discountConfig||[],publicDiscountConfig:e.publicDiscountConfig||[],companyName:e.companyName,companyContactNo:e.companyContactNo,companyEmail:e.companyEmail,companyAddress:e.companyAddress,companyWebsite:e.companyWebsite,companyPAN:e.companyPAN,companyGST:e.companyGST,companySAC:e.companySAC,companyCIN:e.companyCIN,termsAndConditions:e.termsAndConditions,piInstructions:e.piInstructions,bankName:e.bankName,bankBranch:e.bankBranch,bankIFSC:e.bankIFSC,bankAccountName:e.bankAccountName,bankAccount:e.bankAccount,headerTitle:e.headerTitle,headerSubtitle:e.headerSubtitle,headerDescription:e.headerDescription,headerLogo:e.headerLogo,sponsorLogos:e.sponsorLogos||[],footerText:e.footerText,footerLogo:e.footerLogo,contactEmail:e.contactEmail,contactPhone:e.contactPhone,footerLinks:e.footerLinks||[],amenities:(null==(t=e.amenities)?void 0:t.map((e=>({type:e.type,name:e.name,description:e.description,rate:e.rate}))))||[],basicAmenities:(null==(i=e.basicAmenities)?void 0:i.map((e=>({type:e.type,name:e.name,description:e.description,perSqm:e.perSqm,quantity:e.quantity}))))||[],specialRequirements:e.specialRequirements};await l(P({id:a,data:c})).unwrap(),n.success("Exhibition updated successfully"),o(q(r),{state:{exhibitionId:a}})}catch(s){n.error(s.message||"Failed to update exhibition")}},submitText:"Update Exhibition"})})}},Symbol.toStringTag,{value:"Module"})),Ne=({exhibitionId:e,destination:i="layout",label:n="Back to Layout"})=>{const s=k(),{currentExhibition:a}=E((e=>e.exhibition));return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>s(q(a,i),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:n})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},Le=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i;const{id:n}=D(),s=A(),a=k(),o=I(),l=(null==(i=s.state)?void 0:i.exhibitionId)||n,{currentExhibition:r}=E((e=>e.exhibition)),d=e.useRef(null),[c,x]=e.useState({width:100,height:100}),[h,p]=e.useState({width:0,height:0}),[u]=Ce.useForm();e.useEffect((()=>{if(!l)return me.error("Exhibition ID not found"),void a("/exhibition");o(R(l))}),[l,o,a]),e.useEffect((()=>{(null==r?void 0:r.dimensions)&&(x(r.dimensions),u.setFieldsValue(r.dimensions))}),[r,u]),e.useEffect((()=>{const e=()=>{d.current&&p({width:d.current.clientWidth,height:d.current.clientHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const m=e=>{x((t=>({...t,...e}))),u.setFieldsValue(e)};return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(Ne,{exhibitionId:l}),t.jsx(ae,{title:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"Exhibition Space Setup"}),t.jsx(je,{type:"primary",icon:t.jsx(w,{}),onClick:async()=>{try{const e=await u.validateFields();await O.updateExhibition(l,{dimensions:e}),me.success("Exhibition space saved successfully"),await o(R(l)).unwrap(),a(q(r,"layout"),{state:{exhibitionId:l}})}catch(e){me.error("Failed to save exhibition space")}},children:"Save and Continue"})]}),children:t.jsxs("div",{style:{display:"flex",gap:"24px",height:"calc(100vh - 200px)"},children:[t.jsx("div",{style:{flex:"0 0 300px"},children:t.jsxs(Ce,{form:u,layout:"vertical",initialValues:c,children:[t.jsx(Ce.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:t.jsx(ye,{min:10,max:1e3,style:{width:"100%"},onChange:e=>m({width:e||10})})}),t.jsx(Ce.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:t.jsx(ye,{min:10,max:1e3,style:{width:"100%"},onChange:e=>m({height:e||10})})})]})}),t.jsx("div",{ref:d,style:{flex:"1",border:"1px solid #d9d9d9",borderRadius:"8px",position:"relative",overflow:"hidden"},children:t.jsx(Se,{children:t.jsx(X,{width:h.width,height:h.height,exhibitionWidth:c.width,exhibitionHeight:c.height,onExhibitionChange:m})})})]})})]})}},Symbol.toStringTag,{value:"Module"})),Pe=({exhibitionId:e})=>{const i=k(),{currentExhibition:n}=E((e=>e.exhibition));return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>i(q(n),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:"Back to Exhibition"})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},Fe=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var i,n,s,a,o;const{id:l}=D(),r=A(),d=k(),c=I(),x=(null==(i=r.state)?void 0:i.exhibitionId)||l,{currentExhibition:p,halls:u}=E((e=>e.exhibition));return e.useEffect((()=>{x&&(c(R(x)),c(N(x)))}),[x,c]),t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(Pe,{exhibitionId:x}),t.jsxs(te,{gutter:[24,24],children:[t.jsx(ie,{xs:24,sm:12,md:8,children:t.jsxs(ae,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[t.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:t.jsx(h,{style:{fontSize:"48px",color:"#1890ff"}})}),t.jsx(ae.Meta,{title:"Exhibition Space",description:"Set up and manage the exhibition space dimensions",style:{marginBottom:"16px"}}),t.jsx(je,{type:"primary",onClick:()=>d(q(p,"space"),{state:{exhibitionId:x}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),t.jsx(ie,{xs:24,sm:12,md:8,children:t.jsxs(ae,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[t.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:t.jsx(g,{style:{fontSize:"48px",color:"#1890ff"}})}),t.jsx(ae.Meta,{title:"Hall Management",description:"Create and manage exhibition halls",style:{marginBottom:"16px"}}),t.jsx(je,{type:"primary",disabled:!(null==(n=null==p?void 0:p.dimensions)?void 0:n.width)||!(null==(s=null==p?void 0:p.dimensions)?void 0:s.height),onClick:()=>d(q(p,"halls"),{state:{exhibitionId:x}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),t.jsx(ie,{xs:24,sm:12,md:8,children:t.jsxs(ae,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[t.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:t.jsx(f,{style:{fontSize:"48px",color:"#1890ff"}})}),t.jsx(ae.Meta,{title:"Stall Management",description:"Create and manage stalls within halls",style:{marginBottom:"16px"}}),t.jsx(je,{type:"primary",disabled:!u.length,onClick:()=>d(q(p,"stalls"),{state:{exhibitionId:x}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})}),t.jsx(ie,{xs:24,sm:12,md:8,children:t.jsxs(ae,{hoverable:!0,style:{height:"100%",background:"#fff",borderRadius:"8px"},bodyStyle:{padding:"24px"},children:[t.jsx("div",{style:{height:140,background:"#f0f2f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",marginBottom:"16px"},children:t.jsx(S,{style:{fontSize:"48px",color:"#1890ff"}})}),t.jsx(ae.Meta,{title:"Fixture Management",description:"Add sofas, chairs, entrances and other fixtures to the layout",style:{marginBottom:"16px"}}),t.jsx(je,{type:"primary",disabled:!(null==(a=null==p?void 0:p.dimensions)?void 0:a.width)||!(null==(o=null==p?void 0:p.dimensions)?void 0:o.height),onClick:()=>d(q(p,"fixtures"),{state:{exhibitionId:x}}),style:{background:"#7828C8",borderColor:"#7828C8"},children:"Manage"})]})})]})]})}},Symbol.toStringTag,{value:"Module"})),He=({exhibitionId:e,destination:i="layout",label:n="Back to Layout"})=>{const s=k(),{currentExhibition:a}=E((e=>e.exhibition));return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>s(q(a,i),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:n})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},We=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var n,s,a;const{id:o}=D(),l=A(),r=k(),d=I(),c=(null==(n=l.state)?void 0:n.exhibitionId)||o,{currentExhibition:x,halls:h}=E((e=>e.exhibition)),p=e.useRef(null),[u,m]=me.useMessage(),[b,g]=e.useState(!1),[f,y]=e.useState(null),[j,v]=e.useState({width:0,height:0});e.useEffect((()=>{const e=()=>{if(p.current){const{clientWidth:e,clientHeight:t}=p.current;v({width:Math.max(e||400,400),height:Math.max(t||400,400)})}};e();const t=new ResizeObserver(e);return p.current&&t.observe(p.current),window.addEventListener("resize",e),()=>{t.disconnect(),window.removeEventListener("resize",e)}}),[]),e.useEffect((()=>{if(!c)return u.error("Exhibition ID not found"),void r("/exhibition");d(R(c))}),[c,d,r,u]),e.useEffect((()=>{var e,t;if(x){if(!(null==(e=x.dimensions)?void 0:e.width)||!(null==(t=x.dimensions)?void 0:t.height))return u.info("Please set up exhibition space first"),void r(q(x,"space"),{state:{exhibitionId:c}});d(N(c))}}),[x,c,d,r,u]);const S=()=>{y(null),g(!0)},_=async e=>{var t;try{e.id?(await O.updateHall(c,e.id,e),u.success("Hall updated successfully"),g(!1)):(await O.createHall(c,e),u.success("Hall created successfully"),g(!1)),d(N(c))}catch(i){409===(null==(t=i.response)?void 0:t.status)?u.warning({content:i.response.data.message,duration:6,style:{marginTop:"20vh"}}):(u.error(i.message||"Failed to save hall"),g(!1))}};return t.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[t.jsx(He,{exhibitionId:c}),m,t.jsx(ae,{title:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(ne,{children:[t.jsx("span",{children:"Hall Management"}),t.jsx(je,{icon:t.jsx(C,{}),onClick:()=>r(q(x,"space"),{state:{exhibitionId:c}}),children:"Back to Space Setup"})]}),t.jsxs(ne,{children:[t.jsx(je,{type:"primary",icon:t.jsx(i,{}),onClick:S,children:"Add Hall"}),t.jsx(je,{type:"primary",icon:t.jsx(w,{}),onClick:async()=>{try{await O.saveLayout(c,h),u.success("Layout saved successfully")}catch(e){u.error("Failed to save layout")}},disabled:!h.length,children:"Save Layout"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:t.jsx("div",{ref:p,style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:t.jsx(Se,{children:j.width>0&&j.height>0&&(null==x?void 0:x.dimensions)&&t.jsx(X,{width:j.width,height:j.height,exhibitionWidth:x.dimensions.width,exhibitionHeight:x.dimensions.height,halls:h,selectedHall:f,onSelectHall:e=>{y(e),g(!!e)},onHallChange:_,onAddHall:S})})})}),t.jsx(U,{visible:b,hall:f,onCancel:()=>g(!1),onSubmit:_,onDelete:async e=>{var t,i;try{const t=e._id||e.id;if(!t)throw new Error("Hall ID is required");await O.deleteHall(c,t),u.success("Hall deleted successfully"),g(!1),y(null),d(N(c))}catch(n){u.error((null==(i=null==(t=n.response)?void 0:t.data)?void 0:i.message)||"Failed to delete hall")}},exhibitionWidth:(null==(s=null==x?void 0:x.dimensions)?void 0:s.width)||100,exhibitionHeight:(null==(a=null==x?void 0:x.dimensions)?void 0:a.height)||100})]})}},Symbol.toStringTag,{value:"Module"})),Ye=({exhibitionId:e,destination:i="layout",label:n="Back to Layout"})=>{const s=k(),{currentExhibition:a}=E((e=>e.exhibition));return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>s(q(a,i),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:n})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},Oe=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var n,s,a;const{message:o}=ee.useApp(),{id:l}=D(),r=A(),d=k(),c=I(),[x,h]=T(),p=(null==(n=r.state)?void 0:n.exhibitionId)||l,{currentExhibition:u,halls:m,stalls:b,loading:g}=E((e=>e.exhibition)),f=e.useRef(null),[y,j]=e.useState(!1),[v,w]=e.useState(null),[S,_]=e.useState(null),[z,M]=e.useState({width:0,height:0}),[B,P]=e.useState(!1);e.useEffect((()=>{if(!p)return o.error("Exhibition ID not found"),void d("/exhibitions")}),[p,d,o]),e.useEffect((()=>{if(!p)return o.error("Exhibition ID not found"),void d("/exhibition");(async()=>{try{await c(R(p)).unwrap(),await c(N(p)).unwrap(),P(!0)}catch(e){o.error("Failed to load data")}})()}),[p,c,d]),e.useEffect((()=>{var e,t;B&&u&&((null==(e=u.dimensions)?void 0:e.width)&&(null==(t=u.dimensions)?void 0:t.height)||(o.info("Please set up exhibition space first"),d(q(u,"space"),{state:{exhibitionId:p}})))}),[u,p,d,B]),e.useEffect((()=>{B&&!g&&0===m.length&&(o.info("Please create halls first"),d(q(u,"halls"),{state:{exhibitionId:p}}))}),[m,p,d,g,B]),e.useEffect((()=>{if(B&&u&&m.length>0){(async()=>{try{const e=m.map((e=>c(L({exhibitionId:p,hallId:e.id})).unwrap()));await Promise.all(e)}catch(e){o.error("Failed to load stalls")}})()}}),[u,p,m,c,B]);const F=b.filter((e=>e.hallId===((null==v?void 0:v.id)||(null==v?void 0:v._id))));e.useEffect((()=>{if(!B||0===m.length)return;const e=x.get("hallId");if(e){const t=m.find((t=>t.id===e||t._id===e));if(t)w(t);else if(m.length>0){w(m[0]);const e=m[0].id||m[0]._id;e&&h({hallId:e.toString()})}}else if(m.length>0){w(m[0]);const e=m[0].id||m[0]._id;e&&h({hallId:e.toString()})}}),[m,x,B,h]),e.useEffect((()=>{const e=()=>{if(f.current){const{clientWidth:e,clientHeight:t}=f.current;M({width:Math.max(e||400,400),height:Math.max(t||400,400)})}};e();const t=new ResizeObserver(e);return f.current&&t.observe(f.current),window.addEventListener("resize",e),()=>{t.disconnect(),window.removeEventListener("resize",e)}}),[]);const H=async e=>{var t,i;if(!p)return void o.error("Exhibition ID not found");const n=e.id||e._id;if(!n)return void o.error("Stall ID not found");if(!(null==v?void 0:v.id)&&!(null==v?void 0:v._id))return void o.error("No hall selected");const s=v.id,a=v._id||v.id;try{await O.updateStall(p,n,{...e,id:n,hallId:a}),c(L({exhibitionId:p,hallId:s}))}catch(l){o.error((null==(i=null==(t=l.response)?void 0:t.data)?void 0:i.message)||"Failed to update stall position")}};return t.jsx(Se,{children:t.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[t.jsx("div",{style:{padding:"24px 24px 0"},children:t.jsx(Ye,{exhibitionId:p})}),t.jsx(ae,{title:"Stall Manager",extra:t.jsxs(ne,{children:[t.jsx(je,{icon:t.jsx(C,{}),onClick:()=>d(`/exhibition/${p}`,{state:{exhibitionId:p}}),children:"Back to Exhibition"}),t.jsx(je,{type:"primary",icon:t.jsx(i,{}),onClick:()=>{v?(_(null),j(!0)):o.warning("Please select a hall first")},disabled:!v,children:"Add Stall"})]}),style:{flex:1},bodyStyle:{height:"calc(100% - 57px)"},children:t.jsx("div",{ref:f,style:{width:"100%",height:"100%",minHeight:"400px",background:"#f0f2f5",borderRadius:"8px",overflow:"hidden"},children:u&&t.jsx(X,{width:z.width,height:z.height,exhibitionWidth:(null==(s=u.dimensions)?void 0:s.width)||100,exhibitionHeight:(null==(a=u.dimensions)?void 0:a.height)||100,halls:m,selectedHall:v,onSelectHall:e=>{if(w(e),_(null),e){const t=e.id||e._id;h(t?{hallId:t.toString()}:{})}else h({})},isStallMode:!0,children:v&&F.map((e=>t.jsx($,{stall:e,isSelected:(null==S?void 0:S.id)===e.id||(null==S?void 0:S._id)===e._id,onSelect:()=>(e=>{var t;const i=e?{...e,id:e.id||e._id,_id:e._id||e.id,stallTypeId:"string"==typeof e.stallTypeId?e.stallTypeId:(null==(t=e.stallTypeId)?void 0:t._id)||e.stallTypeId,stallType:e.stallType}:null;_(i),j(!!i)})(e),onChange:H,hallWidth:v.dimensions.width,hallHeight:v.dimensions.height,hallX:v.dimensions.x,hallY:v.dimensions.y},e.id||e._id)))})})}),u&&t.jsx(K,{visible:y,stall:S,hall:v,exhibition:u,onCancel:()=>{j(!1),_(null)},onSubmit:async e=>{var t,i;try{if(!(null==v?void 0:v.id)&&!(null==v?void 0:v._id))return void o.error("No hall selected");const t=v.id,i=v._id||v.id;if(e.hallId&&e.hallId!==i)return void o.error("Cannot move stall to a different hall");if(e.id||e._id){const t={...e,id:e.id,_id:e._id,hallId:i,stallTypeId:e.stallTypeId},n=e.id||e._id;if(!n)throw new Error("Stall ID is missing");await O.updateStall(p,n,t),o.success("Stall updated successfully")}else{const{id:t,_id:n,...s}=e,a={...s,hallId:i,stallTypeId:e.stallTypeId};await O.createStall(p,a),o.success("Stall created successfully")}j(!1),c(L({exhibitionId:p,hallId:t}))}catch(n){o.error((null==(i=null==(t=n.response)?void 0:t.data)?void 0:i.message)||"Failed to save stall")}},onDelete:S?()=>(async e=>{var t,i;try{if(!p)return void o.error("Exhibition ID not found");const t=v;if(!t)return void o.error("No hall selected");const i=t.id||t._id;if(!i)return void o.error("Invalid hall ID");await O.deleteStall(p,e),j(!1),_(null),await c(L({exhibitionId:p,hallId:i})).unwrap(),o.success("Stall deleted successfully")}catch(n){o.error((null==(i=null==(t=n.response)?void 0:t.data)?void 0:i.message)||"Failed to delete stall")}})(S.id||S._id):void 0})]})})}},Symbol.toStringTag,{value:"Module"})),qe=({exhibitionId:e,destination:i="layout",label:n="Back to Layout"})=>{const s=k(),{currentExhibition:a}=E((e=>e.exhibition));return t.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[t.jsx(je,{icon:t.jsx(v,{}),onClick:()=>s(q(a,i),{state:{exhibitionId:e}}),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:t.jsx("span",{style:{marginLeft:8},children:n})}),t.jsx("style",{children:"\n        .back-button-hover:hover {\n          transform: translateX(-5px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n          background: #f0f5ff;\n          border-color: #d6e4ff;\n        }\n      "})]})},Ve=[{value:"all",label:"All Types"},{value:"sofa",label:"Sofas"},{value:"chair",label:"Chairs"},{value:"table",label:"Tables"},{value:"desk",label:"Desks"},{value:"plant",label:"Plants"},{value:"entrance",label:"Entrances"},{value:"exit",label:"Exits"},{value:"info",label:"Information"},{value:"restroom",label:"Restrooms"},{value:"food",label:"Food Areas"},{value:"custom",label:"Custom"}],Ge=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var n,s,a;const{message:o}=ee.useApp(),{id:l}=D(),r=A(),d=k(),c=I(),x=(null==(n=r.state)?void 0:n.exhibitionId)||l,{currentExhibition:h,fixtures:p,halls:u,stalls:m,loading:b}=E((e=>e.exhibition)),g=e.useRef(null),[f,y]=e.useState(!1),[j,v]=e.useState(null),[w,S]=e.useState({width:0,height:0}),[C,_]=e.useState("all"),[T,z]=e.useState([]);e.useEffect((()=>{if(!x)return o.error("Exhibition ID not found"),void d("/exhibitions")}),[x,d,o]),e.useEffect((()=>{(async()=>{try{await c(R(x)).unwrap(),await c(F({exhibitionId:x})).unwrap(),await c(N(x)).unwrap(),await c(L({exhibitionId:x})).unwrap()}catch(e){o.error("Failed to load data")}})()}),[x,c,o]),e.useEffect((()=>{z("all"===C?p:p.filter((e=>e.type===C)))}),[p,C]),e.useEffect((()=>{const e=()=>{if(g.current){const{clientWidth:e,clientHeight:t}=g.current;S({width:Math.max(e||400,400),height:Math.max(t||400,400)})}};e();const t=new ResizeObserver(e);return g.current&&t.observe(g.current),window.addEventListener("resize",e),()=>{t.disconnect(),window.removeEventListener("resize",e)}}),[]);const M=()=>{v(null),y(!0)},B=async e=>{try{e.id||e._id?(await c(H({exhibitionId:x,id:e.id||e._id||"",data:e})).unwrap(),o.success("Fixture updated successfully")):(await c(W({exhibitionId:x,data:e})).unwrap(),o.success("Fixture created successfully")),await c(F({exhibitionId:x})).unwrap(),y(!1)}catch(t){o.error(t.message||"Failed to save fixture")}};return t.jsxs("div",{style:{padding:"24px",height:"100vh",display:"flex",flexDirection:"column"},children:[t.jsx(qe,{exhibitionId:x}),t.jsxs(ae,{title:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(ne,{children:t.jsx("span",{children:"Fixture Management"})}),t.jsxs(ne,{children:[t.jsx(re,{style:{width:180},value:C,onChange:e=>{_(e)},options:Ve}),t.jsx(je,{type:"primary",icon:t.jsx(i,{}),onClick:M,children:"Add Fixture"})]})]}),styles:{body:{flex:1,padding:0,overflow:"hidden",minHeight:"400px",position:"relative",background:"#fafafa"}},style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:"500px"},children:[t.jsx("div",{style:{padding:"8px 16px",background:"#f0f7ff",borderBottom:"1px solid #d6e8ff",color:"#0050b3",fontSize:"14px"},children:"Halls and stalls are shown for reference. Place fixtures relative to these elements to enhance visitor navigation."}),t.jsx("div",{ref:g,style:{position:"absolute",top:33,left:0,right:0,bottom:0,overflow:"hidden"},children:t.jsx(Se,{children:w.width>0&&w.height>0&&(null==h?void 0:h.dimensions)&&t.jsx(X,{width:w.width,height:w.height,exhibitionWidth:h.dimensions.width,exhibitionHeight:h.dimensions.height,halls:u,stalls:m,fixtures:T,selectedFixture:j,onSelectFixture:e=>{v(e),y(!!e)},onFixtureChange:B,onAddFixture:M,isFixtureMode:!0})})})]}),t.jsx(Z,{visible:f,fixture:j,onCancel:()=>y(!1),onSubmit:B,onDelete:async e=>{try{const t=e.id||e._id;if(!t)throw new Error("Fixture ID is required");await c(Y({exhibitionId:x,id:t})).unwrap(),o.success("Fixture deleted successfully"),y(!1),v(null)}catch(t){o.error(t.message||"Failed to delete fixture")}},exhibitionWidth:(null==(s=null==h?void 0:h.dimensions)?void 0:s.width)||100,exhibitionHeight:(null==(a=null==h?void 0:h.dimensions)?void 0:a.height)||100})]})}},Symbol.toStringTag,{value:"Module"}));export{Ae as a,Be as b,Le as c,Fe as d,Re as e,We as f,Oe as g,Ge as h,De as i};
