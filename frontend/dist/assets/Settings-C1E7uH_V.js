import{h as E,a as y,j as e,i as k,k as z}from"./index-ZeXq6Cnq.js";import{j as C,i as B,r as j}from"./vendor-react-BNeW3y6d.js";/* empty css                  */import{ae as A,H as n,a6 as U,a7 as S,S as I,T as V,a5 as q,I as v,a1 as T,a4 as O,ab as M,P as L,c as R,ag as D,aS as H,a3 as G}from"./vendor-antd-DmzwxccF.js";import"./vendor-utils-D9BQhWAM.js";import"./vendor-styling-C4kvkEn0.js";import"./vendor-canvas-BRbMLhVA.js";const{Option:d}=T,{Title:J,Text:K}=V,te=()=>{const h=C(),{message:u}=A.useApp(),[c]=n.useForm(),{settings:t,loading:$}=B(a=>a.settings),[f,r]=j.useState([]),[p,g]=j.useState(0);j.useEffect(()=>{h(E())},[h]),j.useEffect(()=>{if(t&&(c.setFieldsValue({siteName:t.siteName,adminEmail:t.adminEmail,language:t.language,timezone:t.timezone,emailNotifications:t.emailNotifications,footerText:t.footerText}),t.logo)){const a=s=>{const o=localStorage.getItem("token");return{url:`${y.defaults.baseURL}/uploads/${s}`,token:o}},{url:i,token:l}=a(t.logo);fetch(i,{headers:{authorization:`Bearer ${l}`}}).then(s=>s.blob()).then(s=>{var m;const o=URL.createObjectURL(s);r([{uid:"-1",name:((m=t.logo)==null?void 0:m.split("/").pop())||"logo",status:"done",url:o,thumbUrl:o,type:s.type,response:{path:t.logo}}])}).catch(()=>{r([])})}},[t,c]);const F=a=>{h(k(a)).unwrap().then(()=>u.success("Settings updated successfully")).catch(i=>u.error(`Failed to update settings: ${i}`))},N={name:"file",action:`${y.defaults.baseURL}/settings/upload/logo`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:f,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(a){const{status:i,name:l,response:s,uid:o}=a.file;if(i==="uploading"){r([...a.fileList]);return}if(i==="done"&&s){g(0);const m=localStorage.getItem("token"),w=`${y.defaults.baseURL}/uploads/${s.path}`;fetch(w,{headers:{authorization:`Bearer ${m}`}}).then(x=>x.blob()).then(x=>{const b=URL.createObjectURL(x);r([{uid:a.file.uid,name:l,status:"done",url:b,thumbUrl:b,type:x.type,response:s}]),u.success(`${l} uploaded successfully`),c.setFieldValue("logo",s.path)}).catch(()=>{u.error(`${l} preview failed to load`),r([])})}else i==="error"?(u.error(`${l} upload failed.`),r([]),g(0)):i==="removed"&&(r([]),c.setFieldValue("logo",null),g(0))},onRemove(){return r([]),c.setFieldValue("logo",null),g(0),!0},customRequest:async({file:a,onSuccess:i,onError:l,onProgress:s})=>{try{h(z(a)).unwrap().then(o=>{i&&i(o)}).catch(o=>{l&&l(new Error(o))})}catch(o){l&&l(o)}}},P=e.jsx("div",{children:p>0?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(L,{type:"circle",percent:p,width:80}),e.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})});return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(U,{gutter:[24,24],align:"middle",children:e.jsx(S,{flex:"auto",children:e.jsxs(I,{direction:"vertical",size:4,children:[e.jsx(J,{level:4,style:{margin:0},children:"Settings"}),e.jsx(K,{type:"secondary",children:"Configure system settings and preferences"})]})})})}),e.jsx(q,{className:"info-card",children:e.jsxs(n,{form:c,layout:"vertical",onFinish:F,initialValues:{siteName:"Exhibition Management System",emailNotifications:!0,language:"en",timezone:"UTC"},children:[e.jsxs(U,{gutter:24,children:[e.jsxs(S,{span:12,children:[e.jsx(n.Item,{label:"Site Name",name:"siteName",rules:[{required:!0,message:"Please input the site name!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Admin Email",name:"adminEmail",rules:[{required:!0,message:"Please input the admin email!"},{type:"email",message:"Please enter a valid email!"}],children:e.jsx(v,{})}),e.jsx(n.Item,{label:"Language",name:"language",children:e.jsxs(T,{children:[e.jsx(d,{value:"en",children:"English"}),e.jsx(d,{value:"es",children:"Spanish"}),e.jsx(d,{value:"fr",children:"French"})]})}),e.jsx(n.Item,{label:"Timezone",name:"timezone",children:e.jsxs(T,{children:[e.jsx(d,{value:"UTC",children:"UTC"}),e.jsx(d,{value:"EST",children:"EST"}),e.jsx(d,{value:"PST",children:"PST"})]})}),e.jsx(n.Item,{label:"Email Notifications",name:"emailNotifications",valuePropName:"checked",children:e.jsx(O,{})})]}),e.jsxs(S,{span:12,children:[e.jsxs(n.Item,{label:"Site Logo",name:"logo",tooltip:"Upload your site logo (recommended size: 200x200px, max 2MB)",children:[e.jsx(M,{...N,children:f.length<1&&P}),f.length>0&&p>0&&e.jsx(L,{percent:p,status:"active",style:{marginTop:8}})]}),e.jsx(n.Item,{label:"Footer Text",name:"footerText",children:e.jsx(v.TextArea,{rows:4,placeholder:"Enter footer text (optional)"})})]})]}),e.jsx(n.Item,{children:e.jsxs(I,{children:[e.jsx(R,{type:"primary",htmlType:"submit",icon:e.jsx(D,{}),loading:$,children:"Save Settings"}),e.jsx(R,{onClick:()=>c.resetFields(),icon:e.jsx(H,{}),children:"Reset"})]})})]})})]})};export{te as default};
