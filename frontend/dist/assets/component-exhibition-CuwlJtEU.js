import{r as e,j as t,f as n,g as i,R as s,h as a,i as l,k as o,l as r,m as d,n as c,o as h,p as x,q as m,s as p,t as u,u as g,v as b,w as f,x as y,y as j,z as v,A as w,B as S,C as k,D as C,E as I,c as N,F as E,G as T,H as P}from"./vendor-others-aeGeD6f-.js";import{E as A}from"./vendor-editor-HOXaQDhO.js";import{s as D,a as R,g as F,p as z}from"./services-DHEt1Qtz.js";import{c as $,T as M,R as q,C as L,I as B,d as V,e as _,f as H,g as W,h as U,i as O,U as Y,P as G,D as X,j as Q,k as K,M as Z,s as J,l as ee,m as te,n as ne,S as ie,o as se,E as ae,A as le,B as oe,p as re,b as de,L as ce,a as he,q as xe,r as me,t as pe}from"./vendor-antd-core-CLD06I8y.js";import{F as ue}from"./vendor-antd-form-DJHhvp8w.js";import{B as ge}from"./vendor-antd-buttons-wjEWA2x8.js";import{M as be}from"./vendor-antd-modal-1GBGM2fb.js";import{L as fe,G as ye,R as je,T as ve,u as we,a as Se,I as ke,C as Ce,b as Ie,c as Ne,K as Ee,S as Te,F as Pe,d as Ae}from"./vendor-canvas-BOVIu3pe.js";import{a as De,b as Re,c as Fe,u as ze,L as $e}from"./vendor-react-i7tvbPTl.js";import{G as Me,a as qe}from"./component-layout-BTsCaDZB.js";import{n as Le}from"./vendor-ui-BOD89xu8.js";import{F as Be}from"./vendor-antd-table-CA0XBoxE.js";import{s as Ve}from"./store-D4NI4RZ9.js";const _e="localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname?"https://aakardata.in/api":"http://localhost:5000/api",He=(e,t)=>{if(!e)return"";let n=`/exhibition/${e.slug||e._id||e.id}`;return t&&(n+=`/${t}`),n},We=(e,t)=>{if(!e)return"";return`/exhibitions/${e.slug||e._id||e.id}`},{RangePicker:Ue}=V,{Title:Oe,Text:Ye}=M,Ge=({value:e="",onChange:n})=>{const i=s.useRef(null),[a]=s.useState(e);return t.jsx(A,{apiKey:"ma7o6bmjpok2nhnhq6jgcwrlg446a2hnyxqih70ni695pvm5",onInit:(e,t)=>{i.current=t},value:e,init:{height:300,menubar:!1,plugins:["advlist","autolink","lists","link","charmap","preview","searchreplace","visualblocks","code","fullscreen","insertdatetime","table","help","wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | removeformat | help",content_style:'body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; font-size: 14px; }',branding:!1,promotion:!1,entity_encoding:"raw",convert_urls:!1,paste_data_images:!0,resize:!1,statusbar:!1,browser_spellcheck:!0,setup:e=>{e.on("init",(()=>{e.undoManager.clear(),e.undoManager.add()})),e.on("change",(()=>{e.undoManager.add()}))}},onEditorChange:e=>{null==n||n(e)}})},Xe=({form:s})=>{const[a,l]=e.useState([]),[o,r]=e.useState(!1);return e.useEffect((()=>{(async()=>{try{r(!0);const e=await D.getStallTypes();l(e.data.filter((e=>"active"===e.status)))}catch(e){}finally{r(!1)}})()}),[]),t.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[t.jsxs($,{className:"settings-card",children:[t.jsx(Oe,{level:4,children:"Basic Information"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter the main details of your exhibition"}),t.jsxs(q,{gutter:24,children:[t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"name",label:"Exhibition Name",rules:[{required:!0,message:"Please enter exhibition name"}],children:t.jsx(B,{placeholder:"Enter exhibition name"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter description"}],children:t.jsx(B.TextArea,{rows:4,placeholder:"Enter exhibition description"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"venue",label:"Exhibition Venue",rules:[{required:!0,message:"Please enter exhibition venue"}],children:t.jsx(B.TextArea,{rows:2,placeholder:"Enter exhibition venue details"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"invoicePrefix",label:"Invoice Prefix",tooltip:"This prefix will be used for all invoices generated for this exhibition (e.g. INV, EXP23)",rules:[{max:10,message:"Prefix cannot be longer than 10 characters"},{pattern:/^[A-Za-z0-9-]*$/,message:"Only letters, numbers, and hyphens are allowed"}],children:t.jsx(B,{placeholder:"Enter invoice prefix (default: INV)"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"dateRange",label:"Exhibition Dates",rules:[{required:!0,message:"Please select exhibition dates"}],children:t.jsx(Ue,{style:{width:"100%"}})})})]})]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(Oe,{level:4,children:"Company Details"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your company information"}),t.jsxs(q,{gutter:24,children:[t.jsxs(L,{span:12,children:[t.jsx(ue.Item,{name:"companyName",label:"Company Name",rules:[{required:!0,message:"Please enter company name"}],children:t.jsx(B,{placeholder:"Enter company name"})}),t.jsx(ue.Item,{name:"companyContactNo",label:"Contact No.",rules:[{required:!0,message:"Please enter contact number"}],children:t.jsx(B,{placeholder:"Enter contact number"})}),t.jsx(ue.Item,{name:"companyEmail",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter a valid email"}],children:t.jsx(B,{placeholder:"Enter email address"})}),t.jsx(ue.Item,{name:"companyAddress",label:"Address",rules:[{required:!0,message:"Please enter address"}],children:t.jsx(B.TextArea,{rows:4,placeholder:"Enter company address"})}),t.jsx(ue.Item,{name:"termsAndConditions",label:"Terms & Conditions",tooltip:"Use the rich text editor to format your terms and conditions",children:t.jsx(Ge,{})})]}),t.jsxs(L,{span:12,children:[t.jsx(ue.Item,{name:"companyPAN",label:"PAN No.",rules:[{required:!0,message:"Please enter PAN number"}],children:t.jsx(B,{placeholder:"Enter PAN number"})}),t.jsx(ue.Item,{name:"companyGST",label:"GST No.",rules:[{required:!0,message:"Please enter GST number"}],children:t.jsx(B,{placeholder:"Enter GST number"})}),t.jsx(ue.Item,{name:"companySAC",label:"SAC Code No.",children:t.jsx(B,{placeholder:"Enter SAC code number"})}),t.jsx(ue.Item,{name:"companyCIN",label:"CIN No.",children:t.jsx(B,{placeholder:"Enter CIN number"})}),t.jsx(ue.Item,{name:"companyWebsite",label:"Website",rules:[{type:"url",message:"Please enter a valid URL"}],children:t.jsx(B,{placeholder:"Enter website URL"})}),t.jsx(ue.Item,{name:"piInstructions",label:"PI Instructions",tooltip:"Use the rich text editor to format your PI instructions",children:t.jsx(Ge,{})})]})]})]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(Oe,{level:4,children:"Bank Details"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Enter your bank account information for payments"}),t.jsxs(q,{gutter:24,children:[t.jsxs(L,{span:12,children:[t.jsx(ue.Item,{name:"bankName",label:"Bank Name",rules:[{required:!0,message:"Please enter bank name"}],children:t.jsx(B,{placeholder:"Enter bank name"})}),t.jsx(ue.Item,{name:"bankBranch",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:t.jsx(B,{placeholder:"Enter branch name"})}),t.jsx(ue.Item,{name:"bankIFSC",label:"IFSC Code",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Please enter a valid IFSC code"}],children:t.jsx(B,{placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})})]}),t.jsxs(L,{span:12,children:[t.jsx(ue.Item,{name:"bankAccountName",label:"Account Name",rules:[{required:!0,message:"Please enter account name"}],children:t.jsx(B,{placeholder:"Enter account name"})}),t.jsx(ue.Item,{name:"bankAccount",label:"Account Number",rules:[{required:!0,message:"Please enter account number"},{pattern:/^\d+$/,message:"Please enter a valid account number"}],children:t.jsx(B,{placeholder:"Enter account number"})})]})]})]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(Oe,{level:4,children:"Stall Rates & Pricing"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure pricing, taxes, and discounts for stalls"}),t.jsxs("div",{style:{marginBottom:"32px"},children:[t.jsx(Oe,{level:5,children:"Stall Type Rates"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure pricing per square meter for different types of stalls"}),t.jsx(ue.List,{name:"stallRates",children:(e,{add:s,remove:l})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(_,{style:{display:"flex",marginBottom:8},align:"baseline",children:[t.jsx(ue.Item,{...s,name:[i,"stallTypeId"],rules:[{required:!0,message:"Please select stall type"}],children:t.jsx(H,{loading:o,placeholder:"Select stall type",style:{width:200},children:a.map((e=>t.jsx(H.Option,{value:e._id,children:e.name},e._id)))})}),t.jsx(ue.Item,{...s,name:[i,"rate"],rules:[{required:!0,message:"Please enter rate"}],children:t.jsx(W,{min:0,placeholder:"Rate per sq.m",style:{width:200},prefix:"₹",formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>{const t=e?Number(e.replace(/₹\s?|(,*)/g,"")):0;return isNaN(t)?0:t}})}),t.jsx(n,{onClick:()=>l(i)})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s(),block:!0,icon:t.jsx(i,{}),children:"Add Stall Type Rate"})})]})})]}),t.jsxs("div",{style:{marginBottom:"32px"},children:[t.jsx(Oe,{level:5,children:"Tax Configuration"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure applicable taxes for stall bookings"}),t.jsx(ue.List,{name:"taxConfig",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(_,{style:{display:"flex",marginBottom:8},align:"baseline",children:[t.jsx(ue.Item,{...s,name:[i,"name"],rules:[{required:!0,message:"Please enter tax name"}],children:t.jsx(B,{placeholder:"Tax name",style:{width:150}})}),t.jsx(ue.Item,{...s,name:[i,"rate"],rules:[{required:!0,message:"Please enter tax rate"}],children:t.jsx(W,{min:0,max:100,placeholder:"Tax rate",style:{width:150},formatter:e=>`${e}%`,parser:e=>{const t=e?Number(e.replace("%","")):0;return isNaN(t)?0:Math.min(t,100)}})}),t.jsx(ue.Item,{...s,name:[i,"isActive"],valuePropName:"checked",children:t.jsx(U,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),t.jsx(n,{onClick:()=>a(i)})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s(),block:!0,icon:t.jsx(i,{}),children:"Add Tax"})})]})})]}),t.jsxs("div",{children:[t.jsx(Oe,{level:5,children:"Admin Discount Configuration"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for admin panel stall bookings"}),t.jsx(ue.List,{name:"discountConfig",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(_,{style:{display:"flex",marginBottom:8},align:"baseline",children:[t.jsx(ue.Item,{...s,name:[i,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:t.jsx(B,{placeholder:"Discount",style:{width:150}})}),t.jsx(ue.Item,{...s,name:[i,"type"],rules:[{required:!0,message:"Please select type"}],children:t.jsxs(H,{style:{width:150},children:[t.jsx(H.Option,{value:"percentage",children:"Percentage (%)"}),t.jsx(H.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),t.jsx(ue.Item,{noStyle:!0,shouldUpdate:(e,t)=>{var n,s,a,l;return(null==(s=null==(n=null==e?void 0:e.discountConfig)?void 0:n[i])?void 0:s.type)!==(null==(l=null==(a=null==t?void 0:t.discountConfig)?void 0:a[i])?void 0:l.type)},children:({getFieldValue:e})=>{const n=e(["discountConfig",i,"type"]);return t.jsx(ue.Item,{...s,name:[i,"value"],rules:[{required:!0,message:"Please enter "+("percentage"===n?"percentage":"amount")}],children:t.jsx(W,{min:0,max:"percentage"===n?100:void 0,placeholder:"percentage"===n?"Percentage":"Amount",style:{width:150},formatter:e=>"percentage"===n?`${e}%`:`₹${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>{const t=e?Number(e.replace(/[₹%,]/g,"")):0;return isNaN(t)?0:t}})})}}),t.jsx(ue.Item,{...s,name:[i,"isActive"],valuePropName:"checked",children:t.jsx(U,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),t.jsx(n,{onClick:()=>a(i)})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s(),block:!0,icon:t.jsx(i,{}),children:"Add Admin Discount"})})]})})]}),t.jsxs("div",{style:{marginTop:"24px"},children:[t.jsx(Oe,{level:5,children:"Public Discount Configuration"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Configure available discounts for public stall bookings"}),t.jsx(ue.List,{name:"publicDiscountConfig",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(_,{style:{display:"flex",marginBottom:8},align:"baseline",children:[t.jsx(ue.Item,{...s,name:[i,"name"],rules:[{required:!0,message:"Please enter discount name"}],children:t.jsx(B,{placeholder:"Discount",style:{width:150}})}),t.jsx(ue.Item,{...s,name:[i,"type"],rules:[{required:!0,message:"Please select type"}],children:t.jsxs(H,{style:{width:150},children:[t.jsx(H.Option,{value:"percentage",children:"Percentage (%)"}),t.jsx(H.Option,{value:"fixed",children:"Fixed Amount (₹)"})]})}),t.jsx(ue.Item,{noStyle:!0,shouldUpdate:(e,t)=>{var n,s,a,l;return(null==(s=null==(n=null==e?void 0:e.publicDiscountConfig)?void 0:n[i])?void 0:s.type)!==(null==(l=null==(a=null==t?void 0:t.publicDiscountConfig)?void 0:a[i])?void 0:l.type)},children:({getFieldValue:e})=>{const n=e(["publicDiscountConfig",i,"type"]);return t.jsx(ue.Item,{...s,name:[i,"value"],rules:[{required:!0,message:"Please enter "+("percentage"===n?"percentage":"amount")}],children:t.jsx(W,{min:0,max:"percentage"===n?100:void 0,placeholder:"percentage"===n?"Percentage":"Amount",style:{width:150},formatter:e=>"percentage"===n?`${e}%`:`₹${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>{const t=e?Number(e.replace(/[₹%,]/g,"")):0;return isNaN(t)?0:t}})})}}),t.jsx(ue.Item,{...s,name:[i,"isActive"],valuePropName:"checked",children:t.jsx(U,{checkedChildren:"Active",unCheckedChildren:"Inactive"})}),t.jsx(n,{onClick:()=>a(i)})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s(),block:!0,icon:t.jsx(i,{}),children:"Add Public Discount"})})]})})]})]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(Oe,{level:4,children:"Status Settings"}),t.jsx(Ye,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Manage the visibility and status of your exhibition"}),t.jsxs(q,{gutter:24,children:[t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:t.jsxs(H,{children:[t.jsx(H.Option,{value:"draft",children:"Draft"}),t.jsx(H.Option,{value:"published",children:"Published"}),t.jsx(H.Option,{value:"completed",children:"Completed"})]})})}),t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:"isActive",label:"Active Status",valuePropName:"checked",children:t.jsx(U,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})})]})]})]})},{Title:Qe,Text:Ke}=M,Ze=({form:n})=>{const{message:i}=O.useApp(),[s,l]=e.useState([]),[o,r]=e.useState([]),[d,c]=e.useState(0),[h,x]=e.useState({}),m=e=>{const t=localStorage.getItem("token");return{url:`${R.defaults.baseURL}/uploads/${e}`,token:t}};e.useEffect((()=>{const e=n.getFieldValue("headerLogo");if(e){const{url:t,token:n}=m(e);fetch(t,{headers:{authorization:`Bearer ${n}`}}).then((e=>e.blob())).then((t=>{const n=URL.createObjectURL(t);l([{uid:"-1",name:e.split("/").pop()||"logo",status:"done",url:n,thumbUrl:n,type:t.type,response:{path:e}}])})).catch((()=>{l([])}))}}),[n]),e.useEffect((()=>{const e=n.getFieldValue("sponsorLogos")||[];e.length>0&&Promise.all(e.map((async(e,t)=>{const{url:n,token:i}=m(e);try{const s=await fetch(n,{headers:{authorization:`Bearer ${i}`}}),a=await s.blob(),l=URL.createObjectURL(a);return{uid:`-${t+1}`,name:e.split("/").pop()||`sponsor-${t+1}`,status:"done",url:l,thumbUrl:l,type:a.type,response:{path:e}}}catch{return null}}))).then((e=>{r(e.filter(Boolean))}))}),[n]);const p={name:"file",action:`${R.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:s,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(e){const{status:t,name:s,response:a,uid:o}=e.file;if("uploading"!==t)if("done"===t&&a){const{url:t,token:o}=m(a.path);c(0),fetch(t,{headers:{authorization:`Bearer ${o}`}}).then((e=>e.blob())).then((t=>{const o=URL.createObjectURL(t);l([{uid:e.file.uid,name:s,status:"done",url:o,thumbUrl:o,type:t.type,response:a}]),i.success(`${s} uploaded successfully`),n.setFieldValue("headerLogo",a.path),a.thumbnail&&n.setFieldValue("headerLogoThumbnail",a.thumbnail)})).catch((()=>{i.error(`${s} preview failed to load`),l([])}))}else"error"===t?(i.error(`${s} upload failed.`),l([]),c(0)):"removed"===t&&(l([]),n.setFieldValue("headerLogo",null),n.setFieldValue("headerLogoThumbnail",null),c(0));else l([...e.fileList])},customRequest:async e=>{const{onProgress:t,onSuccess:n,onError:i,file:s,action:a,headers:l}=e;try{const e=new FormData;e.append("file",s);const o=new XMLHttpRequest;o.open("POST",a||"",!0),l&&Object.keys(l).forEach((e=>{o.setRequestHeader(e,l[e])})),o.upload.onprogress=e=>{e.lengthComputable&&t&&(t({percent:e.loaded/e.total*100}),c(Math.round(e.loaded/e.total*100)))},o.onload=()=>{if(o.status>=200&&o.status<300)try{const e=JSON.parse(o.response);null==n||n(e,s),c(0)}catch(e){null==i||i(e)}else null==i||i(new Error("Upload failed"))},o.onerror=()=>{c(0),null==i||i(new Error("Upload request failed"))},o.send(e)}catch(o){c(0),null==i||i(o)}},onRemove:()=>(l([]),n.setFieldValue("headerLogo",null),n.setFieldValue("headerLogoThumbnail",null),c(0),!0),onPreview:async e=>{if(!e.url)return;const t=window.open("");t&&(t.document.write(`\n          <img src="${e.url}" style="max-width: 100%; height: auto;" \n               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"\n          />\n        `),t.document.head.innerHTML="<title>Image Preview</title>")}},u={name:"file",action:`${R.defaults.baseURL}/exhibitions/upload/sponsors`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/*",fileList:o,listType:"picture-card",multiple:!0,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(e){const{status:t,name:s,response:a,uid:l}=e.file;if("uploading"!==t)if("done"===t&&a&&a.paths&&a.paths.length>0){x((e=>{const t={...e};return delete t[l],t}));const t=a.paths[0],{url:d,token:c}=m(t);fetch(d,{headers:{authorization:`Bearer ${c}`}}).then((e=>e.blob())).then((l=>{const d=URL.createObjectURL(l),c=[...o],h=c.findIndex((t=>t.uid===e.file.uid)),x={uid:e.file.uid,name:s,status:"done",url:d,thumbUrl:d,type:l.type,response:{path:t}};h>-1?c[h]=x:c.push(x),r(c),i.success(`${s} uploaded successfully`);const m=c.filter((e=>{var t;return"done"===e.status&&(null==(t=e.response)?void 0:t.path)})).map((e=>e.response.path));if(n.setFieldValue("sponsorLogos",m),a.thumbnails&&a.thumbnails.length>0){const e=n.getFieldValue("sponsorLogoThumbnails")||[];n.setFieldValue("sponsorLogoThumbnails",[...e,...a.thumbnails])}})).catch((()=>{i.error(`${s} preview failed to load`),r((t=>t.filter((t=>t.uid!==e.file.uid))))}))}else"error"===t?(i.error(`${s} upload failed.`),r((t=>t.filter((t=>t.uid!==e.file.uid)))),x((e=>{const t={...e};return delete t[l],t}))):"removed"===t&&x((e=>{const t={...e};return delete t[l],t}));else r([...e.fileList])},customRequest:async e=>{const{onProgress:t,onSuccess:n,onError:i,file:s,action:a,headers:l}=e,o="object"==typeof s&&"uid"in s?s.uid:String(Date.now());try{const e=new FormData;e.append("file",s);const r=new XMLHttpRequest;r.open("POST",a||"",!0),l&&Object.keys(l).forEach((e=>{r.setRequestHeader(e,l[e])})),r.upload.onprogress=e=>{if(e.lengthComputable&&t){const n=e.loaded/e.total*100;t({percent:n}),x((e=>({...e,[o]:Math.round(n)})))}},r.onload=()=>{if(r.status>=200&&r.status<300)try{const e=JSON.parse(r.response);null==n||n(e,s),x((e=>{const t={...e};return delete t[o],t}))}catch(e){null==i||i(e)}else null==i||i(new Error("Upload failed"))},r.onerror=()=>{x((e=>{const t={...e};return delete t[o],t})),null==i||i(new Error("Upload request failed"))},r.send(e)}catch(r){x((e=>{const t={...e};return delete t[o],t})),null==i||i(r)}},onRemove(e){var t;const i=o.filter((t=>t.uid!==e.uid));r(i);const s=i.filter((e=>{var t;return"done"===e.status&&(null==(t=e.response)?void 0:t.path)})).map((e=>e.response.path));n.setFieldValue("sponsorLogos",s);const a=n.getFieldValue("sponsorLogoThumbnails")||[];if(a.length>0&&(null==(t=e.response)?void 0:t.path)){const t=e.response.path.split("/"),i=t[t.length-1],s=a.filter((e=>!e.includes(i)));n.setFieldValue("sponsorLogoThumbnails",s)}return x((t=>{const n={...t};return delete n[e.uid],n})),!0},onPreview:async e=>{if(!e.url)return;const t=window.open("");t&&(t.document.write(`\n          <img src="${e.url}" style="max-width: 100%; height: auto;" \n               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"\n          />\n        `),t.document.head.innerHTML="<title>Image Preview</title>")}},g=t.jsx("div",{children:d>0?t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx(G,{type:"circle",percent:d,width:80}),t.jsx("div",{style:{marginTop:8},children:"Uploading..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(a,{}),t.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})}),b=t.jsxs("div",{children:[t.jsx(a,{}),t.jsx("div",{style:{marginTop:8},children:"Upload Sponsor Logos"})]});return t.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:t.jsxs($,{className:"settings-card",children:[t.jsx(Qe,{level:4,children:"Header Settings"}),t.jsx(Ke,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure how the exhibition header appears to visitors"}),t.jsxs(q,{gutter:24,children:[t.jsx(L,{span:24,children:t.jsxs(ue.Item,{name:"headerLogo",label:"Header Logo",tooltip:"Upload your exhibition logo (recommended size: 200x200px, max 2MB)",children:[t.jsx(Y,{...p,children:s.length<1&&g}),s.length>0&&d>0&&t.jsx(G,{percent:d,status:"active",style:{marginTop:8}})]})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"headerTitle",label:"Header Title",rules:[{required:!0,message:"Please enter a header title"},{max:100,message:"Title cannot be longer than 100 characters"}],tooltip:"This title will be prominently displayed at the top of your exhibition page",children:t.jsx(B,{placeholder:"Enter a title for your exhibition header"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"headerSubtitle",label:"Header Subtitle",rules:[{max:200,message:"Subtitle cannot be longer than 200 characters"}],tooltip:"A brief tagline or subtitle to provide additional context",children:t.jsx(B,{placeholder:"Enter a subtitle (optional)"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"headerDescription",label:"Header Description",rules:[{max:500,message:"Description cannot be longer than 500 characters"}],tooltip:"A detailed description that appears in the header section",children:t.jsx(B.TextArea,{placeholder:"Enter a description for your exhibition header (optional)",rows:4,showCount:!0,maxLength:500})})}),t.jsxs(L,{span:24,children:[t.jsx(X,{}),t.jsx(Qe,{level:5,children:"Sponsor Logos"}),t.jsx(Ke,{type:"secondary",style:{marginBottom:"16px",display:"block"},children:"Add sponsor logos that will be displayed in the exhibition header"}),t.jsxs(ue.Item,{name:"sponsorLogos",tooltip:"Upload sponsor logos (recommended size: 150x150px, max 2MB each)",children:[t.jsx(Y,{...u,children:b}),Object.entries(h).map((([e,n])=>{var i;return t.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center"},children:[t.jsxs(Ke,{style:{marginRight:10,width:150},ellipsis:!0,children:[(null==(i=o.find((t=>t.uid===e)))?void 0:i.name)||"File",":"]}),t.jsx(G,{percent:n,status:"active",style:{flex:1}})]},e)}))]})]})]})]})})},{Title:Je,Text:et}=M,tt=({form:s})=>{const{message:l}=O.useApp(),[o,r]=e.useState([]),d=e=>{const t=localStorage.getItem("token");return{url:`${R.defaults.baseURL}/uploads/${e}`,token:t}};e.useEffect((()=>{const e=s.getFieldValue("footerLogo");if(e){const{url:t,token:n}=d(e);fetch(t,{headers:{authorization:`Bearer ${n}`}}).then((e=>e.blob())).then((t=>{const n=URL.createObjectURL(t);r([{uid:"-1",name:e.split("/").pop()||"logo",status:"done",url:n,thumbUrl:n,type:t.type,response:{path:e}}])})).catch((()=>{r([])}))}}),[s]);const c={name:"file",action:`${R.defaults.baseURL}/exhibitions/upload/logos`,headers:{authorization:`Bearer ${localStorage.getItem("token")}`},maxCount:1,accept:"image/*",fileList:o,listType:"picture-card",showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0},onChange(e){const{status:t,name:n,response:i}=e.file;if("uploading"!==t)if("done"===t&&i){const{url:t,token:a}=d(i.path);fetch(t,{headers:{authorization:`Bearer ${a}`}}).then((e=>e.blob())).then((t=>{const a=URL.createObjectURL(t);r([{uid:e.file.uid,name:n,status:"done",url:a,thumbUrl:a,type:t.type,response:i}]),l.success(`${n} uploaded successfully`),s.setFieldValue("footerLogo",i.path)})).catch((()=>{l.error(`${n} preview failed to load`),r([])}))}else"error"===t?(l.error(`${n} upload failed.`),r([])):"removed"===t&&(r([]),s.setFieldValue("footerLogo",null));else r([...e.fileList])},onRemove:()=>(r([]),s.setFieldValue("footerLogo",null),!0),onPreview:async e=>{if(!e.url)return;const t=window.open("");t&&(t.document.write(`\n          <img src="${e.url}" style="max-width: 100%; height: auto;" \n               onload="this.style.marginTop = Math.max(0, (window.innerHeight - this.height) / 2) + 'px'"\n          />\n        `),t.document.head.innerHTML="<title>Image Preview</title>")}};return t.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[t.jsxs($,{className:"settings-card",children:[t.jsx(Je,{level:4,children:"Footer Content"}),t.jsx(et,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure the footer content and contact information"}),t.jsxs(q,{gutter:24,children:[t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"footerLogo",label:"Footer Logo",tooltip:"Upload your footer logo (recommended size: 200x200px, max 2MB)",children:t.jsx(Y,{...c,children:o.length<1&&t.jsxs("div",{children:[t.jsx(a,{}),t.jsx("div",{style:{marginTop:8},children:"Upload Logo"})]})})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"footerText",label:"Footer Text",rules:[{required:!0,message:"Please enter footer text"},{max:500,message:"Text cannot be longer than 500 characters"}],tooltip:"This text will appear in the footer section of your exhibition page",children:t.jsx(B.TextArea,{rows:4,placeholder:"Enter footer text",showCount:!0,maxLength:500})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"contactEmail",label:"Contact Email",rules:[{type:"email",message:"Please enter a valid email"},{max:100,message:"Email cannot be longer than 100 characters"}],children:t.jsx(B,{placeholder:"Enter contact email"})})}),t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"contactPhone",label:"Contact Phone",rules:[{pattern:/^[0-9-+()]*$/,message:"Please enter a valid phone number"},{max:20,message:"Phone number cannot be longer than 20 characters"}],children:t.jsx(B,{placeholder:"Enter contact phone number"})})})]})]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(Je,{level:4,children:"Footer Links"}),t.jsx(et,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Add useful links to the footer section"}),t.jsx(ue.List,{name:"footerLinks",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(q,{gutter:16,style:{marginBottom:"16px"},children:[t.jsx(L,{span:11,children:t.jsx(ue.Item,{...s,name:[i,"label"],rules:[{required:!0,message:"Please enter link label"}],children:t.jsx(B,{placeholder:"Link Label"})})}),t.jsx(L,{span:12,children:t.jsx(ue.Item,{...s,name:[i,"url"],rules:[{required:!0,message:"Please enter URL"},{type:"url",message:"Please enter a valid URL"}],children:t.jsx(B,{placeholder:"URL (e.g., https://example.com)"})})}),t.jsx(L,{span:1,style:{display:"flex",alignItems:"center"},children:t.jsx(n,{onClick:()=>a(i)})})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s(),block:!0,icon:t.jsx(i,{}),children:"Add Footer Link"})})]})})]})]})},{Title:nt,Text:it}=M,{TabPane:st}=Q,at=({form:e})=>t.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[t.jsxs(Q,{defaultActiveKey:"basic",type:"card",children:[t.jsx(st,{tab:"Basic Amenities",children:t.jsxs($,{className:"settings-card",children:[t.jsx(nt,{level:4,children:"Basic Amenities"}),t.jsx(it,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure basic amenities that are included with all stall bookings based on stall size"}),t.jsx(ue.List,{name:"basicAmenities",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(q,{gutter:16,style:{marginBottom:"16px"},children:[t.jsx(L,{span:5,children:t.jsx(ue.Item,{...s,name:[i,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:t.jsxs(H,{placeholder:"Select type",children:[t.jsx(H.Option,{value:"facility",children:"Facility"}),t.jsx(H.Option,{value:"service",children:"Service"}),t.jsx(H.Option,{value:"equipment",children:"Equipment"}),t.jsx(H.Option,{value:"other",children:"Other"})]})})}),t.jsx(L,{span:6,children:t.jsx(ue.Item,{...s,name:[i,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:t.jsx(B,{placeholder:"Enter name (e.g. Tables)"})})}),t.jsx(L,{span:6,children:t.jsx(ue.Item,{...s,name:[i,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:t.jsx(B.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),t.jsx(L,{span:3,children:t.jsx(ue.Item,{...s,name:[i,"perSqm"],label:t.jsxs(_,{children:["Per sqm",t.jsx(K,{title:"How many square meters per 1 unit (e.g., 1 table per 9 sqm)",children:t.jsx(l,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:t.jsx(W,{style:{width:"100%"},placeholder:"9",min:1})})}),t.jsx(L,{span:3,children:t.jsx(ue.Item,{...s,name:[i,"quantity"],label:t.jsxs(_,{children:["Quantity",t.jsx(K,{title:"Default quantity to provide (e.g., 1 table for every 9 sqm)",children:t.jsx(l,{})})]}),rules:[{required:!0,message:"Required"},{type:"number",min:1,message:"Must be ≥ 1"}],children:t.jsx(W,{style:{width:"100%"},placeholder:"1",min:1})})}),t.jsx(L,{span:1,style:{display:"flex",alignItems:"center",paddingTop:"10px"},children:t.jsx(n,{onClick:()=>a(i)})})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s({type:"equipment",perSqm:9,quantity:1}),block:!0,icon:t.jsx(i,{}),children:"Add Basic Amenity"})})]})})]})},"basic"),t.jsx(st,{tab:"Extra Amenities",children:t.jsxs($,{className:"settings-card",children:[t.jsx(nt,{level:4,children:"Extra Amenities"}),t.jsx(it,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Configure additional amenities and facilities available at your exhibition for an extra charge"}),t.jsx(ue.List,{name:"amenities",children:(e,{add:s,remove:a})=>t.jsxs(t.Fragment,{children:[e.map((({key:e,name:i,...s})=>t.jsxs(q,{gutter:16,style:{marginBottom:"16px"},children:[t.jsx(L,{span:5,children:t.jsx(ue.Item,{...s,name:[i,"type"],rules:[{required:!0,message:"Please select amenity type"}],children:t.jsxs(H,{placeholder:"Select type",children:[t.jsx(H.Option,{value:"facility",children:"Facility"}),t.jsx(H.Option,{value:"service",children:"Service"}),t.jsx(H.Option,{value:"equipment",children:"Equipment"}),t.jsx(H.Option,{value:"other",children:"Other"})]})})}),t.jsx(L,{span:6,children:t.jsx(ue.Item,{...s,name:[i,"name"],rules:[{required:!0,message:"Please enter amenity name"},{max:100,message:"Name cannot be longer than 100 characters"}],children:t.jsx(B,{placeholder:"Enter name (e.g. Power)"})})}),t.jsx(L,{span:8,children:t.jsx(ue.Item,{...s,name:[i,"description"],rules:[{required:!0,message:"Please enter amenity description"},{max:200,message:"Description cannot be longer than 200 characters"}],children:t.jsx(B.TextArea,{placeholder:"Describe the amenity",rows:2,showCount:!0,maxLength:200})})}),t.jsx(L,{span:4,children:t.jsx(ue.Item,{...s,name:[i,"rate"],rules:[{required:!0,message:"Please enter rate"},{type:"number",min:0,message:"Rate must be greater than or equal to 0"}],children:t.jsx(W,{style:{width:"100%"},placeholder:"Enter rate",prefix:"₹",min:0,formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>{const t=e?Number(e.replace(/₹\s?|(,*)/g,"")):0;return isNaN(t)?0:t}})})}),t.jsx(L,{span:1,style:{display:"flex",alignItems:"center"},children:t.jsx(n,{onClick:()=>a(i)})})]},e))),t.jsx(ue.Item,{children:t.jsx(ge,{type:"dashed",onClick:()=>s({type:"service"}),block:!0,icon:t.jsx(i,{}),children:"Add Extra Amenity"})})]})})]})},"extra")]}),t.jsxs($,{className:"settings-card",style:{marginTop:"24px"},children:[t.jsx(nt,{level:4,children:"Special Requirements"}),t.jsx(it,{type:"secondary",style:{marginBottom:"24px",display:"block"},children:"Specify any special requirements or accessibility features"}),t.jsx(q,{gutter:24,children:t.jsx(L,{span:24,children:t.jsx(ue.Item,{name:"specialRequirements",rules:[{max:1e3,message:"Requirements cannot be longer than 1000 characters"}],children:t.jsx(B.TextArea,{rows:4,placeholder:"Enter any special requirements or accessibility features",showCount:!0,maxLength:1e3})})})})]})]}),lt=({initialValues:e,onSubmit:n,submitText:i="Submit"})=>{const[s]=ue.useForm(),a=[{key:"general",label:"General",children:t.jsx(Xe,{form:s})},{key:"header",label:"Header",children:t.jsx(Ze,{form:s})},{key:"footer",label:"Footer",children:t.jsx(tt,{form:s})},{key:"amenities",label:"Amenities",children:t.jsx(at,{form:s})}];return t.jsx(ue,{form:s,layout:"vertical",initialValues:e,onFinish:e=>{n(e)},style:{height:"100%"},children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsx("div",{style:{flex:1,marginBottom:"24px"},children:t.jsx(Q,{defaultActiveKey:"general",items:a,type:"card"})}),t.jsx("div",{style:{textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:"24px"},children:t.jsx(ge,{type:"primary",htmlType:"submit",children:i})})]})})},ot=({width:e,height:n,scale:i=1,position:a={x:0,y:0},isSelected:l=!1,onSelect:o=()=>{},onChange:r=()=>{},children:d,isEditable:c=!0})=>{const h=s.useMemo((()=>{const s=[];for(let a=0;a<=e;a+=5)s.push(t.jsx(fe,{points:[a,0,a,n],stroke:"#e8e8e8",strokeWidth:1/i,dash:[5/i]},`v${a}`));for(let a=0;a<=n;a+=5)s.push(t.jsx(fe,{points:[0,a,e,a],stroke:"#e8e8e8",strokeWidth:1/i,dash:[5/i]},`h${a}`));return s}),[e,n,i]);return t.jsxs(ye,{x:a.x,y:a.y,width:e,height:n,onClick:e=>{c&&(o(),e.cancelBubble=!0)},children:[t.jsx(je,{width:e,height:n,fill:"#ffffff",stroke:l&&c?"#1890ff":"#d9d9d9",strokeWidth:l&&c?2/i:1/i,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:10/i,shadowOffset:{x:0,y:0},shadowOpacity:.5,cornerRadius:4/i}),t.jsx(ye,{children:h}),t.jsx(ve,{text:`${e}m × ${n}m`,fontSize:14/i,fill:"#666666",x:5,y:5}),d]})},rt=({visible:e,width:n,height:i,onCancel:a,onSubmit:l})=>{const[o]=ue.useForm();s.useEffect((()=>{e&&o.setFieldsValue({width:n,height:i})}),[e,n,i,o]);return t.jsx(be,{title:"Edit Exhibition Space",open:e,onCancel:()=>{o.resetFields(),a()},onOk:()=>{o.validateFields().then((e=>{l(e),o.resetFields()}))},destroyOnClose:!0,children:t.jsxs(ue,{form:o,layout:"vertical",initialValues:{width:n,height:i},children:[t.jsx(ue.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:10,message:"Width must be at least 10 meters"}],children:t.jsx(W,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter width in meters"})}),t.jsx(ue.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:10,message:"Height must be at least 10 meters"}],children:t.jsx(W,{min:10,max:1e3,style:{width:"100%"},placeholder:"Enter height in meters"})})]})})},dt=({hall:e,isSelected:n=!1,onSelect:i,onChange:a,scale:l=1,position:o={x:0,y:0},exhibitionWidth:r=100,exhibitionHeight:d=100,isStallMode:c=!1})=>{const h=s.useRef(null),x=s.useRef(null),m=s.useMemo((()=>{const n=[],{width:i,height:s}=e.dimensions;for(let e=0;e<=i;e+=1)n.push(t.jsx(fe,{points:[e,0,e,s],stroke:"#ddd",strokeWidth:1/l,dash:[2/l,2/l],listening:!1},`v${e}`));for(let e=0;e<=s;e+=1)n.push(t.jsx(fe,{points:[0,e,i,e],stroke:"#ddd",strokeWidth:1/l,dash:[2/l,2/l],listening:!1},`h${e}`));return n}),[e.dimensions.width,e.dimensions.height,l]);s.useEffect((()=>{var e;n&&x.current&&h.current&&(x.current.nodes([h.current]),null==(e=x.current.getLayer())||e.batchDraw())}),[n]);const p=t=>{t.cancelBubble=!0,null==i||i(e)};return t.jsxs(ye,{ref:h,x:e.dimensions.x,y:e.dimensions.y,width:e.dimensions.width,height:e.dimensions.height,draggable:!c&&!!a,onClick:p,onTap:p,onDragStart:e=>{e.cancelBubble=!0},onDragMove:t=>{t.cancelBubble=!0;const n=t.target,i=n.x(),s=n.y(),a=Math.max(0,Math.min(i,r-e.dimensions.width)),l=Math.max(0,Math.min(s,d-e.dimensions.height));n.x(Math.round(a)),n.y(Math.round(l))},onDragEnd:t=>{t.cancelBubble=!0;const n=t.target,i=Math.max(0,Math.min(n.x(),r-e.dimensions.width)),s=Math.max(0,Math.min(n.y(),d-e.dimensions.height));null==a||a({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{...e.dimensions,x:Math.round(i),y:Math.round(s)}})},onTransformEnd:t=>{if(!h.current)return;const n=h.current,i=n.scaleX(),s=n.scaleY();n.scaleX(1),n.scaleY(1);const l=Math.round(n.width()*i),o=Math.round(n.height()*s),c=n.x(),x=n.y(),m=Math.max(0,Math.min(c,r-l)),p=Math.max(0,Math.min(x,d-o));null==a||a({...e,_id:e._id,id:e.id||e._id,exhibitionId:e.exhibitionId,dimensions:{x:m,y:p,width:Math.max(5,Math.min(l,r-m)),height:Math.max(5,Math.min(o,d-p))}})},children:[t.jsx(je,{width:e.dimensions.width,height:e.dimensions.height,fill:"#ffffff",stroke:n?"#1890ff":"#d9d9d9",strokeWidth:n?2/l:1/l,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/l,shadowOffset:{x:2/l,y:2/l},shadowOpacity:.5}),t.jsx(ye,{children:m}),t.jsx(ve,{text:e.name,fontSize:14/l,fill:"#000000",width:e.dimensions.width,align:"center",y:e.dimensions.height/2-7/l})]})},ct=({fixture:n,isSelected:i=!1,onSelect:a,onChange:l,scale:o=1,position:r={x:0,y:0},exhibitionWidth:d=100,exhibitionHeight:c=100,isEditable:h=!0})=>{const x=s.useRef(null),m=s.useRef(null),[p,u]=e.useState("");e.useEffect((()=>{if(n.icon){const e=(e=>{if(!e)return"";const t=window.location.origin,n=e.replace(/^\/?(api\/uploads\/)?/,"");if(n.includes("fixtures/"))return`${t}/api/uploads/${n}`;const i=localStorage.getItem("token");return i?`${t}/api/uploads/${n}?token=${i}`:""})(n.icon);u(e)}else u("")}),[n.icon]);const[g]=we(p);s.useEffect((()=>{var e;i&&m.current&&x.current&&(m.current.nodes([x.current]),null==(e=m.current.getLayer())||e.batchDraw())}),[i]);const b=e=>{e.cancelBubble=!0,null==a||a(n)};return t.jsxs(t.Fragment,{children:[t.jsxs(ye,{ref:x,x:n.position.x,y:n.position.y,width:n.dimensions.width,height:n.dimensions.height,rotation:n.rotation||0,draggable:h&&!!l,onClick:b,onTap:b,onDragStart:e=>{e.cancelBubble=!0},onDragMove:e=>{e.cancelBubble=!0;const t=e.target,i=t.x(),s=t.y(),a=Math.max(0,Math.min(i,d-n.dimensions.width)),l=Math.max(0,Math.min(s,c-n.dimensions.height));t.x(Math.round(a)),t.y(Math.round(l))},onDragEnd:e=>{e.cancelBubble=!0;const t=e.target,i=t.x(),s=t.y(),a=Math.max(0,Math.min(i,d-n.dimensions.width)),o=Math.max(0,Math.min(s,c-n.dimensions.height)),r=n._id||n.id;null==l||l({...n,_id:r,id:r,exhibitionId:n.exhibitionId,position:{x:Math.round(a),y:Math.round(o)}})},onTransformEnd:e=>{if(!x.current)return;const t=x.current,i=t.scaleX(),s=t.scaleY(),a=t.rotation();t.scaleX(1),t.scaleY(1);const o=Math.round(n.dimensions.width*i),r=Math.round(n.dimensions.height*s),h=t.x(),m=t.y(),p=Math.max(0,Math.min(h,d-o)),u=Math.max(0,Math.min(m,c-r)),g=n._id||n.id;null==l||l({...n,_id:g,id:g,exhibitionId:n.exhibitionId,position:{x:p,y:u},dimensions:{width:Math.max(.5,Math.min(o,d-p)),height:Math.max(.5,Math.min(r,c-u))},rotation:a})},children:[(()=>{const e=n.borderColor||(i?"#1890ff":"#d9d9d9"),s=void 0!==n.borderRadius?n.borderRadius/o:3/o;return g?t.jsx(ke,{image:g,width:n.dimensions.width,height:n.dimensions.height,fill:n.color||"#ffffff",stroke:e,strokeWidth:i?2/o:1/o,cornerRadius:s,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/o,shadowOffset:{x:2/o,y:2/o},shadowOpacity:.5}):t.jsx(je,{width:n.dimensions.width,height:n.dimensions.height,fill:n.color||"#f0f2f5",stroke:e,strokeWidth:i?2/o:1/o,cornerRadius:s,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5/o,shadowOffset:{x:2/o,y:2/o},shadowOpacity:.5})})(),n.name&&!1!==n.showName&&t.jsx(ve,{text:n.name,fontSize:12/o,fill:"#000000",width:n.dimensions.width,align:"center",y:-16/o})]}),i&&h&&t.jsx(Se,{ref:m,rotateEnabled:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],boundBoxFunc:(e,t)=>t.width<.5||t.height<.5?e:t})]})},ht=({visible:e,x:n,y:i,onExhibitionClick:s,onHallClick:a,onStallClick:l,onFixtureClick:h,onClose:x})=>{if(!e)return null;const m=[{key:"exhibition",icon:t.jsx(o,{}),label:"Exhibition Space",onClick:()=>{s(),x()}},{key:"hall",icon:t.jsx(r,{}),label:"Add Hall",onClick:()=>{a(),x()}}];return l&&m.push({key:"stall",icon:t.jsx(d,{}),label:"Add Stall",onClick:()=>{l(),x()}}),h&&m.push({key:"fixture",icon:t.jsx(c,{}),label:"Add Fixture",onClick:()=>{h(),x()}}),t.jsx("div",{style:{position:"fixed",top:i,left:n,zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"4px",backgroundColor:"#fff",width:"200px"},children:t.jsx(Z,{items:m})})},xt=e.memo((({stall:n,isSelected:i=!1,onSelect:s,onChange:a,hallWidth:l=0,hallHeight:o=0,hallX:r=0,hallY:d=0,scale:c=1,isDragging:h=!1})=>{const x=e.useRef(null),[m,p]=e.useState(!1),[u,g]=e.useState(!1),[b,f]=e.useState(!1);e.useEffect((()=>{f(window.innerWidth<768);const e=()=>{f(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e.useEffect((()=>{if(m&&!h)g(!0);else{if(!h){const e=setTimeout((()=>{g(!1)}),100);return()=>clearTimeout(e)}g(!1)}}),[m,h]),e.useEffect((()=>{if(m&&x.current&&!h){if(b&&!i)return;x.current.getStage()&&x.current.moveToTop()}}),[m,i,b,h]);const y=i||n.isSelected,j=e.useCallback((e=>{switch(e){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}}),[]),v=e.useCallback((e=>{switch(e){case"available":return"rgba(82, 196, 26, 0.2)";case"booked":return"rgba(250, 173, 20, 0.2)";case"reserved":return"rgba(24, 144, 255, 0.2)";default:return"rgba(217, 217, 217, 0.2)"}}),[]),w=e.useCallback((e=>{e.cancelBubble=!0;const t=e.target,i=t.x()-r,s=t.y()-d,a=Math.max(0,Math.min(i,l-n.dimensions.width)),c=Math.max(0,Math.min(s,o-n.dimensions.height));t.x(Math.round(a+r)),t.y(Math.round(c+d))}),[r,d,l,o,n.dimensions.width,n.dimensions.height]),S=e.useCallback((e=>{if(e.cancelBubble=!0,!a)return;const t=e.target,i=t.x()-r,s=t.y()-d,c=Math.max(0,Math.min(i,l-n.dimensions.width)),h=Math.max(0,Math.min(s,o-n.dimensions.height));a({...n,id:n.id||n._id,_id:n._id||n.id,dimensions:{...n.dimensions,x:Math.round(c),y:Math.round(h)}})}),[a,r,d,l,o,n]),k=e.useCallback((e=>{e.cancelBubble=!0}),[]),C=e.useCallback((e=>{e.cancelBubble=!0,s&&!h&&s()}),[s,h]),I=e.useCallback((()=>{b&&!y||h||p(!0)}),[b,y,h]),N=e.useCallback((()=>{p(!1)}),[]),E=n.dimensions||{x:0,y:0,width:10,height:10},T=n.typeName||"Standard";n.ratePerSqm,E.width,E.height;const P=e.useMemo((()=>"available"!==n.status&&n.companyName?`${T} - ${E.width}×${E.height}m - ${n.companyName}`:`${T} - ${E.width}×${E.height}m`),[T,E.width,E.height,n.status,n.companyName]);return t.jsxs(ye,{ref:x,x:E.x+r,y:E.y+d,width:E.width,height:E.height,draggable:!!a,onClick:C,onTap:C,onDragStart:k,onDragMove:w,onDragEnd:S,opacity:"available"===n.status?1:.7,cursor:"available"===n.status?"pointer":"default",onMouseEnter:I,onMouseLeave:N,listening:!h&&(!b||"available"===n.status),transformsEnabled:h||b?"position":"all",children:[t.jsx(je,{width:E.width,height:E.height,fill:y?"rgba(24, 144, 255, 0.1)":v(n.status),stroke:y?"#1890ff":j(n.status),strokeWidth:y?2/c:1/c,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:h?0:b?2:3,shadowOffset:{x:1,y:1},shadowOpacity:h?0:.3,rotation:0,perfectDrawEnabled:!h,transformsEnabled:h?"position":"all",cornerRadius:.05}),t.jsx(ve,{text:n.number,fontSize:.25*Math.min(E.width,E.height),fill:"#000000",width:E.width,height:E.height,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!h,fontStyle:"bold",listening:!1}),y&&!h&&t.jsx(Ce,{x:E.width-2,y:2,radius:Math.min(.8,.05*E.width),fill:"#1890ff",stroke:"#ffffff",strokeWidth:.2/c,transformsEnabled:"position",listening:!1}),u&&!h&&t.jsxs(Ie,{x:E.width/2,y:0,opacity:1,listening:!1,children:[t.jsx(Ne,{fill:"rgba(0, 0, 0, 1.0)",cornerRadius:.5,pointerDirection:"down",pointerWidth:4,pointerHeight:2,lineJoin:"round",y:-7,listening:!1}),t.jsx(ve,{text:P,fontSize:1.2,fill:"#ffffff",align:"center",padding:2,y:-7,offsetY:0,width:Math.max(.7*P.length,25),height:3,verticalAlign:"middle",listening:!1})]})]})})),mt=({width:n,height:i,exhibitionWidth:a=100,exhibitionHeight:l=100,halls:o=[],stalls:r=[],fixtures:d=[],selectedHall:c=null,selectedFixture:m=null,onSelectHall:p=()=>{},onSelectFixture:u=()=>{},onHallChange:g=()=>{},onFixtureChange:b=()=>{},onExhibitionChange:f=()=>{},onAddHall:y=()=>{},onAddStall:j=()=>{},onAddFixture:v=()=>{},children:w,isStallMode:S=!1,isFixtureMode:k=!1,isPublicView:C=!1})=>{const I=e.useRef(null),N=e.useRef(null),E=e.useRef(null),[T,P]=e.useState(1),[A,D]=e.useState({x:0,y:0}),[R,F]=e.useState(!1),[z,$]=e.useState(!1),[M,q]=e.useState({visible:!1,x:0,y:0}),[L,B]=e.useState(!1),[V,H]=e.useState(!1),[W,U]=e.useState(!1),[O,Y]=e.useState(void 0);e.useEffect((()=>{const e=()=>{U(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const G=e.useCallback((e=>{if(e.evt.preventDefault(),!I.current)return;const t=I.current,n=T,i=t.getPointerPosition(),s=(i.x-t.x())/n,a=(i.y-t.y())/n,l=e.evt.deltaY<0?1.15*n:n/1.15,o=Math.min(Math.max(.1,l),20),r={x:i.x-s*o,y:i.y-a*o};P(o),D(r)}),[T]),X=e.useCallback((()=>{if(!I.current)return;const e=I.current,t=Math.min(1.15*T,20),n=e.width()/2,i=e.height()/2,s={x:n-(n-A.x)/T*t,y:i-(i-A.y)/T*t};P(t),D(s)}),[T,A]),Q=e.useCallback((()=>{if(!I.current)return;const e=I.current,t=Math.max(T/1.15,.1),n=e.width()/2,i=e.height()/2,s={x:n-(n-A.x)/T*t,y:i-(i-A.y)/T*t};P(t),D(s)}),[T,A]),K=e.useCallback((e=>{e?(Y(Ee.pixelRatio),Ee.pixelRatio=W?.8:1):O&&(Ee.pixelRatio=O)}),[O,W]),Z=e.useCallback((e=>{if(e.target===I.current&&(q({...M,visible:!1}),$(!0),K(!0),N.current)){if(C){const e=W?{x:-10,y:-10,width:n+20,height:i+20}:void 0;N.current.cache(e)}if(N.current.hitGraphEnabled(!1),C&&I.current){const e=I.current.container();e.style.cursor="grabbing",e.classList.add("dragging"),I.current.batchDraw();N.current.getChildren().forEach((e=>{if(e.shadowForStrokeEnabled&&(e._savedShadowForStroke=e.shadowForStrokeEnabled(),e.shadowForStrokeEnabled(!1)),e.perfectDrawEnabled&&(e._savedPerfectDraw=e.perfectDrawEnabled(),e.perfectDrawEnabled(!1)),e.cache&&!e.isCached&&e.width&&e.height){e._dragCached=!0;try{if(W){const t=10;e.cache({offset:t,pixelRatio:.8})}else e.cache()}catch(t){e._dragCached=!1}}}))}}}),[M,C,K,W,n,i]),J=e.useCallback((e=>{if(C&&e.target===I.current){if(e.evt&&e.evt._dragSkipUpdate)return;if(e.evt&&(e.evt._dragSkipUpdate=!0),I.current&&N.current){const e=W?.85:.7;Math.random()>e&&I.current.batchDraw()}}else e.target===I.current&&W&&N.current&&(e.cancelBubble=!0)}),[W,C]),ee=e.useCallback((e=>{if(e.target===I.current){if(D({x:e.target.x(),y:e.target.y()}),K(!1),N.current&&(N.current.hitGraphEnabled(!0),C&&N.current.clearCache(),C&&I.current)){const e=I.current.container();e.style.cursor="",e.classList.remove("dragging");N.current.getChildren().forEach((e=>{void 0!==e._savedShadowForStroke&&(e.shadowForStrokeEnabled(e._savedShadowForStroke),delete e._savedShadowForStroke),void 0!==e._savedPerfectDraw&&(e.perfectDrawEnabled(e._savedPerfectDraw),delete e._savedPerfectDraw),e._dragCached&&(e.clearCache(),delete e._dragCached)}))}setTimeout((()=>{I.current&&I.current.batchDraw()}),50),$(!1)}}),[C,K]),te=e.useCallback((()=>{F(!0),document.body.style.cursor=z?"grabbing":"grab"}),[z]),ne=e.useCallback((()=>{F(!1),document.body.style.cursor="default"}),[]),ie=e=>{if(!a||!l||!I.current)return!1;const{x:t,y:n}=e,{x:i,y:s}=I.current.position(),{x:o}=I.current.scale(),r=(t-i)/o,d=(n-s)/o;return r>=0&&r<=a&&d>=0&&d<=l},se=e.useCallback((()=>{p(null),u(null),B(!0),H(!0),q({...M,visible:!1})}),[p,u,M]),ae=e.useCallback((e=>{f(e),H(!1)}),[f]);e.useEffect((()=>{if(n>0&&i>0&&a>0&&l>0){const e=S?20:40,t=(n-2*e)/a,s=(i-2*e)/l,o=Math.min(t,s),r=(n-a*o)/2,d=(i-l*o)/2;P(o),D({x:r,y:d}),I.current&&I.current.batchDraw()}}),[n,i,a,l,S]);const le=s.Children.map(w,(e=>s.isValidElement(e)?s.cloneElement(e,{scale:T,position:A}):e)),oe=t.jsx(ot,{width:a,height:l,scale:T,position:{x:0,y:0},isSelected:!1,onSelect:void 0,onChange:void 0,isEditable:!1});return n<=0||i<=0||a<=0||l<=0?t.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa"},children:"Loading..."}):t.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#fafafa",cursor:R?z?"grabbing":"grab":"default"},children:[t.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1,display:"flex",gap:"8px"},children:t.jsxs(_,{style:{background:"rgba(255, 255, 255, 0.9)",padding:"8px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(8px)"},children:[t.jsx(ge,{icon:t.jsx(h,{}),onClick:Q,disabled:T<=.1,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}}),t.jsxs("div",{style:{padding:"0 8px",fontSize:"14px",color:"#666",userSelect:"none"},children:[Math.round(100*T),"%"]}),t.jsx(ge,{icon:t.jsx(x,{}),onClick:X,disabled:T>=20,style:{borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})]})}),t.jsxs(Te,{ref:I,width:n,height:i,onClick:e=>{var t,n,i;const s=e.target.getClassName();if("Stage"!==s&&"Layer"!==s)if("Group"===s||"Rect"===s){p(null),u(null);const e=null==(t=I.current)?void 0:t.getPointerPosition();if(e&&ie(e)){const{x:t,y:s}=e,{x:a,y:l}=(null==(n=I.current)?void 0:n.position())||{x:0,y:0},{x:o,y:r}=(null==(i=I.current)?void 0:i.scale())||{x:1,y:1};q({x:(t-a)/o,y:(s-l)/r,visible:!0})}else q({...M,visible:!1})}else q({...M,visible:!1});else q({...M,visible:!1})},draggable:!0,onDragStart:Z,onDragMove:J,onDragEnd:ee,onMouseEnter:te,onMouseLeave:ne,onWheel:G,x:A.x,y:A.y,scaleX:T,scaleY:T,perfectDrawEnabled:!z&&!C,hitGraphEnabled:!z,pixelRatio:z?W?.8:1:Math.min(1.5,window.devicePixelRatio||1),dragDistance:C?W?5:3:0,children:[C&&t.jsx(Pe,{ref:E,listening:!1,children:oe}),t.jsxs(Ae,{ref:N,imageSmoothingEnabled:!z||!C,children:[!C&&t.jsx(ot,{width:a,height:l,scale:T,position:{x:0,y:0},isSelected:L,onSelect:k?void 0:se,onChange:S||k?void 0:f,isEditable:!S&&!k}),o.map((e=>t.jsx(dt,{hall:e,isSelected:(null==c?void 0:c.id)===e.id,onSelect:()=>p(e),onChange:S||k?void 0:g,scale:T,position:{x:0,y:0},exhibitionWidth:a,exhibitionHeight:l,isStallMode:S||k},e._id||e.id))),r.map((e=>{const n=e._id||e.id,i=o.find((t=>t.id===e.hallId||t._id===e.hallId));return i?t.jsx(xt,{stall:{...e,_id:n,id:n},hallX:i.dimensions.x,hallY:i.dimensions.y,hallWidth:i.dimensions.width,hallHeight:i.dimensions.height,scale:T,isDragging:z&&C},n):null})),d.map((e=>{const n=e._id||e.id,i=((null==m?void 0:m._id)||(null==m?void 0:m.id))===n;return t.jsx(ct,{fixture:{...e,_id:n,id:n},isSelected:i,onSelect:()=>u(e),onChange:k?b:void 0,scale:T,position:{x:0,y:0},exhibitionWidth:a,exhibitionHeight:l,isEditable:k},n)})),le]})]}),t.jsx(ht,{visible:M.visible,x:M.x,y:M.y,onExhibitionClick:()=>{B(!0),H(!0),q({...M,visible:!1})},onHallClick:()=>{y(),q({...M,visible:!1})},onStallClick:()=>{j(),q({...M,visible:!1})},onClose:()=>q({...M,visible:!1})}),t.jsx(rt,{visible:V,width:a,height:l,onCancel:()=>H(!1),onSubmit:ae})]})},pt=({visible:e,hall:n,exhibitionWidth:i,exhibitionHeight:a,onCancel:l,onSubmit:o,onDelete:r})=>{const[d]=ue.useForm();s.useEffect((()=>{e&&(n?d.setFieldsValue({name:n.name,width:n.dimensions.width,height:n.dimensions.height}):d.setFieldsValue({name:"",width:Math.min(10,i),height:Math.min(10,a)}))}),[e,n,i,a,d]);return t.jsx(be,{title:n?"Edit Hall":"Add New Hall",open:e,onCancel:()=>{d.resetFields(),l()},footer:null,width:400,destroyOnClose:!0,className:"hall-form-modal",children:t.jsxs(ue,{form:d,layout:"vertical",style:{marginTop:"16px"},children:[t.jsx(ue.Item,{name:"name",label:t.jsxs("span",{style:{color:"#000"},children:["Hall Name ",t.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter hall name"}],children:t.jsx(B,{placeholder:"Enter hall name"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsx(ue.Item,{name:"width",label:t.jsxs("span",{style:{color:"#000"},children:["Width (meters) ",t.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter width"},{type:"number",min:5,message:"Width must be at least 5 meters"},{type:"number",max:i,message:`Width cannot exceed ${i} meters`}],children:t.jsx(W,{min:5,max:i,style:{width:"100%"},placeholder:"Enter width"})}),t.jsx(ue.Item,{name:"height",label:t.jsxs("span",{style:{color:"#000"},children:["Height (meters) ",t.jsx("span",{style:{color:"#ff4d4f"},children:"*"})]}),rules:[{required:!0,message:"Please enter height"},{type:"number",min:5,message:"Height must be at least 5 meters"},{type:"number",max:a,message:`Height cannot exceed ${a} meters`}],children:t.jsx(W,{min:5,max:a,style:{width:"100%"},placeholder:"Enter height"})})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"32px",gap:"8px"},children:[t.jsx(_,{children:n&&r&&t.jsx(ge,{className:"delete-button",icon:t.jsx(m,{}),onClick:()=>{n&&r&&be.confirm({title:"Delete Hall",content:`Are you sure you want to delete hall "${n.name}"? This action cannot be undone.`,okText:"Yes, Delete",cancelText:"No, Cancel",okButtonProps:{className:"confirm-delete-button"},centered:!0,onOk:()=>r(n)})},children:"Delete Hall"})}),t.jsxs(_,{children:[t.jsx(ge,{onClick:()=>{d.resetFields(),l()},children:"Cancel"}),t.jsx(ge,{type:"primary",onClick:async()=>{var e,t;const i=await d.validateFields(),s=n?{...n,_id:n._id,id:n.id||n._id,name:i.name,dimensions:{x:(null==(e=n.dimensions)?void 0:e.x)||0,y:(null==(t=n.dimensions)?void 0:t.y)||0,width:i.width,height:i.height},exhibitionId:n.exhibitionId}:{name:i.name,dimensions:{x:0,y:0,width:i.width,height:i.height}};o(s),d.resetFields()},className:"update-button",children:n?"Update Hall":"Create Hall"})]})]})]})})},{Title:ut}=M,gt=({visible:n,stall:i,hall:s,exhibition:a,onCancel:l,onSubmit:o,onDelete:r})=>{const[c]=ue.useForm(),[h,x]=e.useState([]),[p,u]=e.useState(!1);e.useEffect((()=>{if(i){const e={number:i.number,stallTypeId:i.stallTypeId,width:i.dimensions.width,height:i.dimensions.height,ratePerSqm:i.ratePerSqm,status:i.status};c.setFieldsValue(e)}else s&&!c.getFieldValue("status")&&c.setFieldsValue({status:"available",width:Math.min(20,s.dimensions.width/4),height:Math.min(20,s.dimensions.height/4),ratePerSqm:0})}),[i,s,c]),e.useEffect((()=>{n&&(async()=>{var e;try{u(!0);const t=await D.getStallTypes(),n=(null==(e=a.stallRates)?void 0:e.map((e=>e.stallTypeId)))||[],i=t.data.filter((e=>"active"===e.status&&e._id&&n.includes(e._id)));x(i)}catch(t){}finally{u(!1)}})()}),[n,a.stallRates]);const g=()=>{c.resetFields(),l()},b=e=>{switch(e){case"available":return"#52c41a";case"booked":return"#faad14";case"reserved":return"#1890ff";default:return"#d9d9d9"}};return t.jsx(t.Fragment,{children:t.jsx(be,{title:t.jsxs(_,{children:[t.jsx(d,{style:{fontSize:"20px"}}),t.jsx(ut,{level:4,style:{margin:0},children:i?"Edit Stall":"Add Stall"})]}),open:n,onCancel:g,destroyOnClose:!0,forceRender:!0,width:480,centered:!0,footer:[t.jsxs(_,{size:"middle",children:[i&&r&&t.jsx(ge,{danger:!0,icon:t.jsx(m,{}),onClick:()=>r(i),children:"Delete"}),t.jsx(ge,{onClick:g,children:"Cancel"}),t.jsx(ge,{type:"primary",onClick:()=>{s&&(s._id||s.id)?c.validateFields().then((e=>{var t;const n=s._id||s.id;if(!n)return void J.error("Hall ID is missing. Please select a hall again.");const l=i?{x:i.dimensions.x,y:i.dimensions.y}:((e,t,n,i,s)=>{const a=[...n].sort(((e,t)=>Math.floor(e.dimensions.y/5)===Math.floor(t.dimensions.y/5)?e.dimensions.x-t.dimensions.x:e.dimensions.y-t.dimensions.y)),l=(n,l)=>!(n+e>i||l+t>s||a.some((i=>{const s=i.dimensions.x,a=i.dimensions.y,o=i.dimensions.width,r=i.dimensions.height;return!(n+e+1<=s||n>=s+o+1||l+t+1<=a||l>=a+r+1)})));for(const o of a){const e=o.dimensions.x+o.dimensions.width+1,t=o.dimensions.y;if(l(e,t))return{x:e,y:t};const n=o.dimensions.x,i=o.dimensions.y+o.dimensions.height+1;if(l(n,i))return{x:n,y:i}}for(let o=0;o<s;o+=5)for(let e=0;e<i;e+=5)if(l(e,o))return{x:e,y:o};return{x:0,y:0}})(e.width,e.height,(null==(t=a.stalls)?void 0:t.filter((e=>e.hallId===n)))||[],s.dimensions.width,s.dimensions.height),r={id:null==i?void 0:i.id,_id:null==i?void 0:i._id,number:e.number,stallTypeId:e.stallTypeId,dimensions:{x:l.x,y:l.y,width:e.width,height:e.height},ratePerSqm:e.ratePerSqm,status:e.status,hallId:n};o(r)})):J.error("Invalid hall selected. Please try again.")},children:i?"Save Changes":"Create"})]},"footer-buttons")],children:t.jsxs(ue,{form:c,layout:"vertical",preserve:!1,requiredMark:"optional",style:{padding:"12px 0"},children:[t.jsx(ue.Item,{name:"number",label:"Stall Number",rules:[{required:!0,message:"Please enter stall number"}],children:t.jsx(B,{placeholder:"Enter stall number",size:"large",style:{borderRadius:"6px"}})}),t.jsx(ue.Item,{name:"stallTypeId",label:"Stall Type",rules:[{required:!0,message:"Please select stall type"}],children:t.jsx(H,{loading:p,placeholder:"Select stall type",size:"large",onChange:e=>{var t;const n=null==(t=a.stallRates)?void 0:t.find((t=>t.stallTypeId===e));n&&c.setFieldsValue({ratePerSqm:n.rate})},children:h.map((e=>t.jsx(H.Option,{value:e._id,children:e.name},e._id)))})}),t.jsx(X,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Dimensions"}),t.jsxs(_,{style:{width:"100%",gap:"16px"},children:[t.jsx(ue.Item,{name:"width",label:"Width (meters)",rules:[{required:!0,message:"Please enter width"},{type:"number",min:1,message:"Width must be at least 1 meter"},{type:"number",max:(null==s?void 0:s.dimensions.width)||100,message:"Width cannot exceed hall width"}],style:{flex:1},children:t.jsx(W,{min:1,max:(null==s?void 0:s.dimensions.width)||100,style:{width:"100%"},size:"large",placeholder:"Width",addonAfter:"m"})}),t.jsx(ue.Item,{name:"height",label:"Height (meters)",rules:[{required:!0,message:"Please enter height"},{type:"number",min:1,message:"Height must be at least 1 meter"},{type:"number",max:(null==s?void 0:s.dimensions.height)||100,message:"Height cannot exceed hall height"}],style:{flex:1},children:t.jsx(W,{min:1,max:(null==s?void 0:s.dimensions.height)||100,style:{width:"100%"},size:"large",placeholder:"Height",addonAfter:"m"})})]}),t.jsx(X,{orientation:"left",plain:!0,style:{margin:"24px 0"},children:"Details"}),t.jsx(ue.Item,{name:"ratePerSqm",label:"Rate per sq.m (₹)",rules:[{required:!0,message:"Please select a stall type to set the rate"}],children:t.jsx(W,{min:0,style:{width:"100%"},size:"large",placeholder:"Rate will be set based on stall type",prefix:"₹",disabled:!0,formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>{const t=e?Number(e.replace(/₹\s?|(,*)/g,"")):0;return isNaN(t)?0:t}})}),t.jsx(ue.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:t.jsxs(H,{placeholder:"Select status",size:"large",style:{borderRadius:"6px"},children:[t.jsx(H.Option,{value:"available",children:t.jsxs(_,{children:[t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:b("available")}}),"Available"]})}),t.jsx(H.Option,{value:"booked",children:t.jsxs(_,{children:[t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:b("booked")}}),"Booked"]})}),t.jsx(H.Option,{value:"reserved",children:t.jsxs(_,{children:[t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:b("reserved")}}),"Reserved"]})})]})})]})})})},bt=({name:n,type:i,color:s,rotation:a,showName:l,iconUrl:o,defaultIcons:r,borderColor:d=null,borderRadius:c=0})=>{e.useEffect((()=>{}),[n,i,s,a,l,o,r,d,c]);const h=r[i]||"📦";return t.jsxs("div",{style:{padding:"24px",textAlign:"center",backgroundColor:"#fafafa",borderBottom:"1px solid #f0f0f0",borderRadius:"8px 8px 0 0"},children:[t.jsx("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"120px",height:"120px",borderRadius:`${c||4}px`,backgroundColor:s||"#f0f0f0",transform:`rotate(${a}deg)`,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden",position:"relative",border:d?`1px solid ${d}`:"1px solid rgba(0,0,0,0.05)"},children:o?t.jsx("img",{src:o,alt:n,style:{width:"100%",height:"100%",objectFit:"contain",padding:"8px"}}):t.jsx("div",{style:{fontSize:"48px",lineHeight:"1",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:h})}),l&&t.jsx("div",{style:{marginTop:"12px",fontSize:"16px",fontWeight:500,color:"#333"},children:n}),t.jsxs("div",{style:{marginTop:"4px",fontSize:"14px",color:"#888",display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[t.jsx("span",{children:i.charAt(0).toUpperCase()+i.slice(1)}),t.jsx("span",{children:"•"}),t.jsx("span",{children:s}),a>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{children:[a,"°"]})]}),d&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Border: ",d]})]}),c>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Radius: ",c,"px"]})]})]})]})},{Text:ft}=M,yt=({activeKey:e,form:n,fixture:i,exhibitionWidth:s,exhibitionHeight:a,selectedType:o,showName:r,iconFileList:d,fixtureTypes:c,fixtureIcons:h,defaultColors:x,defaultDimensions:m,colorPresets:p,uploadProps:f,iconPreviewVisible:y=!1,previewImage:j="",onTypeChange:v,onColorChange:w,onShowNameChange:S,onIconPreviewCancel:k=()=>{}})=>{switch(e){case"basic":default:return C();case"position":return t.jsxs("div",{className:"tab-content",children:[t.jsx($,{size:"small",title:"Position (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:t.jsxs(q,{gutter:16,children:[t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:["position","x"],label:"X Position",rules:[{required:!0,message:"X position is required"}],children:t.jsx(W,{style:{width:"100%",borderRadius:"8px"},min:0,max:s,step:.1,precision:1,placeholder:"X position"})})}),t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:["position","y"],label:"Y Position",rules:[{required:!0,message:"Y position is required"}],children:t.jsx(W,{style:{width:"100%",borderRadius:"8px"},min:0,max:a,step:.1,precision:1,placeholder:"Y position"})})})]})}),t.jsx($,{size:"small",title:"Dimensions (meters)",style:{marginBottom:16,borderRadius:8},styles:{body:{padding:"12px 16px"}},children:t.jsxs(q,{gutter:16,children:[t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:["dimensions","width"],label:"Width",rules:[{required:!0,message:"Width is required"}],children:t.jsx(W,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Width"})})}),t.jsx(L,{span:12,children:t.jsx(ue.Item,{name:["dimensions","height"],label:"Height",rules:[{required:!0,message:"Height is required"}],children:t.jsx(W,{style:{width:"100%",borderRadius:"8px"},min:.5,max:20,step:.1,precision:1,placeholder:"Height"})})})]})}),t.jsx($,{size:"small",title:t.jsxs("span",{children:[t.jsx(u,{})," Rotation (degrees)"]}),style:{borderRadius:8},styles:{body:{padding:"12px 16px"}},children:t.jsx(ue.Item,{name:"rotation",noStyle:!0,children:t.jsx(ee,{min:0,max:360,marks:{0:"0°",90:"90°",180:"180°",270:"270°",360:"360°"},tooltip:{formatter:e=>`${e}°`},style:{marginTop:10},keyboard:!1})})})]});case"appearance":return t.jsxs("div",{className:"tab-content",children:[t.jsx(ue.Item,{name:"color",label:"Color",tooltip:"Choose a color for the fixture. This affects the background color and tint applied to SVG icons.",rules:[{validator:(e,t)=>{try{return t?Promise.resolve():Promise.reject("Please select a color")}catch(n){return Promise.reject("Please enter a valid color value")}}}],children:t.jsx(te,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:p,onChange:w,style:{width:"100%"}})}),t.jsx(ue.Item,{name:"borderColor",label:"Border Color",tooltip:"Choose a border color for the fixture. Leave empty for default borders.",children:t.jsx(te,{format:"hex",allowClear:!0,showText:!0,disabledAlpha:!0,presets:p,style:{width:"100%"}})}),t.jsx(ue.Item,{name:"borderRadius",label:"Border Radius",tooltip:"Set the corner radius in pixels. Higher values make more rounded corners.",children:t.jsx(W,{min:0,max:20,step:1,style:{width:"100%",borderRadius:"8px"},addonAfter:"px"})}),t.jsxs($,{size:"small",title:"Icon Upload",style:{borderRadius:8,marginBottom:16,marginTop:16},styles:{body:{padding:"16px"}},children:[t.jsx("div",{style:{marginBottom:0},children:t.jsx(Y,{...f,children:d.length<1&&t.jsxs("div",{children:[t.jsx(g,{style:{fontSize:20}}),t.jsx("div",{style:{marginTop:8},children:"Upload Icon"})]})})}),t.jsx(ft,{type:"secondary",style:{display:"block",marginTop:12},children:"Upload a custom icon or use the default icon for the selected fixture type. Supported formats: PNG, JPG, SVG. SVG icons are preferred for better quality at all sizes."})]}),t.jsx(ue.Item,{name:"icon",label:"Icon URL",tooltip:"URL to an icon image for this fixture. Will be used if no icon is uploaded.",children:t.jsx(B,{placeholder:"https://example.com/icon.png",prefix:t.jsx(b,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),t.jsx(be,{open:y,title:"Icon Preview",footer:null,onCancel:k,children:t.jsx("img",{alt:"Icon Preview",style:{width:"100%"},src:j})})]})}function C(){return t.jsxs("div",{className:"tab-content",children:[t.jsx(ue.Item,{name:"name",label:"Fixture Name",rules:[{required:!0,message:"Please enter fixture name"}],children:t.jsx(B,{placeholder:"Enter fixture name",prefix:t.jsx(l,{style:{color:"#aaa"}}),style:{borderRadius:"8px"}})}),t.jsx(ue.Item,{name:"showName",label:"Show Name on Layout",tooltip:"Toggle whether the fixture name appears on the layout",valuePropName:"checked",children:t.jsx(U,{defaultChecked:!0,checkedChildren:"Visible",unCheckedChildren:"Hidden",onChange:e=>{S(e)}})}),t.jsx(ue.Item,{name:"type",label:"Fixture Type",rules:[{required:!0,message:"Please select fixture type"}],children:t.jsx(H,{placeholder:"Select fixture type",onChange:v,options:c.map((e=>({...e,label:t.jsxs(_,{children:[t.jsx("span",{style:{fontSize:16},children:h[e.value]}),t.jsx("span",{children:e.label})]})}))),style:{width:"100%",borderRadius:"8px"},listHeight:300,dropdownStyle:{borderRadius:"8px"}})})]})}},{Text:jt,Title:vt}=M,{TabPane:wt}=Q,St=[{value:"sofa",label:"Sofa"},{value:"chair",label:"Chair"},{value:"table",label:"Table"},{value:"desk",label:"Desk"},{value:"plant",label:"Plant"},{value:"entrance",label:"Entrance"},{value:"exit",label:"Exit"},{value:"info",label:"Information"},{value:"restroom",label:"Restroom"},{value:"food",label:"Food Area"},{value:"custom",label:"Custom"}],kt={sofa:{width:2,height:1},chair:{width:5,height:5},table:{width:1,height:1},desk:{width:2,height:.8},plant:{width:.5,height:.5},entrance:{width:1.5,height:.2},exit:{width:1.5,height:.2},info:{width:1,height:1},restroom:{width:1,height:1},food:{width:2,height:2},custom:{width:1,height:1}},Ct={sofa:"#a0d0ff",chair:"#a0d0ff",table:"#e0e0e0",desk:"#e0e0e0",plant:"#90ee90",entrance:"#98fb98",exit:"#ffcccb",info:"#add8e6",restroom:"#d8bfd8",food:"#ffe4b5",custom:"#f0f0f0"},It={sofa:"🛋️",chair:"🪑",table:"🪟",desk:"🖥️",plant:"🪴",entrance:"🚪",exit:"🚪",info:"ℹ️",restroom:"🚻",food:"🍽️",custom:"📦"},Nt=({visible:n,fixture:i,onCancel:l,onSubmit:o,onDelete:d,exhibitionWidth:c,exhibitionHeight:h})=>{const[x]=ue.useForm(),[u,g]=e.useState(!1),[b,j]=e.useState(""),[v,w]=e.useState("basic"),[S,k]=e.useState(""),[C,I]=e.useState([]),[N,E]=e.useState(!1),[T,P]=e.useState(""),{message:A}=O.useApp(),[D,z]=e.useState("#f0f0f0"),[$,M]=e.useState("New Fixture"),[q,L]=e.useState("chair"),[B,V]=e.useState(0),[_,H]=e.useState(!0),[W,U]=e.useState(null),[Y,G]=e.useState(0);e.useEffect((()=>{if(n)if(i){const e=Z(i.color),t=Ct[i.type]||"#f0f0f0";z(e||t),M(i.name),L(i.type),V(i.rotation||0),j(i.type),H(!1!==i.showName),U(i.borderColor||null),G(i.borderRadius||0)}else{const e="chair";z(Ct[e]),M("New Fixture"),L(e),V(0),j(e),H(!0),U(null),G(0)}}),[n,i]),e.useEffect((()=>{if(n&&x){if(i){const e=Z(i.color),t=Ct[i.type]||"#f0f0f0",n=e||t;x.setFieldsValue({name:i.name,type:i.type,position:{x:i.position.x,y:i.position.y},dimensions:{width:i.dimensions.width,height:i.dimensions.height},rotation:i.rotation||0,color:n,icon:i.icon||"",showName:!1!==i.showName,borderColor:i.borderColor||null,borderRadius:i.borderRadius||0});const s=i.icon?F(i.icon):"";k(s),i.icon?I([{uid:"-1",name:i.icon.split("/").pop()||"icon",status:"done",url:s,thumbUrl:s}]):I([])}else{const e="chair",t=Ct[e];x.setFieldsValue({name:"New Fixture",type:e,position:{x:Math.floor(c/2),y:Math.floor(h/2)},dimensions:kt[e],rotation:0,color:t,icon:"",showName:!0,borderColor:null,borderRadius:0}),k(""),I([])}w("basic")}}),[n,i,x,c,h]);const X=()=>{if(x&&n)try{const e=x.getFieldsValue(!0);if(e.name&&M(e.name),e.type&&L(e.type),void 0!==e.rotation&&V(e.rotation),e.color){const t=Z(e.color);t&&z(t)}if(void 0!==e.showName&&H(e.showName),void 0!==e.borderColor){const t=e.borderColor?Z(e.borderColor):null;U(t)}void 0!==e.borderRadius&&G(e.borderRadius)}catch(e){}};e.useEffect((()=>{if(x&&n)return x.getFieldsValue,X(),()=>{}}),[x,n]);const K={name:"file",action:`${R.defaults.baseURL}/fixtures/upload/icons`,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},accept:"image/png,image/jpeg,image/jpg,image/svg+xml",listType:"picture-card",fileList:C,onChange:({file:e,fileList:t})=>{var n;if("uploading"===e.status&&I(t),"done"===e.status){A.success(`${e.name} uploaded successfully`);let i=((null==(n=e.response)?void 0:n.url)||"").replace(/^\/api\/uploads\//,"");i&&!i.startsWith("fixtures/")&&(i=`fixtures/${i.replace(/^\//,"")}`),x.setFieldValue("icon",i);const s=F(i);k(s);const a=e.name.toLowerCase().endsWith(".svg"),l=t.map((t=>t.uid===e.uid?{...t,url:s,thumbUrl:s,type:a?"image/svg+xml":t.type}:t));I(l)}"error"===e.status&&(A.error(`${e.name} upload failed.`),I(t.filter((t=>t.uid!==e.uid))))},onPreview:e=>{P(e.url||e.thumbUrl||""),E(!0)},onRemove:()=>(k(""),I([]),x.setFieldValue("icon",""),!0),maxCount:1,showUploadList:{showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!1,removeIcon:t.jsx(m,{style:{color:"#ff4d4f"}})}},Z=e=>{try{if(!e)return"#f0f0f0";if("object"==typeof e&&null!==e){if("function"==typeof e.toHexString)return e.toHexString();if(e.rgb||e.hex)return e.hex||`rgb(${e.rgb.r},${e.rgb.g},${e.rgb.b})`}if("string"==typeof e){if(/^#([0-9A-F]{3}){1,2}$/i.test(e))return e;if(/^([0-9A-F]{3}){1,2}$/i.test(e))return`#${e}`;if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/.test(e))return e}return"#f0f0f0"}catch(t){return"#f0f0f0"}},J=s.useCallback((()=>{i&&d&&d(i)}),[i,d]),ee=(te={form:x,fixture:i,exhibitionWidth:c,exhibitionHeight:h,selectedType:b,showName:_,iconFileList:C,fixtureTypes:St,fixtureIcons:It,defaultColors:Ct,defaultDimensions:kt,colorPresets:[{label:"Primary Colors",colors:["#1890ff","#52c41a","#faad14","#f5222d","#722ed1"]},{label:"Neutrals",colors:["#000000","#262626","#595959","#8c8c8c","#bfbfbf","#d9d9d9","#f0f0f0","#ffffff"]}],uploadProps:K,iconPreviewVisible:N,previewImage:T,onTypeChange:e=>{if(j(e),L(e),!i){const t=Ct[e]||Ct.custom;x.setFieldsValue({dimensions:kt[e]||kt.custom,color:t}),z(t)}},onColorChange:e=>{const t=Z(e);x.setFieldValue("color",t),z(t);const n=Object.entries(Ct).find((([e,n])=>n.toLowerCase()===t.toLowerCase()));n&&!i&&(x.setFieldValue("type",n[0]),j(n[0]),L(n[0]))},onShowNameChange:e=>H(e),onIconPreviewCancel:()=>E(!1),activeKey:v},[{key:"basic",label:t.jsxs("span",{children:[t.jsx(r,{}),"Basic Info"]}),children:t.jsx(yt,{...te,activeKey:"basic"})},{key:"position",label:t.jsxs("span",{children:[t.jsx(p,{}),"Position"]}),children:t.jsx(yt,{...te,activeKey:"position"})},{key:"appearance",label:t.jsxs("span",{children:[t.jsx(a,{}),"Appearance"]}),children:t.jsx(yt,{...te,activeKey:"appearance"})}]);var te;const ne=e=>{if(!e)return"";if("string"!=typeof e)return"";if(e.startsWith("fixtures/")&&!e.includes("?")&&!e.includes("http"))return e;let t=e.replace(/^\/api\/uploads\//,"");if(t=t.replace(/^\//,""),t.includes("?")||t.includes("http")){const e=t.split("?")[0].split("/").pop()||"";if(e)return`fixtures/${e}`}return t&&!t.startsWith("fixtures/")?`fixtures/${t}`:t};return t.jsxs(be,{title:t.jsxs("div",{style:{padding:"8px 0",display:"flex",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:24,marginRight:8},children:i?It[i.type]:"🪑"}),t.jsx("span",{children:i?`Edit ${i.name}`:"Add New Fixture"})]}),open:n,onCancel:l,confirmLoading:u,footer:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{children:i&&d&&t.jsx(ge,{danger:!0,icon:t.jsx(m,{}),onClick:J,style:{borderRadius:"6px"},children:"Delete"})}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx(ge,{onClick:l,icon:t.jsx(f,{}),style:{borderRadius:"6px"},children:"Cancel"}),t.jsx(ge,{type:"primary",onClick:async()=>{try{g(!0);const e=await x.validateFields();M(e.name),L(e.type),V(e.rotation||0),z(Z(e.color)),H(e.showName),U(e.borderColor?Z(e.borderColor):null),G(e.borderRadius||0);let t="";e.icon?t=ne(e.icon):(null==i?void 0:i.icon)&&(t=i.icon);const n=(null==i?void 0:i._id)||(null==i?void 0:i.id)||"",s=e.color?Z(e.color):(null==i?void 0:i.color)||"#f0f0f0",a=e.borderColor?Z(e.borderColor):null,r={...i,id:n,_id:n,name:e.name,type:e.type,position:e.position,dimensions:e.dimensions,rotation:e.rotation,color:s,icon:t,zIndex:(null==i?void 0:i.zIndex)||1,isActive:void 0===(null==i?void 0:i.isActive)||i.isActive,borderColor:a,borderRadius:e.borderRadius||0};n&&(r.showName=e.showName),await o(r),l()}catch(e){A.error("Failed to save fixture. Please check the form and try again.")}finally{g(!1)}},icon:t.jsx(y,{}),style:{borderRadius:"6px"},children:i?"Update":"Create"})]})]}),width:560,centered:!0,styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{backgroundColor:"#fff",borderRadius:"0 0 8px 8px",padding:"0"},footer:{borderTop:"1px solid #f0f0f0",padding:"12px 24px",margin:0}},children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"\n        .svg-icon {\n          filter: drop-shadow(0px 1px 2px rgba(0,0,0,0.2));\n        }\n        \n        /* Fix for passive event listener warnings */\n        .ant-slider, .ant-slider-handle, .ant-color-picker-trigger, .ant-color-picker-dropdown {\n          touch-action: none !important;\n        }\n        \n        .ant-slider-rail, .ant-slider-track {\n          touch-action: pan-y !important;\n        }\n        \n        .ant-tabs-tab, .ant-select-selector, .ant-input-number-input, .ant-color-picker-slider, .ant-color-picker-palette {\n          touch-action: manipulation !important;\n        }\n        \n        /* Fix circular references warning */\n        .ant-color-picker-trigger-disabled .ant-color-picker-clear {\n          display: none;\n        }\n      "}}),t.jsx(bt,{name:$,type:q,color:D,rotation:B,showName:_,iconUrl:S,defaultIcons:It,borderColor:W,borderRadius:Y}),t.jsx(ue,{form:x,layout:"vertical",initialValues:{name:"New Fixture",type:"chair",position:{x:0,y:0},dimensions:{width:1,height:1},rotation:0,color:"#f0f0f0",icon:"",showName:!0,borderColor:null,borderRadius:0},style:{padding:"0 24px 20px"},onValuesChange:X,children:t.jsx(Q,{activeKey:v,onChange:e=>{w(e),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},items:ee,tabBarStyle:{marginBottom:16},centered:!0})})]})},Et=Le(be)`
  .ant-modal-content {
    padding: 0;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  .ant-modal-header {
    padding: 24px 32px;
    margin: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    background: linear-gradient(to right, #4b47b9, #3f51b5);
    
    .ant-modal-title {
      color: white;
      font-weight: 600;
      font-size: 18px;
    }
  }
  .ant-modal-body {
    padding: 0;
  }
  .ant-modal-close {
    color: white;
  }
`,Tt=Le.div`
  display: flex;
  border-bottom: 1px solid #eee;
  background-color: #f9f9fa;
  margin-bottom: 24px;
  
  .step-item {
    padding: 16px 24px;
    position: relative;
    display: flex;
    align-items: center;
    font-size: 15px;
    color: #666;
    gap: 10px;
    
    &.active {
      color: #4b47b9;
      font-weight: 500;
      
      &:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: #4b47b9;
      }
      
      .step-icon {
        background-color: #4b47b9;
        color: white;
      }
    }
    
    &.completed {
      .step-icon {
        background-color: #52c41a;
        color: white;
      }
    }
    
    .step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
`,Pt=Le.div`
  padding: 24px 32px 32px;
`,At=Le.h2`
  font-size: 24px;
  font-weight: 600;
  color: #1f1f1f;
  margin-bottom: 8px;
`,Dt=Le.p`
  font-size: 14px;
  color: #666;
  margin-bottom: 24px;
`;Le.div`
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  
  .search-input {
    width: 240px;
    border-radius: 8px;
  }
  
  .filter-select {
    width: 160px;
    border-radius: 8px;
  }
`,Le.div`
  margin-bottom: 24px;
  
  .tab-header {
    display: flex;
    margin-bottom: 24px;
    border-bottom: 1px solid #f0f0f0;
    
    .tab-item {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      
      &.active {
        color: #4b47b9;
        
        &:after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #4b47b9;
          border-radius: 2px 2px 0 0;
        }
      }
      
      .badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        color: #666;
        font-size: 12px;
        height: 20px;
        min-width: 20px;
        padding: 0 8px;
        border-radius: 10px;
        margin-left: 8px;
        
        &.active {
          background: #4b47b9;
          color: white;
        }
      }
    }
  }
`,Le.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
`,Le.div`
  border: 1px solid ${e=>e.selected?"#4b47b9":"#e6e6f0"};
  background: ${e=>e.selected?"rgba(75, 71, 185, 0.05)":"white"};
  border-radius: 12px;
  padding: 20px;
  padding-left: 48px;
  position: relative;
  transition: all 0.2s ease;
  box-shadow: ${e=>e.selected?"0 4px 12px rgba(75, 71, 185, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.04)"};
  cursor: pointer;
  
  &:hover {
    border-color: #4b47b9;
    box-shadow: 0 4px 12px rgba(75, 71, 185, 0.15);
    transform: translateY(-2px);
  }
  
  .stall-price {
    position: absolute;
    top: 16px;
    right: 16px;
    background: ${e=>e.selected?"#4b47b9":"#52c41a"};
    color: white;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  
  .stall-number {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1f1f1f;
    display: flex;
    align-items: center;
    
    .hall-label {
      font-size: 13px;
      color: #666;
      margin-left: 8px;
      font-weight: normal;
    }
  }
  
  .stall-details {
    display: flex;
    gap: 16px;
    margin-top: 16px;
    
    .detail-item {
      flex: 1;
      
      .label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
      }
      
      .value {
        font-size: 15px;
        font-weight: 500;
      }
    }
  }
  
  .selection-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 12px;
    transform: translateY(-50%);
    background: ${e=>e.selected?"#4b47b9":"white"};
    border: 2px solid ${e=>e.selected?"#4b47b9":"#d9d9d9"};
    color: white;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
`;const Rt=Le($)`
  background: #f9fafc;
  border-radius: 12px;
  margin-top: 24px;
  border: 1px solid #eaecf0;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1), 0 1px 2px rgba(16, 24, 40, 0.06);
  
  .ant-card-head {
    background: #f2f4f7;
    border-bottom-color: #eaecf0;
    padding: 16px 24px;
    min-height: 48px;
    
    .ant-card-head-title {
      padding: 0;
      font-size: 16px;
      font-weight: 600;
      color: #101828;
    }
  }
  
  .ant-card-body {
    padding: 16px 24px 24px;
  }
  
  .summary-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    
    &:not(:last-child) {
      border-bottom: 1px solid #eaecf0;
    }
    
    .label {
      color: #475467;
      font-weight: 500;
    }
    
    .value {
      font-weight: 600;
      text-align: right;
      color: #1f2937;
    }
    
    &.discount {
      color: #ef4444;
      
      .value {
        color: #ef4444;
      }
    }
    
    &.total {
      font-weight: 600;
      font-size: 16px;
      color: #101828;
      border-top: 1px solid #eaecf0;
      margin-top: 8px;
      padding-top: 16px;
      
      .label, .value {
        font-size: 16px;
        font-weight: 700;
        color: #101828;
      }
    }
  }
`;Le(ge)`
  &.ant-btn-primary {
    background: #4b47b9;
    border-color: #4b47b9;
    
    &:hover, &:focus {
      background: #3b37a9;
      border-color: #3b37a9;
    }
  }
  
  &.ant-btn-lg {
    height: 48px;
    padding: 0 24px;
    font-size: 16px;
    border-radius: 8px;
  }
`,Le.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`,Le($)`
  background: #f8f8fc;
  border-radius: 12px;
  border: 1px solid #e6e6f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-form-item:last-child {
    margin-bottom: 0;
  }
`,Le(B)`
  &.ant-input-lg {
    border-radius: 8px;
    border: 1px solid #e6e6f0;
    background: white;
    padding: 12px 16px;
    height: auto;
    
    &:hover, &:focus {
      border-color: #4b47b9;
      box-shadow: 0 0 0 2px rgba(75, 71, 185, 0.1);
    }
  }
  
  .anticon {
    color: #4b47b9;
  }
`;const Ft=Le(ge)`
  &.ant-btn-lg {
    height: 40px;
    padding: 0 24px;
    font-size: 14px;
    border-radius: 6px;
    font-weight: 500;
    
    &.ant-btn-primary {
      background: #4b47b9;
      border-color: #4b47b9;
      
      &:hover {
        background: #3f3fa0;
        border-color: #3f3fa0;
      }
    }

    &:not(.ant-btn-primary) {
      border-color: #d9d9d9;
      
      &:hover {
        color: #4b47b9;
        border-color: #4b47b9;
      }
    }
  }
`;Le(ne)`
  .ant-descriptions-item-label {
    background: #f8f8fc !important;
    font-weight: 600;
    color: #1f1f1f;
  }
  
  .ant-descriptions-item-content {
    background: white !important;
  }
`,Le.div`
  background: #f8f8fc;
  padding: 32px 0;
  border-bottom: 1px solid #e6e6f0;
  margin: -32px -32px 32px;
`,Le(ie)`
  max-width: 900px;
  margin: 0 auto;

  .ant-steps-item {
    padding: 0 12px;
    margin: 0;
    
    &:first-of-type {
      padding-left: 0;
    }
    
    &:last-of-type {
      padding-right: 0;
    }
  }

  .ant-steps-item-container {
    position: relative;
  }

  .ant-steps-item-tail {
    padding: 0;
    top: 13px;
    margin: 0;
    
    &::after {
      height: 1px;
      margin: 0;
      background: #e6e6f0;
    }
  }

  .ant-steps-item-icon {
    width: 28px;
    height: 28px;
    line-height: 28px;
    margin-right: 8px;
    font-size: 14px;
    border: none;
    background: #e6e6f0;
    
    .anticon {
      font-size: 14px;
      top: 0;
    }
  }

  .ant-steps-item-content {
    display: inline-block;
  }

  .ant-steps-item-title {
    font-size: 14px;
    line-height: 28px;
    padding-right: 8px;
    color: rgba(0, 0, 0, 0.45);
    font-weight: normal;
    
    &::after {
      height: 1px;
      top: 14px;
      background: #e6e6f0 !important;
    }
  }

  .ant-steps-item-description {
    max-width: 140px;
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }

  .ant-steps-item-active {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
      
      &::after {
        background: #e6e6f0;
      }
    }
    
    .ant-steps-item-description {
      color: rgba(0, 0, 0, 0.65);
    }
  }

  .ant-steps-item-finish {
    .ant-steps-item-icon {
      background: #4b47b9;
      border: none;
      
      .ant-steps-icon {
        color: white;
      }
    }
    
    .ant-steps-item-title {
      color: rgba(0, 0, 0, 0.85);
      
      &::after {
        background: #4b47b9 !important;
      }
    }
    
    .ant-steps-item-tail::after {
      background: #4b47b9;
    }
  }

  .ant-steps-item-wait {
    .ant-steps-item-icon {
      background: #e6e6f0;
      border: none;
      
      .ant-steps-icon {
        color: rgba(0, 0, 0, 0.45);
      }
    }
  }
`,Le.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 4px 0;

  .company-name {
    font-weight: 500;
    color: rgba(0, 0, 0, 0.85);
  }

  .contact-details {
    font-size: 12px;
    color: rgba(0, 0, 0, 0.45);
  }
`,Le.div`
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }

  .section-title {
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e6e6f0;
  }
`,Le.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
`,Le.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
  margin-top: 24px;
`,Le.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 338px; /* Height for 3 cards: (102px × 3) + (16px × 2 gaps) */
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
    
    &:hover {
      background: #bbb;
    }
  }
`,Le($)`
  &.ant-card {
    background: #f8f8fc;
    border: 1px solid #e6e6f0;
    border-radius: 8px;
    position: sticky;
    top: 24px;
  }

  .calculation-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    
    &:last-child {
      margin-bottom: 0;
    }
  }

  .total-row {
    border-top: 1px solid #e6e6f0;
    margin-top: 16px;
    padding-top: 16px;
    font-weight: 600;
  }
`;const zt=({form:n,stallDetails:i=[],selectedStallId:s,selectedStallIds:a=[],exhibition:l})=>{const[o,r]=e.useState([]);e.useEffect((()=>{let e=[...(n.getFieldValue("selectedStalls")||[]).map((e=>String(e)))];if(s){const t=String(s);e.some((e=>e===t))||e.push(t)}a.length>0&&a.forEach((t=>{const n=String(t);e.some((e=>e===n))||e.push(n)})),n.setFieldsValue({selectedStalls:e}),r(e)}),[n,s,a]),e.useEffect((()=>{if(o.length>0){const e=n.getFieldValue("selectedStalls")||[],t=new Set(e.map((e=>String(e)))),i=new Set(o.map((e=>String(e))));let s=t.size!==i.size;if(!s)for(const n of i)if(!t.has(n)){s=!0;break}if(s){const e=o.map((e=>String(e)));n.setFieldsValue({selectedStalls:e}),n.validateFields(["selectedStalls"]).catch((e=>{}))}}}),[o,n]);const d=e.useMemo((()=>i&&0!==i.length?i.filter((e=>o.includes(e.id))):[]),[i,o]),c=e.useMemo((()=>{var e,t,n;if(!i||0===i.length)return{baseAmount:0,discounts:[],totalDiscountAmount:0,amountAfterDiscount:0,taxes:[],totalTaxAmount:0,total:0,selectedStallNumbers:""};const s=i.filter((e=>o.includes(e.id))),a=s.reduce(((e,t)=>e+(t.price||t.ratePerSqm*t.dimensions.width*t.dimensions.height)),0),r=((null==(e=null==l?void 0:l.publicDiscountConfig)?void 0:e.filter((e=>e.isActive)))||[]).map((e=>{const t="percentage"===e.type?a*(Math.min(Math.max(0,e.value),100)/100):Math.min(e.value,a);return{name:e.name,type:e.type,value:e.value,amount:t}})),d=r.reduce(((e,t)=>e+t.amount),0),c=a-d,h=(null==(n=null==(t=null==l?void 0:l.taxConfig)?void 0:t.filter((e=>e.isActive)))?void 0:n.map((e=>({name:e.name,rate:e.rate,amount:c*(e.rate/100)}))))||[],x=h.reduce(((e,t)=>e+t.amount),0);return{baseAmount:a,discounts:r,totalDiscountAmount:d,amountAfterDiscount:c,taxes:h,totalTaxAmount:x,total:c+x,selectedStallNumbers:s.map((e=>`${e.number||e.stallNumber||`Stall ${e.id}`} (${e.hallName||`Hall ${e.hallId||1}`})`)).join(", ")}}),[i,o,null==l?void 0:l.taxConfig,null==l?void 0:l.publicDiscountConfig]),h=e=>`₹${e.toLocaleString("en-IN")}`;return t.jsxs(Pt,{children:[t.jsx(At,{children:"Your Selected Stalls"}),t.jsx(Dt,{children:"Review your selected stalls. You can remove a stall by clicking the delete button."}),t.jsx(ue.Item,{name:"selectedStalls",rules:[{required:!0,message:"Please select at least one stall"}],style:{display:"none"},children:t.jsx(H,{mode:"multiple"})}),d.length>0?t.jsx("div",{style:{marginBottom:24,background:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},children:t.jsx(Be,{dataSource:d.map((e=>({...e,key:e.id,price:e.price||e.ratePerSqm*e.dimensions.width*e.dimensions.height,area:e.dimensions.width*e.dimensions.height,dimensions:`${e.dimensions.width}m × ${e.dimensions.height}m`,size:`${e.dimensions.width}m × ${e.dimensions.height}m`,stallType:e.stallType||{name:e.typeName||e.type||"Standard"},type:e.typeName||e.type||"Standard"}))),pagination:!1,size:"middle",rowClassName:()=>"stall-table-row",className:"selected-stalls-table",style:{borderRadius:"6px",overflow:"hidden"},columns:[{title:"Stall",dataIndex:"number",key:"number",render:(e,n)=>t.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Stall ",e||n.stallNumber]})},{title:"Hall",dataIndex:"hallName",key:"hallName",render:(e,n)=>t.jsx(se,{color:"blue",style:{borderRadius:"4px"},children:e||`Hall ${n.hallId}`})},{title:"Stall Type",dataIndex:"stallType",key:"stallType",align:"center",render:(e,n)=>{var i;const s=(null==(i=n.stallType)?void 0:i.name)||n.type||"Standard";return t.jsx(se,{color:"purple",style:{borderRadius:"4px",padding:"2px 8px"},children:s})}},{title:"Dimensions",dataIndex:"dimensions",key:"dimensions",align:"center",render:(e,n)=>t.jsxs(_,{direction:"vertical",size:0,children:[t.jsx("span",{style:{fontWeight:500},children:e}),t.jsxs("span",{style:{color:"#888",fontSize:"13px"},children:[n.area," sqm"]})]})},{title:"Rate",dataIndex:"ratePerSqm",key:"ratePerSqm",align:"right",render:(e,n)=>t.jsxs("span",{style:{color:"#555"},children:["₹",(n.ratePerSqm||0).toLocaleString("en-IN"),"/sqm"]})},{title:"Price",dataIndex:"price",key:"price",align:"right",render:e=>t.jsx("span",{style:{fontWeight:600,color:"#1890ff",fontSize:"15px",display:"block",padding:"4px 8px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"4px",textAlign:"right"},children:h(e)})},{title:"",key:"action",width:70,align:"center",render:(e,i)=>t.jsx(K,{title:"Remove from selection",children:t.jsx(ge,{type:"text",danger:!0,icon:t.jsx(m,{}),onClick:()=>(e=>{const t=String(e);if(o.some((e=>String(e)===t))){const e=o.filter((e=>String(e)!==t));r(e),n.setFieldsValue({selectedStalls:e}),J.info("Stall removed from selection")}})(i.id),size:"middle",style:{borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"}})})}]})}):t.jsx(ae,{description:"No stalls selected yet. Please select stalls from the layout.",image:ae.PRESENTED_IMAGE_SIMPLE,style:{margin:"32px 0"}}),o.length>0&&t.jsxs(Rt,{title:t.jsx("span",{style:{fontSize:"16px",fontWeight:600},children:"Booking Summary"}),style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)"},headStyle:{background:"#f6f8fa",borderBottom:"1px solid #eee"},bodyStyle:{padding:"16px 24px"},children:[t.jsxs("div",{className:"summary-row",children:[t.jsx("div",{className:"label",children:"Selected Stalls"}),t.jsxs("div",{className:"value",children:[o.length," stall(s) selected"]})]}),t.jsxs("div",{className:"summary-row",children:[t.jsx("div",{className:"label",children:"Stall Numbers"}),t.jsx("div",{className:"value",style:{maxWidth:"60%",wordBreak:"break-word"},children:c.selectedStallNumbers})]}),t.jsxs("div",{className:"summary-row",children:[t.jsx("div",{className:"label",children:"Base Amount"}),t.jsx("div",{className:"value",children:h(c.baseAmount)})]}),c.discounts.map(((e,n)=>t.jsxs("div",{className:"summary-row discount",children:[t.jsxs("div",{className:"label",children:[e.name,"percentage"===e.type?` (${e.value}%)`:""]}),t.jsxs("div",{className:"value",style:{color:"#52c41a"},children:["- ",h(e.amount)]})]},`discount-${n}`))),t.jsxs("div",{className:"summary-row",children:[t.jsx("div",{className:"label",children:"Amount after Discount"}),t.jsx("div",{className:"value",style:{fontWeight:500},children:h(c.amountAfterDiscount)})]}),c.taxes.map(((e,n)=>t.jsxs("div",{className:"summary-row",children:[t.jsxs("div",{className:"label",children:[e.name," (",e.rate,"%)"]}),t.jsxs("div",{className:"value",style:{color:"#faad14"},children:["+ ",h(e.amount)]})]},`tax-${n}`))),t.jsxs("div",{className:"summary-row total",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #f0f0f0"},children:[t.jsx("div",{className:"label",style:{fontSize:"16px",fontWeight:600},children:"Total"}),t.jsx("div",{className:"value",style:{fontSize:"18px",fontWeight:700,color:"#1890ff"},children:h(c.total)})]})]})]})},{Title:$t,Paragraph:Mt,Text:qt}=M,{Panel:Lt}=re,{Option:Bt}=H,Vt=({form:n,formValues:i,selectedStallIds:a=[],exhibition:o,stallDetails:r=[]})=>{const d=n.getFieldValue("selectedStalls")||a||[],[c,h]=e.useState(n.getFieldValue("amenities")||[]),[x,m]=e.useState({}),p=e.useMemo((()=>(null==r?void 0:r.length)?r.filter((e=>d.includes(e.id))):[]),[r,d]),u=e.useMemo((()=>p.reduce(((e,t)=>e+t.dimensions.width*t.dimensions.height),0)),[p]),g=(null==o?void 0:o.basicAmenities)&&o.basicAmenities.length>0,b=(null==o?void 0:o.amenities)&&o.amenities.length>0,f=e.useMemo((()=>g&&0!==u?((null==o?void 0:o.basicAmenities)||[]).map((e=>{const t=Math.floor(u/e.perSqm)*e.quantity;return{...e,calculatedQuantity:t>0?t:0,key:e._id||e.id}})):[]),[o,g,u]),y=e=>(e._id||e.id||"").toString();s.useEffect((()=>{const e=c.map((e=>({id:e,quantity:x[e]||1})));n.setFieldsValue({amenities:e})}),[c,x,n]);const v=e=>`₹${e.toLocaleString("en-IN")}`,w=e.useMemo((()=>b?((null==o?void 0:o.amenities)||[]).filter((e=>c.includes(y(e)))).map((e=>({...e,key:y(e),quantity:x[y(e)]||1}))):[]),[o,b,c,x]),S=[{title:"Name",dataIndex:"name",key:"name",render:(e,n)=>t.jsxs(_,{children:[t.jsx(qt,{strong:!0,children:e}),t.jsx(se,{color:"blue",children:n.type})]})},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:e=>t.jsxs(se,{color:"green",children:[e," ",1===e?"unit":"units"]})},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(e,n)=>t.jsx(K,{title:n.description,children:t.jsxs(qt,{type:"secondary",children:[t.jsx(l,{style:{marginRight:5}}),"1 ",n.quantity>1?`set of ${n.quantity}`:"unit"," per ",e," sqm"]})})}],k=[{title:"Name",dataIndex:"name",key:"name",render:(e,n)=>t.jsxs(_,{align:"center",children:[t.jsx(qt,{strong:!0,children:e}),t.jsx(se,{color:"blue",children:n.type}),t.jsx(qt,{type:"secondary",style:{fontSize:"13px"},children:n.description})]})},{title:"Rate",dataIndex:"rate",key:"rate",width:120,render:e=>t.jsx(qt,{strong:!0,style:{color:"#1890ff"},children:v(e)})},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:120,render:(e,n)=>t.jsx(W,{min:1,value:x[n.key]||1,onChange:e=>{return t=n.key,i=e||1,void m((e=>({...e,[t]:i})));var t,i},style:{width:"100%"}})},{title:"Total",key:"total",width:120,render:(e,n)=>{const i=x[n.key]||1,s=n.rate*i;return t.jsx(qt,{strong:!0,style:{color:"#1890ff"},children:v(s)})}}];return t.jsxs(Pt,{children:[t.jsx($t,{level:4,children:"Stall Amenities"}),t.jsx(Mt,{type:"secondary",style:{marginBottom:24},children:"Review included amenities and select additional amenities for your exhibition stalls."}),t.jsx($,{title:`Selected Stalls: ${d.length}`,style:{marginBottom:24},children:d.length>0?t.jsxs(Mt,{children:["You've selected ",d.length," stall(s) with a total area of ",u," sq. meters."]}):t.jsx(ae,{image:ae.PRESENTED_IMAGE_SIMPLE,description:"No stalls selected"})}),t.jsx($,{title:t.jsxs(_,{children:[t.jsx(oe,{status:"success"}),"Included Amenities"]}),style:{marginBottom:24},children:0===d.length?t.jsx(le,{message:"Select stalls first",description:"Please select stalls to see what amenities are included.",type:"info",showIcon:!0}):g?t.jsx(Be,{dataSource:f.filter((e=>e.calculatedQuantity>0)),columns:S,pagination:!1,size:"small",locale:{emptyText:t.jsx(ae,{image:ae.PRESENTED_IMAGE_SIMPLE,description:"Your stall area is too small to qualify for any basic amenities."})}}):t.jsx(ae,{image:t.jsx(j,{style:{fontSize:60,color:"#cccccc"}}),description:"No basic amenities have been configured for this exhibition."})}),t.jsx(X,{}),t.jsx($,{title:"Additional Amenities (Extra Charges)",children:b?t.jsxs("div",{children:[t.jsx(ue.Item,{label:"Select Additional Amenities",style:{marginBottom:24},children:t.jsx(H,{mode:"multiple",style:{width:"100%"},placeholder:"Select amenities",value:c,onChange:e=>{const t={...x};e.forEach((e=>{c.includes(e)||(t[e]=1)})),Object.keys(t).forEach((n=>{e.includes(n)||delete t[n]})),m(t),h(e)},optionLabelProp:"label",children:((null==o?void 0:o.amenities)||[]).map((e=>t.jsxs(Bt,{value:y(e),label:`${e.name} (${v(e.rate)})`,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs(_,{children:[t.jsx(qt,{strong:!0,children:e.name}),t.jsx(se,{color:"blue",children:e.type})]}),t.jsx(qt,{style:{color:"#1890ff"},children:v(e.rate)})]}),t.jsx("div",{children:t.jsx(qt,{type:"secondary",children:e.description})})]},y(e))))})}),w.length>0&&t.jsxs("div",{style:{marginTop:16},children:[t.jsx(X,{orientation:"left",children:"Selected Amenities"}),t.jsx(Be,{dataSource:w,columns:k,pagination:!1,size:"small"})]})]}):t.jsx(ae,{image:t.jsx(j,{style:{fontSize:60,color:"#cccccc"}}),description:"No additional amenities are available for this exhibition."})}),t.jsx(ue.Item,{name:"amenities",hidden:!0,children:t.jsx(B,{type:"hidden"})}),t.jsx(ue.Item,{name:"selectedStalls",hidden:!0,children:t.jsx(B,{type:"hidden"})})]})},{Title:_t,Paragraph:Ht,Text:Wt}=M,Ut=({form:n,stallDetails:i=[],selectedStallId:s,selectedStallIds:a=[],selectedStalls:o=[],exhibition:r,onPrev:d,onFinish:c,loading:h=!1,formValues:x={}})=>{const[m,p]=e.useState([]),u=e.useMemo((()=>{const e=(n.getFieldValue("selectedStalls")||[]).map((e=>String(e)));if(e.length>0)return e;const t=[];if(s){const e=String(s);t.push(e)}return a&&a.length&&a.forEach((e=>{const n=String(e);t.includes(n)||t.push(n)})),o&&o.length&&o.forEach((e=>{const n=String(e);t.includes(n)||t.push(n)})),t}),[n,s,a,o]);e.useEffect((()=>{if(i&&i.length&&u.length){const e=i.filter((e=>u.includes(String(e.id)))).map((e=>({key:e.id,id:e.id,number:e.number||e.stallNumber||`Stall ${e.id}`,hallName:e.hallName||`Hall ${e.hallId}`,size:`${e.dimensions.width}m × ${e.dimensions.height}m`,area:e.dimensions.width*e.dimensions.height,rate:e.ratePerSqm,price:e.price||e.ratePerSqm*e.dimensions.width*e.dimensions.height,type:e.typeName||e.type||"Standard"})));p(e)}}),[i,u]);const g=e.useMemo((()=>{var e,t,i,s;const a=m.reduce(((e,t)=>e+t.price),0),l=m.reduce(((e,t)=>e+(t.area||0)),0),o=(null==(e=null==r?void 0:r.basicAmenities)?void 0:e.map((e=>{const t=Math.floor(l/e.perSqm)*e.quantity;return{...e,calculatedQuantity:t>0?t:0}})))||[],d=n.getFieldValue("amenities")||[];let c=0;const h=d.map((e=>{var t;const n=e.id,i=e.quantity||1,s=null==(t=null==r?void 0:r.amenities)?void 0:t.find((e=>e.id===n||e._id===n));if(s){const e=(s.rate||0)*i;return c+=e,{name:s.name,rate:s.rate,type:s.type,description:s.description,quantity:i,total:e}}return null})).filter(Boolean),x=((null==(t=null==r?void 0:r.publicDiscountConfig)?void 0:t.filter((e=>e.isActive)))||[]).map((e=>{const t="percentage"===e.type?a*(Math.min(Math.max(0,e.value),100)/100):Math.min(e.value,a);return{name:e.name,type:e.type,value:e.value,amount:t}})),p=x.reduce(((e,t)=>e+t.amount),0),u=a-p,g=u,b=(null==(s=null==(i=null==r?void 0:r.taxConfig)?void 0:i.filter((e=>e.isActive)))?void 0:s.map((e=>({name:e.name,rate:e.rate,amount:g*(e.rate/100)}))))||[],f=b.reduce(((e,t)=>e+t.amount),0);return{baseAmount:a,basicAmenities:o,totalStallArea:l,amenities:h,amenitiesTotal:c,discounts:x,totalDiscountAmount:p,amountAfterDiscount:u,subtotal:g,taxes:b,totalTaxAmount:f,total:g+f,stallCount:m.length}}),[m,n,r]);e.useEffect((()=>{var e;const t=(null==(e=null==r?void 0:r.publicDiscountConfig)?void 0:e.filter((e=>e.isActive)))||[];if(t.length>0){const e=t[0];n.setFieldsValue({discountId:{name:e.name,type:e.type,value:e.value}})}}),[r,n]);const b=[{title:"Stall Number",dataIndex:"number",key:"number"},{title:"Hall",dataIndex:"hallName",key:"hallName"},{title:"Stall Type",dataIndex:"type",key:"type",render:(e,n)=>t.jsx(se,{color:"purple",children:e},`stall-type-${n.key}`)},{title:"Size",dataIndex:"size",key:"size"},{title:"Area",dataIndex:"area",key:"area",render:(e,n)=>t.jsxs("span",{children:[e," sqm"]},`stall-area-${n.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",render:(e,n)=>t.jsxs("span",{children:["₹",e,"/sqm"]},`stall-rate-${n.key}`)},{title:"Price",dataIndex:"price",key:"price",render:(e,n)=>t.jsxs("span",{children:["₹",e.toLocaleString()]},`stall-price-${n.key}`)}],f=e=>`₹${e.toLocaleString("en-IN")}`,y=x.customerName||n.getFieldValue("customerName"),j=x.customerPhone||n.getFieldValue("customerPhone"),v=x.email||n.getFieldValue("email"),w=x.companyName||n.getFieldValue("companyName");return h?t.jsx(Pt,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:t.jsx(de,{size:"large",tip:"Processing your booking..."})}):0===u.length?t.jsxs(Pt,{children:[t.jsx(le,{message:"No Stalls Selected",description:"Please go back and select at least one stall to book.",type:"warning",showIcon:!0}),t.jsx("div",{style:{marginTop:24,textAlign:"right"},children:t.jsx(ge,{onClick:d,children:"Back to Stall Selection"})})]}):t.jsxs(Pt,{children:[t.jsx(ue.Item,{name:"discountId",hidden:!0,children:t.jsx(B,{})}),t.jsx(_t,{level:4,children:"Booking Summary"}),t.jsx(Ht,{type:"secondary",style:{marginBottom:24},children:"Please review your booking details before submitting."}),t.jsx($,{title:"Exhibitor Information",style:{marginBottom:24},children:t.jsxs(ne,{column:2,children:[t.jsx(ne.Item,{label:"Name",children:y||"Not provided"}),t.jsx(ne.Item,{label:"Company",children:w||"Not provided"}),t.jsx(ne.Item,{label:"Phone",children:j||"Not provided"}),t.jsx(ne.Item,{label:"Email",children:v||"Not provided"})]})}),t.jsxs($,{title:"Selected Stalls",className:"review-card",size:"small",children:[t.jsx(Be,{dataSource:m,columns:b,pagination:!1,size:"small",style:{marginBottom:16}}),t.jsxs(Wt,{strong:!0,children:["Total Base Amount: ",f(g.baseAmount)]})]}),g.basicAmenities&&g.basicAmenities.length>0&&t.jsxs($,{title:t.jsxs(_,{children:[t.jsx(oe,{status:"success"}),"Included Basic Amenities"]}),style:{marginBottom:24},children:[t.jsxs(Ht,{type:"secondary",style:{marginBottom:16},children:["The following amenities are included based on your total stall area of ",g.totalStallArea," sqm."]}),t.jsx(Be,{dataSource:g.basicAmenities.filter((e=>e.calculatedQuantity>0)).map(((e,t)=>({...e,key:`basic-${t}`}))),columns:[{title:"Name",dataIndex:"name",key:"name",render:(e,n)=>t.jsxs(_,{children:[t.jsx(Wt,{strong:!0,children:e}),t.jsx(se,{color:"blue",children:n.type})]},`name-${n.key}`)},{title:"Quantity",dataIndex:"calculatedQuantity",key:"calculatedQuantity",width:120,render:(e,n)=>t.jsxs(se,{color:"green",children:[e," ",1===e?"unit":"units"]},`quantity-${n.key}`)},{title:"Allocation",dataIndex:"perSqm",key:"perSqm",width:180,render:(e,n)=>t.jsxs(Wt,{type:"secondary",children:[t.jsx(l,{style:{marginRight:5}}),"1 ",n.quantity>1?`set of ${n.quantity}`:"unit"," per ",e," sqm"]},`allocation-${n.key}`)},{title:"Status",key:"status",width:100,align:"right",render:(e,n)=>t.jsx(Wt,{type:"success",children:"Included"},`status-${n.key}`)}],pagination:!1,size:"small",locale:{emptyText:t.jsx(le,{message:"No basic amenities",description:"Your stall area is too small to qualify for any basic amenities.",type:"info",showIcon:!0})}})]}),g.amenities&&g.amenities.length>0&&t.jsxs($,{title:"Selected Amenities",style:{marginBottom:24},children:[t.jsx(Be,{dataSource:g.amenities.map(((e,t)=>({...e,key:t}))),columns:[{title:"Name",dataIndex:"name",key:"name",render:(e,n)=>t.jsxs(_,{children:[t.jsx(Wt,{strong:!0,children:e}),t.jsx(se,{color:"blue",children:n.type})]},`amenity-name-${n.key}`)},{title:"Description",dataIndex:"description",key:"description",render:(e,n)=>t.jsx(Wt,{type:"secondary",style:{fontSize:"13px"},children:e||"No description provided"},`amenity-desc-${n.key}`)},{title:"Rate",dataIndex:"rate",key:"rate",width:110,align:"right",render:(e,n)=>t.jsx(Wt,{strong:!0,style:{color:"#1890ff"},children:f(e)},`amenity-rate-${n.key}`)},{title:"Quantity",dataIndex:"quantity",key:"quantity",width:90,align:"center",render:(e,n)=>t.jsx(se,{color:"green",children:e},`amenity-qty-${n.key}`)},{title:"Total",dataIndex:"total",key:"total",width:110,align:"right",render:(e,n)=>t.jsx(Wt,{strong:!0,style:{color:"#1890ff"},children:f(e)},`amenity-total-${n.key}`)}],pagination:!1,size:"small"}),t.jsx(X,{}),t.jsx("div",{style:{textAlign:"right"},children:t.jsxs(Wt,{strong:!0,children:["Amenities Total: ",f(g.amenitiesTotal)]})})]}),t.jsxs($,{title:"Price Calculation",style:{marginBottom:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsx(Wt,{children:"Base Amount:"}),t.jsx(Wt,{children:f(g.baseAmount)})]}),g.discounts.length>0&&t.jsxs(t.Fragment,{children:[g.discounts.map(((e,n)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsxs(Wt,{children:[e.name," (","percentage"===e.type?`${e.value}%`:f(e.value),"):"]}),t.jsxs(Wt,{type:"danger",children:["- ",f(e.amount)]})]},n))),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsx(Wt,{children:"Amount after Discount:"}),t.jsx(Wt,{children:f(g.amountAfterDiscount)})]})]}),g.amenitiesTotal>0&&t.jsxs("div",{style:{background:"#f9f9f9",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px dashed #d9d9d9"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[t.jsx(Wt,{type:"secondary",children:"Selected Amenities (for information only):"}),t.jsx(Wt,{type:"secondary",children:f(g.amenitiesTotal)})]}),t.jsx(Wt,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"Note: Amenities are not included in the total calculation"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsx(Wt,{strong:!0,children:"Subtotal:"}),t.jsx(Wt,{strong:!0,children:f(g.subtotal)})]}),g.taxes.length>0&&t.jsx(t.Fragment,{children:g.taxes.map(((e,n)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsxs(Wt,{children:[e.name," (",e.rate,"%):"]}),t.jsx(Wt,{children:f(e.amount)})]},n)))}),t.jsx(X,{}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(_t,{level:5,children:"Total:"}),t.jsx(_t,{level:5,children:f(g.total)})]})]})]})},{confirm:Ot}=be,Yt=({visible:n,stallDetails:i,selectedStallId:s,selectedStallIds:a,loading:l,exhibition:o,onCancel:d,onSubmit:c})=>{const[h]=ue.useForm(),[x,m]=e.useState(0),[p]=e.useState(3),[u,g]=e.useState({}),[b,f]=e.useState(!1),[y,j]=e.useState(!1),C=De((e=>e.exhibitorAuth.exhibitor));e.useEffect((()=>{if(n){m(0),f(!1),g({}),h.resetFields();const e=a.map((e=>String(e)));s&&e.push(String(s));const t={selectedStalls:[...new Set(e)],exhibitionId:null==o?void 0:o._id};C&&(t.customerName=C.contactPerson||"",t.companyName=C.companyName||"",t.email=C.email||"",t.customerPhone=C.phone||""),h.setFieldsValue(t),g(t)}}),[n,h,s,a,o,C]);const I=()=>{m(x-1)},N=()=>{h.validateFields().then((e=>{const t={customerName:h.getFieldValue("customerName"),companyName:h.getFieldValue("companyName"),email:h.getFieldValue("email"),customerPhone:h.getFieldValue("customerPhone")},n=h.getFieldValue("selectedStalls")||[],s=h.getFieldValue("amenities")||[],a=i.filter((e=>n.includes(String(e.id)))).reduce(((e,t)=>e+t.dimensions.width*t.dimensions.height),0);let l=[];(null==o?void 0:o.basicAmenities)&&o.basicAmenities.length>0&&(l=o.basicAmenities.filter((e=>Math.floor(a/e.perSqm)*e.quantity>0)).map((e=>{const t=Math.floor(a/e.perSqm)*e.quantity;return{name:e.name,type:e.type,perSqm:e.perSqm,quantity:e.quantity,calculatedQuantity:t,description:e.description||""}})));let r=[];s&&s.length>0&&(r=s.map((e=>{var t;const n=null==(t=null==o?void 0:o.amenities)?void 0:t.find((t=>String(t._id||t.id)===String(e.id)));return n?{id:String(n._id||n.id),name:n.name,type:n.type,rate:n.rate,quantity:e.quantity||1,description:n.description||""}:null})).filter(Boolean));const d={...u,...e,...t,basicAmenities:l,extraAmenities:r};c(d)})).catch((e=>{J.error("Please complete all required fields")}))},E=[{title:"Stall Details",icon:t.jsx(v,{}),content:t.jsx(zt,{form:h,stallDetails:i,selectedStallId:s,selectedStallIds:a,exhibition:o})},{title:"Amenities",icon:t.jsx(r,{}),content:t.jsx(Vt,{form:h,stallDetails:i,selectedStallIds:h.getFieldValue("selectedStalls")||[],exhibition:o,formValues:u})},{title:"Review",icon:t.jsx(w,{}),content:t.jsx(Ut,{form:h,formValues:u,loading:l,exhibition:o,selectedStalls:h.getFieldValue("selectedStalls")||[],selectedStallIds:h.getFieldValue("selectedStalls")||[],stallDetails:i})}];e.useEffect((()=>{h.getFieldValue("selectedStalls")}),[x,h]);return t.jsx(Et,{title:`Book Exhibition Stall - ${["Stall Details","Amenities","Review"][x]}`,open:n,onCancel:()=>{b?Ot({title:"Discard changes?",icon:t.jsx(k,{}),content:"You have unsaved changes. Are you sure you want to close this form?",onOk(){d()}}):d()},footer:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 24px"},children:[x>0&&t.jsx(Ft,{onClick:I,disabled:y||l,size:"large",children:"Back"}),t.jsx("div",{children:x<p-1?t.jsx(Ft,{type:"primary",onClick:()=>{j(!0),h.validateFields().then((e=>{const t={...{...u,...e},...{customerName:h.getFieldValue("customerName"),companyName:h.getFieldValue("companyName"),email:h.getFieldValue("email"),customerPhone:h.getFieldValue("customerPhone")}};g(t),m(x+1),j(!1)})).catch((e=>{j(!1),J.error("Please complete all required fields")}))},loading:y,disabled:l,size:"large",children:"Next"}):t.jsx(Ft,{type:"primary",onClick:N,loading:l,disabled:y,size:"large",children:"Submit Booking"})})]}),width:900,destroyOnClose:!0,maskClosable:!1,className:"booking-modal",children:t.jsxs(de,{spinning:l||y,tip:l?"Processing your booking...":"Validating...",children:[t.jsx(Tt,{children:E.map(((e,n)=>t.jsxs("div",{className:`step-item ${x===n?"active":""} ${x>n?"completed":""}`,onClick:()=>x>n?m(n):null,style:{cursor:x>n?"pointer":"default"},children:[t.jsx("span",{className:"step-icon",children:x>n?t.jsx(S,{}):n+1}),e.title]},n)))}),t.jsx(ue,{form:h,layout:"vertical",preserve:!0,onFieldsChange:()=>{f(!0)},children:(e=>{const n=h.getFieldValue("selectedStalls")||[],r={customerName:h.getFieldValue("customerName"),companyName:h.getFieldValue("companyName"),email:h.getFieldValue("email"),customerPhone:h.getFieldValue("customerPhone")},d={...u,...r};switch(e){case 0:return t.jsx(zt,{form:h,stallDetails:i,selectedStallId:s,selectedStallIds:a,exhibition:o});case 1:return t.jsx(Vt,{form:h,stallDetails:i,selectedStallIds:n,exhibition:o,formValues:d});case 2:return t.jsx(Ut,{form:h,formValues:d,loading:l,exhibition:o,selectedStalls:n,selectedStallIds:n,stallDetails:i,onPrev:I,onFinish:N});default:return null}})(x)},`form-step-${x}`)]})})},{Content:Gt}=ce,{Title:Xt}=M,Qt=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/"))return`${R.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${R.defaults.baseURL}/${i}?token=${n}`:`${R.defaults.baseURL}/${i}`},Kt=s.memo((()=>{var n,i,s,a;const{id:o}=Re(),r=Fe(),d=ze(),[c,h]=e.useState(null),[x,m]=e.useState(null),[p,u]=e.useState(null),[g,b]=e.useState([]),[f,y]=e.useState(!1),[j,v]=e.useState(!0),[w,S]=e.useState(null),[k,N]=e.useState(!1),[E,T]=e.useState(null),P=e.useRef(null),[A,D]=e.useState({width:800,height:600}),[R,F]=e.useState(!1),[M]=ue.useForm(),{isAuthenticated:B}=De((e=>e.exhibitorAuth));e.useEffect((()=>{const e=()=>{F(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const V=e.useCallback((e=>"booked"===e.status||"reserved"===e.status),[]),_=e.useCallback((()=>{if(P.current){const{clientWidth:e,clientHeight:t}=P.current,n=R?320:800,i=R?480:600,s=Math.max(e||n,n),a=Math.max(t||i,i);(Math.abs(s-A.width)>5||Math.abs(a-A.height)>5)&&D({width:s,height:a})}}),[A.width,A.height,R]);e.useEffect((()=>{let e=null;const t=()=>{null===e&&(e=window.setTimeout((()=>{e=null,_()}),R?100:50))};_();const n=new ResizeObserver(t);return P.current&&n.observe(P.current),window.addEventListener("resize",t),()=>{null!==e&&window.clearTimeout(e),n.disconnect(),window.removeEventListener("resize",t)}}),[_,R]),e.useEffect((()=>{(async()=>{try{if(!o)return S("Exhibition ID is missing"),void v(!1);v(!0),S(null);const e=await z.getLayout(o);h(e.data)}catch(e){S(e.message||"Failed to fetch layout")}finally{v(!1)}})()}),[o]),e.useEffect((()=>{c&&_()}),[c]),e.useEffect((()=>{B&&c&&(u(null),b([]),_(),J.info("You can now select stalls to book.",3))}),[B]);const H=e.useCallback((async e=>{if(V(e))return void J.info(`This stall (${e.stallNumber}) is already booked.`);if(!B)return void d(Ve("stall-booking"));const t=e._id||e.id;b((n=>n.includes(t)?(J.info(`Stall ${e.stallNumber} removed from selection`),n.filter((e=>e!==t))):(J.success(`Stall ${e.stallNumber} added to selection`),[...n,t])))}),[V,B,d]);e.useCallback((e=>{e.cancelBubble=!0}),[]);const W=e.useMemo((()=>{var e;return c?{halls:c.layout.map((e=>t.jsx(dt,{hall:{...e,exhibitionId:o||""},isSelected:!1,onSelect:()=>{},isStallMode:!0},e.id))),stalls:c.layout.flatMap((e=>e.stalls.map((n=>{var i,s,a,l,o,r,d,c;return t.jsx(xt,{stall:{...n,hallId:e.id,hallName:e.name,isSelected:g.includes(n.id),stallTypeId:"default",number:n.stallNumber,typeName:n.type||"Standard",ratePerSqm:n.price||0,rotation:0,dimensions:{x:(null==(i=n.position)?void 0:i.x)||0,y:(null==(s=n.position)?void 0:s.y)||0,width:(null==(a=n.dimensions)?void 0:a.width)||0,height:(null==(l=n.dimensions)?void 0:l.height)||0},status:"maintenance"===n.status?"booked":n.status},isSelected:p===n.id||g.includes(n.id),onSelect:"available"===n.status?()=>H(n):void 0,hallWidth:(null==(o=e.dimensions)?void 0:o.width)||0,hallHeight:(null==(r=e.dimensions)?void 0:r.height)||0,hallX:(null==(d=e.dimensions)?void 0:d.x)||0,hallY:(null==(c=e.dimensions)?void 0:c.y)||0},n.id)})))),fixtures:null==(e=c.fixtures)?void 0:e.map((e=>{var n,i;return t.jsx(ct,{fixture:{...e,id:e.id||e._id,_id:e._id||e.id,exhibitionId:o||"",isActive:!0,zIndex:5},scale:1,position:{x:0,y:0},exhibitionWidth:(null==(n=c.exhibition.dimensions)?void 0:n.width)||0,exhibitionHeight:(null==(i=c.exhibition.dimensions)?void 0:i.height)||0},e.id||e._id)}))}:null}),[c,o,p,g,H]);return j?t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(Gt,{style:{paddingTop:"64px"},children:t.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[t.jsx(de,{size:"large"}),t.jsx("p",{style:{marginTop:16},children:"Loading exhibition layout..."})]})})]}):w||!c?t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(Gt,{style:{paddingTop:"64px"},children:t.jsx(he,{status:"error",title:"Failed to load exhibition layout",subTitle:w||"The exhibition layout couldn't be loaded.",extra:[t.jsx(ge,{type:"primary",onClick:()=>r("/exhibitions"),children:"Back to Exhibitions"},"back")]})})]}):(null==(n=c.exhibition.dimensions)?void 0:n.width)&&(null==(i=c.exhibition.dimensions)?void 0:i.height)?t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsxs(Gt,{style:{paddingTop:"64px",background:"#f7f8fa"},children:[R&&t.jsx("div",{style:{height:"16px",width:"100%"}}),t.jsxs($,{className:"exhibition-card",style:{borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",margin:R?"40px 0px 10px 0px":"10px 0px",border:"none"},bodyStyle:{padding:R?"5px":"24px"},children:[t.jsxs(q,{gutter:[24,24],style:{marginBottom:R?16:32},children:[t.jsx(L,{xs:24,sm:24,md:12,children:t.jsxs("div",{style:{padding:R?"12px":"16px",background:"linear-gradient(145deg, #ffffff, #f8faff)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:R?"column":"row",alignItems:R?"flex-start":"center",gap:R?"12px":"16px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[t.jsx("div",{style:{flexShrink:0,display:"flex",justifyContent:R?"center":"flex-start",width:R?"100%":"auto"},children:c.exhibition.headerLogo?t.jsx(xe,{src:Qt(c.exhibition.headerLogo),alt:`${c.exhibition.name} logo`,style:{maxHeight:R?70:90,maxWidth:R?200:250,objectFit:"contain"},preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:R?200:250,height:R?70:90,backgroundColor:"#f5f5f5",borderRadius:"8px"},children:t.jsx(de,{size:"small"})})}):t.jsx("div",{style:{width:R?70:90,height:R?70:90,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f0f0f0, #e6e6e6)",borderRadius:"8px",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.05)"},children:t.jsx(C,{style:{fontSize:R?24:32,color:"#aaa"}})})}),!R&&t.jsx(X,{type:"vertical",style:{height:"90px",margin:"0 16px",opacity:.6}}),t.jsxs("div",{style:{flex:1,width:R?"100%":"auto"},children:[t.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:R?"18px":"22px",fontWeight:600,background:"linear-gradient(90deg, #333, #666)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:c.exhibition.name}),t.jsxs("p",{style:{margin:"0 0 8px 0",display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:R?"13px":"14px"},children:[t.jsx(C,{style:{fontSize:R?"14px":"16px",color:"#1890ff"}}),t.jsxs("span",{children:[new Date(c.exhibition.startDate).toLocaleDateString()," -",new Date(c.exhibition.endDate).toLocaleDateString()]})]}),t.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px",color:"#555",fontSize:R?"13px":"14px"},children:[t.jsx(l,{style:{fontSize:R?"14px":"16px",color:"#1890ff"}}),t.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:R?"nowrap":"normal",maxWidth:R?"260px":"none"},children:c.exhibition.venue})]})]})]})}),t.jsx(L,{xs:24,sm:24,md:12,children:t.jsxs("div",{style:{padding:R?"16px 5px":"24px",background:"linear-gradient(145deg, #ffffff, #f9fbfd)",borderRadius:"8px",border:"1px solid rgba(230, 235, 245, 0.8)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.03)"},children:[t.jsx("div",{style:{marginBottom:"16px",fontSize:R?"15px":"16px",fontWeight:600,color:"#444",textAlign:"center"},children:"Stall Status:"}),t.jsxs("div",{style:{display:"flex",flexDirection:R?"column":"row",justifyContent:"center",alignItems:"center",gap:R?"10px":"16px",width:"100%"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",width:R?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[t.jsx(oe,{status:"success"}),t.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Available"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#e6f7ff",border:"1px solid #91d5ff",width:R?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[t.jsx(oe,{status:"processing",color:"#1890ff"}),t.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Reserved"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px",borderRadius:"8px",background:"#fff7e6",border:"1px solid #ffd591",width:R?"90%":"30%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[t.jsx(oe,{status:"warning"}),t.jsx("span",{style:{marginLeft:"8px",fontWeight:500},children:"Booked"})]})]})]})})]}),t.jsxs("div",{ref:P,style:{width:"100%",height:R?"70vh":"80vh",minHeight:R?"400px":"600px",background:"#ffffff",borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid rgba(230, 235, 245, 0.8)",boxShadow:"inset 0 2px 6px rgba(0, 0, 0, 0.03)",willChange:"transform",contain:"content",isolation:"isolate"},className:"public-canvas-container",children:[t.jsx("style",{children:"\n                /* Hide only canvas context menu in public view */\n                .konvajs-content .ant-menu {\n                  display: none !important;\n                }\n                \n                /* Base canvas optimization */\n                .konvajs-content {\n                  will-change: transform;\n                  transform: translateZ(0);\n                  backface-visibility: hidden;\n                  transition: filter 0.2s ease-out;\n                }\n                \n                /* Fast layer for static background */\n                .public-canvas-container .konvajs-content canvas:first-child {\n                  image-rendering: auto;\n                }\n                \n                /* Canvas optimization for all canvases */\n                .public-canvas-container canvas {\n                  backface-visibility: hidden;\n                  -webkit-backface-visibility: hidden;\n                  transition: filter 0.15s linear;\n                }\n                \n                /* Dragging state - apply blur effect with better control */\n                .public-canvas-container .konvajs-content.dragging {\n                  filter: blur(1px);\n                }\n                \n                /* Mobile-specific blur - slightly stronger */\n                @media (max-width: 768px) {\n                  .public-canvas-container .konvajs-content.dragging {\n                    filter: blur(1.5px);\n                  }\n                }\n                \n                /* Performance optimizations for dragging */\n                .public-canvas-container .konvajs-content:active canvas {\n                  image-rendering: optimizeSpeed;\n                }\n                \n                /* Touch device optimizations */\n                @media (pointer: coarse) {\n                  .public-canvas-container .konvajs-content:active {\n                    touch-action: none;\n                  }\n                  \n                  .public-canvas-container .konvajs-content.dragging {\n                    filter: blur(2px); /* Stronger blur for touch devices */\n                  }\n                }\n                \n                /* Animation smoothing to reduce flickering */\n                .public-canvas-container .konvajs-content canvas {\n                  will-change: filter;\n                  transform: translateZ(0);\n                }\n                \n                /* Low-end device optimizations */\n                @media (max-width: 480px), \n                       (resolution: 150dpi),\n                       (any-pointer: coarse) {\n                  .public-canvas-container .konvajs-content:active canvas {\n                    image-rendering: optimizeSpeed;\n                  }\n                }\n              "}),t.jsxs(mt,{width:A.width,height:A.height,exhibitionWidth:(null==(s=null==c?void 0:c.exhibition.dimensions)?void 0:s.width)||0,exhibitionHeight:(null==(a=null==c?void 0:c.exhibition.dimensions)?void 0:a.height)||0,halls:(null==c?void 0:c.layout)||[],selectedHall:null,onSelectHall:()=>{},isStallMode:!0,onAddHall:()=>{},onAddStall:()=>{},onAddFixture:()=>{},onExhibitionChange:()=>{},isPublicView:!0,children:[null==W?void 0:W.halls,null==W?void 0:W.stalls,null==W?void 0:W.fixtures]})]})]})]}),g.length>0&&t.jsx(me,{offsetBottom:20,children:t.jsx("div",{style:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:t.jsxs(ge,{type:"primary",size:"large",icon:t.jsx(I,{}),onClick:async()=>{var e;try{if(!c)return;N(!0);let n=null;if(p){const e=c.layout.find((e=>e.stalls.some((e=>e.id===p))));e&&(n=e.stalls.find((e=>e.id===p))||null)}const i=c.layout.flatMap((e=>e.stalls.map((t=>({...t,hallId:e.id,hallName:e.name}))))).filter((e=>"available"===e.status));if(0===g.length&&null===p&&0===i.length)return void J.error("No stalls are available for booking");if(!c.exhibition.basicAmenities)try{const t=await z.getExhibition(o||"");(null==(e=null==t?void 0:t.data)?void 0:e.basicAmenities)&&h({...c,exhibition:{...c.exhibition,basicAmenities:t.data.basicAmenities}})}catch(t){}T(i),y(!0)}catch(t){J.error("Failed to open booking form")}finally{N(!1)}},loading:k,style:{borderRadius:"30px",boxShadow:"0 6px 16px rgba(24, 144, 255, 0.25)",display:"flex",alignItems:"center",gap:"8px",padding:"0 22px",height:"48px",fontSize:"16px",fontWeight:500,background:"linear-gradient(145deg, #1890ff, #40a9ff)",border:"none",transition:"all 0.3s ease"},children:["Book Selected Stalls (",g.length,")"]})})}),t.jsx(Yt,{visible:f,stallDetails:E,selectedStallId:p,selectedStallIds:g,loading:k,exhibition:null==c?void 0:c.exhibition,onCancel:()=>{y(!1)},onSubmit:async e=>{try{N(!0);const n={...e,exhibitionId:null==c?void 0:c.exhibition._id,stallIds:e.selectedStalls};if(B){await z.exhibitorBookStalls(n);J.success("Your booking request has been submitted successfully! It is pending review by the admin.")}else{await z.bookMultipleStalls(o,n);J.success("Your booking request has been submitted successfully!")}if(y(!1),b([]),o)try{const e=await z.getLayout(o);h(e.data)}catch(t){}}catch(t){J.error("Failed to book stall. Please try again.")}finally{N(!1)}}})]}):t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(Gt,{style:{paddingTop:"64px"},children:t.jsx($,{children:t.jsx(he,{status:"error",title:"Invalid Exhibition Layout",subTitle:"Exhibition dimensions are not properly configured"})})})]})})),Zt=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"})),{Content:Jt}=ce,{Title:en,Text:tn,Paragraph:nn}=M,sn=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e;if(t.includes("logos/")||t.includes("sponsors/"))return`${R.defaults.baseURL}/public/images/${t}`;const n=localStorage.getItem("token"),i=`uploads/${t}`;return n?`${R.defaults.baseURL}/${i}?token=${n}`:`${R.defaults.baseURL}/${i}`},an=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),ln=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:n}=Re(),i=Fe(),[s,a]=e.useState(null),[r,c]=e.useState(!0),[h,x]=e.useState(null),[m,u]=e.useState("https://images.unsplash.com/photo-1567419099214-0dd03b43e8de?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");if(e.useEffect((()=>{(async()=>{try{if(!n)return void x("Exhibition ID is missing");c(!0),x(null);const e=await z.getExhibition(n);if(a(e.data),e.data.headerBackground){const t=sn(e.data.headerBackground);u(t);(new window.Image).src=t}else if(e.data.headerLogo){const t=sn(e.data.headerLogo);(new window.Image).src=t}}catch(e){x(e.message||"Error fetching exhibition")}finally{c(!1)}})()}),[n]),r)return t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(Jt,{style:{paddingTop:"64px"},children:t.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[t.jsx(de,{size:"large"}),t.jsx("p",{style:{marginTop:16},children:"Loading exhibition details..."})]})})]});if(h||!s)return t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(Jt,{style:{paddingTop:"64px"},children:t.jsx(he,{status:"404",title:"Exhibition not found",subTitle:h||"The exhibition you're looking for doesn't exist or has been removed.",extra:t.jsx(ge,{type:"primary",onClick:()=>i("/exhibitions"),children:"Back to Exhibitions"})})})]});const{status:g,color:b}=((e,t)=>{const n=new Date,i=new Date(e),s=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>s?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}})(s.startDate,s.endDate),f=((e,t)=>{const n=new Date,i=new Date(e),s=new Date(t);if(n<i){const e=i.getTime()-n.getTime(),t=Math.ceil(e/864e5);return{text:`Day${1!==t?"s":""} until start`,count:t,isPast:!1}}if(n>s){const e=n.getTime()-s.getTime(),t=Math.ceil(e/864e5);return{text:`Day${1!==t?"s":""} since end`,count:t,isPast:!0}}{const e=s.getTime()-n.getTime(),t=Math.ceil(e/864e5);return{text:`Day${1!==t?"s":""} remaining`,count:t,isPast:!1}}})(s.startDate,s.endDate);return t.jsxs(ce,{className:"exhibition-details-layout",children:[t.jsx(Me,{}),t.jsxs(Jt,{className:"exhibition-content",children:[t.jsx("div",{className:"breadcrumb-container",children:t.jsx(pe,{items:[{title:t.jsx($e,{to:"/",children:t.jsx(N,{})})},{title:t.jsx($e,{to:"/exhibitions",children:"Exhibitions"})},{title:s.name}]})}),t.jsx("div",{className:"exhibition-hero",style:{backgroundImage:`url('${m}')`},children:t.jsx("div",{className:"hero-overlay",children:t.jsxs("div",{className:"hero-content",children:[t.jsxs("div",{className:"hero-main",children:[t.jsx(en,{level:1,className:"exhibition-title",children:s.name}),t.jsxs(_,{size:24,className:"exhibition-meta",children:[t.jsxs("div",{className:"meta-item",children:[t.jsx(C,{}),t.jsxs(tn,{children:[an(s.startDate)," - ",an(s.endDate)]})]}),s.venue&&t.jsxs("div",{className:"meta-item",children:[t.jsx(p,{}),t.jsx(tn,{children:s.venue})]}),t.jsxs("div",{className:"meta-item",children:[t.jsx(E,{}),t.jsxs(tn,{children:[f.text,": ",t.jsx("strong",{children:f.count})]})]})]})]}),t.jsxs("div",{className:"hero-actions",children:[t.jsx(ge,{type:"primary",size:"large",icon:t.jsx(o,{}),onClick:()=>i(`/exhibitions/${n}/layout`),className:"action-button layout-button",children:"View Exhibition Layout"}),t.jsx(ge,{size:"large",icon:t.jsx(d,{}),onClick:()=>i(`/exhibitions/${n}/layout`),className:"action-button book-button",children:"Book a Stall"}),f.isPast?null:t.jsx(ge,{size:"large",icon:t.jsx(T,{}),onClick:()=>i("/exhibitor/login"),className:"action-button exhibitor-button",children:"Exhibitor Access"})]})]})})}),t.jsx("div",{className:"stats-container",children:t.jsxs(q,{gutter:[16,16],className:"stats-row",children:[t.jsx(L,{xs:24,sm:8,children:t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon duration-icon",children:t.jsx(C,{})}),t.jsxs("div",{className:"stat-content",children:[t.jsx("div",{className:"stat-value",children:Math.ceil((new Date(s.endDate).getTime()-new Date(s.startDate).getTime())/864e5)}),t.jsx("div",{className:"stat-label",children:"Days Duration"})]})]})}),t.jsx(L,{xs:24,sm:8,children:t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon countdown-icon",children:t.jsx(E,{})}),t.jsxs("div",{className:"stat-content",children:[t.jsx("div",{className:"stat-value",children:f.count}),t.jsx("div",{className:"stat-label",children:f.text})]})]})}),t.jsx(L,{xs:24,sm:8,children:t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-icon status-icon",style:{backgroundColor:b+"20",color:b},children:t.jsx(l,{})}),t.jsxs("div",{className:"stat-content",children:[t.jsx("div",{className:"stat-value status-value",style:{color:b},children:g}),t.jsx("div",{className:"stat-label",children:"Status"})]})]})})]})}),s.sponsorLogos&&s.sponsorLogos.length>0&&t.jsxs("div",{className:"sponsors-section",children:[t.jsx("div",{className:"sponsors-header",children:t.jsx(tn,{type:"secondary",children:"PROUDLY SPONSORED BY"})}),t.jsx("div",{className:"sponsors-container",children:s.sponsorLogos.map(((e,n)=>t.jsx("div",{className:"sponsor-logo-wrapper",children:t.jsx("div",{className:"sponsor-logo",children:t.jsx("img",{src:sn(e),alt:`Sponsor ${n+1}`,className:"sponsor-logo-img",onError:e=>{e.target.src="/placeholder-logo.png"}})})},n)))})]}),t.jsx("div",{className:"exhibition-details-container",children:t.jsxs(q,{gutter:[24,24],children:[t.jsx(L,{xs:24,lg:16,children:t.jsxs($,{className:"details-card about-card",bordered:!1,children:[t.jsx(en,{level:3,className:"section-title",children:"About This Exhibition"}),t.jsx(nn,{className:"main-description",children:s.description}),s.headerDescription&&t.jsx(nn,{className:"extended-description",children:s.headerDescription}),s.headerSubtitle&&t.jsxs("div",{className:"subtitle-section",children:[t.jsx(en,{level:4,children:s.headerSubtitle}),t.jsx(X,{})]})]})}),t.jsx(L,{xs:24,lg:8,children:t.jsx(_,{direction:"vertical",style:{width:"100%"},size:24,children:t.jsx($,{title:"Key Information",className:"details-card info-card",bordered:!1,children:t.jsxs("div",{className:"info-grid",children:[t.jsxs("div",{className:"info-item",children:[t.jsx("div",{className:"info-icon start-icon",children:t.jsx(C,{})}),t.jsxs("div",{className:"info-content",children:[t.jsx(tn,{type:"secondary",className:"info-label",children:"Start Date"}),t.jsx("div",{className:"info-value",children:an(s.startDate)})]})]}),t.jsxs("div",{className:"info-item",children:[t.jsx("div",{className:"info-icon end-icon",children:t.jsx(C,{})}),t.jsxs("div",{className:"info-content",children:[t.jsx(tn,{type:"secondary",className:"info-label",children:"End Date"}),t.jsx("div",{className:"info-value",children:an(s.endDate)})]})]}),s.venue&&t.jsxs("div",{className:"info-item",children:[t.jsx("div",{className:"info-icon venue-icon",children:t.jsx(p,{})}),t.jsxs("div",{className:"info-content",children:[t.jsx(tn,{type:"secondary",className:"info-label",children:"Venue"}),t.jsx("div",{className:"info-value",children:s.venue})]})]})]})})})})]})})]}),t.jsx("style",{children:'\n        .exhibition-details-layout {\n          background-color: #f9fafc;\n        }\n        \n        .exhibition-content {\n          padding-top: 64px;\n          min-height: calc(100vh - 64px);\n        }\n        \n        .breadcrumb-container {\n          max-width: 1280px;\n          margin: 0 auto;\n          padding: 16px 24px;\n        }\n        \n        /* Hero Section */\n        .exhibition-hero {\n          height: 500px;\n          background-size: cover;\n          background-position: center;\n          position: relative;\n          color: white;\n          margin-bottom: 0;\n        }\n        \n        .hero-overlay {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: linear-gradient(to bottom, rgba(20, 20, 40, 0.7), rgba(20, 20, 40, 0.9));\n          display: flex;\n          align-items: center;\n        }\n        \n        .hero-content {\n          max-width: 1280px;\n          width: 100%;\n          margin: 0 auto;\n          padding: 40px 24px;\n          display: flex;\n          flex-direction: column;\n          gap: 40px;\n        }\n        \n        .hero-main {\n          max-width: 800px;\n        }\n        \n        .exhibition-title {\n          color: #fff !important;\n          margin-bottom: 32px !important;\n          font-size: 3.5rem !important;\n          font-weight: 700 !important;\n          line-height: 1.2 !important;\n          letter-spacing: -0.5px;\n          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n        }\n        \n        .exhibition-meta {\n          margin-bottom: 24px;\n        }\n        \n        .meta-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        \n        .meta-item .anticon {\n          font-size: 18px;\n          color: rgba(255, 255, 255, 0.9);\n        }\n        \n        .meta-item span {\n          color: rgba(255, 255, 255, 0.9);\n          font-size: 16px;\n        }\n        \n        .hero-actions {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 16px;\n        }\n        \n        .action-button {\n          padding: 0 24px;\n          height: 48px;\n          font-weight: 500;\n          border-radius: 8px;\n          transition: all 0.3s ease;\n        }\n        \n        .layout-button {\n          background: #4361ee;\n          border-color: #4361ee;\n        }\n        \n        .layout-button:hover {\n          background: #3a56d4;\n          border-color: #3a56d4;\n          transform: translateY(-2px);\n          box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);\n        }\n        \n        .book-button {\n          background: white;\n          color: #111;\n          border-color: transparent;\n        }\n        \n        .book-button:hover {\n          background: #f8f9fa;\n          color: #4361ee;\n          transform: translateY(-2px);\n          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);\n        }\n        \n        .exhibitor-button {\n          border-color: rgba(255, 255, 255, 0.3);\n          color: white;\n          background: transparent;\n        }\n        \n        .exhibitor-button:hover {\n          border-color: white;\n          color: white;\n          background: rgba(255, 255, 255, 0.1);\n          transform: translateY(-2px);\n        }\n        \n        /* Stats Section */\n        .stats-container {\n          max-width: 1280px;\n          margin: 0 auto;\n          padding: 0 24px;\n          margin-top: -50px;\n          margin-bottom: 40px;\n          position: relative;\n          z-index: 5;\n        }\n        \n        .stats-row {\n          margin: 0;\n        }\n        \n        .stat-card {\n          background: white;\n          padding: 24px;\n          border-radius: 12px;\n          display: flex;\n          gap: 20px;\n          align-items: center;\n          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);\n          height: 100%;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        \n        .stat-card:hover {\n          transform: translateY(-5px);\n          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);\n        }\n        \n        .stat-icon {\n          width: 60px;\n          height: 60px;\n          border-radius: 12px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 24px;\n        }\n        \n        .duration-icon {\n          background-color: #4361ee20;\n          color: #4361ee;\n        }\n        \n        .countdown-icon {\n          background-color: #f7257520;\n          color: #f72575;\n        }\n        \n        .stat-content {\n          flex: 1;\n        }\n        \n        .stat-value {\n          font-size: 28px;\n          font-weight: 700;\n          line-height: 1.2;\n          color: #111827;\n        }\n        \n        .stat-label {\n          font-size: 14px;\n          color: #6b7280;\n          margin-top: 4px;\n        }\n        \n        /* Sponsor Logos Styles */\n        .sponsors-section {\n          max-width: 1280px;\n          margin: 0 auto 40px;\n          padding: 36px 24px;\n          background: #fff;\n          border-radius: 16px;\n          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);\n        }\n        \n        .sponsors-header {\n          text-align: center;\n          margin-bottom: 30px;\n        }\n        \n        .sponsors-header .ant-typography {\n          font-size: 14px;\n          letter-spacing: 2px;\n          font-weight: 600;\n          color: #6b7280;\n          position: relative;\n          display: inline-block;\n        }\n        \n        .sponsors-header .ant-typography:before,\n        .sponsors-header .ant-typography:after {\n          content: "";\n          position: absolute;\n          top: 50%;\n          width: 40px;\n          height: 1px;\n          background: #e5e7eb;\n        }\n        \n        .sponsors-header .ant-typography:before {\n          right: 100%;\n          margin-right: 15px;\n        }\n        \n        .sponsors-header .ant-typography:after {\n          left: 100%;\n          margin-left: 15px;\n        }\n        \n        .sponsors-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 30px;\n          justify-content: center;\n          align-items: center;\n        }\n        \n        .sponsor-logo-wrapper {\n          display: inline-flex;\n          transition: transform 0.3s ease;\n        }\n        \n        .sponsor-logo-wrapper:hover {\n          transform: translateY(-5px);\n        }\n        \n        .sponsor-logo {\n          width: 190px;\n          height: auto;\n          border-radius: 8px;\n          overflow: hidden;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background-color: #ffffff;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n          padding: 20px;\n          transition: box-shadow 0.3s ease;\n        }\n        \n        .sponsor-logo:hover {\n          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n        }\n        \n        .sponsor-logo-img {\n          max-width: 100%;\n          max-height: 100%;\n          object-fit: contain;\n        }\n        \n        /* Details Section */\n        .exhibition-details-container {\n          max-width: 1280px;\n          margin: 0 auto;\n          padding: 0 24px 60px;\n        }\n        \n        .details-card {\n          border-radius: 16px;\n          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);\n          overflow: hidden;\n          height: 100%;\n        }\n        \n        .about-card .ant-card-body {\n          padding: 32px;\n        }\n        \n        .section-title {\n          margin-bottom: 24px !important;\n          font-weight: 700 !important;\n          color: #111827 !important;\n          font-size: 28px !important;\n          position: relative;\n        }\n        \n        .section-title:after {\n          content: "";\n          position: absolute;\n          left: 0;\n          bottom: -12px;\n          width: 60px;\n          height: 4px;\n          background: #4361ee;\n          border-radius: 2px;\n        }\n        \n        .main-description {\n          font-size: 16px !important;\n          line-height: 1.7 !important;\n          margin-bottom: 24px !important;\n          color: #374151 !important;\n        }\n        \n        .extended-description {\n          font-size: 16px !important;\n          line-height: 1.7 !important;\n          margin-bottom: 24px !important;\n          color: #6b7280 !important;\n        }\n        \n        .subtitle-section {\n          margin: 24px 0;\n        }\n        \n        .subtitle-section .ant-typography {\n          color: #111827;\n          font-weight: 600;\n        }\n        \n        .info-card .ant-card-head {\n          border-bottom: none;\n          padding: 20px 24px 0;\n        }\n        \n        .info-card .ant-card-head-title {\n          font-weight: 600;\n          font-size: 18px;\n          color: #111827;\n        }\n        \n        .info-card .ant-card-body {\n          padding: 16px 24px 24px;\n        }\n        \n        .info-grid {\n          display: flex;\n          flex-direction: column;\n          gap: 24px;\n        }\n        \n        .info-item {\n          display: flex;\n          align-items: flex-start;\n          gap: 16px;\n        }\n        \n        .info-icon {\n          width: 40px;\n          height: 40px;\n          border-radius: 8px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 18px;\n        }\n        \n        .start-icon {\n          background-color: #4361ee20;\n          color: #4361ee;\n        }\n        \n        .end-icon {\n          background-color: #f7257520;\n          color: #f72575;\n        }\n        \n        .venue-icon {\n          background-color: #0ea5e920;\n          color: #0ea5e9;\n        }\n        \n        .info-content {\n          flex: 1;\n        }\n        \n        .info-label {\n          display: block;\n          margin-bottom: 4px;\n          font-size: 14px;\n        }\n        \n        .info-value {\n          font-size: 16px;\n          font-weight: 500;\n          color: #111827;\n        }\n        \n        @media (max-width: 991px) {\n          .exhibition-hero {\n            height: auto;\n            min-height: 350px;\n          }\n          \n          .hero-overlay {\n            position: relative;\n            padding: 50px 0;\n          }\n          \n          .exhibition-title {\n            font-size: 2.5rem !important;\n          }\n          \n          .stats-container {\n            margin-top: 0;\n          }\n          \n          .stat-card {\n            margin-bottom: 16px;\n          }\n        }\n        \n        @media (max-width: 768px) {\n          .exhibition-title {\n            font-size: 2rem !important;\n            margin-bottom: 24px !important;\n          }\n          \n          .hero-content {\n            padding: 40px 20px;\n          }\n          \n          .hero-actions {\n            flex-direction: column;\n            width: 100%;\n          }\n          \n          .hero-actions button {\n            width: 100%;\n          }\n          \n          .sponsors-container {\n            gap: 20px;\n          }\n          \n          .sponsor-logo {\n            width: 150px;\n          }\n          \n          .stats-container {\n            padding: 0 16px;\n          }\n          \n          .stat-card {\n            padding: 16px;\n          }\n          \n          .stat-icon {\n            width: 50px;\n            height: 50px;\n            font-size: 20px;\n          }\n          \n          .stat-value {\n            font-size: 22px;\n          }\n          \n          .exhibition-details-container {\n            padding: 0 16px 40px;\n          }\n          \n          .about-card .ant-card-body {\n            padding: 24px;\n          }\n          \n          .section-title {\n            font-size: 24px !important;\n          }\n        }\n        \n        @media (max-width: 480px) {\n          .exhibition-title {\n            font-size: 1.75rem !important;\n          }\n          \n          .meta-item {\n            flex-direction: column;\n            align-items: flex-start;\n            gap: 4px;\n          }\n        }\n        '})]})}},Symbol.toStringTag,{value:"Module"})),{Title:on,Text:rn,Paragraph:dn}=M,{Content:cn}=ce,hn=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),xn=e=>{if(!e)return"/exhibition-placeholder.jpg";if(e.startsWith("/"))return e;if(e.startsWith("http"))return e;const t=e.startsWith("/")?e.substring(1):e,n=t.includes("logos/")?t:`logos/${t}`;return`${R.defaults.baseURL}/public/images/${n}`},mn=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const n=Fe(),[i,s]=e.useState([]),[a,l]=e.useState(!0),[o,r]=e.useState(null),[d,c]=e.useState({});return e.useEffect((()=>{(async()=>{try{l(!0),r(null);const e=await z.getExhibitions();s(e.data);const t={};e.data.forEach((e=>{if(e.headerLogo){const n=xn(e.headerLogo),i=new window.Image;i.onload=()=>{t[e._id]=!0,c((t=>({...t,[e._id]:!0})))},i.onerror=()=>{t[e._id]=!1,c((t=>({...t,[e._id]:!1})))},i.src=n}}))}catch(e){r(e.message||"Failed to fetch exhibitions")}finally{l(!1)}})()}),[]),a?t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(cn,{style:{paddingTop:"64px"},children:t.jsxs("div",{style:{textAlign:"center",padding:"48px"},children:[t.jsx(de,{size:"large"}),t.jsx("p",{style:{marginTop:16},children:"Loading exhibitions..."})]})})]}):o?t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(cn,{style:{paddingTop:"64px"},children:t.jsx(he,{status:"error",title:"Failed to load exhibitions",subTitle:o,extra:[t.jsx(ge,{type:"primary",onClick:()=>window.location.reload(),children:"Try Again"},"retry")]})})]}):t.jsxs(ce,{children:[t.jsx(Me,{}),t.jsx(cn,{style:{paddingTop:"64px",background:"#f5f5f5"},children:t.jsxs("div",{style:{padding:"80px 16px"},children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:40},children:[t.jsx(on,{level:2,style:{marginBottom:12,fontSize:36},children:"Upcoming & Current Exhibitions"}),t.jsx(dn,{type:"secondary",style:{fontSize:16,maxWidth:600,margin:"0 auto"},children:"Discover and explore our exhibitions. Click on any card to view details and book stalls."})]}),i.length>0?t.jsx(q,{gutter:[24,24],children:i.map((e=>{const{status:i,color:s}=((e,t)=>{const n=new Date,i=new Date(e),s=new Date(t);return n<i?{status:"Upcoming",color:"#722ED1"}:n>s?{status:"Completed",color:"#8C8C8C"}:{status:"Active",color:"#52C41A"}})(e.startDate,e.endDate),a=(e=>{const t=new Date,n=new Date(e).getTime()-t.getTime();return Math.ceil(n/864e5)})(e.startDate),l=e.headerLogo?xn(e.headerLogo):void 0;return t.jsx(L,{xs:24,sm:12,lg:8,children:t.jsxs($,{hoverable:!0,onClick:()=>n(We(e)),className:"exhibition-card",styles:{body:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"}},style:{borderRadius:"12px",overflow:"hidden",height:"100%",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},children:[t.jsx(oe.Ribbon,{text:i,color:s,style:{right:"-1px",top:"10px",zIndex:2}}),t.jsxs("div",{className:"exhibition-card-container",children:[t.jsx("div",{className:"exhibition-card-logo-container",children:l&&t.jsx("div",{className:"exhibition-logo",children:t.jsx(xe,{src:l,alt:`${e.name} logo`,preview:!1,fallback:"/exhibition-placeholder.jpg",placeholder:t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#f0f0f0"},children:t.jsx(de,{size:"small"})}),style:{width:"100%",height:"100%",objectFit:"contain"}})})}),t.jsxs("div",{className:"exhibition-card-content",children:[t.jsx("div",{className:"exhibition-title",children:t.jsx(on,{level:4,ellipsis:{rows:2},style:{marginBottom:8,fontSize:20,lineHeight:"28px"},children:e.name})}),t.jsx(dn,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:16,fontSize:14},children:e.description}),t.jsxs("div",{className:"exhibition-card-details",children:[t.jsxs("div",{className:"exhibition-card-detail-item",children:[t.jsx(C,{style:{color:"#722ED1"}}),t.jsx(K,{title:"Exhibition Date Range",children:t.jsxs(rn,{style:{fontSize:14},children:[hn(e.startDate)," - ",hn(e.endDate)]})})]}),e.venue&&t.jsxs("div",{className:"exhibition-card-detail-item",children:[t.jsx(p,{style:{color:"#F5222D"}}),t.jsx(K,{title:"Venue",children:t.jsx(rn,{style:{fontSize:14},ellipsis:!0,children:e.venue})})]}),"Upcoming"===i&&a>0&&t.jsxs("div",{className:"exhibition-card-detail-item",children:[t.jsx(E,{style:{color:"#1890FF"}}),t.jsx(K,{title:"Time Remaining",children:t.jsxs(rn,{style:{fontSize:14},children:["Starts in ",a," day",1!==a?"s":""]})})]})]}),t.jsx("div",{className:"exhibition-card-footer",children:t.jsxs(ge,{type:"link",className:"view-details-btn",style:{padding:0,height:"auto",fontSize:14,fontWeight:500},children:["View Details ",t.jsx(P,{})]})})]})]})]})},e._id)}))}):t.jsx(ae,{description:"No exhibitions currently available",style:{background:"#fff",padding:"48px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.06)"},image:ae.PRESENTED_IMAGE_SIMPLE})]})}),t.jsx(qe,{}),t.jsx("style",{children:"\n        .exhibition-card {\n          transition: all 0.3s ease;\n        }\n        \n        .exhibition-card:hover {\n          transform: translateY(-5px);\n          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 6px 6px rgba(0, 0, 0, 0.06) !important;\n        }\n        \n        .exhibition-card-container {\n          display: flex;\n          flex-direction: row;\n          width: 100%;\n          height: 100%;\n        }\n        \n        .exhibition-card-logo-container {\n          width: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          padding: 24px;\n          background-color: #f9f9f9;\n          border-right: 1px solid #eaeaea;\n        }\n        \n        .exhibition-logo {\n          position: relative;\n          flex-shrink: 0;\n          width: 100%;\n          height: 172px;\n          border-radius: 8px;\n          overflow: hidden;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background-color: #f0f0f0;\n          border: 1px solid #e8e8e8;\n        }\n        \n        .exhibition-card-content {\n          width: 50%;\n          padding: 24px;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .exhibition-title {\n          margin-right: 36px;\n        }\n        \n        .exhibition-card-details {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n          margin-bottom: 24px;\n        }\n        \n        .exhibition-card-detail-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        \n        .exhibition-card-footer {\n          margin-top: auto;\n        }\n        \n        .view-details-btn {\n          color: #722ED1;\n        }\n        \n        .view-details-btn:hover {\n          color: #9254DE;\n        }\n        \n        .view-details-btn .anticon {\n          transition: transform 0.3s ease;\n        }\n        \n        .view-details-btn:hover .anticon {\n          transform: translateX(4px);\n        }\n        \n        @media (max-width: 575px) {\n          .exhibition-card-container {\n            flex-direction: column;\n          }\n          \n          .exhibition-card-logo-container {\n            width: 100%;\n            border-right: none;\n            border-bottom: 1px solid #eaeaea;\n            padding: 20px;\n          }\n          \n          .exhibition-logo {\n            height: 140px;\n          }\n          \n          .exhibition-card-content {\n            width: 100%;\n            padding: 20px;\n          }\n        }\n        "})]})}},Symbol.toStringTag,{value:"Module"}));export{mt as C,lt as E,Nt as F,pt as H,Zt as P,xt as S,We as a,gt as b,_e as c,ln as d,mn as e,He as g};
