import{n as ye,r as c,a as ne,j as e,l as fe,b as oe,u as we,R as Se}from"./vendor-react-core-B0uGejYc.js";import{j as q,v as ce}from"./app-core-L3PgNZOI.js";import{F as O,a as se,S as _,B as b,P as de,M as ie,I as U,s as E,A as Ae,T as Ce,g as K,b as le,p as Te,e as Ee,h as De}from"./vendor-antd-core-PMpIrrMR.js";import{ad as ke,z as re,q as me,ag as Le,w as Re,j as Oe,ah as Pe,t as $e,n as Me}from"./vendor-antd-icons-DK8C9GTH.js";import{f as Fe}from"./vendor-redux-GR4hUpLs.js";import{d as ae}from"./vendor-date-utils-3BRsAYU6.js";import{f as _e}from"./app-exhibition-CF4MSB7I.js";const Be="/api",Ge=ye({reducerPath:"invoiceApi",baseQuery:Fe({baseUrl:Be,credentials:"include",prepareHeaders:s=>{const i=localStorage.getItem("token");return i&&s.set("authorization",`Bearer ${i}`),s.set("Content-Type","application/json"),s.set("Accept","application/json"),s}}),tagTypes:["Invoice"],endpoints:s=>({getInvoices:s.query({query:(i={page:1,limit:10})=>({url:"/invoices",method:"GET",params:i}),transformResponse:i=>(console.log("Raw invoice response:",i),typeof i=="object"&&i!==null&&"data"in i?i:Array.isArray(i)?{success:!0,data:i,pagination:{total:i.length,page:1,limit:i.length,pages:1}}:(console.error("Invalid invoice response:",i),{success:!1,data:[],pagination:{total:0,page:1,limit:10,pages:0}})),transformErrorResponse:i=>(console.error("Invoice API Error:",i),i),providesTags:["Invoice"]}),getInvoice:s.query({query:i=>({url:`/invoices/${i}`,method:"GET"}),transformErrorResponse:i=>(console.error("Get Invoice Error:",i),i),providesTags:(i,l,P)=>[{type:"Invoice",id:P}]}),downloadInvoice:s.mutation({query:i=>({url:`/invoices/${i}/download`,method:"GET",responseHandler:l=>l.blob()})}),shareViaEmail:s.mutation({query:({id:i,...l})=>({url:`/invoices/${i}/share/email`,method:"POST",body:l})}),shareViaWhatsApp:s.mutation({query:({id:i,...l})=>({url:`/invoices/${i}/share/whatsapp`,method:"POST",body:l})})})}),{useGetInvoicesQuery:Ue,useGetInvoiceQuery:Ve,useShareViaEmailMutation:We}=Ge,qe=({booking:s})=>{var f,z,R;const[i,l]=c.useState(null),[P,$]=c.useState(!0),x=ne(t=>t.settings.settings);c.useEffect(()=>{(async()=>{$(!0);try{if(s.exhibitionId.headerLogo){const o=s.exhibitionId.headerLogo;l(`${q.defaults.baseURL}/public/uploads/${o}`),console.log("Using exhibition header logo:",o)}else if(x!=null&&x.logo){const o=x.logo;l(`${q.defaults.baseURL}/public/uploads/${o}`),console.log("Using global settings logo:",o)}else{const o=`${q.defaults.baseURL}/public/logo`;l(o),console.log("Using public logo endpoint:",o)}}catch(o){console.error("Error loading logo:",o),l(null)}finally{$(!1)}})()},[s.exhibitionId.headerLogo,x==null?void 0:x.logo]);const D=()=>{const t=new Date(s.exhibitionId.startDate||""),o=new Date(s.exhibitionId.endDate||""),w={};let g=new Date(t);for(;g<=o;){const m=g.toLocaleString("default",{month:"short",year:"numeric"});w[m]||(w[m]=[]),w[m].push(g.getDate().toString().padStart(2,"0")),g=new Date(g),g.setDate(g.getDate()+1)}const V=Object.entries(w).map(([m,Y])=>`${Y.join(", ")} ${m}`);return`${s.exhibitionId.name||"ABSE"} (${V.join(" & ")})`},S=t=>{const o=new Date(t);return{date:o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),time:o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}},p=s.stallIds.map((t,o)=>{var m;const w=t,g=t.dimensions.width*t.dimensions.height,V=g*t.ratePerSqm;return{key:t._id,sn:o+1,stallNo:t.number,stallType:((m=w.stallTypeId)==null?void 0:m.name)||"Standard",dimensions:`${t.dimensions.width}x${t.dimensions.height}m`,area:g.toFixed(0),rate:t.ratePerSqm.toFixed(0),amount:V}}),I=p.reduce((t,o)=>t+o.amount,0),v=s.calculations,u=((f=v.stalls[0])==null?void 0:f.discount)!==void 0&&((z=v.stalls[0])==null?void 0:z.discount)!==null,r=u?(R=v.stalls[0])==null?void 0:R.discount:null,k=(r==null?void 0:r.type)||"percentage",A=(r==null?void 0:r.value)||0;let y=0;u&&A>0&&(k==="percentage"?y=Math.round(I*A/100*100)/100:k==="fixed"&&(y=Math.min(A,I)));const d=I-y,j=v.taxes.find(t=>t.name.includes("GST")),N=j?j.rate:18,L=Math.round(d*N/100*100)/100,M=d+L,B=I,h=y,X=d,C=L,Z=M;return e.jsx("div",{className:"invoice-container",children:e.jsxs("div",{className:"proforma-invoice",children:[e.jsxs("div",{className:"header-section",children:[e.jsx("div",{className:"logo-cell",children:P?e.jsx("div",{className:"logo-loading",children:"Loading..."}):i?e.jsx("img",{src:i,alt:s.exhibitionId.companyName,className:"logo-image",onError:()=>l(null)}):s.exhibitionId.companyName}),e.jsxs("div",{className:"title-company",children:[e.jsx("div",{className:"title-cell",children:"PROFORMA INVOICE"}),e.jsx("div",{className:"company-cell",children:s.exhibitionId.companyName})]})]}),e.jsxs("div",{className:"bill-to-section",children:[e.jsx("div",{className:"bill-to-cell",children:"Bill To"}),e.jsxs("div",{className:"bill-to-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Company Name"}),e.jsx("div",{className:"value-cell",children:s.companyName}),e.jsx("div",{className:"date-label-cell",children:"Date"}),e.jsx("div",{className:"date-value-cell",children:S(s.createdAt).date})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Phone No."}),e.jsx("div",{className:"value-cell",children:s.customerPhone}),e.jsx("div",{className:"date-label-cell",children:"Time"}),e.jsx("div",{className:"date-value-cell",children:S(s.createdAt).time})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"GST No."}),e.jsx("div",{className:"value-cell",children:s.customerGSTIN}),e.jsx("div",{className:"date-label-cell",children:"Invoice No"}),e.jsx("div",{className:"date-value-cell",children:s.invoiceNumber})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("div",{className:"label-cell",children:"Address"}),e.jsx("div",{className:"value-cell",children:s.customerAddress})]})]})]}),e.jsxs("div",{className:"expo-venue-section",children:[e.jsxs("div",{className:"expo-column",children:[e.jsx("div",{className:"heading",children:"Expo Name"}),e.jsx("div",{className:"content",children:D()})]}),e.jsxs("div",{className:"venue-column",children:[e.jsx("div",{className:"heading",children:"Venue"}),e.jsx("div",{className:"content",children:s.exhibitionId.venue})]})]}),e.jsx("div",{className:"section-header stall-summary-header",children:"Stall Summary"}),e.jsxs("div",{className:"stall-table",children:[e.jsxs("div",{className:"stall-header",children:[e.jsx("div",{className:"stall-header-cell",children:"S/N"}),e.jsx("div",{className:"stall-header-cell",children:"Stall No."}),e.jsx("div",{className:"stall-header-cell",children:"Stall Type"}),e.jsx("div",{className:"stall-header-cell",children:"Dimensions"}),e.jsx("div",{className:"stall-header-cell",children:"Area (sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Rate (per sqm)"}),e.jsx("div",{className:"stall-header-cell",children:"Amount"})]}),p.map(t=>e.jsxs("div",{className:"stall-row",children:[e.jsx("div",{className:"stall-cell",children:t.sn}),e.jsx("div",{className:"stall-cell",children:t.stallNo}),e.jsx("div",{className:"stall-cell",children:t.stallType}),e.jsx("div",{className:"stall-cell",children:t.dimensions}),e.jsx("div",{className:"stall-cell",children:t.area}),e.jsx("div",{className:"stall-cell",children:Number(t.rate).toLocaleString("en-IN")}),e.jsx("div",{className:"stall-cell",children:t.amount.toLocaleString("en-IN")})]},t.key))]}),e.jsx("div",{className:"section-header",children:"Calculation Summary"}),e.jsxs("div",{className:"calc-table",children:[e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:"Total Basic Amount"}),e.jsxs("div",{className:"calc-value",children:["₹",B.toLocaleString("en-IN")]})]}),u&&h>0&&e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:k==="percentage"?`Discount (${A}%)`:`Discount (Fixed ₹${A.toLocaleString("en-IN")})`}),e.jsxs("div",{className:"calc-value",children:["-₹",h.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsx("div",{className:"calc-label",children:u&&h>0?"Amount after Discount":"Net Amount"}),e.jsxs("div",{className:"calc-value",children:["₹",X.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row",children:[e.jsxs("div",{className:"calc-label",children:["GST (",N,"%)"]}),e.jsxs("div",{className:"calc-value",children:["₹",C.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"calc-row total-row",children:[e.jsx("div",{className:"calc-label",children:"Total Amount"}),e.jsxs("div",{className:"calc-value",children:["₹",Z.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"details-section",children:[e.jsxs("div",{className:"bank-details",children:[e.jsx("div",{className:"details-header",children:"Bank Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Bank Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Account No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccount})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Name"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankAccountName})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Branch"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankBranch})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"IFSC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.bankIFSC})]})]}),e.jsxs("div",{className:"company-details",children:[e.jsx("div",{className:"details-header",children:"Company Details"}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"CIN No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyCIN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Pan No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyPAN})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"SAC CODE"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companySAC})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"GST No."}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyGST})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Email"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyEmail})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Website"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyWebsite})]}),e.jsxs("div",{className:"details-row",children:[e.jsx("div",{className:"detail-label",children:"Address"}),e.jsx("div",{className:"detail-value",children:s.exhibitionId.companyAddress})]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"PI Instruction"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.piInstructions||"THIS INVOICE IS PROFORMA INVOICE DO NOT CLAIM ANY GOVERNMENT CREDITS ON THIS PROFORMA INVOICE. FINAL INVOICE WOULD BE RAISED AFTER 100% PAYMENT."}})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("div",{className:"instruction-header",children:"Terms & Conditions"}),e.jsx("div",{className:"instruction-content",dangerouslySetInnerHTML:{__html:s.exhibitionId.termsAndConditions||'All cheques / Drafts should be payable to "AAKAR EXHIBITION Private Limited". This bill is payable as per agreed terms. All delayed payments will be charged interest @ 18% p.a. All Complaints / Disputes, if any on this bill should reach us within 15 days on receipt of bill, failing which the bill becomes fully payable. Subject to Ahmedabad Jurisdiction.'}})]}),e.jsx("div",{className:"signature-section",children:e.jsx("div",{className:"signature-text",children:"Authorised Signature"})})]})})},ze=()=>{const{id:s}=fe(),i=oe(),{data:l,isLoading:P}=Ve(s||""),[$,x]=c.useState(!1),[D,S]=c.useState(!1),[p]=O.useForm(),[I,v]=c.useState(0),[u,r]=c.useState(!1),k=async()=>{if(s)try{r(!0),v(0),E.loading({content:"Preparing invoice...",key:"download"});const d=await ce(`/invoices/${s}/download?force=false`,!1,L=>{const M=L.total,B=L.loaded;if(M){const h=Math.round(B*100/M);v(h),h%25===0&&E.loading({content:`Downloading: ${h}% complete`,key:"download"})}}),j=window.URL.createObjectURL(new Blob([d.data])),N=document.createElement("a");N.href=j,N.setAttribute("download",`invoice-${s}.pdf`),document.body.appendChild(N),N.click(),N.remove(),window.URL.revokeObjectURL(j),E.success({content:"Invoice downloaded successfully",key:"download"})}catch(d){console.error("Download error:",d),E.error({content:"Failed to download invoice",key:"download"})}finally{r(!1),v(0)}},A=async d=>{try{await q.post(`/invoices/${s}/share/email`,d),E.success("Invoice shared via email successfully"),x(!1),p.resetFields()}catch(j){console.error("Email sharing error:",j),E.error("Failed to share invoice via email")}},y=async d=>{try{await q.post(`/invoices/${s}/share/whatsapp`,d),E.success("Invoice shared via WhatsApp successfully"),S(!1),p.resetFields()}catch(j){console.error("WhatsApp sharing error:",j),E.error("Failed to share invoice via WhatsApp")}};return P||!l?e.jsx("div",{children:"Loading..."}):(console.log("Invoice data:",l),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(se,{title:"Invoice Details",extra:e.jsxs(_,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(_,{children:[e.jsx(b,{icon:e.jsx(ke,{}),onClick:()=>i(-1),disabled:u,children:"Back"}),e.jsx(b,{type:"primary",icon:e.jsx(re,{}),onClick:k,loading:u&&I<100,disabled:u&&I>=100,children:"Download"}),e.jsx(b,{icon:e.jsx(me,{}),onClick:()=>x(!0),disabled:u,children:"Share via Email"}),e.jsx(b,{icon:e.jsx(Le,{}),onClick:()=>S(!0),disabled:u,children:"Share via WhatsApp"})]}),u&&e.jsx(de,{percent:I,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]}),children:e.jsx(qe,{booking:{...l.bookingId,customerGSTIN:l.bookingId.customerGSTIN||"",invoiceNumber:l.invoiceNumber,exhibitionId:{...l.bookingId.exhibitionId,companyName:l.bookingId.exhibitionId.companyName||"Company Name",bankName:l.bookingId.exhibitionId.bankName||"",bankAccount:l.bookingId.exhibitionId.bankAccount||"",bankAccountName:l.bookingId.exhibitionId.bankAccountName||"",bankBranch:l.bookingId.exhibitionId.bankBranch||"",bankIFSC:l.bookingId.exhibitionId.bankIFSC||"",companyCIN:l.bookingId.exhibitionId.companyCIN||"",companyPAN:l.bookingId.exhibitionId.companyPAN||"",companySAC:l.bookingId.exhibitionId.companySAC||"",companyGST:l.bookingId.exhibitionId.companyGST||"",companyEmail:l.bookingId.exhibitionId.companyEmail||"",companyWebsite:l.bookingId.exhibitionId.companyWebsite||"",companyAddress:l.bookingId.exhibitionId.companyAddress||"",headerLogo:l.bookingId.exhibitionId.headerLogo||void 0},calculations:{...l.bookingId.calculations,stalls:l.bookingId.calculations.stalls.map(d=>({discount:d.discount?{...d.discount,type:d.discount.type||"percentage",value:d.discount.value}:void 0}))}}})}),e.jsx(ie,{title:"Share Invoice via Email",open:$,onCancel:()=>x(!1),footer:null,children:e.jsxs(O,{form:p,onFinish:A,layout:"vertical",children:[e.jsx(O.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(U,{placeholder:"Enter email address"})}),e.jsx(O.Item,{name:"message",label:"Message (Optional)",children:e.jsx(U.TextArea,{placeholder:"Enter optional message"})}),e.jsx(O.Item,{children:e.jsx(b,{type:"primary",htmlType:"submit",children:"Send"})})]})}),e.jsx(ie,{title:"Share Invoice via WhatsApp",open:D,onCancel:()=>S(!1),footer:null,children:e.jsxs(O,{form:p,onFinish:y,layout:"vertical",children:[e.jsx(O.Item,{name:"phoneNumber",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^\+?[1-9]\d{9,14}$/,message:"Please enter a valid phone number"}],children:e.jsx(U,{placeholder:"Enter phone number with country code"})}),e.jsx(O.Item,{children:e.jsx(b,{type:"primary",htmlType:"submit",children:"Send"})})]})})]}))},ia=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"})),{Title:Ye,Text:G}=Ce,{Option:J}=le,{RangePicker:He}=Te,Qe=()=>{var te;const s=oe(),i=we(),[l,P]=c.useState(1),[$,x]=c.useState(10),[D,S]=c.useState(""),[p,I]=c.useState(null),[v,u]=c.useState(null),[r,k]=c.useState(null),[A,y]=c.useState(!1),[d,j]=c.useState(null),[N,L]=c.useState(""),[M,B]=c.useState(""),[h,X]=c.useState("createdAt"),[C,Z]=c.useState("descend"),[f,z]=E.useMessage(),[R,t]=c.useState(null),[o,w]=c.useState(0),{exhibitions:g,loading:V}=ne(a=>a.exhibition);c.useEffect(()=>{i(_e())},[i]);const{data:m,isLoading:Y,refetch:he}=Ue({page:l,limit:$}),[ue,{isLoading:xe}]=We(),ve=Se.useMemo(()=>m!=null&&m.data?m.data.filter(a=>{const n=D.toLowerCase(),T=D===""||a.invoiceNumber&&a.invoiceNumber.toLowerCase().includes(n)||a._id.toLowerCase().includes(n)||a.bookingId.customerName&&a.bookingId.customerName.toLowerCase().includes(n)||a.bookingId.companyName&&a.bookingId.companyName.toLowerCase().includes(n),F=!p||a.status===p,H=!v||a.bookingId.exhibitionId&&a.bookingId.exhibitionId._id===v;let W=!0;if(r&&r[0]&&r[1]){const Q=ae(a.createdAt);W=Q.isAfter(r[0])&&Q.isBefore(r[1])}return T&&F&&H&&W}):[],[m,D,p,v,r]),pe=async a=>{try{t(a),w(0),f.loading({content:"Preparing invoice...",key:a});const n=await ce(`/invoices/${a}/download?force=false`,!1,H=>{const W=H.total,Q=H.loaded;if(W){const ee=Math.round(Q*100/W);w(ee),ee%25===0&&f.loading({content:`Downloading: ${ee}% complete`,key:a})}}),T=window.URL.createObjectURL(new Blob([n.data])),F=document.createElement("a");F.href=T,F.setAttribute("download",`invoice-${a}.pdf`),document.body.appendChild(F),F.click(),F.remove(),window.URL.revokeObjectURL(T),f.success({content:"Invoice downloaded successfully",key:a})}catch(n){console.error("Download error:",n),f.error({content:"Failed to download invoice",key:a})}finally{t(null),w(0)}},je=async()=>{if(!(!d||!N))try{f.loading({content:"Sending email...",key:"email"}),await ue({id:d,email:N,message:M||void 0}).unwrap(),f.success({content:"Invoice sent via email successfully",key:"email"}),y(!1),L(""),B(""),j(null)}catch(a){console.error("Email error:",a),f.error({content:"Failed to send invoice via email",key:"email"})}},Ne=a=>{j(a),y(!0)},ge=()=>{S(""),I(null),u(null),k(null)},Ie=[{title:"Invoice #",dataIndex:["invoiceNumber"],key:"invoiceNumber",sorter:!0,sortOrder:h==="invoiceNumber"?C:null,render:(a,n)=>e.jsx("a",{onClick:()=>s(`/invoice/${n._id}`),children:a||"N/A"})},{title:"Company",dataIndex:["bookingId","companyName"],key:"companyName",sorter:!0,sortOrder:h==="companyName"?C:null,render:a=>a||"N/A"},{title:"Exhibition",dataIndex:["bookingId","exhibitionId","name"],key:"exhibitionName",sorter:!0,sortOrder:h==="exhibitionName"?C:null,render:(a,n)=>e.jsx("a",{onClick:()=>s(`/exhibition/${n.bookingId.exhibitionId._id}`),children:a})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:!0,sortOrder:h==="amount"?C:null,render:a=>`₹${a.toLocaleString("en-IN")}`},{title:"Status",dataIndex:"status",key:"status",sorter:!0,sortOrder:h==="status"?C:null,render:a=>e.jsx(De,{color:a==="paid"?"green":a==="pending"?"gold":a==="cancelled"?"red":"blue",children:a.toUpperCase()})},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",sorter:!0,sortOrder:h==="dueDate"?C:null,render:a=>a?ae(a).format("DD MMM YYYY"):"N/A"},{title:"Created",dataIndex:"createdAt",key:"createdAt",sorter:!0,sortOrder:h==="createdAt"?C:null,render:a=>ae(a).format("DD MMM YYYY")},{title:"Actions",key:"actions",render:(a,n)=>e.jsxs(_,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs(_,{children:[e.jsx(K,{title:"View Invoice",children:e.jsx(b,{type:"text",icon:e.jsx(Me,{}),onClick:()=>s(`/invoice/${n._id}`)})}),e.jsx(K,{title:"Download",children:e.jsx(b,{type:"text",icon:e.jsx(re,{}),onClick:()=>pe(n._id),loading:R===n._id&&o<100,disabled:R!==null&&R!==n._id})}),e.jsx(K,{title:"Email",children:e.jsx(b,{type:"text",icon:e.jsx(me,{}),onClick:()=>Ne(n._id),disabled:R!==null})})]}),R===n._id&&e.jsx(de,{percent:o,size:"small",status:"active",style:{marginBottom:0,marginTop:4}})]})}],be=(a,n,T)=>{T&&T.field&&(X(T.field),Z(T.order||"descend"))};return e.jsxs(Ae,{children:[z,e.jsxs("div",{className:"invoice-list-container",children:[e.jsx(se,{children:e.jsxs(_,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ye,{level:2,style:{margin:0},children:"Invoices"}),e.jsx(_,{children:e.jsx(K,{title:"Refresh",children:e.jsx(b,{icon:e.jsx(Re,{}),onClick:()=>he(),loading:Y})})})]}),e.jsx(se,{size:"small",title:e.jsxs(_,{children:[e.jsx($e,{})," Filters"]}),children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[e.jsxs("div",{style:{minWidth:"200px",flex:1},children:[e.jsx(G,{strong:!0,children:"Search"}),e.jsx(U,{placeholder:"Search by invoice #, company...",value:D,onChange:a=>S(a.target.value),prefix:e.jsx(Oe,{}),allowClear:!0})]}),e.jsxs("div",{style:{minWidth:"150px"},children:[e.jsx(G,{strong:!0,children:"Status"}),e.jsxs(le,{style:{width:"100%"},placeholder:"Filter by status",value:p,onChange:I,allowClear:!0,children:[e.jsx(J,{value:"pending",children:"Pending"}),e.jsx(J,{value:"paid",children:"Paid"}),e.jsx(J,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{style:{minWidth:"200px"},children:[e.jsx(G,{strong:!0,children:"Exhibition"}),e.jsx(le,{style:{width:"100%"},placeholder:"Filter by exhibition",value:v,onChange:u,loading:V,allowClear:!0,children:g.map(a=>e.jsx(J,{value:a._id||a.id,children:a.name},a._id||a.id))})]}),e.jsxs("div",{style:{minWidth:"300px"},children:[e.jsx(G,{strong:!0,children:"Date Range"}),e.jsx(He,{style:{width:"100%"},value:r,onChange:k})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx(b,{icon:e.jsx(Pe,{}),onClick:ge,children:"Clear Filters"})})]})}),e.jsx(Ee,{columns:Ie,dataSource:ve,rowKey:"_id",loading:Y,pagination:{current:l,pageSize:$,total:((te=m==null?void 0:m.pagination)==null?void 0:te.total)||0,onChange:(a,n)=>{P(a),n&&x(n)},showSizeChanger:!0,showTotal:a=>`Total ${a} invoices`},onChange:be})]})}),e.jsxs(ie,{title:"Send Invoice via Email",open:A,onCancel:()=>y(!1),onOk:je,okText:"Send",confirmLoading:xe,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(G,{strong:!0,children:"Email Address"}),e.jsx(U,{placeholder:"Enter recipient email",value:N,onChange:a=>L(a.target.value),style:{width:"100%"}})]}),e.jsxs("div",{children:[e.jsx(G,{strong:!0,children:"Message (Optional)"}),e.jsx(U.TextArea,{placeholder:"Enter optional message",value:M,onChange:a=>B(a.target.value),rows:4})]})]})]})]})},la=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{qe as I,ia as a,la as b,Ge as i,Ue as u};
