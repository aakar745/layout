import{j as a}from"./vendor-pdf-Cn0rG44s.js";import{a4 as E,r as d,G as b,d as x}from"./vendor-antd-B8jUXf3i.js";import{b as l,u as D}from"./vendor-redux-rS0pI56E.js";import{v as y,z as I,C as L}from"./index-bCNJQtew.js";import{E as P}from"./ExhibitionForm-BevSuYHi.js";import{b as T,a as R,u as j,N as q}from"./vendor-react-DW9h-haf.js";import"./vendor-http-t--hEgTQ.js";import"./vendor-antd-icons-BoTJB7uA.js";import"./vendor-ui-BmMA_ojr.js";import"./vendor-canvas-DrFPvyt4.js";import"./vendor-editor-CDayDKFN.js";const Q=()=>{var h;const{message:e}=E.useApp(),{id:F}=T(),n=(h=R().state)==null?void 0:h.exhibitionId,c=j(),s=l(),{currentExhibition:t,loading:u,error:m}=D(i=>i.exhibition),[g,C]=d.useState(!1);d.useEffect(()=>{(async()=>{if(!n){e.error("Exhibition ID not found"),c("/exhibition");return}try{await s(I(n)).unwrap()}catch(r){e.error(r.message||"Failed to fetch exhibition"),c("/exhibition")}finally{C(!0)}})()},[n,s,e,c]),d.useEffect(()=>{m&&e.error(m)},[m,e]);const A=async i=>{var r,f;if(!(!n||!t))try{const[p,k]=i.dateRange,S={name:i.name,description:i.description,venue:i.venue,startDate:p.toISOString(),endDate:k.toISOString(),status:i.status,isActive:i.isActive,invoicePrefix:i.invoicePrefix,stallRates:i.stallRates||[],dimensions:t.dimensions,taxConfig:i.taxConfig||[],discountConfig:i.discountConfig||[],publicDiscountConfig:i.publicDiscountConfig||[],companyName:i.companyName,companyContactNo:i.companyContactNo,companyEmail:i.companyEmail,companyAddress:i.companyAddress,companyWebsite:i.companyWebsite,companyPAN:i.companyPAN,companyGST:i.companyGST,companySAC:i.companySAC,companyCIN:i.companyCIN,termsAndConditions:i.termsAndConditions,piInstructions:i.piInstructions,bankName:i.bankName,bankBranch:i.bankBranch,bankIFSC:i.bankIFSC,bankAccountName:i.bankAccountName,bankAccount:i.bankAccount,headerTitle:i.headerTitle,headerSubtitle:i.headerSubtitle,headerDescription:i.headerDescription,headerLogo:i.headerLogo,sponsorLogos:i.sponsorLogos||[],footerText:i.footerText,footerLogo:i.footerLogo,contactEmail:i.contactEmail,contactPhone:i.contactPhone,footerLinks:i.footerLinks||[],amenities:((r=i.amenities)==null?void 0:r.map(o=>({type:o.type,name:o.name,description:o.description,rate:o.rate})))||[],basicAmenities:((f=i.basicAmenities)==null?void 0:f.map(o=>({type:o.type,name:o.name,description:o.description,perSqm:o.perSqm,quantity:o.quantity})))||[],specialRequirements:i.specialRequirements};await s(L({id:n,data:S})).unwrap(),e.success("Exhibition updated successfully"),c(y(t),{state:{exhibitionId:n}})}catch(p){e.error(p.message||"Failed to update exhibition")}};if(!g)return a.jsx(b,{loading:!0});if(!n)return a.jsx(q,{to:"/exhibition",replace:!0});if(u||!t)return a.jsx(b,{loading:!0});const N={name:t.name,description:t.description,venue:t.venue,dateRange:[x(t.startDate),x(t.endDate)],status:t.status,isActive:t.isActive,invoicePrefix:t.invoicePrefix,stallRates:t.stallRates||[],taxConfig:t.taxConfig||[],discountConfig:t.discountConfig||[],publicDiscountConfig:t.publicDiscountConfig||[],companyName:t.companyName,companyContactNo:t.companyContactNo,companyEmail:t.companyEmail,companyAddress:t.companyAddress,companyWebsite:t.companyWebsite,companyPAN:t.companyPAN,companyGST:t.companyGST,companySAC:t.companySAC,companyCIN:t.companyCIN,termsAndConditions:t.termsAndConditions,piInstructions:t.piInstructions,bankName:t.bankName,bankBranch:t.bankBranch,bankIFSC:t.bankIFSC,bankAccountName:t.bankAccountName,bankAccount:t.bankAccount,headerTitle:t.headerTitle,headerSubtitle:t.headerSubtitle,headerDescription:t.headerDescription,headerLogo:t.headerLogo,sponsorLogos:t.sponsorLogos||[],footerText:t.footerText,footerLogo:t.footerLogo,contactEmail:t.contactEmail,contactPhone:t.contactPhone,footerLinks:t.footerLinks||[],amenities:t.amenities||[],basicAmenities:t.basicAmenities||[],specialRequirements:t.specialRequirements};return a.jsx(b,{title:"Edit Exhibition",extra:a.jsx("a",{onClick:()=>c(y(t),{state:{exhibitionId:n}}),children:"Back to Details"}),children:a.jsx(P,{initialValues:N,onSubmit:A,submitText:"Update Exhibition"})})};export{Q as default};
