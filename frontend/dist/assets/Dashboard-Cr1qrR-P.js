import{a as f,j as e}from"./index-ZeXq6Cnq.js";import{r as d,R as k}from"./vendor-react-BNeW3y6d.js";/* empty css                  */import{f as S,ax as C,aL as A,aM as B,T,a6 as R,a7 as b,a5 as D,o as L}from"./vendor-antd-DmzwxccF.js";import"./vendor-utils-D9BQhWAM.js";import"./vendor-styling-C4kvkEn0.js";import"./vendor-canvas-BRbMLhVA.js";const w={getDashboardStats:async()=>{var a;try{const x=(await f.get("/users")).data||[],t=await f.get("/bookings"),c=((a=t.data)==null?void 0:a.data)||t.data||[],p=(await f.get("/exhibitions")).data||[],j=c.filter(i=>i.status==="confirmed"||i.status==="approved").reduce((i,m)=>i+(m.amount||0),0),y=[...c].sort((i,m)=>new Date(m.createdAt).getTime()-new Date(i.createdAt).getTime()).slice(0,5),v=[...x].sort((i,m)=>new Date(m.createdAt||0).getTime()-new Date(i.createdAt||0).getTime()).slice(0,5);return{userCount:x.length,bookingCount:c.length,totalRevenue:j,exhibitionCount:p.length,recentBookings:y,recentUsers:v}}catch(o){return console.error("Error fetching dashboard stats:",o),{userCount:0,bookingCount:0,totalRevenue:0,exhibitionCount:0,recentBookings:[],recentUsers:[]}}},getRecentActivity:async()=>{try{const{recentBookings:a,recentUsers:o}=await w.getDashboardStats();return[...a.map(t=>({id:t._id,type:"booking",title:`New booking ${t._id.substring(0,8)}`,timestamp:t.createdAt,data:t})),...o.map(t=>({id:t._id,type:"user",title:`User ${t.username||"unknown"}`,timestamp:t.createdAt,data:t}))].sort((t,c)=>new Date(c.timestamp).getTime()-new Date(t.timestamp).getTime())}catch(a){return console.error("Error fetching recent activities:",a),[]}}},{Title:F,Text:s}=T,U=({title:a,value:o,icon:x,color:t,gradient:c,loading:u})=>e.jsxs(D,{className:"stat-card",styles:{body:{padding:"24px"}},style:{background:c,border:"none",overflow:"hidden",position:"relative"},children:[e.jsx("div",{className:"stat-card-background"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx(s,{style:{fontSize:"14px",color:"rgba(255, 255, 255, 0.85)",marginBottom:"8px"},children:a}),e.jsx(s,{style:{fontSize:"28px",fontWeight:600,color:"#FFFFFF",marginBottom:"0"},children:u?e.jsx(L,{size:"small"}):o})]}),e.jsx("div",{className:"stat-card-icon",style:{color:"white"},children:x})]})]}),G=()=>{const[a,o]=d.useState(!0),[x,t]=d.useState(0),[c,u]=d.useState(0),[p,j]=d.useState(0),[y,v]=d.useState(0),[i,m]=d.useState([]),[g,I]=d.useState({server:"Online",database:"Connected",lastBackup:"2 hours ago",systemLoad:"Normal"});d.useEffect(()=>{(async()=>{o(!0);try{const r=await w.getDashboardStats();t(r.userCount),u(r.bookingCount),j(r.totalRevenue),v(r.exhibitionCount);const h=[];r.recentBookings.slice(0,3).forEach(n=>{h.push({id:n._id,icon:e.jsx(C,{}),color:"#2563EB",text:e.jsxs(s,{children:["New booking ",e.jsxs(s,{strong:!0,children:["#",n._id.substring(0,8)]})," received"]}),timestamp:new Date(n.createdAt).toLocaleString()})}),r.recentUsers.slice(0,2).forEach(n=>{h.push({id:n._id,icon:e.jsx(S,{}),color:"#7C3AED",text:e.jsxs(s,{children:["User ",e.jsxs(s,{strong:!0,children:["'",n.username,"'"]})," ",n.createdAt?"registered":"active"]}),timestamp:n.createdAt?new Date(n.createdAt).toLocaleString():"Recently"})}),h.sort((n,E)=>new Date(E.timestamp).getTime()-new Date(n.timestamp).getTime()),m(h)}catch(r){console.error("Error fetching dashboard data:",r)}finally{o(!1)}})()},[]);const N=[{title:"Total Users",value:x,icon:e.jsx(S,{}),color:"#7C3AED",gradient:"linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%)"},{title:"Total Orders",value:c,icon:e.jsx(C,{}),color:"#2563EB",gradient:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)"},{title:"Revenue",value:`â‚¹${p.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:e.jsx(A,{}),color:"#059669",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{title:"Exhibitions",value:y,icon:e.jsx(B,{}),color:"#DC2626",gradient:"linear-gradient(135deg, #DC2626 0%, #B91C1C 100%)"}];return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(F,{level:4,style:{marginBottom:"24px"},children:"Dashboard"}),e.jsx(R,{gutter:[24,24],children:N.map((l,r)=>e.jsx(b,{xs:24,sm:12,lg:6,children:e.jsx(U,{...l,loading:a})},r))}),e.jsxs(R,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(b,{xs:24,lg:12,children:e.jsx(D,{title:"Recent Activity",className:"info-card",styles:{body:{padding:"20px"}},loading:a,children:i.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:i.map(l=>e.jsxs("div",{className:"activity-item",children:[k.cloneElement(l.icon,{style:{color:l.color}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[l.text,e.jsx(s,{type:"secondary",style:{fontSize:"12px"},children:l.timestamp})]})]},l.id))}):e.jsx(s,{type:"secondary",children:"No recent activity found"})})}),e.jsx(b,{xs:24,lg:12,children:e.jsx(D,{title:"System Status",className:"info-card",styles:{body:{padding:"20px"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator online"}),e.jsxs(s,{children:["Server Status: ",e.jsx(s,{strong:!0,type:"success",children:g.server})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator connected"}),e.jsxs(s,{children:["Database Status: ",e.jsx(s,{strong:!0,type:"success",children:g.database})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator backup"}),e.jsxs(s,{children:["Last Backup: ",e.jsx(s,{strong:!0,children:g.lastBackup})]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("div",{className:"status-indicator normal"}),e.jsxs(s,{children:["System Load: ",e.jsx(s,{strong:!0,children:g.systemLoad})]})]})]})})})]})]})};export{G as default};
