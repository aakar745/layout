import{z as H,A as W,B as X,w as q,j as e}from"./index-DoSueJxk.js";import{X as F,u as A,l as _,k as G,r as p}from"./vendor-react-dkbxt9Jf.js";import{a as J,g as K}from"./url-DUULaBjX.js";import{a1 as c,aA as O,V as Q,T as Z,$ as g,a0 as o,S as v,a3 as ee,d as h,aB as te,D as S,aq as u,h as se,U as z,c as j,az as ie,aj as oe,at as re,b as Y,o as ae,aC as ne,w as le,x as de,aD as ce,j as xe,A as pe,f as ge,aE as he}from"./vendor-antd-mFVHvrVJ.js";import"./vendor-utils-ngrFHoWO.js";import"./vendor-styling-CQa69cNz.js";const{Title:$,Text:i,Paragraph:B}=Z,P=()=>{const r=A();return e.jsxs("div",{style:{marginBottom:"24px",position:"sticky",top:"16px",zIndex:10},children:[e.jsx(j,{icon:e.jsx(he,{}),onClick:()=>r("/exhibition"),type:"default",size:"large",style:{borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:"white",borderColor:"transparent",fontWeight:500,padding:"0 16px",height:"42px",display:"flex",alignItems:"center",transition:"all 0.3s ease"},className:"back-button-hover",children:e.jsx("span",{style:{marginLeft:8},children:"Back to List"})}),e.jsx("style",{children:`
        .back-button-hover:hover {
          transform: translateX(-5px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          background: #f0f5ff;
          border-color: #d6e4ff;
        }
      `})]})},ve=()=>{const{id:r}=F(),L=A(),y=_(),{currentExhibition:t,halls:f,stalls:m,loading:N}=G(s=>s.exhibition),[b,d]=p.useState(0),[n,D]=p.useState(null),[w,R]=p.useState(!1);p.useEffect(()=>{r&&(y(H(r)),y(W(r)),y(X({exhibitionId:r})),E(r))},[r,y]),p.useEffect(()=>{t&&U()},[t,n]);const E=async s=>{try{R(!0);const a=await q.getExhibitionProgress(s);D({hallCount:f?.length||0,stallCount:a.stats.totalStalls,bookedStallCount:a.stats.bookedStalls,progress:a.progress})}catch(a){console.error("Failed to fetch exhibition stats:",a),D({hallCount:f?.length||0,stallCount:m?.length||0,bookedStallCount:m?.filter(l=>l.status==="booked").length||0})}finally{R(!1)}},x=()=>n||(t?t.stats?{hallCount:f?.length||t.hallCount||0,stallCount:t.stats.totalStalls,bookedStallCount:t.stats.bookedStalls}:{hallCount:f?.length||0,stallCount:m?.length||0,bookedStallCount:m?.filter(s=>s.status==="booked").length||0}:{hallCount:0,stallCount:0,bookedStallCount:0}),U=()=>{if(!t)return 0;if(n?.progress?.combinedProgress!==void 0)return d(n.progress.combinedProgress);if(t.progress?.combinedProgress!==void 0)return d(t.progress.combinedProgress);if(n?.progress?.stallBookingProgress!==void 0)return d(n.progress.stallBookingProgress);if(t.progress?.stallBookingProgress!==void 0)return d(t.progress.stallBookingProgress);const s=new Date,a=new Date(t.startDate),l=new Date(t.endDate);if(s<a)return d(0);if(s>l)return d(100);const M=l.getTime()-a.getTime(),C=s.getTime()-a.getTime();d(Math.round(C/M*100))},I=s=>{switch(s.toLowerCase()){case"published":return"#52c41a";case"draft":return"#faad14";case"completed":return"#1890ff";default:return"#d9d9d9"}},V=()=>{if(!t)return{text:"",count:0,isPast:!1};const s=new Date,a=new Date(t.startDate),l=new Date(t.endDate);return s>l?{text:"Ended",count:Math.ceil((s.getTime()-l.getTime())/864e5),isPast:!0}:s>=a&&s<=l?{text:"Days Remaining",count:Math.ceil((l.getTime()-s.getTime())/864e5),isPast:!1}:{text:"Days Until Start",count:Math.ceil((a.getTime()-s.getTime())/(1e3*60*60*24)),isPast:!1}},T=s=>{L(K(t,s))};if(N)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(P,{}),e.jsx(c,{children:e.jsx(O,{active:!0,avatar:!0,paragraph:{rows:6}})})]});if(!t)return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(P,{}),e.jsx(c,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(Q,{style:{fontSize:"48px",color:"#d9d9d9",marginBottom:"16px"}}),e.jsx($,{level:4,children:"Exhibition not found"}),e.jsx(B,{type:"secondary",children:"The exhibition you are looking for does not exist or has been removed."})]})})]});const k=V();return e.jsxs("div",{style:{padding:"24px",background:"#f5f7fa",minHeight:"calc(100vh - 64px)"},children:[e.jsx(P,{}),e.jsx(c,{className:"exhibition-header-card",style:{marginBottom:"24px",borderRadius:"12px",overflow:"hidden"},styles:{body:{padding:"0"}},children:e.jsx("div",{style:{background:"linear-gradient(135deg, #1a365d 0%, #44337a 100%)",padding:"40px 24px",position:"relative"},children:e.jsxs(g,{gutter:[24,24],align:"middle",children:[e.jsxs(o,{xs:24,md:16,children:[e.jsx($,{level:2,style:{color:"white",marginBottom:"8px",marginTop:0},children:t.name}),e.jsx(B,{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"16px",marginBottom:"24px"},children:t.description}),e.jsxs(v,{split:e.jsx(S,{type:"vertical",style:{background:"rgba(255,255,255,0.3)"}}),children:[e.jsxs(v,{children:[e.jsx(ee,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsxs(i,{style:{color:"rgba(255,255,255,0.8)"},children:[h(t.startDate).format("MMM D, YYYY")," - ",h(t.endDate).format("MMM D, YYYY")]})]}),t.venue&&e.jsxs(v,{children:[e.jsx(te,{style:{color:"rgba(255,255,255,0.8)"}}),e.jsx(i,{style:{color:"rgba(255,255,255,0.8)"},children:t.venue})]})]})]}),e.jsx(o,{xs:24,md:8,children:e.jsxs(c,{style:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",position:"relative",overflow:"visible"},children:[e.jsx("div",{style:{position:"absolute",top:"-12px",right:"-12px",zIndex:2,background:I(t.status),color:"white",padding:"4px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:t.status.toUpperCase()}),e.jsx(u,{title:k.text,value:k.count,suffix:"days",valueStyle:{color:k.isPast?"#8c8c8c":"#1890ff",fontWeight:600},prefix:e.jsx(se,{})}),e.jsx(S,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(i,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(z,{percent:b,status:b===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),t.progress&&e.jsxs("div",{style:{marginTop:"12px",fontSize:"12px",color:"#8c8c8c"},children:[e.jsxs("div",{children:["Stall Booking: ",t.progress.stallBookingProgress,"%"]}),e.jsxs("div",{children:["Timeline: ",t.progress.timeProgress,"%"]})]}),t.stats&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#595959"},children:[t.stats.bookedStalls,"/",t.stats.totalStalls," stalls booked"]})]})})]})})}),e.jsxs(g,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(o,{xs:24,sm:8,children:e.jsx(j,{type:"primary",icon:e.jsx(ie,{}),onClick:()=>T(`${r}/layout`),block:!0,size:"large",style:{height:"48px"},children:"Manage Layout"})}),e.jsx(o,{xs:24,sm:8,children:e.jsx(j,{icon:e.jsx(oe,{}),onClick:()=>T(`${r}/edit`),block:!0,size:"large",style:{height:"48px"},children:"Edit Exhibition"})}),e.jsx(o,{xs:24,sm:8,children:e.jsx(j,{icon:e.jsx(re,{}),onClick:()=>window.open(J(t),"_blank"),block:!0,size:"large",style:{height:"48px"},disabled:t.status!=="published",children:"View Public Page"})})]}),e.jsxs(g,{gutter:[24,24],children:[e.jsx(o,{xs:24,lg:16,children:e.jsxs(c,{title:"Exhibition Details",style:{borderRadius:"12px",height:"100%"},children:[e.jsxs(g,{gutter:[24,24],children:[e.jsxs(o,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Start Date"}),e.jsx(i,{strong:!0,style:{fontSize:"16px"},children:h(t.startDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"End Date"}),e.jsx(i,{strong:!0,style:{fontSize:"16px"},children:h(t.endDate).format("MMMM D, YYYY")})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Created At"}),e.jsx(i,{strong:!0,style:{fontSize:"16px"},children:h(t.createdAt).format("MMMM D, YYYY")})]})]}),e.jsxs(o,{xs:24,sm:12,children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Status"}),e.jsx(Y,{color:I(t.status),style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:t.status.toUpperCase()})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Active Status"}),e.jsx(Y,{color:t.isActive?"#52c41a":"#f5222d",style:{padding:"4px 12px",borderRadius:"4px",fontSize:"14px"},children:t.isActive?"ACTIVE":"INACTIVE"})]}),t.venue&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Venue"}),e.jsx(i,{strong:!0,style:{fontSize:"16px"},children:t.venue})]})]})]}),e.jsx(S,{}),e.jsxs("div",{children:[e.jsx(i,{type:"secondary",style:{display:"block",marginBottom:"8px"},children:"Description"}),e.jsx(B,{children:t.description||"No description provided."})]})]})}),e.jsxs(o,{xs:24,lg:8,children:[e.jsxs(c,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Exhibition Stats"}),e.jsx(j,{type:"text",size:"small",loading:w,onClick:()=>r&&E(r),icon:e.jsx(xe,{}),title:"Refresh Stats"})]}),style:{borderRadius:"12px",marginBottom:"24px"},children:[w?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(ae,{size:"large"}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsx(i,{type:"secondary",children:"Loading real-time statistics..."})})]}):e.jsxs(g,{gutter:[16,24],children:[e.jsx(o,{span:12,children:e.jsx(u,{title:"Halls",value:x().hallCount,prefix:e.jsx(ne,{})})}),e.jsx(o,{span:12,children:e.jsx(u,{title:"Stalls",value:x().stallCount,prefix:e.jsx(le,{})})}),e.jsx(o,{span:12,children:e.jsx(u,{title:"Booked Stalls",value:x().bookedStallCount,prefix:e.jsx(de,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(o,{span:12,children:e.jsx(u,{title:"Available Stalls",value:x().stallCount-x().bookedStallCount,prefix:e.jsx(ce,{}),valueStyle:{color:"#1890ff"}})})]}),e.jsx(S,{style:{margin:"16px 0"}}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx(i,{type:"secondary",children:"Exhibition Progress"})}),e.jsx(z,{percent:b,status:b===100?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),n?.progress&&e.jsxs("div",{style:{marginTop:"12px",fontSize:"12px",color:"#8c8c8c"},children:[e.jsxs("div",{children:["Stall Booking: ",n.progress.stallBookingProgress,"%"]}),e.jsxs("div",{children:["Time Progress: ",n.progress.timeProgress,"%"]}),e.jsxs("div",{children:["Combined: ",n.progress.combinedProgress,"%"]})]})]}),e.jsx(c,{title:"Created By",style:{borderRadius:"12px"},children:t.createdBy?e.jsxs(v,{children:[e.jsx(pe,{icon:e.jsx(ge,{})}),e.jsx(i,{children:t.createdByName||"Administrator"})]}):e.jsx(i,{type:"secondary",children:"Information not available"})})]})]})]})};export{ve as default};
